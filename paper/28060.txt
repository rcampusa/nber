                             NBER WORKING PAPER SERIES




  PRODUCTIVITY SHOCKS, LONG-TERM CONTRACTS AND EARNINGS DYNAMICS

                                        Neele Balke
                                      Thibaut Lamadon

                                     Working Paper 28060
                             http://www.nber.org/papers/w28060


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                  November 2020




We are thankful to Stéphane Bonhomme, Jan Eeckhout, Jeremy Lise, Costas Meghir and Jean-
Marc Robin for their invaluable advice and to Joseph Altonji, Richard Blundell, Hector Chade,
Michael Greenstone, Jim Heckman, Lisa Laun, Rasmus Lentz, Magne Mogstad, Giuseppe
Moscarini, Nicola Pavoni, Fabien Postel-Vinay and Shouyong Shi for their helpful comments and
suggestions. We thank Sara Constantino, Arjun Gopinath and Adam Oppenheimer for their
assistance. We also thank seminar and conference participants at UCL, IFS, Yale University,
SciencePo, UChicago, UPenn, Northwestern, NYU, Stanford, University of Minnesota,
University of Wisconsin and others. We gratefully acknowledge financial support from the
cemmap, ESRC, the IFS, the Cowles Foundation and the NSF (grant SES-1658920). We are
deeply thankful to the IFAU (www.ifau.se) for access to and help with the Swedish
administrative data. The views expressed herein are those of the authors and do not necessarily
reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2020 by Neele Balke and Thibaut Lamadon. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Productivity Shocks, Long-Term Contracts and Earnings Dynamics
Neele Balke and Thibaut Lamadon
NBER Working Paper No. 28060
November 2020
JEL No. E24,J31,J41,J64

                                         ABSTRACT

This paper examines how employer- and worker-specific productivity shocks transmit to earnings
and employment in an economy with search frictions and firm commitment. We develop an
equilibrium search model with worker and firm shocks and characterize the optimal contract
offered by competing firms to attract and retain workers. In equilibrium, risk-neutral firms
provide only partial insurance against shocks to risk-averse workers and offer contingent
contracts, where payments are backloaded in good times and frontloaded in bad times. We prove
that there exists a unique spot target wage, which serves as an attraction point for smooth wage
adjustments. The structural model is estimated on matched employer-employee data from
Sweden. The estimates indicate that firms absorb persistent worker and firm shocks, with
respective passthrough values of 27 and 11%, but price permanent worker differences, a large
contributor (32%) to variations in wages. A large share of the earnings growth variance can be
attributed to job mobility, which interacts with productivity shocks. We evaluate the effects of
redistributive policies and find that almost 40% of government-provided insurance is undone by
crowding out firm-provided insurance.


Neele Balke
Department of Economics
University of Chicago
1126 East 59th Street
Chicago, IL 60637
nbalke@uchicago.edu

Thibaut Lamadon
Department of Economics
University of Chicago
1126 East 59th Street
Chicago, IL 60637
and NBER
lamadon@uchicago.edu




A data appendix is available at http://www.nber.org/data-appendix/w28060
A web appendix is available at http://lamadon.com/paper/balke_lamadon_wagedyn_supp.pdf
1     Introduction
Firms play an influential role in determining the level of earnings and employ-
ment risk for their workers when designing job contracts (Knight (1921)). Em-
pirical work suggests that they only partially insure their workforce against
productivity shocks (Guiso, Pistaferri, and Schivardi (2005)). Understanding
wage setting and contract formation is then central to key questions in eco-
nomics, including the sources of earnings uncertainty, the implications of job
mobility and the e ectiveness of government insurance.
    The theory of dynamic contracts provides a foundation for the use of long-
term agreements between firms and workers (Harris and Holmstrom (1982),
Thomas and Worrall (1988), Holmstrom and Milgrom (1991)). However, com-
bining optimal contracts with equilibrium models of job mobility with search
frictions is challenging, both theoretically and empirically. Such contracts do
not always admit closed-form solutions (Abreu, Pearce, and Stacchetti (1986)),
and history dependence makes identification di cult. In fact, the empirical
literature on earnings and employment dynamics is often silent about whether
and how firms endogenously set the level of risk for their workers.
    In this paper, we characterize the optimal contract in an equilibrium search
model with risk-averse workers who lack the ability to commit, and both in-
dividual and firm-level productivity shocks. We establish a tractable solu-
tion and conditions for the non-parametric identification of the productivity
processes. The model is parameterized and estimated on Swedish matched
employer-employee data. Using the estimates, we first examine di erent in-
surance channels and how they interact with incentives for workers. We then
quantify the relative variance contribution of di erent sources of uncertainty
to wages and how large the passthrough of productivity shocks to workers is.
Finally, we measure the e ectiveness of government policies aimed at reducing


                                       1
earnings uncertainty by redistributing from high to low earners.
       We develop a structural model with search frictions and one-sided lack of
commitment on the worker side. Search is directed and risk-neutral, ex-ante
homogeneous firms post dynamic contracts to attract workers in di erent sub-
markets.1 Workers are heterogeneous in skills and risk-averse. They search in
the submarket that o ers the best trade-o between expected utility and job-
finding probability. While firms can commit, workers cannot. In particular,
firms are able to credibly promise to insure their workers even when making fu-
ture losses. In contrast, the choices workers make over which market to search
on the job and how much e ort to put into retaining a job are unobservable
and non-contractible (Shi (2009), Tsuyuhara (2016)). This creates a monitor-
ing problem with decision margins on transitions to both unemployment and
other jobs. As a result, dynamic contracts optimally balance the incentives for
search and e ort with the provision of insurance against shocks. In this model,
firms flexibly specify wages for each future productivity path, rather than set-
ting fixed piece rate wages or Nash bargaining contracts, which impose shock
transmission by construction. The model thus o ers a framework for studying
the passthrough of individual- and firm-level productivity shocks to wages and
mobility decisions.
       We prove the existence of an equilibrium and show that the optimal con-
tract features backloading of wages at the time of hiring (like in Stevens (2004),
Burdett and Coles (2003), Shi (2009), Tsuyuhara (2016)) as well as frontloading
of wages in bad times (similar to the optimal unemployment benefits in Hopen-
hayn and Nicolini (1997)). Workers do not internalize the full future surplus
of the match when choosing how much e ort to exert and where to search.
The firm thus chooses to "tilt" the wage profile to appropriately incentivize the
   1
    The pioneering work in directed search is due to Montgomery (1991), Peters (1991), Moen
(1997), Shimer (2005), Burdett, Shi, and Wright (2001) as well as Menzio and Shi (2010),
which this paper builds on.


                                            2
worker. We prove that there exists a unique spot target wage, which serves as
the attraction point for these smooth wage adjustments. The existence of the
target wage has several implications. First, since the target wage can lie below
the current wage level in equilibrium, wage cuts occur on the job despite firm
commitment. Second, since the target wage is a function of worker and firm
productivity, wages respond to both worker- and firm-specific shocks, in keeping
with the empirical literature (Guiso, Pistaferri, and Schivardi (2005), Friedrich,
Laun, Meghir, and Pistaferri (2019), Card, Cardoso, Heining, and Kline (2018)).
This is an important departure from a competitive market, where earnings equal
marginal productivity and do not respond to firm-level shocks.
   We develop conditions for the identification of the productivity processes and
the production function. Independence between worker and firm shocks enables
us to separate them using coworkers' earnings, and the Markov property of the
contract allows us to rely on results for hidden Markov chains (Hu and Shum
(2012)). Solving for the optimal contract is challenging. To achieve tractabil-
ity, we not only use promised utility as an additional state (Spear and Srivas-
tava (1987)), but also show that it is su cient to solve for a single promised
marginal utility across all realizations of future productivity (Marcet and Mari-
mon (2019)). The model is estimated in general equilibrium on administrative
employer-employee data from Sweden. Using simulated methods of moments,
we match transition rates, earnings dynamics and the comovement of firm out-
put with both worker earnings and mobility.
   Our impulse response analysis reveals that the contract provides partial
insurance, especially against negative shocks, and strongly relies on job mobility
to stabilize wages after negative shocks to firm productivity. We compare the
baseline model to a first best contract, where firms o er perfectly flat wages,
which highlights the fact that wage backloading in good times only happens in
the presence of commitment and incentive issues.


                                        3
   To quantify di erent sources of wage uncertainty, we decompose the variance
of earnings and earnings growth into structural components. We find that the
time-varying worker and firm shocks contribute much more to variability in
output than earnings, suggesting that firms provide substantial insurance to
workers. In contrast, firms barely attenuate permanent productivity di erences
between workers, the largest contemporaneous contributor (32%) to variation in
wages across workers. We also find that most (86%) of the variance in earnings
growth is associated with worker transitions in and out of employment, which
interact with productivity shocks.
   We expand on the conventional definition of passthrough to account for three
additional factors. First, we consider persistent shocks spanning a long time
horizon in contrast to strictly transitory or fully permanent shocks. Second,
since shocks alter job transitions, we account for the e ects on workers after
they change jobs. Third, in addition to looking at wage e ects, we extend our
analysis to consider the impacts on the lifetime utility of the worker. Based on
our preferred specification, we estimate passthrough values of 27 and 11% in
response to worker- and firm-level productivity shocks, respectively.
   Finally, we look at how e orts by the government to provide public insurance
to workers are eroded by firms, who optimally raise the passthrough of shocks
to earnings in response to such policies. A revenue-neutral tax policy that
redistributes income from high to low earners achieves only 60% of its direct
insurance e ect because it crowds out insurance provision by the firm. These
findings demonstrate how accounting for firms' decisions to provide insurance
can have important implications for the anticipated e cacy of public policies.

Related literature. There is an important theoretical literature on long-term
contracts between firms and workers. Baily (1974) and Azariadis (1975) study
long-term contracts with commitment and develop the insurance role of the
firm. Harris and Holmstrom (1982) derive the optimal contract when workers

                                       4
cannot commit and find that positive shocks pass through to worker earnings.
Thomas and Worrall (1988) extend this work by looking at lack of commitment
by both workers and firms in the presence of rents. MacLeod and Malcomson
(1989) develop the implications of non-verifiable output. Building on this work,
we include search frictions into the analysis of long-term contracts.
   In the frictional search literature, Stevens (2004), Burdett and Coles (2003)
and Shi (2009) derive optimal wage-tenure contracts and show the presence
of backloading in the absence of shocks. Tsuyuhara (2016) introduces e ort
to control job destruction and derives similar conclusions. Lentz (2013) devel-
ops the optimal wage-tenure contract when firms can respond to outside o ers.
Menzio and Shi (2010) introduce aggregate and match shocks and develop the
block-recursive properties of directed search equilibria, i.e. that the aggregate
distribution does not enter the state space of the firm. Our paper complements
theirs by theoretically and empirically characterizing the link between wages
and productivity. Schaal (2017) develops the incentive-compatible contract in
a directed search environment with risk-neutral workers. Rudanko (2009) de-
rives and evaluates the optimal contract with two-sided lack of commitment
and aggregate shocks in a model without on-the-job search or private actions.
´
Abrah´
     am, Alvarez-Parra, and Forstner (2017) study a contract with moral haz-
ard in production and its implications for cross-sectional wage dispersion. To our
knowledge, the current paper is the first to characterize the optimal long-term
contract o ered in equilibrium by firms in an economy with search frictions,
on-the-job search, firm and worker shocks and risk-averse workers.
   This paper contributes to the growing empirical literature analyzing how
firm shocks are transmitted to worker earnings. Guiso, Pistaferri, and Schivardi
(2005) are the first to document the wage e ects of permanent and transitory
firm shocks, using Italian data. Carlsson, Messina, and Skans (2016) find similar
estimates using detailed information on product prices in Sweden. In Friedrich,


                                        5
Laun, Meghir, and Pistaferri (2019), the authors estimate a model with exoge-
nous earnings dynamics, including firm-level shocks, and endogenous mobility
decisions. Roys (2016) uses firm-level data to study the link between firm shocks,
wage bills, and employment in a model where wages are set by Nash bargaining.
We extend this literature by endogenizing the level of insurance that firms o er
workers.
   Our analysis fits into a wider empirical literature that uses search models
to understand wage dispersion and mobility. Postel-Vinay and Robin (2004),
Bagger, Fontaine, Postel-Vinay, and Robin (2014) and Lise, Meghir, and Robin
(2016) estimate models of earnings with risk-neutral workers and sequential
contracting. We extend this literature and use matched employer-employee data
to estimate a search model with optimal contracting and risk-averse workers.
   Two papers have empirically assessed the presence of optimal contracts. Chi-
appori, Salanie, and Valentin (1999) directly investigate the presence of down-
ward rigidity in wages over time, while Lemieux, MacLeod, and Parent (2009)
study the presence of performance pay contracts and their contribution to the
rise in earnings inequality in the US. We complement this work by introducing
search frictions.
   Finally, this paper also relates to the large empirical literature on earnings
and employment dynamics. MaCurdy (1982), Abowd and Card (1989), Meghir
and Pistaferri (2004) and Altonji, Smith, and Vidangos (2013) document the
importance of persistent shocks in the process of earnings and employment using
longitudinal data. Hall and Mishkin (1980), Blundell, Pistaferri, and Preston
(2008) and Low, Meghir, and Pistaferri (2010) evaluate how income shocks a ect
consumption and how these e ects are mitigated by government transfers. In
this paper, we extend this work by showing how the earnings process itself might
change due to optimal responses by firms in contexts where governments insure
workers against earnings risks.


                                        6
Outline.        Section 2 presents the equilibrium search model and Section 3
characterizes the optimal contract. In Section 4, we describe the model imple-
mentation, the data, moment selection and the estimation strategy. In Section
5, we analyze the results and report the e ects of a redistributive tax policy.


2       The contracting model
This section presents an equilibrium search model that examines the extent to
which risk-neutral firms use employment contracts to provide partial insurance
for risk-averse workers in the presence of firm-level and worker-specific produc-
tivity shocks. In this model, workers can search on the job, search is directed,
and firms compete to create vacancies and o er dynamic contracts to attract
applicants. While firms can commit to contracts, workers cannot. In particular,
workers' choices about which market to search and the level of e ort to put into
retaining their jobs are unobservable and hence non-contractible.

2.1     Environment

Agents and preferences. Time is discrete, indexed by t and continues forever.
The economy is composed of a discrete uniform distribution of infinitely-lived
workers with ability indexed by xt oe X={x1 , x2 ...xnx } and evolving over time
according to a Markov process. Workers enjoy utility over consumption, cap-
tured by the increasing and concave utility function u : R æ R, and pay a utility
cost of e ort c : R æ R, where c(0)=0, cÕ oe [0, cÕ ], cÕ (0)=0, cÕÕ >0. Lacking access
to asset markets, employed workers consume their wages wt and unemployed
workers receive unemployment benefits b(xt ).2 Workers maximize the expected
sum of utility from consumption less e ort, discounted at a factor -- .
    2
     Although introducing worker savings would be an interesting additional feature, it drasti-
cally complicates the problem, both theoretically and numerically. Introducing hidden savings
                                                                        ´
is an active area of research in principal-agent environments (see e.g. Abrah´am and Pavoni
(2008), Attanasio and Pavoni (2011)).



                                              7
       The employer side of the market is composed of a uniform distribution of
ex-ante identical firms indexed by j oe [0, 1]. Firms produce output, pay wages
and post job vacancies. A given firm employs a mass of workers ljt (xt , zt ), where
each worker has her own productivity xt and job-specific match quality zt . The
firm produces total output Yjt using a constant-returns-to-scale technology:
                                       ÿÿ
                               Yjt =           ljt (x, z )f (x, z ),                       (1)
                                       x   z

where f (xt , zt ) is the output of a worker of type xt in a match of quality zt .
       The discrete match quality zt oe Z evolves over time according to a monotonic
transition rule zt+1 =g (zt , <jt ) and is governed by firm-level productivity shocks
<jt . In every period, a firm experiences only one firm-wide productivity shock
<jt but has a distribution of match qualities and worker types. At each xt and
zt the firm pays a distribution of wages wt , which is set dynamically.
       Each firm chooses how many vacancies to post at a unit cost k . The vacancies
are viable for one period and become active jobs if they match with a worker.
New hires start with a match quality zt+1 =g (z0 , <jt ) for some fixed z0 .3 The
objective of the firm is to maximize the present value of profits.

Labor market. The matching process between workers and firm vacancies is
constrained by search frictions. The labor market is organized in a set of sub-
markets indexed by (xt , vt ) oe XV, where vt oe V=[v, v ] is the value promised
to the worker in that submarket. The promised value vt equals the expected
lifetime utility for a worker of type xt who matches with a firm in submarket
(xt , vt ). Firms choose the submarkets (xt , vt ) where they open vacancies and
workers direct their search to any vt queue associated with their own type xt .4
   3
     A fixed z0 guarantees that firms are ex-ante identical, which simplifies the solution.
   4
     Theorem 3 in Menzio and Shi (2011) reveals that workers will separate by type in equi-
librium if markets are indexed by the value that each type xt gets in a particular submarket
v=(v (x1 ), v (x2 )...v (xnx )) oe Rnx , and workers can apply to any submarket. In equilibrium
only a given type xt visits a particular market. This market can then be represented directly
by (xt , vt ), as done in the current paper.



                                               8
                                   Figure 1: Within-period time line

                                                     job                  job
                                                 destruction           transition

                                                    " (et )              Yp((xt , vt ))

            t                                                                                t+1
                f (xt , zt ), wt           et                   vt          xt+1 , zt+1 |xt , zt
                production               e ort                search         productivity
                 and wage                                                        shocks


Within each queue the matching between firms and workers is random.
   Each submarket displays a tightness represented by the function  : XV æ
R+ , which is the ratio of the number of vacancies to the number of workers.
Tightness is queue-specific, which means that in queues with a high ratio of
vacancies to workers it is harder for firms to hire, and di erent worker types
find jobs at di erent rates. In queue (xt , vt ) a worker of type xt matches with
probability p((xt , vt )) and a vacancy is filled with probability q ((xt , vt )). The
job finding probability p() oe [0, 1] is assumed to be twice continuously di er-
entiable, strictly increasing and strictly concave, where p(0)=0 and pÕ (0)<OE.
Similarly, q () oe [0, 1] is a twice continuously di erentiable, strictly decreas-
ing and strictly convex function such that q ()=p()/, q (0)=1 and p(q 1 (·))
is concave. When choosing which submarket to participate in, both firms and
workers take into account the value as well as the probability of matching.

Timing of actions.                  Each period is divided into four stages as illustrated
in Figure 1. First, production takes place at given productivity levels xt and
zt . For each match, the firm collects output and pays a wage wt to the worker.
Second, workers choose their e ort level et by balancing e ort costs c(et ) and
job destruction probability " (et ), where " (0)=1, " Õ oe [" Õ , 0) and " ÕÕ Æ0. There is
a decreasing probability of job loss in e ort " (et ), which captures the idea that
a negligent worker might lose a client or break a machine and so is more likely


                                                      9
to be fired, and that she can choose to become unemployed at zero cost since
c(0)=0. Although the worker chooses " (et ), the firm can also induce separation
by promising a su ciently low future lifetime utility such that the worker quits.
Third, in the search stage workers choose which submarket (xt , vt ) to visit and
get matched with probability Yp((xt , vt )), where Y oe [0, 1] denotes their on-
the-job search e ciency. If matched, the worker moves to a new job and the
current job is destroyed. If they do not match, the job continues to the fourth
stage, in which a new xt+1 is realized and the firm shock <t updates the match
quality zt+1 .

Informational structure and contracts. A contract defines the wage and
actions for a matched worker and firm for all future histories. Call st © (xt , zt ) oe
S=XZ the productivity tuple of a match in period t and call s· © (s1 ...s· ) oe S·
a given history of realizations between today and · periods in the future. The
future history of productivity for a match is common knowledge to both the
worker and the firm and so is fully contractible. However, the worker's e ort
and search decisions are private information. The contract C o ered by the firm
to the worker is then represented by:

       C © (w,  )       where       w © {w· (s· )}OE
                                                  · =0 ;      © {v· (s· ), e· (s· )}OE
                                                                                    · =0 .     (2)

The first component of the contract w captures the firm's wage policy for each
future history w· (s· ). The second component  comprises the worker's re-
sponses and can be thought of as the unenforceable actions suggested by the
contract. Specifically, it includes the e ort level e· (s· ) and the submarket the
employee applies to on the job v· (s· ) for each future history of productivity.5
Although both of these actions are unobserved by the firm, we focus on con-
tracts where the contractual recommendations are incentive-compatible. The
   5
    Derivations will require that contracts specify simple probabilities over actions rather
than actions themselves. This is left implicit at this point but will be clarified in the recursive
formulation of the problem.


                                                10
firm thus chooses both wages and workers' actions, subject to the incentive
compatibility constraint that the actions match the workers' optimal responses.
   Importantly, the contract space is completely flexible in how wages respond
to tenure and productivity histories. In particular, unlike piece rate contracts
or Nash bargaining, it does not impose any restrictions on how firms set wages
in response to productivity shocks, which is the central question of this paper.
Since firms choose the amount of passthrough of a shock endogenously, the
model helps to rationalize the firms' contribution to workers' uncertainty about
their earnings. By taking the model to the data, we are able to quantify the
level of risk absorption by the firm and the e ectiveness of government-provided
insurance in mitigating the risk to workers.

2.2    Worker's problem
Consider an unemployed worker of type xt who receives benefits b(xt ) in the
current period and wants to search on the submarket that o ers the best trade-
o between promised future utility and job finding probability. Dropping all
time subscripts and focusing on a stationary equilibrium, the value of being
unemployed U (x) can be written as:

 U (x) = sup u(b(x)) + -- p((x, v0 ))v0 + -- (1  p((x, v0 ))) ExÕ [U (xÕ )|x], (BE-U)
          v0

where v0 denotes the expected lifetime utility in the submarket chosen by the
unemployed worker.
   Next, let an employed worker be in a job with productivity levels (x, z ) and
a current promised value V . Suppose the firm pays a wage w in this period and
promises an expected lifetime utility W from tomorrow into the future. Then the
employed worker faces the following problem when making her current search




                                         11
and e ort decisions (v1 , e):

  max u(w)  c(e) + --" (e)ExÕ [U (xÕ )|x] + -- (1  " (e))Yp((x, v1 ))v1
   v1 ,e

                                      + -- (1  " (e))(1  Yp((x, v1 )))W. (EQ-W)

The optimal worker policies v1
                             ú
                               : XV æ [v, v ] and eú : XV æ [0, e] depend
on the worker's current x and the promised expected utility for next period W ,
but not on the match quality z , the wage w or the current promised value V .

Definition 1. We define the composite retention probability p
                                                            ~ : XV æ [0, 1]
                                     ~ : XV æ R as functions of x and the
and the utility return to the worker r
promised utility W using short-hand eú = eú (x, W ) and v1
                                                         ú
                                                           = v1
                                                              ú
                                                                (x, W ):
            ~(x, W ) ©(1  " (eú )) (1  Yp((x, v1
            p                                  ú
                                                 )))

            ~(x, W ) ©  c(eú ) + -- (1  " (eú )) Yp((x, v1
            r                                            ú
                                                           )) (v1
                                                                ú
                                                                   W)

                                + --" (eú )ExÕ [U (xÕ )|x] + -- (1  " (eú )) W.

The functions p
              ~(x, W ) and r
                           ~(x, W ) capture how a firm can incentivize a worker
when setting the wage dynamically.

2.3        Firm's problem
Setting up the firm's problem involves resolving two di culties. First, each firm
has infinitely many employment relationships that need to be optimized. This
can be addressed by relying on a constant-returns-to-scale technology combined
with linear vacancy costs, which allows us to separate the firm's problem into
individual jobs. Second, the contract a firm o ers to a new worker specifies the
wage for every future sequence of productivity shocks. Solving this problem
for all possible contingencies is intractable because the dimensionality grows to
infinity. However, following Spear and Srivastava (1987), we can rewrite the
firm's problem recursively by augmenting the productivity state space (x, z )
with the previously promised utility to the worker V .


                                         12
    The firm's expected profit from a match J (x, z, V ) can be expressed recur-
sively as:
                                          ÿ         1                                                                  2
J (x, z, V ) =           max                      fii f (x, z )  wi + -- p
                                                                         ~(x, Wi )ExÕ zÕ [J (xÕ , z Õ , WixÕ zÕ )|x, z ]
                   fii ,wi ,Wi ,WixÕ zÕ
                                          i=1,2
                                   ÿ
             s.t          V Æ              fii (u(wi ) + r
                                                         ~(x, Wi )) ,                                      (BE-F)
                                  i=1,2
                                                                   ÿ
                          Wi = ExÕ zÕ [WixÕ zÕ |x, z ],                    fii = 1.
                                                                   i=1,2

At each state (x, z, V ), the firm chooses the randomization fii : SV æ [0, 1]
over a two-point lottery, whose only purpose is to ensure concavity of the ex-
pected profit function. Although the underlying utility and productivity func-
tions are concave, incentive constraints can, in general, create additional gains
from randomization for firms and workers because the allocation space may be-
come non-convex. Lotteries are a standard way to convexify the feasible set and
so retain concavity of J (x, z, V ), which is useful to establish the existence of an
equilibrium (Prescott and Townsend (1984)). All other choices, including the
wage wi : SV æ R+ , promised future expected utilities Wi : SV æ V and
productivity-specific promised utilities WixÕ zÕ : SV æ V, are made contingent
on the lottery realization i at the beginning of each period. The values WixÕ zÕ
reflect that we augmented the state space with V . These values enter the con-
tinuation value and are set optimally contingent on the realized productivity in
the next period (xÕ , z Õ ).
    When choosing the control variables to maximize expected returns, the firm
has to respect previous commitments and incentive compatibility. The promise-
keeping constraint ensures that the firm honors last period's promise to deliver
the value V to the worker (see the left hand side of the first constraint). Incentive
compatibility of the worker is embedded in r
                                           ~(·, ·) and p
                                                       ~(·, ·).
    Next, consider the return to opening a vacancy in market (x, v ), given va-



                                                              13
cancy creation cost k and initial match quality z0 :

                (x, v ) = max q ((x, v ))ExÕ zÕ [J (xÕ , z Õ , W0xÕ zÕ )|x, z0 ]  k
                          W0xÕ zÕ

                         s.t. v = ExÕ zÕ [W0xÕ zÕ |x, z0 ].                           (BE-V)

Finally, firms open vacancies in a given market if and only if expected returns
to the vacancy are positive.

2.4    Equilibrium

Free entry. We impose a free entry condition on each submarket. Free entry
together with linear vacancy costs imply that as long as the return to a vacancy
 (x, v ) is positive, firms post more vacancies to make profits. However, the
more vacancies are posted in a market, the tighter the market gets, lowering
the vacancy filling rate and consequently each vacancy's expected value. This
means that firms open vacancies in each market until expected profits become
non-positive:

                            '(x, v ) oe X  V :         (x, v ) Æ 0.                   (EQ1)

This condition pins down the equilibrium tightness (x, v ) and the mass of
vacancies ,,(x, v ) in each active submarket (x, v ). We consider a symmetric
equilibrium where all firms open an identical number of vacancies in each queue.

Market clearing. Let h(x, z, V ) be the stationary distribution of workers with
productivity x in matches of quality z with promised utility V . Let µ(x) rep-
resent the mass of unemployed workers of type x. The distributions h(x, z, V ),
µ(x) and ,,(x, v ) represent the equilibrium allocation in the labor market. In or-
der for labor markets to clear, these equilibrium distributions must be generated
by equilibrium decisions.
   To derive the law of motion for the stationary distribution h(x, z, V ) in the
economy, we initially focus on the firm-side problem. A firm is large in the sense


                                              14
that it hires a continuum of workers, and at the same time it is infinitesimal in
the economy because it cannot hire a significant share of the entire work force.
For each firm, the distribution of match quality, worker types and promised
values is pinned down by its entire history of shocks < OE . The infinite shock
history matters because a shock in one period can alter the distribution of jobs
at the firm level beyond that period. For instance, if a firm experienced a very
bad shock last period, this will a ect the distribution of workers beyond current
productivity levels. However, conditional on the history < OE , the identity of
the firm is redundant. In other words, the notion of a firm in this context is
captured by a shared history of shocks. Hence, it is su cient to characterize
the joint distribution over (x, z, V ) at the firm level, denoted by h(x, z, V |< OE ),
where < OE is exogenous. The law of motion for this distribution is:
   1                  2 ^ ÿ
  h x, z, V |[< ; < ] =
                   OE
                            ,,(xÕ , V Õ )q ((xÕ , V Õ ))P (x|xÕ )
                                        xÕ
                                  VÕ

                                       1{z = g (z0 , < )}1{V = W0xz (xÕ , z0 , V Õ )} dV Õ
                ÿÿ ÿ
           ^
       +                          fii (xÕ , z Õ , V Õ )~
                                                       p(xÕ , Wi (xÕ , z Õ , V Õ ))h(xÕ , z Õ , V Õ |< OE )P (x|xÕ )
                xÕ   zÕ   i=1,2
           VÕ

                                  1{z = g (z Õ , < )}1{V = Wixz (xÕ , z Õ , V Õ )} dV Õ .

Importantly, conditional on the shock history, it is unnecessary to keep track
of which worker was in which firm, a direct result of having search markets.
Since firms are large and symmetric, the overall state of the economy can be
characterized by the integral of the joint distribution over shock histories at the
firm level < OE . This pins down the aggregate stationary distribution h(x, z, V ):
                                   ^
                      h(x, z, V ) = h(x, z, V |< OE )P (< OE ) d< OE .     (EQ2)




                                                          15
    Next, the mass of unemployed workers µ(x) evolves according to:
              ÿ
  µ(xÕ ) =            µ(x)P (xÕ |x)[1  p((x, v0
                                              ú
                                                (x)))]+
                  x
          ÿÿ ÿ
    ^
                            (1  µ(x))P (xÕ |x)[1  p
                                                  ~(x, Wi (x, z, V ))]h(x, z, V ) dV. (EQ3)
          x       z i=1,2
      V

Finally, the vacancy mass ,,(x, v ) must satisfy '(x, v ):
                            5
  ,,(x, v ) = (x, v ) µ(x)1{v = v0    ú
                                        (x)}
            ^
              ÿ ÿ                                                               6
      +Y               fii (x, z, V )1{v = v1i (x, Wi (x, z, V ))}h(x, z, V ) dV . (EQ4)
                                             ú
                      z i=1,2
              V

Based on these conditions, we define the equilibrium.

Definition 2. A recursive search equilibrium consists of firm value func-
tions J (x, z, V ) and          (x, V ), an unemployment value function U (x), a job re-
                    ~(x, Wi ), a worker return function r
tention probability p                                   ~(x, Wi ), optimal contract
policy functions > = {fii , wi , ei , v1i , v0 , Wi , WixÕ zÕ , W0xÕ zÕ }i=1,2 , a market tightness
function (x, v ) oe R+ , an active aggregate job distribution h(x, z, V ), a mass of
unemployed workers µ(x) over types x, and a mass of vacancies ,,(x, v ) across
submarkets (x, v ), such that:
 (a) J (x, z, V ), (x, V ), and U (x) satisfy BE-F, BE-V and BE-U for all (x, z, V ),
      ~(x, Wi (x, z, V )) and r
  (b) p                       ~(x, Wi (x, z, V )) satisfy EQ-W for all (x, z, V ),
  (c) > contains the associated policy functions,
 (d) (x, v ) and ,,(x, v ) satisfy the free entry condition EQ1 for all (x, v ),
  (e) h(x, z, V ) is generated by ,,(x, v ), µ(x) and > as in EQ2, and
  (f) µ(x) and ,,(x, v ) clear the market in accordance with EQ3 and EQ4.

    In equilibrium, neither workers nor firms have an incentive to deviate from
their contracts. Solving for an equilibrium, which involves large-dimensional
distributions of workers over employment states and queues, is generally very
di cult. The approach we adopt relies on the properties of equilibrium, es-

                                                 16
pecially the fact that the unique tightness function (x, v ) is not a function
of the aggregate state of the economy.6 Intuitively, since the labor market is
divided into submarkets, the tightness in each submarket does not depend on
the distribution of workers over other submarkets. As a result, given (x, v )
in a specific submarket, a worker who queues in that submarket has a proba-
bility of finding a job that is independent of other markets. Consequently, a
worker's return from searching and retention probability are independent of the
distribution and hence the firm problem is distribution-free, i.e. the Bellman
equations do not include h(x, z, V ) as an additional state. This allows for a
two-step computational procedure. In a first step, one can solve for the value
functions, which depend only on (x, z, V ); and in a second step, simulate them
in order to recover the associated distributions.
        The separation of expected profits from aggregate distributions also ensures
the tractability of block recursive equilibria (Menzio and Shi (2010)). Building
on the work of these authors and of Tsuyuhara (2016), we can formally prove
the existence of equilibrium.

Proposition 1 (Existence of Equilibrium). There exists a recursive search equi-
librium, in which the expected profit function J (x, z, V ) is continuously di er-
entiable as well as strictly decreasing and concave with respect to V .

Proof. See Appendix A1.1.


3         Contract characterization
3.1         Incentive vs. insurance trade-o
A worker is less likely to leave a firm when she is promised a higher future value.
Intuitively, the worker searches submarkets with a higher v as the expected
future utility in her current job increases. However, submarkets that o er a
    6
        All equilibrium properties are derived in the supplementary Appendix W1.1.


                                               17
higher lifetime value have a lower job finding rate and so the worker is less
likely to find a new match. This is summarized in Lemma 1:

Lemma 1 (Pareto Properties). Given (x, V, Wi ),
(a) v1
     ú
       (x, Wi ) and eú (x, Wi ) are uniquely determined,
    ~(x, Wi ) is continuous, di erentiable a.e. and increasing in Wi ,
(b) p
    ~(x, Wi ) is increasing and di erentiable a.e. in Wi and r
(c) r                                                        ~Õ (x, Wi )=-- p
                                                                            ~(x, Wi ),
(d) expected profits J (x, z, V ) are increasing in match quality z .

Proof. See Appendix A1.2.

   Lemma 1 sheds light on the firm's trade-o between providing dynamic in-
centives and insurance to the worker when choosing promised values and wages.
By increasing future promised values, a firm incentivizes its workers to exert
more e ort, and so increases the probability that each match continues to exist.
Dynamically incentivizing workers thus makes a case for backloading wages, i.e.
for increasing promised values and wages over time. However, higher promised
values also lower a firm's profits and worker risk aversion implies that the cheap-
est way to deliver a given lifetime utility to workers is by keeping the wage
constant over time. This intertemporal insurance motive thus calls for a flat
wage profile and no backloading.
   To understand how firms resolve this trade-o between incentives and insur-
ance, it is useful to analyze how firms decide to compensate workers over time.
The following proposition provides a clear prediction for how wages evolve as a
function of the current state of the match:

Proposition 2 (Optimal Wage Growth). For any current state (x, z, V ), within
each lottery realization i, the following relationship between wage growth and
expected firm profits holds:
                                                                     1            1
          ÷ (x, Wi ) · ExÕ zÕ [J (xÕ , z Õ , WixÕ zÕ )|x, z ] =                          ,   (FOC)
                                                                  uÕ (wi
                                                                       Õ
                                                                         )      uÕ (w)

                                                   18
where ÷ (x, W ) =    ^
                    ^W
                         log p
                             ~(x, W ) > 0 is the derivative of the log probability of
retention with respect to the future value promised to the worker W , w is the
current wage and wi
                  Õ
                    is next period's wage in lottery realization i.

Proof. See Appendix A1.2.

   The optimal balance between insurance and incentive motives ties together
all the features of the model and the FOC allows us to uncover where each
of the features enters. For instance, the right hand side only involves worker
preferences and reveals how much the worker likes intertemporal wage smooth-
ing. The left hand side reflects the presence of search frictions and decisions
about how much e ort to exert, as captured by ÷ (x, W ). One can also directly
observe that the optimal contract exhibits full insurance across future states
as (xÕ , z Õ ) drop out of the FOC. The intertemporal dimension of insurance thus
competes against incentives when optimally setting wage contracts. The benefit
of intertemporal insurance (the right hand side) grows with the amount of risk
aversion, and since the curvature of utility typically decreases in consumption
levels, is higher at low wages. The extent of insurance o ered by the optimal
contract thus depends endogenously on where the worker is in the wage and
value distribution. The flip side of smoothing wages is that it lowers the returns
to dynamic incentives, as measured by the left hand side. The term ÷ (x, W )
shows how elastic the retention probability is with respect to future promised
values W . E ort contributes to this term through the endogenous job destruc-
tion probability " (eú (x, W )), and search frictions enter through the optimal job
finding rate p((x, v1
                    ú
                      (x, W ))). While we know that in equilibrium e ort is in-
creasing in W and job finding rates are decreasing in W , this does not allow
a conclusion about how ÷ (x, W ) changes with W . The answer depends on the
second derivative of the retention probability p
                                               ~(x, W ). The qualitative e ect of
changes in W on the level of insurance therefore remains ambiguous despite the


                                          19
fact that expected profits decrease in W . However, in the limit without search
frictions and e ort decisions, ÷ (x, W ) goes to zero because the endogenous sep-
aration probability becomes insensitive to local changes in W . As a result, the
model approaches a full insurance economy and the incentive constraint starts
resembling a participation constraint, creating a discontinuity where it binds.
This means that absent the incentive issues due to search and e ort decisions,
workers enjoy complete wage smoothing until a better outside option arrives.
   The proposition also reveals that the worker's wage growth has the same
sign as the expected profit of the firm under the optimal contract. Whenever
the firm expects positive profits, it is optimal to increase wages, and whenever
profits are expected to be negative, it is optimal to lower wages. This means
that across all shock histories, a change in wages is positive if and only if the
expected profit for the firm is also positive. This optimal strategy sacrifices
some of the worker's utility, since she prefers flat wages, for a higher probability
of keeping the match alive. Intuitively, inducing less separation is a way for the
firm to benefit longer from a profitable match in a context with workers who
value only their own share of the match surplus.
   The trade-o between insurance and incentives is thus solved by wage back-
loading when the firm expects positive profits. To formalize this argument
further, we define:

Definition 3. The target wage wú (x, z ) given (x, z ) is defined as the wage as-
sociated with the promised value W ú (x, z ) for which M (x, z, W ú (x, z ))=0, where


                   M (x, z, W ) = max ExÕ zÕ [J (xÕ , z Õ , WxÕ zÕ )|x, z ]
                                     WxÕ zÕ

                              s.t W = ExÕ zÕ [WxÕ zÕ |x, z ],




                                              20
and, with Wx Õ z Õ (x, z ) denoting the argmax of M (x, z, W (x, z )), is equal to:
           ú                                                ú

                                         A                         B
                                    Õ1              1
                    w (x, z ) = u
                      ú
                                          Õ Õ Õ                       .
                                         J (x , z , Wxú
                                                       Õ z Õ (x, z ))


   The target wage captures the wage level at which expected firm profits are
zero and the worker collects the entire value of the match. The optimal contract
can be further characterized using this target wage.

Proposition 3 (Target Wage Tracking). For each viable match (x, z ) there
exists a unique target wage wú (x, z ), which is increasing in z . The wage specified
in the optimal contract tracks this target wage for each lottery realization i:

           w Æ wú (x, z )  w Æ wi
                                Õ
                                  Æ wú (x, z ) incentive to stay,

           w Ø wú (x, z )  wú (x, z ) Æ wi
                                         Õ
                                           Æw             incentive to leave.

Proof. See Appendix A1.2.

   At any state (x, z, V ), the wage adjusts towards wú (x, z ). If the current
wage w is below the target wage, the firm will increase wages in the following
period, but not so much as to exceed wú (x, z ). The prospective wage increase
induces the worker to exert more e ort to retain her job, leading to a higher
level of insurance against job loss. Since the wage will grow, the higher level
of job loss insurance is achieved at the expense of having less than full wage
insurance. Conversely, if the firm currently pays more than wú (x, z ), it lowers
future wages towards the target wage and reduces the probability of retaining
the employee. Here, the firm provides less wage insurance by allowing the wage
to fall and at the same time less insurance against job loss by incentivizing
lower levels of e ort. Hence, wage insurance and job loss insurance go in the
same or opposite directions depending on the current wage level relative to
the target wage. Finally, the wage stays constant when w=wú (x, z ) because
the left hand side of the FOC is zero. Intuitively, since the worker collects
the entire value of the match, her incentives are aligned with the firm and the

                                             21
incentive problem vanishes. Only the insurance motive prevails and the contract
prescribes constant wages.

3.2    Backloading
Propositions 2 and 3 amount to a formal backloading result at the time of hiring.
Although the firm is able to commit, it chooses to "tilt" the wage profile instead
of setting a perfectly flat consumption path for the worker even in the absence
of shocks. This is optimal because the worker makes e ort and search decisions
e and v that a ect the probability that the match continues to exist. When
some of the match surplus goes to the firm, the worker does not internalize the
full future value of the match when making these decisions (unless she is at
wú (x, z )). It is then optimal for the firm to frontload some profits and backload
wages. Importantly, this happens every time a new match forms due to the free
entry condition. At that moment, expected profits must be positive to recover
vacancy costs and so wages increase in accordance with Proposition 2. The
model thus exhibits, on average, an increasing wage profile after every new hire,
irrespective of the possibility of wage decreases later on.
   Backloading is a well-known property of long-term contracts with lack of
commitment on the worker side. Stevens (2004) demonstrated this property in
a search environment with risk-neutral agents and a minimum wage constraint.
In our paper, workers are risk-averse and so the contract must optimally balance
the incentive problem with the desire for consumption smoothing as shown in
Burdett and Coles (2003), Shi (2009) and Tsuyuhara (2016).
   Another property that hinges on backloading is that workers can experience
wage cuts during value-enhancing moves to other firms even if their own pro-
ductivity is unchanged. As in Postel-Vinay and Robin (2002), skill losses are
not necessary to rationalize the empirically prevalent wage cuts after job tran-
sitions, because higher promised values can be delivered through backloaded


                                        22
wages. The heterogeneity in match quality z is crucial for this property to arise
in our setup. In the absence of shocks, as for instance in Shi (2009), Tsuyuhara
(2016) or Burdett and Coles (2003), wages would not go down during J2J tran-
sitions. Homogeneous firms share the same profit function, whose concavity in
the promised value would dictate that the higher value of the new job must be
associated with a higher wage.
       Since the firm can only imperfectly monitor the worker's actions, the firm
faces an incentive constraint, capturing that the worker chooses a specific hidden
action only when appropriately incentivized.7 Here, the worker's e ort and
search decisions a ect the duration of the match and the availability of outside
options. The common role of e ort and search in the incentive problem for the
firm is emphasized by the fact that they enter the retention probability p
                                                                         ~(x, Wi )
together. These two hidden actions have been studied separately in Menzio and
Shi (2010), where directed search is unobservable by the firm, and in Tsuyuhara
(2016), where e ort a ects the job finding probability. However, we believe
this paper is the first to combine the two in a study looking at the dynamic
transmission of shocks to wages under the optimal contract. We turn to these
dynamics next.

3.3       Transmission of productivity shocks
Proposition 3 reveals that the realized wage smoothly tracks the reference wage
wú (x, z ), which depends on productivity x and is increasing in match quality
z . This implies that wages respond to both positive and negative productivity
shocks, from both the firm and worker side. To better illustrate the rich features
of this wage setting, Figure 2 draws the qualitative wage path under di erent
contract arrangements in response to positive and negative worker- and firm-
level shocks. The solid red line shows the wage dynamics under the optimal
   7
   This incentive problem resembles the principal-agent problem outlined in Rogerson (1985)
where a risk-averse worker chooses a hidden e ort level.


                                            23
                      Figure 2: Wages and productivity shocks
                w                        w


                          x                                   z



                                           t                                   t
                    (a) positive x shock                (b) positive z shock

                w                                   w



                          x                                   z

                                           t                                   t
                    (c) negative x shock                (d) negative z shock

     Notes: This figure plots wages under di erent contracting environments in re-
     sponse to productivity shocks. The dash-dotted green line represents a two-sided
     commitment contract, the dashed blue line shows firm commitment without im-
     perfect monitoring, and the solid red line captures firm commitment and incen-
     tive issues. The dotted black lines depict the productivities.



contract in this paper, where one-sided lack of commitment and moral hazard
act as the two key drivers. For comparison, we plot the wage dynamics under the
optimal contract against the wage dynamics with these two elements removed.
The dashed blue line depicts a similar one-sided limited commitment model but
without a monitoring problem, and the dash-dotted green line represents a full
commitment contract that also lacks hidden actions.

Commitment. To understand the di erences between contract arrangements,
it is useful to analyze the commitment problem separately from the moral hazard
issue. With regard to the former, the di erences between the dash-dotted green
line and the dashed blue line are exclusively due to di erent assumptions on
worker commitment. While risk-neutral firms can commit to insure risk-averse


                                               24
workers in both environments, the worker is free to choose a better outside
option only in the model depicted by the dashed blue line.
   In the presence of full commitment, firms optimally insure workers against
all shocks, resulting in flat dash-dotted green lines in all cases. As in Menzio and
Shi (2011), the equilibrium is e cient and retains the social planner's allocation
in response to shocks. Despite fluctuations in x, the firm pays the same wage to
the worker. The worker commits not to quit at high x, while the firm commits
to not dissolve the match at low x. However, when quality z falls, the best
way to achieve insurance is through dissolving the match and letting the worker
start a new job. Separation, indicated by a circle in Figure 2d, benefits both
employers and workers who are able to form new, higher quality z0 matches.
This is in line with Azariadis (1975) who finds that enforceable contracts can
lead to an equilibrium in which fluctuations in wages are eliminated but job
changes occur.
   If instead only the firm is able commit to a contract, the worker cannot
commit to ignoring better spot market o ers. A positive x shock then improves
the worker's outside options, resulting in an immediate pay raise. This is repre-
sented by a jump in the dashed blue line following a positive x shock in Figure
2a. In contrast, a negative x shock is fully absorbed by the employer who has
committed to an unresponsive wage ex-ante as part of the optimal contract.
Since outside o ers are worse, the worker's participation constraint is slack and
the match continues, as in Harris and Holmstrom (1982). Despite being absent
in Harris and Holmstrom (1982), one can extend the one-sided commitment
framework with firm-specific shocks to match quality z . A positive z shock
exclusively a ects the existing match but is inconsequential for wages at other
jobs with the same x, so neither employment relationships nor wages change.
Finally, when match productivity falls below z0 , the worker moves to another
firm where she receives the same compensation as before.


                                        25
   Therefore, commitment plays a crucial role in shaping wage dynamics. As
soon as workers cannot commit to forgo better outside options, the firm stops
o ering full insurance, which di ers from the two-sided commitment case. Two
further insights become apparent when considering one-sided commitment. First,
the fact that in Harris and Holmstrom (1982) wages increase but never decrease
might suggest that one-sided commitment generally implies downward wage
rigidity. However, a simultaneous drop in x and z can indeed generate a wage
decline. If it becomes too expensive for the current firm to perfectly insure
an unproductive worker in a low quality match, the firm will cut the wage or
induce separation. If the worker moves to a new firm, the match quality will be
higher but the new employer will set a lower spot wage due to the worker's lower
productivity. Therefore, a combination of negative z and x shock can trigger
a wage decline, even when firms exhibit the ability to commit. The downward
wage rigidity in Harris and Holmstrom (1982) is precipitated by the assumption
that all jobs are identical, while heterogeneity in jobs in our setup allows for
decreasing wage paths. Second, it is ine cient to sustain any match with a
quality below z0 if new matches can be formed in frictionless markets. Without
separation, the opportunity for higher quality in new matches remains unused
by the firm and the worker. However, the worker may not move if she has worse
outside options from a simultaneous x drop. The firm is then stuck with a low x
worker in a low z match. In this case, a social planner would prefer to terminate
the employment relationship to avoid the dead-weight loss of z < z0 associated
with ine cient immobility.

Imperfect monitoring. We consider imperfect monitoring, which accounts
for the di erences between the dashed blue line and the solid red line in Figure
2. Both the blue and red lines represent situations with one-sided commitment,
i.e. firms can commit to dynamic contracts whereas workers cannot, but only
the solid red line includes a hidden action dimension. Here, we consider unob-

                                       26
servable e ort and search decisions that a ect the likelihood of separation. This
comparison reveals two core findings. First, hidden actions make wages respon-
sive to both positive and negative shifts in expected profits. In contrast, without
moral hazard wages only respond to positive x shocks. Second, conditional on
a wage change, the imperfect monitoring model exhibits much smoother wage
adjustments.
   The responsiveness of wages to all shocks (solid red line) is consistent with
the FOC. For instance, in the presence of imperfect monitoring, adverse shocks
to z lead to two ine ciencies absent a wage drop. The worker exerts too much
e ort to keep the less productive match alive, but also searches markets with
too high lifetime utility, simply because she does not internalize the reduction
in joint surplus. To counteract these ine ciencies, the firm lowers the wage
(Figure 2d). The reverse holds true when the worker does not fully internal-
ize the benefits of continuing a high z match. In this situation, the firm adds
incentives to maintain the match by increasing wages, whereas in a world with-
out monitoring problem search and e ort would be dictated and wages would
remain constant (Figure 2b). A similar argument holds when firm profits are
a ected by x shocks (Figure 2a and Figure 2c).
   Di erences in the smoothness of wage adjustments in Figure 2a are rooted
in how a worker is retained over time. In the blue dashed case, an increase in
productivity x increases the worker's outside options, which the firm must match
immediately to keep the worker, resulting in a wage jump. With imperfect
monitoring, the firm backloads payments to increase the likelihood of retaining
the worker, as established above. This happens smoothly due to the worker's
risk aversion, and so wages increase more slowly in the model represented by
the red solid line. The gradual passthrough hinges on the incentive structure
and probabilistic nature of separation, and hence on the presence of search
frictions, but is not limited to directed search. Random search, as in Burdett


                                        27
and Coles (2003), also produces smooth wage adjustments because the worker's
reservation wage in light of non-contractible outside o ers is unobserved.
    From a technical point of view, the worker's participation constraint in the
model represented by the dashed blue line is replaced by an incentive constraint
in the case of the red solid line. Under a participation constraint, a better
outside option can be obtained with certainty, so the firm must lift the wage in-
stantly or the worker leaves. In contrast, with an incentive constraint, obtaining
the outside option is probabilistic and mobility frictions allow for a slow wage
increase. Of course, one can reinterpret a participation constraint as a stark
incentive problem. The key is then to restrict the incentive problem to always
bind at a corner solution where the worker either leaves or stays with certainty.
    One may wonder why a firm would choose to lower wages smoothly in bad
times rather than fully renegotiating them as in Thomas and Worrall (1988).
This is because it is optimal for a firm to use its commitment power to promise
insurance to a worker at the time of hiring. The fact that after a bad shock a
firm is ex-post bound to the contract does not mean that commitment is ex-ante
undesirable; to the contrary, the firm benefits from its commitment ability. The
wage goes down in Thomas and Worrall (1988) because the firm participation
constraint binds, whereas we allow the firm to optimize without this additional
constraint, which results in an ex-ante preferable outcome.


4     Estimating the contracting model
There are two important challenges when taking the model to the data. The
first di culty concerns identification. Individual productivity is not directly ob-
servable, and the way it translates into earnings and labor participation is highly
non-linear. The second obstacle is tractability. Solving directly for promised
utilities in each future state is infeasible.

Non-parametric identification. We provide su cient conditions for the

                                          28
identification of the production function f (·) and the productivity processes
for x and z using a five-year panel dataset on workers' and coworkers' earn-
ings and participation. We assume the preference functions u(·) and c(·) are
known.8 First, we show that the independence between coworker trajectories
after conditioning on firm-level productivity histories allows us to isolate firm
shocks from worker shocks. Next, we use the Markovian properties of the opti-
mal contract to identify the wage and participation process conditional on the
latent variables x and z , drawing on the identification result for hidden Markov
chains in Hu and Shum (2012). Finally, we show that the present value of the
worker, the firm profit function, and the production function can be recovered
from the conditional choice probabilities together with the Bellman equation.

Tractability. Solving BE-F directly would require optimizing over the promised
utilities WixÕ zÕ for every (x, z, V ) in each future state of the world (xÕ , z Õ ). This
becomes unmanageable as soon as reasonable supports for X and Z are consid-
ered. However, the first order condition with respect to WizÕ xÕ reveals that the
promised utilities at di erent future states are chosen optimally by the firm in
order to equalize marginal utilities across those states. The solution can thus
be characterized by a single promised marginal utility. In Appendix A1.3, we
rewrite the contracting problem recursively using marginal utilities9 and rely on
this formulation in the numerical implementation.

4.1     Model specification
Each period corresponds to one quarter and the discount factor -- =0.987 is set
to match an annual interest rate of 5%. For the estimation, we use the utility
                   w1 1
function u(w) =     1 
                        ,   where the parameter of constant relative risk aversion
   8
    Supplementary Appendix W2 includes the formal results.
   9
    This is known as the recursive Lagrangian approach developed by Kocherlakota (1996),
Marcet and Marimon (2019), Messner, Pavoni, and Sleet (2012) and Cole and Kubler (2012).
Farhi and Werning (2013) uses promised marginal utility directly.



                                           29
is set to a standard value  =1.5. These values are taken from Low, Meghir, and
Pistaferri (2010). Work e ort controls separation through " (e)=1e and incurs
utility cost
                            "0                 "0         1 "1
                 c(e) =         + "0 (1  e)       1 (1  e)
                                                             1,
                          "1  1              1  "1

where the condition c(0)=0 is satisfied at any values of ("0 , "1 ). The flow value
of being unemployed is set to u(b) for a fixed b.
   Let worker productivity x be characterized by two subcomponents: one per-
manent x0 and one persistent x1 . The sets of values for these subcomponents,
as well as for match quality z , are drawn from discretized log normal distribu-
tions with a log mean of zero and log variances x
                                                2
                                                  0
                                                    , x
                                                      2
                                                        1
                                                          and z
                                                              2
                                                                , respectively.
We set the initial match quality to its median value z0 =1. Since x0 is fixed,
the transition matrix for x is block-diagonal such that each block includes the
transition probabilities for x1 . With a reset probability (1/x ), productivity
x1 is redrawn uniformly from its prior distribution, independently of previous
levels of x1 . Otherwise, with probability /x , x1 persists. The transition matrix
of z follows a similar Markov structure with persistence parameter /z . This
determines the law of motion for match quality, z Õ = g (z, < ), where g (z, < ) is
the conditional quantile function of the transition matrix and < is the firm-level
shock. The function g (z, < ) is monotonic by construction and implicitly assumes
a uniform distribution of firm shocks < that allows for correlated match qualities
at the firm level. It does not, however, imply that all workers at one firm have
the same z , even if they share the same shocks < .
   The output of a match is given by f (x0 , x1 , z ) = a·x0 ·x1 ·z , where total factor
productivity a is normalized such that average utility is one. We employ the
                                           1
matching function q () = [­Ï /(­Ï + Ï )] Ï and estimate the model in equilibrium
such that the job finding rate of workers is derived from the free entry condition
EQ1. We use a common estimate of the curvature Ï=0.8, normalize the vacancy


                                          30
cost to k =1, and estimate the matching e ciency ­ oe (0, 1). Alternatively, one
could fix ­ and estimate the vacancy cost k . Finally, we also estimate the
on-the-job search e ciency Y.
    We use a measure of value added per worker at the firm level.10 To re-
main consistent with the theory, we use a constant-returns-to-scale produc-
tion function when aggregating match outputs. We sum across workers over
four consecutive quarters and construct annualized earnings wa , match out-
put f a and value added per worker y a to match the frequency of value added
and earnings in the data. Finally, we add measurement error to log earn-
ings and to log value added per worker, with respective standard deviations
mw and my . In total, this specification requires estimating the parameter set
Ë = {"0 , "1 , b, x0 , x1 , z , /x , /z , ­, Y, mw , my }.

4.2      Data
The sample is built on employer-employee matched data prepared in Friedrich,
Laun, Meghir, and Pistaferri (2019), which links three Swedish administrative
data sets: the Longitudinal Database on Education, Income and Employment
(LOUISE), which provides data on demographic and socioeconomic variables for
the entire working age population; the Register-Based Labor Market Statistics
(RAMS), which tracks worker earnings and employment spells and includes
firm identifiers; and the Structural Business Statistics (SBS), which includes a
measure of value added and employment size for each firm and year.
    We use five consecutive years (2001 to 2006) for our analysis. We adjust
monetary variables for inflation. On the worker side, all self-employed individ-
uals are removed from the sample. To abstract from labor supply decisions on
the extensive margin, we focus on males between 25 and 50 years of age, which
  10
     Since firms are ex-ante identical, vacancy costs are homogeneous and the equilibrium is
symmetric, the model is less suitable for mapping the firm size distribution directly into the
data. Therefore, we focus on value added per worker in the estimation.



                                                31
removes the labor participation decisions of females during child-bearing years
and decisions related to retirement. However, we include active and non-active
job seekers in order to account for mobility in and out of work. We limit the em-
ployer side to firms with a positive value added. Still, our final sample includes
almost 1.2 million unique workers and over 70, 000 unique firms. Appendix A2
provides further details on the data sources and sample construction.

4.3    Moments of interest
To capture the level of risk sharing between firms and workers together with
transition dynamics in the labor market, we select three sets of moments to be
matched: transition probabilities, individual earnings dynamics and moments
relating firm output to both worker earnings and mobility.
   First, using information on monthly spell data, we follow Friedrich, Laun,
Meghir, and Pistaferri (2019) and construct quarterly transition probabilities of
starting a job (U2E), losing a job (E2U) and changing jobs (J2J). As reported
in Table 1, the numbers we obtain are 0.17 for U2E, 0.022 for E2U and 0.026
for J2J rates. The J2J probability is notably lower than in the US and other
comparable European countries.
   Second, we generate moments of individual earnings dynamics. Yearly earn-
ings data may imprecisely measure the duration of partial employment spells
within the year. To alleviate this concern, we only use observations that report
12 months of work. In this group, the overall variance of log earnings in the
data is 0.14. Earnings grow by 2.5% on average for all fully employed workers
over two consecutive years, and have a variance of 0.025. We extract the au-
tocovariance of log earnings growth from the data at 0.007. Job switchers --
individuals who are fully employed in one year, switch in a second year to a new
employer and continue working there for the entire third year -- experience an
average wage growth of 6.4% over these two years. This is over two times the


                                       32
                                              Table 1: Moments and model fit
                                                                                  data       model
            P rU2E                                                                 0.17       0.16
                                                                                 (0.00035)
            P rJ2J                                                                0.026      0.026
                                                                                 (4.1e-05)
            P rE2U                                                                0.022      0.020
                         Ë                    È                                  (4.4e-05)
            VarS E log wit                                                         0.14       0.15
                     Ë                         È                                 (0.00031)
            ES EE                log wit                                          0.025      0.028
                             Ë                     È                             (0.00010)
            VarS EE                  log wit                                      0.025      0.024
                                 Ë                                       È       (0.00012)
            CovS EEE                      log wit ,     log wit1                 -0.0068     -0.0083
                     Ë                                     È                     (6.4e-05)
            ES J2J log wit  log wit2                                              0.064      0.061
                 Ë                        È            Ë             È           (0.00055)
            ES E log wit  ES U2E log wit                                           0.55       0.50
                                     Ë                                       È   (0.0038)
            CovS UEUE log wi,·i (1) , log wi,·i (2)                               0.092      0.090
                             Ë                     È                             (0.00035)
            VarS EE                  log yit                                      0.098      0.091
                                 Ë                                   È           (0.0070)
            CovS EEE                      log yit ,    log yit1                   -0.034     -0.036
                             Ë                                   È               (0.0026)
            CovS EE                      log wit ,     log yit                   0.00099     0.0010
                             Ë                                               È   (0.00013)
            CovS EE                      log(1  p
                                                ~it ),         log yit            -0.013     -0.014
                                                                                 (0.0040)

     Notes: Transition probabilities are quarterly, all other quantities are at the
     yearly level. Subscripts S capture di erent sets of observations for the corre-
     sponding empirical averages. Standard errors are computed using bootstrap.
     See the supplementary Appendix W3.2 for a full description.



average gain, suggesting a positive earnings return associated with job transi-
tions. To estimate the next two moments, we use unemployment spells. The
first moment relates to the mean-to-minimum wage ratio of Hornstein, Krusell,
and Violante (2011) and captures the log di erence between the average yearly
earnings in the entire economy and the average yearly earnings for hires coming


                                                                 33
out of unemployment. This gap is 0.55, meaning that the average wage is about
twice what new hires earn. The second moment is the within-individual covari-
ance of earnings for workers coming out of unemployment twice, an indicator
of their persistent heterogeneity. At 0.092, this covariance is higher than half of
the overall variance in earnings, suggesting a strong role for persistent worker
heterogeneity in the data.
       The final set of moments links firm performance to earnings dynamics and
mobility. To start, we retrieve the growth of log value added per worker at
the firm level. The cross-sectional growth variance is 0.1, while the first order
autocovariance is 0.034. The covariance between the growth rates of value
added per worker and the earnings of those who stay with the firm is 0.001.
This speaks to one of the core theoretical findings from the analysis of the
model: wages move with the performance of the firm.11 Finally, to understand
how firm performance a ects the transition probabilities of workers, we include
a moment that captures how worker retention varies with output. To this end,
we compute the covariance between changes in the log probability of workers
leaving the firm and the log value added per worker. We find a value of 0.013,
indicating that when firm performance goes up workers are less likely to leave
the firm. In total, there are 12 parameters to estimate in order to match 14
moments in the data.

4.4       Model fit
We estimate the model via indirect inference.12 The model fit is good, as shown
in Table 1. All three transition probabilities are matched well. Although the
model gives a central role to insurance, it can generate a large variance in log
  11
     Assuming a unit root process with i.i.d. measurement error, one can combine these
three moments to compute a passthrough measure of permanent shocks. This results in a
passthrough value of 4.5% which is in keeping with 7.8% in Guiso, Pistaferri, and Schivardi
(2005), see Appendix A3.2.
  12
     See supplementary Appendix W4 for the estimation procedure as well as a sensitivity
analysis following Andrews, Gentzkow, and Shapiro (2017).


                                            34
earnings with a small autocovariance of wage growth, as in the data. The fit
of the wage growth variance is also good. Average earnings growth is slightly
overstated unconditionally and slightly understated conditional on J2J moves
and U2E transitions. Overall, the model captures the earnings process well,
including the joint process of firm performance and worker earnings. With
respect to firm performance, the total variance of permanent value added growth
is estimated to lie within the standard deviation, and its lagged covariance and
covariance with wage growth come close to the data. Lastly, value added growth
covaries with changes in separation probabilities similarly in both the model and
the data.
    The corresponding parameter values are presented in Table 2. Worker pro-
ductivity and match quality are highly persistent with parameter estimates at
0.91 and 0.95, respectively. They are also very dispersed, especially compared to
the permanent worker productivity x0 , allowing for large cross-sectional produc-
tivity di erences. Utility costs of e ort increase fast with a curvature parameter
of 0.37. The match e ciency parameter is 0.19, and workers search about 47%
less e ciently on the job than when unemployed. Finally, the measurement
errors on earnings and value added are around 0.20.


5     Results analysis
5.1    Understanding the optimal contract

Impulse response analysis. We report the impulse responses in the model
to permanent positive and negative innovation shocks to x and z , scaled to
generate a 10% output change. In practice, we simulate the histories of a cross-
section of matches, and compare a treatment group that receives the permanent
productivity shock with a control group that does not. Figures 3 and 4 report
the di erences in variables of interest between the control and treatment groups


                                       35
                           Table 2: Parameter estimates
      persistence for worker productivity                   /x       0.91
                                                                   (1.8e-05)
      persistence for match quality                         /z       0.95
                                                                   (4.3e-06)
      dispersion for worker permanent productivity          x0       0.33
                                                                   (5.2e-05)
      dispersion for worker transitory productivity         x1       0.70
                                                                   (0.00023)
      dispersion for match quality                          z        0.49
                                                                   (0.00018)
      e ort cost parameter                                  "0     0.00064
                                                                   (1.6e-07)
      e ort cost curvature                                  "1       0.37
                                                                   (3.8e-05)
      flow payment while unemployed                         b        0.11
                                                                   (5.4e-05)
      e ciency of the matching function                     ­        0.19
                                                                   (8.2e-06)
      on-the-job search e ciency                            Y        0.53
                                                                   (8.7e-05)
      measurement error on earnings                         mw       0.20
                                                                   (0.00088)
      measurement error on value added per worker my                 0.19
                                                                   (4.0e-05)

     Notes: Standard errors in brackets are computed according to the asymptotic
     variance formula derived in supplementary Appendix W4.4.



around the event at time 0.
   After a positive shock to worker productivity x, output and the target wage
immediately jump upward by 10 and 5%, respectively (see solid blue lines in
Figure 3). At the same time, the plot shows how the positive responses in
earnings and promised value are delayed, conforming with the theoretical re-
sult of wage smoothing in the optimal contract. This means that during the
transition towards the new target wage, the worker is underpaid relative to her
productivity, and so work e ort goes down and labor market search is shifted



                                         36
    Figure 3: Average impulse response to x change at estimated parameters




     Notes: E ect of a positive (solid blue) and negative (dashed red) permanent x
     shock over time (years). Starting (x, z ) values are drawn from the stationary
     distribution. Initial wages are target wages. Separation is ruled out.



towards jobs with higher lifetime utility v . Low e ort and modified search drive
up separation and the worker is more likely to transition into other jobs or (to
a lesser extent) into unemployment. With time, as wages and promised utility
approach their new long-run targets, e ort levels improve and transition rates
fall again. As the wage converges to the target wage, the firm's expected profit
shrinks to zero and hence the worker extracts all the benefit of the positive pro-

                                          37
    Figure 4: Average impulse response to z change at estimated parameters




     Notes: E ect of a positive (solid blue) and negative (dashed red) permanent z
     shock over time (years). Starting (x, z ) values are drawn from the stationary
     distribution. Initial wages are target wages. Separation is ruled out.



ductivity shock. Search is permanently directed towards better jobs reflecting
the permanent nature of the productivity shock.
   Unsurprisingly, a negative x shock triggers adjustments of the opposite sign
(see dashed red lines). However, the simulation reveals crucial asymmetries be-
tween positive and negative shocks, where the latter trigger earnings changes
of smaller magnitude. The asymmetry reflects the fact that the firm provides

                                          38
the worker with partial insurance tailored towards negative x shocks. Specif-
ically, despite a target wage drop of similar magnitude, wages and promised
values decrease much more slowly following a negative shock than a positive
one. The worker has a stronger incentive to keep her relatively well-paid job
and so chooses to exert more e ort, which dampens the di erence in J2J tran-
sitions to about one third relative to the positive shock. At the same time, firm
profits take a bigger hit.
   Figure 4 plots the impulse response functions of a permanent shock to match
quality z . As in the previous graph, when a positive z shock hits, output and the
target wage shoot up on impact. But there are three key di erences compared to
x shocks. First, the target wage reacts more strongly relative to output. Second,
lifetime utility and wages rise more slowly, resulting in larger firm profits for
an extended period. Third, changes in J2J and E2U transition probabilities are
both smaller in magnitude and of opposite sign. The reason for all three points
is that in contrast to x shocks, the productivity boost here is job-specific. This
implies that the employee creates a higher value for the employer. However,
unlike before, the worker's outside options have not changed and so the firm
backloads wage payments longer without increased risk of separation. The e ort
and search decisions respond according to the worker's growing promised value
of the match, lowering separation rates.
   When comparing negative to positive z shocks, all adjustments between
treatment and control groups reverse direction. Moreover, the main di erence
between the two shocks is that the J2J transition rates are about twice as large
in magnitude. This asymmetry captures the fact that separation is used as an
adjustment margin under the optimal contract in response to negative shocks to
match productivity because both the firm and the worker can gain by forming
a new match. Consequently, the firm o ers lower values to its workers, who
in turn reduce their e ort and look for jobs with lower lifetime utility. As a


                                       39
result, separation rates are high when production is low, which is in keeping
with the negative correlation between changes in output and separation in the
data. Since output and separation move in the same direction under x shocks,
z shocks seem to be more important for successfully matching this moment.
   To conclude, we find that the transmission e ects of productivity shocks are
delayed and there is a significant level of backloading of wages. The worker
enjoys partial wage insurance, which insulates her particularly well against neg-
ative x shocks.

First best comparison. We now compare the impulse responses to shocks be-
tween the preceding baseline model and a first best contract, in which firms can
observe the search and e ort decisions of workers. This comparison is useful to
understand how the optimal baseline contract accounts for incentive and com-
mitment problems. For conciseness, we only point out the main di erences here
but we include the full first best responses in Figures A1 and A2 in Appendix
A3.1, together with the solution technique.
   Under the first best contract, wages stay perfectly flat while all other vari-
ables jump immediately to new long-run levels in response to productivity
shocks. Although workers enjoy full wage insurance, their lifetime utility rises
after a positive x or negative z shock through decreases in costly e ort and
applications to higher value jobs, which are also found more easily. Note that
searching markets with higher v does not prevent job-to-job transition rates
from simultaneously rising. This is because the tightness in each (x, v ) submar-
ket is not only determined by v but also by the higher productivity x. Increasing
match qualities z imposes a utility loss on the worker ex-post, in contrast to
the baseline model, although the first best contract delivers a higher value ex-
ante to both firms and workers. In fact, at every value of firm profits J , the
worker achieves a higher expected utility V in the contract without incentive
and commitment problems.

                                       40
                       Table 3: Level variance decompositions
                                     total        x0    x1        z   other
                                               overall
              match output fita
                                      0.31 11% 61% 24%                  5%
              target wage wit
                           úa
                                      0.14 32% 33% 31%                  4%
              earnings wit
                        a
                                      0.14 32% 7% 9%                   53%
                                       within individual,     over time
              match output fita
                                      0.08 0% 18%              6%     2%
              target wage wit
                           úa
                                      0.03 0% 10%              7%     1%
              earnings wit
                        a
                                      0.01 0% 3%               3%     5%
     Notes: Using simulated data from the model, we run linear regressions with
     dummies for each level of (x0 , x1 , z ) and report the variances as percentages of
     the total cross-sectional variances. All terms are annualized, in logs and exclude
     measurement error.



Decomposing earnings variances. To identify the sources of wage uncer-
tainty, we use the model to decompose the variances of earnings and earnings
growth into structural components. We also include match output to quantify
the extent of insurance provided under the optimal contract against di erent
types of shocks.
   In Table 3, we show that the time-varying component of worker heterogene-
ity, x1 , contributes to most (61%) of the variations in annualized match output,
but to only a small part of the variation in earnings (7%). Instead, the largest
contemporaneous contributor (32%) to cross-sectional variations in wages is the
permanent component of worker heterogeneity, x0 . This suggests that firms
provide significant insurance to workers and pass through only a small share of
time-varying worker shocks. The insurance against firm shocks appears smaller
because their variance contribution to earnings (9%) is comparable to that of
x1 shocks, but the latter account for about two and a half times more of the
variance in output.
   Notably, a large part of the earnings variance is not captured by current


                                             41
                         Table 4: Growth variance decompositions
                               Total    U2E/E2U           J2J        x1         z
            Var( log fit
                      a
                         )     0.108         -8.0% -3.6% 78.9% 18.3%
            Var( log wit )
                       a
                               0.005         86.2% 13.9% 40.0% 13.7%
        Notes: Using simulated data from the model, we individually remove transitions
        in and out of employment, J2J transitions, x1 and z shocks, keeping policies >
        fixed. All terms are annualized, in logs and exclude measurement error.



productivity levels, but instead can be attributed to the dispersion created
by the path dependency of the contract, i.e. by di erences in the promised
value V .13 For instance, two workers at the same current (x0 , x1 , z ) may well
have di erent values V and receive di erent wages because they di er in their
employment histories and therefore in how far they are from the common target
wage. We thus also conduct a within-individual variance decomposition over
time. Our results consistently suggest that workers enjoy considerable insurance
against productivity fluctuations, especially against x1 shocks. Shocks to x1
and z have a bigger impact on the variation of the target wage than on actual
earnings, which is indicative of the wage smoothing embedded in the contract.
      Next, we decompose the variances in growth of both yearly output and
earnings into endogenous mobility and exogenous shock components using sim-
ulated data. To quantify the contribution of di erent features of the model,
we remove one element at a time. Table 4 shows the results of this exercise.
Shutting down transitional dynamics associated with moving in and out of em-
ployment lowers the wage variations by 86.2%. For comparison, the reduction
from worker-specific shocks is about half this size (40.0%) and the contribution
from z shocks is even smaller (13.7%). The fact that the terms sum to more
than 100% reflects the presence of interactions between mobility and produc-
tivity shocks. Intuitively, to the extent that negative productivity shocks a ect
 13
      The residual remains large even when including interaction terms between x0 , x1 and z .


                                              42
earnings less than positive shocks, as seen in the impulse response analysis,
a worker who is paid less than the target wage can expect stronger wage ad-
justments in response to changes in wú (x, z ). Combining this observation with
the fact that a worker exiting unemployment tends to start her new job below
wú (x, z ) illustrates how mobility can interact with shocks.
   As in the level decomposition, x1 captures the largest (78.9%) share of the
variation in match output but contributes less to the wage growth variance
(40.0%), reflecting the insurance against time-varying worker shocks embedded
in the contract. Interestingly, J2J transitions a ect the growth variances of
output and wages in opposite directions. While a positive contribution to the
wage growth variance can be expected when considering that moving allows
workers to extract higher wages faster in response to positive x shocks, the
option to separate after adverse z shocks also curtails drops in output. J2J
transitions thus limit the e ects of shocks on production and show up as a
negative contributor to the output growth variance.

Passthrough analysis. Typically, passthrough analyses assess how much of a
persistent and transitory shock to firm output is transmitted to worker earnings.
We extend this definition to account for three di culties. First, the passthrough
in our setup needs to consider a shock with a given level of persistence, rather
than purely transitory or fully permanent shocks. In order to capture the full
e ect of a given shock, we thus evaluate its impact on match output and on
worker outcomes in terms of expected present values (EPV). And to study
both worker and firm shocks we use match output rather than an aggregate
measure such as value added. Second, a shock in our model alters the incentive
structure and hence job transitions -- its overall e ect is no longer limited to a
single firm-worker relationship. We thus compute the EPV of wages and output
both for the case where workers and employers are forced to stay together, as
well as for the case where workers can choose to move to new employers or into

                                        43
                            Table 5: Passthrough analysis
                                     mobility          x1 shock z shock
            utility passthrough      outcome only        0.27        0.11
                                     yes                 0.25        0.18
            wage passthrough         yes                 0.33        0.42
                                     no                  0.24        0.67
      Notes: Passthroughs are computed as the elasticity of the discounted present
      value of worker outcomes with respect to match output. Mobility is removed in
      row 4 for wages, and in rows 1 and 4 for productivity. See Appendix A3.2.



unemployment. Third, one can go beyond focusing on wages and instead look at
the impacts on the total lifetime utility of the worker, which accounts for e ort
and risk aversion. We therefore contrast the wage passthrough, based on the
present discounted value of wages, with a utility passthrough, computed as the
change in the constant consumption equivalent of the worker's promised value
with and without the shock. We compute passthroughs as an elasticity at the
individual level and average over the stationary distribution. In Appendix A3.2,
we show how this approach can map onto previous definitions of passthrough
in the literature.
   The results of our passthrough analysis are presented in Table 5. In our
preferred specification (row 1), we report the passthrough of an innovation shock
in x1 and z to a worker's total lifetime utility and find 0.27 and 0.11, respectively.
In other words, a productivity shock, which raises the EPV of output in a given
firm-worker match by 10%, translates into an increase in the worker's lifetime
utility amounting to a 2.7% and 1.1% higher constant consumption equivalent,
respectively. Here, the worker outcome incorporates the present value of utility,
including wages at future employers. The measure of the shock in terms of
match output is not a ected by the contractual environment or endogenous
mobility and hence is exogenous. This allows us to interpret the passthrough as
reflecting the contractual decision by the firm about how much of an exogenous

                                           44
shock to transmit to the employee. Alternatively, we can allow for labor mobility
in production (row 2), and find similar values (0.25 and 0.18). In order to isolate
how much of the overall utility e ect is due to the changes in wages, we compute
wage passthroughs and find elasticities of 0.33 for worker shocks and 0.42 for
firm shocks (row 3). These measures are very sensitive to the assumption that
no separation occurs, which results in an overstated passthrough value for z
shocks (0.67) and a lower elasticity for x1 shocks (0.24). In conclusion, these
findings suggest a significant amount of shock passthrough. They also show
that both wages and mobility are important components of firm insurance.

5.2    Policy evaluation
The previous results show that while workers are partially insured by their
employers, they still face non-negligible earnings uncertainty. Here, we consider
how a policy maker might attempt to mitigate this uncertainty through tax
policies that alter the level of earnings inequality faced by individuals. For
instance, a government may wish to tax individuals with high incomes in order
to pay transfers to low earners. Such a progressive tax schedule may contribute
to earnings stabilization.
   We analyze the e ect of a revenue-neutral tax policy that redistributes in-
come from high to low wage earners. Budget neutrality respects di erences
in total benefits paid due to changes in the unemployment rate. We follow
Heathcote, Storesletten, and Violante (2014) and parameterize the policy as
wnet =·0 wgross
          ·1
                , pick a set of values for ·1 and solve for the revenue-neutral ·0 in
the estimated model. Lowering ·1 reduces the progressivity of the tax schedule
and dictates a higher ·0 , whereas increasing ·1 has the opposite e ect. In Table
6, we report the e ect of the tax policies ·1 =(0.9, 1.1) on the cross-sectional
variance of annualized earnings and earnings growth, net of measurement error.
The first two columns report the policy e ects on gross and net wages, holding


                                         45
                      Table 6: E ect of revenue-neutral policies
                                      baseline contracts           reoptimized contracts
                                    gross        net              gross             net
  More progressive    V ar(log wa )  0.146 0.117 (19.7%) 0.151 (+3.8%)       0.123 (15.6%)
(·1 = 0.9, ·0 = 1.15) V ar( log wa ) 0.005 0.004 (22.6%) 0.005 (+4.0%)       0.004 (14.3%)
  Less progressive    V ar(log wa )  0.146 0.175 (+19.9%)    0.140 (3.7%) 0.172 (+17.9%)
(·1 = 1.1, ·0 = 0.87) V ar( log wa ) 0.005 0.006 (+15.5%)    0.004 (8.4%) 0.005 (+9.6%)

     Notes: Policies take the form wnet =·0 wgross
                                             ·1
                                                   . Baseline contracts are fixed, while
     reoptimized contracts include equilibrium responses of workers and firms to the
     policy. Percentage changes are relative to the baseline estimation. Outcomes
     are annualized and exclude measurement error.



the decisions of workers and firms fixed. These numbers can be interpreted as
the intended policy e ect. However, labor market contracts are generally free
to change in response to new tax policies. Hence, the last two columns show
the same e ects under full equilibrium reoptimization of contracts.
   We find that if a government redistributes from high to low earners, almost
40% of the protection against variation in earnings growth is undone by a re-
duction in firm-provided insurance. In other words, firm insurance is crowded
out by public insurance. To see this, note that the more progressive policy
achieves a 22.6% reduction in wage growth variation under baseline contracts,
but falls well short of this when allowing for contract reoptimization. The rea-
soning is as follows: firms are aware that the government is providing insurance
to their workers and so they choose to pass on more productivity risk to them.
The new equilibrium contracts thus stipulate higher (+4.0%) pre-tax variation,
which attenuates the e ect of the transfer policy to a 14.3% reduction in wage
growth variance. A less progressive tax policy, due to a higher ·1 , increases
the net wage growth variance (+15.5%) without contract adjustments. Since
this reduces workers' utility, firms counteract the policy by setting less (8.4%)
variable gross wages. But as the firms' remedial actions are incomplete, the
final wage variation is still more volatile (+9.6%) than under the baseline sce-


                                             46
nario. A similar crowding-out e ect of 1020% dampens the policy impact
on wage variances. This exercise demonstrates how, at realistic parameter val-
ues, accounting for firms' decisions to provide insurance can have important
implications for the e ectiveness of government-provided insurance.


6     Conclusion
In this paper, we study di erent sources of earnings uncertainty faced by workers
in the labor market. We develop an equilibrium model with search frictions
and show that the optimal contract between firms and workers prescribes a
wage that smoothly tracks both positive and negative worker and firm shocks,
deviating from the prediction of a perfectly competitive model. We provide
conditions for identification and estimate a parameterized version of the model
using Swedish matched employer-employee data. Our main findings are that
shocks are only partially transmitted to worker earnings and that firms insure
their workers extensively against non-permanent worker shocks. We extend
prior definitions of passthrough in order to incorporate job mobility. Finally,
we show that publicly provided insurance substantially crowds out insurance
provision by firms.
    Future work could extend the current model in several ways. Including sav-
ings, which would allow individuals to self-insure, is an important next step
despite being computationally and theoretically di cult. Other work could
build on the block recursivity of the equilibrium in order to study aggregate
shocks and evaluate the cost of business cycles in an environment with firm in-
surance. Another promising avenue for future work is to include heterogeneity
across firms and examine how the provision of insurance links to firm size by al-
lowing for permanent heterogeneity, amenities at the firm level or heterogeneous
vacancy costs. One could also link the question of passthrough to commonly
found collective agreements in the labor market, such as guaranteed minimum


                                       47
wage increases, limitations to write long-term contracts or common pay compo-
nents. These extensions, which are constraints on the contracting space, could
build on the results developed in this paper.
   Finally, we believe that the insurance framework developed here will be use-
ful for other research agendas where relational long-term contracts and insur-
ance provision, together with search frictions, are important. For example, this
framework may prove useful for those working on relational banking, insurance
markets and repeated buyer-seller transactions.



References
Abowd, J. M., and D. Card (1989): "On the covariance structure of earnings
 and hours changes," Econometrica, 57(2), 411­445.
´
Abrah  ´ m, A., F. Alvarez-Parra, and S. Forstner (2017): "The e ects
       a
  of moral hazard on wage inequality in a frictional labor market," Discussion
  paper.
´
Abrah  ´ m, A., and N. Pavoni (2008): "E cient Allocations with Moral Haz-
       a
  ard and Hidden Borrowing and Lending: A Recursive Formulation," Review
  of Economic Dynamics, 11(4), 781­803.
Abreu, D., D. Pearce, and E. Stacchetti (1986): "Optimal cartel equilib-
 ria with imperfect monitoring," Journal of Economic Theory, 39(1), 251­269.
Altonji, J. G., A. Smith, and I. Vidangos (2013): "Modeling earnings
 dynamics," Econometrica, 81(4), 1395­1454.
Andrews, I., M. Gentzkow, and J. M. Shapiro (2017): "Measuring
 the Sensitivity of Parameter Estimates to Estimation Moments," Quarterly
 Journal of Economics, 132(4), 1553­1592.
Attanasio, O. P., and N. Pavoni (2011): "Risk Sharing in Private Informa-
 tion Models With Asset Accumulation: Explaining the Excess Smoothness of
 Consumption," Econometrica, 79(4), 1027­1068.
Azariadis, C. (1975): "Implicit Contracts and Underemployment Equilibria,"
 Journal of Political Economy, 83(6), 1183­1202.
Bagger, J., F. Fontaine, F. Postel-Vinay, and J.-M. Robin (2014):
 "Tenure, Experience, Human Capital, and Wages: A Tractable Equilibrium

                                      48
  Search Model of Wage Dynamics," American Economic Review, 104(6), 1551­
  96.
Baily, M. N. (1974): "Wages and employment under uncertain demand," The
 Review of Economic Studies, 41(1), 37­50.
Blundell, R., L. Pistaferri, and I. Preston (2008): "Consumption In-
 equality and Partial Insurance," American Economic Review, 98(5), 1887­
 1921.
Burdett, K., and M. Coles (2003): "Equilibrium Wage-Tenure Contracts,"
 Econometrica, 71(5), 1377­1404.
Burdett, K., S. Shi, and R. Wright (2001): "Pricing and Matching with
 Frictions," Journal of Political Economy, 109(5), 1060­1085.
Card, D., A. R. Cardoso, J. Heining, and P. Kline (2018): "Firms
 and labor market inequality: Evidence and some theory," Journal of Labor
 Economics, 36(S1), S13­S70.
Carlsson, M., J. Messina, and O. N. Skans (2016): "Wage adjustment
 and productivity shocks," The Economic Journal, 126(595), 1739­1773.
Chiappori, P., B. Salanie, and J. Valentin (1999): "Early Starters versus
 Late Beginners," Journal of Political Economy, 107(4), 731­760.
Cole, H., and F. Kubler (2012): "Recursive contracts, lotteries and weakly
 concave Pareto sets," Rev. Econ. Dyn., 15(4), 479­500.
Dardanoni, V. (1995): "Income distribution dynamics: monotone Markov
 chains make light work," Soc. Choice Welfare, 12(2), 181­192.
Farhi, E., and I. Werning (2013): "Insurance and taxation over the life
  cycle," Review of Economic Studies, 80(2), 596­635.
Friedrich, B., L. Laun, C. Meghir, and L. Pistaferri (2019): "Earn-
 ings dynamics and firm-level shocks," Discussion paper, National Bureau of
 Economic Research.
Guiso, L., L. Pistaferri, and F. Schivardi (2005): "Insurance within the
 Firm," Journal of Political Economy, 113(5), 1054­1087.
Hall, R. E., and F. S. Mishkin (1980): "The sensitivity of consumption
 to transitory income: estimates from panel data on households," Discussion
 paper, National Bureau of Economic Research.
Harris, M., and B. Holmstrom (1982): "A Theory of Wage Dynamics,"
 The Review of Economic Studies, 49(3), 315­333.

                                    49
Heathcote, J., K. Storesletten, and G. L. Violante (2014): "Con-
 sumption and labor supply with partial insurance: An analytical framework,"
 American Economic Review, 104(7), 2075­2126.
Holmstrom, B., and P. Milgrom (1991): "Multitask Principal-Agent Anal-
 yses: Incentive Contracts, Asset Ownership, and Job Design," Journal of Law,
 Economics, & Organization, 7, 24­52.
Hopenhayn, H. A., and J. P. Nicolini (1997): "Optimal Unemployment
 Insurance," Journal of Political Economy, 105(2), 412­438.
Hornstein, A., P. Krusell, and G. L. Violante (2011): "Frictional wage
 dispersion in search models: A quantitative assessment," American Economic
 Review, 101(7), 2873­98.
Hu, Y., and M. Shum (2012): "Nonparametric identification of dynamic mod-
 els with unobserved state variables," Journal of Econometrics, 171(1), 32­44.
Knight, F. H. (1921): Risk, uncertainty and profit, vol. 31. Houghton Mi in.
Kocherlakota, N. R. (1996): "Implications of E cient Risk Sharing without
 Commitment," The Review of Economic Studies, 63(4), 595­609.
Lemieux, T., W. B. MacLeod, and D. Parent (2009): "Performance pay
  and wage inequality," The Quarterly Journal of Economics, 124(1), 1­49.
Lentz, R. (2013): "Optimal Wage-Tenure Contracts without Search Intensity
  Commitment," Discussion paper, Citeseer.
Lise, J., C. Meghir, and J.-M. Robin (2016): "Matching, sorting and
  wages," Review of Economic Dynamics, 19, 63­87.
Low, H., C. Meghir, and L. Pistaferri (2010): "Wage Risk and Em-
 ployment Risk over the Life Cycle," American Economic Review, 100(4),
 1432­1467.
MacLeod, W. B., and J. M. Malcomson (1989): "Implicit Contracts,
 Incentive Compatibility, and Involuntary Unemployment," Econometrica,
 57(2), 447­480.
MaCurdy, T. E. (1982): "The use of time series processes to model the
 error structure of earnings in a longitudinal data analysis," Journal of
 Econometrics, 18(1), 83­114.
Marcet, A., and R. Marimon (2019): "Recursive contracts," Econometrica,
 87(5), 1589­1631.



                                     50
Meghir, C., and L. Pistaferri (2004): "Income Variance Dynamics and
 Heterogeneity," Econometrica, 72(1), 1­32.
Menzio, G., and S. Shi (2010): "Block recursive equilibria for stochastic
 models of search on the job," Journal of Economic Theory, 145(4), 1453­
 1494.
          (2011): "E cient Search on the Job and the Business Cycle," Journal
  of Political Economy, 119(3), 468­510.
Messner, M., N. Pavoni, and C. Sleet (2012): "Recursive methods for
 incentive problems," Rev. Econ. Dyn., 15(4), 501­525.
Moen, E. R. (1997): "Competitive Search Equilibrium," Journal of Political
 Economy, 105(2), 385­411.
Montgomery, J. D. (1991): "Equilibrium Wage Dispersion and Interindustry
 Wage Di erentials," The Quarterly Journal of Economics, 106(1), 163­179.
Peters, M. (1991): "Ex Ante Price O ers in Matching Games Non-Steady
 States," Econometrica, 59(5), 1425­1454.
Postel-Vinay, F., and J.-M. Robin (2002): "Equilibrium wage dispersion
 with worker and employer heterogeneity," Econometrica, 70(6), 2295­2350.
        (2004): "To match or not to match?: Optimal wage policy with endoge-
  nous worker search intensity," Review of Economic Dynamics, 7(2), 297­330.
Prescott, E. C., and R. M. Townsend (1984): "General competitive anal-
 ysis in an economy with private information," International Economic Review,
 pp. 1­20.
Rogerson, W. P. (1985): "Repeated Moral Hazard," Econometrica, 53(1),
 69­76.
Roys, N. (2016): "Persistence of shocks and the reallocation of labor," Review
 of Economic Dynamics, 22, 109­130.
Rudanko, L. (2009): "Labor market dynamics under long-term wage contract-
 ing," Journal of Monetary Economics, 56(2), 170­183.
Schaal, E. (2017): "Uncertainty and unemployment," Econometrica, 85(6),
  1675­1721.
Shi, S. (2009): "Directed Search for Equilibrium Wage-Tenure Contracts,"
  Econometrica, 77(2), 561­584.




                                     51
Shimer, R. (2005): "The assignment of workers to jobs in an economy with
  coordination frictions," Journal of Political Economy, 113(5), 996­1025.
Spear, S. E., and S. Srivastava (1987): "On Repeated Moral Hazard with
  Discounting," The Review of Economic Studies, 54(4), 599­617.
Stevens, M. (2004): "Wage-tenure contracts in a frictional labour market:
  Firms' strategies for recruitment and retention," The Review of Economic
  Studies, 71(2), 535­551.
Stokey, N. L., R. Lucas, and E. Prescott (1989): "Recursive methods
  in dynamic economics," Cambridge, MA: Harvard University.
Thomas, J., and T. Worrall (1988): "Self-enforcing wage contracts," The
 Review of Economic Studies, 55(4), 541­554.
Tsuyuhara, K. (2016): "Dynamic Contracts with Worker Mobility via Di-
 rected On-the-Job Search," International Economic Review, 57(4), 1405­
 1424.




                                   52
