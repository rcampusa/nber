                                 NBER WORKING PAPER SERIES




            X-CAPM: AN EXTRAPOLATIVE CAPITAL ASSET PRICING MODEL

                                           Nicholas Barberis
                                           Robin Greenwood
                                             Lawrence Jin
                                            Andrei Shleifer

                                         Working Paper 19189
                                 http://www.nber.org/papers/w19189


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                       June 2013




We are grateful to seminar participants at Dartmouth College, the London Business School, the London
School of Economics, Oxford University, the University of Southern California, and Yale University
for useful feedback; and also to Jonathan Ingersoll for many helpful conversations. The views expressed
herein are those of the authors and do not necessarily reflect the views of the National Bureau of Economic
Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2013 by Nicholas Barberis, Robin Greenwood, Lawrence Jin, and Andrei Shleifer. All rights reserved.
Short sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.
X-CAPM: An Extrapolative Capital Asset Pricing Model
Nicholas Barberis, Robin Greenwood, Lawrence Jin, and Andrei Shleifer
NBER Working Paper No. 19189
June 2013
JEL No. G02,G12

                                              ABSTRACT

Survey evidence suggests that many investors form beliefs about future stock market returns by extrapolating
past returns: they expect the stock market to perform well (poorly) in the near future if it performed
well (poorly) in the recent past. Such beliefs are hard to reconcile with existing models of the aggregate
stock market. We study a consumption-based asset pricing model in which some investors form beliefs
about future price changes in the stock market by extrapolating past price changes, while other investors
hold fully rational beliefs. We find that the model captures many features of actual prices and returns,
but is also consistent with the survey evidence on investor expectations. This suggests that the survey
evidence does not need to be seen as an inconvenient obstacle to understanding the stock market; on
the contrary, it is consistent with the facts about prices and returns, and may be the key to understanding
them.


Nicholas Barberis                                    Lawrence Jin
Yale School of Management                            Yale University
135 Prospect Street                                  lawrence.jin@yale.edu
P O Box 208200
New Haven, CT 06520-8200                             Andrei Shleifer
and NBER                                             Department of Economics
nick.barberis@yale.edu                               Harvard University
                                                     Littauer Center M-9
Robin Greenwood                                      Cambridge, MA 02138
Harvard Business School                              and NBER
Baker Library 267                                    ashleifer@harvard.edu
Soldiers Field
Boston, MA 02163
and NBER
rgreenwood@hbs.edu
1. Introduction
         Recent theoretical work on the behavior of aggregate stock market prices has tried
to account for several empirical regularities. These include the excess volatility puzzle of
LeRoy and Porter (1981) and Shiller (1981), the equity premium puzzle of Mehra and
Prescott (1985), the low correlation of stock returns and consumption growth noted by
Hansen and Singleton (1982, 1983), and, most importantly, the evidence on predictability
of stock market returns using the aggregate dividend-price ratio (Campbell and Shiller
1988, Fama and French 1988). Both traditional and behavioral models have tried to
account for this evidence.
         Yet this research has largely neglected another set of relevant data, namely those
on actual investor expectations of stock market returns. As recently summarized by
Greenwood and Shleifer (2013) using data from multiple investor surveys, many
investors hold extrapolative expectations, believing that stock prices will continue rising
after they have previously risen, and falling after they have previous fallen.1 This
evidence is inconsistent with the predictions of many of the models used to account for
the other facts about aggregate stock market prices. Indeed, in most traditional models,
expected returns are low when stock prices are high: in these models, stock prices are
high when investors are less risk averse or perceive less risk. Cochrane (2011) finds the
survey evidence uncomfortable, and recommends discarding it.
         In this paper, we present a new model of aggregate stock market prices which
attempts to both incorporate extrapolative expectations held by a significant subset of
investors, and address the evidence that other models have sought to explain. The model
includes both rational investors and price extrapolators, and examines security prices
when both types are active in the market. Moreover, it is a consumption-based asset
pricing model with infinitely lived consumers optimizing their decisions in light of their
beliefs and market prices. As such, it can be directly compared to some of the existing



1
 Greenwood and Shleifer (2013) analyze data from six different surveys; some are of individual investors,
while others cover institutions. Most of the surveys ask about expectations for the next year’s stock market
performance, but some also include questions about the longer term. The average investor expectations
computed from each of the six surveys are highly correlated with one another and are all extrapolative.
Earlier studies of stock market investor expectations include Vissing-Jorgensen (2004), Amromin and
Sharpe (2008), and Bacchetta, Mertens, and Wincoop (2009).

                                                     2
research. We suggest that our model can reconcile the evidence on expectations with the
evidence on volatility and predictability that has animated recent work in this area.
       Why is a new model needed? As Table 1 indicates, traditional models of financial
markets have been able to address pieces of the existing evidence, but not the data on
expectations. The same holds true for preference-based behavioral finance models, as
well as for the first generation belief-based behavioral models that focused on random
noise traders without imposing a specific structure on beliefs. Several papers listed in
Table 1 have studied extrapolation of fundamentals. However, these models also struggle
to match the survey evidence: after good stock market returns, the investors they describe
expect higher cash flows, but not higher returns. Finally, a small literature, starting with
Cutler, Poterba, and Summers (1990) and DeLong et al. (1990b), focuses on models in
which some investors extrapolate prices. Our goal is to write down a more “modern”
model that includes infinite horizon investors, some of whom are fully rational, who
make optimal consumption decisions given their beliefs, so that the predictions can be
directly compared to those of the more traditional models.
       Our infinite horizon continuous-time economy contains two assets: a risk-free
asset with a fixed return; and a risky asset, the stock market, which is a claim to a stream
of dividends and whose price is determined in equilibrium. There are two types of
traders. Both types maximize expected lifetime consumption utility. They differ only in
their expectations about the future. Traders of the first type, “extrapolators,” believe that
the expected price change of the stock market is a weighted average of past price
changes, where more recent price changes are weighted more heavily. Traders of the
second type, “rational traders,” are fully rational: they know how the extrapolators form
their beliefs and trade accordingly. The model is simple enough to allow for a closed-
form solution.
       We first use the model to understand how extrapolators and rational traders
interact. Suppose that, at time t, there is a positive shock to dividends. The stock market
goes up in response to this good cash-flow news. However, the extrapolators cause the
price jump to be amplified: since their expectations are based on past price changes, the
stock price increase generated by the good cash-flow news leads them to forecast a higher



                                              3
future price change on the stock market; this, in turn, causes them to push the time t stock
price even higher.
       More interesting is rational traders’ response to this development. We find that
the rational traders do not aggressively counteract the overvaluation caused by the
extrapolators. This is because they reason as follows. The rise in the stock market caused
by the good cash-flow news -- and by extrapolators’ reaction to it -- means that, in the
near future, extrapolators will continue to have bullish expectations for the stock market:
after all, their expectations are based on past price changes, which, in our example, are
high. As a consequence, they will continue to exhibit strong demand for the stock market
in the near term. This means that, even though the stock market is overvalued at time t, its
returns in the near future will not be particularly low – they will be bolstered by the
ongoing demand from extrapolators. Recognizing this, the rational traders do not sharply
decrease their demand at time t; they only mildly reduce their demand. Put differently,
they only partially counteract the overpricing caused by the extrapolators.
       Using a combination of formal propositions and numerical simulations, we then
examine our model’s predictions about prices and returns. We find that these predictions
are consistent with several of the key facts about the aggregate market and, in particular,
with the basic fact that when prices are high (low) relative to dividends, the stock market
subsequently performs poorly (well). When good cash-flow news is released, the stock
price in our model jumps up more than it would in an economy made up of rational
investors alone: as described above, the price jump caused by the good cash-flow news
feeds into extrapolators’ expectations, which, in turn, generates an additional price
increase. At this point, the stock market is overvalued and prices are high relative to
dividends. Since, subsequent to the overvaluation, the stock market performs poorly on
average, the level of prices relative to dividends predicts subsequent price changes in our
model, just as it does in actual data. The same mechanism also generates excess volatility
-- stock market prices are more volatile than can be explained by rational forecasts of
future cash flows – as well as negative autocorrelations in price changes at all horizons,
capturing the negative autocorrelations we see at longer horizons in actual data.
       The model also matches some empirical facts that, thus far, have been taken as
evidence for other models. For example, in actual data, surplus consumption, a measure

                                              4
of consumption relative to past consumption, is correlated with the value of the stock
market; moreover, it predicts the market’s subsequent performance. These facts have
been taken as support for habit-based models. However, they also emerge naturally in our
framework.
       Our numerical analysis allows us to quantify the effects described above.
Specifically, we use the survey data studied by Greenwood and Shleifer (2013) and
others to parameterize the functional form of extrapolation in our model. For this
parameterization, we find, for example, that if 50% of investors are extrapolators while
50% are rational traders, the standard deviation of annual price changes is 30% higher
than in an economy consisting of rational traders alone.
       There are aspects of the data that our model does not address. For example, even
though some of the investors in the economy are price extrapolators, the model does not
predict momentum in price changes: the presence of fully rational traders means that
price changes are negatively autocorrelated at all lags. Also, there is no mechanism in our
model, other than high risk aversion, that can generate a large equity premium. And while
the presence of extrapolators reduces the correlation of consumption changes and price
changes, this correlation is still much higher in our model than in actual data.
       In summary, our analysis suggests that, simply by introducing some extrapolative
investors into an otherwise traditional consumption-based model of asset prices, we can
make sense not only of some important facts about prices and returns, but also, by
construction, of the available evidence on the expectations of real-world investors. This
suggests that we do not need to think of the survey evidence as a nuisance, or as an
impediment to understanding the facts about prices and returns. On the contrary, the
extrapolation that is present in the survey data is perfectly consistent with the facts about
prices and returns, and may be the key to understanding them.
       In Section 2, we present our model and its solution, and discuss some of the basic
insights that emerge from it. In Section 3, we assign values to the model parameters. In
Section 4, we show analytically that the model reproduces several key features of stock
prices. Our focus here is on quantities defined in terms of differences – price changes, for
example; given the structure of the model, these are the natural objects of study. In
Section 5, we use simulations to document the model’s predictions for ratio-based

                                              5
quantities, such as the price-dividend ratio, that are commonly studied by empiricists.
Section 6 concludes. All proofs, as well as some discussion of technical issues, are in the
Appendix.


2. The Model
           In this section, we propose a heterogeneous-agent, consumption-based model in
which some investors extrapolate past price changes when making forecasts about future
price changes. Constructing such a model presents significant challenges, both because of
the heterogeneity across agents, but also because it is the change in price, an endogenous
quantity, that is being extrapolated. By contrast, constructing a model based on
extrapolation of exogenous fundamentals is somewhat simpler. To prevent our model
from becoming too complex to interpret, we make some simplifying assumptions – about
the dividend process (a random walk in levels), about investor preferences (exponential
utility), and about the risk-free rate (an exogenous constant). We expect the intuitions of
the model to carry over to more complex formulations.
           We consider an economy with two assets: a risk-free asset in perfectly elastic
supply with a constant interest rate r; and a risky asset, which we think of as the
aggregate stock market, and which has a fixed per-capita supply of Q.2 The risky asset is
a claim to a continuous dividend stream whose level per unit time evolves as an
arithmetic Brownian motion
                                            dDt  g D dt   D d  ,                        (1)

where g D and  D are the expected value and standard deviation of dividend changes,

respectively, and where  is a standard one-dimensional Wiener process. Both g D and  D

are constant in our model. We denote the value of the stock market at time t by Pt.
           There are two types of infinitely-lived traders in the economy: “extrapolators” and
“rational traders.” Both types maximize expected lifetime consumption utility. The only
difference between them is that one type has correct beliefs about the expected return of
the risky asset, while the other type does not.



2
    We discuss the constant interest rate assumption at the end of Section 2.

                                                        6
       The modeling of extrapolators is motivated by the survey evidence analyzed by
Vissing-Jorgensen (2004), Amromin and Sharpe (2008), Bacchetta, Mertens, and
Wincoop (2009), and Greenwood and Shleifer (2013). These investors form beliefs about
the future price change of the stock market by extrapolating the market’s past price
changes. To formalize this, we introduce a measure of “sentiment,” defined as:
                                            t
                                   St   e(t  s ) dPs dt ,      0,                  (2)
                                            

where s is the running variable for the integral. St is simply a weighted average of past
price changes on the stock market where the weights decrease exponentially the further
back we go into the past. The definition of St includes even the most recent price change,
dPtdt  Pt  Ptdt. The parameter  plays an important role in our model. When it is high,
sentiment is determined primarily by the most recent price changes; when it is low, even
price changes in the distant past have a significant effect on current sentiment. In Section
3, we use survey data to estimate .
       We assume that extrapolators’ expected price change, per unit time, in the value
of the stock market, is
                                   g Pe ,t  te [dPt ] / dt   0  1St ,                 (3)

where the superscript “e” is an abbreviation for “extrapolator,” and where, for now, the
only requirement we impose on the constant parameters 0 and 1 is that 1  0. Taken
together, equations (2) and (3) capture the essence of the survey results in Greenwood
and Shleifer (2013): after good stock market returns, extrapolators expect the stock
market to continue to perform well; and after poor stock market returns, they expect
continued weak performance. While we leave 0 and 1 unspecified for now, natural
values are 0  0 and 1  1, and these are indeed the values that we use later.
       We do not take a strong stand on the underlying source of the extrapolative
expectations in (3). However, one possible source is the representativeness heuristic, or
the closely-related belief in the law of small numbers (Barberis, Shleifer, and Vishny
1998; Rabin 2002). For example, under the law of small numbers, people think that even
short samples will resemble the parent population from which they are drawn. As a result,




                                                 7
when they see good recent returns in the stock market, they infer that the stock market
must currently have a high average return and that it will therefore continue to do well.3
         The second type of investor, the rational trader, has correct beliefs about the
evolution of future stock prices. By correctly conjecturing the equilibrium price process,
the rational investors take full account of extrapolators’ endogenous responses to price
movements at all future times.
         There is a continuum of both rational traders and extrapolators in the economy.
Each investor, whether a rational trader or an extrapolator, takes the risky asset price as
given when making his trading decision, and has CARA preferences with absolute risk
aversion  and time discount factor .4 At time 0, each extrapolator maximizes
                                                      
                                                           e  t Ct 
                                                   
                                                                   e


                                            
                                             e
                                                                      dt                                             (4)
                                                                
                                             0
                                                     0                 
subject to his budget constraint
                   dWt e  Wt e dt  Wt e  (Wt e  Cte dt  Nte Pt )(1  rdt )  N te Dt dt  N te Pt  dt  Wt e
                                                                                                                      (5)
                           rWt e dt  Cte dt  rN te Pdt
                                                       t   Nte dPt  Nte Dt dt ,

where N te is the per-capita number of shares he invests in the risky asset at time t.
Similarly, at time 0, each rational trader maximizes
                                                      
                                                           e  t Ct 
                                                   
                                                                    r


                                            
                                             r
                                                                      dt                                             (6)
                                                                
                                             0
                                                     0                 
subject to his budget constraint
                   dWt r  Wt r dt  Wt r  (Wt r  Ctr dt  Ntr Pt )(1  rdt )  Ntr Dt dt  Ntr Pt  dt  Wt r
                                                                                                                      (7)
                           rWt r dt  Ctr dt  rN tr Pdt
                                                       t   Ntr dPt  Ntr Dt dt ,

where N tr is the per-capita number of shares he invests in the risky asset at time t, and
where the superscript “r” is an abbreviation for “rational trader.” Since rational traders
correctly conjecture the price process Pt, their expectation is consistent with that of an
outside econometrician.


3
  We think of the effect that we are modeling as distinct from the experience effect reported by Malmendier
and Nagel (2011). Some evidence that these are indeed distinct effects is that, as we show later, the investor
expectations documented in surveys depend only on recent past returns, not the distant past returns that
play a role in Malmendier and Nagel’s (2011) results.
4
  The model remains analytically tractable even if the two types of investors have different values of  or .

                                                             8
         We assume that rational traders make up a fraction , and extrapolators 1  , of
the total investor population. The market clearing condition that must hold at each time
is:
                                                N tr  (1  ) N te  Q ,                                                  (8)
where Q is the per-capita supply of the risky asset.
         We assume that both extrapolators and rational traders observe Dt and Pt on a
continuous basis. Moreover, they know the values of μ and Q; and traders of one type
understand how traders of the other type form beliefs about the future.5
         Using the stochastic dynamic programming approach developed in Merton
(1971), we obtain the following proposition.


Proposition 1 (Model solution). In the heterogeneous-agent model described above, the
equilibrium price of the risky asset is
                                                                    Dt
                                                 Pt  A  BSt         .                                                    (9)
                                                                    r
The price of the risky asset Pt and the sentiment variable St evolve according to
                                          B              gD                 D
                                   dPt         St                dt               d ,                              (10)
                                          1  B      (1   B ) r       (1   B ) r

                                                            gD           D
                                   dSt                St      dt              d .                                  (11)
                                                1  B        r       (1   B )r
At time t, the value functions for the extrapolators and the rational traders are
                                                        e  s Cs 
                                                         


                                                     
                                                              e


         J (Wt , St , t )  max
           e     e
                                            
                                            e
                                                                    ds    exp  t  r Wt e  a e St2  be St  c e  ,
                                                              
                                            t
                                                                       
                           {Cse , N se }st
                                                       t

                                                      e  s Cs 
                                                     
                                                                    r


         J r (Wt r , St , t )  max              t 
                                                  r
                                                                      ds    exp  t  r Wt r  a r St2  b r St  c r  .
                               {Csr , N sr }st
                                                     t                 
                                                                                                                         (12)
The optimal per-capita share demands for the risky asset from the extrapolators and from
the rational traders are


5
  As in any framework with less than fully rational traders, the extrapolators could, in principle, come to
learn that their beliefs about the future are inaccurate. We do not study this learning process; rather, we
study the behavior of asset prices when extrapolators are unaware of the bias in their beliefs.

                                                              9
                                                                     Q 1  e
                               N te  0e  1e St ,        N tr         Nt ,                             (13)
                                                                        
and the optimal consumption flows of the two types are
                                                                         log(r  )
                              Cte  rWt e 
                                           
                                              a St  b e St  c e  
                                           1 e 2
                                                                            
                                                                                   ,
                                                                                                            (14)
                                                                         log(r  )
                              Ctr  rWt r   a r St2  b r St  c r  
                                           1
                                                                                    ,
                                                                           

where the optimal wealth levels, Wt e and Wt r , evolve as in (5) and (7), respectively. The

coefficients A, B, a e , b e , c e , a r , b r , c r , e0 and 1e are determined through a system of

simultaneous equations.                                                                                      


         To understand the role that extrapolators play in our model, we compare the
model’s predictions to those of a benchmark “rational” economy, in other words, an
economy where all traders are of the fully rational type, so that   1.6


Corollary 1 (Rational benchmark). If all traders in the economy are rational (  1), the
equilibrium price of the risky asset satisfies
                                                      2D    g    D
                                         Pt           2
                                                           Q  D2  t .                                     (15)
                                                      r       r     r
It therefore evolves according to
                                                     gD     
                                         dPt           dt  D d  .                                        (16)
                                                      r      r
The value function for the rational traders is
                                                     1                      1        1            
                               J r (Wt r , t )        exp  t  r Wt r   r     2 2D Q 2   .   (17)
                                                     r                     r        2            
The optimal consumption flow is
                                                           r   2D Q 2
                                         Ct  rWt r                     ,                                 (18)
                                                            r     2r


6
  Another way of reducing our model to a fully rational economy is to set 0 and 1, the parameters in (3),
to gD /r and 0, respectively. In this case, both the rational traders and the extrapolators have the same,
correct beliefs about the expected per unit time price change of the risky asset.

                                                          10
where the optimal wealth level, Wt r , evolves as

                                  r   2D Q 2       Q D
                           dWt  
                               r
                                                  dt       d .                          (19)
                                  r      2r            r

                                                                                                 


2.1. Discussion
        In Sections 4 and 5, we discuss the model’s implications in detail. However, the
closed-form solution in Proposition 1 already makes apparent the basic properties of our
framework.
        From equation (11), we see that the sentiment level St follows a mean-reverting
process with long-run mean gD /r. Equation (9) shows that, when sentiment is high, stock
market prices are pushed up -- the coefficient B is positive for all values of the basic
parameters that we have considered. Intuitively, if the sentiment level is high, indicating
that past price changes have been high, extrapolators expect the stock market to perform
well in the future and therefore push its current price higher. While extrapolators’ beliefs
are, by definition, extrapolative, rational traders’ beliefs are contrarian: their beliefs are
based on the true price process (10) whose drift depends negatively on St.
        Comparing equations (10) and (16), we also see that, as noted in the Introduction,
the presence of extrapolators amplifies the volatility of price changes – specifically, by a
factor of 1/(1  B) > 1. And while in an economy made up of rational investors alone,
price changes are not predictable -- see equation (16) -- equation (10) shows that they are
predictable in the presence of extrapolators. Specifically, if the stock market has recently
experienced good returns, so that the sentiment variable St has a high value, the
subsequent stock market return is low on average: the coefficient on St in equation (10) is
negative. In short, high valuations in the stock market are followed by low returns, and
low valuations are followed by high returns. This anticipates some of our results on stock
market predictability in Sections 4 and 5.
        In the analysis we conduct later, we find that, for reasonable values of the basic
model parameters, the derived parameter 1e in equation (13) is positive. In other words,

after a period of good stock market performance, one that generates a high level of

                                               11
sentiment St, extrapolators increase the number of shares of the stock market that they
hold. With a fixed supply of these shares, this automatically means that the share demand
of rational traders varies negatively with the sentiment variable St: rational traders absorb
the shocks in extrapolators’ demand.7
         We also find that, for reasonable values of the basic model parameters, the
derived parameters a e , a r , b e , and b r in equation (14) typically satisfy a e  0, a r  0, and

b e  b r . The fact that b e  b r indicates that extrapolators increase their consumption more
than rational traders do after strong stock market returns. After strong returns,
extrapolators expect the stock market to continue to rise; an income effect therefore leads
them to consume more. Rational traders, recognizing that extrapolators’ ebullience has
caused the stock market to become overvalued, correctly perceive low future returns;
they therefore do not raise their consumption as much.
         Equations (9) and (11) indicate that the mispricing created by extrapolators is
eventually corrected, and more quickly so for high values of β. To understand this – in
other words, to understand why, in our framework, bubbles eventually burst – recall that
an overpricing occurs when good cash-flow news generates a price increase that then
feeds into extrapolators’ beliefs, leading them to push prices still higher. The form of
extrapolation in equation (2), however, means that as time passes, the price increase
caused by the good cash-flow news plays a smaller and smaller role in determining
extrapolators’ beliefs. As a result, these investors become less bullish over time, and the
bubble deflates. This happens more rapidly when β is high because, in this case,
extrapolators quickly “forget” all but the most recent price changes.
         Since extrapolators have incorrect beliefs about future price changes, it is likely
that, in the long run, their wealth will decline relative to that of rational traders. However,
the price process in (10) is unaffected by the relative wealth of the two trader types: under
exponential utility, the share demand of each type, and hence also prices, are independent


7
  Since the supply of the risky asset is fixed and there are only two groups of traders, the share demand of
rational traders must vary negatively with the sentiment level. In a stripped-down version of our
framework, we have also analyzed what happens when there are three types of traders: the two types we
examine here, but also a group of partially-rational investors who buy (sell) the risky asset when its price is
low (high) relative to fundamentals. We find that, in this economy, the share demand of the fully rational
traders is positively related to the sentiment level. In other words, consistent with the findings of
Brunnermeier and Nagel (2004), these traders “ride the bubble” generated by extrapolators.

                                                      12
of wealth. In other words, the exponential utility assumption allows us to abstract from
the effect of “survival” on prices, and to focus on what happens when both types of trader
play a role in setting prices.
         At the heart of our model is an amplification mechanism: if good cash-flow news
pushes the stock market up, this price increase feeds into extrapolators’ expectations
about future price changes, which then leads them to push current prices up even higher.
However, this then further increases extrapolators’ expectations about future price
changes, leading them to push the current price still higher, and so on. Given this infinite
feedback loop, it is important to ask whether the heterogeneous agent equilibrium we
described above exists. The following corollary provides a condition for existence of
equilibrium.


Corollary 2 (Existence of equilibrium). The equilibrium described in Proposition 1
exists if and only if 1  |B|  0. When   0 (all investors are extrapolators), the
equilibrium described in Proposition 1 exists if and only if
                                           1  r ,                                         (20)

assuming that 1  2.                                                                         


         Corollary 2 shows that, when all investors in the economy are extrapolators, there
may be no equilibrium even for reasonable parameter values; loosely put, the feedback
loop described above may fail to converge. For example, if 1 = 1 and  = 0.5, there is no
equilibrium in the case of   0 if the interest rate is less than 50%. However, if even a
small fraction of investors are rational traders, the equilibrium is very likely to exist.
Indeed, for   0.05, we have found an equilibrium for all the parameter values we have
tried.
         One of the assumptions of our model is that the risk-free rate is constant. To
evaluate this assumption, we compute the aggregate demand for the risk-free asset across
the two types of trader. We find that this aggregate demand is very stable over time and,
in particular, that it is uncorrelated with the sentiment level St. This is because the
demand for the risk-free asset from one type of trader is largely offset by the demand


                                              13
from the other type: when sentiment St is high, rational traders increase their demand for
the risk-free asset (and move out of the stock market), while extrapolators reduce their
demand for the risk-free asset (and move into the stock market). When sentiment is low,
the reverse occurs. This suggests that, even if the risk-free rate were endogenously
determined, it would not fluctuate wildly, nor would its fluctuations significantly
attenuate the effects we describe here.


3. Parameter Values
         In this section, we assign benchmark values to the basic model parameters. We
use these values in the numerical simulations of Section 5. However, we also use them in
Section 4. While the core of that section consists of analytical propositions, we can get
more out of the propositions by evaluating the expressions they contain for reasonable
parameter values.
         For easy reference, we list the model parameters in Table 2. The asset-level
parameters are the risk-free rate r; the initial level of the dividend D0 ; the mean g D and

standard deviation  D of dividend changes; and the risky asset supply Q. The investor-

level parameters are the initial wealth levels for the two types of agents, W0e and W0r ;

absolute risk aversion  and the time discount rate ; the proportion μ of rational traders
in the economy; , which governs the relative weighting of recent and distant past price
changes in the definition of the sentiment variable; and, finally, 0 and 1, which govern
the relationship between the sentiment variable and extrapolators’ beliefs.8
         We set r = 2.5%, consistent with the low historical risk-free rate. We set the initial
dividend level D0 to 10, and given this, we choose  D  0.25; in other words, we choose

a volatility of dividend changes small enough to ensure that we only rarely encounter
negative dividends and prices in the simulations we conduct later. We set g D  0.05 to

match, approximately, the empirical ratio of g D /  D in the data. Finally, we set the risky

asset supply to Q  5.



8
 The variables ‫ܦ‬଴ , ܹ଴௘ , and ܹ଴௥ are listed at the bottom of Table 2 because, for much of the analysis, we do
not need to specify their values; their values are needed only for the simulations in Section 5.

                                                     14
       We now turn to the investor-level parameters. We set the initial wealth levels to
W0e  W0r  5000. Given this, we set risk aversion  equal to 0.1 so that relative risk

                                                          WJWW
aversion, computed from the value function as RRA             r W , is 12.5 at the initial
                                                           JW

wealth levels. We choose a low time discount rate of  = 1.5%, consistent with most
other asset pricing frameworks; and, as noted earlier, we set 0 and 1 in equation (3) to
0  0 and 1  1. These values imply that, while extrapolators overestimate the
subsequent price change of the stock market after good past price changes and
underestimate it after poor past price changes, the errors in their forecasts of future price
changes over any finite horizon will, in the long run, average out to zero.
       This leaves just two parameters: μ, the fraction of rational investors in the
economy; and , the weighting parameter in equation (2). Because these two parameters
play an important role in our framework, we consider a range of values for each one in
the numerical analysis that follows. Specifically, we consider four different values of μ: 1
(an economy where all investors are fully rational), 0.75, 0.5, and 0.25. We do not
consider the case of   0 because Corollary 2 indicates that, when all investors are
extrapolators, the equilibrium does not exist for reasonable values of  and 1. For , we
consider three possible values: 0.05, 0.5, and 0.75. Recall that, for higher values of ,
extrapolators weigh recent returns more heavily when forecasting future returns. For
example, when   0.05, the realized annual price change on the stock market starting
four years ago is weighted 86% as much as the most recent annual price change; when 
 0.5, it is weighted 22% as much; and when   0.75, it is weighted only 11% as much.
       While we consider four different values of μ, we focus on the lowest of the four
values, namely 0.25. The fact that the average investor in the surveys studied by
Greenwood and Shleifer (2013) – surveys that include both sophisticated and less
sophisticated respondents – exhibits extrapolative expectations suggests that many if not
most investors in actual financial markets may be extrapolators.
       We can also use the survey evidence to get a better sense of a reasonable value of
. The idea is simple: if investors’ expectations of future stock market returns depend
primarily on very recent market returns – on returns over the past year, or past two years

                                              15
– then  is high. Conversely, if investors’ expectations of future returns depend to a
significant extent on returns in the distant past, then this points to a lower value for . In
the Appendix, we describe in detail how we use the survey data to estimate . The
estimation makes use of Proposition 2 below, and specifically, equation (22), which
describes the change in the value of the stock market expected by extrapolators over any
future horizon.


Proposition 2 (Price change expectations of rational traders and extrapolators).
Conditional on an initial sentiment level S0  s, rational traders’ expectation of the price
change in the stock market over the finite time horizon (0, t1) is:
                                                                             g       g t
                                0r  Pt1  P0 S0  s   B 1  e  kt1   D  s   D 1 ,          (21)
                                                                              r        r
while extrapolators’ expectation of the same quantity is:
                                                                     1 (mt1  e  mt1  1)
              Pt1  P0 S0  s     0  1s  t1    0  ms 
              e
               0
                                                                                           ,           (22)
                                                                             m2
                
where k            and m  (1  1). When 0  0 and 1  1, (22) reduces to
             1  B

                                         e0  Pt1  P0 S0  s   st1 .                              (23)

                                                                                                          

Equations (21) and (22) confirm that the expectations of extrapolators load positively on
the sentiment level, while the expectations of rational traders load negatively.


         When we use the procedure described in the Appendix to estimate  from the
survey data, we obtain a value of approximately 0.5. Consequently, while we present
results for three different values of , we pay most attention to the case of   0.5.9
         For a given set of values of the basic parameters in Table 2, we use the procedure
outlined in the Appendix to compute the “derived” parameters: e0 and 1e , which

9
 When we estimate  from the survey data, we assume, for simplicity, that all the surveyed investors are
extrapolators. If we instead allowed some of them to fall into the category of rational investors – in other
words, if we instead tried to estimate both  and μ from the survey data -- we might obtain a different value
of . However, we would not expect the estimate of  to change very much.

                                                      16
determine extrapolators’, and hence rational traders’, optimal share demand (see equation
(13)); a e , b e , c e , a r , b r and c r , which determine investors’ optimal consumption policies
(see equation (14)); A and B, which specify how the price level P depends on the level of
the sentiment S and the level of the dividend D (see equation (9)); and finally  P , the

volatility of price changes in the stock market (see equation (10)). For example, if  
0.25,   0.5, and the other basic parameters have the values shown in Table 2, the values
of the derived parameters are:
                 e0  1.54, 1e  0.51,  P  19.75, A  117.04, B  0.99,
           a e  1.22  103 , a r  1.28  103 , b e  7.31 103 , b r  0.042,           (24)
                                    c e  1.63, c r  3.47.


4. Empirical Implications
        In this section, we present a detailed analysis of the empirical predictions of the
model. Under the assumptions that the dividend level follows an arithmetic Brownian
motion and that investors have exponential utility, it is more natural, in our analysis, to
work with quantities defined in terms of differences rather than ratios – for example, to
work with price changes Pt  P0 rather than returns; and with the “price-dividend
difference” P  D/r rather than the price-dividend ratio. For example, Corollary 1 shows
that, in the benchmark rational economy, it is P  D/r that is constant over time, not P/D.
In this section, then, we study the predictions of price extrapolation for these difference-
based quantities. In Section 5, we also consider the ratio-based quantities.
        We study the implications of the model for the difference-based quantities with
the help of formal propositions. For example, if we are interested in the autocorrelation of
price changes, we first compute this autocorrelation analytically, and then report its value
for the parameter values in Table 2. For two crucial parameters, μ and β, we consider a
range of possible values. Recall that μ is the fraction of rational traders in the overall
investor population, while β controls the relative weighting of near-past and distant-past
price changes in extrapolators’ forecast of future price changes.
        We are interested in how the presence of extrapolators in the economy affects the
behavior of the stock market. To understand this more clearly, in the results that we

                                                 17
present below, we always include, as a benchmark, the case of   1, in other words, the
case where the economy consists entirely of rational traders.


4.1. Predictive power of D/r  P for future price changes
        A basic fact about the stock market is that the dividend-price ratio of the stock
market predicts subsequent returns, but not subsequent cash flows. It is helpful to express
this fact in the more structured way suggested by Cochrane (2011), among others. If we
run three univariate regressions – a regression of future returns on the current dividend-
price ratio; a regression of future dividend growth on the current dividend-price ratio; and
a regression of the future dividend-price ratio on the current dividend-price ratio – then,
as a matter of accounting, the three regression coefficients must (approximately) sum to
one. Empirically – and this is the basic fact that needs to be explained – the three
regression coefficients are roughly 1, 0, and 0, respectively, at long horizons. In other
words, at long horizons, the dividend-price ratio forecasts future returns – not future cash
flows, and not its own future value.
        We can express this point in a way that fits more naturally with our model, using
quantities defined as differences, rather than ratios. Given the accounting identity
                            D0                      D D  D            
                                P0   Pt  P0    t  0    t  Pt  ,                (25)
                            r                        r   r   r        
it is immediate that if we run three regressions – of the future price change, the (negative)
future dividend change, and the future dividend-price difference, on the current dividend-
price difference – the three coefficients we obtain must sum to one, at any horizon. To
match the empirical facts, our model needs to predict a regression coefficient in the first
regression that is close to one, particularly at long horizons. The next proposition shows
that this is exactly the case.


Proposition 3 (The predictive power of D/r  P). Consider a regression of the price
change in the stock market over some time horizon (0, t1) on the level of D/r  P at the




                                               18
start of the horizon. In population, the coefficient on the independent variable in the
regression is10

                                DP (t1 ) 
                                                  
                                              cov D0 / r  P0 , Pt1  P0     1 e    kt1
                                                                                              ,              (26)
                                                  var  D0 / r  P0 

                
where k            .                                                                                         
             1  B


         Table 3 reports the value of the regression coefficient in Proposition 3 for various
values of μ and β, and for five different time horizons: a quarter, a year, two years, three
years, and four years. The table shows that, consistent with the empirical facts, D/r  P
does indeed predict future price changes with a positive sign. Moreover, the regression
coefficient,  DP (t1 ), is increasing in the length of the time horizon t1. For long time

horizons t1, the regression coefficient converges to 1, as it does empirically in a
regression of long-horizon returns on the dividend yield. In the benchmark rational
economy, the quantity D/r  P is constant; the regression coefficient we compute in
Proposition 3 is therefore undefined.
         The intuition for why D/r  P predicts subsequent price changes is
straightforward. A sequence of good cash flow news pushes up stock prices, which then
raises extrapolators’ expectations about the future price change of the stock market and
causes them to push stock prices even higher. At this point, the stock market is
overvalued; the value of D/r  P is therefore low. Precisely because the stock market is
overvalued, the subsequent price change is low, on average. The quantity D/r  P
therefore forecasts price changes with a positive sign.
         The table shows that, for a fixed horizon, the predictive power of D/r  P is
stronger for low : since the predictability of price changes is driven by the presence of
extrapolators, it is natural that this predictability is stronger when there are more
extrapolators in the economy. The predictive power of D/r  P is also weaker for low :
when  is low, extrapolators’ beliefs are more persistent; as a result, it takes longer for an

10
  The expectations that we compute in the propositions in Section 4 are taken over the steady-state
distribution of the sentiment level S. Ergodicity of the stochastic process St guarantees that time-series
averages will converge to our analytical results in the long run.

                                                        19
overvaluation to correct, reducing the predictive power of D/r  P for price changes at
any fixed horizon.


4.2. Autocorrelations of P  D/r
        In the data, price-dividend ratios are highly autocorrelated at short lags, and we
would like to know if our model can capture this. The natural analog of the price-
dividend ratio in our model is the difference-based quantity P  D/r. We therefore
examine the autocorrelation structure of this quantity.
        In our discussion of the accounting identity in equation (25), we noted that, if we
run regressions of the future change in the stock price, the future change in dividends,
and the future dividend-price difference on the current dividend-price difference, then the
three regression coefficients we obtain must sum to one. Since dividends follow a random
walk in our model, we know that the coefficient in the second regression is zero. We also
know, from Proposition 3, that the coefficient in the first regression is 1  e  kt1 . The
coefficient in the third regression, which is also the autocorrelation of the dividend-price
difference D/r  P, must therefore equal e  kt1 . The next proposition confirms this.


Proposition 4 (Autocorrelations of P  D/r). In population, the autocorrelation of P 
D/r at a time lag of t1 is
                                                    D         Dt 
                              PD (t1 )  corr  P0  0 , Pt1  1   e  kt1 ,               (27)
                                                     r         r 

             
and k           .                                                                             
          1  B

        In Table 4, we compute the autocorrelations in Proposition 4 for several pairs of
values of  and , and for lags of one quarter, one year, two years, three years, and four
years. The table shows that, in our model, and consistent with the empirical facts, the
price-dividend difference is highly persistent at short horizons, while at long horizons, the
autocorrelation drops to zero: at long horizons, the price-dividend difference forecasts
price changes, not its own future value. The table shows that the autocorrelations are




                                                   20
higher for low values of : when  is low, extrapolators’ beliefs are very persistent,
which, in turn, imparts persistence to the price-dividend difference.


4.3. Volatility of price changes and of P  D/r
        Empirically observed stock market returns and price-dividend ratios are thought
to exhibit “excess volatility,” in other words, to be more volatile than can be explained
purely by fluctuations in rational expectations about future cash flows. We now show
that, in our model, price changes and the price-dividend difference – the natural analogs
of returns and of the price-dividend ratio in our framework – also exhibit such excess
volatility. In particular, they are more volatile than in the benchmark rational economy
described in Corollary 1, an economy where prices are set only by rational forecasts of
future cash flows.


Proposition 5 (Excess volatility). In the economy of Section 2, the volatility of price
changes over a finite time horizon (0, t1) is

                                        S B         2 D               2D
                                     
             P (t1 )  var Pt1  P0 
                                         k 
                                              S B 
                                                       r 
                                                            1  e   2 t1 ,
                                                                    kt1

                                                                         r
                                                                                           (28)

while the volatility of P  D/r over (0, t1) is

                                              Dt           D             1  e  kt1
                     PD (t1 )  var  ( Pt1  1 )  ( P0  0 )    S B             ,   (29)
                                               r            r                k

                                D
where k           and  S             .                                                    
            1  B           (1  B )r

        Table 5 reports the standard deviation of annual price changes and of the annual
price-dividend difference P  D/r for several (, ) pairs. Panel A shows that, in the fully
rational economy (  1), the standard deviation of annual price changes is 10, in other
words, D /r. When extrapolators are present, however, the standard deviation is
considerably higher: 30% higher when there are an equal number of extrapolators and
rational traders in the economy, a figure that, as we explain below, depends little on the
parameter . Similarly, while in the fully rational economy the price-dividend difference
is constant, in the presence of extrapolators, it varies significantly.

                                                   21
        The results in Proposition 5 and in Table 5 confirm the intuition we described in
the Introduction, namely that the presence of extrapolators amplifies the volatility of
stock prices. A good cash flow shock pushes stock prices up. However, this increase in
stock prices immediately leads extrapolators to expect higher future price changes in the
stock market, which, in turn, leads them to push the value of the stock market up even
further. Rational investors counteract this overvaluation, but only mildly so: since they
understand how extrapolators form beliefs, they know that extrapolators will continue to
have optimistic beliefs about the stock market in the near future, which, in turn, means
that subsequent price changes, while lower than average, will not be very low. As a
consequence, rational investors do not push back strongly against the overvaluation
caused by the extrapolators. Put differently, even if the fraction of extrapolators in the
overall population is low, this can be enough to significantly amplify the volatility of the
stock market.
        The table shows that, as expected, the greater the fraction of extrapolators in the
economy, the more “excess volatility” there is in price changes and in the price-dividend
difference. More interesting, it also shows that the amount of excess volatility is largely
insensitive to the parameter . This may seem surprising at first: since extrapolators’
beliefs are more variable when  is high, one might have thought that a higher  would
correspond to higher price volatility. However, there is another force that pushes in the
opposite direction: rational traders know that, precisely because extrapolators change
their beliefs more quickly when  is high, any mispricing caused by the extrapolators will
correct more quickly in this case. As a result, when  is high, rational traders trade more
aggressively against the extrapolators, dampening volatility. Overall, then,  has little
effect on volatility.
        Does the higher price volatility generated by extrapolators leave the rational
traders worse off? It does not. Specifically, we find that, if we start with an economy
consisting of only rational traders and then gradually add more extrapolators while
keeping the per-capita supply of the risky asset constant, the value function of the rational
trader increases in value. In other words, while the higher price volatility lowers rational
traders’ utility, this is more than compensated for by the higher profits they make by
exploiting the extrapolators.

                                             22
4.4. Autocorrelations of price changes
        Empirically, returns on the stock market are positively autocorrelated at short
lags; at longer lags, they are negatively autocorrelated. We now examine what our model
predicts about the autocorrelation structure of the analogous quantity to returns in our
framework, namely price changes.


Proposition 6 (Autocorrelations of price changes). In population, the autocorrelation of
price changes between (0, t1) and (t2, t3), where t2  t1, is

                                                                           
                                                                  cov Pt1  P0 , Pt3  Pt2        
                                                         
            P (t1 , t2 , t3 )  corr Pt1  P0 , Pt3  Pt2                                                ,   (30)
                                                                               
                                                                var Pt1  P0 var Pt3  Pt2              
where
                                            S B         2 D   kt3
                 
            cov Pt1  P0 , Pt3  Pt2       2k 
                                                  S B 
                                                           r 
                                                                   
                                                                e e
                                                                        kt2
                                                                                   e   kt1
                                                                                                1 ,

                                            S B        2 D                  2D
                           
                       var Pt1  P0        k 
                                                   
                                                  S B 
                                                          r 
                                                              1  e  kt1
                                                                             r 2 t1 ,
                                                                                                               (31)

                                            S B         2 D                       2
                           
                      var Pt3  Pt2        k 
                                                  S B 
                                                           r 
                                                                   
                                                                1 e             
                                                                       k ( t3 t2 )
                                                                                      2D (t3  t2 ),
                                                                                      r
             
and k           .                                                                                               
          1  B

        In Table 6, we use Proposition 6 to compute the autocorrelation of price changes
for several pairs of values of  and , and at lags of one, two, three, four, eight, and
twelve quarters. The table shows that price changes are negatively autocorrelated at all
lags, with the autocorrelation tending to zero at long lags. To see why, suppose that there
is good cash flow news at time t. The stock market goes up in response to this news; but
since this price rise causes extrapolators to expect higher future price changes, the stock
market is pushed even further up. Now that the stock market is overvalued, the price
change is lower, on average, going forward. In other words, past price changes have
negative predictive power for future price changes.
        Negative autocorrelations are also observed in the data, at several lags; to some
extent, then, our model matches the data. However, there is also a way in which our


                                                        23
model does not match the data: actual returns are positively autocorrelated at the first
quarterly lag, while the price changes generated by our model are not.
         Some earlier models of return extrapolation – for example, Cutler, Poterba, and
Summers (1990), De Long et al. (1990b), Hong and Stein (1999), and Barberis and
Shleifer (2003) – do generate positive short-term autocorrelation, or “momentum,” for
short. Barberis and Shleifer (2003), for example, consider an economy with two groups
of investors. The first group’s demand for the risky asset at time t depends on the asset’s
past price changes up to time t  1; the second group buys (sells) the risky asset when its
price is low (high) relative to fundamentals, but does not know the exact structure of
extrapolator demand. This model generates positive short-term autocorrelation and
negative long-term autocorrelation in price changes. In De Long et al. (1990b) and Hong
and Stein (1999), the time t risky asset demand of some investors depends positively on
the price change between time t  2 and time t  1; these frameworks also generate
positive short-term autocorrelation in price changes, and negative long-term
autocorrelation.
         Given that these earlier extrapolation-based models generate momentum, why
does our model not do so? There are two differences between the earlier models and the
current one, each of which, taken alone, suffices to remove any momentum. First, in
contrast to the earlier models, our economy contains fully rational investors who
understand how extrapolators form beliefs. Second, in the current model, extrapolators’
demand for the risky asset depends on even the most recent price change Pt  Pt  dt , while

in the earlier models, it depends only on price changes up to, but not including, the most
recent price change. This last assumption is important for generating momentum: if
extrapolators’ demand at time t depends on the price change between time t  2 and time
t  1, a positive price change between t  2 and t  1 is likely to generate a positive price
change between t  1 and t.11



11
  Our claim that either the presence of rational investors or an extrapolator demand function that depends
on the most recent price change is enough to remove momentum is based on a re-examination of the
Barberis and Shleifer (2003) model. We find that, if we either replace the partially rational investors in that
model with fully rational investors, or make extrapolator demand a function of the most recent price
change, the model no longer generates momentum.

                                                      24
4.5. Correlation of consumption changes and price changes
        Another quantity of interest is the correlation of consumption growth and returns.
In the data, this correlation is low. We now look at what our model predicts about the
analogous quantity: the correlation of consumption changes and price changes.


Proposition 7 (Correlation between consumption changes and price changes). In
population, the correlation between the change in consumption and the change in price
over a finite time horizon (0, t1 ) is

                                                                cov(Ct1  C0 , Pt1  P0 )
                            
                      corr Ct1  C0 , Pt1  P0             var(Ct1  C0 ) var( Pt1  P0 )
                                                                                               ,           (32)

where

                 cov(Ct1  C0 , Pt1  P0 )

                                     W  S           2 ag D  2S                                b 2 
                Br (1  e  kt1 )           B  1              (1  e  kt1 )  (1  e  kt1 ) S 
                                       k              kr                                          k 
                                                                                                           (33)
                         2 g DS      1  e  kt1           S      1  e  kt1 
                  D aW         t1                 D bW    t1              
                            rk            k                 k           k 
                                             2 g D  S 1  e  kt1                          
                  D W t1   1a D                               1b D (1  e  kt1 ) S ,
                                                 r        rk                                rk
                                               S B         2                  2
                        var( Pt1  P0 )            ( S B  D )(1  e  kt1 )  2D t1 ,                   (34)
                                                k            r                  r
and




                                                           25
  var(Ct1  C0 ) 

           4 g 2 2     1  e  kt1    4         1  e 2 kt1  r 2bW2  2S        1  e  kt1
  r 2 aW2  2D 2 S (t1              )  S3 (2t1              )            ( t1              )
           r k              k          4k             k            k2                  k

                             e 2 kt1  1 2 kt1               2 2  4 g D  S 1  e          4S (1  e 2 kt1 ) 
                                                                                       kt1
    raW bW  2S g D                                                       2 2
                   (3t1  2              e t1 )  r W t1   a 
                                                     2 2
                                                                                                                  
         k2                        k                                 r
                                                                           2
                                                                                    k                 k2           
                                                                                                                       (35)
    2b 2  2S                  4  2 ab 2S g D                                2 g DS        1  e  kt1 
               (1  e  kt1 )                    (1  e  kt1 )  2r 2 aW W            ( t1             )
       k                                 kr                                       rk                 k       
                  S       1  e  kt1                2 g 4e  kt1  1  3e 2 kt1
  2r 2bW W         (t1              )  2  1bW a S D (                          t1e 2 kt1 )
                  k            k                        k            2k
      4  1aW g D  S                                             
                       (1  e  kt1 )  2 r  1W b (1  e  kt1 ) S .
              k                                                      k


                                                                                            b BQ
Note that a  a r  (1  )a e , b  b r  (1  )be , aW  a / , bW                             rBQ,
                                                                                             1  B
            DQ                            D
W                ,k        and  S            .                                                               
         (1  B)r     1  B           (1  B)r


           Panels A and B of Table 7 use Proposition 7 to compute the correlation of
consumption changes and price changes at a quarterly and annual frequency,
respectively, and for several (, ) pairs. The two panels show that, while the presence of
extrapolators slightly reduces this correlation relative to its value in the fully rational
economy, the correlation is nonetheless high. As is the case for virtually all consumption-
based pricing models, then, our model fails to match the low correlation of consumption
growth and returns in the data.


4.6. Predictive power of the surplus consumption ratio
           Prior empirical research has shown that a variable called the “surplus
consumption ratio” – a measure of consumption relative to past consumption levels, is
contemporaneously correlated with the price-dividend ratio on the overall stock market;
and furthermore, that it predicts subsequent returns with a negative sign. These findings
have been taken as support for habit-based models of the aggregate stock market. We
show, however, that these patterns also emerge from our model.


                                                             26
         As we have done throughout this section, we look at a surplus consumption
difference rather than a surplus consumption ratio; moreover, we focus on the simplest
possible surplus consumption difference, namely the current level of aggregate
consumption minus the level of aggregate consumption at some point in the past.
Proposition 8 computes the correlation between this variable and the contemporaneous
price-dividend difference P  D/r.


Proposition 8: (Correlation between consumption change and P  D/r). In population,
the correlation between the change in consumption over a finite time horizon (0, t1 ) and P

 D/r is
                                                                                   Dt1
                                                Dt1         cov(Ct1  C0 , Pt1          )
                        corr(Ct1  C0 , Pt1          )                            r              ,   (36)
                                                 r                                       Dt1
                                                           var(Ct1  C0 ) var( Pt1            )
                                                                                          r

where
                               Dt1                      a g  2 rb  2 r    ag  2 b 2 
    cov(Ct1  C 0 , Pt1          )  (1  e  kt1 ) B  W D2 S  W 2 S  W S  D S  S  , (37)
                                r                       k        2k       k    kr   2k  

             Dt1             2S
var( Pt1          )  B2        , and var(Ct1  C0 ) is as in (35). Also, a  a r  (1  )a e ,
              r             2k
                                               b BQ                   DQ           
b  b r  (1  )be , aW  a / , bW                  rBQ, W            ,k        and
                                                1  B             (1  B)r     1  B
           D
S               .                                                                                     
       (1   B)r

         Proposition 9 examines whether the surplus consumption difference can predict
future price changes.


Proposition 9 (The predictive power of changes in consumption). Consider a
regression of the price change in the stock market from t1 to t2 on the change in
consumption over the finite time horizon (0, t1). In population, the coefficient on the
independent variable is



                                                           27
                            C (t1 , t2 ) 
                                                   
                                               cov Ct1  C0 , Pt2  Pt1   ,                        (38)
                                                        
                                                    var Ct1  C0   
where
                                          cov(Ct1  C0 , Pt2  Pt1 )

                                                     a g 2 rb 2 r      ag 2 b2              (39)
             (e  k (t2 t1 )  1)(1  e  kt1 ) B  W D2 S  W 2 S  W S  D S  S  ,
                                                     k        2k      k     kr  2k  

                                                                                              a
and var(Ct1  C0 ) is as in (35). Also, a  a r  (1  )a e , b  b r  (1  )be , aW      ,
                                                                                              
       b BQ                   DQ                              D
bW             rBQ, W            ,k        , and  S            .                             
        1  B             (1  B)r     1  B             (1  B)r

        Panel C of Table 7 uses Proposition 8 to compute, for several (, ) pairs, the
correlation between the surplus consumption difference and the price-dividend
difference. Here, the surplus consumption difference is computed as the current level of
aggregate consumption minus the level of aggregate consumption a quarter ago. The
panel shows that the two quantities are significantly correlated. Table 8 uses Proposition
9 to compute the coefficient on the independent variable in a regression of the price
change in the stock market over some horizon – one quarter, one year, two years, three
years, or four years – on the surplus consumption difference. It shows that the surplus
consumption difference has significant negative predictive power for price changes, and
that the predictive power is particularly strong for low μ and high β. Taken together, then,
Panel C of Table 7 and Table 8 show that the surplus consumption difference can be
correlated with the valuation level of the stock market and with the subsequent stock
price change even in a framework that does not involve habit-type preferences in any
way.
        The intuition for these results is straightforward. After a sequence of good cash
flow news, extrapolators cause the stock market to become overvalued and hence the
price-dividend difference to be high. However, at the same time, extrapolators’ optimistic
beliefs about the future lead them to raise their consumption; while the rational traders do
not raise their consumption as much, aggregate consumption nonetheless increases
overall, pushing the surplus consumption difference up. This generates a positive


                                                       28
correlation between the price-dividend difference and the surplus consumption
difference. Since the stock market is overvalued at this point, the subsequent price change
in the stock market is low, on average. As a consequence, the surplus consumption
difference predicts future price changes with a negative sign.


4.7. Equity premia and Sharpe ratios
       Proposition 10 below computes the equity premium and Sharpe ratio of the stock
market.


Proposition 10 (Equity Premium and Sharpe Ratio). In the economy of Section 2, the
equity premium, defined as the per unit time expectation of the excess price change and
dividend, can be written as
                             1                                     g
                                  dPt  Dt dt  rPdt
                                                    t    (1  rB) D  rA.                  (40)
                             dt                                     r
The Sharpe ratio is
               dt1 (dPt  Dt dt  rPdt
                                      t  )
             Var  dt1 (dPt  Dt dt  rPdt
                                        t  )
                                                            1/2                             (41)
                   2D        B      
                                          2
                                              2D                          gD      
                                rB                           (1  rB)     rA  .
             (1  B) r  1  B       2(1  B)r                               
                        2 2                         2
                                                                               r

                                                                                              


       Panel A of Table 9 uses the proposition to compute the average excess price
change and dividend at an annual horizon for several (, ) pairs. The panel shows that
the equity premium rises as the fraction of extrapolators in the economy goes up: the
more extrapolators there are, the more volatile the stock market is; the equity premium
therefore needs to be higher to compensate for the higher risk. Panel B of the table shows
that it is not just the equity premium that goes up as  falls, but also the Sharpe ratio.




                                                29
5. Further Analysis: Ratio-based Quantities
       In Section 4, we focused on quantities defined in terms of differences: on price
changes, and on the price-dividend difference P  D/r. Given the additive structure of our
model, these are the natural quantities to study. However, most empirical research works
with ratio-based quantities such as returns and price-dividend ratios. While these are not
the most natural quantities to look at in the context of our model, we can nonetheless
examine what our model predicts about them. This is what we do in this section.
       Since analytical results are not available for ratio-based quantities, we use
numerical simulations to study their properties. In Section 5.1, we explain the
methodology behind these simulations. In Section 5.2, we present our results. In brief, the
results for the ratio-based quantities are broadly consistent with those for the difference-
based quantities in Section 4. However, we also interpret these results cautiously:
precisely because they are not the natural objects of study in our model, the ratio-based
quantities are not as well-behaved as the difference-based quantities we examined in
Section 4.


5.1. Simulation Methodology
       To conduct the simulations, we first discretize the model. In this discretized
version, we use a time-step of t  ¼, in other words, of one quarter. As indicated in
Section 3, the initial level of the dividend is D0  10 and the initial wealth levels are

W0e  W0r  5000. We further set the initial sentiment level, S0 , to the steady-state mean of

gD
   .
 r
       We know from Proposition 1 that, at time 0,
                                                          D0
                   N 0e  e0  1e S0 , P0  A  BS0       ,
                                                          r
                                                                                            (42)
                  C  rW   a i S02  bi S0  ci   log(r  ),
                          1                          1
                    i       i
                                                                    i  {e, r}.
                                                    
                    0      0



The proposition also tells us that, from time nt to (n+1)t, we have:




                                               30
                      D( n 1) t  Dnt  g D t   D t ( n 1) t ,

                                                            gD                        D t
                       S( n 1) t  Snt            Snt                      t              ( n 1) t ,
                                              1  B          r                       (1  B )r
                                                               D( n 1) t
                       P( n 1) t  A  BS( n 1) t                       ,
                                                                   r
                                                                                        Q  (1  ) N (en 1) t
                       N (en 1)   0e  1e S( n 1) t ,           N (rn 1) t                                ,   (43)
                                                                                                   
                      W(in 1) t  Wnit  N ni t ( P( n 1) t  Pnt )  Cni t t

                                   rWnit t  rN ni t Pnt t  N ni t D( n 1) t t ,

                      C(in 1) t  rW(in 1) t 
                                                      
                                                         a S( n 1) t  bi S( n 1) t  ci   log(r  ),
                                                      1 i 2                                      1
                                                                                                 
with i {e, r}, and where { ( n 1) t , n  1} are i.i.d. standard normal random variables with

mean 0 and a standard deviation of 1. We make the conventional assumptions that the
level of the consumption stream for the period between (nt, (n+1)t) is determined at
the beginning of the period; and that the level of the dividend paid over this period is
determined at the end of the period.
         For a given set of values of the basic model parameters in Table 2, we use the
procedure described in the proof of Proposition 1 to compute the parameters that
determine the optimal portfolio holdings and consumption choice – variables such as 1e ,
for example.12 We then use the above equations to simulate a sample path for our
economy that is 200 periods long, in other words, 50 years long. We compute quantities
of interest from this 200-period time series – the autocorrelation of stock market returns,
say. We then repeat this process 10,000 times. In the next section, we report the average
return autocorrelation that we obtain across these 10,000 simulated paths.




12
  Here, we are assuming that the values of the derived parameters, such as ߟଵ௘ , that determine investors’
optimal policies in the continuous-time framework are a good approximation to the values of these
parameters in the discrete-time analog of our model. One indication that this is a reasonable assumption is
that our numerical results are robust to changing t from 1/4 to 1/48, say.

                                                                 31
5.2. Results
        Table 10 presents the model’s predictions for ratio-based quantities for  
0.25 and for three different values of . For each (, ) pair, we simulate 10,000
paths, each of which is 200 periods long. For each of the 10,000 paths, we compute
various quantities of interest – specifically, the quantities listed in the left column of
Table 10. The table reports the average value of each quantity across the 10,000
paths. The last column of the table reports the empirical value of each quantity over
the post-war period from 1947 to 2011.13
        We now discuss each of these quantities in turn. Most of them are simply the
ratio-based analogs of the quantities we studied in Section 4: for example, instead of
computing the standard deviation of price changes, we compute the standard
deviation of returns. However, we are also able to address some questions that we
did not discuss in any form in Section 4, such as whether the consumption-wealth
ratio or more complex formulations of the surplus consumption ratio have any
predictive power for returns.
        Row 1: We report the coefficient on the independent variable in a regression
of total log excess returns measured over a one-year horizon on the log dividend-
price ratio at the start of the year. To be clear, as described above, we run this
regression in each of the 10,000 paths we simulate; the table reports the average
coefficient across all paths, as well as the average R-squared, in parentheses.
Consistent with the findings of Section 4.1, the table shows that the dividend-price
ratio predicts subsequent returns with a positive sign.
        Row 2: We report the autocorrelation of the price-dividend ratio at a one-
year lag. Consistent with the results of Section 4.2, the ratio is highly persistent.
        Row 3: We compute the excess volatility of returns -- specifically, the
standard deviation of stock returns in the heterogeneous-agent economy relative to
the standard deviation of returns in the rational benchmark economy. Consistent
with the findings of Section 4.3, we see that stock returns exhibit excess volatility.

13
  For the nondurable consumption data, the sample period starts in 1952. Returns are based on the CRSP
value-weighted index. For the consumption-wealth ratio, wealth is computed in two different ways: the first
way uses the market capitalization of the CRSP stock market, and the second uses aggregate household
wealth from the Flow of Funds accounts, following Lettau and Ludvigson (2001).

                                                    32
            Row 4: We compute the excess volatility of price-dividend ratios: the
standard deviation of the price-dividend ratio in the heterogeneous-agent economy
relative to its standard deviation in the rational benchmark economy. Consistent with
Section 4.3, the standard deviation of the price-dividend ratio goes up in the
presence of extrapolators.
            Row 5: We compute the autocorrelation of quarterly log excess stock returns
at lags of one quarter and two years. As in Section 4.4, returns are negatively
autocorrelated.
            Row 6: We compute the correlation of annual log excess stock returns with
annual changes in quarterly log consumption. As in Section 4.5, this correlation is
higher than the correlation observed in the data.
            Row 7: We compute the correlation between the surplus consumption ratio and
the price-dividend ratio, where both quantities are measured at a quarterly frequency.
Given the greater flexibility afforded by numerical simulations, we use a more
sophisticated definition of surplus consumption than in Section 4.6, one that is still
simpler than in Campbell and Cochrane (1999) but that nonetheless preserves the spirit of
their calculation. Specifically, we define the surplus consumption ratio as:
                                                          Cta  X t
                                                      S 
                                                       t
                                                        a
                                                                    ,                                   (44)
                                                             Cta
where the superscript “a” stands for “aggregate,” and where the habit level Xt adjusts
slowly to changes in consumption:
                                                                                      e  k t
                            X t   k 1 w(k ; n, )Ct  k , where w(k ; n, ) 
                                     n
                                                                                                   .    (45)
                                                                                    j 1 ejt
                                                                                      n



In simple terms, Xt is a weighted sum of past consumption levels, where recent
consumption levels are weighted more heavily. For a given , we choose n so that


    n     j t
    j 1
        e              e  t  e  ( n 1) t
                                                 90%; that is, we choose ݊ so that even consumption

    
        e j t               e t
    j 1




                                                            33
changes in the distant past receive at least some weight in the computation of the
habit level. In our calculations, we set   0.95 and n  12.14
        Row 7 of Table 10 shows that, as in Section 4.6, the surplus consumption
ratio and price-dividend ratio are positively correlated, consistent with the actual
data.
        Row 8: We report the coefficient on the independent variable in a regression
of total log excess returns over a year on the surplus consumption ratio at the start of
the year. Consistent with our results in Section 4.6 using a simpler measure of
surplus consumption, the surplus consumption ratio predicts subsequent returns with
a negative sign, as it does in actual data.
        Row 9: Empirically, the consumption-wealth ratio has predictive power for
subsequent returns. Here, we examine whether our model can generate this pattern.
We compute the coefficient on the independent variable in a regression of total log
excess returns over a year on the log consumption-wealth ratio at the start of the
year. The table shows that the ratio does indeed have some predictive power.
        What is the intuition for this predictive power? After a sequence of good cash
flow news, extrapolators cause the stock market to become overvalued. This, in turn,
increases aggregate wealth in the economy; it also increases aggregate consumption, but
not to the same extent: rational traders, in particular, do not increase their consumption
very much because they realize that future returns on the stock market are likely to be
low. Overall, the consumption-wealth ratio falls. Since the stock market is overvalued, its
subsequent return is lower than average. The consumption-wealth ratio therefore predicts
subsequent returns with a positive sign.
        Row 10: We compute the equity premium and Sharpe ratio in our economy.


        In summary, while it is natural, in our framework, to study difference-based
quantities rather than ratio-based quantities, Table 10 shows that the ratio-based
quantities exhibit patterns that are broadly similar to those that we obtained in
Section 4 for the difference-based quantities.


14
  When  = 0.95, quarterly consumption one year ago is weighted about 40% as much as current
consumption.

                                                 34
6. Conclusion
       Survey evidence suggests that many investors form beliefs about future stock
market returns by extrapolating past returns: they expect the stock market to perform well
(poorly) in the near future if it has recently performed well (poorly). Such beliefs are hard
to reconcile with existing models of the aggregate stock market. We study a
heterogeneous-agent model in which some investors form beliefs about future stock
market price changes by extrapolating past price changes, while other investors have
fully rational beliefs. We find that the model captures many features of actual returns and
prices. Importantly, however, it is also consistent with the survey evidence on investor
expectations. This suggests that the survey evidence does not need to be seen as a
nuisance; on the contrary, it is consistent with the facts about prices and returns and may
be the key to understanding them.




                                             35
                                                         Appendices
A. Proof of Proposition 1
        In order to solve the stochastic dynamic programming problem, we need the
differential forms for the evolution of the state variables. From the definition of the
sentiment variable, St   e  (t  s ) dPs  dt , its differential form is
                                      t

                                      

                                     dSt  St dt  dPt .                                               (A1)
         The term Stdt captures the fact that, when we move from time t to time t  dt,
all the earlier price changes that contribute to St need to be associated with smaller
weights since they are further away from time t  dt than they were from time t; the term
dPt captures the fact that the latest price change pushes St in the same direction; and the
parameter  captures the stickiness of this belief updating rule. Also, the wealth of each
type of trader evolves as
                     Wt i dt  (Wt i  Cti dt  N ti Pt )(1  rdt )  N ti Dt dt  N ti Pt  dt
                                                                                                          (A2)
               dWt i  rWt i dt  Cti dt  rN ti Pdt    t  N ti dPt  N ti Dt dt ,    i  {e, r} ,
consistent with the budget constraints in (5) and (7).
        As noted in the main text, the derived value functions for the extrapolators and the
rational traders are
                                                         e s  Csi 
                 J (Wt , St , t )  max
                  i   i
                                   {Csi , N si }st
                                                    t  
                                                     i

                                                        t       
                                                                        ds  ,
                                                                             
                                                                                     i  {e, r}.          (A3)

        The assumptions that traders have CARA preferences, that Dt follows an
arithmetic Brownian motion, that St evolves in a Markovian fashion as in (A1), and that
extrapolators’ biased beliefs in (3) are linearly related to St jointly guarantee that the
derived value functions are only functions of time, of the level of wealth, and of the level
of sentiment, but of nothing else (such as Dt or Pt). We verify this and discuss it further
after solving the model.
        If we define
                                                   et C 1 i i
                                                                i


                          (C , N ;W , S , t )  
                          i   i   i       i
                                                            t [dJ ] ,                     i {e, r} ,   (A4)
                                                           dt
then, from the theory of stochastic control, we have that15
                        0  mai
                                xi i (C i , N i ;W i , S , t ) , i {e, r} .                             (A5)
                                      {C , N }

By Ito’s lemma, (A5) leads to the stochastic Bellman equations which state that, along
the optimal path of consumption and asset allocation,
              et C
                       i


         0
                 
                                                                             1 i 2 i 2
                          J ti  JWi rW i  C i  rN i P  N i g Pi  N i D  JWW
                                                                              2
                                                                                   P ( N )
                                                                                                          (A6)
                  J  S  g   2 J SS
                                   1
                     i
                     S
                                      i
                                      P
                                         i
                                            2P  JWS
                                                    i
                                                       N i 2P ,                     i {e, r} ,
                                   2

15
     See Kushner (1967) for a detailed discussion of this topic.

                                                              36
where g Pe and g Pr are the per unit time price change of the stock market expected by
extrapolators and rational traders, respectively, and where  P is the per unit time
volatility of the stock price. Note that, as stated in (3), g Pe   0  1S , and that g Pr comes
from rational traders’ conjecture about the stock price process, which is yet to be
determined. Note also that, in continuous time, the volatility  P is essentially observable
by computing the quadratic variation; as a result, the two types of traders agree on its
value. We assume, and later verify, that  P is an endogenously determined constant that
does not depend on S or t. Finally, from the evolution of S in (A1), we know that dW i and
S are locally perfectly correlated for both types of trader.
        Since the infinite-horizon model is perpetual, and since, as verified later, the
evolutions of W e and W r do not depend explicitly on the level of the dividend or the stock
price, we know that the passage of time only affects the value functions through time
discounting. We can therefore write, for i  {e, r},
                                                                                              e( s t )Cs 
                                                                                            
                                                                                                             i

                                t i
        J (Wt , St , t )  e I (Wt , St ), where I (Wt , St )  ma
            i    i                      i                      i       i
                                                                                   x   i
                                                                                                            ds  .    (A7)
                                                                                                       
                                                                                       t
                                                                         {Csi , Nsi }st
                                                                                             t                  
Substituting (A7) into (A6) gives the reduced Bellman equations
                 eC
                        i


                           I i  IWi  rW i  C i  rN i P  N i g Pi  N i D   IWW
                                                                                           1 i 2 i 2
          0                                                                                  P ( N )
                                                                                          2
                                                                                                                         (A8)
               I Si  S  g Pi   2 I SS
                                         1 i 2
                                                P  IWS i
                                                             N i 2P ,        i {e, r}.
                                         2
The first-order conditions of (A8) with respect to C i and W i are
                                                     IWi  eC
                                                                   i
                                                                                                                         (A9)
and
                                  IWi g Pi  rP  D IWS
                                                      i
                             N  i
                                i
                                                    i ,                      i {e, r}.                                (A10)
                                 IWW        2P     IWW
The first term on the right-hand side of (A10) is the share demand due to mean-variance
considerations; the second term is the hedging demand due to sentiment-related risk.
        We now conjecture, and later verify, that the true equilibrium stock price satisfies
                                                                       Dt
                                               Pt  A  BSt              .                                             (A11)
                                                                       r
The coefficients A and B are yet to be determined. Assuming that the rational traders
know this price equation and the true process for Dt, they can obtain the true evolution of
the stock price as
                                  B              gD              D
                           dPt         St             dt            d                                            (A12)
                                  1  B      (1  B)r       (1  B)r
by combining (1), (A1), and (A11). Substituting (A12) into (A1) yields
                                           gD           D
                       dSt           St      dt            d .                                                   (A13)
                               1  B        r       (1  B)r


                                                          37
From (A12) and (A13) it is clear that when B  1, the sentiment variable St follows an
Ornstein-Uhlenbeck process with a steady-state distribution that is Normal with mean
 gD                            2D 
       and variance                      , and that the expected per unit time price change,
  r                     2 r 2 (1   B )
 tr [dPt ]                                                      g
            , also fluctuates around its long-run mean of D with long-run variance of
     dt                                                           r
     D B
       2 3 2
                  . In addition
 2r 2 (1  B)3
                                       B             gD                  D
                           g Pr            St            ,    P            .             (A14)
                                     1  B       (1  B)r           (1  B)r
That is, rational traders’ future expected price change is negatively and linearly related to
the sentiment level, and  P is a constant if the conjecture in (A11) is valid.
        Given the imposed belief structure that g Pe   0  1S , the extrapolators
subjectively believe that the stock price evolves as
                                                          D
                            dPt    0  1St  dt            d e ,                                                (A15)
                                                      (1  B)r
where de is extrapolators’ perceived innovation term from the dividend process, which
itself follows
                                           dDt  gDe dt  D d e ,                                                   (A16)
          e                                                                                      16
where g is extrapolators’ perceived expected per unit time dividend change.
          D

        Differentiating (A12) and substituting in (A1) and (A16), extrapolators obtain
                            B                 g De                D
                     dPt            St                 dt               d e ,                                  (A17)
                              1   B      (1    B ) r       (1   B ) r
in contrast with the price process (A12) obtained by the rational traders. Comparing
(A15) and (A17) suggests that
                        g De (St )  0 r (1  B)   1r (1  B)  rB St .                                       (A18)
That is, extrapolators’ perceived expected dividend change per unit time depends
explicitly on St. (We note that this is quite different from directly extrapolating past
dividend changes.)
        Price-agreement across the two types of traders, in other words,
                                dP  g Pr dt  P d   gPe dt  P d e                                              (A19)
prevents extrapolators from seeing, through retrospection, that their belief structure is
biased, and provides a direct relation between d and de. Equations (A12), (A17), and
(A19) jointly confirm dividend-agreement across traders:
                              dD  gD dt  D d   gDe dt  D d e .                                                (A20)


16
  If instead, the extrapolators know the true process of Dt, they will believe that dPt  (0  1St)dt + Pd,
a price process that, given that B/(1  B)  0  1, clearly deviates from the true process in (A12). In
other words, even after a time interval of length dt, extrapolators will, in principle, be able to learn that their
beliefs are wrong.

                                                       38
        We guess that the solutions of I e (W e , S ) and I r (W r , S ) are
                   I i (W i , S )   exp r W i  ai S 2  bi S  ci  ,    i {e, r}.             (A21)
Substituting (A21) into the optimal consumption rule in (A9) and the optimal share
demand of the stock in (A10) yields
                                    1
                                                        1
                                                                   
                        C i  rW i  ai S 2  bi S  ci  log(r  ) ,
                                                        
                                                                                                        (A22)

and
                              gPi  rP  D (2ai S  bi )
                          N 
                            i
                                                         ,                 i {e, r}.                  (A23)
                                  r 2P       r
       For the extrapolators, substituting g Pe   0  1S and the price equation (A11) into
(A23) gives
                                               0  rA  be2P          1  rB  2ae2P
         N e  0e  1e S , where 0e                         and e
                                                                                          .            (A24)
                                                     r 2P                    r 2P
                                                                     1


Substituting the price equation (A11), the form of I e in (A21), the optimal consumption
C e in (A22), and the optimal share demand N e in (A24) into the reduced Bellman
equation (A8) for the extrapolators, we obtain the following quadratic equation in S:
                         (  rA  be2P )  (1  rB  2ae2P )S
      0  (r  )  r   0                                          (0  1S  rA  rBS )
                                           r  2
                                                 P


              ae S 2  be S  ce  log(r )  [(0  rA  be2P )  (1  rB  2ae2P )S ]2
                                           
                                                                 22P                                 (A25)
                                                        1
          (2ae S  be )[S  (0  1S )]  ae22P  22P (2ae S  be )2
                                                        2
         (2ae S  be )[(0  rA  be2P )  (1  rB  2ae2P )S ] ,
which is equivalent to three simultaneous equations:
                     (1  rB  2ae2P )2
               0                           rae  2ae(1 1)  2(aeP )2 ,                          (A26)
                              2P2


          (1  rB  2ae2P )(0  rA  be2P )
   0                                             rbe  2ae0  be(1 1)  222P aebe ,           (A27)
                           2P
                      (0  rA  be2P )2                                       1
      0  (r  )                          rce  r log(r )  be0  ae22P  (beP )2 .           (A28)
                             2P2
                                                                                 2
        These three equations determine the coefficients a e , b e , c e , e0 , and 1e as functions
of the coefficients A and B. If, as we assume, extrapolators know the belief structure of
the rational traders as well as the parameters  and Q, it follows that they can go through
the intertemporal maximization problem for the rational investors (specified below) and
figure out the price equation (A11). As a result, extrapolators know the coefficients A and



                                                       39
B, and through equations (A26), (A27), and (A28), they can solve for their optimal share
demand N e , as well as for their value function J i .
        We now turn to the rational traders. Using g Pr and  P from (A14), the form of I r
in (A21), N r from (A23), the optimal share demand of the stock from extrapolators in
(A24), and the market clearing condition N r  (1  ) N e  Q, we obtain ar and b r as
functions of A and B,
                  (1 B)2 r 2  B         (1  )2D 1e 
             a 
               r
                                    rB                   ,
                     22D  1 B           r(1 B)2 
                                                                                                      (A29)
                   (1 B)2 r 2  2D                 gD    (1  ) 2D 0e 
              br                        Q  rA                            .
                       2D  r (1 B)2          (1 B)r r(1  B)2 
Substituting the price equation (A11), g Pr from (A14), the form of I e in (A21), the optimal
consumption C r in (A22), and the optimal share demand N r  Q  1
                                                                    (0  1 S ) into the
                                                                       e    e


reduced Bellman equation (A8) for the rational traders, we obtain another quadratic
equation in S
                   Q  (1  )(0e  1e S )  B            gD               
0  (r  )  r                                    S            rA  rBS 
                                             1  B    (1  B)r            
      a r S 2  br S  c r  log(r )  r 2  22P [Q  (1  )(e0  1e S )]2 (2a r S  br )     gD 
                                                                                             S   (A30)
                                                        2 2
                                                                                   1  B            r 
               1                       r 2P (2a r S  br )[Q  (1  )(0e  1e S )]
    a r22P  22P (2ar S  br )2                                                    ,
               2                                              
which is equivalent to three simultaneous equations:
              (1  )1e B (1  )1e rB           [(1  )r 1e P ]2 2a r 
    0  r                                ra r
                                                                                  2(a r  P )2
              (1  B)                                    2             1  B
                                                                 2
                                           
                                                                                                      (A31)
          2a r (1  )r 1e 2P
                                 ,
                    

                    Q  (1  )e0  B          (1  )1e  g D            
          0  r                         rB                        rA   rbr
                                   1 B                  (1  B)r      
                  r 2  22P (1  )1e [Q  (1  )e0 ] br     2a r g D
                                                                          222P a r br           (A32)
                                    2                     1 B (1 B)r
                  r 2P
              
                     
                           2ar [Q  (1  )e0 ]  br (1  )1e  ,


                                                      40
                 r [Q  (1  )e0 ]  g D            
 0  (r  )                                     rA   rc r  r log(r  )
                                      (1  B)r      
                                                                                                                (A33)
       r 2  22P [Q  (1  )e0 ]2    b r g D              1 r              br r 2P [Q  (1  )e0 ]
                                                a   
                                                     r 2 2
                                                               (b     ) 2
                                                                                                           .
                    22                (1  B)r                                            
                                                          P            P
                                                              2
These three equations determine the coefficients A, B, and c r . Equations (A26)-(A28)
and (A31)-(A33) are the mathematical characterization of the endogenous interaction
between rational traders and the extrapolators. The procedure for solving these
simultaneous equations is left to the next section of the Appendix.
         The fact that the conjectured forms of Pt, I e , and I r in (A11) and (A21) satisfy the
Bellman equations in (A8) for all Wt and St verifies these conjectures, conditional on the
validity of the assumption that Wt and St are the only two stochastic state variables. To
verify the latter, note that the price equation in (A11), the optimal consumption rules in
(A22), and the fact that the solutions of N te and N tr are linearly related to St jointly
guarantee that the evolutions of Wt e and Wt r in (A2) depend explicitly only on St. Lastly,
the derived evolution of the stock price in (A12) verifies the assumption that  P is an
endogenously determined parameter. This completes the verification procedure.
        Equations (A11), (A12) and (A13), (A24), and (A22) confirm equations (9), (10),
(11), (13), and (14) in the main text, respectively, and equations (A7) and (A21) together
confirm (12). This completes the proof of Proposition 1.                                     


B. Solving the Simultaneous Equations
           To solve equations (A26), (A27), (A28), (A31), (A32), and (A33), we group them
into three pairs of equations and solve each pair in sequence. First, we use (A26) and
(A31) to determine ae and B, where, in turn, we use (A14), (A24), and (A29) to express
 P , 1e , and ar as functions of ae and B. Second, we use (A27) and (A32) to determine
b e and A, where, in turn, we use (A24) and (A29) to express e0 and b r as functions of
b e , A, and B. Lastly, we solve each of (A28) and (A33) to obtain c e and c r , respectively.
The fact that the value function J i (W , S , t ) is multiplicatively separable in W, S, and t
simplifies the model and ensures tractability. For instance, our model has the feature that
the discount factor  only affects optimal consumption and optimal wealth, but not the
equilibrium price: for both types of investor, optimal share demand is unrelated to .


C. Proof of Corollary 1
         When all the traders in the economy are fully rational, (A21) reduces to
                                   I r (W r )  e rW K ,
                                                              r
                                                                                                                (A34)
where K is a constant to be determined. Substituting (A34) into (A10) and using N r  Q,
we know that the equilibrium stock price is

                                                     41
                                          2D      g      D
                                   Pt      2
                                                Q  D2  t .                                 (A35)
                                           r        r       r
This third term on the right-hand side of this equation shows that Pt is pegged to the
current level of the dividend; the other two terms capture dividend growth and
compensation for risk. Substituting (A34) and (A35) into the Bellman equation (A8)
determines the coefficient K as
                                     1        r    22DQ2 
                               K  exp                        .                           (A36)
                                     r       r          2r 
From (A9), optimal consumption is
                                   1                     r   2DQ2
                        C  rW  log(r K )  rW                     .                     (A37)
                                                         r       2r
From (A2), (A35), and (A37), optimal wealth evolves according to
                                    r   2DQ2          QD
                           dWt r                   dt        d .                       (A38)
                                     r        2 r          r
This completes the proof of Corollary 1.                                                 


D: Proof of Corollary 2
      Differentiating both sides of (A11) gives
                                                      g D dt   D d 
                            dPt  B( Sdt  dPt )                    .                    (A39)
                                                             r
If there is positive cash-flow news that increases the stock price by , then, from (A39),
the presence of sentiment in the equilibrium price will push the price up by a further
amount B, and then by a further amount 2B2, and so on. The total price increase due
to a shock of size  is therefore
                                                                            1
                      B  2 B 2     (1  B  2 B 2  )            .          (A40)
                                                                         1  B
This geometric series converges if and only if 1  |B|  0. That is, the price equation
(A11) is an “equilibrium” price equation if and only if 1  |B|  0.
        When all investors are extrapolators (  0), the market clearing condition implies
                                         0  rA  be2P
                                   0 
                                      e
                                                            Q,                             (A41)
                                               r 2P
                           1  rB  2ae2P
                   1e                       0  1  rB  2ae2P  0.                    (A42)
                                 r 2P
Substituting (A42) into (A26), we obtain
              0  ae [r  2(1 1)  2ae22P ]  ae [r (1  B) (2  1 )].            (A43)
Under the condition that 1  2, (A43) implies a  0. Given this, (A42) then implies that
                                                     e


                                            B  1 / r.                                      (A44)



                                               42
Since the necessary and sufficient condition for existence of the conjectured equilibrium
is 1  |B|  0, (A44) now means that a necessary condition for existence is
                                                 1  r.                                        (A45)
We have not yet shown the sufficiency of this condition; to do so, we need to check
(A27) and (A28) to see whether we can determine A, b e , and c e . Substituting a e  0 and
(A44) into (A27), we obtain
                            be  0     unless r  (1  1) .                                    (A46)
With b  0, we then obtain, from (A41), that
       e


                            0  Qr 2P 0  Q2D r 1 (1  1r 1 )2
                       A                                                .                      (A47)
                                 r                     r
                                                                    D
Now substituting a e  0, be  0, (A41), (A44), and  P                  into (A28) gives
                                                                (1  B)r
                                   r         22DQ2
                            ce                              log(r ) .                        (A48)
                                     r    2(1  1r 1 )2 r
Quite generally, then, we can solve for A, b e , and c e if condition (A45) holds. Therefore,
we can claim that (A45) is both a necessary and sufficient condition.
       We note that this proof does not rule out any nonlinear equilibria.                  


E: Proofs of Propositions 2 to 10
        The statistical properties of the sentiment process St can be derived by studying a
related process, Z t  e kt St , which evolves according to
                                       kekt g D
                                dZt            dt  ekt S d  .                           (A49)
                                          r
Unlike the sentiment process, the Zt process has a non-stochastic drift term, and is
therefore easier to analyze. We use this process repeatedly in our proofs of Propositions 2
to 6.

E.1. Proof of Proposition 2
        It is straightforward to calculate the price change expectations of rational traders.
Combining extrapolators’ belief about the instantaneous price change, (A15), and the
differential definition of the sentiment variable, (A1), we find that extrapolators’
subjective belief about the evolution of St is
                             dSt  [0  (1 1)St ]dt  S d e .                              (A50)
Extrapolators believe that e is a standard Wiener process. This means that, from the
perspective of extrapolators, the evolution of Z te  e mt St , where m  (1  1), is
                                   dZte  emt0dt  emt S d e .                               (A51)
                                             e
Using the statistical properties of the Z process, as perceived by extrapolators, we obtain
                                            t

(22). When m  0, applying L'Hôpital's rule to (22) gives (23).                              


                                                   43
E.2. Proof of Proposition 3
       From (A11), we know that
                                                                         
          cov D0 / r  P0 , Pt1  P0   B2 cov S0 , St1  S0  Br 1 cov S0 , Dt1  D0 .                                               (A52)
                                                          
It is obvious that cov S0 , Dt1  D0  0. Using the properties of the Z process, we can
show
                                                                                       (1  e kt1 )2S
                                                       
                                              cov S0 , St1  S0                          2k
                                                                                                        .                                  (A53)
We also obtain
                                                                                                        2S B2
                                         var  D0 / r  P0   B2 var  S0                                   .                           (A54)
                                                                                                         2k

Equations (A52), (A53), and (A54) then jointly give (26).                                                                              

E.3. Proof of Proposition 4
       For the autocorrelation structure of P  D/r, we know from (A11) that
                                                                                   
                                                           PD (t1 )  corr S0 , St1 .                                                    (A55)
We can show that
                                   
                                                                                             
                 cov S0 , St1  s  0  S0 s   0  S0  0  St1 s   0  St1  
                                                                                                                          
                                                  kt  g D 2  e kt1 2S                                                               (A56)
                                           s e 1  s                  .
                                                       r      2k
It is straightforward to show that var( S0 )  var( St1 )  2S / 2k . Putting these results
together, we obtain equation (27) in the main text.                                                                                    

E.4. Proof of Proposition 5
       From the price equation (A11), we know that the variance of price changes is
given by
                                                                                       
         var Pt1  P0  B2 var St1  S0  2Br 1 cov St1  S0 , Dt1  D0  r 2 var Dt1  D0 .                                          (A57)
                                        
The quantity var St1  S 0 can be expressed as

                                                 
                                                   
                                                                                          
                                                                                                                               
                                                                                          2
         var St1  S0  s  var St1  S0 s   s    St1  S0 s     St1  S0   ,                                             (A58)
                                                                                         
where the subscript s means that we are conditioning on S0  s. We can show
                                                                          (1  e2kt1 )2S
                                                                            
                                                           t1
          var St1  S0 s  e2kt1 var Zt1  Z0 s  e2kt1  e2kt 2S dt                   .                                               (A59)
                                                           0                    2k
Using the properties of the Z process, we also find that
                                                                                 g      
                                             0  St1  S0 s   (1  e kt1 )  D  s  ,                                               (A60)
                                                                                  r     

                                                                           44
and
                                                    (1  e kt1 )S D
                                            
                        cov St1  S0 , Dt1  D0 
                                                              k
                                                                       .                                                  (A61)
Substituting (A59) and (A60) into (A58) gives
                                                (1  e kt1 )2S
                              var St1  S0           k
                                                                .                                                         (A62)

Substituting (A61), (A62), and var( Dt1  D0 )  2Dt1 into (A57) gives equation (28) in the
main text. Combining the price equation (A11) with (A62) leads to (29).                                                

E.5. Proof of Proposition 6
       From (A11), we know that
                                                                                  
        cov Pt1  P0 , Pt3  Pt2  B2 cov St1  S0 , St3  St2  r 2 cov Dt1  D0 , Dt3  Dt2                    
                                                                                                                           (A63)
                                                                   
                   Br 1 cov St1  S0 , Dt3  Dt2  Br 1 cov St3  St2 , Dt1  D0 .                         
Using the properties of the Z process, we obtain
                                               2S  kt3  kt2 kt1
                                
                    cov St1  S0 , St3  St2 
                                               2k
                                                   e e        e 1 ,                                                 (A64)
and
                                              
                                                       
                  cov Dt1  D0 , St3  St2  S D e kt3  e kt2 ekt1  1 .
                                                k
                                                                                                                       (A65)


In addition, since the increments in future dividends are independent of any random
variable that is measurable with respect to the information set at the current time,
                                                                          
                     cov Dt1  D0 , Dt3  Dt2  cov St1  S0 , Dt3  Dt2  0 .                                            (A66)
Substituting (A64), (A65), and (A66) into (A63) yields the first equation in (31). The
second equation in (31) is derived in Proposition 5, and the third equation can be derived
in a similar way.                                                                        

E.6. Proof of Propositions 7 to 9
       From the budget constraints (A2), the price equation (A11), and the optimal
consumptions (A22), we know that aggregate wealth evolves as
                                    dW  (aW St2  bW St  cW )dt  W d  .                                               (A67)
Substituting this into (A22) yields
        Ct1  C0  r (Wt1  W0 )   1[a(St21  S02 )  b(St1  S0 )]
                       t1                                                       t1                                         (A68)
                   r  (aW St2  bW St  cW )dt  rW  d   1[a(St21  S02 )  b(St1  S0 )].
                       0                                                        0




                                                                    45
To compute cov(Ct1  C0 , Pt1  P0 ) and var(Ct1  C0 ), we first need to compute the
covariance of every combination of two terms in the last line of (A68). For example, one
of these covariances is17

                                                                                                   S
                                              t1                                                     t1
                                                s 0  St St1 s   dt  s 0  St1 s  
                    t1
         cov             St dt , St1                                                                                 s   dt
                    0                         0                                                  0
                                                                                                          s   0   t

                                                                                                                                       (A69)
                          (1  e kt1 )2S
                                          .
                               2k
The other covariance terms can be computed in a similar way. Rearranging and
simplifying terms, we obtain (33), (35), (37), and (39). Equation (34) has been derived in
Proposition 5.                                                                           

E.7. Proof of Propositions 10
        Substituting the equilibrium price equation (A11) and its evolution (A12) into our
                                         1
definition of the equity premium,   dPt  Dt dt  rPdt
                                                      t   , gives (40) in the main text. For
                                        dt
the Sharpe ratio, by the law of total variance,
          Var  dt1 (dPt  Dt dt  rPdt
                                      t  ) 
           s  Var  dt1 (dPt  Dt dt  rPdt
                                              t  ) s  St    Vars    dt1 (dPt  Dt dt  rPdt
                                                                                                    t  ) s  St                    (A70)
                                                          2
              2D        B              2D
                              rB               .
        (1  B) 2 r 2  1  B       2(1  B)r
                                                  2


Combining (40) with (A70) gives (41).                                                                                              


F: Estimating 

Estimating Equations
       Our objective is to estimate the model parameters , 0, and 1 using the survey
data.
       Suppose we have a time-series of aggregate stock market prices with sample
frequency t (we use t  ¼ for quarterly data). Then, at time t, the proper discretization
of (A1) is
                           S t (, n )   j  0 w( j; , n )( Pj  Pj  t ),
                                           n 1
                                                                                                                                       (A71)
                                 e   j t
where w( j; , n)                                 . Here the weighting functions are parameterized by  and
                              k 0 ek t
                                 n 1


by n, which measures how far back investors look when forming their beliefs. These
weights must sum to 1.

17
  The derivation of (A69) makes use of Fubini’s theorem. We have checked that the conditions that allow
the use of Fubini’s theorem hold in our context. For more on these conditions, see Theorem 1.9 in Liptser
and Shiryaev (2001).

                                                                    46
       The key assumption of our model is that extrapolators’ expected price change (not
expected return) is
                               te [ dPt ] / dt   0  1St ().                        (A72)

The expectation in (A72) is computed over the next instant of time, from t to t  dt, not
over a finite time horizon. In the surveys, however, investors are typically asked to state
their beliefs about stock market performance over the next year. It is therefore not fully
correct to estimate (, 0, 1) using (A72). We must instead compute what the model
implies for the price change extrapolators expect over a finite horizon. We do this in
Proposition 2 of the paper, and find:
                                                                                m (t1  t )  e  m ( t1 t )  1
          te [ Pt1  Pt | S t  s ]  ( 0  1 s )(t1  t )  1 ( 0  ms )                                   ,                 (A73)
                                                                                            m2
where m  (1  1 ).
        The first term on the right-hand side of (A73) is extrapolators’ expected price
change at time t,  0  1s, multiplied by the time horizon, t1  t. (For example, t1  t  0.5
for a six-month horizon). The second term captures extrapolators’ subjective beliefs
about how the sentiment level will evolve over the time horizon, t1  t , The parameters (,
0, 1) enter here in a non-linear fashion.
        To determine (, 0, 1), we therefore estimate both

                                     te [ Pt1  Pt ]  [ˆ 0  ˆ 1St (ˆ )](t1  t )  t1 ,                                      (A74)
and

                                                                                       m (t1  t )  e  m ( t1  t )  1
        te [ Pt1  Pt ]  [ˆ 0  ˆ 1St (ˆ )](t1  t )  ˆ 1 (ˆ ˆ 0  mSt (ˆ ))                                     t1 ,   (A75)
                                                                                                   m2
with m(ˆ , ˆ 1 )  ˆ (1  ˆ 1 ) and St (ˆ ) constructed as described above. We also estimate
equation (A75) for the special case where 1 is fixed at 1. In this case, equation (A75)
becomes:

                                                                                ˆ ˆ 0 (t1  t ) 2
                              te [ Pt1  Pt ]  [ˆ 0  St (ˆ )](t1  t )                          t1 .                        (A76)
                                                                                         2

Survey Data
        We estimate equations (A74), (A75), and (A76) using the Gallup survey data
studied by Greenwood and Shleifer (2013) and others. We start with the “rescaled”
version of the series described in that paper. After the rescaling, the reported expectations
are in units of percentage expected returns on the aggregate stock market over the
following 12 months. We then convert this series into expected price changes by
multiplying by the level of the S&P 500 price index at the end of the month in which
participants have been surveyed. That is,



                                                                47
                                                         Pt  Pt
                                te [ Pt1  Pt ]   te [ 1      ]  Pt                     (A77)
                                                            Pt
                                                   
                                                       Survey

The resulting Gallup series comprises 135 datapoints between October 1996 and
November 2011. The data are monthly but there are also some gaps.
        We estimate equations (A74), (A75), and (A76) using nonlinear least squares
regression. We use 60 quarters of lagged price changes in the S&P 500 price index when
constructing S above. We report coefficients and Newey West standard errors using a lag
length of 6 months.

     Coefficient          Equation (A74)                  Equation (A75)   Equation (A76)

          β                     0.49                              0.44         0.68
       [t-stat]                [6.50]                            [5.77]       [10.73]
          λ0                    0.09                              0.07         0.07
       [t-stat]               [30.24]                           [35.41]       [36.18]
          λ1                    1.35                              1.32
       [t-stat]                [8.70]                            [9.48]

      R-squared                0.77                              0.74           0.75




                                        References

Alti, Aydogan, and Paul Tetlock. 2013. “Biased Beliefs, Asset Prices, and Investment: A
Structural Approach.” Journal of Finance, forthcoming.

Amromin, Gene, and Steven A. Sharpe. 2008. “Expectation of Risk and Return Among
Household Investors: Are their Sharpe Ratios Countercyclical?” Finance and Economics
Discussion Series Working Paper, 2008-17, Federal Reserve Board, Washington DC.

Bacchetta, Philippe, Elmar Mertens, and Eric van Wincoop. 2009. “Predictability in
Financial Markets: What Do Survey Expectations Tell Us?” Journal of International
Money and Finance, 406-426.

Bansal, Ravi, and Amir Yaron. 2004. “Risks for the Long Run: A Potential Resolution of
Asset Pricing Puzzles.” Journal of Finance 59, 1481–1509.

Bansal, Ravi, Dana Kiku, and Amir Yaron. 2012. “An Empirical Evaluation of the Long-
Run Risks Model for Asset Prices.” Critical Finance Review 1, 183–221.

Barberis, Nicholas, Ming Huang, and Tano Santos. 2001. “Prospect Theory and Asset
Prices.” Quarterly Journal of Economics 116, 1–53.

Barberis, Nicholas, and Andrei Shleifer. 2003. “Style Investing.” Journal of Financial
Economics 68, 161–199.

                                                 48
Barberis, Nicholas, Andrei Shleifer, and Robert Vishny. 1998. “A Model of Investor
Sentiment.” Journal of Financial Economics 49, 307–343.

Barro, Robert. 2006. “Rare Disasters and Asset Markets in the Twentieth Century.”
Quarterly Journal of Economics 121, 823–866.

Brunnermeier, Markus, and Stefan Nagel. 2004. “Hedge Funds and the Technology
Bubble.” Journal of Finance 59, 2013-2040.

Campbell, John, and John Cochrane. 1999. “By Force of Habit: A Consumption-Based
Explanation of Aggregate Stock Market Behavior.” Journal of Political Economy 107,
205–251.

Campbell, John, and Robert Shiller. 1988. “The Dividend-Price Ratio and Expectations
of Future Dividends and Discount Factors.” Review of Financial Studies 1, 195–228.

Choi, James. 2006. “Extrapolative Expectations and the Equity Premium.” Working
paper, Yale University.

Cochrane, John. 2011. “Presidential Address: Discount Rates.” Journal of Finance 66,
1047–1108.

Cutler, David, James Poterba, and Lawrence Summers. 1990. “Speculative Dynamics and
the Role of Feedback Traders.” American Economic Review Papers and Proceedings 80,
63–68.

De Long, Brad, Andrei Shleifer, Lawrence Summers, and Robert Waldman. 1990a.
“Noise Trader Risk in Financial Markets.” Journal of Political Economy 98, 703–738.

De Long, Brad, Andrei Shleifer, Lawrence Summers, and Robert Waldman. 1990b.
“Positive Feedback Investment Strategies and Destabilizing Rational Speculation.”
Journal of Finance 45, 379–395.

Fama, Eugene, and Kenneth French. 1988. “Dividend Yields and Expected Stock
Returns.” Journal of Financial Economics 22, 3–25.

Fuster, Andreas, Benjamin Hebert, and David Laibson. 2011. “Natural Expectations,
Macroeconomic Dynamics, and Asset Pricing.” NBER Macroeconomics Annual 26, 1–
48.

Gabaix, Xavier. 2012. “Variable Rare Disasters: An Exactly Solved Framework for Ten
Puzzles in Macro-Finance.” Quarterly Journal of Economics 127, 645–700.

Greenwood, Robin, and Andrei Shleifer. 2013. “Expectations of Returns and Expected
Returns.” Working paper, Harvard University.

Hansen, Lars, and Kenneth Singleton. 1982. “Generalized Instrumental Variables
Estimation of Nonlinear Rational Expectations Models.” Econometrica 50, 1269-1286.

                                          49
Hansen, Lars, and Kenneth Singleton. 1983. “Stochastic Consumption, Risk Aversion,
and the Temporal Behavior of Asset Returns.” Journal of Political Economy 91, 249-265.

Hirshleifer, David, and Jianfeng Yu. 2013. “Asset Pricing with Extrapolative
Expectations and Production.” Working paper, University of California and University of
Minnesota.

Hong, Harrison, and Jeremy Stein. 1999. “A Unified Theory of Underreaction,
Momentum Trading, and Overreaction in Asset Markets.” Journal of Finance 54, 2143–
2184.

Ju, Nengjiu, and Jianjun Miao. 2012. “Ambiguity, Learning, and Asset Returns.”
Econometrica 80, 559–591.

Kushner, Harold. 1967. Stochastic Stability and Control (Academic Press, New York).

LeRoy, Stephen, and Richard Porter. 1981. “The Present-Value Relation: Tests Based on
Implied Variance Bounds.” Econometrica 49, 555574.

Lettau, Martin, and Sydney Ludvigson. 2001. “Consumption, Aggregate Wealth, and
Expected Stock Returns.” Journal of Finance 56, 815–849.

Lipster, Robert, and Albert Shiryaev. 2001. Statistics of Random Processes I, General
Theory, 2nd edition (Springer-Verlag, New York).

Malmendier, Ulrike, and Stefan Nagel. 2011. Depression-babies: Do Macroeconomic
Experiences Affect Risk-taking? Quarterly Journal of Economics 126, 373-416.

Mehra, Rajnish, and Edward Prescott. “The Equity Premium: A Puzzle.” Journal of
Monetary Economics 15, 145161.

Merton, Robert. 1971. “Optimum Consumption and Portfolio Rules in a Continuous-
Time Model.” Journal of Economic Theory 3, 373–413.

Rabin, Matthew. 2002. “Inference by Believers in the Law of Small Numbers.” Quarterly
Journal of Economics 117, 775–816.

Rietz, Thomas. 1988. “The Equity Risk Premium: A Solution.” Journal of Monetary
Economics 22, 117–131.

Shiller, Robert. 1981. “Do Stock Prices Move Too Much to be Justified by Subsequent
Changes in Dividends?” American Economic Review 71, 421436.

Timmermann, Alan. 1993. “How Learning in Financial Markets Generates Excess
Volatility and Predictability in Stock Prices.” Quarterly Journal of Economics 108,
1135–1145.

Vissing-Jorgensen, Annette. 2004. “Perspectives on Behavioral Finance: Does

                                           50
‘Irrationality’ Disappear with Wealth? Evidence from Expectations and Actions,” in
NBER Macroeconomics Annual, Volume 18, eds. Mark Gertler and Kenneth Rogoff,
Cambridge, MA: MIT Press.

Wachter, Jessica. 2013. “Can Time-Varying Risk of Rare Disasters Explain Aggregate
Stock Market Volatility?” Journal of Finance 68, 987–1035.




                                          51
                    Table 1: Selected Models of the Aggregate Stock Market




                                                             Model                                  Accounts   Accounts
                                                             allows for     D/P        Accounts     for        for
                                                             intermediate   predicts   for          equity     survey
                                                             consumption    returns    volatility   premium    evidence
TRADITIONAL
Habit               Campbell and Cochrane (1999)                 Yes          Yes         Yes         Yes        No


                    Bansal and Yaron (2004)                      Yes          No          Yes         Yes        No
Long-run risk
                    Bansal, Kiku, and Yaron (2012)               Yes          Yes         Yes         Yes        No


                    Rietz (1988), Barro (2006)                   Yes          No          No          Yes        No
Rare disasters
                    Gabaix (2012), Wachter (2013)                Yes          Yes         Yes         Yes        No


LEARNING            Timmerman (1993)                             Yes          Yes         Yes         No         No


BEHAVIORAL
Preference-based
Prospect theory     Barberis, Huang, and Santos (2001)           Yes          Yes         Yes         Yes        No

Ambiguity
                                                                 Yes          Yes         Yes         Yes        No
aversion            Ju and Miao (2012)


Belief-based
Noise trader risk   De Long et al. (1990a)                       Yes          Yes         Yes         No         No


                    Barberis, Shleifer, Vishny (1998)            No           Yes         Yes         No         No
                    Choi (2006)                                  Yes          Yes         Yes         No         No
Extrapolation of
                    Fuster, Herbert, Laibson (2011)              Yes          Yes         Yes         No         No
fundamentals
                    Alti and Tetlock (2013)                      No           Yes         Yes         No         No
                    Hirshleifer and Yu (2013)                    Yes          Yes         Yes         No         No


                    Cutler, Poterba, Summers (1989)              No           Yes         Yes         No         Yes
                    De Long et al. (1990b)                       No           Yes         Yes         No         Yes
Extrapolation of    Hong and Stein (1999)                        No           Yes         Yes         No         Yes
returns
                    Barberis and Shleifer (2003)                 No           Yes         Yes         No         Yes
                    Barberis, Greenwood, Jin, and Shleifer
                                                                 Yes          Yes         Yes         No         Yes
                    (2013)




                                                        52
                                           Table 2: Parameter Values

The table reports the values we assign to the risk-free rate r; the per unit time mean gD and standard deviation D of
dividend changes; the risky asset per-capita supply Q; absolute risk aversion ; the discount rate ; the proportion 
of rational traders in the economy; the parameters , 0 and 1 which govern the beliefs of extrapolators; the initial
level of the dividend D0; and the initial wealth levels,     and     , of extrapolators and rational traders, respectively.


                                          Parameter                  Value
                                               r                     2.50%
                                              gD                      0.05
                                              σD                      0.25
                                              Q                        5
                                                                     0.1
                                              δ                      1.50%
                                                             {0.25, 0.5, 0.75, 1}
                                              β                 {0.05, 0.5, 0.75}
                                              λ0                       0
                                              λ1                       1
                                              D0                       10
                                                                     5000
                                                                     5000




                                                           53
               Table 3: Predictive Power of D/r  P for Future Stock Price Changes
The table reports the population estimate of the regression coefficient when regressing the price change from time t
to time t  k (in quarters) on the time t level of D/r  P for k =1, 4, 8, 12, and 16, and for various pairs of values of
the parameters μ and β:
                                            Pt  k  Pt  a  b( Dt / r  Pt )  ε t  k .
The calculations make use of Proposition 3 in the main text.


                                                                       
                β            k              1               0.75               0.5               0.25
                             1              -              0.014              0.016             0.022
                             4              -              0.055              0.064             0.085
               0.05          8              -              0.106              0.124             0.162
                            12              -              0.155              0.180             0.233
                            16              -              0.201              0.233             0.298
                             1              -              0.134              0.161             0.219
                             4              -              0.438              0.504             0.628
               0.5           8              -              0.684              0.754             0.861
                            12              -              0.822              0.878             0.948
                            16              -              0.900              0.940             0.981
                             1              -              0.194              0.232             0.311
                             4              -              0.579              0.652             0.774
               0.75          8              -              0.822              0.879             0.949
                            12              -              0.925              0.958             0.988
                            16              -              0.968              0.985             0.997




                                                           54
                                    Table 4: Autocorrelations of P  D/r

The table reports the autocorrelation of P  D/r at various lags k (in quarters) and for various pairs of values of the
parameters  and . The calculations make use of Proposition 4 in the main text.


                                                                       
                β            k             1               0.75               0.5               0.25
                             1              -              0.986             0.984             0.978
                             4              -              0.945             0.936             0.915
               0.05          8              -              0.894             0.876             0.838
                            12              -              0.845             0.820             0.767
                            16              -              0.799             0.767             0.702
                             1              -              0.866             0.839             0.781
                             4              -              0.562             0.496             0.372
               0.5           8              -              0.316             0.246             0.139
                            12              -              0.178             0.122             0.052
                            16              -              0.100             0.060             0.019
                             1              -              0.806             0.768             0.689
                             4              -              0.421             0.348             0.226
               0.75          8              -              0.178             0.121             0.051
                            12              -              0.075             0.042             0.012
                            16              -              0.032             0.015             0.003




                                                           55
                    Table 5: Volatility of Price Changes and Volatility of P  D/r

Panel A reports the volatility of annual price changes for various pairs of values of the parameters μ and β; Panel B
reports the volatility of P  D/r, measured at an annual frequency, for various pairs of μ and β. The calculations
make use of Proposition 5 in the main text.


                                    Panel A: Volatility of Annual Price Changes

                                                                
                                      1             0.75            0.5             0.25
                        0.05           10            11.20           13.15           17.43
                         0.5           10            11.17           13.03           16.86
                        0.75           10            11.04           12.67           15.90

                                        Panel B: Volatility of Annual P  D/r

                                                                
                                      1             0.75            0.5             0.25
                        0.05            0             1.21           3.19             7.53
                         0.5            0             1.32           3.42             7.77
                        0.75            0             1.25           3.20             7.09




                                                         56
                                                      Table 6: Autocorrelations of Price Changes

The table reports the autocorrelations of quarterly and cumulative stock price changes at various lags k (in quarters) and for various pairs of values of the
parameters μ and β. The calculations make use of Proposition 6 in the main text.



                                                Autocorrelations at Horizon k                          Cumulative Autocorrelations to Horizon k
                                                                                                                          
                             k            1         0.75           0.5       0.25                      1          0.75           0.5       0.25
                               1            0        -0.001        -0.003     -0.007                     0         -0.001        -0.003     -0.007
                               2            0        -0.001        -0.003     -0.007                     0         -0.002        -0.005     -0.010
                               3            0        -0.001        -0.003     -0.007                     0         -0.002        -0.006     -0.013
                  0.05
                               4            0        -0.001        -0.003     -0.007                     0         -0.003        -0.007     -0.015
                               8            0        -0.001        -0.003     -0.006                     0         -0.004        -0.010     -0.020
                               12           0        -0.001        -0.003     -0.006                     0         -0.005        -0.011     -0.024
                               1            0        -0.016        -0.038     -0.079                     0         -0.016        -0.038     -0.079
                               2            0        -0.013        -0.032     -0.062                     0         -0.021        -0.050     -0.103
                               3            0        -0.012        -0.027     -0.048                     0         -0.024        -0.058     -0.118
                  0.5
                               4            0        -0.010        -0.022     -0.038                     0         -0.026        -0.063     -0.127
                               8            0        -0.006        -0.011     -0.014                     0         -0.029        -0.070     -0.138
                               12           0        -0.003        -0.006     -0.005                     0         -0.029        -0.069     -0.134
                               1            0        -0.022        -0.054     -0.110                     0         -0.022        -0.054     -0.110
                               2            0        -0.018        -0.041     -0.076                     0         -0.029        -0.069     -0.140
                               3            0        -0.014        -0.032     -0.053                     0         -0.032        -0.077     -0.154
                  0.75
                               4            0        -0.012        -0.024     -0.036                     0         -0.034        -0.081     -0.161
                               8            0        -0.005        -0.008     -0.008                     0         -0.035        -0.083     -0.159
                               12           0        -0.002        -0.003     -0.002                     0         -0.033        -0.077     -0.147




                                                                                 57
                         Table 7: Consumption, P  D/r, and Price Changes

Panel A shows the correlation between quarterly changes in consumption and quarterly changes in price; Panel B
shows the correlation between annual changes in consumption and annual changes in price; Panel C shows the
correlation between the annual change in consumption and P  D/r. The calculations make use of Propositions 7 and
8 in the main text.

             Panel A: Correlation between quarterly consumption changes and quarterly price changes

                                                             
                                          1         0.75         0.5       0.25
                               0.05         1        0.994        0.985      0.984
                               0.5          1        0.929        0.842      0.840
                               0.75         1        0.903        0.794      0.792

               Panel B: Correlation between annual consumption changes and annual price changes

                                                             
                                          1         0.75         0.5       0.25
                               0.05         1        0.994        0.985      0.984
                               0.5          1        0.947        0.878      0.876
                               0.75         1        0.935        0.853      0.849

                    Panel C: Correlation between quarterly consumption changes and P  D/r

                                                             
                                          1         0.75         0.5       0.25
                               0.05         -        0.152        0.148      0.148
                               0.5          -        0.436        0.398      0.409
                               0.75         -        0.504        0.446      0.456




                                                       58
       Table 8: Predictive Power of Changes in Consumption for Future Price Changes

The table reports the population estimate of the regression coefficient when regressing the price change from time t
to time t  k (in quarters) on the most recent quarterly consumption change for k  1, 4, 8, 12, 16, and for various
pairs of values of the parameters  and :
                                         Pt  k  Pt  a  b(Ct  Ct 1 )  ε t  k .
The calculations make use of Proposition 9 in the main text.


                                                                           
                       k              1                   0.75                    0.5        0.25
                         1              0                  -0.011                 -0.026      -0.053
                         4              0                  -0.043                 -0.101      -0.205
           0.05          8              0                  -0.084                 -0.195      -0.393
                        12              0                  -0.123                 -0.284      -0.565
                        16              0                  -0.159                 -0.366      -0.722
                         1              0                  -0.107                 -0.214      -0.442
                         4              0                  -0.350                 -0.671      -1.266
            0.5          8              0                  -0.547                 -1.003      -1.738
                        12              0                  -0.658                 -1.168      -1.914
                        16              0                  -0.720                 -1.250      -1.979
                         1              0                  -0.144                 -0.270      -0.552
                         4              0                  -0.429                 -0.759      -1.375
           0.75          8              0                  -0.609                 -1.023      -1.686
                        12              0                  -0.686                 -1.115      -1.756
                        16              0                  -0.718                 -1.147      -1.772




                                                            59
                               Table 9: Equity Premia and Sharpe Ratios

Panel A reports equity premia for various pairs of values of the parameters  and ; Panel B reports Sharpe ratios
for various pairs of  and . The calculations make use of Proposition 10 in the main text.

                                              Panel A: Equity Premia

                                                                
                                            1         0.75          0.5       0.25
                                0.05        1.25        1.58         2.19       3.91
                                 0.5        1.25        1.65         2.46       4.88
                                0.75        1.25        1.66         2.48       4.92




                                               Panel B: Sharpe Ratios

                                                                
                                            1         0.75          0.5       0.25
                                0.05       0.125       0.140         0.165      0.220
                                 0.5       0.125       0.143         0.173      0.233
                                0.75       0.125       0.143         0.172      0.227




                                                         60
                       Table 10: Model Predictions for Ratio-based Quantities

The table summarizes the model’s predictions for ratio-based quantities. A full description of these quantities can be
found in Section 5.2 of the main text. The values of the basic model parameters are given in Table 2, and  (the
fraction of rational traders) is 0.25. For   0.05, 0.5, and 0.75, we report estimates of each quantity averaged over
10,000 simulated paths. In rows (1), (8), and (9), we report both a regression coefficient and, in parentheses, an R-
squared. The right column shows the empirical estimates for the post-war period from 1947-2011 (1952-2011 for
consumption-related quantities because nondurable consumption data are available only from 1952).


                                                                                              post-war U.S. stock
          quantity of interest
                                                            0.05         0.5        0.75           market data

                (1) predictive power of                     0.29        0.46         0.45              0.11
                       log(D/P)                            (0.20)      (0.22)       (0.21)            (0.08)
               (2) autocorrelation of P/D                   0.93        0.84        0.85                 0.94
             (3) excess volatility of returns               2.32        2.91        2.97                   -
              (4) excess volatility of P/D                  7.21        4.85        4.55                   -
    (5) autocorrelation of log excess return (k = 1)        -0.01       -0.09       -0.14                0.11
      autocorrelation of log excess return (k = 8)          -0.01       -0.01       -0.01                -0.02
          (6) correlation between Δ4c and                   0.72        0.54        0.47                 0.32
   (7) correlation between surplus consumption and
                                                            0.26        0.33        0.27                 0.10
                          P/D
                (8) predictive power of                    -0.27       -0.89        -0.77              -0.77
             the surplus consumption ratio                 (0.15)      (0.18)       (0.17)            (0.09)
                (9) predictive power of                     0.51        0.12         0.01        0.02             0.33
                       log(C/W)                            (0.15)      (0.15)       (0.15)      (0.03)           (0.05)
                 (10) equity premium                       1.16%       1.62%       1.64%              7.97%
                     Sharpe ratio                           0.12        0.14        0.13               0.44




                                                         61
