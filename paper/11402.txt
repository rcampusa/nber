                                  NBER WORKING PAPER SERIES




                           EFFICIENT KIDNEY EXCHANGE:
                  COINCIDENCE OF WANTS IN A STRUCTURED MARKET

                                               Alvin E. Roth
                                              Tayfun Sönmez
                                              M. Utku Ünver

                                          Working Paper 11402
                                  http://www.nber.org/papers/w11402


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                       June 2005




We thank Audrey Bohnengel, Kevin Cheung, Francis Delmonico, Michael Goemans, Selçuk Karabati,
Jonathan Kopke, Michael Rees, Susan Saidman, JunWako and SteveWoodle for discussions and comments,
Rui Dong for her research assistance, Hüseyin Çankaya for his assistance on drawing the figures. Sönmez
acknowledges the research support of KoçBank via the KoçBank scholar program and Turkish Academy of
Sciences in the framework of the Young Scientist Award Program via grant TS/TÜBAGEBúIP/2002-1-19,
and Roth and Ünver acknowledge support from the NSF via grant no: 0338619. Any errors are our own.
The views expressed herein are those of the author(s) and do not necessarily reflect the views of the National
Bureau of Economic Research.

©2005 by Alvin E. Roth, Tayfun Sönmez, and M. Utku Ünver. All rights reserved. Short sections of text,
not to exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
Efficient Kidney Exchange: Coincidence of Wants in a Structured Market
Alvin E. Roth, Tayfun Sönmez, and M. Utku Ünver
NBER Working Paper No. 11402
June 2005
JEL No. C7, C6

                                          ABSTRACT

Patients needing kidney transplants may have willing donors who cannot donate to them because of

blood or tissue incompatibility. Incompatible patient-donor pairs can exchange donor kidneys with

other such pairs. The situation facing such pairs resembles models of the "double coincidence of

wants," and relatively few exchanges have been consummated by decentralized means. As the

population of available patient-donor pairs grows, the frequency with which exchanges can be

arranged will depend in part on how exchanges are organized. We study the potential frequency of

exchanges as a function of the number of patient-donor pairs, and the size of the largest feasible

exchange. Developing infrastructure to identify and perform 3-way as well as 2-way exchanges will

have a substantial effect on the number of transplants, and will help the most vulnerable patients.

Larger than 3-way exchanges have much smaller impact. Larger populations of patient-donor pairs

increase the percentage of patients of all kinds who can find exchanges.

Alvin E. Roth                                        M. Utku Ünver
Harvard University                                   Koç University
Department of Economics                              Department of Economics
Littauer 308                                         Rumelifeneri Yolu, Sariyer, 34450
Cambridge, MA 02138-3001                             Istanbul Turkey
and NBER                                             uunver@ku.edu.tr
al_roth@harvard.edu

Tayfun Sönmez
Koç University
Department of Economics
Rumelifeneri Yolu, Sariyer, 34450
Istanbul Turkey
tsonmez@ku.edu.tr
1       Introduction
In 2003 there were 8,665 transplants of deceased donor kidneys for the approximately 60,000
patients waiting for such transplants in the U.S.. While waiting, 3,436 patients died. There
were also 6,464 kidney transplants from living donors.1
    A patient is often unable to receive a willing live-donor’s kidney, because of blood-type
incompatibility or antibodies to one of the donor’s proteins (“positive crossmatch”). Recently
a few “paired kidney donations” have been performed between two such incompatible patient-
donor pairs: the donor in each pair gives a kidney to the other pair’s compatible patient.
The National Organ Transplant Act of 1984 makes it illegal to buy or sell a kidney, and so
incompatible patient donor pairs are faced squarely with Jevons’ classic problem of the “double
coincidence of wants:”

            Jevons (1876), Chapter 1: “The Þrst diﬃculty in barter is to Þnd two persons
        whose disposable possessions mutually suit each other’s wants. There may be many
        people wanting, and many possessing those things wanted; but to allow of an act of
        barter, there must be a double coincidence, which will rarely happen. ... the owner
        of a house may Þnd it unsuitable, and may have his eye upon another house exactly
        Þtted to his needs. But even if the owner of this second house wishes to part with
        it at all, it is exceedingly unlikely that he will exactly reciprocate the feelings of the
        Þrst owner, and wish to barter houses. Sellers and purchasers can only be made to
        Þt by the use of some commodity... which all are willing to receive for a time, so
        that what is obtained by sale in one case, may be used in purchase in another. This
        common commodity is called a medium, of exchange, because it forms a third or
        intermediate term in all acts of commerce.”

   Partly because of the diﬃculty of Þnding these double coincidences, there have been few such
exchanges: In the fourteen transplant centers in New England (The United Network for Organ
Sharing — UNOS — region 1), Þve such 2-way exchanges had been conducted as of December
2004 (cf. Delmonico, 2004). There have also been a very few 3-way exchanges (Lucan et al.
2003)2 , two in the United States, by Dr. Robert Montgomery’s program at Johns Hopkins. All
surgeries in an exchange are done simultaneously (so 2-way exchange requires four simultaneous
surgeries, and 3-way requires six), and so larger exchanges pose more logistical diﬃculties.
    1
     The U.S. ScientiÞc Registry of Transplant Recipients http://www.ustransplant.org/srtr.php. Live
donation of kidneys is possible because people have two kidneys, and because healthy people suﬀer little risk
from donating one.
   2
     In a three-way exchange, the donor from one pair gives a kidney to the patient of a second pair, whose
donor gives to the patient in a third pair, whose donor gives to the patient in the Þrst pair.

                                                     2
    One theme of the present paper is that some of the diﬃculties that Jevons attributes to
the absence of a medium of exchange will also loom large whenever a thick market is lacking.
Even with a medium of exchange, Jevons’ second house owner would be reluctant to part with
his house if no suitable third house could be found. And we will show that, even without a
medium of exchange, the problem of the coincidence of wants can be substantially ameliorated
by the presence of an appropriate market structure.
    One reason there have been so few exchanges is that until recently there have been no
databases of incompatible patient-donor pairs: incompatible donors were simply not further
considered. This is starting to change. In September, 2004, the New England Program for
Kidney Exchange, proposed by Drs. Francis Delmonico, Susan Saidman, and the three authors
of this paper was approved by the Renal Transplant Oversight Committee of New England. (It
will be administered through the New England Organ Bank.) Databases for identifying kidney
exchanges have also been initiated in Ohio and Baltimore. As these centers start to open their
doors to patient-donor pairs, one of the primary tasks is to design a clearinghouse that can
identify eﬃcient sets of feasible exchanges among incompatible patient-donor pairs (cf. Roth,
Sönmez, and Ünver, 2004a,b, 2005, Segev et al. 2005).
    The “coincidence of wants” for kidney exchange has a structure determined in part by the
blood types of the patients and donors. Consequently it is possible to bring simple theory to
bear on the question of how eﬃcient such exchange can be, operating just as a gift-exchange, in
the absence of any medium of exchange.3 Computational results on real and simulated patient
data (Saidman et al. 2005) suggest that as the available population of incompatible patient-
donor pairs grows, an increasing percentage of patients will be able to receive a transplant
via a two way exchange, that three-way exchanges will continue to be important for achieving
eﬃcient exchange, and that most of the eﬃciency gains from exchanges larger than 2-way are
captured by including 3-way exchanges.4 In the present paper we explore why this is the case.
That is, we investigate the structure of eﬃcient exchange, without a medium of exchange, when
supply and demand are mediated by blood types.
    Furthermore, we will prove that, under the conditions of supply and demand that can
normally be expected in a population of incompatible patient-donor pairs available for exchange,
if we abstract away from tissue type incompatibilities and look at only the barriers to exchange
   3
     There is also a literature devoted to the discussion of whether the ban on the buying and selling of kidneys
should be repealed. See e.g. Becker and Elias (2002), and the survey of this literature in Nadel and Nadel
(2005).
   4
     We have recently been able to conÞrm this on a database of patient-donor pairs assembled in Ohio by
Dr. Steve Woodle, Dr. Michael Rees, Jonathan Kopke and their colleagues in the Paired Donation Kidney
Consortium.



                                                       3
caused by blood-type incompatibilities, all eﬃcient exchanges can be accomplished in exchanges
involving no more than four incompatible pairs.



2     Background
There are four blood types A, B, AB, and O (corresponding to the presence of proteins A or B,
or both together, or neither) and blood-type incompatibility has a very well-deÞned structure:
a patient may not receive the kidney of a donor whose blood contains one of the A,B proteins
that the patient does not have. Thus patients with blood type O can only receive a kidney from
an O donor, type A patients can receive A or O kidneys, B patients B or O kidneys, and AB
patients can receive a kidney from a donor of any blood type. Note that a patient with blood
type O has the most diﬃculty Þnding a compatible donor, while O donors will never have a
blood type incompatibility with any patient.
    Tissue-type incompatibility (“positive crossmatch”) is much less structured and has to do
with the patient having preformed antibodies against one of the donor’s proteins. Antibodies
can arise from exposure to foreign proteins, e.g. through prior transplants, blood transfusions,
or even childbirth. (Consequently mothers are less likely to be compatible with a kidney from
the father of their children than from a random donor from the same population.)

   An example helps illustrate why 3-way exchange is important. Consider a population of 9
incompatible patient-donor pairs. (A pair is denoted as type x-y if the patient and donor are
ABO blood-types x and y respectively.)

    • Example: There are Þve pairs of patients who are blood-type incompatible with their
      donors, of types O-A, O-B, A-B, A-B, and B-A; and four pairs who are incompatible
      because of positive crossmatch, of types A-A, A-A, A-A and B-O. For simplicity in this
      example there are no positive crossmatches between patients and other patients’ donors.

   Then 6 transplants can result from the three possible 2-way exchanges, namely (A-B,B-A);
(A-A,A-A); (B-O,O-B), where e.g. (A-B,B-A) denotes an exchange in which a pair of type
(A-B) donates a B kidney to the patient in the pair of type (B-A) and receives an A kidney
from the donor in that pair. When only 2-way exchanges are feasible, these three exchanges
constitute a maximal set of exchanges: no other way of arranging exchanges would result in
more than 6 transplants. But if 3-way exchanges are also feasible, then 8 transplants can be
arranged via one 2-way exchange and two 3-way exchanges: (A-B,B-A); (A-A,A-A,A-A); (B-
O,O-A,A-B). (In the 3-way exchanges, the donor in the Þrst pair donates to the patient in the

                                               4
second pair, the second donor donates to the third patient, and the third donor to the Þrst
patient. E.g. in the third exchange, the O donor from the B-O pair donates to the O patient
of the O-A pair, etc.)
    The 3-way exchanges allow

    1. an odd number of A-A pairs to be transplanted (instead of only an even number with
       2-way exchanges), and

    2. an O donor to facilitate three transplants rather than only two.

    While the diﬀerence between even and odd numbers of pairs will become proportionately
smaller as the population of incompatible pairs grows, the importance of making good use
of O donors will remain. O donors will be relatively rare among incompatible patient-donor
pairs, because O donors are only incompatible with their intended recipient if there is a positive
crossmatch.
    In this example the only positive crossmatches were between patients and their own donors,
but in actual populations there will be positive crossmatches between patients and other donors,
particularly since a patient with a positive crossmatch with his own donor is more likely than
average to be a highly sensitized patient who has antibodies to proteins in a high percentage of
potential donors. In such a case there may be more conÞgurations in which a 3-way exchange
will be helpful. For instance, suppose in our example the 2-way exchange (A-B, B-A) had
been infeasible because of a positive crossmatch between the A patient in the Þrst pair and
the A donor in the second pair. A 3-way exchange (A-B, B-A, A-A) might nevertheless be
possible, using one of the A-A pairs. However the case in which there are only blood-type
incompatibilities (and no positive crossmatches) between patients and donors other than their
own will allow us to establish an upper bound on the number of exchanges that are possible,
since the presence of positive crossmatches can only reduce the set of feasible exchanges.


3     The Model
There are a number of kidney patients, each with an incompatible living donor. The incompat-
ibility can be either a blood-type incompatibility or a tissue-type incompatibility (a positive
crossmatch).
    A two-way kidney exchange involves two patients each of whom is incompatible with her
own donor but compatible with the other donor. When the two-way exchange is carried out,
both patients receive a kidney from other’s donor. A three-way kidney exchange involves
three patients i, j, k each of whom is incompatible with her own donor but such that patient i is

                                                5
compatible with the donor of patient j, patient j is compatible with the donor of patient k, and
patient k is compatible with the donor of patient i. As in the case of two-way exchange, each
patient involved in the trade receives a compatible kidney as a result of the three-way kidney
exchange. A four-way kidney exchange is deÞned similarly.
   While patients can have tissue-type incompatibility with their own donors, to establish an
upper bound on the number of possible exchanges we will assume that:
   Assumption 1 (Upper bound assumption). No patient is tissue-type incompatible
with another patient’s donor.5
   We will derive analytical expressions for the maximum number of patients who can beneÞt
from a feasible set of kidney exchanges among a large population of incompatible pairs, when
the only constraints on exchange are imposed by

   1. blood-type incompatibility, and

   2. the number of patients allowed in each exchange.

    Given the “upper bound” assumption, whether a patient can be part of a given exchange
depends on her own blood-type together with her donor’s blood-type. When we speak of a type
A-AB patient-donor pair, we mean a patient-donor pair in which the patient is of blood-type
A while her incompatible donor is of blood-type AB. The number of type A-AB patient-donor
pairs will be denoted by #(A-AB). We use analogous notation for all 16 types of patient-donor
pairs. We refer to type A-B pairs and type B-A pairs as opposite types, and use the same
terminology for other types as well.
    Patients with blood type O will be incompatible with their donors unless the donor also
has blood type O, and donors with blood type AB will be incompatible with their intended
recipient unless she also is AB. So pairs of these types will be over-represented in populations
of incompatible patient-donor pairs. And, when exchanges are carried out, there will be higher
demand for O kidneys than A kidneys and higher demand for A kidneys than AB kidneys.
Similarly there will be higher demand for O kidneys than B kidneys and higher demand for B
kidneys than AB kidneys. This puts pairs of types O-A, O-B, O-AB, A-AB, and B-AB at a
disadvantage since they need a kidney that is in higher demand than the kidney they oﬀer. So
these type pairs will both occur more frequently and wait longer for an exchange than other
   5
    When we later dispense with this assumption to consider populations with the tissue type incompatibilities
found in the national patient population, we will see that, in large markets, this assumption isn’t very conse-
quential. The reason is that, although a patient who is tissue type incompatible with her own donor will likely
have positive crossmatches with some other patients’ donors also, in a suﬃciently large population there will
also be many donors with whom she has no tissue type incompatibility.

                                                      6
types. Therefore the following is a natural assumption on any suﬃciently large population of
incompatible patient-donor pairs.6
    Assumption 2. (Large Population of Incompatible Patient-Donor Pairs) Regard-
less of the maximum number of pairs allowed in each exchange, pairs of types O-A, O-B, O-AB,
A-AB, and B-AB are on the “long side” of the exchange in the sense that at least one pair of
each type remains unmatched in each feasible set of exchanges.7


3.1     Maximal-Size Two-Way Exchange
For any non-negative number k, let [k] denote the integer part of k, ie. the greatest integer no
larger than k.
    Proposition 1. For any patient population obeying Assumptions 1 and 2, the maximum
number of patients who can be matched with only two-way exchanges is:

                   2 (#(A-O) + #(B-O) + #(AB-O) + #(AB-A) + #(AB-B))
                         + (#(A-B) + #(B-A) − |#(A-B) − #(B-A)|)
                            Ã"        # "        # "        # "           #!
                               #(A-A)     #(B-B)     #(O-O)      #(AB-AB)
                         +2            +          +          +
                                 2           2          2           2
Proof : Each pair of type A-O is compatible with each pair of type O-A by Assumption 1, and
types O-A are on the long side of the exchange by Assumption 2. Therefore each pair of type
A-O (demanding a kidney that is less sought after than the one they provide) makes a two-way
exchange possible. Moreover since only two-way exchanges are allowed, matching the A-O pair
with a pair of a type other than O-A does not increase the size of the maximal set of exchanges.
The same argument follows for each pair of types B-O, AB-O, AB-A, AB-B as well, explaining
the term
                   2 (#(A-O) + #(B-O) + #(AB-O) + #(AB-A) + #(AB-B)) .
Now consider any maximal size match in which every pair of types A-O, B-O, AB-O, AB-A,
AB-B is matched with a pair of the opposite type. In the absence of any remaining types A-O,
   6
     In particular, this assumption is met on each of the real and simulated populations of incompatible patient-
donor pairs that we have examined that contain at least 25 pairs.
   7
     It is worth emphasizing that this assumption will characterize large populations of incompatible patient-
donor pairs, not patient-donor pairs in general. When we look at the whole population of patient-donor pairs
(including the compatible pairs) there will in general be as many O donors as O patients. Note also that,
in populations in which Assumption 2 is met, there will always be diﬃcult choices to make about which O
patients should receive the scarce O kidneys, even when attention is conÞned to maximal sets of exchanges.
In game-theoretic terms, the strong core (the core deÞned by weak domination) of this market in which many
kidneys are equally desirable, is empty (cf. Shapley and Scarf, 1974, Roth and Postlewaite, 1977, Quint and
Wako, 2004).

                                                       7
B-O, AB-O, AB-A, AB-B, pairs of types A-B and B-A can only be matched with a pair of
the opposite type. Therefore, unless the two types have the same number of pairs, the longer
side will have some pairs that remain unmatched. Since each pair on the shorter side can be
matched with a pair on the longer side, |#(A-B) − #(B-A)| pairs of types A-B, B-A remain
unmatched under this maximal size set of exchanges, explaining the second term

                         (#(A-B) + #(B-A) − |#(A-B) − #(B-A)|) .

Finally when pairs of types A-O, B-O, AB-O, AB-A, AB-B are each matched with a pair of the
opposite type, each pair of types A-A, B-B, AB-AB, O-O can only be matched with a pair of
the same type. Therefore since only 2-way exchanges are allowed, all pairs of type A-A can be
matched whenever #(A-A) is even and all but one can be matched whenever #(A-A) is odd.
The same argument follows for pairs of types B-B, AB-AB, O-O as well, explaining the last
term               Ã"         # "         # "          # "               #!
                      #(A-A)       #(B-B)      #(O-O)        #(AB-AB)
                 2              +           +            +                  .
                         2            2           2               2

3.2    Maximal-Size Two-Way and Three-Way Exchange
The logistics of kidney exchange get harder as the number of patients in each exchange increases.
Therefore one important question is how much of the gains from kidney exchange can be
captured through two-way exchanges, and what are the marginal eﬃciency gains of three-way,
four-way, and larger exchanges.
    We will denote a three-way exchange as an ordered list of three patient-donor pairs, in which
the donor of the Þrst pair donates to the second patient, the donor of the second pair donates
to the third patient, and the donor of the third pair donates to the Þrst patient. We use similar
terminology for four-way and larger exchanges.
    While two-way kidney exchanges can capture most of the gains from exchange, they cannot
capture all potential gains; at least some three-way exchanges are needed. There are several
reasons for this:

  1. Recall that when only two-way exchanges are allowed, one pair of type A-A remains
     unmatched if #(A-A) is odd. There is a similar potential eﬃciency loss for each of the
     types B-B, AB-AB, and O-O. For almost all patient populations, that eﬃciency loss can
     be avoided once three-way exchanges are allowed. For example, unless there is only one
     type A-A pair, all type A-A pairs can be matched with each other through one three-way
     exchange and two-way exchanges for the others. Even when there is only one type A-A
     pair, she can be “appended” to a two-way exchange between an A-B pair and a B-A pair
     to form a three-way (B-A, A-A, A-B) exchange.

                                               8
                             P AIR 1                                                                       P AIR 1

                  ¾                        »                                                     ¾                       »
              P atient                   Donor                                               P atient                  Donor

                        p p p p p p p p p p p p p p p•p                                               p p p p p p p p p p p p p p p•p
                      AB                               O                                            AB                               O
                      ½                              S ¼                                            ½                              S ¼
                       •
                       ¶                                                                             ¶•
                      ¶                                                                             ¶
                       ¶                      S                                               ¶                             S
                                               S                                                                             S
         AB•p¶                                     S pp                            p p pS                                        S pp
                  ¶                                                                       ¶
             p pS
                ppp S                                 p O P atient                                                                  p O P atient
                                               ¶ p p p•                                 ppp S                                ¶ p p p•
                                                   ¶                                                                             ¶
                                                                         Donor AB•¶
                    ppp S                    ¶ pppp ¶                                      ppp S                           ¶ pppp ¶
Donor
                       ppp                       p                                            ppp                              p
                                                         ¶                                                                             ¶
                                               p                                                                             p
         S                                                                     S
                           ppp S        ¶ ppp                                                     ppp S               ¶ ppp
                               p      ¶ p p p p ¶ P AIR 2                                             ppp S         ¶ p p p p ¶ P AIR 2
          S                                                                      S
         3 SS p p•p pS                                                                                   •p p
                                                      ¶                                                                             ¶
P AIR                                   p
                                       •A                                 P AIR 3 SS                                 •p B ¶
                    SA                          ¶                                         S     B
             P atient                     Donor                                             P atient                    Donor



Figure 1: When three-way exchanges are feasible, each type AB-O pair can form a three-way
exchange with two pairs on the long side.

  2. With only two-way exchanges, under a maximal size match each type AB-O pair (with
     a rare O donor) is matched with a pair of one of the types O-AB, O-A, or O-B each of
     which is on the long side by Assumption 2. If three-way exchanges are allowed, each type
     AB-O pair can trade with not one but two pairs on the long side through either a (AB-O,
     O-A, A-AB) exchange or (AB-O, O-B, B-AB) exchange. That increases the size of the
     maximal-size matching by one for each type AB-O pair (See Figure 1).

  3. With only two-way exchanges, pairs of types A-B and B-A can be matched with each
     other, but |#(A-B) − #(B-A)| pairs on the longer side remain unmatched. With three-
     way exchanges available, part or all of these |#(A-B) − #(B-A)| pairs on the long side
     can also be matched, increasing the size of the maximal-size set of exchanges.
        Terasaki, Gjertson and Cecka (1998) report that the frequency of types A-B and B-A are
        0.05 and 0.03 respectively. So w.l.o.g. assume that:
        Assumption 3. #(A-B) > #(B-A).
        Consider a type B-O pair. In the absence of three-way exchanges, each such pair can be
        matched with one pair on the long side (such as a pair of the opposite type). However
        when three-way exchanges are available, a type B-O pair can form a three-way (B-O, O-A,


                                                                     9
                               P AIR 1                                                                       P AIR 1

                   ¾                        »                                                      ¾                       »
               P atient                   Donor                                                P atient                  Donor
                       Bp p p p p p p p p p p p p p p p O                                             ABp p p p p p p p p p p p p p p•p
                                                                                                                                       A
                       ½¶•                          •S ¼                                              ½¶•                            S ¼
                       ¶                                                                              ¶
                         ¶                     S                                                ¶                             S
                                                S                                                                              S
             p p pS                                 S pp                             p p pS                                        S pp
                    ¶                                                                       ¶
                  ppp S                                p O P atient
                                                ¶ p p p•                                  ppp S                                       p A P atient
                                                                                                                               ¶ p p p•
                                                    ¶                                                                              ¶
          B •¶                                                             Donor AB•¶
                      ppp S                   ¶ pppp ¶                                       ppp S                           ¶ pppp ¶
Donor
                         ppp                      p                                             ppp                              p
                                                          ¶                                                                              ¶
                                                p                                                                              p
         S                                                                       S
                             ppp S       ¶ ppp                                                      ppp S               ¶ ppp
                                 p     ¶ p p p p ¶ P AIR 2                                              ppp S         ¶ p p p p ¶ P AIR 2
          S                                                                        S
         3 SS p p•p pS                                                                                     •p p
                                                       ¶                                                                              ¶
P AIR                                   •p ¶                                P AIR 3 SS
                                                                                                  B                    •p B ¶
                      SA                 A                                                  S
             P atient                      Donor                                              P atient                    Donor



Figure 2: When three-way exchanges are feasible and #(A-B) > #(B-A), each type B-O pair
can form a three-way exchange with two pairs on the long side. The same is also true for each
type AB-A pair.

        A-B) exchange together with two pairs each of which is on the long-side by Assumptions
        2 and 3. Similarly while a type AB-A pair can be matched with one pair on the long side
        when only two-way exchanges are available, it can form a three way (AB-A, A-B, B-AB)
        exchange together with two pairs each of which is on the long-side by Assumptions 2 and
        3 (See Figure 2).8
        So of |#(A-B)−#(B-A)| type A-B pairs who remain unmatched under two-way exchanges,
        as many as (#(B-O)+#(AB-A)) can be matched through three-way exchanges. Therefore
        such three-way exchanges increases the size of the maximal-size matching by

                                         min{(#(A-B) − #(B-A)), (#(B-O) + #(AB-A))}.

    To simplify the formula for the size of the maximal set of exchanges, we assume that none
of the types A-A, B-B, AB-AB and O-O have only one pair. As we have already argued, when
only one pair is present for any of these types it can be appended to a two-way exchange, but
that considerably complicates the description of the size of the maximal-size set of exchanges.
  8
    In case #(B-A) > #(A-B) instead, type A-O pairs and AB-B pairs become critical and each such pair can
form a three-way exchange with two pairs on the long side.


                                                                      10
   Assumption 4. There is either no type A-A pair or there are at least two of them. The
same is also true for each of the types B-B, AB-AB, and O-O.
   We are ready to summarize these observations in a proposition.
   Proposition 2. For any patient population for which Assumptions 1-4 hold, the maximum
number of patients who can be matched with two-way and three-way exchanges is:

              2 (#(A-O) + #(B-O) + #(AB-O) + #(AB-A) + #(AB-B))
                   + (#(A-B) + #(B-A) − |#(A-B) − #(B-A)|)
                   + (#(A-A) + #(B-B) + #(O-O) + #(AB-AB))
                   +#(AB-O) + min{(#(A-B) − #(B-A)), (#(B-O) + #(AB-A))}

   To summarize, the marginal eﬀect of three-way kidney exchanges is:
                                                  Ã"        #   "        #   "         #   "   #!
                                            #(A-A)     #(B-B)   #(O-O)   #(AB-AB)
   #(A-A) + #(B-B) + #(O-O) + #(AB-AB) − 2           +        +        +
                                               2          2       2         2
      +#(AB-O) + min{(#(A-B) − #(B-A)), (#(B-O) + #(AB-A))}

For large patient populations, the second line, that is the aggregate frequency of types AB-
O, B-O and AB-A, account for essentially all gains from three-way exchanges (through the
exchanges diagrammed in Figures 1 and 2). In small populations the Þrst term, that is one
additional patient matched for each of the types A-A, B-B, AB-AB and O-O with an odd size,
might account for a substantial part of the gains.


3.3    Maximal-Size Two-Way, Three-Way and Four-Way Exchange
We have already shown that each type AB-O can form a three-way exchange with two patients
on the long side. In case four-way exchanges are allowed and if three-way exchanges cannot
handle the entire diﬀerence between types A-B and B-A, a type AB-O patient can be matched
with three patients on the long side to form a four-way exchange. So if #(A-B) > #(B-A) as
we assumed in Assumption 3, a type AB-O patient can form a four-way (AB-O, O-A, A-B,
B-AB) exchange with three patients on the long side increasing the size of the maximal-size
match by one (See Figure 3).
   Proposition 3. For any patient population in which Assumptions 1-4 hold, the maximum
number of patients who can be matched with two-way, three-way and four-way exchanges is:

        2 (#(A-O) + #(B-O) + #(AB-O) + #(AB-A) + #(AB-B))
             + (#(A-B) + #(B-A) − |#(A-B) − #(B-A)|)

                                            11
                                                    P AIR 1
                                                P¾
                                                 atient       »
                                                           Donor

                                                   p p p p p p p p p p p p p p p•p
                                                  AB                              O
                                                  ½                               @ ¼
                                                   •
                                                  ¡                              @
                               Â¿           ¡                                   @ ¾»
                                          ¡
                                  pp ¡                                             @•pp
                                                                                 @
                       Donor AB ppp
                                  ¡
                                                                                      pp O P atient
                                                                                       pp
                                   pp
                                 •
                                    pp                                                  ppp
                                     pp                                                   pp
                                      pp                                                   pp
                                       pp                                                   ppp
                    P AIR 4                                                                      P AIR   2
                                 p•                                                 •
                               ÁÀ                                                 ½             ¼
                       P atient B @                                                ¡ A Donor
                                                                                  ¡
                                          @
                                            ¾                                  ¡»
                                                                                 ¡
                                           @
                                             @•p p p p p p p p p p p p p p p•p¡
                                             @
                                                  ½
                                                    B      A ¼
                                              Donor       P atient
                                                   P AIR 3


Figure 3: When four-way exchanges are feasible, each type AB-O pair can form a four-way
exchange with three pairs on the long side.

             + (#(A-A) + #(B-B) + #(O-O) + #(AB-AB))
             +#(AB-O) + min{(#(A-B) − #(B-A)), (#(B-O) + #(AB-A) + #(AB-O))}

Therefore in the absence of tissue-type incompatibilities between patients and other patients’
donors, the marginal eﬀect of four-way kidney exchanges is bounded above by the rate of the
very rare AB-O type.


3.4    Suﬃciency of Two-Way, Three-Way and Four-Way Exchange
So far we have derived analytical expressions for the maximum number of patients who can
beneÞt from kidney exchange when the number of patients allowed in each exchange is no more
than two, three, and four. We will next show that given Assumptions 1, 2, and 4, the number
of patients who can beneÞt from exchange does not further increase when Þve-way or larger
exchanges are feasible. We need a little additional notation to present this result.
    Until now we described an exchange through the blood-types of the patients and their
incompatible donors. In this section it will be useful to describe an exchange through the
identities of the patients and their donors. For example when we speak of a three-way exchange

                                  E = (P1 − D1 , P2 − D2 , P3 − D3 )

                                                          12
that means donor D1 donates a kidney to patient P2 , donor D2 donates a kidney to patient P3 ,
and donor D3 donates a kidney to patient P1 . We will refer to any size exchange in a similar
way.
   An exchange is feasible if each donor in an exchange is compatible (both blood-type com-
patible and tissue-type compatible) with the patient to whom she donates. A matching is
a collection of feasible exchanges such that no pair is part of more than one exchange. A
maximal matching is one that includes as many patient-donor pairs as is feasible, i.e. it is a
maximal-size matching.
   Our next result indicates that, in the simple environments in which Assumptions 1, 2, and
4 apply, exchanges involving more than four pairs are never needed to achieve an eﬃcient
outcome.
    Theorem (4-way exchange suﬃces): Consider a patient population for which Assump-
tions 1, 2, 4 hold and let µ be any maximal matching (when there is no restriction on the size
of the exchanges that can be included in a matching). Then there exists a maximal matching
ν which consists only of two-way, three-way, and four-way exchanges, under which the same
set of patients beneÞt from exchange as in matching µ.

Proof : Consider a patient population and a maximal matching µ as in the statement of the
theorem. If µ is made of four-way or smaller exchanges then we are done. Otherwise we will
construct a matching ν which is made of four-way or smaller exchanges and matches the same
set of patients as matching µ.
    To simplify the exposition we will prove the theorem for the case in which the largest
exchange in matching µ is Þve-way. In general the same proof can be used to show that given
any maximal matching in which the largest exchange is of size k > 4, there exists another
matching which matches the same set of patients through (k − 1)-way or smaller exchanges;
and repeated application of this argument implies the desired result.
    Let
                      E = (P1 − D1 , P2 − D2 , P3 − D3 , P4 − D4 , P5 − D5 )

be any Þve-way exchange in µ. We will complete the proof by showing that all patient-donor
pairs in this exchange can be matched via smaller exchanges without changing the set of patients
who beneÞt from exchange.
   Since there are four blood-types, there are at least two patients in exchange E who have
the same blood-type. Pick any two such patients. We have two cases to consider:
   Case 1 . Neither of the these patients receive a kidney from the incompatible donor of the
other under exchange E.

                                              13
   W.l.o.g. suppose these patients are P1 and P3 . Under exchange E patient P1 receives
a kidney from donor D5 and patient P3 receives a kidney from donor D2 . Since these two
patients are of the same blood-type, by Assumption 1 donors D2 and D5 are compatible with
both patients and hence the following two exchanges are feasible “dividing” exchange E into
two smaller exchanges:

               E 0 = (P1 − D1 , P2 − D2 ),     E 00 = (P3 − D3 , P4 − D4 , P5 − D5 )

   Case 2 . One of these two patients receive a kidney from the incompatible donor of the
other under exchange E.
   W.l.o.g. suppose these patients are P1 and P2 . Since P1 receives a kidney from D5 , by
Assumption 1 patient P2 is also compatible with donor D5 and hence the four-way exchange

                          E ∗ = (P2 − D2 , P3 − D3 , P4 − D4 , P5 − D5 )

is feasible. We will complete the proof by showing that the remaining pair (P1 − D1 ) can be
included in an exchange without having an adverse impact on any patient who receives a kidney
in the matching µ.
    Observe that while patients P1 and P2 are of the same blood-type, P2 is compatible with
donor D1 and yet patient P1 is incompatible. Therefore while P1 is blood-type compatible with
her donor D1 , she is tissue-type incompatible. We have two cases to consider:
    Case 2a. Pair (P1 − D1 ) is one of the types A-O, B-O, AB-O, AB-A, or AB-B.
    In this case pair (P1 − D1 ) is on the short side of the exchange and by Assumption 2 there
exists a pair of the opposite type that is unmatched. By Assumption 1 pair (P1 − D1 ) can form
a two-way exchange with this pair, increasing the total number of patients beneÞtting from
exchange and contradicting that µ is of maximal-size. Hence this case cannot hold.
    Case 2b. Pair (P1 − D1 ) is one of the types A-A, B-B, AB-AB, or O-O.
    By Assumption 4 there is at least one other pair (P6 − D6 ) with the same type (and thus
patients P1 , P6 and donors D1 , D6 all have the same blood-type). This pair is part of an
exchange Ê under µ for otherwise pair (P1 − D1 ) can form a two-way exchange with them by
Assumption 1 and this would contradict the maximality of matching µ. If Ê is a two-way or
three-way exchange then by Assumption 1 pair (P1 − D1 ) can be “appended” to this exchange
(right before or right after pair (P6 − D6 )). If, on the other hand, Ê is a larger exchange, then
pair (P6 − D6 ) can be removed from Ê to form a two-way exchange with pair (P1 − D1 ) which
is feasible by Assumption 1. Moreover since P6 and D6 are of the same blood type, the donor
who donates a kidney to patient P6 under Ê can instead donate a kidney to the patient who
receives a kidney from D6 under Ê and hence the remaining pairs in Ê can form an exchange
with one less pair.

                                                14
    Looking at the role that the Assumptions 1, 2, and 4 play in the theorem, we can restate it as
follows. In a suﬃciently large population of incompatible patient donor pairs, the only reasons
that eﬃcient exchange may require exchanges involving more than four pairs are idiosyncratic
tissue type incompatibilities, and the presence of singleton patient-donor pairs with the same
blood type. We next consider how much deviation from the above results we should expect in
patient populations having the incidence of tissue type incompatibilities we see in the national
patient population.


4         Simulations using national patient characteristics
In this section we dispense with the simplifying assumptions made so far, and turn to simulated
data reßecting national patient characteristics. SpeciÞcally, we now look at populations in which
a patient may have tissue type incompatibilities with many donors. This will allow us to see how
good are the approximations derived above under the assumption that exchange was limited
only by blood type incompatibilities.
    The simulations reported here basically follow those of Saidman et. al 2005, with the
addition that, for each simulated population we not only compute the actual maximal number
of exchanges, but we also compute the predicted (upper bound) number based on the formulas
derived above.9 (These formulas depend on the details of the simulation, insofar as they depend
on the number of pairs of each type present in each simulated population.) We will see that the
formulas predict the actual number of exchanges surprisingly well. That is, the upper bounds on
the maximal number of exchanges when exchange is limited only by blood type incompatibility
are not far above the numbers of exchanges that can actually be realized. In addition, only a
small number of exchanges involving more than four pairs are needed to achieve eﬃciency in
the simulated data.


4.1         Patient and Donor Characteristics
We consider samples of non-blood related patient-donor pairs in order to avoid the complications
due to the impact of genetics on immunological incompatibilities. The characteristics such as
the blood-types of patients and donors, the PRA (Percent Reactive Antibody) distribution of
the patients, donor relation of patients, and the gender of the patients are generated using the
empirical distributions of the U.S. Organ Procurement and Transplantation Network (OPTN)
and the ScientiÞc Registry of Transplant Recipients (SRTR) data (see Table 1). We consider
all ethnicities in the data.
    9
        Unlike in Saidman et al. we also consider four-way exchange.


                                                        15
4.2    Tissue-Type Incompatibility
Tissue-type incompatibility (a positive crossmatch) is independent of blood-type incompat-
ibility and arises when a patient has preformed antibodies against a donor tissue-type.
    Patients in the OPTN/SRTR database are divided into the following three groups based on
the odds that they have a crossmatch with a random donor:

  1. Low PRA patients: Patients who have a positive crossmatch with less than 10% of the
     population.

  2. Medium PRA patients: Patients who have a positive crossmatch with 10-80% of the
     population.

  3. High PRA patients: Patients who have a positive crossmatch with more than 80% of the
     population.

    Frequencies of low, medium, and high PRA patients reported in the OPTN/SRTR database
are given in Table 1. Since a more detailed PRA distribution is unavailable in the medical
literature, we will simply assume that:

   • each low PRA patient has a positive crossmatch probability of 5% with a random donor,

   • each medium PRA patient has a positive crossmatch probability of 45% with a random
     donor, and

   • each high PRA patient has a positive crossmatch probability of 90% with a random donor.

   We have already indicated that when a patient is female and the potential donor is her
husband, it is more likely that they have a positive crossmatch due to pregnancies. Zenios,
Woodle, and Ross (2001) indicate that while positive crossmatch probability is 11.1% between
random pairs, it is 33.3% between female patients and their donor husbands. Equivalently,
female patients’ negative crossmatch probability (i.e. the odds that there is no tissue-
type incompatibility) with their husbands is approximately 75% of the negative crossmatch
probability with a random donor. Therefore we accordingly adjust the positive crossmatch
probability between a female patient and her donor husband using the formula

                              PRA∗ = 100 − 0.75(100 − P RA)

and assume that



                                            16
   • each low PRA female patient has a positive crossmatch probability of 28.75% with her
     husband,

   • each medium PRA female patient has a positive crossmatch probability of 58.75% with
     her husband, and

   • each high PRA female patient has a positive crossmatch probability of 92.25% with her
     husband.


4.3    Patient-Donor Population Construction
In our simulations, we randomly simulate a series of patient-donor pairs using the population
characteristics explained above. Whenever a pair is compatible (both blood-type compatible
and tissue-type compatible), the donor can directly donate to the intended recipient and there-
fore we do not include them in our sample. Only when they are either blood-type or tissue-type
incompatible do we keep them, until we reach a sample size of n incompatible pairs. We use a
Monte-Carlo simulation size of 500 random population constructions for three population sizes
of 25, 50 and 100.


4.4    Outline of the Simulations
For each sample of n incompatible patient-donor pairs, we Þnd the maximum number of patients
who can beneÞt from an exchange when both blood-type and tissue-type incompatibilities are
considered, and

  a. only two-way exchanges are allowed,

  b. two-way and three-way exchanges are allowed,

  c. two-way, three-way, and four-way exchanges are allowed, and

  d. any size exchange is allowed.

    In our simulations, to Þnd the maximal number of patients who can beneÞt from an exchange
when only two-way exchanges are allowed, we use a version of Edmonds’ (1965) algorithm (see
Roth, Sönmez, and Ünver, 2004b), and to Þnd the maximal number of patients who can beneÞt
from an exchange when larger exchanges are allowed, we use various integer programming
techniques.
    We compare these numbers with those implied by the analytical expressions we developed
in order to see whether these formulae can be seen as close approximations or whether they

                                              17
merely represent crude upper-bounds. Since many high PRA patients cannot be part of any
exchange due to tissue-type incompatibilities, we report two sets of upper-bounds induced by
the formulae we developed:

   1. For each sample we use the formulae with the raw data, and

   2. for each sample we restrict our attention to patients each of whom can participate in at
      least one feasible exchange.

    That is, in Table 2, “Upper bound 1” for each maximal allowable size exchange is the average
over all simulated populations of the realization of the formula developed above for that size
exchange (i.e. Propositions 1, 2, and 3 for maximal exchange sizes 2, 3, or 4 pairs) with the
population size of n = 25, 50, or 100. However in a given sample of size n=25, for example,
there may be some patients who have no compatible donor with whom they can complete a
feasible exchange, because of tissue type incompatibilities. So, for each size k exchange that
we consider, we look at the population of n0 (k) < n of patient-donor pairs who can participate
in a k-way or smaller exchange, and “Upper bound 2” in Table 2 reports the average over all
populations for the realizations of the formulas using this smaller population of incompatible
patient-donor pairs. Clearly Upper bound 2 provides a more precise (i.e. lower) upper bound
to the number of exchanges that can be found. The fact that the diﬀerence between the two
upper bounds diminishes as the population size increases reßects that, in larger populations,
even highly sensitized patients are likely to Þnd a compatible donor.


4.5     Discussion of the Simulation Results
The simulation results (which include tissue type incompatibilities) are very similar to the
theoretical upper bounds we develop for the case with only blood type incompatibilities. While
two-way exchanges account for most of the potential gains from exchange (74%, 78%, 82% for
population sizes of 25, 50, and 100 pairs respectively), the number of patients who beneÞt from
exchange signiÞcantly increases when three or more pair exchanges are allowed. Consistent
with the theory, three-way exchanges account for a large share of the remaining potential gains
(77%, 87%, 94% for a population sizes of 25, 50 and 100 pairs respectively). The theory that
we developed in the absence of crossmatches is still predictive when there are crossmatches:
virtually all possible gains from trade are achieved with two-way, three-way and four-way
exchanges, especially when the population size is large (See Table 2).10
  10
    When the population size is 100 incompatible pairs, in 485 of the 500 simulated populations the maximum
possible gains from trade are achieved when no more than four pairs are allowed to participate in an exchange.


                                                     18
5      Concluding remarks
This paper has two themes. The Þrst is intensely practical, and concerns the infrastructure that
needs to be prepared to eﬃciently conduct kidney exchange among incompatible patient-donor
pairs. The second is more general, and concerns the role of markets in facilitating exchange
even in the absence of a medium of exchange.
    On the practical side, we have shown why it will be important to develop the infrastructure
to identify and to perform three-way as well as two-way kidney exchanges, since the eﬃcient
utilization of O donors often requires three-way exchanges. Although the identiÞcation of max-
imal two and three-way exchanges is a computationally hard problem (unlike the identiÞcation
of maximal two-way exchanges; Roth, Sönmez, and Ünver, 2004b), it appears that instances
of practical size can be readily solved with conventional integer programming software. And,
while performing three-way exchanges requires six simultaneous surgeries, this will often be
feasible, particularly when the patients are at diﬀerent transplant centers. It seems likely that
the most usual logistical arrangement will be for the donor to travel to the designated patient’s
transplant center. So, for example, in the case of a three way exchange in which each patient
is at a diﬀerent hospital, this means that each of three hospitals will only be performing two
surgeries, which they would be required to perform in any live-donor kidney transplant.11 As
Proposition 2 explains, and Table 2 demonstrates, the gains from including the possibility of
three-way exchange are substantial, and substantially greater than the further marginal gains
from four-way exchange (Proposition 3 and Table 2). Thus, at least initially we will be searching
for two and three-way exchanges.


5.1     M&M’s: Money and Markets
More generally, this paper is about how markets facilitate exchange. Jevons (1876) famously
suggests that the primary diﬃculties with barter arise from the absence of, and can be solved by
the introduction of, a medium of exchange. We argue that many of the problems that Jevons
identiÞes as resulting from an absence of money would continue to be problems (even with
money) in the absence of a suﬃciently thick market, and that many of the beneÞts Jevons sees
as ßowing from the presence of money result at least in part from the presence of a market.
Kidney exchange allows us to see which of the market eﬀects can still be achieved in the absence
of money.
  11
    The logistics of three-way exchanges will remain more diﬃcult than two-way exchanges, even when three
hospitals are involved. A three way exchange involves scheduling surgery for six patients, all of whom must be
ready for surgery at the same time, and will consequently have higher probability of being delayed or cancelled
due to changing health conditions than a two-way exchange that involves only four patients.


                                                      19
    In the absence of a thick market, only a very small number of kidney exchanges have so
far been accomplished. We show that a thick market organized by a clearinghouse provides
many of the beneÞts that Jevons attributed to the presence of a medium of exchange. If we
conÞne our attention narrowly to a suﬃciently large population of patient-donor pairs, all of
the eﬃciencies of exchange can be achieved without money, primarily in exchanges involving
no more than three pairs. Table 2 shows that about 60% of the incompatible pairs can beneÞt
in this way, with those that cannot being the pairs on the long side of the market, primarily
O blood type patients with A or B donors. To beneÞt these patients it would be necessary to
increase the supply of O type donors.
    Two thought experiments about how to do this help illustrate the parallel roles of money
and markets. Suppose that instead of conÞning our attention to incompatible patient-donor
pairs, we considered exchange among the entire population of patient-donor pairs, i.e. suppose
we also included in the pool of potential exchangers those pairs in which the donor could give
a kidney to the intended recipient directly.12 In that case there would no longer be a shortage
of O donors, and simulations show that, in populations of 100 (compatible and incompatible)
patient-donor pairs, it would be possible to arrange transplants for over 90% of the patient-
donor pairs (Roth, Sönmez, and Ünver 2005). Of course, these beneÞts, achieved without the
use of money, accrue only to those patients who have a willing kidney donor. In contrast, if
the legal/ethical/social objections to a fully monetized market were to be resolved, and money
could be exchanged to recruit donors from the general population, then it would presumably
be possible to arrange transplants for a high percentage of all patients in need of one.
    While we are on the subject of the parallel roles of money and markets, the structure of
eﬃcient exchange in the case of kidneys allows us to address, without the use of money, another
of money’s traditional roles.

           “A second diﬃculty arises in barter. At what rate is any exchange to be made?
       If a certain quantity of beef be given for a certain quantity of corn, and in like
       manner corn be exchanged for cheese, and cheese for eggs, and eggs for ßax, and so
       on, still the question will arise–How much beef for how much ßax, or how much of
       any one commodity for a given quantity of another?” Jevons (1876, Chapter 1)
  12
    At present in New England, only incompatible pairs may be registered for exchange. As we noted in Roth,
Sönmez, and Ünver (2005): “It seems likely that until exchange becomes well established, only incompatible
patient-donor pairs will be included, as surgeons will be reluctant to advise compatible pairs not to proceed with
their own transplant. However, as exchange becomes more routine, there will be opportunities for mutually
beneÞcial exchange between e.g. a 25-year-old patient with a compatible 50-year-old donor and a 50-year-old
patient with an incompatible 25-year-old donor.”



                                                       20
    As we have seen, if the object is to facilitate as many transplants as possible among in-
compatible patient-donor pairs, then we can determine the rates of exchange. For example a
(B-O) pair on the short side of the market can exchange with two pairs on the long side of the
market (Figure 2), while an even rarer (AB-O) pair can exchange with three pairs on the long
side (Figure 3).13


5.2     Practical Market Design
As economists are more frequently called upon to design markets,14 and not merely to study
them at arms length, there will be new opportunities for understanding how markets work, and
what obstacles they face in achieving eﬃcient allocation.
    Kidney exchange, in the context of the legal/social/ethical prohibitions on the buying and
selling of organs, gives us a chance to look closely at the exchange of indivisible goods, without
a medium of exchange, in an environment in which the structure of eﬃcient exchange can
be analyzed. One of the main contributions that a centralized clearinghouse can make in this
context is to establish a suﬃciently thick market so that double and triple coincidences of wants
can be identiÞed and consummated.
    In general, clearinghouses seem to be in most demand in markets that have suﬀered failures
with respect to the thickness of the market, or congestion in making and processing enough of-
fers, or that have incentive problems that make it unsafe for participants to provide information
needed for eﬃcient allocation. For example, clearinghouses recently designed for other markets
in which monetary transfers are considered inappropriate have involved the allocation of public
school places in New York City (where the clearinghouse solved a congestion problem), and in
Boston, where the existing allocation system had an incentive problem (see Abdulkadiroù    glu and
Sönmez 2003, Abdulkadiroù    glu, Pathak, and Roth, 2005, and Abdulkadiroù     glu, Pathak, Roth,
and Sönmez, 2005). Clearinghouses are also used in markets in which monetary wages are
entirely appropriate, such as the labor markets for new doctors (see e.g. Roth, 1984, Roth and
Peranson, 1999), and for medical specialists of various sorts (see e.g. Niederle and Roth, 2005).
And there has been recent attention to how decentralized markets deal well or badly with some
of the same problems that clearinghouses can be used to solve (in e.g. the markets for college
admissions and Þnancial aid, law clerks, psychologists, gastroenterologists, collectables, etc.,
see e.g. Avery et al. 2001, 2003, Niederle and Roth, 2003, 2004, Ockenfels and Roth 2004,
  13
     Note that if the objective is to maximize the total number of transplants, then patient-donor pairs of type
O-AB may be adversely aﬀected, if the AB-O types are used in four way exchanges. Matching O-AB pairs will
therefore often require reducing the total number of patients who can be matched.
  14
     cf. e.g. Milgrom (2004), Roth (2002), Wilson (2002).



                                                      21
Roth and Xing 1997).
    All of these markets, like kidney exchange, are matching markets, in the sense that it matters
who transacts with whom (in contrast to anonymous commodity markets). And the fact that
some of these markets can do much of their work without money at all supports the view that
many matching markets in which money is freely available nevertheless do not clear by price
adjustments alone. (Departments of economics don’t hire professors by announcing a price and
seeing who comes...)
    Viewed in this light, the present study is part of the growing investigation into how markets
are and need to be designed to achieve eﬃciency, taking into account the particular obstacles
that they encounter. This line of work, which is given focus by the demand for practical
designs for particular markets, directs our attention to the many still poorly understood details
of market clearing, in a way that can in the long term only deepen our understanding of how
markets work in general.



References
 [1] A. Abdulkadiroù
                   glu, P. A. Pathak, and A. E. Roth (2005) “The New York City high school
     match,” American Economic Review, Papers and Proceedings, May, in press.

 [2] A. Abdulkadirogùlu, P. A. Pathak, A. E. Roth, and T. Sönmez (2005) “The Boston public
     school match,” American Economic Review, Papers and Proceedings, May, in press.

 [3] A. Abdulkadirogùlu and T. Sönmez (2003) “School choice: A mechanism design approach,”
     American Economic Review 93: 729-747.

 [4] M. Abecassis et al. (2002) “Consensus statement on the live organ donor,” The Journal of
     the American Medical Association 284: 2919-2926.

 [5] C. Avery, A. Fairbanks, and R. Zeckhauser (2003) The Early Admissions Game: Joining
     the Elite, Harvard University Press, Cambridge, MA.

 [6] C. Avery, C. Jolls, R. A. Posner, and A. E. Roth (2001) “The market for federal judicial
     law clerks,” University of Chicago Law Review 68: 793-902.

 [7] G. S. Becker and J. J. Elias (2002) “Introducing incentives in the market for living organ
     donations,” working paper, University of Chicago.




                                               22
 [8] F. L. Delmonico (2004) “Exchanging kidneys — Advances in living-donor transplantation,”
     The New England Journal of Medicine 350: 1812-1814.

 [9] J. Edmonds (1965) “Paths, trees, and ßowers,” Canadian Journal of Mathematics 17:
     449-467.

[10] J. W. HatÞeld (2005) “Pairwise kidney exchange: Comment,” working paper, Stanford
     University.

[11] W. S. Jevons (1876) Money and the Mechanism of Exchange. New York: D. Appleton and
     Co. [Online] available from
     http://www.econlib.org/library/YPDBooks/Jevons/jvnMME1.html; accessed 30 April
     2005

[12] M. Lucan, P. Rotariu, D. Neculoiu, and G. Iacob (2003) “Kidney exchange program:
     A viable alternative in countries with low rate of cadaver harvesting,” Transplantation
     Proceedings 35: 933-934.

[13] C. N. McKinney, M. Niederle, and A. E. Roth (2005) “The collapse of a medical labor
     clearinghouse (and why such failures are rare),” American Economic Review, in press.

[14] P. Milgrom (2004) Putting Auction Theory to Work, Cambridge University Press.

[15] M. S. Nadel and C. A. Nadel (2005) “Using reciprocity to motivate organ donations,” Yale
     Journal of Health Policy, Law and Ethics 5: 293-325.

[16] M. Niederle and A. E. Roth (2003) “Unraveling reduces mobility in a labor market: Gas-
     troenterology with and without a centralized match,” Journal of Political Economy 111:
     1342-1352.

[17] M. Niederle and A. E. Roth (2004) “Market culture: How norms governing exploding oﬀers
     aﬀect market performance,” working paper, Stanford University and Harvard University.

[18] M. Niederle and A. E. Roth (2005) “The gastroenterology fellowship market: Should there
     be a match?” American Economic Review, Papers and Proceedings, May, in press.

[19] A. Ockenfels and A. E. Roth (2004) “Convergence of prices for a new commodity: ‘Iraq
     most wanted’ cards on eBay,” working paper, Köln University and Harvard University.

[20] T. Quint and J. Wako (2004) “On houseswapping, the strict core, segmentation, and linear
     programming,” Mathematics of Operations Research 29: 861-877.

                                             23
[21] F. T. Rapaport (1986) “The case for a living emotionally related international kidney
     donor exchange registry,” Transplantation Proceedings 18: 5-9.

[22] L. F. Ross, D. T. Rubin, M. Siegler, M. A. Josephson, J. R. Thistlethwaite, Jr., and E. S.
     Woodle (1997) “Ethics of a paired-kidney-exchange program,” The New England Journal
     of Medicine 336: 1752-1755.

[23] L. F. Ross and E. S. Woodle (2000).“Ethical issues in increasing living kidney donations
     by expanding kidney paired exchange programs,” Transplantation 69: 1539-1543.

[24] A. E. Roth (1984) “The evolution of the labor market for medical interns and residents: a
     case study in game theory,” Journal of Political Economy 92: 991-1016.

[25] A. E. Roth (2002) “The economist as engineer: game theory, experimental economics and
     computation as tools of design economics,” Econometrica 70: 1341-1378.

[26] A. E. Roth and E. Peranson (1999) “The redesign of the matching market for American
     physicians: some engineering aspects of economic design,” American Economic Review 89:
     748-780.

[27] A. E. Roth and A. Postlewaite (1977) “Weak versus strong domination in a market with
     indivisible goods,” Journal of Mathematical Economics 4: 131-137.

[28] A. E. Roth, T. Sönmez, and M. U. Ünver (2004a) “Kidney exchange,” Quarterly Journal
     of Economics 119: 457-488.

[29] A. E. Roth, T. Sönmez, and M. U. Ünver (2004b) “Pairwise kidney exchange,” National
     Bureau of Economic Research, working paper no. w10698, August, Journal of Economic
     Theory in press.

[30] A. E. Roth, T. Sönmez , and M. U. Ünver (2005) “A kidney exchange clearinghouse in
     New England,” American Economic Review, Papers and Proceedings, May, in press.

[31] A. E. Roth and X. Xing (1997) “Turnaround time and bottlenecks in market clearing: de-
     centralized matching in the market for clinical psychologists,” Journal of Political Economy
     105: 284-329.

[32] S. L. Saidman, A. E. Roth, T. Sönmez, M. U. Ünver, and F. L. Delmonico (2005) “Increas-
     ing the opportunity of live kidney donation by matching for two and three way exchanges,”
     working paper, Massachusetts General Hospital, Harvard University, Koç University, New
     England Organ Bank.

                                               24
[33] D. L. Segev, S. E. Gentry, D. S. Warren, B. Reeb, and R. A. Montgomery (2005) “Kidney
     paired donation and optimizing the use of live donor organs,” The Journal of American
     Medical Association 293: 1883-1890.

[34] L. Shapley and H. Scarf (1974) “On cores and indivisibility,” Journal of Mathematical
     Economics 1: 23-28.

[35] P. I. Terasaki, D. W. Gjertson, and J. M. Cecka (1998) “Paired kidney exchange is not a
     solution to ABO incompatibility,” Transplantation 65: 291.

[36] R. B . Wilson (2002) “Architecture of power markets,” Econometrica 70: 1299-1340.

[37] S. Zenios, E. S. Woodle, and L. F. Ross (2001) “Primum non nocere: avoiding harm
     to vulnerable wait list candidates in an indirect kidney exchange,” Transplantation 72:
     648-54.




                                            25
Table 1: Patient and living donor distributions used in simulations based on OPTN/SRTR
Annual Report in 2003, for the period 1993-2002, retrieved from http://www.optn.org on
11/22/2004. Patient characteristics are obtained using the new waiting list registrations data,
and living donor relatinal type distribution is obtained from living donor transplants data.
                          A. Patient ABO Blood Type      Frequency
                                      O                    48.14%
                                      A                    33.73%
                                       B                   14.28%
                                      AB                    3.85%
                               B. Patient Gender         Frequency
                                     Female                40.90%
                                      Male                 59.10%
                           C. Unrelated Living Donors    Frequency
                                     Spouse                48.97%
                                      Other                51.03%
                              E. PRA Distribution        Frequency
                                   Low PRA                 70.19%
                                  Medium PRA               20.00%
                                   High PRA                 9.81%




                                              26
Table 2: Simulation results about average number of patients actually matched and predicted by
the formulae to be matched. The standard errors of the population are reported in parantheses.
The standard errors of the averages are obtained by dividing population standard errors by
square root of the simulation number, 22.36.
                                                  Type of Exchange
                                                           Two-way,
       Pop.                                  Two-way,                         No
                   Method        Two-way                  Three-way,
       Size                                  Three-way                     Constraint
                                                           Four-way
                  Simulation        8.86        11.272         11.824         11.992
                                  (3.4866)     (4.0003)       (3.9886)       (3.9536)
       n=25    Upper bound 1        12.5        14.634         14.702
                                  (3.6847)     (3.9552)       (3.9896)
               Upper bound 2       9.812         12.66         12.892
                                  (3.8599)     (4.3144)       (4.3417)
                  Simulation       21.792       27.266         27.986          28.09
                                  (5.0063)     (5.5133)       (5.4296)       (5.3658)
       n=50    Upper bound 1         27.1        30.47         30.574
                                   (5.205)      (5.424)       (5.4073)
               Upper bound 2       23.932       29.136         29.458
                                  (5.5093)      (5.734)       (5.6724)
                  Simulation       49.708       59.714         60.354         60.39
                                  (7.3353)      (7.432)       (7.3078)        (7.29)
      n=100    Upper bound 1       56.816       62.048         62.194
                                  (7.2972)     (7.3508)       (7.3127)
               Upper bound 2       53.496       61.418         61.648
                                  (7.6214)     (7.5523)       (7.4897)




                                             27
