                              NBER WORKING PAPER SERIES




               HETEROGENEOUS HOUSEHOLDS UNDER UNCERTAINTY

                                        Pietro Veronesi

                                      Working Paper 25448
                              http://www.nber.org/papers/w25448


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                   January 2019




I thank John Heaton and Lubos Pastor for their comments. I acknowledge financial support from
the Fama-Miller Center for Research in Finance and by the Center for Research in Security Prices
at the University of Chicago Booth School of Business. The views expressed herein are those of
the author and do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2019 by Pietro Veronesi. All rights reserved. Short sections of text, not to exceed two
paragraphs, may be quoted without explicit permission provided that full credit, including ©
notice, is given to the source.
Heterogeneous Households under Uncertainty
Pietro Veronesi
NBER Working Paper No. 25448
January 2019
JEL No. E21,G1,G11,G12

                                          ABSTRACT

I characterize a dynamic economy under general distributions of households’ risk tolerance,
endowments, and beliefs about long-term growth. As the economy expands and the stock market
rises (a) the fraction of households with declining consumption-share increases; (b) the wealth-
share of high risk-tolerant households increases; (c) richer households’ wealth display a higher
CAPM beta; and (d) households’ portfolios change qualitatively. A log-utility investor for
instance borrows in contractions but lends in expansions. Variations in uncertainty and expected
growth generate trading volume due to risk sharing. Higher uncertainty increases stock prices,
risk premiums, volatility, wealth inequality and the dispersion of portfolio holdings, consistently
with the events in the late 1990s.


Pietro Veronesi
University of Chicago
Booth School of Business
5807 South Woodlawn Avenue
Chicago, IL 60637
and NBER
pietro.veronesi@chicagobooth.edu
1.        Introduction

Empirical studies on households’ risk preferences using different estimation strategies and
different samples agree on one fact: The distribution of risk tolerance is wide, with some
households extremely risk averse and with others close to risk-neutrality.1 In a world with
large and time varying macroeconomic uncertainty, such large differences in risk-preferences
must impact agents’ trading behavior and wealth dynamics. For instance, it is well known
that the late 1990s were characterized by rising price valuation, volatility, and trading vol-
ume. Wealth inequality, moreover, also trended up strongly in that period.2 Raising macroe-
conomic uncertainty with heterogeneous preferences predict just that.

       Specifically, I embed general risk-preference distributions in a dynamic model of asset
pricing with macroeconomic uncertainty and obtain numerous predictions. I first focus on
a benchmark model without learning to obtain benchmark results: In this setting, higher
dispersion of risk preferences generates higher Sharpe ratios and risk-free rates in bad times
but lower ones in good times. As the economy expands and the stock market rises (a)
the fraction of households whose consumption-share declines with output increases; (b) the
wealth-share of high risk-tolerant households increases; (c) richer households’ net worth
display a higher CAPM beta; and (d) households’ portfolio allocations change qualitatively.
A log-utility investor, for instance, borrows in bad times but lends in good times. Points (a),
(b), (c) are consistent with recent trends (See Saez and Zucman (2016), Gomez (2018)).3
The key driver of these results is risk sharing, as households with higher risk tolerance insure
those with lower risk tolerance by selling them risk-free bonds and taking aggressive positions
in stocks. They thus gain the most as the economy expands.

       The extension to uncertainty about long-term growth and learning yields additional novel
results. First, higher uncertainty entails additional motives for risk-sharing and thus house-
holds with higher risk tolerance take on even more extreme positions in stocks than those
with lower risk tolerance. In particular, an endogenous increase in uncertainty generates
higher dispersion in portfolio allocations across households which is achieved through higher
trading volume, as more risk tolerant households buy stocks from the less risk tolerant ones.
I show that an endogenous increase in uncertainty thus increases trading volume as well as
stock valuations, return volatility, and wealth inequality.
   1
     See e.g. Barsky, Juster, Kimball and Shapiro (1997), Kimball et al. (2008, Figure 1), Chiappori et al.
(2014, Figure 2).
   2
     See e.g. Saez and Zucman (2016).
   3
     In a related model with multiple countries and inequality-averse households, Pastor and Veronesi (2018)
show that globalization exacerbates the inequality due to risk sharing highlighted in (a) and (b) and thus
lead households to vote for a populist who promises to end globalization.


                                                     1
   These results provide theoretical foundation to the events of the late 1990s that saw record
breaking valuations, high volatility, trading volume, and dispersion of portfolio holdings
across managers (see e.g. Greenwood and Nagel (2009)). The existence of large trading
volume around “bubble” events has been taken as evidence of behavioral biases (see e.g.
Scheinkman (2014) for a review), but increasing economic uncertainty in the spirit of Pastor
and Veronesi (2006) combined with heterogeneous preferences as in this paper provide a
plausible alternative story. Moreover, rising uncertainty also increases the wealth dispersion
across agents, thereby explaining the large increase in wealth inequality in the late 1990s
(see e.g. Saez and Zucman (2016)).

   Under uncertainty and learning, households’ portfolio allocations become extreme. In-
deed, households with low risk tolerance may even short stocks to hedge against bad news
about long-term economic growth. Negative shocks to aggregate output signal even lower
output going forward and such households can hedge against this bad news by shorting stocks
and buying bonds. Indeed, their wealth is negatively correlated with the aggregate economy.
Time varying expected growth and uncertainty are thus potentially important channels for
trading dynamics in a learning environment.

   The focus on continuous distributions of risk tolerance also highlights the behavior of
households with intermediate risk tolerance which are not visible in standard two-agents
models. For instance, as the economy expands agents with intermediate risk tolerance are
first borrowers and then lenders, with the intensity of borrowing and lending determined by
their risk tolerance. This behavior is due to the change in risk-return characteristics of risky
stocks and interest rates in equilibrium. As the economy expands, the aggregate Sharpe
ratio declines, decreasing the attractiveness of stock investment. Although also the risk-free
rate declines, the former effect dominates and induce intermediate agents to move out from
stocks and buy bonds.

   My paper is related to numerous strands of literature: The first and more obvious is
the traditional literature on heterogeneous risk preferences, risk sharing, and asset prices.
Differently from the classic papers of Dumas (1989), Wang (1996), Longstaff and Wang
(2013), and Bahmra and Uppal (2014), I consider a continuum of agents and obtain relations
about the whole distribution of wealth, and not only of two types. This is important to
discuss issues related to wealth distribution, for instance, or the behavior of households in
the middle of the distribution, which cannot be studied in two-agents models. Finally, I
focus on the impact of learning dynamics on portfolio holdings and asset prices, which is
mostly not discussed in this earlier research.



                                                 2
   Cvitanic et al. (2011) consider N types of heterogeneous agents and obtain several re-
sults that are related to some in this paper. While Cvitanic et al. consider multiple sources
of heterogeneity (preferences, beliefs, discounting), I rather focus on generic distributions
of risk-tolerance and endowments and learning about long-term growth. Unlike that pa-
per, I show that heterogeneity and uncertainty explain high valuation, trading volume, and
volatility, for instance, among other results. The papers are complementary from a technical
standpoint, but they focus on different issues.

   Chan and Kogan (2002), Xiorius and Zapatero (2007) and Santos and Veronesi (2018) also
consider models with a continuum of agents, but under the assumption of habit formation or
time-varying risk preferences. My focus is instead on the impact of uncertainty and learning
on households’ consumption and trading patterns, and their relation to asset prices, when
households have standard preferences with constant relative risk aversion (CRRA). From
a technical standpoint, I exploit similar methodologies as in Chan and Kogan (2002) and
Xiorius and Zapatero (2007).

   Pastor and Veronesi (2018) study a two-country model that exploits heterogeneous risk
preference within country and across countries. Unlike this paper, that paper assumes that
agents are averse to inequality, especially the consumption of the “elites”. As the global
economy expands, international risk sharing exacerbates inequality in the rich country. After
a long expansion, the majority of the citizens in the rich country would prefer to consume
less but live in a more equal society by limiting the consumption of the ultra rich. They do
so by voting for a populist who promises to end globalization, as the move to autarky affects
the consumption of the ultra rich the most.

   My paper is also related to the literature on parameter uncertainty and learning (e.g.
David (1997), Veronesi (1999, 2000), Brennan and Xia (2001), Pastor and Veronesi (2006),
Ai (2010), David and Veronesi (2013), Collin-Dufressne et al. (2016) ). This literature
focuses on representative agent’s models and thus does not explore the implications of risk
sharing under uncertainty and learning, which this paper instead develops.

   Finally, my paper is related to the literature on “bubbles” and the trading patterns that
are implied by such frenzy. For instance, Scheinkman and Xiong (2003) show that over-
confidence and short-sale constraints make optimistic investors value stocks more than their
true fundamental value thanks to a “resale option” component. Important, trading volume
is related to such resale option and the existing literature emphasizes trading volume as a
distinguishing pattern of behavioral biases (see e.g. Scheinkman 2014). I show that rais-
ing uncertainty with heterogeneous preferences also induces high valuation, stock volatility


                                              3
and higher dispersion in portfolio allocations, which is in line with the evidence in the late
1990s. Pastor and Veronesi (2009) show that “bubble-like” patterns in both stock prices and
volatility may be due to learning about new technologies, and the “bubble” bursts due to
an increase in discount rates when a new technology is adopted. That paper though does
not consider heterogeneity across agents, which is the focus of this paper.

    The paper develops as follows: Next section introduces the benchmark model without
learning, and the implications for agents’ consumption, wealth, trading, and asset prices.
Section 3. discusses the the implication of uncertainty about long-term growth for risk shar-
ing, portfolio allocation, and trading. In section 4. I calibrate the model. I also put forwards
an assumption on initial endowments that allow for a simple solution to the equilibrium fixed
point problem and thus allows me to obtain simple numerical solutions for the calibration.
Section 5. concludes.



2.      Benchmark Model

Time is continuous and it spans the period [0, T ], where T is finite but large. A finite T helps
deal with the non-stationary nature of the economy. There is a continuum of infinitesimal
agents. All agents have preferences exhibiting Constant Relative Risk Aversion (CRRA)
over their own consumption Cit :
                                                                  1− ρ1
                                                             −φt Cit
                                                                        i

                                          Ui (Cit , t) = e             1                                    (1)
                                                                1−     ρi

where ρi 6= 1 is agent i’s risk tolerance. If ρi = 1 then Ui (Cit , t) = e−φt log (Cit). Risk
tolerance is bounded in the population, that is, ρi ∈ (ρL , ρH ), but I make no additional
assumptions otherwise.

   Agents can invest in a productive risky opportunity or park their savings in a risk-free
                                                                        R
bond. At time 0, agents are born with si shares of the risky asset, with si di = 1.4 I denote
f(ρ, s) the joint density on ρi and si . The risky asset has a unit price Pt and pays a dividend
Dt , where δt = log (Dt ) follows the process

                                             dδt = µdt + σdZt

Zt is a standard Brownian motion, and µ and σ are constants, although this restriction is
   4
                             R
    I often use the notation di to indicate the integral across agents using the relevant density on i, without
specifying the latter to avoid notational clutter. I make the density explicit when it is necessary for economic
interpretation or clarity.


                                                       4
not necessary for the results. In this section I assume µ is known to investors. Section 3.
examines the case in which µ is not known but investors learn its value over time.

   In addition to the risky asset, agents can borrow or lend at the risk-free rate rt , whose
value is determined in equilibrium. Bt is the price of a risk-free bond at t. Both prices Pt
and rt are determined in equilibrium. Markets are thus dynamically complete.

    Denote each agent i’s position in stock Nit and in bonds Nit0 . Each agent maximizes the
intertemporal utility                                           
                                                Z T       1− ρ1
                                                       C      i
                                                                 
                                  max T E0         e−φt it 1 dt
                            {Cit ,Nit ,Nit0 }    0      1 − ρi
                                                          t=0


subject to the budget constraint

                                   dWit = Nit (dPt + Dt dt) + Nit0 Bt rt dt − Cit dt                                   (2)

with initial condition Wi,0 = si P0 .


2.1.    Equilibrium

To understand the logic of the equilibrium, it is useful to go through some of the steps (see
Chan and Kogan (2002), Xiorious and Zapatero (2007)). Markets are dynamically complete
and thus from Cox and Huang (1989) each agent i equivalently solves the static maximization
                                                         
                               Z                1− ρ1                                    "Z                #
                                  T       C        i
                                                                                              T
             max        E0            e−φt it     1    dt      subject to         E0             Mt Cit dt = si P0   (3)
            {Cit }T
                  t=0          0           1−      ρi                                      0


where Mt is the equilibrium state price density (normalized to M0 = 1).

   The Lagrangean of the static optimization is
                                                               
                               Z                 1− ρ1                        "Z                    #          !
                                         T     C      i                             T
                   Li =    E0 
                                          e−φt it 1          dt
                                                                 − ξi   E0             Mt Citdt − si P0               (4)
                                       0       1 − ρi                           0


where ξi is the Lagrange multiplier determined by the static budget constraint. The maxi-
mization is taken state by state and time by time obtaining the first-order condition
                                         − ρ1
                               e−φt Cit     i
                                                = ξi Mt         =⇒       Cit = e−ρi log(ξi )+ρi gt                     (5)

where
                                                        gt = −φt − log (Mt )                                           (6)

                                                                    5
                                                                                                                    R
      Aggregate now across agents and impose the market clearing condition Dt =                                         Cit di to
obtain the equilibrium condition:
                                  Z                                   h                        i
                           Dt =       e−ρi log(ξi )+ρi gt di = E CS e−ρi log(ξi)+ρi gt                                       (7)

where the last step exploits the law of large numbers and E CS [.] denotes the cross-sectional
average across agents i.5 The quantity gt , and hence the equilibrium state price density Mt ,
is the solution to equation (7), which I denote by

                                                    gt = g (δt ) .

The state price density is then
                                                 Mt = e−φt−g(δt)                                                             (8)

    Given the equilibrium g(δt ), the constants ξi are determined by the budget constraints
                                                 hR          i      hR                i
(3). After substitution of Mt and using P0 = E0 0T Mτ Dτ dτ = E0 0T e−φτ +δτ −g(δτ )dτ , the
budget constraint (3) can be written as follows:
                                                                            hR                              i
                                                                               T
                                                                      E0         0    e−φτ +δτ −g(δτ ) dτ
               e−ρi log(ξi ) = si λ(ρi )      where        λ(ρi ) =        hR
                                                                              T
                                                                                                                i            (9)
                                                                      E0     0       e−φτ +(ρi −1)g(δτ ) dτ

I finally substitute this expression back in equilibrium condition (7) to obtain:
                                                       h                     i
                                           eδt = E CS si λ (ρi ) eρi g(δt)                                                  (10)

The normalization M0 = 1 implies g(δ0) = 0. Assuming δ0 = 0 without loss of generality, I
thus have the normalization
                                                E CS [si λ (ρi )] = 1                                                       (11)

      Equations (9) and (10) highlight the nature of the functional fixed-point problem that
characterizes an equilibrium: We need the equilibrium g(δt) to compute the Lagrange mul-
tipliers ξi and hence λ(ρ) from (9) but we need λ(ρ) to compute the equilibrium g(δt) from
(10). Still, assuming that conditions are such that the fixed point has a solution, we can
characterize the solution even without explicitly solving for λ(ρ) (see Chan and Kogan (2002)
and Xiorius and Zapatero (2007) for related results under habit formation):




  5
    I assume throughout conditions are such that the law of large number can be applied. See Feldman and
Gilles (1985), Judd (1985).


                                                           6
Proposition 1: Let the functional fixed-point problem in Equations (9) and (10) have a
solution for every δt. Then:


    (a) The solution g(δt) is unique

    (b) The function g (δt) is globally increasing in δt, it is concave, and it diverges to infinity
           as δt increases. Specifically:
                                                                                      "            #
                                 0         1                   00         0        Et∗∗ [ρ]
                                g (δt ) = ∗     > 0;          g (δt ) = g (δt ) 1 − ∗       <0
                                         Et [ρ]                                    Et [ρ]

           where Et∗[.] and Et∗∗[.] denote cross-sectional averages computed using the following two
           distributions, respectively:
                                            Z
                            ∗
                           f (ρ|δt) ∝           f(ρ, s) s ds λ (ρ) eρg(δt) ;      f ∗∗ (ρ|δt ) ∝ f ∗ (ρ|δt)ρ

    (c) The function g(δt ) > 0 if and only if δt > 0.

    (d) The function g 0 (δt ) is bounded above and below:
                             1                1                                 1                           1
                               > g 0 (δt ) >    ,           lim g 0 (δt) =        ,       lim g 0 (δt) =
                            ρL               ρH           δt →−∞               ρL         δt →∞            ρH


         Before I comment on Proposition 1, the following corollary ties it to the standard homo-
geneous case:6

                                                                                  1
Corollary 1: If ρi = ρj = ρ for all i, j, then g (δt ) =                            δ
                                                                                  ρ t
                                                                                          and the state price density is
                  1                  − 1ρ
Mt = e−φt− ρ δt = e−φt Dt .

         Under homogeneous preferences we have the classic result that the state price density
equals the marginal utility of the representative agent with risk aversion 1/ρ. Even in the
homogeneous case we have g 0 (δt) = 1/ρ > 0; and limδ→∞ g(δ) = ∞ and g (δt ) > 0 for δt > 0.

         Proposition 1 confirms that such properties are true also under heterogeneity. Indeed,
note that g 0 (δt ) is the inverse of the average risk tolerance. Such average, however, is not
computed from the original distribution of ρ, f(ρ), but from a distorted distribution f ∗ (ρ|δt)
that corrects the original one by the state-price density factor g (δ). As δt increases, f ∗ (ρ|δt)
gives increasingly more weight to high ρ (because g (δt) > 0) implying that the effective risk
aversion g 0 (δt) = 1/E ∗ [ρ|δt] decreases as the economy gets stronger.
     6
         The result is easy to see: When all agents are
                                                       identical
                                                                with risk tolerance ρ, λ(ρ) = 1 for all ρ and given
E   CS
         [si ] = 1, equation (10) reduces to δt = log e−ρg(δt ) = −ρg(δt ).


                                                                7
      This effect is due to a combination of risk sharing and different elasticities of intertemporal
substitution (EIS): Agents with lower risk aversion insure agents with higher risk aversion,
and during good times they end up representing more of the aggregate consumption of the
economy. In addition, such agents with higher risk tolerance have also higher EIS. Thus,
they are happy to consume less in bad times but they want to consume more in good times.
Agents with low risk tolerance, in contrast, want to smooth consumption over time and thus
they want to consume more in bad times and relatively less in good times. With CRRA
utility the two channels are interchangeable.

      Although I did not use a representative agent set up to obtain the equilibrium, a repre-
sentative agent exists in this economy, as shown in the next proposition:

Proposition 2. The function g 0(δt ) is the relative risk aversion of the representative agent
in this economy:
                                                     D U 00(D, t)
                                 g 0 (δt) = RRA(D) = −                                          (12)
                                                       U 0 (D, t)
where U(D, t) is the utility function of the representative agent
                                                   Z
                                             −φt       si λ(ρi )eρi g(log(D))
                               U(D, t) = e                                    di                (13)
                                                             1 − ρ1i
The representative agent’s risk aversion is thus decreasing in output
                                       dRRA(D)
                                                  <0
                                           dD


      From Proposition 1, g(δt ) is concave in δt, as g 0 (δt) decreases with δt. The risk aversion
of the representative agent hence decreases as the economy expands. Even if all agents have
constant relative risk aversion, heterogeneity brings about a decrease in risk aversion in good
times. As the economy grows, more weight is given to agents with lower risk aversion and
the state price density reflects such lower weighted risk aversion. I further discuss this effect
in the next section.


2.2.       Optimal Consumption

The endogenous behavior of g(δ) has implications for the equilibrium consumption share of
individual agents, i.e. their consumption-to-output ratio, which is given by: 7
                                   Cit
                                       = si λ (ρi ) eρig(δt )−δt                     (14)
                                   Dt
  7
    See also Chan and Kogan (2002), Xiorius and Zapatero (2008) for a similar expression under habit
formation.


                                                       8
   I then obtain the following:

Corollary 2:


 (a) The C/D ratio is increasing in output for agents with ρi > Et∗ [ρi ].

 (b) Thus, as δt increases, so does the fractions of agents whose C/D is declining in δi.


   Corollary 2 shows that for given δt agents with risk tolerance ρi > Et∗ [ρ] have equilibrium
C/D ratios that increase as δt increases, and agents with low risk tolerance have C/D ratios
that decrease. The first types of agents eat an increasing larger share of aggregate output
compared to the other types. However, interestingly, as output increases so does the effective
average risk tolerance Et∗ [ρ], as agents with higher risk tolerant agents weigh more in the
distribution, and thus the threshold increases. It follows that the fraction of agents with
declining C/D ratio increases as well. That is, there is an increasing share of agents whose
consumption does not keep up with the increase in aggregate output. This is the nature of
risk-sharing with a continuum of heterogeneous agents. The exact mechanism which delivers
this result (in terms of portfolio allocation) is discussed in Section 2.5.

   We observe from expression (14) that the weights of the distribution f ∗ (ρ|δ) in Proposi-
tion 1 depend on consumption shares. In particular, denote Ct (ρ, s) the time-t consumption
of an agent born with risk tolerance ρ and an endowment of s shares. Then:
                                              Z
                                   ∗                        Ct (ρ, s)
                                  f (ρ|δ) =       f(ρ, s)             ds                  (15)
                                                               Dt
This expression shows that the adjusted distribution on ρ depends on the endowment-
weighted consumption share of agents with risk tolerance ρ. For instance, even if ρ was
uniformly distributed, if agents with high ρ consume more, then it is as if the average
risk-tolerance of the economy is higher.

Corollary 3: Agents with higher risk tolerance ρi have more volatile consumption. In par-
ticular:
                                       dCit
                                            = µC,i dt + σC,i dZt                          (16)
                                       Cit
where
                                                            "              #
                                  ρi         1 ρi          ρi − Et∗∗ [ρ]
                       µC,i   =          µ +           1 +                                (17)
                                Et∗ [ρ]      2 Et∗ [ρ]        Et∗ [ρ]
                                  ρi
                       σC,i   =   ∗
                                        σ                                                 (18)
                                Et [ρ]



                                                   9
   Risk tolerance ρi is also the elasticity of intertemporal substitution with CRRA utility.
Higher elasticity of intertemporal substitution then makes agents have more volatile con-
sumption (they are more elastic). Higher risk tolerance also implies a higher growth rate of
consumption (from the first term), due to the willingness of smooth consumption over time
as well and not only across states.       The second term in µC,i is positive for high ρi but it
turns negative for low ρi as Et∗∗ [ρ] increases over time.

Corollary 4: As the economy grows, the simple average consumption volatility declines
                                     Z
                                                           E [ρi ]
                                         σC,i f (ρ) dρ =           σ
                                                           Et∗ [ρ]



   This simple result shows that statistics that do not control for the density f ∗ (ρ|δt) would
highlight properties of consumption volatility that are not real, but just an artifact of miss-
weighting consumption growth.


2.3.    Asset Prices

The interest rate and risk prices only depend on the state price density (8) and thus by Ito’s
Lemma I obtain the following proposition:

Proposition 3: The stochastic discount factor follows the process
                                     dMt
                                         = −rt dt − σM,tdZt                                (19)
                                     Mt
where
                                           (                               !       )
                                      1      1         1 + Et∗∗ [ρ] − Et∗ [ρ]
                       rt   = φ+ ∗        µ−                     ∗
                                                                              σ2           (20)
                                   Et [ρ]    2                Et [ρ]
                                σ
                   σM,t     =                                                              (21)
                              Et∗ [ρ]



   In the special case of ρi = ρ = 1/γ, then Et∗ [ρ] = Et∗∗ [ρ] = ρ and I obtain the standard
                       γ2 2
result rt = φ + γµ −    2
                          σ   and σM,t = γσ.

   From Proposition 1, Et∗ [ρ] increases with δt , as more of the weights goes to higher agents
with higher risk tolerance ρi , then risk prices σM,t declines as the economy improves (see also
Chan and Kogan (2002), Xiorius and Zapatero (2007)).


                                                  10
      The impact of growth on the real interest rate is non-linear. The last term in the paren-
                                                                       2
thesis is declining in δt and converging to 2ρσ H . Thus, if µ is sufficiently large interest rates
decline as the economy becomes larger in size. Intuitively, agents with higher risk tolerance
are also those with higher elasticity of intertemporal substitution (EIS). When the economy
has positive growth such agents have lower desire to borrow to smooth out consumption
compared to those with lower EIS. It follows that rates tend to decline as the economy
grows. A countervailing effect, however, is that as the economy grows so does the average
risk tolerance, and thus precautionary savings demand for bonds declines. This effect tends
to raise interest rates. When µ is sufficiently large the first effect eventually dominates.

    I next discuss the properties of the stock return process. Before I do so, I introduce the
following notation for a generic function K (δt+τ ) of
                                                                         √
                                                       δt+τ = δt + µτ + σ τ x                                        (22)

where x ∼ N (0, 1):
                                                  "Z                                                #
                                                φe−φτ  T −t
            Etx,τ    [K (δt+τ )] = E                       K (δt+τ ) dτ |δt                                          (23)
                                        0    1 − e−φ(T −t)
                                   Z T −t Z ∞                √ 
                                 =            K δt + µτ + σ τ x n (x) fτ (τ |T − t)dxdτ
                                              0         −∞

                                                                 {τ <T −t}                   φe−φτ 1
where n(x) is the standard normal density, fτ (τ |T − t) = 1−e−φ(T   −t)   is the density of a
                                                                       8
truncated random variable τ exponentially distributed over [0, T − t].


Proposition 4: The stock price is
                                                                               h                  i
                                        Pt = p(T − t) eg(δt) Etx,τ eδt+τ −g(δt+τ )                                   (24)

                             1−e−φ(T −t)
where p (T − t) =                φ
                                         .   Thus, the stock return process

                                                  dPt + Dt dt
                                                              = µP t dt + σP tdZt
                                                      Pt
where µP t = rt + σP tσM t, and
                                                       n                                        o
                                       σP t =              1 + g 0 (δt) − Eetx,τ [g 0 (δt+τ )] σ                     (25)

In this formula, Eetx,τ [.] denotes the expectation with respect to the following distribution

                                      fe (x, τ |δt) ∝ n(x)fτ (τ |T − t) eδt+τ −g(δt+τ )                              (26)
  8
                R T −t                            φ           R T −t                   φ       e−φ(T −t) −1
      Indeed,    0
                         fτ (τ |T − t) dτ =   1−e−φ(T −t)      0
                                                                       e−φτ dτ =   1−e−φ(T −t)     −φ         = 1.


                                                                        11
   Pricing formula (24) is a tautology from the definition of Etx,τ [.] and the pricing formula
        hR              i
Pt = Et tT Mτ /Mt Dτ dτ . To understand the volatility formula, recall that

                                                         1
                                          g 0 (δt) =
                                                       Et∗[ρ]
i.e. the inverse of the weighted average of risk tolerance. If all agents have ρi = ρ = constant,
then Et∗ [ρ] = Et+τ
                ∗
                    [ρ] = ρ and thus I obtain the standard result σP t = σ. Indeed, in this
case, the risk premium is simply σ 2/ρ. For instance, if ρ = 0.1 then risk aversion is 10 and
the risk premium is 10σ 2 .

   The existence of heterogeneity introduces time varying risk-tolerance, which in turn gen-
erates time varying volatility and expected return. The size and impact of the effect depends
on whether the following condition is satisfied:

                                     g 0 (δt) > Eetx,τ [g 0 (δt+τ )]                        (27)


   Next corollary explains why:

Corollary 5: (a) The price-dividend ratio
                           Pt                           h                i
                              = p(T − t) eg(δt)−δt Etx,τ eδt+τ −g(δt+τ )                    (28)
                           Dt
is increasing in δt if and only if condition (27) is satisfied.

   (b) Condition (27) is satisfied if ρH > 1 and δt is sufficiently high, or if the standardized
growth rate of the economy µ/σ is sufficiently high.

   If P/D is increasing in δt, then it is easy to see why the model with heterogeneous risk
tolerance increases both the volatility and the risk premium compared to a model with
homogeneous preferences. As δt increases, the stock price increases and the P/D ratio also
gets a positive kick due to a lower discount rate. The two effects compound each other and
the stock price is more volatile and requires a higher risk premium compared to the case
with homogeneous preferences.

   However, the P/D ratio may not be increasing in output δt if an increase in δt increases
the risk-free rate, for instance. If the increase in weighted risk tolerance reduces sufficiently
the precautionary savings demand for bonds, the interest rate may increase with δt which in
turn may decrease the P/D ratio. In this case, the volatility of stock returns would actually
be lower than in the case with homogeneous investors.

                                                  12
2.4.    Wealth and Wealth Dynamics

Dynamic market completeness implies that the wealth of each agent is equal to the present
value of his/her future consumption and thus
                                                "Z                    #
                                                      T   Ms
                                    Wit = Et                 Cis ds
                                                  t       Mt
I now characterize agents’ wealth as a function of aggregate (log) output δt .

Proposition 5: The wealth of each agent i at time t is
                                                               h            i
                         Wit = p(T − t) si λ(ρi ) E x,τ e(ρi −1)g(δt+τ )                  (29)

and the consumption to wealth ratio (C/W) is
                          Cit                  1
                              =            x,τ                                            (30)
                          Wit   p (T − t) Et [e(ρi −1)(g(δt+τ )−g(δt)) ]


   Given (29) and (30), I can analyze a number properties of wealth and C/W ratio, even
without knowing the exact functional form of g (δ) as solution of equation (11), but only its
characterization in Proposition 1.

   First, the random amount of initial shares endowment si affects the level of wealth pro-
portionally going forward. An agent with 10% more shares at time 0 due to a lucky draw
of si will be richer by 10% going forward. Indeed, the consumption/wealth ratio does not
depend on si .

   Second, the dynamics of output δt affects the level of wealth of each agent differently
depending on their risk tolerance. For instance, the log-utility agent (ρi = 1) has wealth
                                                            1 − e−φ(T −t)
                               Witρi =1 = si λ(1) eg(δt )
                                                                 φ
Thus, an increase in output increases the log-utility agent’s wealth. However, if Et∗ (ρ) > 1,
the wealth to output ratio (W/D) of log-utility agent declines with output when δt is large
enough. Indeed,                           
                      d log Witρi =1 /Dt
                                       = g 0 (δ) − 1 < 0 ⇔ Et∗ [ρ] > 1 .
                           dδt
Assuming ρH   > 1, because Et∗ [ρ] → ρH , there is a point in which Et∗ [ρ] > 1 and W/D of
log-utility investor declines with output. Clearly, the consumption/wealth ratio of log utility
agent – a myopic agent – is still deterministic and independent of output, as we would expect
                                      Citρi =1       φ
                                         ρi =1 =     −φ(T −t)
                                      Wit        1−e

                                                  13
   I obtain the following:

Corollary 6: When δt is sufficiently high, for given si , agents with higher risk tolerance ρi
have more wealth than agents with lower risk tolerance.

   It is easy to see how Corollary 6 stems from expression (29) and Proposition 3. Indeed,
recall that si λ(ρi ) = e−ρi log(ξi ) . After substitution, the claim then follows from the fact that
g (δt+τ ) − log(ξi ) > 0 for any ξi when δt+τ is sufficiently high. Because δt+τ is linear in δt, as
the latter increases so does the distribution of δt+τ , yielding the result.

   The same argument implies the following:

Corollary 7: Agents with higher risk tolerance consume a lower percentage of their wealth
than agents with lower risk tolerance.

   This is easy to see as well: we know that (g (δt+τ ) − g (δt)) > 0 for δt+τ > δt . Therefore, in
a growing economy we have a large part of the distribution with g (δt+τ ) − g (δt) > 0. Thus,
                                      h                            i
a higher ρi implies higher Etx,τ e(ρi −1)(g(δt+τ )−g(δt)) and therefore lower C/W. Moreover, as
δt increases concavity implies that the difference (g (δt+τ ) − g (δt )) decreases, and therefore
there is a compression of C/W ratios as the economy grows stronger (for given T − t).

   To discuss further properties, it is useful to first normalize the wealth of each agent by
the aggregate wealth (which equal the stock market price, by market clearing).
                         Z                                     h                  h               ii
                  Pt =       Wjt dj = p(T − t) E CS sj λ(ρj ) E x,τ e(ρj −1)g(δt+τ )                     (31)


Corollary 8:


 (a) The wealth distribution is given by weights
                                                                        h                  i
                                    Wi,t      si λ(ρi ) Etx,τ e(ρi −1)g(δt+τ )
                              ωit =      =     h                h                ii                      (32)
                                    Pt     E CS sj λ(ρj ) Etx,τ e(ρj −1)g(δt+τ )

 (b) The initial weights at time 0 are ωi0 = si .

 (c) Agent i’s wealth share ωit increases with output if and only if
                                          h                             i
                                    Etx,τ g 0 (δt+τ )e(ρi −1)g(δt+τ )
                         (ρi − 1)                                           > 1 − Eetx,τ [g 0 (δt+τ )]   (33)
                                          Etx,τ   [e(ρi −1)g(δt+τ )]

      where recall Eetx,τ [ . ] uses density (26)


                                                          14
 (d) In addition, for any cutoff ρ, the wealth share of agents i with ρi > ρ increases as δt
                                    R
      increases. Denote ωt (ρ) =     i:ρi >ρ   ωit di. Then

                                                      ∂ωt(ρ)
                                                             >0
                                                       ∂δt

   Equation (32) shows the two sources of wealth distribution, namely, the initial random
endowment si and the component due to risk preferences (and their implicit implication for
sharing). The second ratio in (32) can in fact be characterized and it depends on ρi and
the level of current output δt. When δt increases, the wealth share of the top distribution of
risk tolerance ρ > ρ increases, for any ρ (point (d)). This implies of course that the wealth
share of the ones below the cutoff worsen. Point (c) shows the condition under which the
wealth share of agent i increases. The right-hand-side of (33) does not depend on i and it
is increasing in δt . Unfortunately, the left-hand-side is also increasing in δt , unless ρ = 1, in
which case this becomes a constant. It follows that a log utility investor has its wealth share
increase for a while and then decline as the economy grows (assuming ρH > 1).

   I finally characterize the dynamics of wealth:

Proposition 6: Agent i’s wealth dynamics is
                                 dWit + Citdt
                                              = µW it dt + σW it dZt
                                     Wit
where µW it = rt + σW it σM t and
                                                            h                          i
                                                      E x,τ g 0 (δt+τ ) e(ρi −1)g(δt+τ ) 
                 σW it =        g 0 (δt) + (ρi − 1)                                           σ   (34)
                                                            E x,τ [e(ρi −1)g(δt+τ )]   




   Before discussing Proposition 6, I provide a second characterization to the stock price,
based on (31):

Corollary 9: The stock return volatility and expected return can be expressed as
                                                  Z
                                    σP t =            ωit σW it di
                                                        Z
                                    µP t = rt +             ωit µW it di



   The volatility and risk premium of stock returns are wealth-weighted averages of the
volatility and risk premium of the wealth process of individual agents in the economy. I thus
have the following proposition:

                                                       15
Proposition 7:

 (a) There is a threshold ρ∗ > 1 such that for all ρi < ρ∗ agents with higher ρi have higher
       volatility of wealth σW i :
                                             ρi < ρj ⇒ σW it < σW jt

 (b) Let ρH ≤ ρ∗ and let the marginal distribution f(ρ) be continuous on (ρL , ρH ). For
       every δt there is ρ(δt ) such that

                   σW it < σP t < σW jt      for every     i and j such that ρi < ρ(δt ) < ρj

   The condition in Proposition 7 that there is ρ∗ > 1 is not necessary but just sufficient.
It could well be that ρ∗ = ∞ but the general case proved tricky to establish formally given
the generality of the distribution f(ρ). From an economic standpoint, agents with higher
risk tolerance have higher volatility of wealth. Intuitively, such agents are more willing to
have higher consumption in good times and lower consumption in bad times (because they
insure the agents with lower risk tolerance). That is, the consumption of such agents is
more “volatile” than consumption of more risk averse agents, as shown in Corollary 3. It
follows that their wealth – the present value of such consumption streams – respond more
to aggregate shocks as their cash flow volatility is more volatile.

   Part (b) stems from the fact that the average is always strictly between the extremes
and σW it is increasing in ρi . This result is important to understand the “beta” of the wealth
portfolio and the trading positions of agents in this economy, as discussed next.

Proposition 8: Let ρH < ρ∗ where ρ∗ is the threshold in Proposition 7. Then, households
with higher risk tolerance have a higher “beta” of their wealth dynamics. Let
                                             Covt (dWit /Wit , dPt /Pt )
                                     βit =                                                      (35)
                                                  V art (dPt /Pt )
then
                                     ρi < ρ(δt ) < ρj ⇒ βit < 1 < βjt
where ρ(δt) is the threshold in Proposition 7, point (b).

   That is, households with higher risk tolerance have a higher sensitivity of their wealth
to the stock market. Because such households also tend to grow richer than others (see
Corollary 6), we obtain the prediction that richer households tend to have wealth dynamics
that is more sensitive to the stock market. Indeed, this point can also be seen from a
“CAPM” perspective. The risk premium of household i’s wealth is in fact
                                               σW it
                          µW it = σW it σM t =       µP t = βit µP t
                                               σP t

                                                      16
   That is, the rate of return on wealth is higher for households with higher “beta” and
hence, given Proposition 8, for agents with high risk tolerance. Because everything else equal,
agents with high risk tolerance become richer in the long run (see Corollary 6), Proposition
8 lends support to the empirical evidence that richer households have net worth with higher
beta (see e.g. Gomez (2018)). Next section ties these results with households’ optimal
portfolio allocations.


2.5.    Portfolio Allocation

I use the results in Cox and Huang (1986) and the properties of dynamic market completeness
to obtain the relative positions of agents in stocks and bonds. The wealth of agent i can be
written as a portfolio of stocks and bonds:

                                        Wit = Nit Pt + Nit0 Bt                            (36)

where Bt is the value of the bond. We then must have

                                       dWit = NitdPt + Nit0 dBt

From Ito’s lemma, we thus have

                            o (dt) + σW itWit dZt = o (dt) + Nit σP t Pt dZt

Equating the diffusion terms, the position in stocks must be given by
                                                    σW it Wit
                                            Nit =                                         (37)
                                                    σP t Pt
Given Nit , I can determine the position in bonds as a residual
                                                                              
                                                                       σW it
                            Nit0 Bt   = Wit − Nit Pt = Wit          1−
                                                                       σP t

   The model has thus implications on the trading strategy of agents which depend on the
level of the economy δt .

Proposition 9: Let ρH < ρ∗ and let ρ(δt) be threshold defined in Proposition 7. Then
investors with higher risk tolerance ρi > ρ(δt) take on leverage:

                             Nit0 Bit < 0    if and only if      ρi > ρ(δt )

Moreover, investors who lever invest more than 100% of their wealth in risky assets
                              Nit Pt
                                     >1      if and only if      ρi > ρ(δt )
                               Wit

                                                    17
    Proposition 9 provides the economic intuition of the earlier results: Agents with high risk
tolerance borrow from the other agents to invest in the risky security. The risky security
pays off in good times (when δt increases) which in turn make such agents wealthier and
make them consume more. It is all endogenous.

   Proposition 7 and 9 also shows that the identity of agents who take on leverage changes
over time. While general results seems difficult due to the complexity of formulas, I can
provide some partial results around log utility ρ = 1.

Proposition 10: Let the marginal distribution f (ρ) be defined over (ρL , ρH ) with ρL < 1 <
                                                                9
ρH . A log-utility investor leverage if and only if

                                                 Eetx,τ [g 0 (δt+τ )] > 1                        (38)

Condition (38) is satisfied for δt sufficiently low but it is violated for δt sufficiently high. Thus,
the log-utility investor moves from being a borrower to a lender as the economy grows.

      The proposition shows that for sufficiently low δt, the log-utility investor is among those
with higher risk tolerance, and thus that investor will leverage its position. However, as
the economy grows and the wealth shifts towards the agents with even higher risk tolerance
(ρ > 1), such an investor ends up being among those that are not leveraged. Intuitively,
the Sharpe ratio keeps declining and even log-utility investors find it optimal to hold some
bonds, eventually.

      While proving a more general proposition seems hard, by continuity, the proof holds for a
whole set of agents around ρ = 1. In other words, the agents who take leverage are different
as δt increases. The conjecture is that the fraction of agents who lever shrinks over time as
stock return volatility increases. I find such result in my calibration in Section 4.


2.6.        The Dispersion of Risk Tolerance

In this section, I study the impact of the properties of the distribution f(ρ) on asset prices.
For simplicity, let si = 1 for all i, that is, all agents have the same initial endowment. Let
f(ρ) be the distribution of ρ. We then have the following:

Corollary 10: Consider two distributions f1(ρ) and f2 (ρ) with f2 stochastically dominating
  9               e x,τ [ . ] uses distribution (26).
      Recall that E t




                                                           18
f1 . Then E2∗[ρ|δ] > E1∗ [ρ|δ]. Therefore, risk prices σM,t is lower under f2 than under f1 .
Finally, if µ/σ is sufficiently high, then the risk free rate rt is lower under f2 than under f1 .

   That is, if f2(ρ) gives uniformly more mass to higher risk tolerance agents than f1(ρ),
then the weighted average risk tolerance increases. The result is intuitive.

   I now study the impact of the dispersion of risk-tolerance on asset prices. How does
an increase in the dispersion of the distribution f(ρ) affect consumption, wealth, and asset
prices? I analyze the dispersion through a mean-preserving spread to f(ρ).

Proposition 11. Let fmps (ρ) be a mean preserving spread on f(ρ). If µ/σ is sufficiently
high, then there are thresholds δmin and δmax with 0 < δmin < δmax such that the weighted risk
           ∗
tolerance Emps [ρ|δt] < E ∗[ρ|δt] for δt < δmin and Emps
                                                     ∗
                                                         [ρ|δt] > E ∗ [ρ|δt] for δt > δmax.

   Proposition 11 establishes that the risk adjusted risk tolerance E ∗[ρ|δ] decreases for low
δt when we increase the dispersion of risk tolerance, but it increases for high δt . This result
leads to the following implication:

Corollary 11.      Under the conditions of Proposition 11, a mean preserving spread on the
distribution of risk-tolerance increases the market price of risk and the risk-free rate for low
output δt < δmin but decrease them for high output δt > δmax .

   Essentially, an increase in the dispersion of risk tolerance makes some agents more risk
averse and some agents less risk averse than the average (which is kept constant). For low
δt, the impact of more risk averse ones is larger than the impact of less risk averse agents
and thus the consumption/adjusted average risk tolerance decreases. This effect increases
risk prices. In addition, because the same effect decreases the elasticity of intertemporal
substitution, more agents want to borrow, and hence the interest rate increases. However, as
the economy grows, at some point the increase in the mass of agents with lower risk tolerance
becomes a dominant effect, and thus risk prices and interest rate decline by more than under
the original distribution.

   The impact on asset prices of a mean-preserving spread on the distribution of risk toler-
ance is harder to determine. However, the P/D ratio formula (28) indicates that the P/D
                                              h               i
ratio depends on the expected difference Etx,τ eg(δt)−g(δt+τ ) . When g 0(δ) is higher, this ex-
pected difference is higher, and thus we can expect the P/D ratio to be lower. While harder
to prove formally, this argument strongly suggests that a mean preserving spread on risk
tolerance decreases the P/D ratio.




                                                 19
2.7.    Initial Endowments and Asset Prices

I finally discuss the impact of different initial endowments on assets prices. That is, what
happens to asset prices when we shift wealth from e.g. low risk averse to high risk averse
agents? This shift is likely more prevalent than we think in the real world: Redistributive
policies that shift wealth from rich to poor likely shift it from agents with low risk aversion
to those with high risk aversion, as the former are those that become richer in good times.

   Indeed, the previous sections show that agents with high risk tolerance ρ eventually be-
come richer than agents with low risk tolerance. I now study the impact of initial endowments
that depend on risk tolerance ρ:

Proposition 12: Let si = s(ρ)s̃i where s(ρ) is monotonic in ρ such that E CS [s(ρ)] = 1 and
s̃i is a unit-mean positive random noise term uncorrelated with ρi . Then if µ/σ is sufficiently
high, for any two functions s1 (ρ) and s2 (ρ),

                             s10(ρ) > s20(ρ) =⇒ E1∗ [ρ|δ] > E2∗ [ρ|δ]



   Proposition 12 verifies that if we give a higher endowment to low risk tolerant agents
at time zero, then the adjusted average risk-tolerance in the economy decreases. That is,
redistributive policies that transfer funds from high risk tolerant agents to low risk tolerant
agents have the implicit impact of decreasing the weighted average risk tolerance, and hence
risk prices, as implied by the following corollary:

Corollary 12: Under the conditions of Proposition 12:

                               s10(ρ) > s20 (ρ) =⇒ σM t,1 < σM t,2



   Most developed economies have tax and subsidy policies that implicitly transfer wealth
from rich agents to poor agents. Given that wealth is endogenous, however, in my model
the rich agents are those that likely are less risk averse than the poor agents. Consequently,
the transfer of wealth from rich to poor amount to an increase in wealth of more risk averse
agents and thus an increase in the risk premium.




                                                 20
3.      Macroeconomic Uncertainty and Learning

I now introduce macroeconomic uncertainty and learning. The additional assumption is
simple: Let’s assume that the drift rate of output growth µ is not known but distributed
according to a generic prior distribution π0(µ):
                                               µ ∼ π0 (µ)
Because I am interested in studying the possibility of an increase in uncertainty, I do not take
π0(µ) to be normally distributed because the properties of the Kalman-Bucy filter would
imply that uncertainty decreases deterministically. Other non-normal prior distributions
π0(µ) may generate an increase of uncertainty for some periods of time.

   Even if π0 (µ) is a general prior distribution over the parameter µ, I can still characterize
the dynamics of the posterior density of πt(µ).
                                         R
Lemma:       Let π0(µ) be such that          π0(µ)dµ = 1 and π0(µ) > 0. Then for every µ, the
density πt(µ) follows the martingale process:
                                  dπt(µ) = πt (µ) (µ − Et[µ]) σ −1 dZbt                    (39)
where
                                                Z
                                   Et [µ] =         µ πt (µ) dµ                            (40)
                                     dZbt = σ −1 (dδt − Et [µ] dt)                         (41)
                              R
In addition, πt (µ) > 0 and       πt(µ)dµ = 1 almost surely.

     That is, we can easily track the whole distribution πt(µ) over time. From (41) we can
rewrite the dividend process under the information filtration as
                                        dδt = Et [µ] dt + σ dZbt
It follows that all state variables depend only on the innovation process dZbt and thus markets
are dynamically complete. Therefore, the results in the previous section extend immediately
to this case, as we show next. The benefit of this setting is that we can then investigate the
implications of learning and stochastic changes in uncertainty and asset prices and trading.


3.1.     Asset Prices under Parameter Uncertainty

The derivations in Section 2.2. highlight that the results in Propositions 1 and 2, and Corol-
laries 1 and 2 also hold under uncertainty and learning about µ. Indeed, µ does not en-
ter anywhere in those derivations or expressions because of time-separable preferences and

                                                    21
market completeness. The consumption dynamics in Corollary 3, Equation (16), is almost
identical, except that Et [µ] replaces µ (which is not observable) in the formula for expected
consumption growth (17), and the shock to households’ consumption growth is the Brownian
motion dZbt in (41) instead of the unobservable dZt .

   The state price density Mt in Proposition 3 also only depends on δt , which is observable,
and not on the parameter µ. Thus, parameter uncertainty does not affect Mt either. The
stochastic discount factor dMt /Mt in Proposition 3, Equation (19), is only mildly affected
as the interest rate rt in (20) now depends on Et [µ] instead of µ and the shock to the SDF
is now dZbt instead of dZt . The risk price σM t in (21) is unaffected.

    In contrast to households’ consumption and the state-price density, the stock price is
affected by the unobservable µ, as the latter affects the expectation Etx,τ [.]. However, it only
amounts to a change of the definition of the expectation itself. For any function K(δt+τ )
                           √
where δt+τ = δt + µτ + σ τ x we can define Etµ,x,τ [K (δt+τ )] as in (23) except that the
expectation is taken also over µ ∼ πt(µ) in addition to the normal density n(x) and the
density fτ (τ |τ < T ).10 We thus obtain the following modification to Proposition 4:

Proposition 13: The stock price is
                                                                   h              i
                                  Pt = p(T − t) eg(δt ) Etµ,x,τ eδt+τ −g(δt+τ )                       (42)
                        1−e−φ(T −t)
where p (T − t) =           φ
                                    .   Thus, the stock return process

                                          dPt + Dt dt
                                                      = µP t dt + σP t dZbt
                                              Pt
where µP t = rt + σP tσM t and
                              n                                    o                    
                   σP t =       1 + g 0 (δt) − Eetµ,x,τ [g 0 (δt+τ )] σ + Ebt [µ] − Et [µ] σ −1       (43)

In this formula, Eetµ,x,τ [.] denotes the expectation with respect to the distribution

                               fe (µ, x, τ |δt) ∝ πt (µ) n (x) fτ (τ ) eδt+τ −g(δt+τ )                (44)

and Ebt [µ] uses the modified distribution
                                                               h              i
                                        πb t(µ) ∝ πt(µ) Etx,τ eδt+τ −g(δt+τ )|µ                       (45)



   The price formula (42) is the direct extension of the one under certainty in expression
(24). The next corollary follows:
  10
       As shown in Section 4., such expectation is straightforward to compute by Monte Carlo simulations.


                                                          22
Corollary 13: A mean-preserving spread on the distribution πt (µ) increases the stock price
Pt . That is, higher macroeconomic uncertainty increases stock valuations.

    It is easy to see that the parameter µ enters linearly into δt+τ and eδt+τ −g(δt+τ ) is convex in
δt+τ and hence in µ. A mean preserving spread over a convex function increases its expected
value. This result is related to the analogous result under homogeneous preferences (see
Veronesi (2000, proof of Lemma 3) and also Appendix to Pastor and Veronesi (2006)). In
particular, Pastor and Veronesi (2006) use a similar convexity result to explain the high
valuations in the late 1990s, a point I will return to in Section 4.

    The volatility formula (43) under learning is similar to the one under certainty in Propo-
                                                                                                   
sition 4, except that we have the additional learning-related term Ebt[µ] − Et [µ] σ −1 . For-
tunately, as in Veronesi (2000), I can provide a sign to this term depending on whether
       h                i
Etx,τ eδt+τ −g(δt+τ ) |µ is increasing or decreasing in µ. This in turn depends on the distribu-
tion of risk tolerance ρ and the current output δt.

Corollary 14: (a) If ρH < 1, then Ebt[µ] < Et [µ]; (b) If ρH > 1 and δt is sufficiently large,
then Ebt [µ] > Et [µ]

    Characterizing the sign of Ebt [µ] − Et [µ] is not sufficient to also sign the full impact of
learning on volatility and risk premium, however, because uncertainty also impacts the term
Eetµ,x,τ [g 0 (δt+τ )]. We will see in the numerical example that the second term dominates the
impact of learning on asset returns.

   Moving to economics, as in Veronesi (2000), if all agents have EIS< 1 (part (a)), then
higher growth µ always implies a lower P/D ratio. Thus, the diffusion of stock returns is
smaller under learning because a positive shock to dividends increases the expected future
growth which in turn reduces the P/D ratio. Consequently, while the positive shock increases
the price directly because of higher dividend rate, the increase in expected growth reduces
the P/D ratio (for given discount) and thus reduces the impact of the positive shock.

    If ρH > 1, however, and the economy is growing, at some point the weight on high EIS
agents is sufficient to imply that an increase in expected growth rate increases the P/D ratio.
This additional kick to prices will increase the volatility of stocks. Unfortunately, the risk
premium at this point would still be low because risk prices are low.11
  11
    A popular expedient to obtain higher volatility and thus higher risk-premium is to assume that equity is
leveraged. Following Abel (1990), the price of a security that pays DL,t = Dtα for α > 0 not only has higher
volatility on its own, but it generate a P/D ratio that is increasing in µ if α is sufficiently high. As such, the
volatility and equity premium of such security would be enhanced substantially.




                                                       23
3.2.     Wealth Dynamics under Uncertainty

Under parameter uncertainty, the wealth level and its dynamics are immediately related to
their counterparts in Propositions 4 and 5:

Proposition 14: The wealth of each agent i at time t is
                                                                                h                i
                          Wit = p(T − t) si λ(ρi ) eg(δt ) Etµ,x,τ e(ρi −1)g(δt+τ )                                  (46)

and the wealth dynamics is
                                    dWit + Cit dt
                                                  = µW it dt + σW it dZbt                                            (47)
                                        Wit
where µW it = rt + σW it σM t and
                                                 h                                 i
                                          Etµ,x,τ g 0 (δt+τ ) e(ρi −1)g(δt+τ )                           
     σW i,t =        g 0 (δt) + (ρi − 1)                                                 σ + Ebti [µ] − Et[µ] σ −1
                                               Etµ,x,τ   [e(ρi −1)g(δt+τ ) ]       

where Eb i [.] uses the distribution
                                                                h                   i
                                   πb ti (µ) ∝ πt (µ)E x,τ e(ρi −1)g(δt+τ ) |µ



   The volatility of wealth (48 ) is similar to the counterpart in equation (34) without
learning, except for the last term, which depends on parameter uncertainty. Fortunately, we
can easily see whether this term is positive or negative, and it depends on risk tolerance:

Corollary 15: Ebti [µ] > Et [µ] if and only if ρi > 1.

   Corollary 15 suggests that parameter uncertainty increases wealth volatility of agents
that are more risk-tolerant than log-utility, while it decreases wealth volatility of investors
that are less risk-tolerant than log. It is harder to prove the general statement because
parameter uncertainty also affects the second term in equation (48), which is harder to sign.
Still, to first order, it seems that introducing learning increases the volatility of wealth for
agents that are more risk tolerant than log. Indeed, we can instead prove the following:

Corollary 16: The wealth volatility of log-utility investors is not affected by parameter
uncertainty.

   If all investors in the economy are less risk tolerant than log (i.e. ρH < 1), the all
households have lower wealth volatility under learning than under certainty. Although such
result appears paradoxical, it is of course related to the same result already highlighted for
stocks and discussed in Veronesi (2000).

                                                           24
3.3.    Portfolio Allocation under Uncertainty

Because markets are still dynamically complete under learning, the allocations to stocks and
bonds are still given by expressions (37) and (38). To better characterize how the change
in uncertainty affects trading behavior, I consider again a mean-preserving spread on the
distribution πt(µ). General results are hard to obtain in this case, but I can prove the
following:

Proposition 15: Let π̃t (µ) be a mean-preserving-spread on the distribution πt(µ). If σ
is sufficiently small, then a mean-preserving spread on πt (µ) increases the relative position
in stocks of agents with risk-tolerance higher than one, and decreases it for those with risk-
tolerance lower than one. That is
                                        Ñitρi >1   Nitρi >1
                                                  >
                                        Ñitρi <1   Nitρi <1



   Hence, higher uncertainty on the drift rate of consumption increases the relative position
in stocks of agents with risk tolerance higher than 1 and decreases it for agents with risk
tolerance lower than 1. This implies that when heterogeneity of risk aversion encompasses
agents with risk tolerance above and below one, there is a clear increase in the dispersion
of stock positions, and hence of trading across agents. The proposition can only be shown
when σ is sufficiently small by a continuity argument, but simulations below show that it is
rather general fact.

   Corollary 13 and Proposition 15 show that an increase in uncertainty brings about an
increase in stock prices and an increase in the dispersion of portfolio holdings, which can only
be achieved through trading. Because my model with general priors implies that uncertainty
may endogenously increase, we can expect that the price of the stock to increase and the
trading volume increase at the same time. The reason is that higher macroeconomic uncer-
tainty increases risk sharing opportunities across heterogeneous agents and hence it generates
additional trading. Moreover, higher uncertainty also implies that believes fluctuate more
wildly, generating trading volume.




                                                25
4.      A Calibration

To calibrate the model we need to first return to the issue of solving the fixed-point problem
in Equations (9) and (10), that is:
                                                                                   h           i
                                 h                   i                 E0µ,x,τ eδτ −g(δτ )
                  eδt = E CS si λ(ρi )eρi g(δt) ;           λ(ρi ) =                               (48)
                                                                       E0µ,x,τ [e(ρ−1)g(δτ ) ]

For general endowment distributions si , the functional fixed point is hard to solve. I rather
proceed as follows:


  1. Let the endowment be given by

                      si = s(ρi )s̃i   where s̃i > 0, E[s̃i] = 1, Cov[s̃i, ρi ] = 0 ;

  2. Assume the product s(ρ)λ(ρ) has the functional form

                                                               e−ρy
                                            s(ρ)λ(ρ) =
                                                            E CS [e−ρy ]

       for some constant y;

  3. Compute g(δt ) by solving the equation
                                                                           h           i
                                        h                    i     E CS eρ(g(δt)−y)
                           eδt = E CS s(ρ)λ(ρ)eρg(δt ) =                                   ;       (49)
                                                                       E CS [e−ρy ]

  4. Compute                                                h              i
                                                     E0µ,x,τ eδτ −g(δτ )
                                        λ(ρ) =                                 ;
                                                 E0µ,x,τ [e(ρ−1)g(δτ )]
  5. Compute the initial endowment

                                                      1      e−ρy
                                            s(ρ) =                     ;
                                                     λ(ρ) E CS [e−ρy ]

       Some algebra shows that E CS [s(ρ)] = 1.


     When µ/σ is high, λ(ρ) is decreasing in ρ, which in turn makes s(ρ) increasing in ρ. This
is a problem as the procedure above naturally gives more endowment to high risk tolerant
agents. However, by judiciously choosing the constant y I can “undo” the impact of λ(ρ)
on s(ρ) and obtain initial distribution for s(ρ) that is increasing or decreasing in ρ (or U-
shaped). Unfortunately, the simple methodology above to numerically solve the model does

                                                      26
not allow for the case with s(ρ) = 1 for all ρ. Still, the random component s̃i provides noise
in the initial distribution to make the initial endowment look like a flat “cloud”.

    While the above strategy can be carried out for any distribution of ρ, it is useful to have
closed-form formulas for the cross-sectional averages. I thus let risk tolerance be distributed
according to a truncated normal density:
                                                                       
                                     ρi ∼ T rN ρ, σρ2; ρL , ρH
                            
where T rN ρ, σρ2, ρL , ρH       denotes the truncated normal distribution with range (ρL , ρH ).
The equilibrium equation (49) then shows that gt = g(δt) is the solution of:
                                                                                            
                         1                  Φ ρH ; ρb + gt σρ2, σρ2 − Φ ρL ; ρb + gt σρ2, σρ2
             δt = ρb gt + σρ2gt2 + log                                                          (50)
                         2                                      b σρ2 − Φ ρL ; ρ,
                                                         Φ ρH ; ρ,             b σρ2

where ρb = ρ − yσρ2, and Φ ( . ; a, b) denotes the normal CDF with mean a and variance b.
The solution of (50) is straightforward to obtain numerically.12

    Finally, my characterization of many quantities, such as wealth or stock prices, in the form
of expectations allows me to efficiently exploit Monte Carlo integration for the calculations
of such quantities. Given φ > 0, it is straightforward to simulate maturity times τ =
− log(U)/φ, where U ∼Uniform[0, 1] as well as x ∼ N(0, 1) and µ ∼ πt (µ). Given a large
number of simulations (with τ truncated at T ), all the quantities in the form Etµ,x,τ [K(δt+τ )]
can be easily computed as the average of the simulated functions at (µ, x, τ ). In particular,
there is no need to take any integral explicitly.

    Table 1 reports parameter choices for an illustration of the model’s implications. I set
the average economic growth at µ = 3%, which is in line with the data. I instead choose
the volatility of consumption growth at σ = 6%, higher than the aggregate consumption
volatility estimated by national accounts (around 1.5 %). I choose a high volatility for
illustrative purposes, as resolving the equity premium puzzle is not the point of this paper.
I assume the prior π0(µ) is uniform between µL = 0 and µH = .06, µ ∼ U[0, .06]. A positive
support is reasonable as the prior is about long-term growth.
  12
   Indeed, if σρ2 is small and the distribution is away from the boundaries, then equation (50) is well
approximated by δt = ρb gt + 12 σρ2 gt2 whose solution is
                                                     q
                                                         ρb2 + 2σρ2 δt − ρb
                                        ge (δt ) =
                                                               σρ2

The positive root of the quadratic equation ensures the same set of properties of g (δt ) in Proposition 1.
Xiorius and Zapatero (2007) provide a similar expression for their case with habit persistence preferences.


                                                          27
                                           Table 1: Parameters


              µL    µH    µb       σ    φ           ρ   σρ     ρL ρH           E CS [ρ] y T
               0    0.06 0.03     0.06 0.02        0.02 1     0.05 10          0.847 4 100


   The range of risk tolerance is between ρL = 0.02 to ρH = 10 which correspond to risk
aversion parameters between 50 and 0.01. I choose ρ = ρL = 0.02 to obtain a positively
skewed distribution of risk tolerance (as the mode is at ρ.) Evidence from Kimball et al.
(2014) suggests such a strongly positively skewed distribution. It also conforms with the fact
that a large part of the population does not invest in stocks. Given the truncated normal
distribution, the average risk tolerance is given by
                                                                        
                                         2
                                           φ ρL ; ρ, σρ2 − φ ρH ; ρ, σρ2
                       E CS [ρ] = ρ + σρ                                   = 0.847,
                                           Φ ρH ; ρ, σρ2 − Φ ρL ; ρ, σρ2
which corresponds to an average risk aversion of 1.1806. Above, φ(.; a, b) denotes the pdf a
normal distribution with mean a and variance b.

   Panel A in Figure 1 shows the distribution of risk tolerance under this parameterization.
The distribution gives the vast majority of density to high risk averse agents. But it is
strongly positively skewed. So, there are agents with very low risk aversion. The dotted
vertical line denotes the average risk tolerance.

   Panel B shows the value of the function g(δt ) for different values of output Dt = eδt . The
output ranges between 3 and over 6. To give a sense of measure of the x-axis, given a growth
rate µ = .03, the economy takes 23 years to double in size.13

   Panels C and D show the weighted average risk tolerance and the implied risk aversion,
respectively. Focusing on Panel D, the effective aggregate risk aversion is around 1.8 at Dt =
3. As the economy improves, the effective risk aversion declines, as shown in Proposition 1.
By the time the output doubles, the risk aversion dropped close to the average risk aversion.
As the economy keeps growing the effective risk aversion keeps dropping to finally converge
to 1/ρH = 0.1 in the long-run.

   Figure 2 shows the impact of the decrease in effective risk aversion and an increase in
uncertainty on asset prices. For comparison’s purposes, I keep T = 100 across different levels
of output Dt . That is, although I often discuss the behavior of asset prices as the economy
“grows”, there is no temporal dimension implicit in this or the remaining figures.
 13
      The formula is time = log(multiple)/µ.


                                                     28
                          A. Distribution of risk tolerance                                    B. Function g( )
                    0.8                                                           4

                    0.6
                                                                                 3.5
                    0.4




                                                                 g
                                                                                  3
                    0.2

                     0                                                           2.5
                                1       2   3       4   5                              3         4        5           6
                              risk tolerance                                                       Output D
                    C. Weighted Average Risk Tolerance                                     D. Implied Risk Aversion
                    0.9                                                           2
   Risk Tolerance




                                                                 Risk Aversion
                    0.8

                    0.7                                                          1.5

                    0.6

                    0.5                                                           1
                          3         4           5       6                              3         4        5           6
                                     Output D                                                     Output D

Figure 1: Risk Preferences: Real and Weighted. Panel A plots the distribution of
risk tolerance used in the calibration. Panel B shows the function g(δt ). Panel C plots the
consumption weighted risk tolerance E ∗ [ρ|δt] and Panel D reports the implied risk aversion
(1/E ∗ [ρ|δt]). All parameters are in Table 1.

   Each panel of Figure 2 plots two lines. The solid line corresponds to the case with
uncertainty, in which µ is uniformly distributed between µL = 0 and µH = 0.06 as in Table
1. The dashed line corresponds to the case of no uncertainty, with µ = 3%.

   Panel A shows the P/D ratio for D ranging between 3 and 6. In both cases of uncertainty
and certainty, the P/D ratio increases as the economy expands. Intuitively, as the effective
risk aversion decreases – and especially the effective EIS increases – the P/D increases. This
result is consistent with our result in Proposition 4.

   In addition, Panel A shows that higher uncertainty leads to a higher P/D ratio, as the
solid line is higher than the dashed line. This result is consistent with Corollary 13. Pastor
and Veronesi (2006) exploits a similar argument in a model with habit preferences to highlight

                                                            29
                    A. Price Dividend Ratio                             B. Volatility
          60                                               20


          50                                               15
    P/D




                                                       %
          40                                               10
                                 Uncertainty                         Uncertainty
                                 No Uncertainty                      No Uncertainty
          30                                                5
                3        4         5          6                  3      4         5      6
                           Output D                                      Output D
                       C. Risk Premium                               D. Risk-free Rate
          1.5                                               7

                                                           6.5
   %




           1                                           %    6

                      Uncertainty
                                                           5.5       Uncertainty
                      No Uncertainty                                 No Uncertainty
          0.5                                               5
                3        4         5          6                  3      4         5      6
                          Output D                                       Output D

Figure 2: Asset Prices. Panel A plots the P/D ratio, Panel B the stock return volatility,
Panel C the risk premium, and Panel D the risk-free rate. In each panel, the uncertainty case
(solid line) assumes µ is uniformly distributed between 0 and 6%, while the no-uncertainty
case (dotted line) assumes µ = 3%. All other parameters are in Table 1.

that the high uncertainty about profitability of tech companies in the late 1990s may explain
their high stock valuations at that time.

   The high valuations in the late 1990s were accompanied by high volatility, which is also
evident in this model by looking at Panel B. Uncertainty increases return volatility substan-
tially from around 8% under certainty (dashed line) to around 13 - 18% under uncertainty
(solid line). Hence, high valuations and high volatility go hand in hand when they are due
to macroeconomic uncertainty.

   Even in the case of certainty about µ, the dotted line in Panel B shows that volatility
is higher than fundamental volatility, which is at 6%. This is due to the P/D ratio being
increasing in δt, as discussed after Corollary 5.

                                                  30
   Panel C plots the equity premium. Because the volatility of the stochastic discount factor
is still low in the model, σM t = σ/Et∗[ρ], the equity premium is small, especially in the case
of certainty, which ranges between just above 1% to 0.5%. The risk premium declines in
the case of certainty as the effective risk aversion declines as the economy expands. Under
uncertainty, the risk premium is higher, around 1.5%, but still far smaller than in the data
(6%). This model does not resolve the equity premium puzzle.

   Finally, Panel D plots the risk-free rate, which is not affected by uncertainty. The risk
free rate is high (the risk-free rate puzzle) and declines as the economy expands. Because
the expected growth is high enough, the impact through the elasticity of intertemporal
substitution dominates, as explained in Section 2.3.

   In summary, the combination of learning and heterogeneity has a substantial impact on
asset prices, as it increase prices, volatility, and the equity premium. We could expect that an
(endogenous) increase in uncertainty thus leads to higher valuation, higher volatility, and a
higher risk premium. Note that the positive relation between P/D ratio and equity premium
due to an increase in uncertainty would make standard predictive regressions fail. This is
exactly what happened in the late 1990s, when the P/D ratio lost its ability to predict future
stock returns (see e.g. Menzly, Santos and Veronesi (2004)).

   Figure 3 highlights the impact of uncertainty at the micro level. Panel A displays
                                                                              q
                                                                                      the
                                                                                  CS
dispersion of stock holdings across agents, computed as the standard deviation Vt [Nit ].
The plot shows that the dispersion of stock holdings is far higher under uncertainty (solid
line) compared to the case of certainty (dotted line). As the economy expands the dispersion
increases in both cases, but the difference due to uncertainty is dominating the figure. As
explained, higher uncertainty generates additional risk-sharing motives, and households with
high risk tolerance insure those with low risk tolerance.

   Panels C and D show the distribution of positions in stocks and bonds, respectively,
for the case in which output is Dt = 5. The difference between the solid and dotted line
shows that the dispersion of holdings is far larger for the case of uncertainty. Indeed, quite
interestingly, very low risk tolerance households short the stock under uncertainty. This
behavior is due to their hedging demands: because bad news about future output implies
lower future consumption, such agents want to lower their consumption today and save more.
By shorting the stock they gain from lower return and can purchase even more bonds to
consume in the future. An extension of the model to allow for short-sale constraints would
thus likely imply that such agents would not invest in stocks, as shown in the data.




                                              31
               A. Dispersion of Stock Holdings                             B. Dispersion of Wealth Shares
              15                                                          30
                           Uncertainty                                             Uncertainty
                           No Uncertainty                                          No Uncertainty




                                                              Std(Wi/P)
              10                                                          20
    Std(Ni)



               5                                                          10


               0                                                           0
                   3            4           5       6                          3         4           5       6
                                Output D                                               Output D
                       10 -3C. Stock Holdings                                      D. Bond Holdings
                                                                           2                     Uncertainty
               4                                                                                 No Uncertainty

               2                                                           1
                                                          N0i B
   Ni




               0
                                                                           0
                                        Uncertainty
              -2                        No Uncertainty

                          1         2   3       4    5                             1         2   3       4    5
                              Risk tolerance                                           Risk tolerance


Figure 3: Portfolio
                 q Holdings and Wealth. Panel A plots the cross-sectional dispersion
of stock holdings VtCS [Nit]. Panel B plots the cross-sectional dispersion of wealth across
households. Panel C plots the actual distribution of stock holdings for the case D = 5 across
households, and panel D plots the distribution of bond holdings for the case D = 5. In each
panel, the uncertainty case (solid line) assumes µ is uniformly distributed between 0 and
6%, while the no-uncertainty case (dotted line) assumes µ = 3%. All other parameters are
in Table 1.

   Finally, Panel B of Figure 3 shows that higher uncertainty about economic growth also
implies a far higher dispersion of wealth shares across households. That is, a higher wealth
inequality. The intuitive reason is that high uncertainty make households take on more
extreme positions in stocks which in turn affect their wealth distribution.

   The results of Figures 2 and 3 thus suggest that an increase in uncertainty should increase
the P/D ratio, return volatility, wealth inequality, and the dispersion of stock holdings, i.e.
increase trading volume. These patterns are shown in Figure 4, which plots an example
simulation with endogenous increase in uncertainty. Indeed, because I do not impose that


                                                         32
   A. Uncertainty and Expected Growth                                            B. P/D Ratio and Volatility
               1.6                                                         70                                        20
                                                 3




                                                                                                                          Volatility (%)
               1.5
    Percent




                                                        Percent
                                                                           60
                                                 2.5




                                                                    P/D
                                                                                                                     15
               1.4
                                      ( )        2                         50
                                  t                                                                     P/D
                                 E( )                                                                   Volatility
               1.3                t
                                                 1.5                       40                                        10
                     2   4   6   8          10                                       2     4    6   8      10
                         Years                                                                 Years
              C. Stock Holdings and Volume                                               D. Wealth Inequality
                                                 0.08
                                 Dispersion
                                 Volume                                          5
               15                                0.06


                                                                     Std(Wi/P)
                                                           Volume
     Std(Ni)




                                                                                 4
                                                 0.04
               10                                                                3
                                                 0.02                            2

                5                                0
                     2   4   6   8          10                                       2     4    6   8      10
                             Years                                                              Years

Figure 4: Endogenous Uncertainty, Asset Prices, and Portfolio Holdings. Panel
A plots the uncertainty on economic growth (solid line) and expected growth (dotted line)
in a simulated
      q         path. Uncertainty is defined as the standard deviation on economic growth
Ut = Et [(µ − Et [µ])2]. Panel B plots the corresponding P/D ratio (solid line) and the stock
return
q      volatility (dotted line). Panel C plots the cross-sectional dispersion of stock holdings
    CS
  Vt [Nit] (solid line) and trading volume (dotted line), computed as the average absolute
change in stock holdings. Panel D plots wealth inequality, computed as the cross-sectional
dispersion in wealth shares. Parameters are in Table 1.

priors are normally distributed, the learning dynamics is non-linear. Although uncertainty
decreases on average (eventually it will go to zero), there are episodes of endogenous increases
in uncertainty due to realizations of shocks that are farther away from the mean.

   Panel A of Figure 4 plots an example of an increase in uncertainty in simulation,
                                                                           q
                                                                                     where I
compute uncertainty as the standard deviation of beliefs over µ, that is Ut =                                 Et [(µ − Et[µ])2 ].
I purposely choose a time period in which such uncertainty increases, as it is evident between
t = 3 and t = 6, when Ut increases from 1.3% to 1.6%. The panel also shows that at the


                                                              33
same time expected economic growth Et [µ] also increases from around 1.5% to 3%.

    The solid line in Panel B shows that the P/D ratio increases substantially, from 48 to
70, in response to such increase in expected growth and uncertainty. The large increase in
the price valuation and the subsequent decline may be dubbed “a bubble” on an ex-post
basis. The dotted line in the same panel shows that stock return volatility also increases in
response to an increase in uncertainty, moving from 11% to 17%.

   The solid line in panel C shows that the dispersion of stock holdings across agents in-
creased from 6 to 14, consistently with Proposition 15. As uncertainty and expected growth
increases (Panel A) the dispersion also increases generating trading volume, as more risk
tolerant agents purchase stocks from less risk tolerant agents. The dotted line in Panel C
plots the trading volume, which is computed as the average absolute change in stock holdings
at discrete time intervals. By comparing the dotted line with Panel A, we see that changes
in both uncertainty and expected growth are accompanied by spikes in trading volume. In-
deed, a regression of trading volume on absolute changes in uncertainty and expected growth
yields a 90% R2 , with both uncertainty and expected growth strongly significant.

   Finally, Panel D plots the wealth inequality across agents, measured as the cross-sectional
variance of wealth shares. The increase in uncertainty and expected growth generates a large
increase of wealth inequality, as the increase in stock market make some households, the more
risk tolerant, far more wealthier than others, the less risk tolerant.

   To further emphasize the relation between the variation in uncertainty, the variation in
economic growth, and trading volume, Figure 5 shows the scatterplots of trading volume
(y-axis) against absolute changes in uncertainty (Panel A) and absolute changes in expected
growth (Panel B). The scatterplots are computed over 50 simulated paths of 50-years each
using the parameters in Table 1. As can be seen, variation in uncertainty explains 65%
of trading volume, while variation in expected growth explains 74% of the trading volume.
When combined, changes in both uncertainty and expected growth have a R2 = 84%, with
both quantities strongly significant. In summary, learning dynamics generates a large amount
of trading volume in periods characterized by large changes in uncertainty and expected
growth simply due to risk sharing motives.

   The patterns of price movements, volatility, portfolio holdings, and trading volume de-
picted in panels A through C of Figure 4 are normally ascribed to bubbles and behavioral
biases (see e.g. Scheinkman and Xiong (2003), Greenwood and Nagel (2009)) but as can
be seen they can be generated in a model with heterogeneous agents and uncertainty about



                                              34
Figure 5: Trading Volume. Panel A plots the trading volume (y-axis) against the absolute
changes in uncertainty (x-axis) on 50 simulated paths of 50 years each. The solid line
represents the pooled regression line with its corresponding R2 . Panel B plots trading volume
against absolute changes in expected aggregate growth. Trading volume is computed as the
average absolute change in households’ stock holdings at discrete intervals. Parameters are
in Table 1.

long-term growth.14 The fact that the late 1990s were characterized by increasing uncertainty
about long-term growth is quite plausible (see Pastor and Veronesi (2006) for discussion).
While models with representative agents do not have predictions about portfolio holdings
and trading, the contribution of this paper in this regard is to show that the same forces
that generate higher price valuations and volatility also generate an increase in dispersion of
portfolio holdings, and hence trading volume, due to higher need for risk sharing. In addi-
  14
     Panel C of Figure 4 shows that trading volume tames at the peak of the “bubble” in this simulation,
as uncertainty and economic growth also flatten (Panel A). Evidence suggests that trading volume was high
also at the peak of the 1990s dot-com bubble, suggesting large variations in uncertainty and economic growth
also at the peak, which the simulation in Figure 4 does not capture.



                                                    35
                                           A. Stock Holdings
                0.01

                    0

           Ni   -0.01                                                        Dt =2
                                                                             Dt =4
                -0.02                                                        Dt =6

                -0.03
                         0.5   1     1.5    2        2.5   3   3.5    4     4.5       5
                                            Risk tolerance
                                            B. Bond Holdings
                    3
                                                                             Dt =2
                    2
                                                                             D =4
                                                                                  t
                B




                    1                                                        D =6
             N0
              i




                                                                                  t


                    0

                    -1
                         0.5   1     1.5    2        2.5   3   3.5    4     4.5       5
                                            Risk tolerance


Figure 6: Portfolio Holdings. Panel A plots the distribution of stock holdings for three
values of output Dt = 2, 4, 6. Panel B plots the distribution of bond holdings for the same
values. Parameters are in Table 1.

tion, wealth inequality also substantially increases due to the same forces, which is consistent
with the trends in the late 1990s (see e.g. Saez and Zucman (2016)).

   Finally, Figure 6 plots the distribution of stock holdings (Panel A) and bond holdings
(Panel B) across households for three values of Dt . This figure highlights that households
with intermediate risk tolerance qualitatively change their portfolio holdings as the econ-
omy expands. Consistently with the result of Proposition 10, households with risk aversion
around 1 are borrowers for low Dt = 2, but they become lenders for Dt = 6, although at
different times depending on risk tolerance. Households at the extremes, instead, are either
always lenders (low risk tolerance) or always borrowers (high risk tolerance). The identity of
borrowers and lenders thus change over time, as it depends on the risk-return characteristics
of stock returns and the level of interest rates.


                                                36
5.      Conclusions

The documented households heterogeneity in risk preferences and endowments is crucial to
understand the dynamics of their behavior in response to a changing economic environment as
well as to understand equilibrium asset prices. I show that such heterogeneity combined with
time-varying uncertainty about long-term growth produces several empirical facts that are
consistent with the empirical evidence. As the economy expands, the share of agents who do
not keep up with the economy increases, the wealth distribution becomes more extreme, and
households qualitatively modify their position in stocks and bonds. For instance, households
with intermediate risk preferences move from being borrowers and leverage their purchases
of risky assets to lenders and choose more conservative positions.

   More important, the increase in macroeconomic uncertainty exacerbates heterogeneity
across agents and provides further motives for risk sharing: With high uncertainty, house-
holds with high risk tolerance take on much more aggressive positions than households with
low risk tolerance. Moreover, endogenous increases in uncertainty increase trading motives
and hence yields additional trading volume as agents move to more extreme positions in
risky stocks. My model predicts that an endogenous increase in uncertainty increases price
valuations, return volatility, wealth inequality, and dispersion in traders’ portfolio holdings,
consistently with the evidence during the dot-com bubble of the late 1990s.

     The model is set in the convenient framework of complete markets. Under learning, the
model implies that households with low risk tolerance may hold short positions in stocks.
Introducing incomplete markets and short sale constraints in my model with heterogeneous
agents and learning may thus yield the result that the most risk averse agents do not invest
in the stock market, consistently with the data. Time varying uncertainty and expected
growth would still lead to large variation in trading volume because of the large number of
other agents who are not constrained. Unfortunately, the case with incomplete markets is
substantially more challenging and I thus leave this topic to future research.




                                              37
References

Ai, Hengjie (2010) “Information Quality and Long-run Risk: Asset Pricing Implications,”
    Journal of Finance, vol. 65, Issue 4, 1333-1367

Barsky, Robert B., F. Thomas Juster Miles S. Kimball Matthew D. Shapiro (1997) “Pref-
    erence Parameters and Behavioral Heterogeneity: An Experimental Approach in the
    Health and Retirement Study,” Quarterly Journal of Economics, 112, 2, 537–579.

Bhamra, Horjat and Raman Uppal, (2014), “Asset Prices with Heterogeneity in Preferences
    and Beliefs,” The Review of Financial Studies.

Brennan, Michael J., and Yihong Xia, (2001), “Stock return volatility and equity premium,”
    Journal of Monetary Economics 47

Chan, Yeung Lewis and Leonid Kogan (2002) “Catching up with the Jonese: Heterogeneous
    Preferences and the Dynamics of Asset Prices,” Journal of Political Economy, 110, no.
    6: 1255–1285.

Chiappori, P. A., Krislert Samphantharak, Sam Schulhofer-Wohl, and Robert M. Towne-
    send, (2014)“Heterogeneity and risk sharing in village economies,” Quantitative Eco-
    nomics, 1–27.

Colling-Dufresne, Pierre, Michael Johannes, and Lars Lochster (2016) “Parameter learning
     in General Equilibrium: The Asset Pricing Implications,” American Economic Review,
    106 (3), 664–698.

Cox, John, and Chi-fu Huang (1989) “Optimal Consumption and Portfolio Policies when
    Asset Prices Follow a Diffusion Process.” Journal of Economic Theory Vol. 49, No. 1:
    33–893.

Cvitanic, J., E. Jouini, S. Malamud and C. Napp (2012) “Financial Markets Equilibrium
    with Heterogeneous Agents.” Review of Finance, 16 , 285321.

David, Alexander (1997) “Fluctuating Confidence in Stock Markets: Implications for Re-
    turns and Volatility Journal of Financial and Quantitative Analysis.

David, Alexander and Pietro Veronesi (2013) “What Ties Return Volatilities to Price Val-
    uations and Fundamentals?” Journal of Political Economy, 121, 4, 682–746.

Dumas, B. (1989)“Two-person dynamic equilibrium in the capital market,” Review of Fi-
    nancial Studies, Vol. 2, pp. 157?188.

                                            38
Feldman, Mark, and Gilles, Christian. (1985) “An Expository Note on Individual Risk
    without Aggregate Uncertainty.” J. Econ. Theory 35 (February): 2632

Gomez, Matthieu (2017) “Asset Prices and Wealth Inequality,” working paper, Princeton
    University.

Greenwood R. and S. Nagel (2009) “Inexperienced Investors and the Bubble” Journal of
    Financial Economics, 93, 239–258.

Kimball Miles S, Claudia R. Sahm, and Matthew D Shapiro (2008) “Inputing Risk Tolerance
    from Survey Responses” Journal of the American Statistical Association, 103: 483,
    1028 – 1038

Judd, Kenneth L. (1985) “The Law of Large Numbers with a Continuum of IID Random
    Variables.” J. Econ. Theory 35 (February): 19-25.

Liptser Robert S. and N. Shiryaev (2001) “Statistics of Random Processes” Springer-Verlag
    Berlin Heidelberg .

Longstaff, Francis A. and Jiang Wang (2012) “Asset Pricing and the Credit Market,” Re-
    view of Financial Studies, vol. 25 (11): 3169–3215.

Menzly, Lior, Tano Santos, and Pietro Veronesi (2004) “Understanding Predictability”
    Journal of Political Economy, 112, 1: 1–47.

Pastor, Lubos and Pietro Veronesi (2006) “Was There a NASDAQ Bubble in the Late
    1990s?” Journal of Financial Economics 81, 61 – 100

Pastor, Lubos and Pietro Veronesi (2018) “ Inequality Aversion, Populism, and the Backlash
    Against Globalization,” Working Paper, University of Chicago.

Saez, Emmanuel and Gabriel Zucman (2016) “Wealth Inequality in the United States since
    1913: Evidence from Capitalized Income Tax Data,” Quarterly Journal of Economics,
    vol. 131 no. 2, 519–578.

Santos, Tano and Pietro Veronesi (2018) “Leverage” Working Paper, University of Chicago.

Scheinkman, Jose A. (2014) “Speculation, Trading, and Bubbles,” Kenneth J. Arrow Lec-
    ture Series, Columbia University Press, New York.

Scheinkman, Jose A. and Wei Xiong (2003) “Overconfidence and Speculative Bubbles,”
    Journal of Political Economy, December 2003, 1183-1219.



                                           39
Townsend, Robert M. “Risk and Insurance in Village india,” Econometrica, May, 62(3),
    539–591.

Veronesi, Pietro (1999) “Stock Market Overreaction to Bad News in Good Times: A Ra-
    tional Expectations Equilibrium Model,” Review of Financial Studies , 12, 5.

Veronesi, Pietro (2000) “How does Information Quality Affect Stock Returns?” Journal of
    Finance, 55, 2.

Wang, Jiang (1996) “The Term Structure of Interest Rates in a Pure Exchange Economy
    with Heterogeneous Investors,” Journal Financial Economics 41 (May): 75–110.

Xiouros, C. and F. Zapatero, (2010) “The Representative Agent of an Economy with Exter-
    nal Habit-Formation and Heterogeneous Risk-Aversion,” Review of Financial Studies,
    23: 3017-3047.




                                          40
Appendix: Proofs

Proof of Proposition 1. The equilibrium condition defines g (δt) as the solution to

                                              δt = log (E [si λ (ρi ) eρi g ])

The right-hand-side (RHS) of this equation is monotonically increasing in g, as
                              ∂ log (E [si λ (ρi ) eρi g ])   E [si ρi λ (ρi ) eρi g ]
                                                            =                          > 0.
                                         ∂g                    E [si λ (ρi ) eρi g ]
Thus the solution g(δt ) is unique. Note that we have the restriction M0 = 1 and assuming
δ0 = 0 without loss of generality, the restriction requires the following normalization

                                                   0 = log (E [si λ (ρi )])


   Take now the total differential with respect to δt to find
                                                                h                       i
                                                g 0 (δt ) E ρi si λ (ρi ) eρi g(δt)
                                          1=
                                                          E [si λ (ρi ) eρi g(δt ) ]
Define a new density over ρi
                                                      R
                                  ∗                        f (ρi , si ) si λ (ρi ) eρi g(δt) dsi
                                f (ρi |δt) = R R
                                                          f (ρi , si ) si λ (ρi ) eρi g(δt ) dρi dsi
Thus obtaining
                                                    1
                                                g 0 (δt) = >0
                                               E ∗ [ρ|δt ]
That is, g (δt) is globally increasing, and g (δt ) > 0 for δt > 0.

   To prove concavity, rewrite
                                                                h                       i
                                                            E e−ρi log(ξi )+ρi g(δt )
                                          g 0 (δt ) =
                                                          E [ρi e−ρi log(ξi )+ρi g(δt) ]
and compute the second derivative
                 h                                      i           h                       i       h                            i
              E ρi g 0 (δt) e−ρi log(ξi )+ρi g(δt)              E e−ρi log(ξi )+ρi g(δt) E ρ2i g 0 (δt) e−ρi log(ξi )+ρi g(δt)
g” (δt ) =                                                  −                                                        2
                     E [ρi e−ρi log(ξi )+ρi g(δt) ]                               (E [ρi e−ρi log(ξi)+ρi g(δt ) ])
                         h                          i                   h                      i       h                i
                         E ρi e−ρi log(ξi)+ρi g(δt)                E e−ρi log(ξi)+ρi g(δt) E ρ2i e−ρi log(ξi )+ρi g(δt) 
         = g 0 (δt)                                           −                                     2
                         E [ρi e−ρi log(ξi)+ρi g(δt) ]            (E [ρi e−ρi log(ξi)+ρi g(δt ) ])                      
                                h                      i h                        i
                             E e−ρi log(ξi )+ρi g(δt ) E ρ2i e−ρi log(ξi)+ρi g(δt) 
         = g 0 (δt) 1 −
                                E [ρi e−ρi log(ξi )+ρi g(δt) ] E [ρi e−ρi log(ξi)+ρi g(δt ) ] 
                        (                      )
                       E ∗∗ [ρi |δt ]
         = g 0 (δt) 1 − ∗
                       E [ρi |δt]

                                                                    41
where now
                                                        R
                          ∗∗               ρ f (ρ, ξ) e−ρi log(ξi )+ρi g(δt )dξ
                      f        (ρ|δt ) = R R
                                             f (ρ, ξ) ρe−ρi log(ξi)+ρi g(δt) dξdρ
                                                      R R −ρ log(ξ )+ρ g(δ )
                                         ρf ∗ (ρ|δt )    e i        i     i    t
                                                                                    dρi dξi
                                       = RR                −ρ  log(ξ   )+ρ  g(δ   )
                                               f (ρ, ξ) ρe   i       i    i     t   dξdρ
                                               ∗
                                            ρf (ρ|δt)
                                       = R ∗
                                           ρf (ρ|δt ) dρ

Note that f ∗∗ (ρ|δt ) provides uniformly higher mass to higher ρ than lower ρ, and thus the
expectation using f ∗∗ (ρ|δt ) must be higher than using f ∗ (ρ|δt ). Hence

                                                  E ∗∗ [ρ|δt] > E ∗ [ρ|δt ]

which gives                                                  (                      )
                                                    0   E ∗∗ [ρi |δt ]
                                  g” (δt ) = g (δt ) 1 − ∗                              <0
                                                        E [ρi |δt ]

   Finally, as δt increases and thus g (δt ) > 0, the density
                                                    R
                                 ∗                      f (ρi , ξi ) e−ρi log(ξi )+ρi g(δt )dξi
                                f (ρi |δt) =            RR
                                                            e−ρi log(ξi)+ρi g(δt ) dρi dξi
gives increasingly higher weight to high ρi (recall that ξi are fixed constants) and therefore
f ∗ (ρ|δt ) converges to a degenerate distribution around ρH and hence
                                                                        1
                                                        g 0 (δt ) →
                                                                       ρH
Similarly, as δt decreases, g (δ) < 0 and the distribution f ∗ (ρ|δt ) becomes degenerate around
ρL .

   Q.E.D.


   Proof of Proposition 2. We know that the representative agent is given by

                                              Z               1− ρ1                      Z
                                                  1 e−φt Cit      i

                 U (Dt , t) = max                                     di subject to          Cit di = Dt
                                     {Cit }       ξi 1 − ρ1i

Therefore, we have from the FOC of the social planner Lagrangean that
                                                   1 −φt − ρ1i
                                                      e Cit = Mt
                                                   ξi
where Mt is the lagrange multiplier (where we use the notation in the decentralized economy,
i.e. Mt is the state price density). Therefore, we have the solution for consumption is the

                                                                 42
one discussed in the text. The utility function of the representative agent is thus
                                                                                               1− 1
                                                      Z                  e−ρi log(ξ)+ρi g(δt)      ρi
                                               −φt            − log(ξ)
                         U (Dt , t) = e                   e                            1                di
                                                                                 1−    ρi
                                                      Z
                                                          e−ρi log(ξ)+(ρi −1)g(δt)
                                         = e−φt                                    di
                                                                  1 − ρ1i

Recall
                                                  e−ρi log(ξ) = si λ (ρi )

thus                                                      Z
                                                                si λ (ρi ) e(ρi −1)g(log(D))
                                   U (Dt , t) = e−φt                                         di
                                                                          1 − ρ1i
We now compute the risk aversion

                                                                     D U” (D, t)
                                             RA (D) = −
                                                                      U 0 (D, t)

We have
                               Z
       0                −φt        si λ (ρi ) e(ρi −1)g(log(D)) (ρi − 1) g 0 (δ) 1
     U (Dt , t) = e                                                             di
                                                       1 − ρ1i                     D
                               Z
                        −φtsi λ (ρi ) e(ρi −1)g(log(D)) ρi (ρi − 1) g 0 (δ) 1
                  = e                                                         di
                                               (ρi − 1)                           D
                                       Z
                                                                              1
               = g 0 (log (D)) e−φt si λ (ρi ) e(ρi −1)g(log(D)) ρi di
                                            Z
                                                                              D
                                  1 −φt                     (ρi −1)g(log(D))       1
     U” (D, t) = g” (log (D)) e                si λ (ρi ) e                  ρi di
                                  D Z                                              D
                                                                                                               1 1
                       +g 0 (log (D)) e−φt            si λ (ρi ) e(ρi −1)g(log(D)) (ρi − 1) ρi g 0 (log (D))    di
                                                  Z
                                                                                                               D D
                           0                −φt                                             1
                       −g (log (D)) e                 si λ (ρi ) e(ρi −1)g(log(D)) ρi di
                                                                                            D2
or
                                                                 Z
                                     1
            U” (D, t) = g” (log (D)) 2 e−φt si λ (ρi ) e(ρi −1)g(log(D))ρi di
                                    D         Z
                           0        2 1 −φt
                        +g (log (D)) 2 e         si λ (ρi ) e(ρi −1)g(log(D)) (ρi − 1) ρi di
                                       D Z
                           0           −φt                                    1
                        −g (log (D)) e     si λ (ρi ) e(ρi −1)g(log(D)) ρi di 2
                                                                             D

     Therefore, recall

                    D U” (D, t)
 RA (D) = −
                     U 0 (D, t)

                                                                 43
                                      R                                                                R                                          
                        g”(log(D))         si λ(ρi )e(ρi −1)g(log(D)) ρi di             g 0 (log(D))2    si λ(ρi )e(ρi −1)g(log(D)) (ρi −1)ρi di
                    
                                       R                                           +                      R
                                                                                                                                                   
                        g 0 (log(D))       s λ(ρ )e(ρi −1)g(log(D)) ρ di                     g 0 (log(D)) s λ(ρ )e(ρi −1)g(log(D)) ρ di
            = −
               
                                            i     i
                                                              g 0 (log(D))
                                                                           R   i                             i
                                                                                   si λ(ρi )e(ρi −1)g(log(D)) ρi di
                                                                                                                     i                  i          
                                                                                                                                                   
                                                            −              R
                                                                 g 0 (log(D))      s λ(ρ )e(ρi −1)g(log(D)) ρ di
                                                                                    i    i                       i
                    "                                                      R                                                                           #
                                                      0
                 g” (log (D)) g                           (log (D)) si λ (ρi ) e(ρi −1)g(log(D)) ρ2i di
            = − 0             +                               R      − g 0 (log (D)) − 1
                 g (log (D))                                    si λ (ρi ) e(ρi −1)g(log(D)) ρi di
               "                                                   #
                 g” (log (D))    0           ∗∗      0
            = − 0             + g (log (D)) E [ρ] − g (log (D)) − 1
                 g (log (D))
Recall now
                                                                           1
                                                g 0 (δ) =
                                                                    E∗     [ρ|δ]
                                                                               "                        #
                                                              E ∗∗ [ρ|δ]
                                                                       0
                                            g” (δ) = g (δ) 1 − ∗
                                                              E [ρ|δ]
obtaining
                        "                         "                            #                                                               #
                    g 0 (δ)          E ∗∗ [ρ|δ]
    RA (D) = − 0               1− ∗               + g 0 (log (D)) E ∗∗ [ρ] − g 0 (log (D)) − 1
                 g (log (D))         E [ρ|δ]
           = − [1 − g 0 (log (D)) E ∗∗ [ρ|δ] + g 0 (log (D)) E ∗∗ [ρ] − g 0 (log (D)) − 1]
                 = g 0 (log (D))
                 = g 0 (δt)

Q.E.D.


   Proof of Corollary 2. From (5) and (9) the consumption share is
                                                      Cit
                                                          = e−ρi log(ξi )+ρi g(δt )−δt
                                                      Dt
Therefore
                            ∂Cit /Dt
                                     = (ρi g 0 (δt ) − 1) e−ρi log(ξi )+ρi g(δt )−δt > 0
                              ∂δt
if and only if
                                                             ρi g 0 (δt ) − 1 > 0
i.e. if and only if
                                                                       1
                                                          ρi >               = E ∗ [ρ|δt]
                                                                  g0   (δt )
The last point follows from the fact that g 0 (δt) is decreasing and hence E ∗ [ρ|δt] is increasing
in δt. As the economy expands, fewer agents satisfy this condition. Q.E.D.


   Proof of Corollary 3: From

                                                          Cit = e−ρi log(ξi )+ρi g(δt)

                                                                           44
Ito’s Lemma implies
                                                      1                      n                        o
                                                                                          2
        dCit = e−ρi log(ξi )+ρi g(δt )ρi g 0 (δ) dδt + e−ρi log(ξi )+ρi g(δt) [ρi g 0 (δ)] + ρi g” (δ) dδt2
                                                      2
and hence
        dCit                   1                     n                        o
                                                                  2
             = ρi g 0 (δ) µdt + e−ρi log(ξi)+ρi g(δt) [ρi g 0 (δ)] + ρi g” (δ) σ 2dt + ρi g 0 (δ) dZt
         Cit                   2
or
                               "            #2                           !        
     dCit    ρi µ    1    ρi                         ρi       E ∗∗ [ρ|δt]  2       ρi
          = ∗      +                              + ∗        1− ∗           σ dt + ∗       dZt
      Cit  E [ρ|δt] 2  E [ρ|δt]
                         ∗                         E [ρ|δt ]   E [ρ|δt ]         E [ρ|δt]

or                                  (         (                       )     )
               dCit     ρ        1    ρi − E ∗∗ [ρ|δt]   2          ρi
                    = ∗       µ+   1+                  σ   dt +            dZt
                Cit  E [ρ|δt]    2       E ∗ [ρ|δt]             E ∗ [ρ|δt]
Q.E.D.


     Proof of Proposition 3. The stochastic discount factor is

                                                  Mt = e−φt−g(δt)

Therefore
                                                             1h 0                i
                     dMt = −φMdt − g 0 (δ) Mt dδ +             g (δt )2 − g” (δt) Mt dδ 2
                                                             2
Hence
                dMt                       1h       2
                                                             i
                    = −φdt − g 0 (δ) µdt + g 0 (δt) − g” (δt) σ 2dt − g 0 (δ) σdZt
                 Mt                       2
or                                                                         
                 dMt                    1h                  i
                     = − φ + g 0 (δ) µ − g 0 (δt)2 − g” (δt) σ 2 dt − g 0 (δ) σdZt
                  Mt                    2
obtaining
                                        dMt
                                            = −r (δt) dt − σM (δt) dZt
                                        Mt
with
                                            1h 0                 i
                                              g (δt )2 − g” (δt ) σ 2
                       r (δt) = φ + g 0 (δ) µ −
                                           (2      "                    # )
                                     1           1 1 + E ∗∗ [ρ|δt]
                            = φ+ ∗          µ−                       − 1 σ2
                                  E [ρ|δt]       2     E ∗ [ρ|δt]
                                 σ
                     σM (δ) =  ∗
                              E [ρ|δt]

Q.E.D.



                                                        45
   Proof of Proposition 4. The pricing formula stems from the pricing equation
                               "Z                    #                         "Z                                        #
                                     T   Mτ                                             T −t
                 Pt = Et                    Dτ dτ = eg(δt+τ ) Et                               e−φτ −g(δt+τ )+δt+τ dτ
                                 t       Mt                                         0
                                                     h                     i
                    = p (T − t) eg(δt ) Et eδt+τ −g(δt+τ )

Recall that
                                                   √
                                 δt+τ = δt + µτ + σ τ x for x ∼ N (0, 1)
                 ∂g(δt+τ )
and therefore,     ∂δt
                             = g 0 (δt+τ ) . We thus obtain that the
                                                                                                  h            i
                    log (Pt ) = log (p (T − t)) + g (δt ) + log Et eδt+τ −g(δt+τ )

This implies
                                                               h                                               i
                                                            Et (1 − g 0 (δt+τ )) eδt+τ −g(δt+τ ) 
              d log (Pt ) = o (dt) + g 0 (δt) +                                                                      σdZt
                                                                          Et [eδt+τ −g(δt+τ ) ]                

The results of proposition 4 follow. Q.E.D.


   Proof of Corollary 5. The P/D ratio is
                                     P                         h                i
                                       = p (T − t) eg(δt)−δt Et eδt+τ −g(δt+τ )
                                     D
Therefore
                                                                                                      h             i
                 log (P/D) = log p (T − t) + g (δt ) − δt + log Et eδt+τ −g(δt+τ )

It follows
                                                                       h                                             i
                  ∂ log (P/D)                                       Et (1 − g 0 (δt+τ )) eδt+τ −g(δt+τ )
                              = g 0 (δt) − 1 +
                       ∂δt                                                      Et [eδt+τ −g(δt+τ )]
                                                                h                                           i
                                                            Et g 0 (δt+τ ) eδt+τ −g(δt+τ )
                                         = g 0 (δt) −
                                                                    Et [eδt+τ −g(δt+τ ) ]
                                         = g 0 (δt) − Eetx,τ [g 0 (δt+τ )] > 0

if and only if
                                                g 0 (δt) > Eetx,τ [g 0 (δt+τ )]

Establishing the first result.

   As for the second result, note that
                                                      h                                        i
                                                   Et g 0 (δt+τ ) eδt+τ −g(δt+τ )
                                     g 0 (δt ) −                                                       >0
                                                          Et [eδt+τ −g(δt+τ ) ]

                                                                46
iff                                        h                      i             h                                    i
                           g 0 (δt) Et eδt+τ −g(δt+τ ) − Et g 0 (δt+τ ) eδt+τ −g(δt+τ )
                                                                                                                         >0
                                                         Et [eδt+τ −g(δt+τ ) ]
iff                    h                                                        i
                    Et [g 0 (δt ) − g 0 (δt+τ )] eδt+τ −g(δt+τ )
                                                                                     = Eetx,τ [g 0 (δt) − g 0 (δt+τ )] > 0
                                    Et   [eδt+τ −g(δt+τ ) ]
Recall that g (δt) is decreasing, therefore δt+τ > δt implies [g 0 (δt ) − g 0 (δt+τ )] > 0. The
                0

distribution of δt+τ is
                                                                                                       
                                         f (δt+τ ) = φ δt+τ ; δt + µτ ; σ 2τ |τ fτ (τ )
and the distribution
                                                φ (δt+τ ; δt + µτ ; σ 2τ |τ ) eδt+τ −g(δt+τ )
                             fe (δt+τ ) =                                                     fτ (τ )
                                                             E [eδt+τ −g(δt+τ ) ]
Note that h (δt+τ ) = δt+τ − g (δt+τ ) has h0 (δt+τ ) = 1 − g 0 (δt+τ ) < 0 if ρH < 1 and h0 (δt+τ ) =
1 − g 0 (δt+τ ) > 1 if ρH > 1 and δt+τ is sufficiently high (above some threshold). If ρH > 1 and
δt is sufficiently high, then fe (δt+τ ) gives more weight to high δt+τ than f (δt+τ ). Given that
the latter is symmetric around δt + µτ , it follows that for any µ > 0, the distribution fe (δt+τ )
gives an increasingly higher weight to higher δt+τ compared to the normal density. Thus, as
the weight on δt+τ increases compared to δt and eventually Eetx,τ [g 0 (δt ) − g 0 (δt+τ )] > 0.

      When h0 (δt+τ ) = 1 − g 0 (δt+τ ) < 0, instead, then fe (δt+τ ) gives more weights to lower
δt+τ than f (δt+τ ). However, so long µ/σ is sufficiently high and the distribution τ gives
sufficiently high weights to high τ , the conditional distribution φ (δt+τ ; δt + µτ ; σ 2 τ |τ ) gives
low or even negligible weight to δt+τ < δt . Indeed, the result is immediate if σ → 0 and
µ > 0 in which case φ (δt+τ ; δt + µτ ; σ 2τ |τ ) gives zero weight to δt+τ < δt for every τ > 0.
By continuity, it follows that if µ/σ is sufficiently high, Eetx,τ [g 0 (δt ) − g 0 (δt+τ )] > 0.

      Q.E.D.


      Proof of Proposition 5: The wealth of agent i is
                             "Z                      #                          "Z                                                            #
                                    T   Mτ                                              T
           Wit = Et                        Ciτ dτ = eg(δt ) Et                              e   −φ(τ −t)−g(δτ ) −ρi log(ξi )+ρi g(δτ )
                                                                                                                e                        dτ
                                t       Mt                                          t
                                                     "Z                                                    #
                                                             T −t
                           −ρi log(ξi)+g(δt )                           −φτ +(ρi −1)g(δt+τ )
                = e                             Et                  e                                 dτ
                                                         0
                                                                            h                          i
                = p (T − t) e−ρi log(ξi)+g(δt ) E x,τ e(ρi −1)g(δt+τ )

The C/W is thus
                              Cit                e−ρi log(ξi )+ρi g(δt)
                                  =
                              Wit   p (T − t) e−ρi log(ξi )+g(δt) E x,τ [e(ρi −1)g(δt+τ )]

                                                                           47
                                                                   1
                                     =
                                           p (T −    t) E x,τ   [e(ρi −1)(g(δt+τ )−g(δt)) ]
Q.E.D.


      Proof of Corollary 8. Note that
                                                                  h                    h                  ii
                            Pt = p (T − t) e+g(δt) E CS λ (ρi ) Etx,τ e(ρi −1)g(δt+τ )

Therefore                                                                  h                        i
                                        Wit      si λ (ρi ) Etx,τ e(ρi −1)g(δt+τ )
                              ωitW    =     =     h                 h                ii
                                        Pt    E CS sj λ (ρj ) Etx,τ e(ρj −1)g(δt+τ )

      Part (b) follows immediately from the definition of λ(ρi ) in (9), which in the notation
here is given by                                       h                  h                         ii
                                                E CS sj λ (ρj ) E0x,τ e(ρj −1)g(δt+τ )
                                   λ(ρi ) =
                                                           E0x,τ [e(ρi −1)g(δt+τ ) ]

      Part (c) of Corollary 8 can be shown as follows
                                                                              h                     i
                                           Wit   e−ρi log(ξi) E x,τ e(ρi −1)g(δt+τ )
                                     ωit =     =
                                           Pt          E x,τ [eδt+τ −g(δt+τ ) ]
Therefore
                                                           h                     i                     h                i
              log (ωit ) = −ρi log (ξi ) + log E x,τ e(ρi −1)g(δt+τ )                  − log E x,τ eδt+τ −g(δt+τ )

Thus
                             h                                          i                 h                                       i
  ∂ log ωitW             E x,τ (ρi − 1) g 0 (δt+τ ) e(ρi −1)g(δt+τ )                  E x,τ (1 − g 0 (δt+τ )) eδt+τ −g(δt+τ )
                     =                                                            −
        ∂δt                           E x,τ [e(ρi −1)g(δt+τ ) ]                                 E x,τ [eδt+τ −g(δt+τ ) ]
                                            h                             i                         h                           i
                                     E x,τ g 0 (δt+τ ) e(ρi −1)g(δt+τ )                    E x,τ g 0 (δt+τ ) eδt+τ −g(δt+τ )
                     = (ρi − 1)                                                   −1+                                               >0
                                           E x,τ [e(ρi −1)g(δt+τ )]                                 E x,τ [eδt+τ −g(δt+τ ) ]
iff
                                           h                              i                         h                           i
                                     E x,τ g 0 (δt+τ ) e(ρi −1)g(δt+τ )                    E x,τ g 0 (δt+τ ) eδt+τ −g(δt+τ )
        LHS (ρ) = (ρi − 1)                                                    >1−
                                          E x,τ [e(ρi −1)g(δt+τ ) ]                             E x,τ [eδt+τ −g(δt+τ ) ]

      The RHS does not depend on ρi . The LHS increases in ρ for ρ < ρ∗ with ρ∗ > 1. In fact,
    ∂LHS (ρ)
                =
        ∂ρ
                                     
    E x,τ g0 (δt+τ ) e(ρi −1)g(δt+τ )
  =                            
         E x,τ e(ρi −1)g(δt+τ )
               (                                                                                                               )
                 E x,τ g0 (δt+τ ) g (δt+τ ) e(ρi −1)g(δt+τ )     E x,τ g0 (δt+τ ) e(ρi −1)g(δt+τ ) E x,τ g (δt+τ ) e(ρi −1)g(δt+τ )
    + (ρi − 1)                                               −                                            2
                            E x,τ e(ρi −1)g(δt+τ )                                    E x,τ e(ρi −1)g(δt+τ )
  > 0


                                                                  48
iff
                               h                           i
        ∂LHS (ρ)   E x,τ g 0 (δt+τ ) e(ρi −1)g(δt+τ )
                 =
          ∂ρ            E x,τ [e(ρi −1)g(δt+τ )]
                                      n                                                                          o
                         + (ρi − 1) Eeix,τ [g 0 (δt+τ ) g (δt+τ )] − Eeix,τ [g 0 (δt+τ )] Eeix,τ [g (δt+τ )]
                     > 0

We thus have that
                               h                              i
         ∂LHS (ρ)        E x,τ g 0 (δt+τ ) e(ρi −1)g(δt+τ )                   n      x,τ                         o
                  =                                                          g
                                                                  + (ρi − 1) Cov     0
                                                                                 i [g (δt+τ ) g (δt+τ )]
           ∂ρ           E x,τ [e(ρi −1)g(δt+τ ) ]
                  = (+) + (−) (−)
                     > 0

is always true for ρi < 1, as g 0 (δt+τ ) is decreasing while g (δt+τ ) is increasing. Because
∂LHS(ρ)
  ∂ρ
        > 0 (strictly) for ρi = 1, by continuity this also holds for all ρi < ρ∗ for some
threshold ρ∗ > 1.

      Two additional points are useful


      1. Note now that for ρ = 1 (log utility), the LHS=0. Therefore, the condition for log
        utility investor is 0 > 1 − Eetx,τ [g 0 (δt+τ )]. Below in Lemma A1 I prove this threshold
        is increasing (ie. H(δ) = Eetx,τ [g 0 (δt+τ )] decreasing) and therefore the wealth share of
        log-utility investor is initially increasing in δ but at some point it starts to decrease.
        That is, the log utility investor initially is moving up but eventually he moves down
        the wealth distribution. By continuity, the same argument applies to a whole set of
        agents around log-utility.

      2. Note that as δt increases, both expectations in
                                          h                              i                 h                            i
                                    E x,τ g 0 (δt+τ ) e(ρi −1)g(δt+τ )              E x,τ g 0 (δt+τ ) eδt+τ −g(δt+τ )
          LHS (ρ) = (ρi − 1)                                                 > 1−
                                          E x,τ [e(ρi −1)g(δt+τ )]                         E x,τ [eδt+τ −g(δt+τ ) ]
                     = (ρi − 1) Eeix,τ [g 0 (δt+τ )] > 1 − Ee x,τ [g 0 (δt+τ )]

        converge to 1/ρH , obtaining the condition

                                                        ρi > ρH
                                                                                                             ∂ log(ωit
                                                                                                                     W
                                                                                                                       )
        which is never satisfied. So, eventually, for all i with ρi < ρH , we must have                          ∂δt
                                                                                                                            <
        0. All agents eventually have a wealth share that is declining in output.


                                                        49
   Proof of Part (d). Consider
                                                                        h                        i
                                                              E CS ωitW |ρi > ρ
We have                                Z
                                                     Wit                 h            i
                                                         di = m ρi > ρ E CS ωitW |ρi > ρ
                                           i:ρi >ρ   P
                      
where m ρi > ρ is the mass of agents with risk tolerance higher than ρ. We have
                                                                    h                            h                        i                i
                               h                         i   E CS si λ (ρi ) E x,τ e(ρi −1)g(δt+τ ) |ρi > ρ
                      E CS ωitW |ρi > ρ =                                    h                           h                      ii
                                                                   E CS sj λ (ρj ) E x,τ e(ρj −1)g(δt+τ )

and thus
        W            
   E CS ωit |ρi > ρ
                                              
   E CS si λ (ρi ) E x,τ e(ρi −1)g(δt+τ ) |ρi > ρ
 =                                         
      E CS sj λ (ρj ) E x,τ e(ρj −1)g(δt+τ )
                                                                                              
                                                  E CS si λ (ρi ) E x,τ e(ρi −1)g(δt+τ ) |ρi > ρ
 =                                                                                                               
     E CS sj λ (ρj ) E x,τ e(ρj −1)g(δt+τ ) |ρj > ρ m ρj > ρ + E CS sj λ (ρj ) E x,τ e(ρj −1)g(δt+τ ) |ρj < ρ 1 − m ρj > ρ
                                           1
 =                                                        
                E CS sj λ(ρj )E x,τ e(ρj −1)g (δt+τ ) |ρj <ρ                   
     m ρj > ρ + CS                x,τ
                                        (ρ −1)g (δ ) 
                                           i       t+τ
                                                              1 − m ρj > ρ
                           E       si λ(ρi )E        e                  |ρi >ρ


Consider now the ratio
                                                h                        h                           i                i
                                       E CS sj λ (ρj ) Etx,τ e(ρj −1)g(δt+τ ) |ρj < ρ
                    R (δt) =                     h                                                                   i
                                        E CS si λ (ρi ) Etx,τ [e(ρi −1)g(δt+τ )] |ρi > ρ
                                                                                                                                                
                                                                                 E CS sj λ(ρj )Etx,τ e(                   )
                                                                                                                     ρj −1 g (δt+τ )
                                                                                                                                        |ρj <ρ
                                                h                            i
                                       E CS sj λ (ρj ) |ρj < ρ                                       E CS [sj λ(ρj )|ρj <ρ]
                               =                 h                           i           h                       h                  i              i
                                       E CS si λ (ρi ) |ρi > ρ                    E CS si λ(ρi )Etx,τ e(ρi −1)g(δt+τ ) |ρi >ρ

                                                                                                     E CS [si λ(ρi )|ρi >ρ]

so that we can write
                                           h                           i                  h           h                      i                      i
                                   E CS sj λ (ρj ) |ρj < ρ                        Eb CS Etx,τ e(ρj −1)g(δt+τ ) |ρj < ρ
               R (δt ) =                   h                        i                     h                                                         i
                                   E CS si λ (ρi ) |ρi > ρ                        Eb CS Etx,τ [e(ρi −1)g(δt+τ ) ] |ρi > ρ

where
                                                                                     h                               h                         i            i
               h       h                         i             i             E CS sj λ (ρj ) Etx,τ e(ρj −1)g(δt+τ ) |ρj < ρ
        Eb CS Etx,τ e(ρj −1)g(δt+τ ) |ρj < ρ                        =                                        h                             i
                                                                                                 E CS sj λ (ρj ) |ρj < ρ
                                                                                     h                               h                         i            i
                h      h                         i             i             E CS si λ (ρi ) Etx,τ e(ρi −1)g(δt+τ ) |ρi > ρ
        Eb CS Etx,τ e(ρi −1)g(δt+τ ) |ρi > ρ                        =                                        h                             i
                                                                                                 E CS si λ (ρi ) |ρi > ρ

are just normalization so that we can deal with simple cross-sectional averages over ρi con-
ditional on the latter being above or below a threshold.

                                                                             50
    The first term in R (δt ) does not depend on δt . Both the numerator and denominator of
the second term depend on g (δt ). Because g (δt ) is increasing and hence g (δt+τ ) > 0 for δt
sufficiently high, an increase in g (δt+τ ) induces an increase in the denominator that is higher
than the impact at the numerator, because ρhj are uniformly   i      higher at the denominator.
                                                     W
Thus, R (δt ) is decreasing in δt and hence E ω |ρ > ρ is increasing in δ. The share of
wealth to low risk-tolerance agents increase over time. Formally (and leaving out the first
positive constant for notational simplicity)
      R0 (δt )
                                                           
      EbCS Etx,τ (ρj − 1) g0 (δt+τ ) e(ρj −1)g(δt+τ ) |ρj < ρ
  =                                              
                   bCS Etx,τ e(ρi −1)g(δt+τ ) |ρi > ρ
                   E
                                             CS  x,τ                                              
        bCS Etx,τ e(ρj −1)g(δt+τ ) |ρj < ρ E
        E                                        b     Et   (ρi − 1) g0 (δt+τ ) e(ρi −1)g(δt+τ ) |ρi > ρ
      −                                                               2
                                     EbCS Etx,τ e(ρi −1)g(δt+τ ) |ρi > ρ
                                          
      EbCS E x,τ e(ρj −1)g(δt+τ ) |ρj < ρ
                t
  =                                        ×
      EbCS E x,τ e(ρi −1)g(δt+τ ) |ρi > ρ
                 t
                                                                                                                         !
           bCS Etx,τ (ρj − 1) g0 (δt+τ ) e(ρj −1)g(δt+τ ) |ρj < ρ
           E                                                            EbCS Etx,τ (ρi − 1) g0 (δt+τ ) e(ρi −1)g(δt+τ ) |ρi > ρ
      ×                                                          −                                              
                       bCS E x,τ e(ρj −1)g(δt+τ ) |ρj < ρ
                       E                                                          EbCS E x,τ e(ρi −1)g(δt+τ ) |ρi > ρ
                               t                                                            t
                                          
      EbCS Etx,τ e(ρj −1)g(δt+τ ) |ρj < ρ  b CS                                         b CS  x,τ                               
                                                                                                                                     
  =                                        E b      x,τ           0
                                                       Et [(ρj − 1) g (δt+τ )] |ρj < ρ − E     b                   0
                                                                                                     Et [(ρi − 1) g (δt+τ )] |ρi > ρ
      EbCS E x,τ e(ρi −1)g(δt+τ ) |ρi > ρ
                 t
  <   0

        b CS
where Eb        [ . ] expression use the relevant density weighted by e(ρj −1)g(δt+τ ). The inequality
stems from the fact that g 0 (δ) > 0 and that the first term takes an average with ρj that are
uniformly lower than the ρi in the second term. Thus, the first term must be lower than the
second term, and the inequality follows.

     Q.E.D.


     Lemma A1.
                                                                     h                            i
                                                              E x,τ g 0 (δt+τ ) eδt+τ −g(δt+τ )
                          H (δt ) = Eetx,τ [g 0 (δt+τ )] =
                                                                    E x,τ [eδt+τ −g(δt+τ )]
is decreasing in δ.
     Proof. We have
                                              
 0            E x,τ g” (δt+τ ) eδt+τ −g(δt+τ )
H (δ) =                                 
                   E x,τ eδt+τ −g(δt+τ )
                                                                                                                                         
                E x,τ g0 (δt+τ ) (1 − g0 (δt+τ )) eδt+τ −g(δt+τ )     E x,τ g0 (δt+τ ) eδt+τ −g(δt+τ ) E x,τ (1 − g0 (δt+τ )) eδt+τ −g(δt+τ )
              +                                                   −                                              2
                             E x,τ eδt+τ −g(δt+τ )                                            E x,τ eδt+τ −g(δt+τ )
        =     ex,τ [g” (δt+τ )]
              E
                                                      h                             i
                                                                     2
                E x,τ g0 (δt+τ ) eδt+τ −g(δt+τ ) − E x,τ [g0 (δt+τ )] eδt+τ −g(δt+τ )
              +                                              
                                        E x,τ eδt+τ −g(δt+τ )

                                                             51
                                                                                                                                   
               E x,τ g0 (δt+τ ) eδt+τ −g(δt+τ ) E x,τ eδt+τ −g(δt+τ ) − E x,τ g0 (δt+τ ) eδt+τ −g(δt+τ ) E x,τ g0 (δt+τ ) eδt+τ −g(δt+τ )
             −                                                                                     
                                                       E x,τ eδt+τ −g(δt+τ ) E x,τ eδt+τ −g(δt+τ )
         =   ex,τ [g” (δt+τ )]
             E
                                                          h                             i
                                                                    2
               E x,τ g0 (δt+τ ) eδt+τ −g(δt+τ )     E x,τ [g0 (δt+τ )] eδt+τ −g(δt+τ )
             +                                  −                             
                    E x,τ eδt+τ −g(δt+τ )                  E x,τ eδt+τ −g(δt+τ )
                                                                                                           !2
               E x,τ g0 (δt+τ ) eδt+τ −g(δt+τ ) E x,τ eδt+τ −g(δt+τ )        E x,τ g0 (δt+τ ) eδt+τ −g(δt+τ )
             −                                                      +                                
                    E x,τ eδt+τ −g(δt+τ ) E x,τ eδt+τ −g(δt+τ )                    E x,τ eδt+τ −g(δt+τ )
                                         h                            i                                               
                                  E x,τ [g0 (δt+τ )]2 eδt+τ −g(δt+τ )           x,τ
                                                                                       0          δt+τ −g(δt+τ )
                                                                                                                   !2 
             ex,τ [g” (δt+τ )] −                                              E        g  (δt+τ ) e
         =   E                                                         −                                 
                                           E x,τ eδt+τ −g(δt+τ )                    E x,τ eδt+τ −g(δt+τ )             
                                 n       h             i                         o
         =   ex,τ [g” (δt+τ )] − E
             E                      ex,τ [g0 (δt+τ )]2 − (E x,τ [g0 (δt+τ )])2
                                       x,τ
         =   ex,τ [g” (δt+τ )] − Vg
             E                    ar         [g0 (δt+τ )]
         <   0

Q.E.D.

   Proof of Proposition 6:

   The wealth of agent i is
                                                                               h                 i
                              Wit = p (T − t) si λ (ρi ) eg(δt) E x,τ e(ρi −1)g(δt+τ )

Thus,
                                                                                                         h       i
    log (Wit ) = log (p (T − t)) + log (si ) + log (λ (ρi )) + g (δt) + log E x,τ e(ρi −1)g(δt+τ )

By Ito’s Lemman, the volatilty of log (Wit )
                                                                    h                               i
                                                           E x,τ g 0 (δt+τ ) e(ρi −1)g(δt+τ ) 
                       σW it =       g 0 (δ) + (ρi − 1)                                                   σ
                                                                    E x,τ [e(ρi −1)g(δt+τ ) ]       


The drift rate follows from no arbitrage as the fair compensation for a security that pays Cit
over time                              "                    #
                                     dWit + Cit dt
                                   E               = (rt + σW itσM t) dt
                                         Wit
Q.E.D.

   Proof of Proposition 7: Consider the first derivative of σW it with respect to ρi
                                              
∂σW it       E x,τ g0 (δt+τ ) e(ρi −1)g(δt+τ )
         = σ                            
 ∂ρi              E x,τ e(ρi −1)g(δt+τ )
                        (                                                                                                               )
                          E x,τ g0 (δt+τ ) g (δt+τ ) e(ρi −1)g(δt+τ )     E x,τ g0 (δt+τ ) e(ρi −1)g(δt+τ ) E x,τ g (δt+τ ) e(ρi −1)g(δt+τ )
           +σ (ρi − 1)                                                −                                            2
                                     E x,τ e(ρi −1)g(δt+τ )                                    E x,τ e(ρi −1)g(δt+τ )


                                                                52
We can define the density
                                                        f (δt+τ ) e(ρi −1)g(δt+τ )
                                        fe (δ
                                         i      t+τ ) =
                                                         E x,τ [e(ρi −1)g(δt+τ ) ]
to obtain
∂σW it                                      n                                                                         o
       = σ Eeix,τ [g 0 (δt+τ )] + σ (ρi − 1) Eeix,τ [g 0 (δt+τ ) g (δt+τ )] − Eeix,τ [g 0 (δt+τ )] Ee x,τ [g (δt+τ )]
 ∂ρi
                 n                                         x,τ                       o
          = σ Eeix,τ [g 0 (δt+τ )] + (ρi − 1) Cov
                                              g       0
                                                  i [g (δt+τ ) , g (δt+τ )]

                                                                                           x,τ
                                                                       g
We have g (δt+τ ) is increasing and g 0 (δt+τ ) decreasing. Therefore, Cov     0
                                                                           i [g (δt+τ ) , g (δt+τ )] <
0. Because g 0 (δt+τ ) > 0 we have
                                                  ∂σW it
                                                         > 0 if ρi ≤ 1
                                                   ∂ρi
                               ∂σW it
In addition, for ρi = 1,        ∂ρi
                                        > 0, strictly. It follows by continuity that there is a ρ∗ > 1
            ∂σW it
such that    ∂ρi
                     > 0 for all ρi < ρ∗ .

   Part (b) of the proposition stems from continuity of σW it in ρi and the fact that the
                                                 R
average is always contained between extremes σP = ωit σW itdi. The threshold ρ (δt ) depends
on δt as both the weights ωit and the volatilities depend on it.

    Q.E.D.

                                                                                     x,τ
   We also note that as δt increases, g 0 (δt+τ ) → ρ−1           g        0
                                                      H . Thus Cov i [g (δt+τ ) , g (δt+τ )] → 0,
while Eeix,τ [g 0 (δt+τ )] → ρ−1                                                ∂σW it
                              H > 0. It follows that for δt sufficiently large, ∂ρi    > 0 for all
ρi < ρH .



    Proof of Proposition 8:                  Immediate from Proposition 7 and the formula for beta.
Q.E.D.


    Proof of Proposition 9: Immediate from Proposition 7 and the formulas for portfolio
allocation Q.E.D.


    Proof of Proposition 10: The volatility of a log utility investor is
                                                      ρ=1    0
                                                     σW t = g (δ) σ


Therefore
                                                        ρ=1
                                                       σW t > σP t


                                                             53
iff                                                                h                          i
                                                             Etx,τ g 0 (δt+τ ) eδt+τ −g(δt+τ ) 
                       g 0 (δ) σ >   1 + g 0 (δt) −                                                 σ
                                                                   Etx,τ [eδt+τ −g(δt+τ ) ]   

or                                                        h                               i
                                                   Etx,τ g 0 (δt+τ ) eδt+τ −g(δt+τ )
                                     0>1−
                                                          Etx,τ [eδt+τ −g(δt+τ ) ]
or                                             h                                 i
                                         Etx,τ g 0 (δt+τ ) eδt+τ −g(δt+τ )
                                                                                     >1
                                              Etx,τ [eδt+τ −g(δt+τ ) ]
or
                                                   Eetx,τ [g 0 (δt+τ )] > 1
We have g 0 (δt+τ ) → 1/ρL > 1 for δt+τ → −∞ and g 0 (δt+τ ) → 1/ρH < 1 for δt+τ → +∞.
Because from Lemma A1 the expectation Eetx,τ [.] is monotonically decreasing in δt, the result
follows by continuity. Q.E.D.

      Proof of Corollary 10. The equilibrium condition for g (δt) is that it satisfies
                                                     Z
                                          1 =             fk (ρ) λk (ρ) eρgk (δt )−δt dρ
                                                              h              i
                                                      E0x,τ eδτ −gk (δτ )
                                λk (ρ) =
                                                     E0x,τ [e(ρ−1)gk (δτ ) ]
For δt = δ0 = 0 we have g (δt) = g (δ0) = g (0) = 0 and the condition requires
                                                      Z
                                               1=          fk (ρ) λk (ρ) dρ

Because λk (ρ) are decreasing, it follows that if f2 stochastically dominates f1 then
                                     Z                                  Z
                               1=         f1 (ρ) λ1 (ρ) dρ >                f2 (ρ) λ1 (ρ) dρ
           R
Because        f2 (ρ) λ2 (ρ) dρ = 1, it follows that λ2 (ρ) has to shift upwards for a range of ρ

                                           λ2 (ρ) > λ1 (ρ) for some ρ

Recall now that the functions gk (δ) have specific properties: They are strictly increasing
and concave with g1 (0) = g2 (0) = 0 and gk0 (δ) → ρ−1
                                                    H for high δ and viceversa. It follows
that gk (δ) must intersect each other at ρ = 0. Because E0x,τ (δτ ) > 0, and thus gk (δτ ) > 0
in expectation, we thus must have g2 (δ) < g1 (δ) when δ > 0 for λ2 (ρ) > λ1 (ρ). Hence,
g2 (δ) > g1 (δ) when δ < 0. It follows that

                                                     g20 (δ) < g10 (δ)

and hence
                                                   E2∗ [ρ|δ] > E1∗ [ρ|δ]

                                                               54
That is, if f2 (ρ) stochastically dominates f1 (ρ) then the weighted risk tolerance is higher
under f2 than under f1 .

   The other claims follow from the formulas for the market price of risk and interest rate,
where for the latter, again, we use µ/σ being sufficiently large (e.g. µ > 0 and σ → 0).
Q.E.D.


   Proof of Proposition 11: Recall that in Proposition 1 we have

                                                            f (ρ) λ (ρ) eρg(δt )
                                    f ∗ (ρ|δt ) = R
                                                            f (ρ) λ (ρ) eρg(δt )dρ

where                                                                h                i
                                                           E0x,τ eδτ −g(δτ )
                                        λ (ρ) =
                                                           E0x,τ [e(ρ−1)g(δτ ) ]
To understand the impact of a mean-preserving spread (mps), we need to know how the
following function is related to ρ:
                                                                     h                    i         eρg(δt)
                    h (ρ; δt ) = λ (ρ) e     ρg(δt )
                                                       =   E0x,τ         e   δτ −g(δτ )
                                                                                              E0x,τ [e(ρ−1)g(δτ )]

We have

                                                                                                       h                     i
                            h            ig (δt) e               ρg(δt )              eρg(δt ) E0x,τ g (δτ ) e(ρ−1)g(δτ )
         h0 (ρ; δt) = E0x,τ eδτ −g(δτ )  x,τ (ρ−1)g(δτ ) −                                                               2
                                                                                                                              
                                         E0 [e           ]                                       (E0x,τ [e(ρ−1)g(δτ )])
                                                          h                                   i
                                                  E0x,τ g (δτ ) e(ρ−1)g(δτ )
                   = h (ρ; δt) g (δt ) −                                                       
                                                       E0x,τ [e(ρ−1)g(δτ ) ]

                                                                                                              
                                                     √                  √
   If µ/σ is sufficiently high, then Ee0x,τ g (µτ + σ τ x) e(ρ−1)g(µτ +σ τ x) > 0 (note that this
is certainly true if µ > 0 and σ → 0, given that g (δ) > 0 for δ > 0). Given that g (δt) = 0
for δt = 0 and g (δt) → ∞ if δt → ∞, it follows that h0 (ρ; δt) < 0 for δt sufficiently low, and
h0 (ρ; δt) > 0 for δt sufficiently high. Let δ (ρ) be such that
                                                                 h                                  i
                                                     E0x,τ g (δτ ) e(ρ−1)g(δτ )
                                g δ (ρ) =
                                                               E0x,τ [e(ρ−1)g(δτ ) ]

Then, h0 (ρ; δt ) < 0 for δt < δ (ρ) and h0 (ρ; δt) > 0 for δt > δ (ρ). Thus, h0 (ρ; δt) < 0 for all
                                                                                        
ρ if δt < δmin = minρ δ (ρ) and h0 (ρ; δt ) > 0 for all ρ if δt > δmax = maxρ δ (ρ) . This
                                                                                    ∗
argument holds both for the original distribution and the mps distribution. Define δmin and



                                                               55
 ∗
δmax the minimum and the maximus across the two distributions. Denote with mps the
distributions / variables under the mean-preserving spread. We thus have

                               f (ρ) h (ρ; δt )                     fmps (ρ) hmps (ρ; δt)
             f ∗ (ρ|δt) = R                          ∗
                                                  ; fmps (ρ|δt) = R
                               f (ρ) h (ρ; δt) dρ                   fmps (ρ) hmps (ρ; δt) dρ

where gmps (δt) solves                         Z                          
                                  δt = log          fmps (ρ) hmps (ρ; δt) dρ
                                                             ∗
It follows that if µ/σ is sufficiently high, then when δt < δmin and both h (ρ; δt) and hmps (ρ; δt)
                         ∗
are decreasing, we have fmps (ρ|δt) gives relatively more weight to low ρ than f ∗ (ρ|δt) does.
This implies
                                   ∗
                                  Emps [ρ|δt] < E ∗ [ρ|δt] for δt < δmin
                                                                     ∗


                    ∗                                                                   ∗
Viceversa, if δt > δmax , then both h (ρ; δt) and hmps (ρ; δt) are increasing and thus fmps (ρ|δt)
gives more weight to high ρ than f ∗ (ρ|δt ) and we obtain

                                   ∗
                                  Emps [ρ|δt ] > E ∗ [ρ|δt] for δt > δmax
                                                                      ∗



Q.E.D.


   Proof of Proposition 12: Let sk,i = sk (ρi ) sei where Cov(sei , ρi ) = 0 and E[si ] = 1, and
sk (ρi ) be a monotonic function of ρ such that E [sk (ρ)] = 1. We can define a new density

                                             fk (ρ) = f (ρ) sk (ρ)
                         R                 R
This is a density as         fk (ρ) dρ =       f (ρ) sk (ρ) dρ = E [sk (ρ)] = 1. A model with redis-
tribution is the same as a model with s (ρ) = 1 (as discussed earlier) but simply with a
distribution of ρ’s that is shifted. Consider now the case in which s02 (ρ) > s01 (ρ). Then
f2 (ρ) stochastically dominate f1 (ρ). The result then follows from corollary 10. Q.E.D.


   Proof of Lemma. The lemma follows from the filtering result for discrete Markov
processes (see e.g. Chapter 9 in Lyptser and Shyriaev (2001)). Because this filtering result
holds for a countable number of states, the limiting distribution πt(µ) and its dynamics can
be obtained in the limit as the states are defined as discrete points on the real line and we
let the number of states diverge to infinity. Q.E.D.


   Proof of Proposition 15: Recall
                                                         σW it Wit
                                                Nit =
                                                          σP Pt

                                                        56
so that
                                                                     Nit   σW it Wit
                                                                         =
                                                                     Njt   σW jt Wjt
The wealth of each agent is
                                                                               Z           h                               i
                                                                      g(δt )
                      Wit = p (T − t) si λ (ρi ) e                                 E x,τ e(ρi −1)g(δt+τ ) |µ πt (µ) dµ

Then
                                                                                      Z                   h                       i
   dWit = o (dt) + p (T − t) si λ (ρi ) eg(δt ) g 0 (δt)                                       E x,τ e(ρi −1)g(δt+τ ) |µ πt (µ) dµ
                                    Z               h                                              i                   
                  + (ρi − 1)            E x,τ g 0 (δt+τ ) e(ρi −1)g(δt+τ ) |µ πt (µ) dµ σ
                      Z         h                                i
                  +       E x,τ e(ρi −1)g(δt+τ ) |µ πt (µ) (µ − Et [µ]) dµσ −1
σ (dWi ) = σW it Wit
                                                             Z             n                           h                       i
                                                    g(δt )
              = p (T − t) si λ (ρi ) e                           πt (µ) g 0 (δt ) E x,τ e(ρi −1)g(δt+τ ) |µ σ
                                            h                                           i                          h                       i                   o
                  + (ρi − 1) E x,τ g 0 (δt+τ ) e(ρi −1)g(δt+τ ) |µ σ + E x,τ e(ρi −1)g(δt+τ ) |µ (µ − Et [µ]) σ −1 dµ

Consider
          h                                                  i         h                               i                       h                               i
h (µ) = g 0 (δt) σ + (µ − Et [µ]) σ −1 E x,τ e(ρi −1)g(δt+τ ) |µ +(ρi − 1) E x,τ g 0 (δt+τ ) e(ρi −1)g(δt+τ ) |µ σ

If h (µ) is convex, then Wit σW it increases because of MPS in π (µ). Take first derivative
                                        h                             i
         h0 (µ) = σ −1 E x,τ e(ρi −1)g(δt+τ )|µ
                            h                                                      i                           h                                       i
                          + g 0 (δt ) σ + (µ − Et [µ]) σ −1 (ρi − 1) E x,τ g 0 (δt+τ ) τ e(ρi −1)g(δt+τ ) |µ
                                                        h                                                                                      i
                          + (ρi − 1) E x,τ [g” (δt+τ ) + (ρi − 1) g 0 (δt+τ )] τ e(ρi −1)g(δt+τ ) |µ σ

Then, the second derivative is
                                            h                                                  i
h” (µ) = σ −1 (ρi − 1) E x,τ g 0 (δt+τ ) τ e(ρi −1)g(δt+τ )|µ
                                                h                                                  i
                +σ −1 (ρi − 1) E x,τ g 0 (δt+τ ) τ e(ρi −1)g(δt+τ )|µ
                  h                                                    i                               h                                                           i
                + g 0 (δt) σ + (µ − Et [µ]) σ −1 (ρi − 1) E x,τ [g” (δt+τ ) + (ρi − 1) g 0 (δt+τ )] τ 2e(ρi −1)g(δt+τ ) |µ
                                        h                                                                                              i
                + (ρi − 1) E x,τ [g 000 (δt+τ ) + (ρi − 1) g” (δt+τ )] τ 2 e(ρi −1)g(δt+τ ) |µ σ
                                        h                                                                                                                  i
                + (ρi − 1) E x,τ [g” (δt+τ ) + (ρi − 1) g 0 (δt+τ )] ((ρi − 1) g 0 (δt+τ )) τ 2 e(ρi −1)g(δt+τ ) |µ σ


    or
                                                h                                                  i
h” (µ) = 2σ −1 (ρi − 1) E x,τ g 0 (δt+τ ) τ e(ρi −1)g(δt+τ ) |µ
                  h                                                    i                               h                                                           i
                + g 0 (δt) σ + (µ − Et [µ]) σ −1 (ρi − 1) E x,τ [g” (δt+τ ) + (ρi − 1) g 0 (δt+τ )] τ 2e(ρi −1)g(δt+τ ) |µ
                                        h                                                                                              i
                + (ρi − 1) E x,τ [g 000 (δt+τ ) + (ρi − 1) g” (δt+τ )] τ 2 e(ρi −1)g(δt+τ ) |µ σ
                                            h                                                                                                      i
                + (ρi − 1)2 E x,τ [g” (δt+τ ) + (ρi − 1) g 0 (δt+τ )] g 0 (δt+τ ) τ 2 e(ρi −1)g(δt+τ ) |µ σ

                                                                               57
We consider the local curvature of h (µ) around the mean µbt . In this case µ − E [µ] is small
(for given σ). When σ is small, moreover, only the first term is large, as all the others
converge to zero as σ converges to zero. Therefore, for σ small, the local curvature of h (µ)
is
                                                     h                            i
                    h” (µ) ≈ 2σ −1 (ρi − 1) E x,τ g 0 (δt+τ ) τ e(ρi −1)g(δt+τ ) |µ

which is positive for ρi > 1 and negative for ρi < 1. Therefore, for σ small and µ around µbt ,
we should expect that a mean preserving spread increases σ (dW ) for ρi > 1 and decrease it
for ρi < 1. The result follows. Q.E.D.




                                                  58
