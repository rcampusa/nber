                              NBER WORKING PAPER SERIES




                      DYNAMIC SPATIAL GENERAL EQUILIBRIUM

                                        Benny Kleinman
                                           Ernest Liu
                                       Stephen J. Redding

                                      Working Paper 29101
                              http://www.nber.org/papers/w29101


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     July 2021




We are grateful to Princeton University for research support. A previous version of this paper
circulated under the title "Sufficient Statistics for Dynamic Spatial Economics." We would like to
thank conference and seminar participants at Dartmouth, Hong Kong, NBER, Nottingham and
Princeton for helpful comments. We are also grateful to Andrew Cassey, Fariha Kamal, Martha
Loewe, Youngjin Song and Abigail Wozniak for their help with data. We would like to thank
Maximilian Schwarz for excellent research assistance. The usual disclaimer applies. The views
expressed herein are those of the authors and do not necessarily reflect the views of the National
Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2021 by Benny Kleinman, Ernest Liu, and Stephen J. Redding. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including © notice, is given to the source.
Dynamic Spatial General Equilibrium
Benny Kleinman, Ernest Liu, and Stephen J. Redding
NBER Working Paper No. 29101
July 2021
JEL No. F14,F15,R12

                                          ABSTRACT

We develop a dynamic spatial general equilibrium model with forward-looking investment and
migration decisions. We characterize analytically the transition path of the spatial distribution of
economic activity in response to shocks. We apply our framework to the reallocation of US
economic activity from the Rust Belt to the Sun Belt from 1965-2015. We find slow convergence
to steady-state, with US states closer to steady-state at the end of our sample period than at its
beginning. We find substantial heterogeneity in the effects of local shocks, which depend on
capital and labor dynamics, and the spatial and sectoral incidence of these shocks.


Benny Kleinman                                   Stephen J. Redding
Department of Economics                          Department of Economics &
Julis Romo Rabinowitz Building                   School of Public and International Affairs
Princeton, NJ 08544                              Princeton University
binyamin@princeton.edu                           Princeton, NJ 08544
                                                 and CEPR
Ernest Liu                                       and also NBER
Princeton University                             reddings@princeton.edu
Department of Economics
Julis Romo Rabinowitz Building
Princeton, NJ 08544
ernestliu@princeton.edu
1    Introduction
A key research question in economics is understanding the gradual response of the spatial dis-
tribution of economic activity to shocks. To address this question, we develop a dynamic spatial
model with forward-looking investment and migration decisions. Despite accommodating a large
state space and a rich geography, the model remains tractable, and we provide conditions for the
existence and uniqueness of its general equilibrium. We linearize the model to derive closed-form
solutions for the transition path of the entire spatial distribution of economic activity in response
to shocks. Using these closed-form solutions, we characterize analytically the determinants of
the economy's dynamic response to productivity, amenity, trade cost and migration cost shocks.
We show that the speed of convergence to steady-state depends on the eigenvalues of a transition
matrix that governs the evolution of the state variables. We undertake a spectral analysis of this
transition matrix to distinguish shocks and exposure to these shocks. We apply our framework
to the reallocation of US economic activity from the "Rust Belt" to the "Sun Belt" from 1965-2015.
We nd that US states are closer to steady-state by the end of our sample than at its beginning,
contributing to a decline in geographical mobility over time. We nd slow average speeds of
convergence to steady-state, with an average half-life of around 20 years. We nd substantial
heterogeneity in the e ects of local shocks, which depend on both capital and labor dynamics,
and the spatial and sectoral incidence of shocks.
    One of the key challenges in developing dynamic spatial models to address these questions is
incorporating forward-looking dynamic investment decisions, because the investment decision
in each location depends on economic activity in all locations in all future time periods. With
high-dimensional state spaces, this can introduce a curse of dimensionality, which can make
computing the equilibrium allocations challenging, or can make it di cult to distinguish be-
tween alternative possible future trajectories for the economy. We develop a framework that
incorporates this forward-looking behavior for both investment decisions for the immobile fac-
tor (capital structures) and migration decisions for the mobile factor (labor). Even with these two
sources of dynamics, we provide an analytical characterization of the existence and uniqueness of
the steady-state equilibrium, and of the comparative statics of the spatial distribution of economic
activity in each future time period in response to shocks.
    To illustrate our approach, we begin with a baseline single-sector Armington model of trade,
with dynamic discrete choice migration decisions, and investment determined as the solution
to an intertemporal consumption-investment problem. The economy consists of many locations
that di er in productivity, amenities, bilateral trade costs and bilateral migration costs. There
are two types of agents: workers and landlords. Workers are geographically mobile but do not
have access to an investment technology (and hence live "hand to mouth"). They make forward-


                                                 1
looking migration decisions, taking into account migration costs and the expected continuation
value from optimal future location decisions, as in Caliendo et al. (2019). Landlords are geograph-
ically immobile but have access to an investment technology for accumulating local capital. They
make forward-looking consumption-investment decisions to maximize intertemporal utility, as
in Angeletos (2007) and Moll (2014).
   We linearize the model to derive a closed-form solution for the economy's transition path in
terms of an impact matrix (R), which captures the impact of shocks in the initial period in which
they occur, and a transition matrix (P ), which governs the evolution of the state variables from
one period to the next in response to these shocks. The impact and transition matrices in turn
depend on four observable trade and migration share matrices: (i) an expenditure share matrix
(S ) that re ects the expenditure share of each importer on each exporter; (ii) an income share
matrix (T ) that captures the share of each exporter's value-added derived from each importer; (iii)
an outmigration share matrix (D ) that re ects the share of people in a given origin that migrate
to each destination; (iv) an inmigration share matrix (E ) that corresponds to the share of people
in a given destination that migrate from each origin. Given these observable matrices, initial
values for the economy's state variables (population and the capital stock in each location) and
the model's structural parameters, we can solve in closed-form for the entire spatial distribution
of economic activity in each location in all future time periods.
    This linearization has two key advantages. First, we show that our linear closed-form solu-
tions can be used to undertake a spectral analysis of the economy's adjustment to shocks. We use
an eigendecomposition of the transition matrix to distinguish shocks and exposure to shocks. We
show that any empirical shocks can be expressed as a linear combination of eigen-shocks, de ned
as shocks for which the initial impact on the state variables corresponds to an eigenvector of the
transition matrix. We show that the speed of convergence to steady-state, as measured by the
half-life, is determined by the corresponding eigenvalues of this transition matrix. This speed
of convergence is in uenced by both capital and labor adjustment, and the dynamics in these
two state variables interact with one another, because of the complementarity of capital and la-
bor in production. For example, if both capital and labor are above steady-state in a location,
this slows convergence, because the high capital stock raises the marginal product of labor, and
hence retards its downward adjustment. Similarly, the high population raises the marginal prod-
uct of capital and dampens its downward adjustment. In contrast, if capital is above steady-state
whereas labor is below steady-state, this tends to speed convergence, because the high capital
stock attracts labor, and the low population discourages capital accumulation. A lower intertem-
poral elasticity of substitution, greater dispersion in idiosyncratic mobility shocks and a lower
labor share also all slow convergence towards steady-state.
   Second, as our linearization uses methods from the dynamic stochastic general equilibrium


                                                 2
(DSGE) literature in macroeconomics, we are able to relax the assumption of perfect foresight
commonly maintained in spatial models to allow for stochastic fundamentals and rational expec-
tations. We report three main sets of results for the economy's transition path. First, we consider
an economy that is somewhere along the transition path towards an unobserved steady-state at
a given point in time, and show how to solve for the transition path to that steady-state in the
absence of any further shocks to fundamentals. Second, starting with the same initial conditions,
we show how to solve for the economy's transition path in response to any convergent sequence
of expectations of future shocks. Third, we show how to solve for the economy's dynamic path
when the fundamental shocks follow a rst-order Markov process. Although we allow for high-
dimensional state spaces with many locations or location-sectors, our use of conventional linear
algebra techniques ensures that our approach is computationally e cient and quick and easy to
implement. Finally, a caveat is that our closed-form solutions for the transition path are based
on a linearization, and are thus only exact in theory for small shocks. However, we show that in
practice they closely approximate the full non-linear model solution even for large shocks, such
as the empirical distribution of decadal shocks observed during our sample period.
    Although for simplicity we begin with our baseline single-sector Armington model, we show
that our approach admits a large number of extensions and generalizations. We incorporate ag-
glomeration forces in both production (productivity spillovers) and residential decisions (amenity
spillovers). In the presence of these agglomeration forces, we show that the conditions for the
existence of a unique steady-state require that these agglomeration forces are su ciently weak
relative to the model's dispersion forces, which include idiosyncratic worker preferences. More
generally, we show that our results hold for an entire class of constant elasticity trade models,
including models of perfect competition and constant returns to scale, and models of monopo-
listic competition and increasing returns to scale. We assume for simplicity that capital is only
used in production, but we show that our results naturally extend to the case in which capital is
also used residentially (housing). Finally, we demonstrate that our approach also extends to in-
corporate multiple sectors (as in Costinot et al. 2012) and both multiple sectors and input-output
linkages (as in Caliendo and Parro 2015 and Caliendo et al. 2019).
   In our main empirical application, we use data on U.S. states from 1965-2015 to examine the
decline of the "Rust Belt" and the rise of the "Sun Belt." We show that this setting features con-
vergence dynamics in both capital and net and gross migration, highlighting the relevance of a
framework such as ours that features both of these adjustment margins. Our ndings of slow
average speeds of convergence to steady-state of around 20 years are consistent with reduced-
form empirical evidence of persistent impacts of local shocks. Our results also emphasize the
heterogeneity in the impact of these local shocks, depending on their size and incidence across
locations, and the extent to which they a ect both capital and labor state variables. We nd that


                                                3
average speeds of convergence are relatively constant over time, despite the modest observed
decline in inter-state migration. These results highlight that this decline in inter-state migration
need not imply a rise in geographical barriers to mobility, since it also in uenced by the distance
of the state variables from steady-state and the size and incidence of shocks.
       In a nal empirical exercise, we implement our multi-sector extension using region-sector
data on U.S. states and foreign countries from 1999-2015. In this multi-sector extension, we con-
tinue to nd relatively slow convergence towards steady-state, but the average half-life is notably
lower than our baseline single-sector speci cation. This pattern of results re ects the property
of the data that movements of people between sectors within U.S. states occur much more fre-
quently than movements of people between U.S. states. An implication is that the speed with
which the economy adjusts to shocks depends crucially on the extent to which they a ect one
industry relative to another industry within the same location, versus the extent to which that
a ect all industries in one location relative to all industries in another location.
       Our research is related to several strands of existing work. First, our paper contributes to a
long line of research on economic geography, including Krugman (1991b), Krugman and Venables
(1995) and Helpman (1998), as synthesized in Fujita et al. (1999), and reviewed in Duranton and
Puga (2004) and Redding (2020). Early theoretical research on economic geography considered
static models or assumed myopic migration decisions, as in Krugman (1992).1 In contrast, the
more recent research on quantitative spatial models has often considered static speci cations,
including Redding and Sturm (2008), Allen and Arkolakis (2014), Ahlfeldt et al. (2015), Allen et al.
(2017), Ramondo et al. (2016), Redding (2016), Caliendo et al. (2018) and Monte et al. (2018), as
surveyed in Redding and Rossi-Hansberg (2017).
    A key reason that quantitative spatial models have frequently focused on these static speci -
cations is the challenge of modelling forward-looking investments in settings with high-dimensional
state spaces. One approach to this challenge has been to consider speci cations in which dynamic
decisions reduce to static problems. In the innovation models of Desmet and Rossi-Hansberg
(2014), Desmet et al. (2018) and Peters (2019), the incentive to invest in innovation each period
depends on the comparison of static pro ts and innovation costs. In the overlapping generations
model of Allen and Donaldson (2020), adults make migration decisions to maximize their own
adult utility, and do not consider the utility of the next generation of youths. Another approach is
to capture forward-looking migration decisions using dynamic discrete choice models, including
Artuç et al. (2010); Artuc et al. (2021), Caliendo et al. (2019) and Caliendo and Parro (2020).2 We in-
   1
     Exceptions include a small number of theoretical trade and geography papers that have considered forward-
looking decisions under perfect foresight in stylized settings with a small number of locations, including Krugman
(1991a), Matsuyama (1991) and Baldwin (2001).
   2
     See Glaeser and Gyourko (2005) and Greaney (2020) for models in which population dynamics are shaped by
durable housing. See Walsh (2019) for a model in which innovation takes the form of the creation of new varieties.



                                                        4
corporate both forward-looking investment and migration decisions and use our linearization to
derive closed-form solutions for the transition path of the entire spatial distribution of economic
activity in response to shocks.
    Second, our work is related to the literature on su cient statistics in static international trade
and economic geography models, including Arkolakis et al. (2012), Caliendo et al. (2017), Baqaee
and Farhi (2019), Galle et al. (2018), Huo et al. (2019), Bartelme et al. (2019), Adão et al. (2019),
Bonadio et al. (2020), and Kim and Vogel (2020).3 Using a class of static constant elasticity trade
models, Kleinman et al. (2020) show that the rst-order comparative statics can be stacked as a
matrix inversion problem, which yields closed-form solutions for the elasticity of the endogenous
variables in each country with respect to shocks in any other country. Although these existing
studies have developed su cient statistics for static spatial models, our key contribution is to de-
velop them for dynamic spatial models, incorporating both forward-looking investment decisions
for the immobile factor and dynamic migration decisions for the mobile factor.
       Third, our research is related to an empirical literature on local labor markets, including Autor
et al. (2013), Kovak (2013), Kline and Moretti (2014), Dix-Carneiro and Kovak (2015), and Diamond
(2016), Hornbeck and Moretti (2018) and Eriksson et al. (2019), as reviewed in Moretti (2011) and
Autor et al. (2016). One strand of this literature has examined the reallocation of U.S. economic
activity from the Rust Belt to the Sun Belt, such as Blanchard and Katz (1992), Feyrer et al. (2007),
Rappaport (2007), Glaeser and Ponzetto (2010), Hartley (2013), Yoon (2017) and Alder et al. (2019).
Another strand of this literature has emphasized the persistent impact of negative local labor
market shocks, including in particular Dix-Carneiro and Kovak (2017), Amior and Manning (2018)
and Autor et al. (2020). We contribute to this research by using our spectral analysis to analyze
the determinants and heterogeneity of the economy's dynamic response to shocks.
    The remainder of the paper is structured as follows. In Section 2, we introduce our base-
line quantitative spatial model with dynamics from forward-looking investment and migration
decisions. In Section 3, we linearize the model and derive our closed-form solutions for the econ-
omy's transition path. In Section 4, we show that our analysis admits a number of extensions and
generalizations, including shocks to trade and migration costs, agglomeration forces, multiple
sectors, and input-output linkages. In Section 5, we implement our baseline speci cation for U.S.
states from 1965-2015 and our multi-sector extension for U.S. states and foreign countries from
1999-2015. In Section 6, we report a speci cation check, in which we examine the potential for
non-linearities in the model. In Section 7, we summarize our conclusions.
   3
       For su cient statistics in heterogeneous agent models in macro, see Auclert et al. (2020) and Bilal (2021).




                                                            5
2     Dynamic Spatial Model
In this section, we introduce our baseline dynamic spatial general equilibrium model. We com-
bine a speci cation of trade between locations with a constant trade elasticity, a formulation of
migration decisions with a constant migration elasticity, optimal consumption-investment deci-
sions with constant intertemporal elasticity of substitution preferences, and stochastic shocks to
fundamentals under rational expectations.
    We consider an economy with many locations indexed by i  {1, . . . , N }. Time is discrete and
is indexed by t. There are two types of in nitely-lived agents: workers and landlords. Workers are
endowed with one unit of labor that is supplied inelastically and are geographically mobile subject
to migration costs. Workers do not have access to an investment technology, and hence live "hand
to mouth," as in Kaplan and Violante (2014). Landlords are geographically immobile and own
the capital stock in their location. They make forward-looking decisions over consumption and
investment in this local stock of capital. We interpret capital as buildings and structures, which
are geographically immobile once installed, and depreciate gradually at a constant rate  .
    The endogenous state variables are the population ( it ) and capital stock (kit ) in each loca-
tion. The key location characteristics that determine the spatial distribution of economic activ-
ity are the sequences of productivity (zit ), amenities (bit ), trade costs (nit ) and migration costs
(nit ). Without loss of generality, we normalize the total population across all locations to one
(   N
    i=1 it   = 1), so that   it   can also be interpreted as the population share of location i at time t.
Throughout the following, we use bold math font to denote a vector (lowercase letters) or matrix
(uppercase letters). The derivations for all expressions and results in this section are reported in
Section B of the online appendix.
    To streamline the exposition, we focus in this section on shocks to productivities (zit ) and
amenities (bit ), and assume that productivity and amenities are exogenous. In Section 4 below,
we show that our approach extends to shocks to trade and migration costs, endogenous produc-
tivity and amenities through agglomeration forces, and a large number of other generalizations,
including multiple sectors and input-output linkages.

2.1    Production
At the beginning of each period t, the economy inherits in each location i a mass of workers ( it )
and capital stock (kit ). Firms in each location use labor and capital to produce output (yit ) of the
variety supplied by that location. Production is assumed to occur under conditions of perfect
competition and subject to the following constant returns to scale technology:
                                              µ          1-µ
                                                   kit
                                                                                                       (1)
                                         it
                         yit = zit                             ,       0 < µ < 1,
                                         µ        1-µ

                                                         6
where zit denotes productivity in location i at time t.
   We assume that trade between locations is subject to iceberg variable trade costs, such that
nit  1 units of a good must be shipped from location i in order for one unit to arrive in location
n, where nit > 1 for n = i and iit = 1. From pro t maximization, the cost to a consumer
in location n of sourcing the good produced by location i depends solely on these iceberg trade
costs and constant marginal costs:
                                                                   µ 1-µ
                                                              nit wit rit
                                   pnit = nit piit =                      ,                           (2)
                                                                  zit
where piit is the "free on board" price of the good supplied by location i before trade costs.
   We choose the total labor income of all locations as our numeraire:        N
                                                                              i=1   wit   it   = 1.

2.2    Worker Consumption
Worker preferences within each period t are modeled as in the standard Armington model of trade
with constant elasticity of substitution (CES) preferences. As workers do not have access to an
investment technology, they spend their wage income and choose their consumption of varieties
to maximize their utility each period. The indirect utility function of a worker in location n in
period t depends on the worker's wage (wnt ), the cost of living (pnt ) and amenities (bnt ):

                                  ln uw
                                      nt = ln bnt + ln wnt - ln pnt ,                                 (3)

where we use the superscript w to denote workers. The cost of living (pnt ) depends on the price
of the variety sourced from each location i (pnit ):
                                                     N              -1/

                                        pnt =                p- 
                                                              nit         ,                           (4)
                                                     i=1

where  > 1 is the constant elasticity of substitution and  =  - 1 > 0 is the trade elasticity.

2.3    Capital Accumulation
Landlords in each location choose their consumption and investment to maximize their intertem-
poral utility subject to their budget constraint. Landlords' intertemporal utility equals the ex-
pected present discounted value of their ow utility:
                                                                      1-1/
                                                               ck
                                   k
                                  vit   = Et            t+s     it+s
                                                                       ,                              (5)
                                               s=0
                                                                1 - 1/

where we use the superscript k to denote landlords; ck
                                                     it is the consumption index dual to the price
index (4);  is the discount rate;  is the elasticity of intertemporal substitution. Since landlords

                                                         7
are geographically immobile, we omit the term in amenities from their ow utility, because this
does not a ect the equilibrium in any way, and hence is without loss of generality.
    We assume that the investment technology in each location uses the varieties from all loca-
tions with the same functional form as consumption. We assume that landlords can only invest in
their own location and that one unit of capital can be produced using one unit of the consumption
index in that location.4 We interpret capital as buildings and structures, which are geographically
immobile once installed. Capital is assumed to depreciate at the constant rate  and we allow for
the possibility of negative investment. The intertemporal budget constraint for landlords in each
location requires that total income from the existing stock of capital (rit kit ) equals the total value
                           it ) plus the total value of net investment (pit (kit+1 - (1 -  ) kit )):
of their consumption (pit ck

                                    rit kit = pit ck
                                                   it + kit+1 - (1 -  ) kit .                                      (6)

We begin by establishing a key property of landlords' optimal consumption-investment decisions.
We use Rit  1 -  + rit /pit to denote the gross return on capital.

Lemma 1. The optimal consumption of location i's landlords satis es cit = it Rit kit , where it is
de ned recursively as
                                                                  -1          
                                     -1                                -1
                                     it = 1 +   Et Rit+1
                                                           
                                                         t+1                     .

Landlords' optimal saving and investment decisions satisfy kit+1 = (1 - it ) Rit kit .

   Lemma 1 shows that the landlords in each location have a linear saving rate (1 - it ) out of
current period wealth Rit kit , as in Angeletos (2007). The saving rate depends on the expected
sequence of future returns on capital {Et Rit+s }, the discount rate  , and the elasticity of substi-
tution  . In the special case of log-utility ( = 1), landlords have a constant saving rate  (i.e.,
kit+1 = Rit kit ) as in the conventional Solow-Swan model and Moll (2014).
    We show below that there exists a steady-state equilibrium level of the capital-labor ratio in
each location, towards which the economy gradually converges in the absence of further shocks.
Along the transition path, the rental rate on capital can di er across locations, because of our
assumption that capital corresponds to buildings and structures that are geographically immobile.
However, the extent of these di erences is limited by the use of tradeable consumption goods for
investment, and quantitatively we nd them to be relatively small. In steady-state, the real rental
rate in terms of the consumption good is equalized across locations.5
   4
      This speci cation can be extended to allow landlords to invest in other locations at the cost of additional com-
plication. Although we make the standard assumption that consumption and investment use goods in the same
proportions, similar results hold if investment uses only the good produced by each location.
    5
      Introducing another type of capital (e.g. machines) that is perfectly mobile is straightforward. In steady-state:
ri /p i = (1 -  (1 -  )) /. Steady-state di erences in ri /pi can be accommodated by di erences in the produc-
                                                               

tivity of investment, where one unit capital is produced with i units of the consumption good in location i.

                                                          8
2.4   Worker Migration Decisions
After supplying labor and spending wage income on consumption in each period t, workers
observe idiosyncratic mobility shocks (           gt ),   and decide where to move. The value function for a
                                   it ) is equal to the current ow of utility in that location plus
worker in location i in period t (Vw
the expected continuation value from the optimal choice of location:

                        Vw        w             w
                         it = ln uit + max  Et Vgt+1 - git +                               gt    ,                    (7)
                                                {g }N
                                                    1


where  is the discount rate; Et [·] denotes the expectation in period t over future location charac-
teristics. Because workers are hand-to-mouth, it is without loss of generality to assume logarith-
mic utility (ln uw
                 it ) over consumption. We make the conventional assumption that idiosyncratic
mobility shocks are drawn from an extreme value distribution: F ( ) = e-e                                     , where  is
                                                                                                     (- - )



the Euler-Mascheroni constant; the parameter  controls the dispersion of idiosyncratic mobility
shocks; and we assume iit = 1 and nit > 1 for n = i.

2.5   Market Clearing
Goods market clearing implies that income in each location, which equals the sum of the income
of workers and landlords, is equal to expenditure on the goods produced by that location:
                                                           N
                          (wit       it   + rit kit ) =         Snit (wnt   nt   + rnt knt ) ,                        (8)
                                                          n=1

where we begin by assuming that trade is balanced, before later extending our analysis to incor-
porate trade imbalances in Section 4.
   Capital market clearing implies that the rental rate for capital is determined by the require-
ment that landlords' income from the ownership of capital equals payments for its use. Using
pro t maximization and zero pro ts, this capital market clearing condition is given by:
                                                            1-µ
                                                rit kit =       wit it .                                              (9)
                                                             µ

2.6   General Equilibrium
Given the state variables {   i0 ,   ki0 }, the general equilibrium of the economy is the stochastic pro-
cess of allocations and prices such that rms in each location choose inputs to maximize pro ts,
workers make consumption and migration decisions to maximize utility, landlords make con-
sumption and investment decisions to maximize utility, and prices clear all markets, with the
appropriate measurability constraint with respect to the realizations of location fundamentals.


                                                               9
For expositional clarity, we collect the equilibrium conditions and express them in terms of a se-
quence of ve endogenous variables { it , kit , wit , Rit , vit }t=0 . All other endogenous variables of
the model can be recovered as a function of these variables.

Capital Returns and Accumulation:                     Using capital market clearing (9), the gross return on
capital in each location i must satisfy:

                                                                1 - µ wit it
                                     Rit =       1-+                                 ,
                                                                  µ pit kit

where the price index (4) of each location becomes
                                                                                                     -1/
                              N                           1-µ                                  -
                                            1-µ
                    pnt =            wit                        ( it /kit )1-µ ni /zi                      .            (10)
                             i=1
                                             µ

The law of motion for capital is

                                                                    1 - µ wit it
                            kit+1 = (1 - it ) 1 -  +                                         kit ,                      (11)
                                                                      µ pit kit

where (1 - it ) is the saving rate de ned recursively as in Lemma 1:
                                                                     -1              
                                   -1                                         -1
                                   it = 1 +   Et Rit+1
                                                         
                                                       t+1                               .


Goods Market Clearing:            Using the CES expenditure share, the equilibrium pricing rule (2),
and the capital market clearing condition (9) in the goods market clearing condition (8), the re-
quirement that income equals expenditure on the goods produced by a location can be written
solely in terms of labor income:
                                                           N
                                           wit   it   =         Snit wnt      nt ,                                      (12)
                                                          n=1

                                                               -
                            wit ( it /kit )1-µ ni /zi                                                   Snit wnt nt
           Snit =                                                   -
                                                                          ,                  Tint                   ,   (13)
                      N
                             wmt (   mt /kmt )
                                                 1-µ
                                                          nm /zm                                          wit it
                      m=1

where we have used the property that capital income is a constant multiple of labor income;
Snit is the expenditure share of importer n on exporter i at time t; we have de ned Tint as the
corresponding income share of exporter i from importer n at time t; and note that the order of
subscripts switches between the expenditure share (Snit ) and the income share (Tint ), because the
 rst and second subscripts will correspond below to rows and columns of a matrix, respectively.


                                                           10
Worker Value Function:           Using the value function (7), indirect utility function (3) and the
properties of the extreme value distribution, the expected value from living in location n at time
t after taking expectations with respect to the idiosyncratic mobility shocks {                    gt }     (that is, vnt
                                                                                                                       w
                                                                                                                          
E [Vw nt ]), can be written as:

                                                             N
                                       wnt
                                                                                                                      (14)
                  w                                                       w                   1/
                 vnt   = ln bnt + ln           +  ln             exp  Et vgt+1 /gnt                ,
                                       pnt               g =1

where the expectation Et vgt
                          w
                            +1 = Et E Vnt+1 is taken over future fundamentals {zis , bis }s=t+1 .
                                       w                                                  




Population Flow:        Using the properties of the extreme value distribution, the population ow
condition for the evolution of the population distribution over time is given by:

                                                        N

                                             gt+1   =         Digt it ,                                               (15)
                                                        i=1

                                      w                   1/
                             exp  Et vgt+1 /git                                               it Digt
               Digt =      N                                     1/
                                                                      ,              Egit               ,             (16)
                                          w
                           m=1   exp  Et vmt+1 /mit
                                                                                               gt+1

where Digt is the outmigration probability from location i to location g between time t and t + 1;
we have de ned Egit as the corresponding inmigration probability to location g from location
i between time t and t + 1; again note that the order of subscripts switches between the out-
migration probability (Digt ) and the inmigration probability (Egit ), because the rst and second
subscripts will correspond below to rows and columns of a matrix, respectively.

Properties of General Equilibrium:            Given the state variables { it , kit } and the realized loca-
tion fundamentals {zit , bit }, the general equilibrium in each period is determined as in a standard
static international trade model. Between periods, the evolution of the stock of capital {kit } is
determined by the equilibrium saving rate, and the dynamics of the population distribution { it }
are determined by the gravity equation for migration. We now formally de ne equilibrium.

De nition 1. Equilibrium. Given the state variables {                     i0 ,   ki0 } in each location in an initial
period t = 0, an equilibrium is a stochastic process of wages, capital returns, expected values,
mass of workers and stock of capital in each location {wit , Rit , vit , it+1 , kit+1 }t=0 measurable
with respect to the fundamental shocks up to time t ({zis , bis }s=1 ), and solves the value function
                                                                 t

(14), the population ow condition (15), the goods market clearing condition (12), and the capital
market clearing and accumulation condition (11), with the saving rate determined by Lemma 1.




                                                        11
    We de ne a deterministic steady-state equilibrium as one in which the fundamentals {zi , bi}
and the endogenous variables { i , ki , wi , Ri , vi } are constant over time, where we use an asterisk
                                               

to denote the steady-state value of variables.

De nition 2. Steady State. A steady-state of the economy is an equilibrium in which all location-
speci c fundamentals and endogenous variables (wages, expected values, mass of workers and
stock of capital in each location) are time invariant: {zi , bi , i , ki , wi , Ri , vi }.
                                                                                  


    Our model features rich spatial interactions between locations in both goods and factor mar-
kets and forward-looking investment and migration decisions. Nevertheless, the absence of ag-
glomeration forces and diminishing marginal returns to capital accumulation ensure the existence
of a unique steady-state spatial distribution of economic activity (up to a choice of numeraire),
given time-invariant values of the locational fundamentals of productivity (zi ), amenities (bi ),
goods trade costs (ni
                   
                      ) and migration frictions (ni ).

Proposition 1. Existence and Uniqueness. There exists a unique steady-state spatial distri-
bution of economic activity { i , ki , wi , Ri , vi } (up to a choice of numeraire) given time-invariant
                                              

locational fundamentals {zi , bi , ni , ni } that is independent of initial conditions {
                                        
                                                                                             i0 ,   ki0 }.

Proof. See Section B.7 of the online appendix.

Trade and Migration Share Matrices:              We now introduce the trade and migration share ma-
trices that we use in the next section to characterize the model's comparative statics. Let S be
the N × N matrix with the ni-th element equal to importer n's expenditure on exporter i. Let
T be the N × N matrix with the in-th element equal to the fraction of income that exporter i
derives from selling to importer n. We refer to S as the expenditure share matrix and to T as
the income share matrix. Intuitively, Sni captures the importance of i as a supplier to location n,
and Tin captures the importance of n as a buyer for country i. Note the order of subscripts: in
matrix S , rows are buyers and columns are suppliers, whereas in matrix T , rows are suppliers
and columns are buyers.
    Similarly, let D be the N × N matrix with the ni-th element equal to the share of outmigrants
from origin n to destination i. Let E be the N × N matrix with the in-th element equal to the
share of inmigrants to destination i from origin n. We refer to D as the outmigration matrix and
to E as the inmigration matrix. Intuitively, Dni captures the importance of i as a destination for
origin n, and Ein captures the importance of n as an origin for destination i. Again note the order
of subscripts: in matrix D , rows are origins and columns are destinations, whereas in matrix E ,
rows are destinations and columns are origins.
    For theoretical completeness, we maintain three assumptions on these matrices, which are
satis ed empirically in all years of our data: (i) For any i, n, there exists k such that S k                in
                                                                                                                  >0

                                                      12
and D k   in
               > 0. (ii) For all i, Sii > 0 and Dii > 0. (iii) The matrices S and D are of rank
N - 1. The rst assumption states that all locations are connected with each other directly or
indirectly, through ows of goods and migrants. The second assumption ensures that each loca-
tion consumes a positive amount of domestic goods and has a positive amount of own migrants.
The third assumption ensures that N - 1 columns of the trade and migration share matrices are
linearly independent, with the nal column determined by the requirement that the trade and
migration shares sum to one.


3    Spatial Dynamics
We now linearize the model and derive closed-form solutions for the transition path of the spatial
distribution of economic activity in response to productivity and amenity shocks. Our lineariza-
tion has three main advantages for our empirical application. First, we are able to provide an
analytical characterization of the properties of the economy's transition path, with for example
the speed of convergence to steady-state depending on the eigenvalues of a transition matrix.
Second, most existing research on spatial dynamics assumes perfect foresight. In contrast, our
linearization allows us to solve for the economy's transition path under stochastic fundamen-
tals and rational expectations, as well as under the conventional perfect foresight assumption.
Third, we obtain our analytical characterization for constant intertemporal elasticity of substitu-
tion preferences, which are challenging to analyze in the non-linear model except in the special
case of logarithmic preferences, because in general the equilibrium saving rate is determined as
the solution to the xed-point problem in Lemma 1.
    In Section 3.1, we derive the linearized system of equations that characterizes the economy's
transition path. In Section 3.2, we rst illustrate our approach, by considering the special case of
an economy that is on the transition path towards an initial steady-state and experiences a one-
time, unexpected shock to fundamentals. We show the subsequent dynamic path of the economy
can be characterized by an impact matrix (R), which captures the impact of shocks in the initial
period in which they occur, and a transition matrix (P ), which governs the evolution of the state
variables from one period to the next in response to these shocks. We demonstrate that a spectral
analysis of P and R provides a complete characterization of the model's transition dynamics: The
eigenvalues of P govern the half-lives of convergence to steady-state; the eigenvectors reveal the
locations exposed to particular shocks and the shocks that impact particular locations.
   In Section 3.3, we show that our approach generalizes to an unexpected and convergent se-
quence of shocks to future fundamentals under perfect foresight. In Section 3.4, we show that our
approach also generalizes to stochastic fundamentals, where agents form rational expectations
about future fundamentals based on a known stochastic process for fundamentals. The derivation


                                                13
for all results in this section is reported in Section B.8 of the online appendix.
   One caveat is that our linearization is only exact in theory for small shocks. In principle,
there could be important non-linearities for large shocks. In Section 6 below, we show that in
practice our linearization provides a close approximation to the full non-linear model even for
large shocks, such as the empirical distribution of shocks observed during our sample period.

3.1    Linearized Equilibrium Conditions
We now linearize the general equilibrium conditions of the model. We suppose that we observe
the state variables { t , kt } and the trade and migration share matrices {S , T , D , E } of the econ-
omy at time t = 0. The economy need not be in steady-state at t = 0, but we assume that it is
on a convergence path towards a steady-state with constant fundamentals {z , b, ,  }. We refer
to the steady-state implied by these initial fundamentals as the initial steady-state. We use a tilde
above a variable to denote a log deviation from the initial steady-state (it+1 = ln it+1 - ln       i)
for all variables except for the worker value function, for which with a slight abuse of notation
we use the tilde to denote a deviation in levels (vit  vit - vt
                                                              
                                                                ).
    Totally di erentiating the general equilibrium conditions around the implied initial steady-
state, holding constant the aggregate labor endowment, trade costs and migration costs, we ob-
tain the following system of equations that fully characterizes the economy's transition path in
response to shocks to productivity and amenities:

      kt+1 = kt + (1 -  (1 -  )) wt - pt - kt +                    t                                   (17)
                                                             
                                   1-
                  + (1 -  (1 -  ))    ( - 1) Et                     s wt+s - pt+s - kt+s +   t+s   ,
                                                             s=1


                             pt = S wt - zt - (1 - µ) kt -               t   ,                         (18)

   [I - T +  (I - T S )] wt = - (I - T )            t   +  (I - T S ) zt + (1 - µ) kt -      t     ,   (19)
                                                    
                                 t+1   =E   t   +    (I - ED ) Et vt+1 ,                               (20)
                                                    
                                 vt = wt - pt + bt +  D Et vt+1 .                                      (21)

   In this system of rst-order equations, there are no terms in the change in the trade and
migration share matrices, because these terms are second-order in the underlying Taylor-series
expansion, involving interactions between the changes in productivity and amenities and the
changes in trade and migration shares. As we consider small changes in productivity and ameni-
ties, these second-order terms converge to zero. An important implication is that we can write
the trade and migration share matrices with no time subscript (S , T , D , E ), because they take

                                                        14
the same value for small changes in productivity and amenities, whether we use the initial values
of the trade and migration share matrices at time t = 0, their values in the unobserved initial
steady-state, or their values after adjustment to the shocks. In our empirical application, we use
the initial values at time t = 0, because these are observed in the data.
   From the capital accumulation condition (17), the capital stock in period t + 1 depends on
current and future values of the real wage, the capital stock and population through the solution
to landlords' consumption-investment problem. From the price index equation (18), the change
in the cost of living component of the real wage depends on expenditure shares and the changes
in wages, capital-labor ratios and productivities in each location. From the goods market clearing
condition (19), the change in each location's per capita income depends on changes in population
in all locations ( rst term) and changes in the price competitiveness of other locations's goods in
all markets (second term). From the population ow equation (20), the change in each location's
population depends on the changes in populations in all locations ( rst term) and the changes
in expected values in all locations (second term). Finally, from the value function equation (20),
the change in expected value in each location depends on the change in ow utility ( rst three
terms) and the change in continuation value (last term).
   The state variables in this system of equations are the population ( t ) and capital stock (kt ) in
each location. The laws of motion for both population (20) and capital (17) are forward-looking:
the future population in each location depends on both the current population and the expected
future value of living in each location; similarly, the optimal investment decision of landlords
depends on future returns to capital (note Rt = (1 -  (1 -  )) wt - pt - kt +             t   ). In the
special case of log-utility ( = 1), landlords have a constant saving rate  out of income net of
depreciation, as discussed above. Therefore, the capital equation (17) becomes backward-looking
in this special case, because the future capital stock is a function of only the current period vari-
ables. The value function (21) is also forward-looking, because the expected value of living in
each location depends on current-period state variables, the productivity and amenity shocks,
and the expected future value of living in each location. Finally, the wage equation (19) and price
index equation (18) both depend only on current-period state variables and the productivity and
amenity shocks, through the static trade model.

3.2    Transition Dynamics for a One-time Shock
As a rst illustration of our approach, we begin by solving for the economy's transition path in
response to a one-time shock. We suppose that agents learn at time t = 0 about a one-time,
unexpected, and permanent change in productivity and amenities from time t = 1 onwards.
Under this assumption, we can write the sequence of future fundamentals (productivities and
amenities) relative to the initial level as zt , bt   =    z , b for t  1, and we can drop the

                                                 15
expectation operator in the system of equations (17) through (21).
       Substituting the wage equation (19) and the value function (21) into the labor dynamics equa-
tion (20) and the capital accumulation condition (17), we show in Section B.8.4 of the online
appendix that we can reduce can reduce the model's transition dynamics to the following linear
system of second-order di erence equations in the state variables:

                                       xt+2 = xt+1 + xt + f ,                                                      (22)

                                                             z
where xt =          t
                         is a 2N × 1 vector of the state variables; f =
                                                                  is a 2N × 1 vector of
                kt                                            b
the shocks to fundamentals; and , , , and  are 2N × 2N matrices that depend only on the
structural parameters of the model { , ,  , , µ,  } and the observed trade and migration share
matrices {S , T , D , E }.
   This matrix system of second-order di erence equations (22) can be solved using standard
techniques from the time-series macroeconomics literature. Using the method of undetermined
coe cients following Uhlig (1999), we obtain a closed-form solution for the transition path of the
entire spatial distribution of economic activity in terms of a transition matrix (P ), which governs
the evolution of the state variables from one period to the next, and an impact matrix (R), which
captures the initial impact of the shocks to fundamentals.6

Proposition 2. Transition Path. Suppose that the economy at time t = 0 is on a convergence
path towards an initial steady-state with constant fundamentals (z , b, ,  ). At time t = 0, agents
                                                                              z
learn about one-time, permanent shocks to productivity and amenities (f =          ) from time t = 1
                                                                              b
onwards. There exists a 2N × 2N transition matrix (P ) and a 2N × 2N impact matrix (R) such
that the second-order di erence equation system in (22) has a closed-form solution of the form:

                                        xt+1 = P xt + Rf           for t  0.                                       (23)

Proof. See Section B.8.4 of the online appendix.

       From Proposition 2, we have a closed-form solution for the evolution of the state variables in
each location in all future time periods. Therefore, we can compute the time path of the entire
spatial distribution of economic activity in response to productivity and amenity shocks, using
only the initial observed values of the state variables { t , kt }, the transition matrix (P ) and the
impact matrix (R). Both the transition matrix (P ) and impact matrix (R) can be computed from
our observed trade and migration share matrices (S , T , D , E ) and the structural parameters of
the model.
   6
     Relative to the time-series macro literature, our dynamic spatial model features a larger state space of many loca-
tions or location-sectors over time. Nevertheless, the use of standard linear algebra techniques allows our approach
to accommodate large state spaces, while remaining computationally e cient and easy to implement.

                                                          16
3.2.1   Convergence Dynamics Versus Fundamental Shocks

Before providing a further analytical characterization of the economy's transition path, we show
that our linearization permits an additive decomposition of the observed change in the spatial
distribution of economic activity across locations into the contributions of convergence to steady-
state and shocks to fundamentals.
   Although Proposition 2 states the law of motion of the state variables in terms of log-deviations
relative to the initial steady-state, note that we can take rst-di erences between two time pe-
riods to eliminate the initial steady-state values of variables and obtain a law of motion in log
changes between time periods (noting that  ln xt+1  ln xt+1 - ln xt = xt+1 - xt and  ln f1 
ln f1 - ln f0 = f ):
                                            P  ln xt                     if t > 0,
                         ln xt+1 =                                                                 (24)
                                            P  ln xt + R ln ft+1         if t = 0.
   Summing (24) across time periods, we thus obtain the following additive decomposition of
the change in the state variables between years -1 and t into the contributions of convergence
dynamics and shocks to fundamentals:
                                 t                              t-1
            ln xt - ln x-1 =            s
                                      P (ln x0 - ln x-1 ) +           P s Rf       for all t  1.   (25)
                                s=0                             s=0
                                        convergence given       dynamics from
                                       initial fundamentals   fundamental shocks


   In the absence of any shocks to fundamentals (f = 0), the second term on the right-hand side
of equation (25) is zero, and the state variables converge to:

                  ln xinitial = lim ln xt = ln x-1 + (I - P )
                                                             -1
                                                                (ln x0 - ln x-1 ) ,                (26)
                               t


where (I - P )-1 =      
                        s=0   P s is well-de ned under the condition that the spectral radius of P
is smaller than one, a property that we verify empirically.
    A rst implication is that we can solve for the unobserved steady-state in each year, given the
observed state variables for two initial periods (t = -1, 0), the trade and migration share matrices
for one initial period {S , T , D , E }, and the structural parameters { , ,  , , µ,  }. While one
can also solve for the unobserved steady-state by extending existing dynamic exact-hat algebra
approaches to incorporate forward-looking capital investments, no additive decomposition anal-
ogous to (25) exists, because convergence dynamics and shocks to fundamentals interact through
the non-linear structure of the model.
  A second implication of Proposition 2 is that we can solve for the impact of shocks to funda-
mentals on the steady-state values of the state variables. To see this, note that if the economy is


                                                         17
initially in a steady-state at time 0, then the rst term on the right-hand side of equation (25) is
zero, and the path of the state variables follows:
                                  t-1
          xt = ln xt - ln x0 =          P s Rf = I - P t (I - P )-1 Rf         for all t  1.      (27)
                                  s=0


In this case, the initial response is x1 = Rf , and, taking the limit as t  , we obtain the
comparative steady-state response to fundamental shocks f :

                          lim xt = ln x          
                                       new - ln xinitial = (I - P )
                                                                   -1
                                                                      Rf ,                        (28)
                          t

where we show that this comparative steady-state response can be written as the elasticity of the
endogenous variables in each location with respect to a shock in any location in Proposition A.1
in Section B.8.3 in the online appendix.
   A third implication is is that we can solve for the impact of counterfactual shocks to funda-
mentals on the state variables at various time horizons, even without data on the initial values
of the state variables. Given any set of fundamental shocks (f ), the R matrix captures the initial
impact of these shocks f on the state variables, and the P matrix governs the propagation of
this impact over time, such that        t-1
                                        s=0   P s Rf is the cumulative impact up till time t. These P
and R matrices depend on only the observed trade and migration share matrices (S , T , D , E )
and the structural parameters of the model. This property can be useful in settings where the
initial values of the state variables (such as the capital stock in each location) are hard to observe.
In contrast, solving for the impact of shocks to fundamentals in the non-linear model requires
observed values for the initial state variables.

3.2.2   Spectral Analysis of the Transition Matrix P

We now provide a further analytical characterization of the economy's transition path. Our anal-
ysis so far in Proposition 2 is based on the entire transition matrix (P ). We now show that we can
further characterize the economy's transition path in terms of lower-dimensional components,
namely the eigenvectors and eigenvalues of this transition matrix (P ). Such a lower-dimensional
representation is not possible within the full non-linear model, for which only numerical solutions
for the transition path exist. We use this lower-dimensional representation to characterize the
economy's speed of convergence to steady-state and the heterogeneous impact of local shocks.
   In equation (25) above, we have already shown that we can decompose the dynamic path
of the economy into one component capturing shocks to fundamentals and another component
capturing convergence to the initial steady-state. Therefore, for the remainder of this subsection,
we focus for expositional simplicity on an economy that is initially in steady-state.


                                                     18
Eigendecomposition of the Transition Matrix                   We begin by undertaking an eigendecompo-
sition of the transition matrix, P  U V , where  is a diagonal matrix of eigenvalues arranged
in decreasing order by absolute values, and V = U -1 . For each eigenvalue k , the k -th column
of U (uk ) and the k -th row of V (vk ) are the corresponding right- and left-eigenvectors of P ,
respectively, such that
                                     k uk = P uk ,           k vk = vk P .

That is, uk (vk ) is the vector that, when left-multiplied (right-multiplied) by P , is proportional
to itself but scaled by the corresponding eigenvalue k .7 We refer to uk simply as eigenvectors.
Both {uk } and {vk } are bases that span the 2N -dimensional vector space.
    We next introduce a particular type of shock to productivity and amenities that proves use-
ful for characterizing the model's transition dynamics. We de ne an eigen-shock as a shock to
productivity and amenities (f(k) ) for which the initial impact of these shocks on the state vari-
ables (Rf(k) ) coincides with a real eigenvector of the transition matrix (uk ). Assuming that the
impact matrix is invertible, which we verify empirically, we can recover these eigen-shocks from
the impact matrix (R) and the eigenvectors of the transition matrix (uk ), using f(k) = R-1 uk .
Recall that both the impact matrix (R) and the eigenvectors of the transition matrix (uk ) can
be computed using only our observed trade and migration share matrices (S , T , D , E ) and the
structural parameters of the model { , ,  , , µ,  }. Therefore, we can solve for the eigen-shocks
from these observed data and the structural parameters of the model.
       Using our eigendecomposition and de nition of an eigen-shock, we can undertake a spectral
analysis of the economy's dynamic response to shocks. In particular, we can express the transition
path of the state variables in response to any empirical productivity and amenity shocks (f )
in terms of a linear combination of the eigenvectors and eigenvalues of the transition matrix.
Additionally, the weights or loadings in this linear combination can be recovered from a linear
projection (regression) of the observed shocks (f ) on the eigen-shocks (f(k) ).

Proposition 3. Spectral Analysis. Consider an economy that is initially in steady-state at time
t = 0 when agents learn about one-time, permanent shocks to productivity and amenities (f =
  z
     ) from time t = 1 onwards. The transition path of the state variables can be written as a linear
  b
combination the eigenvalues (k ) and eigenvectors (uk ) of the transition matrix:
                            t-1              2N                          2N
                                                   1 - t                       1 - t
                     xt =         P s Rf =             k
                                                         uk vk Rf =                k
                                                                                     u k ak ,                 (29)
                            s=0              k=1
                                                   1 - k                 k=1
                                                                               1 - k
   7
    Note that P need not be symmetric. This eigendecomposition can be undertaken as long the transition matrix
has distinct eigenvalues, a condition that we verify empirically. We construct the right-eigenvectors such that the
2-norm of uk is equal to 1 for all k , where note that vi uk = 1 for i = k and vi uk = 0 otherwise.



                                                        19
where the weights in this linear combination (ak ) can be recovered as the coe cients in a linear
projection (regression) of the observed shocks (f ) on the eigen-shocks (f(k) ).
Proof. The proposition follows from the eigendecomposition of the transition matrix: P  U V ,
as shown in Section B.8.7 of the online appendix.

    Proposition 3 is one of our main analytical results and plays a key role in our empirical analy-
sis. We now show how it can be used to characterize both the speed of convergence to steady-state
and the heterogeneous impact of shocks across locations.

Speed of Convergence We measure the speed of convergence to steady-state using the con-
ventional measure of the half-life. In particular, we de ne the half-life of a shock f for the i-th
state variable as the time it takes for that state variable to converge half of the way to steady-state:
                               (1/2)                       |xit - xi |    1
                              ti       f  arg max                          ,
                                                  tZ>0   maxs |xis - xi | 2
where xi = xi,new - xi,initial .
                     

    We begin by considering the speed of convergence for eigen-shocks, for which the initial
impact on the state variables corresponds to a real eigenvector of the transition matrix (f(k) =
R-1 uk ). For these eigen-shocks, the state variables converge exponentially towards steady-state,
and the speed of convergence depends solely on the corresponding eigenvalue (k ).
Proposition 4. Speed of Convergence. Consider an economy that is initially in steady-state
at time t = 0 when agents learn about one-time, permanent shocks to productivity and amenities
         z
(f =        ) from time t = 1 onwards. Suppose that these shocks are an eigen-shock (f(k) ), for
         b
which the initial impact on the state variables at time t = 1 coincides with a real eigenvector (uk )
of the transition matrix (P ): Rf(k) = uk . The transition path of the state variables (xt ) in response
to such an eigen-shock (f(k) ) is :
                    2N
                           1 - t
                               j            1 - t
                                                k
             xt =                uj vj uk =       uk         =     ln xt+1 - ln xt = t
                                                                                     k uk ,
                    j =1
                           1 - j            1 - k

and the half-life is given by:
                                          (1/2)              ln 2
                                         ti       f =-
                                                            ln k
for all state variables i = 1, · · · , 2N , where · is the ceiling function.
Proof. The proposition follows from the eigendecomposition of the transition matrix (P  U V ),
for the case in which the initial impact of the shocks to productivity and amenities on the state
variables at time t = 1 coincides with a real eigenvector (Rf(k) = uk ) of the transition matrix
(P ), as shown in Section B.8.7 of the online appendix.

                                                     20
       From Proposition 4, the impact of eigen-shocks (f(k) ) on the state variables in each time period
is always proportional to the corresponding eigenvector (uk ), and decays exponentially at a rate
determined by the associated eigenvalue (k ), as the economy converges to the new steady-state.8
These eigenvalues fully summarize the economy's dynamic response to eigen-shocks, even in our
setting with a high-dimensional state space, a rich geography of trade and migration costs, and
multiple sources of dynamics from investment and migration.
    Each eigen-shock (f(k) ) has a di erent speed of convergence (as captured by the associated
eigenvalue k ), because this speed of convergence to steady-state depends not only on the struc-
tural parameters { , ,  , , µ,  }, but also on the incidence of the shock on the population and cap-
ital stock in each location (as captured by the elements of the associated eigenvector uk = Rf(k) ).
From Proposition 3, any empirical shock (f ) can be expressed as a linear combination of the eigen-
shocks, which hence implies that the speed of convergence will also vary across empirical shocks,
depending on their incidence on the population and capital stock in each location.

Heterogeneous Impact of Shocks                  Using our spectral analysis in Proposition 3, we can de-
compose the observed evolution of the state variables (xt ) in response to any empirical produc-
tivity and amenity shocks (f ) into the contributions of each eigencomponent (uk ).
    Using this decomposition, we can distinguish shocks from exposure to these shocks. Each
eigencomponent can be interpreted as the response of the state variables to a di erent type of
shock (uk = R-1 f(k) ). Di erent empirical productivity and amenity shocks (f ) place di erent
weights on these eigencomponents (as captured by the loadings, ak ). The state variables of the
economy (the population and the capital stock in each location) are unevenly exposed to these
di erent types of shocks. The exposure of the state variable in location i to the k -th eigen-shock
is given by the relevant element of the eigencomponent (uik ), while its exposure to any empirical
shock f depends on the products of the relevant elements of each eigencomponent (uik ) and the
weights or loadings on the di erent eigencomponents (ak ).
   The impact of these di erent shocks on the state variables evolves over time, because di er-
ent eigencomponents (uk ) have di erent associated eigenvalues (k ), and hence di erent speeds
of convergence to steady-state. Therefore, we can use our spectral analysis to isolate di erent
types of shocks (as captured by di erent eigencomponents), the exposure of the state variables
to these di erent types of shocks (as captured by the elements of these eigencomponents and the
loadings), and the time horizons over which these e ects occur (as captured by the eigenvalues).
   8
     In general, these eigenvectors and eigenvalues can be complex-valued. If the initial impact is the real part of a
complex eigenvector uk (Rf = Re (uk )), then ln xt+1 - ln xt = Re (t      k uk ) = Re (k ) · Re k uk . That is, the
                                                                                                t-1

impact no longer decays at a constant rate k . Instead, the complex eigenvalues introduce oscillatory motion as the
dynamical system converges to the new steady-state. For expositional purposes, we focus on real-valued eigenvalues
and eigenvectors. In our empirical application, the imaginary components of P 's eigenvalues are small, implying
that oscillatory e ects are small relative to the e ects that decay exponentially.

                                                         21
   As such, this decomposition has both similarities and di erences with empirical shift-share
Bartik decompositions. A key similarity is that both distinguish shocks and exposure to these
shocks. A rst key di erence is that our decomposition is derived from our closed-form solution
for transition path of the spatial distribution of economic activity in the general equilibrium of
our model. A second key di erence is that our decomposition is dynamic, and hence evolves over
time, as the economy gradually adjusts to the shock.

3.3    Convergent Sequence of Shocks Under Perfect Foresight
We now generalize our analysis of the model's transition dynamics to any convergent sequence
of future shocks to productivities and amenities under perfect foresight. In particular, we con-
sider an economy that is somewhere on a convergence path towards an initial steady-state with
constant fundamentals at time t = 0, when agents learn about a convergent sequence of future
shocks to productivity and amenities fs      from time t = 1 onwards, where fs is a vector of
                                         s1
log di erences in fundamentals between times s and 0 for each location.

Proposition 5. Sequence of Shocks Under Perfect Foresight. Consider an economy that is some-
where on a convergence path towards steady-state at time t = 0, when agents learn about a conver-
                                                                             zs
gent sequence of future shocks to productivity and amenities fs       =                from time
                                                                  s1         bs    s1
t = 1 onwards. There exists a 2N × 2N transition matrix (P ) and a 2N × 2N impact matrix (R)
such that the second-order di erence equation system in (22) has a closed-form solution of the form:
                
                                                                                                (30)
                                   -(s-t)
        xt =           -1  - P              R fs - fs-1 + Rft + P xt-1        for all t  1,
               s=t+1

with initial condition x0 = 0 and where ,  are matrices from the second-order di erence equation
(22) and are derived in Section B.8.7 of the online appendix.

Proof. See Section B.8.7 of the online appendix.

   Therefore, even though we consider a general convergent sequence of shocks to productivity
and amenities in a setting with many locations connected by a rich geography, and with multiple
sources of dynamics from investment and migration, we are again able to obtain a closed-form
solution for the transition path of the spatial distribution of economic activity. Our linearization
allows us to take log deviations between the state variables at each future point in time s  1 and
the initial steady-state at time t = 0, taking into account the intervening changes in fundamentals
between those times. The closed-form solution in equation (30) holds regardless of the economy's
initial distance from steady-state at time t = 0, which is captured in the lagged log di erence in
the state variables from the initial steady-state (xt-1 ).

                                                  22
   Proposition 5 encompasses a number of special cases. First, the permanent shock to produc-
tivity and amenities in period 1 considered in the previous subsection is naturally a special case
of the convergent sequence of shocks to fundamentals considered here: if fs = f for all s  1,
equations (30) and (23) coincide. Second, we encompass a permanent shock to productivity and
amenities in any period t^  1, with fs = f for s  t
                                                  ^ and zero before t
                                                                    ^. In this case, the dynamic
evolution of the state variables in equation (30) simpli es to

                                    Rft + P xt-1                       tt^,
                            xt =
                                    (-1  - P ) ( ) Rf + P xt-1
                                                ^-t
                                              - t
                                                                         ^.
                                                                       t<t

   The transition matrix P and impact matrix R are exactly the same as those in the previous
subsection, and can be recovered from our observed trade and migration share matrices {S , T ,
D , E } and the structural parameters of the model { , ,  , , µ,  }.

3.4   Stochastic Location Characteristics and Rational Expectations
While we have illustrated our approach in the previous two subsections under the assumption of
perfect foresight, we now return to the more general speci cation in Section 2, in which agents
form rational expectations about stochastic fundamentals. In this more general case, we show
that we can use a similar approach to solve in closed-form for the model's transition dynamics,
given an assumed stochastic process for fundamentals. In particular, using  ln to denote log
changes between two periods (e.g.  ln zit  ln zit - ln zit-1 ), we assume the following AR(1)
process for fundamentals, which allows shocks to productivity and amenities to have permanent
e ects on the level of these variables, and hence to a ect the steady-state equilibrium:

                              ln zit+1 = z  ln zit +    z
                                                        it ,        |z | < 1,                    (31)
                              ln bit-1 = b  ln bit +    b
                                                        it ,        b < 1,

where z = b = 0 corresponds to the special case in which fundamentals follow a random walk;
and   z
      it   and   b
                 it   are mean zero and independently and identically distributed innovations.
    The linearization methods that we used to derive closed-form solutions in the previous sub-
sections are taken from the Dynamic Stochastic General Equilibrium (DSGE) literature in macroe-
conomics. Therefore, they continue to apply with stochastic fundamentals, and we can adapt our
earlier results to compute the entire transition path of the expected value of the models' endoge-
nous variables over time.
   Upon observing fundamental shocks at time t, agents form rational expectations about the
future evolution of fundamentals. Given our assumed AR(1) process for fundamentals in equa-
tion (31), agents expect future shocks to fundamentals to decay geometrically to zero over time.


                                                   23
Therefore, we can write the expected values of these future shocks to fundamentals as:

                                          Et [ ln ft+s ] = N s  ln ft ,                                          (32)

               z · IN ×N  0N ×N
where N                  b                      and Et [·] is the expectation conditional on the realizations
                 0N ×N    · IN ×N
of shocks up to time t.
    Using this property, we can extend our earlier results to obtain a closed-form solution for the
economy's expected transition path under stochastic fundamentals and rational expectations. In
particular, consider an economy at time t with state variables xt and fundamentals ft . To rst-
order, the changes in the state variables between periods t and t+1 re ect both convergence to the
steady-state implied by time-t fundamentals and the convergent sequence of expected changes
in fundamentals from equation (32).

Proposition 6. Stochastic Fundamentals and Rational Expectations. Suppose that produc-
tivity and amenities evolve stochastically according to the AR(1) process in equation (31) and agents
have rational expectations. There exists a 2N × 2N transition matrix (P ) and a 2N × 2N impact
matrix (R) such that the evolution of the economy's state variables (xt ) has the following closed-form
solution:
                                                 
                                                                          RN s+1 ( ln ft -  ln ft-1 ) . (33)
                                                                     -s
   ln xt+1 = P  ln xt + R ln ft +                     -1  - P
                                                s=0

Proof. See Section B.8.7 of the online appendix.

    Proposition 6 characterizes the equilibrium stochastic process of the endogenous state vari-
ables. For each period t, the population and capital stock in each location in period t + 1 (xt+1 )
are determined by past state variables (xt , xt-1 ), realizations of fundamental shocks in period t
( ln ft ), and expectations of future fundamental shocks. Combining Proposition 6 with equation
(32) for expected future fundamentals, we can also solve for the expected future path of the state
variables Et [ln xt+s ] for all t and s.
    Proposition 6 relates closely to our earlier results for perfect foresight in the previous two
subsections. The rst two terms on the right-hand-side of equation (33) capture how the state
variables would evolve if location fundamentals realized at time t were expected to be permanent,
as in Proposition 2.9 This coincides with the solution under rational expectations if location
fundamentals follow a random walk. In this case, both autoregressive coe cients z and b are
equal to zero, and N is a zero matrix. The nal term, which is a summation over all future
periods, captures the impact of the sequence of future fundamental shocks expected at time t,
    9
      Note that we can take the rst-di erence of log-deviations from steady-state to obtain log-changes, as in Section
3.2.1 above, where  ln xt = xt - xt-1 .


                                                         24
relative to the sequence expected in the previous period t - 1. This last term can be compared
with the corresponding terms in Proposition 5, where the sequence of future fundamental shocks
is known under perfect foresight. Intuitively, the innovations in fundamental shocks at time t
( it
   z
     and it
          b
            in equation (31)) a ect the current-period state variables ( t , kt ) in ways similar
to unexpected "MIT" shocks. These innovations in fundamental shocks at time t also a ect the
entire sequence of future fundamental shocks expected at time t, because of serial correlation in
fundamental shocks (z and b not equal to zero).
   Therefore, our linearization allows us to relax the assumption of perfect foresight commonly
maintained in quantitative spatial research to allow for stochastic fundamentals and rational ex-
pectations, and yet still solve analytically for the transition path of the expected spatial distribu-
tion of economic activity. In contrast, solving the full non-linear model for this case of stochastic
fundamentals and rational expectations is considerably more challenging, because there is no
analytical solution for the mapping from expected future fundamental shocks to expected future
state variables.


4     Extensions
We now show that our approach accommodates a large number of extensions and generalizations.
In Subsection 4.1, we incorporate shocks to trade and migration costs. In Subsection 4.2, we al-
low productivity and amenities to have an endogenous component that re ects agglomeration
forces, as well as an exogenous component of fundamentals. In Subsection 4.3, we discuss exten-
sions with multiple nal goods sectors (Costinot et al. 2012) and input-output linkages (Caliendo
and Parro 2015 and Caliendo et al. 2019). In Subsection 4.4, we discuss a number of additional
extensions, including trade de cits and residential capital (housing).

4.1    Shocks to Trade and Migration Costs
In this subsection, we show that our analysis naturally incorporates shocks to trade and migration
costs, where the derivation for all results in this subsection is reported in Section D.1 of the online
appendix. Whereas productivity and amenity shocks are common across all partner locations,
trade and migration cost shocks are bilateral, which implies that our comparative static results
now have a representation as a three tensor. To reduce these three tensors down to a matrix
(two tensor) representation, we aggregate bilateral trade and migration shocks across partner
locations, using the appropriate weights implied by the model.
    In particular, we de ne two measures of outgoing and incoming trade costs, which are trade-
share weighted averages of the bilateral trade costs across all export destinations and import
sources, respectively. We de ne outgoing trade costs for location i as ln it
                                                                          out
                                                                                       N
                                                                                       n=1   Tint ln nit ,

                                                  25
where the weights are the income share (Tint ) that location i derives from selling to each export
destination n. We specify incoming trade costs for location n as ln nt
                                                                    in
                                                                                            N
                                                                                            i=1      Snit ln nit , where
the weights are the expenditure share (Snit ) that location n devotes to each import source i. Sim-
ilarly, we de ne outgoing migration costs for location i as ln out
                                                                it       n=1 Dint ln nit , where the
                                                                         N

weights are the outmigration shares from location i to each destination n. We specify incoming
migration costs for location n as ln in
                                     nt 
                                                     N
                                                     i=1   Enit ln nit , where the weights are the inmigration
shares (Enit ) to location n from each origin i.
   Using these de nitions of outgoing and incoming trade and migration costs, we obtain an
analogous system of equations for the model's transition dynamics:

                [ (1 -  ) I + (1 -  (1 -  )) (1 - µ) S ] kt -                   - (1 -  (1 -  ))  in
                                                                                                                       (34)
                                                                            t
   kt+1 =                                                                                                          ,
                          + (1 -  (1 -  )) (I - S ) wt + (1 -  (1 -  )) S z +                    t


                                                      (I - T S ) z + (1 - µ) kt -
                                                                                                                       (35)
                                                                                                 t
             [I - T +  (I - T S )] wt =                                                                    ,
                                                                                    in     out
                                                           - (I - T )   t +  [T  -               ]
                                                                 1 in
                           t+1   =E    t   +    (I - ED ) vt+1 -    - E out ,                                          (36)
                                                                 
         vt =     (I - S ) wt + S z + (1 - µ) S kt -              t   -  in + b - out +  D vt+1                ,       (37)

where recall that we use a tilde above a variable to denote a log deviation from the initial steady-
state. Note that equations (17), (19), (20) and (21) in our baseline speci cation above correspond
to the special case of equations (36)-(37) in which  in =  out = in = out = 0.

4.2     Agglomeration Forces
In this subsection, we generalize our baseline speci cation to introduce agglomeration forces,
where the derivation for all results in this subsection is reported in Section D.2 of the online
appendix. We allow productivity and amenities to have both exogenous and endogenous compo-
nents. The exogenous component captures locational fundamentals, such as climate and access
to natural water, while the endogenous component captures agglomeration forces. Following the
standard approach in the economic geography literature, we model these agglomeration forces
as constant elasticity functions of a location's own population: zit = z   it and bit = bit it ,
                                                                                                 z                       b
                                                                       ¯it                  

where  z > 0 and  b > 0 parameterize the strength of agglomeration forces for productivity and
amenities, respectively.10
  10
     Although for simplicity we assume that agglomeration and dispersion forces only depend on a location's own
population, our framework can be further generalized to incorporate spillovers across locations, as in Ahlfeldt et al.
(2015) and Allen et al. (2020). While we focus on agglomeration forces ( z > 0 and  b > 0), it is straightforward to
also allow for additional dispersion forces ( z < 0 and  b < 0).



                                                           26
   In this extension, the general equilibrium conditions of the model remain the same as in
Section 2.6 above, substituting for the terms in productivity and amenities (zit and bit ) using
the terms in location fundamentals and agglomeration forces (zit = z    it and bit = bit it ).
                                                                                  z                  b
                                                                    ¯it                  

The introduction of these agglomeration forces magni es the impact of exogenous di erences
in fundamentals on the spatial distribution of economic activity. Furthermore, depending on the
strength of these agglomeration forces, there can either be a unique steady-state equilibrium or
multiple steady-state equilibria for the spatial distribution of economic activity. Again we obtain
an analytical characterization of the conditions for the existence and uniqueness of the general
equilibrium of the model, as summarized in the following proposition.

Proposition 7. (A) There exists a unique steady-state spatial distribution of economic activity
    
{wi             
    , vi , i , ki } (up to a choice of numeraire) given the exogenous fundamentals {z i , bi , ni , ni }
if the largest absolute value of the following eigenvalues is less than one.
                                                          b
                                                                       
                                                       1- 
                                1            
                                              (1-b -z -b µ)+(1+µ) 
                                      =                              .
                                             
                                2                     (1+µ)
                                             
                                             (
                                               1- b - z - b µ)+(1+µ)


(B) For su ciently small agglomeration forces ( b +  z  +  b µ < 1), the largest absolute value of
these eigenvalues is necessarily less than one.

Proof. See Section D.2 of the web appendix.


   In general, from part (A) of Proposition 7, whether there is an unique steady-state in the
model depends on the strength of agglomeration forces ( z ,  b ), trade elasticity (), capital in-
tensity (µ), the discount rate ( ) and the dispersion of idiosyncratic preferences (). From part
(B) of Proposition 7, a su cient condition for the existence of a unique steady-state is that the
agglomeration forces ( z ,  b ) are su ciently small. As these parameters converge towards zero,
we obtain our baseline speci cation without agglomeration forces, in which there is necessarily
a unique steady-state equilibrium, as shown in Section 2.6 above. Additionally, an increase in the
dispersion of idiosyncratic preferences (a larger value for ) necessarily increases the range of
values for the other parameters for which a unique steady-state equilibrium exists, as shown in
the proof of the proposition.
   After incorporating the additional agglomeration parameters in the model's general equilib-
rium conditions in Section 2.6 above, we obtain analogous closed-form solutions for the transition
path of the spatial distribution of economic activity in terms of a transition matrix (P ) and an
impact matrix (R), as in Proposition 2 for our baseline speci cation above.



                                                  27
4.3    Multi-sectors and Input-Output Linkages
Our su cient statistics also extend to environments with multiple sectors and input-output link-
ages. We brie y discuss these extensions here and derive them in the online appendix.
   As in our baseline speci cation in Section 2, we assume that capital is geographically immobile
across locations once installed. For the multi-sector model, we consider two di erent assumptions
about capital mobility across sectors. In Section D.3 of the online appendix, we assume that
installed capital is speci c to a location, but mobile across sectors within locations. In Section D.4
of the online appendix, we assume installed capital is speci c to both a location and sector. This
second speci cation corresponds to a dynamic spatial version of the traditional speci c-factors
model, in which there are migration frictions for the mobile factor across locations and sectors,
and there is endogenous accumulation of the factor speci c to each location and sector over time.
In both cases, we assume Cobb-Douglas preferences across sectors and CES preferences across
the goods supplied by locations within sectors, as in Costinot et al. (2012).
   In Section D.5 of the online appendix, we further generalize these multi-sector speci cations
to allow for input-output linkages, where the production technology in each sector now uses
the two primary factors of labor and capital together with intermediate inputs according to a
Cobb-Douglas functional form, as in Caliendo and Parro (2015).
   In all of these speci cations, consumption, production, trade and migration are modelled in a
similar way as in our baseline, single-sector speci cation. The set of equilibrium conditions for
the value function (14), population ow (15), and goods market clearing (12) extends naturally
from describing each location to describing each location-sector, and the capital market clear-
ing and accumulation condition (11) generalizes in a form that depends on the capital mobility
assumption. We again obtain a closed-form solution for the transition path of the entire spatial
distribution of economic activity in terms of a transition matrix (P ) and an impact matrix (R),
as in Proposition 2 for our baseline speci cation above.
   In these multi-sector extensions, the trade and migration share matrices are de ned from
location-sector to location-sector. Additionally, in the input-output speci cation, the expenditure
share (S ) and income share (T ) matrices must be adjusted to take into account the network
structure of production. First, the gross value of trade from exporter i to importer n in industry k
includes not only the direct value-added created in this exporter and sector but also the indirect
value added created in previous stages of production. Second, the e ect of a productivity shock
in one location on any other location now di ers depending on the extent to which it reduces
input prices (and hence production costs) or reduces output prices.




                                                 28
4.4      Other Extensions
Our approach also accommodates a number of other extensions and generalizations. In our base-
line speci cation, we model trade between locations as in Armington (1969), in which goods are
di erentiated by location of origin. In Section C of the online appendix, we establish a number of
isomorphisms, in which we show that our results hold throughout the class of trade models with
a constant trade elasticity. In Section D.6 of the online appendix, we incorporate trade de cits
following the conventional approach of the quantitative international trade literature of treating
these de cits as exogenous. In Section D.7 of the online appendix, we allow capital to be used
residentially (for housing) as well as commercially (in production). In each case, we derive an
analogous closed-form solution for the economy's transition path in terms of a transition matrix
(P ) and an impact matrix (R), as in Proposition 2 for our baseline speci cation above.


5        Quantitative Analysis
In this section, we report our main empirical results for the dynamics of the spatial distribu-
tion of economic activity across U.S. states from 1965-2015. We choose U.S. states as our spatial
units, because of the availability of data on bilateral shipments of goods, bilateral migration ows
and capital stocks over this long historical time period, and because of the substantial observed
changes in the spatial distribution of economic activity over time. For the same reasons, we focus
for most of our empirical analysis on a version of our baseline single-sector model, augmented
to take account of the empirically-relevant distinction between traded and non-traded goods.11
To examine the extent to which sectoral specialization in uences exposure to shocks, we also
implement our multi-sector extension with location-sector-speci c capital from Section 4.3 for
the shorter time period from 1999-2015 for which the sector-level data are available.
    In Subsection 5.1, we introduce our data sources and de nitions. In Subsection 5.2, we discuss
the parameterization of our model. In Subsection 5.3, we provide reduced-form evidence on the
substantial reorientation of economic activity across U.S. states over our sample period, includ-
ing the decline of the Rust Belt and rise of the Sun Belt. In Subsection 5.4, we use our additive
decomposition of the economy's transition path to examine the respective contributions of con-
vergence to steady-state and fundamental shocks. In Subsection 5.5, we use our spectral analysis
to provide evidence on the speed of convergence to steady-state, the respective contributions of
capital and labor dynamics, and the heterogeneous impact of shocks. In Subsection 5.6, we exam-
ine the distributional consequences of shocks to fundamentals. In Subsection 5.7, we report the
results of our multi-sector extension, and provide evidence on the role of sectoral specialization
    11
    Therefore, our single-sector model in our empirical implementation features a single traded sector and a single
non-traded sector, as developed in detail in Section E of the online appendix.


                                                        29
in in uencing the dynamic response of the economy to shocks.

5.1       Data
Our main source of data for our baseline quantitative analysis from 1965-2015 is the national
economic accounts of the Bureau of Economic Analysis (BEA), which report population, gross
domestic product (GDP) and the capital stock for each U.S. state.12 We focus on the 48 contigu-
ous U.S. states plus the District of Columbia, excluding Alaska and Hawaii, because they only
became U.S. states in 1959 close to the beginning of our sample period, and could be a ected by
idiosyncratic factors as a result of their geographical separation. We de ate GDP and the capital
stock to express them in constant (2012) prices.
       We construct bilateral ve-year migration ows between U.S. states from the U.S. population
census from 1960-2000 and from the American Community Survey (ACS) after 2000. We de ne a
period in the model as equal to ve years to match these observed data. We interpolate between
census decades to obtain ve-year migration ows for each year of our sample period. To take
account of international migration to each state and fertility/mortality di erences across states,
we adjust these migration ows by a scalar for each origin and destination state, such that origin
population in year t pre-multiplied by the migration matrix equals destination population in year
t + 1, as required for internal consistency.
       We construct the value of bilateral shipments between U.S. states from the Commodity Flow
Survey (CFS) from 1993-2017 and its predecessor the Commodity Transportation Survey (CTS) for
1977. We again interpolate between reporting years and extrapolate the data backwards in time
before 1977 using relative changes in the income of origin and destination states, as discussed
in further detail in Section H of the online appendix. For our baseline quantitative analysis with
a single traded and non-traded sector, we abstract from direct shipments to and from foreign
countries, because of the relatively low level of U.S. trade openness, particularly towards the
beginning of our sample period.
       For our multi-sector extension from 1999-2015, we construct data for the 48 contiguous U.S.
states, 43 foreign countries and 23 economic sectors, yielding a total of 2,093 region-sector com-
binations, where a region is either a U.S. state or a foreign country. We allow for trade across all
region-sectors, and for migration across all U.S. states and sectors. We obtain sector-level data
on value added, employment and the capital stock for each U.S. state from the national economic
accounts of the Bureau of Economic Analysis (BEA).
   We construct migration ows between U.S. states in each sector by combining data from
the U.S. population census, American Community Survey (ACS), and Current Population Survey
(CPS), as discussed in Section H of the online appendix. We use the value of bilateral shipments
  12
       For further details on the data sources and de nitions, see the data appendix in Section H of the online appendix.

                                                            30
between U.S. states in each sector from the Commodity Flow Survey (CFS), interpolating between
reporting years. We measure foreign trade for each U.S. state and sector using the data on for-
eign exports by origin of movement (OM) and foreign imports by state of destination (SD) from
the U.S. Census Bureau.13 For each foreign country and sector, we obtain data on value added,
employment and the capital stock from the World Input-Output Tables (WIOT).

5.2    Parameterization
To implement our approach empirically, we assume central values of the model's structural pa-
rameters from the existing empirical literature. We assume a standard value of the trade elasticity
of  = 5, as in Costinot and Rodríguez-Clare (2014). We set the 5-year discount rate equal to the
conventional value of  = (0.95)5 . We assume an elasticity of intertemporal substitution of
 = 1, which corresponds to logarithmic intertemporal utility. We assume a value for the migra-
tion elasticity of  = 3 , which is in line with the values in Bryan and Morten (2019), Caliendo
et al. (2019) and Fajgelbaum et al. (2019). We set the share of labor in value added to µ = 0.65,
as a central value in the macro literature. We assume a ve percent annual depreciation rate,
such that the 5-year depreciation rate is  = 1 - (0.95)5 , which is again a conventional value
in the macro and productivity literatures. We report comparative statics for how these model
parameters a ect the economy's transition path in our quantitative analysis below.

5.3    Reduced-Form Evidence on the Rust and Sun-Belt
One the most striking features of economic activity in the United States over our sample period is
its reorientation away from the "Rust Belt" in the mid-west and north-east towards the "Sun Belt"
in the south and west. Although we implement our quantitative analysis at the level of individual
states, we begin by reporting some aggregate results for four groupings of states to illustrate this
large-scale reorientation. Following Alder et al. (2019), we de ne the Rust Belt as the states of
Illinois, Indiana, Michigan, New York, Ohio, Pennsylvania, West Virginia and Wisconsin, and the
Sun Belt as the states of Arizona, California, Florida, New Mexico and Nevada. We group the
remaining states into two categories to capture longstanding di erences between the North and
South: Other Southern States, which includes all former members of the Confederacy, except
those in the Sun Belt; and Other Northern States, which comprises all the Union states from the
  13
     The Census Bureau constructs these data from U.S. customs transactions, aiming to measure the origin of the
movement of each export shipment and the destination of each import shipment. Therefore, these data di er from
measures of exports and imports constructed from port of exit/entry, and from the data on the exports of manu-
facturing enterprises (EME) from the Annual Survey of Manufactures (ASM). See https://www.census.gov/foreign-
trade/aip/elom.html and Cassey (2009).




                                                      31
U.S. Civil War, except those in the Rust Belt or Sun Belt.14
       In Figure 1, we display the shares of these four groups of states in the U.S. population over
time. As shown in the top-left panel, the Rust Belt exhibits by far the largest decline in population
share, which falls by around 8 percentage points from 24.2-16.5 percent from 1965-2015. As shown
in the top-right panel, the Sun Belt displays the largest increase in population share, which rises
by around 5 percentage points from 9.3-14.7 percent over the same period. In contrast, the trends
in population shares for the other two groups of states are much atter. The population share of
Other Northern States falls by 1.6 percentage points from 18.8-17.2 percent, while that for Other
Southern States rises by 2.8 percentage points from 14.4-17.2 percent.
       Figure 1 also shows the shares of these four groups of states in real GDP and the real capital
stock in the United States over time.15 We nd that GDP and capital stock shares show some
di erences from population shares, highlighting the potential relevance of capital accumulation
and productivity growth for the observed reorientation of economic activity. In the Rust Belt, we
 nd that capital and GDP shares fall more rapidly than population in the 1960s and 1970s. In con-
trast, in the Sun Belt, GDP and capital shares lie above population shares from the early 1960s to
the 1990s, before population shares ultimately converge towards them. In Other Northern States,
population shares fall marginally below GDP and capital shares from the mid-1980s onwards.
Finally, in Other Southern States, GDP and capital shares rise substantially more sharply than
population shares in the 1960s and 1970s, consistent with a role for income convergence.
  14
      Therefore, "Other Southern" includes Alabama, Arkansas, Georgia, Louisiana, Mississippi, North Carolina,
South Carolina, Tennessee, Texas, and Virginia. "Other Northern" includes Colorado, Connecticut, Delaware, Dis-
trict of Columbia, Idaho, Iowa, Kansas, Kentucky, Maine, Maryland, Massachusetts, Minnesota, Missouri, Montana,
Nebraska, New Hampshire, New Jersey, North Dakota, Oklahoma, Oregon, Rhode Island, South Dakota, Utah, Ver-
mont, Washington and Wyoming.
   15
      We nd similar patterns whether we use real or nominal shares of GDP and the capital stock.




                                                      32
Figure 1: Shares of Population, Gross Domestic Product (GDP) and the Capital Stock in the United
States over Time
                                          Rust Belt                                                                               Sun Belt

                                                 Pop              GDP          Capital                                                   Pop          GDP          Capital

                                     .3                                                                                      .3




                                    .25                                                                                     .25
                Share of US Total




                                                                                                        Share of US Total
                                     .2                                                                                      .2




                                    .15                                                                                     .15




                                     .1                                                                                      .1

                                          1960                          1980              2000   2020                             1960                      1980              2000   2020
                                                                                   Year                                                                                Year



                                          Other Northern States                                                                   Other Southern States

                                                 Pop              GDP          Capital                                                   Pop          GDP          Capital

                                     .3                                                                                      .3




                                    .25                                                                                     .25
                Share of US Total




                                                                                                        Share of US Total
                                     .2                                                                                      .2




                                    .15                                                                                     .15




                                     .1                                                                                      .1

                                          1960                          1980              2000   2020                             1960                      1980              2000   2020
                                                                                   Year                                                                                Year


               Rust Belt: Illinois, Indiana, Michigan, New York, Ohio, Pennsylvania, West Virginia and Wisconsin. Sun Belt: Arizona, California, Florida,
               New Mexico and Nevada. Other Southern all other former members of the Confederacy. Other Northern all other Union states during the Civil War


Notes: Shares of total population, real gross domestic product (GDP) and the real capital stock in the United States
over time; real GDP and capital stock in 2012 prices.


    In Figure 2, we provide evidence on the role of internal migration as a source of population
changes for the four groups of states. Internal migration is measured as movements of people be-
tween states within the United States and excludes international migration. We focus for brevity
on in-migrants, measured as in ows of internal migrants (in thousands) into each destination
region, separated out by origin region. Three features are noteworthy. First, geographical prox-
imity matters for migration ows, such that other Rust Belt states are one of the leading sources
of in-migrants for the Rust Belt (top-left panel), consistent with our model's gravity equation pre-
dictions. Second, all groups of states receive non-negligible in-migration ows, such that gross
migration ows are larger than net migration ows, in line with the idiosyncratic mobility shocks
in our model. Third, despite the role for geography, the Rust Belt and Other Northern states are
the two largest sources of in-migrants for the Sun Belt, consistent with internal migration con-
tributing to the observed reorientation of population shares.
    Finally, although not shown in these gures, we nd a modest decline in rates of internal
migration between states in the later years of our sample, which is in line the ndings of a number
of studies, including Kaplan and Schulhofer-Wohl (2017) and Molloy et al. (2011). Consistent with
the comparison of several di erent sources of administrative data in Hyatt et al. (2018), we nd
that this decline in rates of internal migration between states is smaller in the population census


                                                                                                   33
data than in Current Population Survey (CPS) data.

      Figure 2: Internal In-migrants for each Destination Region by Origin Region over Time
                                                        Rust Belt Destination                                                                                    Sun Belt Destination
                In-migrants by Origin (1,000s)   2500                                                                                                     2500




                                                                                                                         In-migrants by Origin (1,000s)
                                                 2000                                                                                                     2000



                                                 1500                                                                                                     1500



                                                 1000                                                                                                     1000



                                                 500                                                                                                       500

                                                        1970                      1980          1990              2000                                           1970                   1980              1990   2000
                                                                                         Year                                                                                                      Year


                                                        Other North Destination                                                                                  Other South Destination

                                                 2500                                                                                                     2500
                In-migrants by Origin (1,000s)




                                                                                                                         In-migrants by Origin (1,000s)
                                                 2000                                                                                                     2000



                                                 1500                                                                                                     1500



                                                 1000                                                                                                     1000



                                                 500                                                                                                       500

                                                        1970                      1980          1990              2000                                           1970                   1980              1990   2000
                                                                                         Year                                                                                                      Year




                                                                                  Rust Belt            Sun Belt                                           Other North                          Other South

               Rust Belt: Illinois, Indiana, Michigan, New York, Ohio, Pennsylvania, West Virginia and Wisconsin. Sun Belt: Arizona, California, Florida,
               New Mexico and Nevada. Other Southern all other former members of the Confederacy. Other Northern all other Union states during the Civil War


Notes: Internal in-migration to each destination region by source region from 1960-2000; internal migration includes
all movements of people between states within the United States and excludes international migration.


5.4     Convergence to Steady-state and Fundamental Shocks
We begin by using our additive decomposition from Section 3.2.1 to provide evidence on the
contributions of convergence to steady-state and shocks to fundamentals to the observed reori-
entation of economic activity across U.S. states over our sample period.
    First, we use equation (26) to compute the steady-state values of the state variables for each
U.S. state and year { t , kt } in the absence of further changes in unobserved fundamentals {zt ,
                           

bt , t , t }, given the observed state variables for two previous years and the observed trade and
migration share matrices for each year (S , T , D , E ).
    In Figure 3, we summarize the state-level results by displaying actual and steady-state pop-
ulation shares for each of our four groupings of states. The black line shows the actual data for
each year; the dashed red line shows the implied steady-state assuming no further changes in
fundamentals. From the top-left panel, we nd that actual population in the Rust Belt states was
already substantially above its steady-state value in 1965, and only begins to approach its steady-
state value towards the end of our sample period. In the top-right panel, actual population in
the Sun Belt states was substantially below its steady-state value in 1965, but converges towards
its steady-state value by the late 2000s. In the bottom-right panel, actual population in Other

                                                                                                                    34
Southern states rises substantially above its steady-state value during our sample period, before
the two sets of population shares converge towards one another by the end of our sample period.
Finally, in the bottom-left panel, actual and steady-state population shares in Other Northern
states lie relatively close to one another throughout our sample period.
    Across these four panels, we nd that actual population shares can remain persistently either
above or below their steady-state values for decades, implying slow convergence to steady-state.
Actual and steady-state population shares are also closer together at the end of our sample period
than at its beginning, suggesting that one potential reason for the modest observed decline in
population mobility over time could be that the economy is now closer to steady-state.

              Figure 3: Actual and Implied Steady-State Population Shares by Region
                                        Rust Belt                                                                       Sun Belt

                                   .5                                                                              .5




                                   .4                                                                              .4
                Population share




                                                                                                Population share

                                   .3                                                                              .3




                                   .2                                                                              .2




                                   .1                                                                              .1
                                          1970        1980   1990          2000   2010   2020                             1970        1980   1990          2000   2010   2020
                                                                    Year                                                                            Year



                                        Other North                                                                     Other South

                                   .5                                                                              .5




                                   .4                                                                              .4
                Population share




                                                                                                Population share




                                   .3                                                                              .3




                                   .2                                                                              .2




                                   .1                                                                              .1
                                          1970        1980   1990          2000   2010   2020                             1970        1980   1990          2000   2010   2020
                                                                    Year                                                                            Year




                                                                             Actual       Implied Steady-State
               Rust Belt: Illinois, Indiana, Michigan, New York, Ohio, Pennsylvania, West Virginia and Wisconsin. Sun Belt: Arizona, California, Florida,
               New Mexico and Nevada. North and South definitions based on Federal and Confederacy states


Note: Black line shows actual population shares; dashed line shows implied steady-state population share from
equation (25), assuming no further changes in fundamentals, given the observed state variables for two previous
years and the observed trade and migration share matrices for each year.


    Second, we use equation (26) to compute the counterfactual transition path of economic ac-
tivity implied by convergence towards an initial steady-state with unchanged fundamentals. In
Figure 4, we display these counterfactual transition paths for population shares for 1965, 1975,
1985 and 1995 (dashed lines), as well as the actual evolution of population shares (solid black
line). We extend the counterfactual transition paths beyond the end of our sample period to
again highlight the model's implied slow convergence towards steady-state. From our additive
decomposition in equation (25), the di erence between the actual and counterfactual transition
paths corresponds to contributions from shocks to fundamentals.

                                                                                           35
    We nd that the transition path implied by convergence towards an initial steady-state has
substantial predictive power for the trajectory of actual population shares. We nd the largest
residual contributions from shocks to fundamentals in the late 1960s and early 1970s, which is
consistent with this period including substantial structural change in manufacturing and the rst
oil price shock. From the mid-1970s onwards, we nd smaller values for these residuals, with the
counterfactual transition paths from convergence towards an initial steady-state closely tracking
the actual evolution of population shares (solid black line).

Figure 4: Actual Population Shares and Counterfactual Population Shares Implied by Conver-
gence Towards an Initial Steady-State with Unchanged Fundamentals




Note: Solid black line shows actual population shares; dashed lines show counterfactual transition paths for
population shares based on convergence to an initial steady-state with unchanged fundamentals from equation
(26), starting in either 1965, 1975, 1985 or 1995.


    To provide further evidence on this predictive power of convergence dynamics, we regress ac-
tual population growth on predicted population growth based on convergence towards an initial
steady-state with unchanged fundamentals. We estimate these regressions for each of the periods
1965-2015, 1975-2015, 1985-2015 and 1995-2015, as reported in Section F.1 of the online appendix.
Even for the period from 1965-2015, for which there is the greatest residual contribution from
shocks to fundamentals, we nd a strong positive and statistically signi cant relationship be-
tween actual and predicted population growth, with a regression slope (standard error) of 0.64
(0.18) and R-squared of 0.19. For all periods starting in the mid-1970s onwards, we nd an even
stronger relationship between actual and predicted population growth. For example, for the pe-

                                                      36
riod from 1975-2015, we estimate a regression slope (standard error) of 0.99 (0.095) and R-squared
of 0.82.
   In Section F.1 of the online appendix, we show that controlling for initial log population, log
capital stock, and log population growth has little impact on either the estimated coe cient or
R-squared in these regressions. Therefore, the strength of the relationship between actual and
predicted population growth does not simply re ect mean reversion, because we continue to nd
substantial independent information in predicted population growth, even after including these
controls for initial levels and rates of growth of economic activity.

5.5    Spectral Analysis
We next provide a further characterization of the economy's transition path using our eigende-
composition of the transition matrix (P ) from Propositions 3 and 4 in Section 3.2.2 above.

Speed of Convergence to Steady-State We begin by using Proposition 4 to compute half-
lives of convergence to steady-state. In particular, we compute the number of years for the state
variables to converge half of the way towards steady-state for eigen-shocks (f(k) ), for which the
initial impact of these shocks on the state variables (Rf ) corresponds to a real eigenvector of the
transition matrix (uk ). We have as many half-lifes as eigen-shocks, where each of these eigen-
shocks corresponds to a di erent pattern of shocks to productivity and amenities across the state
variables in each location.
    In the left panel of Figure 5, we display a histogram of these half-lifes across the eigencom-
ponents. We nd that the speed of convergence to steady-state is typically slow, with an average
half life of around 20 years. This pattern of results is consistent with reduced-form ndings of
persistent impacts of local shocks (e.g. Dix-Carneiro and Kovak 2017; Autor et al. 2020) and with
our empirical ndings in the previous subsection that states can remain persistently above or be-
low steady-state for decades. We also nd substantial heterogeneity in the speed of convergence
to steady-state, with half lives ranging from less than 10 years to more than 70 years, depending
on the size and incidence of the shocks to productivity and amenities across the state variables
in each location. This heterogeneity in speeds of convergence is consistent with reduced-form
evidence of uneven impacts of local shocks, as in Eriksson et al. (2019).
    In the right panel of Figure 5, we show that capital and labor dynamics interact with one
another to shape this heterogeneous speed of convergence. On the vertical axis, we display the
half-life of convergence to steady-state (in years) for each eigenvalue of the transition matrix. On
the horizontal axis, we display the regression slope coe cient between the gaps from steady-state
for labor and capital for the corresponding eigen-shock. As apparent from the gure, we nd a
strong, positive and non-linear relationship between the half-life of convergence to steady-state

                                                37
and the correlation between the gaps from steady-state for the two state variables. We observe
low half-lifes (fast convergence) for negative correlations and high half-lifes (slow convergence)
for positive correlations. We nd that a tight relationship between these two variables, with little
dispersion in half-lives for a given correlation between the steady-state gaps.

                            Figure 5: Half-lifes for Convergence Towards Steady-State
(a) Histogram of Half-lifes for Shocks to Productiv-            (b) Relationship Between Half-Lifes of Conver-
ity and Amenities that Correspond to Eigenvectors               gence Towards Steady-State and the Correlation
of the Transition Matrix (P ) in 2000                           between the Initial Gaps of the Labor and Capital
...                                                             State Variables from Steady-State in 2000

            .5



            .4



            .3
  Density




            .2



            .1



            0
                 0     20           40           60   80
                             Half-Life (Years)

Note: Half-life corresponds to the time in years for the state variables to converge half of the way towards
steady-state for an eigen-shock, for which the initial impact of the shock to productivity and amenities on the state
variables (Rf ) corresponds to an eigenvector (uk ) of the transition matrix (P ); left panel shows the distribution of
half-lifes across eigencomponents of the transition matrix in 2000; right panel plots these half-lifes of convergence
to steady-state for the year 2000 against the regression slope coe cient between the gaps from steady-state for the
labor and capital state variables for the corresponding eigen-shock.


            This role of an interaction between capital and labor dynamics in shaping the speed of conver-
gence arises from the complementarity between capital and labor in the production technology.
A high stock of capital in a location raises the marginal productivity of labor, while a high popu-
lation in a location raises the marginal productivity of capital. Therefore, if both capital and labor
are above steady-state in a location, this slows convergence, because the high capital stock retards
the downward adjustment of labor, and the high population dampens the downward adjustment
of capital. Similarly, if both capital and labor are below steady-state, this also slows convergence,
by an analogous line of reasoning. In contrast, if capital is above steady-state whereas labor is
below steady-state, this speeds up convergence, because the high capital stock attracts labor, and
the low population discourages capital accumulation.
    The transition matrix (P ) changes over time with underlying changes in the trade and mi-
gration share matrices (S , T , D , E ). Therefore, we can compute eigenvalues of this transition
matrix, and hence half-lives of convergence to steady-state, for each year of our sample period.

                                                           38
Although we observe a modest decline in geographical mobility in the data on state-to-state mi-
gration, we nd that the speed of convergence towards steady-state is relatively constant over
time, with the mean and maximum half-life declining somewhat towards the end of our sample
period. This juxtaposition of a decline in geographical mobility and faster convergence towards
steady-state again highlights the idea that a decline in geographical mobility does not necessarily
imply a rise in migration frictions and hence slower convergence towards steady-state. This de-
cline in geographic mobility instead can be explained by the economy being closer to steady-state
at the end of our sample period than at its beginning and/or by a change to the pattern of shocks
to productivity and amenities across locations.

       Figure 6: Half-lifes of Convergence to Steady-State for Alternative Parameter Values




Note: Half-lifes of convergence to steady-state for each eigen-shock for alternative parameter values in 2000;
vertical axis shows half-life in years; horizontal axis shows the rank of the eigen-shocks in terms of their half-lifes
for our baseline parameter values (with one the highest half life); each panel varies the noted parameter, holding
constant the other parameters at their baseline values; the blue and red solid lines denote the lower and upper range
of the parameter values considered, respectively; each of the other eight lines in between varies the parameters
uniformly within the stated range; the thick black dotted line in the bottom-left panel displays half-lifes for the
special case of our model without capital, which corresponds to the limiting case in which µ converges to one.


Comparative Statics of the Speed of Convergence                       Using our closed-form solution for the
transition matrix (P ) as a function of the observed data {S , T , D , E } and the structural pa-
rameters of the model { , ,  , , µ,  }, we can also examine the comparative statics of the
speed of convergence with respect to parameter values. We vary each parameter individually,

                                                          39
holding constant the other parameters, and recompute the transition matrix (P ), eigen-shocks
(f(k) = R-1 uk ), and corresponding eigenvalues (k ). An advantage of our linearization is that
we can examine the speed of convergence for the entire spectrum of eigen-shocks, where any
empirical shocks can be written as linear combinations of these eigen-shocks. Undertaking an
analogous exercise using the non-linear model would be challenging, since one would need to
undertake numerical counterfactuals for the set of all possible fundamental shocks, which is not
well de ned.
   In Figure 6, we display half-lifes across eigen-shocks for di erent parameter values, where the
eigen-shocks are sorted in terms of decreasing half-life for our baseline parameter values. Each
panel varies the noted parameter, holding constant the other parameters at their baseline values.
In the top-left panel, a lower intertemporal elasticity of substitution ( ) implies a longer half-life
(slower convergence), because consumption becomes less substitutable across time for landlords,
which reduces their willingness to respond to investment opportunities. In the top-middle panel,
a lower migration elasticity () also implies a longer half-life (slower convergence), because it
increases the dispersion of idiosyncratic tastes, which leads workers to become less responsive
to di erences in the expected value of living in each location. In the top-right panel, a higher
discount rate ( ) also implies a longer half-live (slower convergence), because it increases the
steady-state rate of saving out of income net of depreciation.
   In the bottom-left panel, a lower labor share (µ) implies a longer half-life (slower conver-
gence), which re ects the interaction between capital and labor dynamics. Note that the special
case of our model without capital corresponds to the limiting case in which the labor share con-
verges to one. We show half-lifes of convergence to steady-state in this special case using the
thick black dotted line, again sorted in terms of decreasing half-life for our baseline parameter
values. In this special case, we only only have N state variables and eigencomponents, compared
to 2N state variables and eigencomponents in the general model.
   Comparing these two speci cations, we see that incorporating capital investments introduces
a new adjustment margin, which can increase the economy's speed of convergence in response to
some shocks, as shown by the additional eigencomponents with low half-lifes to the right of the
end of the thick dotted black line. However, this new capital adjustment margin also interacts with
the existing labor adjustment margin, because of the complementarity between capital and labor
in the production technology. As labor reallocates between regions, this induces endogenous
responses in the capital stock, which in turn induces further labor reallocation, and hence slows
the speed of convergence. As a result, the rst N eigencomponents in the model with both labor
and capital lie above those in the special case with only labor, as shown by the eigencomponents
above the thick dotted black line.
   In the bottom-middle panel, a higher trade elasticity () implies a longer half-life (slower


                                                 40
convergence), because it increases the responsiveness of production and consumption in the static
trade model, and hence requires greater reallocation of capital and labor across locations. In the
bottom-right panel, a lower share of tradeables ( ) implies a longer half life (slower convergence),
because it makes the impact of shocks more concentrated locally, which requires greater labor
and capital reallocation between locations.

Heterogeneous Impact of Shocks We next use our eigendecomposition of the transition ma-
trix to provide evidence on the heterogeneous impact of local shocks. We compute the loading
(i ) of an individual location i on the eigenvectors (uk ) using a vector of weights (wi ) equal to
one for its state variables and zero otherwise: i = wi U . Using these loadings for two di erent
locations i and n, we compute the similarity of their exposure to productivity and amenity shocks
as the correlation between these loadings:

                                                       i  n
                                  Similarityi,n                    ,                            (38)
                                                   ||i || × ||n ||

where the stronger this correlation, the greater the extent to which these two locations are ex-
posed to more similar productivity and amenity shocks.
    In Figure 7, we display the similarity of exposure to productivity and amenity shocks for U.S.
states in 1965 (top panel) and 2015 (bottom panel) using a network graph. The nodes correspond
to U.S. states, with the size of these nodes re ecting the population shares of the states. The
thickness of each edge captures the degree of similarity in exposure to productivity and amenity
shocks, where we focus on the 200 edges with the highest degrees of similarity for reasons of leg-
ibility. States are grouped to maximize modularity (the fraction of edges within the groups minus
the expected fraction if the edges were distributed at random). The di erent colored shading
indicates the distinct groups of states.




                                                41
                                              Figure 7: Network of State Exposure to Productivity and Amenity Shocks
                                                                                                                                          (a) 1965
                                                                                                                           RI
                                                                                                                                                                                                                                    SD




                                                                                                                                                WV
                                                                                                  SC



                                                                                                                       VA
                                                                                                                                                                                                                              NV
                                                                                                                                                                                                                                                                   AZ
                                                                                                                                                           MS
                                                                                              NC                                                                                     FL
                                                                                                                                                                           AR
                                                                                             CT
                                                                                                            MA                       LA
                                                                                                                                                                                                                              WY
                                                                                                                                                                                                                                                    NM


                                                                    NJ                                                     GA
                                                                                        NY                                                           CA                    NH

                                                                                                                  MI  VT
                                                                                                                                           AL
                                                                                                                                                            TN
                                                                                                                                                                                                          UT
                                                                                                                                                                                                                               CO                        ID
                                                                         MD
                                                                                                            WI                                                                                  OK
                                                                                        RI
                                                                                             PA                                 OH                   TX                         OR
                                                               NH                                                                                                                                                   WA
                                                                                                                 IL                                                                                                                                ME
                                                                                                                                KY
                     DC
                                                                                                                                                                     MO
                                                                                                                                                IN                                                   NE                   KS
                                                                          ME
                                                                                                                  MN

     CA                                  MA           PA
                                                                    DE
                                                                                                  CT
                                                                                                                                                                                      IA
                                                                                                                                                                                                           MT
                                                                                                                                                                                                                                                              VT
                                                                                                                                                                                                                                                                                                   NH


                    MI
 TX                                                                                NJ                                                                                 ND


                                          NY                                                                                     VA
                               LA
                                                     IN             KY                            NC                                      (b) 2015
           MN                             OH                                       FL                                 MD                                        WV
                                                                                                                                                                                                DC

                                                                                                                                                                                                                                    CA                                             MA     PA
                               IL                          AR                                 AL                                                                                                                                                        MI
          WI
                                          IA                   MS
                                                                          GA                                           SC                                             DE
                                                                                                                                                                                     VT                                   TX                                                        NY
                          MO                                                                                                                                                                                                                                                 LA
                                         NE
                                                          TN                  OK                                                                                RI                                                                                                                       IN             K
                                                                                                                                                                                                                                               MN                                   OH
                                                                                                                                          NH

               SD
                                    ND
                                                                                                                                                                                                                                              WI                         IL                    AR
                                                                                                                                                                                                                                                                                    IA             MS
     CO                                                                                                                                                                                                                                                            MO
                              WA                                                                                                                      ME                                                                                 NV
                                                                                                                                                                                                                                                                                   NE
          AZ                                                                                       KS
                                                                                                                                                                                                                                                                                              TN
                                         UT
                                                           CA                                                MA                  PA                                       CT                                                                       SD
                                                                                                                                                                                                                                                                              ND


                                                                                   MI
OR                        MT
                                                 TX       ID
                                                                                                                  NY
                                                                                                                                                           NJ
                                                                                                                                                                                           NM   VA
                                                                                                                                                                                                                                    CO
                                                                                                                                                                                                                                                                   WA
                                                                                                   LA                                                                 NC                                                                      AZ
                                                                                                                                IN              KY                                                                                                                      DC
                                                                          MN                                     OH                                        FL                        MD                                       WV                                                   UT

                                                                         WI                       IL                                  AR
                                                                                                                                                      GA             AL                                                  OR                                        MT                         ID
                                                                                                                  IA                      MS                                          SC                                            DE
                                                                                              MO
                                                                                                                 NE
                                                                                                                                     TN                OK

                                                                                                       ND
                                                                              SD


                                                               CO
                         NM
                                                                                              WA                                                                                                                                                                                                   NV
                                                                         AZ                                                                                                KS                                  WY
                                                                                                                 UT

                                                OR                                           MT                                      ID




                    Note: Network of bilateral similarity of state exposure to productivity and amenity shocks in 1965 (Panel A) and
                    2015 (Panel B), as de ned in the main text; states grouped to maximize modularity (the fraction of edges within the
                    groups minus the expected fraction if the edges were distributed at random); the two-letter codes correspond to the
                                         WY



                    postal codes for each U.S. state (e.g. CA represents California); colors indicate distinct groups of states.


                              We nd a powerful role for state size and geography in shaping the similarity of exposure to
                    productivity and amenity shocks. In 1965, we nd four main groups of states, as indicated by the
                    blue, green, orange and purple colors. The blue group includes most of the traditional industrial
                    states (e.g. New York, Pennsylvania, Michigan and Ohio), while the green group incorporates
                    Southern and Western states (e.g. California and Texas). Between 1965 and 2015, we nd that a
                      fth group of states emerges, which consists largely of Mid or Southern-Atlantic states (e.g. New
                    Jersey, North Carolina, Maryland and Virginia), and is shown in light green. We also nd that
                    California and Texas move to the blue group of states between these two years, as they increase in

                                                                                                                                                42
size and population, and become more connected with these traditional industrial states. Overall,
we nd that the network is more tightly clustered in 2015 than in 1965, consistent with an increase
in the integration of the U.S. economy over time.

5.6    Distributional Consequences
We now turn to the distributional consequences of shocks to fundamentals. Our framework
implies a rich pattern of heterogeneous welfare e ects of these shocks, both across landlords
because they are geographically immobile, and across workers because of migration frictions,
which imply that a worker's initial location matters for welfare e ects. For both landlords and
workers, the welfare e ects of the shock depend not only on the change in steady-state, but also
on the economy's dynamic response along the entire transition path.
    In Section B.9 of the online appendix, we provide an analytical characterization of these het-
erogenous welfare e ects. First, we show that the relative welfare e ects of shocks across workers
initially located in each region can be inferred from the initial population movements. Second, we
use our closed-form solutions for the economy's transition path to solve for the average welfare
e ect for all workers weighted by initial population shares. We show that this average welfare
e ect can be decomposed into direct e ects from fundamental shocks and indirect e ects from
the changes in state variables in response to these fundamental shocks.
    To illustrate these heterogeneous welfare e ects, we start at the observed values of the state
variables (population and the capital stock) at the beginning of our sample period in 1965, and un-
dertake a counterfactual for a one-time permanent productivity shock equal to the accumulated
empirical distribution of productivity shocks from 1965-2015. We recover this empirical distri-
bution of productivity shocks from the inversion of the non-linear model, using an extension
of existing dynamic exact-hat algebra approaches to incorporate forward-looking capital invest-
ments, as discussed in Section G.1 of the online appendix. We solve for the empirical distribution
of relative changes in productivity across states, using the normalization that the productivity
shocks are mean zero in logs. In this counterfactual, we solve for the transition path of the spa-
tial distribution of economic activity towards the new steady-state in response to this one-time
shock. We evaluate the uneven impact of these productivity shocks on the welfare of workers
depending on their location.
   In Figure 8, we contrast the e ects of these shocks on worker ow utility (wi bi /pi ) versus
worker expected value (vi
                        w
                          ). In both panels, the vertical axis shows the change in the ow utility
(wi bi /pi ) in the initial period for workers located in each state in that period. In the left-panel,
the horizontal axis shows the change in the expected value (vi
                                                             w
                                                               ) in the initial period for workers
located in each state in that period. In contrast, in the right-panel, the horizontal axis shows the
change in the expected value (viw
                                  ) of living in each state in the new steady-state equilibrium. Both

                                                  43
the change in expected value and the change in ow utility are normalized to have a mean of zero
across states.
   In both panels, we nd substantial heterogeneity in the welfare e ects of the productivity
shocks, depending on the state in which workers are initially located. This heterogeneity is
driven by the migration frictions, which imply that it is costly and takes time for workers in
states that experience relative reductions in expected values to reallocate towards those that ex-
perience relative increases in expected values. As population reallocates across states, this leads
to endogenous changes in the stock of capital in each state, which in turn induces further labor
reallocation. In general, the changes in relative expected values are much larger than the changes
in relative ow utilities in the initial period, because these expected values correspond to the net
present value of the stream of expected future ow utilities.
   Comparing the two panels, the change in the initial period ow utility is much more strongly
correlated with the change in the initial period expected value (left panel) than the change in
the expected value in the new steady-state equilibrium (right panel). Again this intuitive pattern
re ects the reallocation of some workers from states that initially experience relative reductions
in expected values towards other states that initially experience relative increases in expected
values, and the resulting endogenous changes in the stock of capital in each state.

Figure 8: Counterfactual Impact of Productivity and Amenity Shocks on Flow Utility and Ex-
pected Value in the Initial Period and the New Steady-State




Note: Starting at the observed values of the state variables at the beginning of our sample in 1965, we undertake
a counterfactual for a one-time permanent productivity shock in each state, equal to the accumulated empirical
productivity shocks from 1965-2015; the left panel shows that change in ow utility and expected value in the initial
period; the right panel shows the change in ow utility in the initial period and the expected value in the new steady-
state; both the change in ow utility and expected value are normalized to have a mean of zero across U.S. states; the
two-letter codes correspond to the postal codes for each U.S. state (e.g. CA represents California); the colors indicate
the states in each of our four groups from Figure 1 above (e.g. gray corresponds to Rust Belt).


                                                          44
5.7    Multi-sector Quantitative Analysis
In a nal empirical exercise, we implement our multi-sector extension with region-sector speci c
capital from Section 4.3 above, using our region-sector data from 1999-2015. We compute our
closed-form solutions for the comparative statics of economic activity in each region-sector with
respect to productivity and amenity shocks in any region-sector, along the entire transition path.
In the interests of brevity, we focus on our analytical characterization of the economy's transition
path using our spectral analysis of the transition matrix (P ).
    We begin by using our generalization of Proposition 4 in the multi-sector model to compute
half-lifes of convergence towards steady-state for shocks to productivity or amenities for which
the initial impact on the state variables (Rf ) corresponds to an eigenvector (uk ) of the transition
matrix (P ). In Figure 9, we display the distribution of these half-lifes across eigenvectors of the
transition matrix in the year 2000. As apparent from the gure, we nd substantially more rapid
convergence to steady-state in our multi-sector extension, with an average half-life of 7 years
and a maximum half-life of 35 years (compared to around 20 and 85 years in our baseline single-
sector model). This nding is driven by the property of the region-sector migration matrices that
 ows of people between sectors within the same U.S. state are much larger than those between
di erent U.S. states. A key implication is that there is likely to be heterogeneity in the persistence
of the impact of local shocks, depending on whether they induce reallocation across industries
within the same location or reallocation across di erent locations.
   In the right panel of Figure 9, we show that capital and labor dynamics again interact with one
another to shape the speed of convergence towards steady-state in the multi-sector model. On the
vertical axis, we display the half-life of convergence to steady-state (in years) for each eigenvalue
of the transition matrix. On the horizontal axis, we display the regression slope coe cient be-
tween the gaps from steady-state for labor and capital for the corresponding eigen-shock. As for
the single-sector model above, we nd a strong, positive and non-linear relationship between the
half-life of convergence to steady-state and the correlation between the gaps from steady-state
for the two state variables. We observe low half-lifes (fast convergence) for negative correlations
and high half-lifes (slow convergence) for positive correlations.
   Under our assumption of no international migration, the deviation of labor from steady-state
is always equal to zero for foreign countries in our multi-sector model. Therefore, they adjust to
fundamental shocks through capital accumulation alone. As a result, we observe a mass of eigen-
shocks with intermediate half-lifes in both panels of the gure. These half-lifes lie in-between
eigen-shocks with fast convergence (negative correlation between the gaps from steady-state)
and those with slow convergence (positive correlation between the gaps from steady-state).




                                                 45
              Figure 9: Half-lifes for Convergence Towards Steady-State in the Multi-Sector Model
(a) Histogram of Half-lifes for Shocks to Productiv-            (b) Relationship Between Half-Lifes of Conver-
ity and Amenities that Correspond to Eigenvectors               gence Towards Steady-State and the Correlation
of the Transition Matrix (P ) in 2000                           between the Initial Gaps of the Labor and Capital
...                                                             State Variables from Steady-State in 2000

            .25



             .2



            .15
  Density




             .1



            .05



             0
                  0     10          20           30   40
                             Half-Life (Years)

Note: Half-life corresponds to the time in years for the state variables to converge half of the way towards
steady-state for an eigen-shock, for which the initial impact of the shock to productivity and amenities on the state
variables (Rf ) corresponds to an eigenvector (uk ) of the transition matrix (P ) in the multi-sector model; left panel
shows the distribution of half-lifes across eigencomponents of the transition matrix in 2000 in the multi-sector
model; right panel plots these half-lifes of convergence to steady-state for the year 2000 in the multi-sector model
against the regression slope coe cient between the gaps from steady-state for the labor and capital state variables
for the corresponding eigen-shock.



6             Non-linearities
Our quantitative analysis so far has demonstrated three main advantages of our linearization.
First, we derive closed-form solutions for the economy's transition path, which permits our ana-
lytical analysis of the determinants of the economy's dynamic response to shocks. Second, we ob-
tain these closed-form solutions under stochastic fundamentals and rational expectations, which
are challenging to analyze in the non-linear model, and hence most prior research on spatial
dynamics has assumed perfect foresight. Third, we obtain our analytical characterization for
constant intertemporal elasticity of substitution preferences, which are also challenging to an-
alyze in the non-linear model, except in the special case of logarithmic preferences, because in
general the equilibrium saving rate is determined as the solution to the xed-point problem in
Lemma 1 in Section 2 above.
   A caveat is that our linearization in only exact in theory for small shocks and in principle
there could be important non-linearities. To examine the potential scope for these non-linearities,
we compare the predictions of our linearization to those of the full non-linear model solution.
In particular, we extend the numerical shooting algorithm for dynamic migration decisions in
Caliendo et al. (2019) to incorporate forward-looking capital investments for the special case of

                                                           46
our model with logarithmic preferences and perfect foresight. This shooting algorithm involves
 rst guessing the entire transition path for population and the capital stock towards the new
steady-state, and then iterating over subsequent updates of this entire transition path, until the
solution and guess converge to one another. We show that in practice our linearization provides
a close approximation to the full non-linear model solution even for large shocks, such as the
empirical distribution of shocks observed during our sample period. For brevity, we report results
for our baseline single-sector speci cation from Section 2 above.
    In Subsection 6.1, we invert the full non-linear model to recover the unobserved changes in
productivity, amenities, trade costs and migration frictions (zit , bit , nit , git ) implied by the ob-
served changes in the state variables ( it , kit ) and the trade and migration shares (Snit , Tint , Digt ,
Egit ). In Subsection 6.2, we examine the potential role for non-linearities, by undertaking coun-
terfactuals using the empirical distribution of productivity shocks, and comparing the predictions
of our linearization to those of the full non-linear model solution.

6.1    Empirical Distribution of Fundamental Shocks
We begin by inverting the non-linear model to recover the unobserved changes in fundamentals
(zit , bit , nit , git ) implied by the observed data. We make the conventional assumption of perfect
foresight and use our extension of existing dynamic exact-hat algebra approaches to incorpo-
rate forward-looking capital investments. We solve for the unobserved changes in fundamentals
from the general equilibrium conditions of the model, using the observed data on bilateral trade
and migration ows, population, capital stock and labor income per capita. We recover these
unobserved fundamentals, without making assumptions about where the economy lies on the
transition path or the speci c trajectory of fundamentals, as shown in Section G.1 of the online
appendix.
    In the left and right panels of Figure 10, we show the recovered empirical distributions of
relative changes in productivity (zi = zi2000 /zi1990 ) and amenities (bi = bi2000 /bi1990 ) across U.S.
states from 1990-2000, where both variables are normalized to have a geometric mean of one.
We nd that relative changes in productivity and amenities are clustered around their geometric
mean of one, but individual states can experience substantial changes in relative productivity and
amenities over a period of a decade, of up to 50 percent. In Section G.2 of the online appendix, we
provide further evidence that we nd an intuitive pattern of changes in productivity, amenities,
bilateral trade costs, and bilateral migration frictions.




                                                    47
Figure 10: Relative Productivity and Amenity Shocks from 1990-2000 from our Model Inversion
    (a) Productivity Shocks (zi = zi2000 /zi1990 )                (b) Amenity Shocks (bi = bi2000 /bi1990 )




Note: Histograms of the distributions of relative changes in productivity (zi = zi2000 /zi1990 ) and amenities
(bi = bi2000 /bi1990 ) from 1990-2000 from our model inversion, as discussed in Section G.1 of the online appendix.
Relative changes in productivity (zi = zi2000 /zi1990 ) and amenities (bi = bi2000 /bi1990 ) are both normalized to
have a geometric mean of one.


6.2     Transition Paths
To examine the potential scope for non-linearities, we compare the transition paths for the spatial
distribution of activity implied by our linearization and the full non-linear model solution. First,
we solve for the steady-state in the full non-linear model implied by the 1990 values of funda-
mentals {zi , bi , ni , ni } from the model inversion. Second, we undertake counterfactuals for the
empirical distribution of productivity shocks from 1990-2000. We solve for the economy's transi-
tion path in response to these productivity shocks using both our linearization and our extended
dynamic exact hat algebra algorithm for the full non-linear model.
   In Figure 11, we show the transition path for population shares (left panel) and population
relative to the initial steady-state (right panel) for each US state. In both panels, the solid blue line
denotes full non-linear model, and the red dashed-line corresponds to our linearization. We nd
that the two sets of predictions track one another relatively closely along the entire transition
path of more than one hundred years, implying a limited role for non-linearities even for the
empirical distribution of productivity shocks over a decade. This approximation is somewhat
better for population shares (left panel) than for population relative to the initial steady-state
(right panel), but remains close in both cases. We nd a similar pattern of results for the capital
stock and for the response of both state variables to amenity shocks.16
  16
     While omitted in the interests of brevity, we also nd a close relationship between the predictions of our lin-
earization and the non-linear model solution for changes in steady-states, with a regression slope coe cient of 1.003
and a coe cient of correlation of 0.999. Following the approach of Kleinman et al. (2020) for a static trade model,
we can also derive analytical bounds for the quality of the approximation for changes in steady-state.



                                                         48
Figure 11: Transition Path Predictions of Our Linearization and the Full Non-Linear Model Solu-
tion for Counterfactual Changes in Productivity
     (a) Transition Path for Population Shares                (b) Transition Path for Population Relative to Initial
                         ...                                  Steady-State Levels




Note: We rst solve for the steady-state values of the state variables { i , ki } implied by the 1990 values of the
                                                                             

fundamentals from inverting the full non-linear model under perfect foresight {zi , bi , ni , ni }. We next undertake
counterfactuals using the empirical distribution of relative changes in productivity over the period 1990-2000, as
discussed in Section G.1 of the online appendix. We compare the predicted transition path in the state variables
from our linearization in Proposition 2 to those from the full non-linear model solution using an extension of the
conventional dynamic exact-hat algebra approach to incorporate capital investments.


    Therefore, our linearization is not only exact in theory for small changes, but also provides
a close approximation in practice to the economy's transition path for the empirical distribution
of decadal productivity and amenity shocks. As discussed above, the main advantages of our lin-
earization are that it yields closed-form solutions for the transition path, encompasses stochastic
fundamentals and rational expectation, and allows for constant intertemporal elasticity of sub-
stitution preferences. A secondary advantage is that we can use our closed-form solutions to
evaluate (to rst-order) any number of counterfactuals for di erent combinations of shocks in
di erent locations. In contrast, using the full non-linear model, one must instead solve each
counterfactual separately using the extended numerical shooting algorithm discussed above. In
Section G.3 of the online appendix, we show that this shooting algorithm is substantially more
costly computationally, particularly for high-dimensional state spaces.


7     Conclusions
A classic question in economics is the response of economic activity to local shocks. In general,
this response can be gradual, because of investments in capital structures and migration frictions.
A key challenge in modeling these dynamics, is that agents' forward-looking decisions depend
on the entire spatial distribution of economic activity across all locations in all future time pe-
riods. Our rst main contribution is to develop a tractable dynamic spatial general equilibrium


                                                         49
framework that incorporates both forward-looking capital investments and dynamic migration
decisions. Despite the many locations connected by a rich geography of trade and migration
frictions, and the multiple sources of dynamics, we provide an analytical characterization of the
conditions for the existence and uniqueness of the steady-state equilibrium.
   Our second main contribution is to derive closed-form solutions for the rst-order general
equilibrium e ect of shocks to fundamentals (productivities, amenities, trade costs and migra-
tion costs) along the entire transition path of the spatial distribution of economic activity. These
su cient statistics depend on four observable matrices for expenditure shares, income shares,
outmigration shares and inmigration shares, the initial values of the state variables (population
and the capital stock) in each location, and the model's parameters. We show that the economy's
transition path is fully characterized by a second-order di erence equation in these state vari-
ables. This second-order di erence equation has a closed-form solution in terms of an impact
matrix, which captures the initial impact of the shocks, and a transition matrix, which governs
the subsequent evolution of the state variables in response to these shocks.
   We use our closed-form solutions for the economy's transition path to provide an analytical
characterization of the economy's dynamic response to shocks. We use an eigendecomposition
of the transition matrix to distinguish between shocks and exposure to shocks. We introduce
the concept of an eigen-shock for which the initial impact of the shock on the state variables is
equal to a eigenvector of the transition matrix. We show that these eigen-shocks can be recovered
from the observed data; any empirical shocks can be written as a linear combination of the eigen-
shocks; and the weights or loadings in this linear combination can be recovered by regressing the
empirical shocks on the eigen-shocks. We use these results to decompose the evolution of the
state variables in response to empirical shocks into the contributions of each eigen-shock. We
show that the speed of convergence to steady-state, as measured by the half-life, is determined
by the corresponding eigenvalues of the transition matrix.
   In our main empirical application, we use data on U.S. states from 1965-2015 to examine the
decline of the "Rust Belt" in the North-East and Mid-West and the rise of the "Sun Belt" in the
South and West. We show that this setting features convergence dynamics in capital and both net
and gross migration, highlighting the relevance of a framework such as ours that incorporates
both forward-looking investments and dynamic migration decisions. Already at the beginning
of our sample period in 1965, we nd that Rust Belt and Sun Belt states were substantially below
and above their steady-state populations, respectively. By the end of sample period, all states
are much closer to their steady-state population than they were at its beginning. We show that
the initial distance of a state's population from its steady-state has substantial predictive power
for subsequent population growth from 1965-2015, even after controlling for the initial levels of
population and the capital stock and initial population growth.


                                                50
     We nd slow average convergence to steady-state, with an average half-life in our baseline
speci cation of around 20 years, which is consistent with recent empirical ndings of persistent
impacts of local shocks. We also nd substantial heterogeneity in this speed of convergence,
which depends on the size and incidence of shocks to productivity and amenities, and is in line
with reduced-form evidence of uneven impacts of local shocks. Since capital and labor are com-
plementary in the production technology, we show that these two sources of dynamics can either
o set or reinforce one another, depending on the correlation between the impact of the shocks
on the capital and labor state variables. Although our closed-form solutions for the economy's
transition path are only exact in theory for small shocks, we show that in practice they provide
a close approximation to the full non-linear model solution even for large shocks, such as the
empirical distribution of decadal shocks observed during our sample period.
  In a nal empirical exercise, we implement our multi-sector extension using region-sector
data on U.S. states and foreign countries from 1999-2015. We nd lower average half-lifes in
our multi-sector extension, which re ects the property of the data that there is greater mobility
of labor across sectors within states than across states. Nevertheless, we again nd substantial
variation in these half-lifes, reinforcing the heterogeneity in the impacts of local shocks, which
now depend on both their spatial and sectoral incidence. We nd that these average half-lifes are
relatively constant over time, which contrasts with the modest observed decline in geographical
mobility. This pattern of results highlights that this decline in geographical mobility does not
necessarily imply a rise in spatial frictions, since it is also in uenced by convergence towards
steady-state, and changes in the pattern and magnitude of shocks.


References
A      , R., C. A       ,     F. E         (2019): "Spatial Linkages, Global Shocks, and Local
    Labor Markets: Theory and Evidence," NBER Working Paper, 25544.
A          , G., S. R       , D. S    ,      N. W    (2015): "The Economics of Density: Evidence
    from the Berlin Wall," Econometrica, 83, 2127­2189.
A       , S., D. L      ,     L. O        (2019): "Labor Market Con ict and the Decline of the
    Rust Belt," Boston University, mimeograph.
A        , T.    C. A           (2014): "Trade and the Topography of the Spatial Economy," Quar-
    terly Journal of Economics, 129, 1085­1140.
A       , T., C. A        ,     X. L (2017): "Optimal City Structure," Yale University, mimeo-
    graph.
------ (2020): "On the Equilibrium Properties of Network Models with Heterogeneous Agents,"
  NBER Working Paper, 27837.
A      , T.   D. D             (2020): "The Geography of Path Dependence," Dartmouth College,
    mimeograph.

                                               51
A       , M.      A. M             (2018): "The Persistence of Local Joblessness," American Economic
    Review, 108, 1942­1970.
A            , G. M. (2007): "Uninsured Idiosyncratic Investment Risk and Aggregate Saving," Re-
    view of Economic Dynamics, 10, 1­30.
A            , C., A. C      ,     A. R            C          (2012): "New Trade Models, Same Old
    Gains," American Economic Review, 102, 94­130.
A             , P. S. (1969): "A Theory of Demand for Products Distinguished by Place of Produc-
    tion," IMF Sta Papers, 16, 159­178.
A       , E., I. B      ,     G. P       (2021): "Patterns of Labor Market Adjustment to Trade
    Shocks with Imperfect Capital Mobility," Universidad San Andres, Buenos Aires.
A       , E., S. C         ,     J. M L       (2010): "Trade Shocks and Labor Adjustment: A
    Structural Empirical Approach," American Economic Review, 100, 1008­45.
A         , A., M. R      ,     L. S     (2020): "Micro Jumps, Macro Humps: Monetary Policy
    and Business Cycles in an Estimated HANK Model," Harvard University, mimeo.
A      , D., D. D        ,       G. H        (2020): "On the Persistence of the China Shock," MIT,
    mimeograph.
A       , D., D. D    ,    G. H. H         (2013): "The China Syndrome: Local Labor Market
    E ects of Import Competition in the United States," American Economic Review, 103, 2121­68.
A      , D. H., D. D    ,     G. H. H        (2016): "The China Shock: Learning from Labor
    Market Adjustment to Large Changes in Trade," Annual Review of Economics, 8, 205­240.
B          , R. (2001): "Core-Periphery Model with Forward-Looking Expectations," Regional Sci-
    ence and Urban Economics, 31, 21­49.
B        , D. R.     E. F        (2019): "Networks, Barriers, and Trade," Harvard University, mimeo-
    graph.
B           , D., T. L ,     A. L          (2019): "Specialization, Market Access and Real In-
    come," University of Michigan, mimeograph.
B      , A. (2021): "Solving Heterogeneous Agent Models with the Master Equation," Harvard Uni-
    versity, mimeograph.
B              , O. J.       L. F. K    (1992): "Regional Evolutions," Brookings Papers on Economic
    Activity, 1, 1­61.
B          , B., Z. H , A. A. L       ,      N. P              N      (2020): "Global Supply Chains
    in the Pandemic," NBER Working Paper, 27224.
B       , G.    M. M          (2019): "The Aggregate Productivity E ects of Internal Migration:
    Evidence from Indonesia," Journal of Political Economy, 127, 2229­2268.
C           , L., M. D      ,     F. P     (2019): "Trade and Labor Market Dynamics: General
    Equilibrium Analysis of the China Trade Shock," Econometrica, 87, 741­835.
C           , L.   F. P       (2015): "Estimates of the Trade and Welfare E ects of NAFTA," Review
    of Economic Studies, 82, 1­44.


                                                   52
------ (2020): "The Quantitative E ects of Trade Policy on Industrial and Labor Location," Yale
  University, mimeograph.
C           , L., F. P  , E. R   H           ,    P. D. S     (2018): "The Impact of Regional and
    Sectoral Productivity Changes on the U.S. Economy," Review of Economic Studies, 85, 2042­2096.
C         , L., F. P  ,     A. T         (2017): "Distortions and the Structure of the World
    Economy," NBER Working Paper, 23332.
C        , A. J. (2009): "State Export Data: Origin of Movement Versus Origin of Production," Jour-
    nal of Economic and Social Measurement, 34, 241­268.
C          , A., D. D          ,      I. K          (2012): "What Goods Do Countries Trade? A
    Quantitative Exploration of Ricardo?s Ideas," Review of Economic Studies, 79, 581­608.
C          , A.     A. R          C      (2014): "Trade Theory with Numbers: Quantifying the
    Consequences of Globalization," in Handbook of International Economics, ed. by E. Helpman,
    K. Rogo , and G. Gopinath, Amsterdam: Elsevier North Holland, vol. 4, 197­262.
D         , K., D. K. N   ,     E. R    H          (2018): "The Geography of Development," Jour-
    nal of Political Economy, 126, 903­983.
D         , K.    E. R       H         (2014): "Spatial Development," American Economic Review,
    104, 1211­1243.
D          , R. (2016): "The Determinants and Welfare Implications of US Workers' Diverging Lo-
    cation Choices by Skill: 1980-2000," American Economic Review, 106, 479­524.
D     C        , R.   B. K. K      (2015): "Trade Liberalization and the Skill Premium: A Local
    Labor Markets Approach," American Economic Review, 105, 551­557, papers and Proceedings.
------ (2017): "Trade Liberalization and Regional Dynamics," American Economic Review, 107,
  1908­2946.
D             , G.      D. P   (2004): "Micro-Foundations of Urban Agglomeration Economies," in
    Handbook of Regional and Urban Economics, ed. by J. V. Henderson and J.-F. Thisse, Amsterdam:
    Elsevier, vol. 4, 2063­2117.
E         , K., K. N. R , J. C. S          ,    M. X (2019): "Trade Shocks and the Shifting
    Landscape of U.S. Manufacturing," NBER Working Paper, 25646.
F             , P. D., E. M       , J. C. S      S        ,     O. Z      (2019): "State Taxes and
    Spatial Misallocation," Review of Economic Studies, 86, 333­376.
F        , J., B. S       ,     A. D. S      (2007): "Did the Rust Belt Become Shiny? A Study of
    Cities and Counties that Lost Steel and Auto Jobs in the 1980s," Brookings-Wharton Papers on
    Urban A airs, 41­89.
F        , M., P. K       ,     A. J. V       (1999): The Spatial Economy: Cities, Regions, and
    International Trade, Cambridge MA: MIT Press.
G      , S., M. Y ,     A. R         C      (2018): "Slicing the Pie: Quantifying the Aggregate
    and Distributional Consequences of Trade," University of Calirfornia, Berkeley, mimeograph.
G        , E. L.    J. G         (2005): "Urban Decline and Durable Housing," Journal of Political
    Economy, 113, 345­375.


                                                 53
G          , E. L.   G. A. P       (2010): "Did the Death of Distance Hurt Detroit and Help
    New York?" in Agglomeration Economies, ed. by E. L. Glaeser, Chicago: Chicago University
    Press, chap. 10.
G          , B. (2020): "The Distributional E ects of Uneven Regional Growth," University of Wash-
    ington, mimeograph.
H          , D. (2013): "Urban Decline in Rust-Belt Cities," Economic Commentary, 2013-06.
H          , E. (1998): "The Size of Regions," in Topics in Public Economics: Theoretical and Applied
    Analysis, ed. by D. Pines, E. Sadka, and I. Zilcha, Cambridge: Cambridge University Press, 33­
    54.
H            , R.     E. M        (2018): "Who Bene ts From Productivity Growth? Direct and
    Indirect E ects of Local TFP Growth on Wages, Rents, and Inequality," NBER Working Paper,
    24661.
H     , Z., A. A. L       ,      N. P       N       (2019): "International Comovement in the
    Global Production Network," NBER Working Paper, 25978.
H       , H., E. M E        , K. U  ,    A. Z      (2018): "Interstate Migration and Employer-
    to-Employer Transitions in the United States: New Evidence from Administrative Records
    Data," Demography, 55, 2161­2180.
K        , G.     S. S            W     (2017): "Understanding the Long-run Decline in Interstate
    Migration," International Economic Review, 58, 57­94.
K       , G.     G. L. V         (2014): "A Model of the Consumption Response to Fiscal Stimulus
    Payments," Econometrica, 82, 1199­1239.
K , R.     J. V            (2020): "Trade and Welfare (Across Local Labor Markets)," NBER Working
 Paper, 27133.
K           , B., E. L ,       S. J. R     (2020): "International Friends and Enemies," NBER Work-
    ing Paper, 27587.
K       , P.   E. M        (2014): "Local Economic Development, Agglomeration Economies, and
    the Big Push: 100 Years of Evidence from the Tennessee Valley Authority," Quarterly Journal
    of Economics, 129, 275­331.
K        , B. K. (2013): "Regional E ects of Trade Reform: What is the Correct Measure of Liberal-
    ization?" American Economic Review, 103, 1960­1976.
K           , P. (1991a): "History Versus Expectations," Quarterly Journal of Economics, 106, 651­
    667.
------ (1991b): "Increasing Returns and Economic Geography," Journal of Political Economy, 99,
  483­499.
------ (1992): "A Dynamic Spatial Model," NBER Working Paper Series, 4219.
K          , P.     A. V          (1995): "Globalization and the Inequality of Nations," Quarterly
    Journal of Economics, 110, 857­880.
M             , K. (1991): "Increasing Returns, Industrialization, and Indeterminacy of Equilibrium,"
    Quarterly Journal of Economics, CVI, 617­50.


                                                  54
M     , B. (2014): "Productivity Losses from Financial Frictions: Can Self-Financing Undo Capital
    Misallocation," American Economic Review, 104, 3186­3221.
M        , R., C. L. S    ,       A. W          (2011): "Internal Migration in the United States,"
    Journal of Economic Perspectives, 25, 173­196.
M       , F., S. R      ,     E. R      H         (2018): "Commuting, Migration and Local Em-
    ployment Elasticities," American Economic Review, 108, 3855­3890.
M         , E. (2011): "Local Labor Markets," in Handbook of Labor Economics, ed. by D. Card and
    O. Ashenfelter, Amsterdam: Elsevier North Holland, vol. 4b, 1238­1303.
P        , M. (2019): "Market Size and Spatial Growth: Evidence from Germany's Post-War Popu-
    lation Expulsions," Yale University, mimeograph.
R           , N., A. R         C     ,     M. S        R          (2016): "Trade, Domestic Fric-
    tions and Scale E ects," American Economic Review, 106, 3159­3184.
R              , J. (2007): "Moving to Nice Weather," Regional Science and Urban Economics, 37, 375­
    398.
R         , S. J. (2016): "Goods Trade, Factor Mobility and Welfare," Journal of International Eco-
    nomics, 101, 148­167.
------ (2020): "Trade and Geography," in Handbook of Regional and Urban Economics, ed. by
  G. Gopinath, E. Helpman, and K. Rogo , Amsterdam: Elsevier, forthcoming.
R        , S. J.     E. R       H          (2017): "Quantitative Spatial Models," Annual Review of
    Economics, 9, 21­58.
R         , S. J.  D. M. S       (2008): "The Costs of Remoteness: Evidence from German Divi-
    sion and Reuni cation," American Economic Review, 98, 1766­1797.
U      , H. (1999): "A Toolkit for Analyzing Non-linear Dynamic Stochastic Models Easily," in
    Computational Methods for the Study of Dynamic Economies, ed. by R. Marimon and A. Scott,
    New York: Oxford University Press, 30­61.
W          , C. (2019): "Firm Creation and Local Growth," Yale University, mimeograph.
Y      , C. (2017): "Estimating a Dynamic Spatial Equilibrium Model to Evaluate the Welfare Im-
    plications of Regional Adjustment Processes," International Economic Review, 58, 473­497.




                                                  55
