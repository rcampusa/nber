                             NBER WORKING PAPER SERIES




                    MACROPRUDENTIAL POLICY WITH LEAKAGES

                                        Julien Bengui
                                        Javier Bianchi

                                     Working Paper 25048
                             http://www.nber.org/papers/w25048


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                  September 2018




For useful comments and suggestions, we thank Yan Bai, Frédéric Boissay, Marcel Fratzscher,
Olivier Jeanne, Sebnem Kalemli-Ozcan, Michael Klein, Alessandro Rebucci, and Alp Simsek, as
well as conference/seminar participants at the IMF, Einaudi Institute, Laval, UQAM, NBER-
CRBT Conference on Monetary Policy and Financial Stability in Emerging Markets, 2015 SED,
Barcelona GSE Summer Workshop on International Capital Flows, the Concluding Conference
of the ESCB’s Macro-prudential Research Network, the 2015 Canadian Macroeconomic Study
Group Annual Meeting, and the IMF 2015 Annual Research Conference. An earlier version of
this paper circulated under the title “Capital Flow Management When Capital Controls Leak.”
We are grateful to the Social Sciences and Humanities Research Council of Canada for funding
this research under grant 430-2016-00995. We thank Louphou Coulibaly, Wontae Han, and Yanis
Sbih for excellent research assistance. The views expressed herein are those of the authors and
not necessarily those of the Federal Reserve Bank of Minneapolis, the Federal Reserve System,
or the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2018 by Julien Bengui and Javier Bianchi. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Macroprudential Policy with Leakages
Julien Bengui and Javier Bianchi
NBER Working Paper No. 25048
September 2018
JEL No. E0,F0,F3,F32,F34

                                            ABSTRACT

The outreach of macroprudential policies is likely limited in practice by imperfect regulation
enforcement, whether due to shadow banking, regulatory arbitrage, or other regulation
circumvention schemes. We study how such concerns affect the design of optimal regulatory
policy in a workhorse model in which pecuniary externalities call for macroprudential taxes on
debt, but with the addition of a novel constraint that financial regulators lack the ability to enforce
taxes on a subset of agents. While regulated agents reduce risk taking in response to debt taxes,
unregulated agents react to the safer environment by taking on more risk. These leakages
undermine the effectiveness of macruprudential taxes but do not necessarily call for weaker
interventions. A quantitative analysis of the model suggests that aggregate welfare gains and
reductions in the severity and frequency of financial crises remain, on average, largely unaffected
by even significant leakages.


Julien Bengui
Département de sciences économiques
Université de Montréal
C.P. 6128, succursale Centre-ville
Montréal QC H3C 3J7
Canada
julien.bengui@umontreal.ca

Javier Bianchi
Federal Reserve Bank of Minneapolis
90 Hennepin Avenue
Minneapolis, MN 55401
and NBER
javieribianchi@gmail.com
1       Introduction
Macroprudential regulation has emerged as a central element of the post-financial crisis dominant
policy paradigm, in which the management of credit cycles has been elevated to the rank of first-
order policy concerns. Central to this view is the notion that curbing credit booms reduces
financial sector vulnerabilities to future reversals in financial conditions. The effectiveness of
macroprudential regulation, however, is not being taken for granted and has been the subject of
a growing empirical literature (see, e.g., Cerutti, Claessens and Laeven, 2017). A common policy
concern is that such new regulation could be bypassed and have unintended consequences.1
    A number of important conceptual questions arise against this backdrop: Is the scope for
macroprudential policy significantly altered by the possibility of leakages? Does macroprudential
policy remain desirable in the presence of leakages? How is the optimal design of regulation
altered by the presence of leakages? The theoretical literature on macroprudential policy has so
far abstracted from the practically relevant issue of imperfect regulation enforcement, and thus
a proper framework to address these questions is lacking. Our goal in this paper is to fill this
gap by providing a theoretical model suited to tackle these issues.
    In line with the emerging policy paradigm and an established theoretical literature on the
topic (e.g., Lorenzoni 2008), we adopt a framework in which inefficient private borrowing deci-
sions generate excessive financial fragility. In our theory, a pecuniary externality resulting from
frictions in financial markets makes macroprudential policy desirable, yet the introduction of
such policy endogenously leads to increased risk taking by a shadow sector endowed with the
ability to bypass regulation. These unintended spillover effects in turn feed into the economy’s
exposure to financial crises, limiting the effectiveness of macroprudential policy and altering its
optimal design.
    Our framework builds on Bianchi (2011)’s model of macroprudential policy, in which a pecu-
niary externality generates overborrowing and excessive exposure to financial crises. We extend
this workhorse model by adding a shadow sector that is able to circumvent regulation. The
macroprudential authority is able to curb risk taking within a narrow (regulated) sector, but has
to internalize the (unregulated) shadow sector’s destabilizing response to its actions.
    We start our analysis with a tractable three-period model. In the model, agents initially make
a borrowing decision and are then subject to income shocks in the intermediate period while
facing a collateral constraint that limits their ability to smooth consumption. The presence of
a market price in the collateral constraint implies that the higher the aggregate leverage chosen
in the initial period, the larger the contraction in the borrowing capacity in the intermediate
period for all households. This pecuniary externality and the associated financial amplification
    1
    Empirical studies analyzing such leakages in macroprudential policies include Magud et al. (2011), Aiyar,
Calomiris and Wieladek (2014), Klein (2012), Jiménez, Ongena, Peydró and Saurina (2012), Forbes, Fratzscher
and Straub (2013), Dassatti and Peydró (2013), and Ahnert, Forbes and Reinhardt (2018).


                                                     1
effects are not internalized by private households, providing a rationale for a macroprudential
policy aimed at limiting private leverage. Different from existing models, however, we assume
that macroprudential regulation can only be enforced on a subset of the population. As a result,
a macroprudential policy seeking to make regulated agents internalize the pecuniary externality
creates a safer environment and has the unintended consequence of encouraging higher borrowing
by unregulated agents. These spillovers undermine the effectiveness of macroprudential policy
and increase the economy’s exposure to financial crises.
    We show that despite destabilizing spillover effects on the unregulated sphere, a small macro-
prudential tax on regulated agents is always strictly welfare improving for all agents. Going
beyond a perturbation argument, we derive an explicit formula for the optimal macroprudential
tax. Relative to the standard Pigouvian tax expression familiar from the literature, accounting
for leakages yields two new elements. One reflects the weaker influence of the financial regulator
onto the price of collateral due to the unregulated sector partially offsetting the regulated sector’s
response to the regulation. The second one reflects the regulator’s higher valuation of relaxing
future collateral constraints resulting from the unregulated sector’s higher exposure to financial
crises. Taken together, these two effects imply an ambiguous effect of leakages on the size of
optimal macroprudential taxes.
    We then turn to an infinite horizon model to pursue a quantitative analysis. In the infinite
horizon context, leakages further give rise to a time inconsistency problem. To see why, suppose
agents expect loose regulation in the future. This expectation generates a perception of a riskier
environment, which induces unregulated agents to take less risk today, narrowing the gap between
the borrowing choices of regulated and unregulated agents. Interestingly, this channel works
despite unregulated agents not being directly subject to regulation. Given our goal of evaluating
the extent to which leakages undermine the effectiveness of regulation, we find it useful to focus
on a discretionary regime in which a regulator has limited ability to exploit the disciplining
effect just described. We thus consider a government that sets optimal regulation sequentially
and without commitment, and we focus on Markov-perfect equilibria. We then calibrate our
infinite horizon model to match the features of emerging market crises and experiment with
degrees of leakages ranging from 0 to 50% of agents making up the unregulated sphere of the
economy.
    The main take away from our quantitative analysis is that even subject to significant leakages,
macroprudential policy remains highly effective and desirable. To offset the increase in borrowing
by the unregulated sector, the planner induces even tighter regulation on the regulated sector, and
this results in aggregate levels of borrowing that are comparable to the constrained-efficient allo-
cation. Average welfare gains are also surprisingly stable with respect to leakages. Nonetheless,
the welfare gains are spread unevenly in the economy, with the lion’s share going to unregulated
agents. Intuitively, while the financial stability benefits of macroprudential policy are partially


                                                  2
offset by the burden of regulation for regulated agents, they are not for unregulated agents, who
free-ride on others’ precautionary behavior.
    This paper belongs to a growing literature providing foundations for macroprudential policies.
A first strand of this literature, most closely related to our paper, examines pecuniary externali-
ties and incomplete markets when financial constraints depend on market prices (Caballero and
Krishnamurthy, 2001, Lorenzoni, 2008, Bianchi, 2011, Jeanne and Korinek, 2012, Bianchi and
Mendoza, 2018, Korinek, 2018). Abstracting from imperfect regulation enforcement, this litera-
ture has tackled several issues, including the interactions between macroprudential and stabiliza-
tion policies (Benigno et al., 2013), monetary policy (Fornaro, 2015, Ottonello, 2015, Sergeyev,
2016, Coulibaly, 2018, Devereux, Young and Yu, 2018), international coordination (Bengui,
2013), policy cyclicality (Schmitt-Grohé and Uribe, 2017), multiple equilibria (Schmitt-Grohé
and Uribe, 2016), news shocks (Bianchi, Liu and Mendoza, 2016), learning about financial in-
novation (Bianchi, Boz and Mendoza, 2012), volatility (Reyes-Heroles and Tenorio, 2018), trend
shocks (Flemming et al., 2016, Seoane and Yurdagul, 2017), and fiscal capacity (Stavrakeva,
2017). A second strand of the literature on macroprudential policy examines aggregate demand
externalities in the presence of nominal rigidities (Schmitt-Grohé and Uribe, 2013, Farhi and
Werning, 2016). Recent research in this area has studied Mundell’s Trilemma (Farhi and Wern-
ing, 2012), liquidity traps (Korinek and Simsek, 2016, Acharya and Bengui, 2018, Fornaro and
Romei, 2018), and fiscal unions (Farhi and Werning, 2017).
    A common theme in this literature is the presence of a wedge between the private and social
cost of borrowing, which generates scope for Pigouvian taxes. Our contribution is to explicitly
model the imperfect enforcement of macroprudential regulation, pursuing both a qualitative
and quantitative analysis of optimal policy. The paper also speaks to an empirical literature
that examines the effectiveness of macroprudential regulation.2 In particular, our quantitative
predictions are consistent with the findings that tighter regulation leads to opposite risk-taking
responses by different agents, although tighter regulation leads to an overall reduction in risk
taking (Dassatti and Peydró, 2013, Aiyar, Calomiris and Wieladek, 2014).
    Finally, a related literature spurred by the rise in shadow banking studies the interaction be-
tween regulation and shadow banking activity. Examples include Huang (2014), Plantin (2015),
Grochulski and Zhang (2015), Farhi and Tirole (2017), Ordonez (2018), Ordonez and Piguillem
(2018), and Bengui, Bianchi and Coulibaly (2019). This literature adopts a primarily micropru-
dential approach to financial regulation. To the best of our knowledge, our paper is the first
one to analyze the implications of the existence of a shadow sector for optimal macroprudential
regulation.
    The paper is organized as follows. Section 2 presents a three-period model that shows an-
alytical results for the main mechanisms in the paper. Section 3 presents the results from the
  2
      See footnote 1 for a list of papers.


                                                3
infinite horizon quantitative model. Section 4 concludes. Proofs are collected in the appendix.


2      A Three-Period Model
In this section, we present an analytically tractable three-period model of financial crises in
which macroprudential policy can only be enforced on a subset of agents. Specific assumptions
on preferences deliver closed-form solutions for continuation equilibria and help us obtain an
analytical characterization of the optimal macroprudential policy problem in the presence of
leakages. Later, in Section 3, we study the same mechanisms we outline in this simple model in
the context of a more general quantitative infinite horizon model.

2.1     Environment
We consider a small open economy that lasts for three periods t = 0, 1, 2. There are two types
of goods, tradables and nontradables, and no production. The only source of uncertainty is over
the endowment of tradable goods in period t = 1.
    The economy is populated by a continuum of agents of one of two types i = U, R that differ
in their ability to bypass regulation: a fraction γ is unregulated (U ) and the remaining 1 − γ is
regulated (R). The distinction between unregulated and regulated agents is intended to capture
in a broad sense the existence of a shadow banking sector, differences in access to sources of
funding, or differences in the ability to circumvent regulation by different agents.3
    Both types of agents have identical preferences and endowments. Preferences are given by

                                  Wi = cTi0 + E0 β ln (ci1 ) + β 2 ln (ci2 )
                                                                           
                                                                                                           (1)

with
                                                        ω         1−ω
                                           cit = cTit        cN
                                                              it          ,

where E is the expectation operator and β < 1 is a discount factor. Date 0 utility is linear in
tradable consumption cT , while date 1 and date 2 utility is logarithmic in a consumption basket
c, which is a Cobb-Douglas aggregator of tradable goods consumption cT and nontradable goods
consumption cN . The parameter ω is the share of tradables in total consumption.
                                                                                           
    Agents receive endowments of tradable goods and nontradable goods of ytT (s) , ytN at
date 1 and date 2, but do not receive any endowment at date 0. The date 1 endowment of
tradables y1T (s) is a random variable depending on the event s ∈ S, which can be interpreted as
the aggregate state of the economy. For simplicity, we assume that y2T is deterministic and that
the nontradable goods endowment is constant, y1N = y2N = y N .
   3
     For the most part, we consider an environment where the size of the unregulated sector γ is exogenous, but
will also provide a simple way to endogenize γ based on an idiosyncratic cost of bypassing regulation.



                                                        4
    Agents have access to a single, one-period, non-state-contingent bond denominated in units
of tradable goods that pays a fixed interest rate r, determined exogenously in the world market.
Denoting the relative price of nontradables by pN , the agents’ budget constraints in all three
periods are given by

                           cTi0 + (1 + τi )−1 bi1 = Ti                                                         (2)
               cTi1 (s) + pN     N                                T        N
                           1 (s)ci1 (s) + bi2 (s) = (1 + r)bi1 + y1 (s) + p1 (s)y
                                                                                  N
                                                                                               ∀s              (3)
                         cTi2 (s) + pN     N                          T   N
                                     2 (s)ci2 (s) = (1 + r)bi2 (s) + y + p2 (s)y
                                                                                 N
                                                                                               ∀s,             (4)

where bt+1 denotes the bond holdings an agent chooses at the beginning of period t, τi denotes
the tax rate on date 0 borrowing, and Ti is a lump-sum transfer. Crucially, we impose τU = 0,
that is, unregulated agents face no tax on borrowing.4 To abstract from the distributional side
effects of macroprudential policy, we assume that the planner rebates the tax proceeds to the
agents who pay the tax.
    At date 1, agents are subject to a credit constraint preventing them from borrowing more
than a fraction κ of their current income:

                                    bi2 (s) ≥ −κ pN     N   T
                                                                 
                                                  1 (s)y + y1 (s)   ∀s.                                        (5)

This credit constraint captures in a parsimonious way the empirical fact that income is critical
in determining credit market access. The form of this constraint follows Mendoza (2002) and is
common in the literature on financial crises and macroprudential policy (e.g., Bianchi, 2011 and
Korinek, 2018). 5
    Agents choose consumption and savings to maximize their utility (1) subject to budget con-
straints (2), (3), (4), and the credit constraint (5), taking pN          N
                                                               1 (s) and p2 (s) as given. Necessary
   4
     We assume that unregulated agents are prevented from arbitraging via borrowing abroad and lending domes-
tically to the regulated sphere (e.g., because of technological reasons). Equivalently, we could assume that the
tax on borrowing on the regulated sphere applies to both domestic and foreign forms of borrowing.
   5
     This collateral constraint can be derived endogenously from limited enforcement assuming that: (i) households
can default at the end of the period (before observing next period income realization), (ii) upon default, foreign
creditors can seize a fraction κ of the current income and households regain access immediately to credit markets.
Non-tradable goods enter the collateral constraint because while foreign creditors do not value non-tradable goods,
they can sell it in exchange for tradable goods after seizing these goods after default. The current and not the
future price appears in the constraint because the opportunity to default is at the end of the current period,
before the realization of future shocks (see Bianchi and Mendoza, 2018).




                                                        5
and sufficient conditions for optimality are given by

                          1 − ω cTit (s)
             pN
              t (s) =                    ,                                                                (6)
                            ω cN it (s)
                                                              
                                                         ω
                    1 = β(1 + r)(1 + τi )E0                      ,                                        (7)
                                                      cTi1 (s)
                ω                      ω
                        ≤ β(1 + r)              with equality if bi2 (s) > −κ(pN     N   T
                                                                               1 (s)y + y1 (s))           (8)
             cTi1 (s)                cTi2 (s)

for all s. Condition (6) is a static optimality condition equating the marginal rate of substitution
between tradable and nontradable goods to their relative price. Conditions (7) and (8) are the
Euler equations for bonds at date 0 and date 1. The latter holds with strict inequality if the
credit constraint binds, in which case current marginal utility exceeds the expected marginal
utility costs from borrowing one unit and repaying next period.
    Finally, the government budget constraint says that taxes on borrowing are rebated back to
regulated agents:
                                            τR
                                  TR = −         bR1 and TU = 0.                                 (9)
                                          1 + τR

Definition of competitive equilibrium. Given a tax policy τR , TR , a competitive regulated
equilibrium of the model is a set of date 0 choices {cTi0 , bi1 }i∈{U,R} , date 1 choices {cTi1 (s), cTi2 (s),
cN        N                                          N       N
 i1 (s), ci2 (s), bi2 (s)}i∈{U,R},s∈S , and prices {p1 (s), p2 (s)}s∈S such that (1) given prices and taxes,
agents’ decisions are optimal, (2) the market for the nontradable good clears at all dates, and
(3) the government budget constraint holds.
     In what follows, we proceed by backward induction. We first analyze the date 1 continuation
equilibrium for given date 0 bond choices and then turn to the determination of date 0 borrowing
decisions.

2.2     Date 1 continuation equilibrium
To simplify the analysis, we make the following parametric assumptions.

Assumption 1. The domestic agents’ discount factor and the international interest rate satisfy
β(1 + r) = 1.

   This assumption, common in small open economy models, implies that domestic agents are
as patient as international investors. A result of this assumption is that there is no intrinsic
motivation for consumption tilting in the domestic economy between date 1 and date 2, which
simplifies the households’ optimization problem.

Assumption 2. The consumption shares and collateralizable fraction of income are such that
0 < κ < ω/(1 − ω).



                                                               6
    This assumption simplifies the analysis by guaranteeing that there is a unique (continuation)
equilibrium. As will become clear below, when Assumption 2 holds, an increase in aggregate
consumption by one unit does not relax agents’ credit constraint by more than one unit in
equilibrium.
    For given date 0 savings choices, the agent’s date 1 problem conveniently admits a closed-form
solution. If an agent i is unconstrained at date 1, his consumption plan for all s is given by

                                  ω                               1 − ω wei1 (s)
         cTi1 (s) = cTi2 (s) =       wei1 (s),   and cN
                                                      it (s) =                   ,      for t = 1, 2,   (10)
                                 1+β                              1 + β pN
                                                                         t (s)

where wei1 (s) is the agent’s date 1 lifetime wealth:

                                                                        y2T + pN
                                                                               2 (s)y
                                                                                      N
                      wei1 (s) ≡ (1 + r)bi1 + y1T (s) + pN     N
                                                         1 (s)y +                       .
                                                                             1+r
To finance this consumption plan, the agent borrows the shortfall between his expenditures
wei1 (s)/(1 + β) and cash on hand (1 + r)bi1 + y1T (s) + pN1 (s)y
                                                                  N
                                                                    at date 1:

                                                                        y2T + pN      N
                                                                                       
                       unc       β                  T         N     N          2 (s)y
            bi2 (s) = bi2 (s) ≡       (1 + r)bi1 + y1 (s) + p1 (s)y −                     . (11)
                                1+β                                          1+r

    The agent is constrained at date 1 if the bond position in (11) violates the credit constraint
(5). In this case, he borrows the maximum amount:

                                  bi2 (s) = bcon
                                                         T        N      N
                                                                            
                                             i2 (s) ≡ −κ y1 (s) + p1 (s)y                               (12)

and chooses a consumption plan given by

                    cTi1 (s) = ω we
                                 ˜ i1 (s)             cTi2 (s) = ω(1 + r) [wei1 (s) − we
                                                                                      ˜ i1 (s)]
                                     we
                                      ˜ i1 (s)                                wei1 (s)−we˜ i1 (s)
                                                                                                        (13)
                    cN
                     i1 (s) = (1 − ω) pN (s)         cN
                                                      i2 (s) = (1 − ω)(1 + r)       pN (s)
                                                                                                  ,
                                            1                                           2


where we
      ˜ i1 (s) is the agent’s date 1 constrained wealth

                           ˜ i1 (s) ≡ (1 + r)bi1 + (1 + κ) y1T (s) + pN      N
                                                                              
                           we                                         1 (s)y     ,

which corresponds to the sum of actual date 1 wealth and the maximum amount that can be
borrowed.
   The nontradable goods market clearing condition is

                             γCUNt (s) + (1 − γ)CRt
                                                 N
                                                    (s) = y N ,     for t = 1, 2,                       (14)

where uppercase letters with U or R subscripts denote aggregates over an agent’s type.
  The aggregation of the two sets of agents’ intertemporal budget constraints yields the econ-



                                                      7
omy’s intertemporal resource constraint:

                               C2T (s)                                             yT
                   C1T (s) +           = (1 + r) [γBU 1 + (1 − γ)BR1 ] + y1T (s) + 2 ,                         (15)
                               1+r                                                1+r
where CtT (s) ≡ γCUT t (s) + (1 − γ)CRt
                                     T
                                        (s) is aggregate tradable consumption.
   Combining the nontradable market clearing condition (14) with the agents’ static optimality
condition (6) indicates that the equilibrium price of nontradables is proportional to the economy’s
absorption of tradables:
                                                  1 − ω CtT (s)
                                        pN
                                         t (s) =                .                              (16)
                                                    ω    yN
This condition establishes a positive equilibrium relationship between the price of nontradables
and aggregate tradable consumption for a given level of nontradable output. Intuitively, when
tradable consumption is high relative to nontradables consumption, the relative price of non-
tradables has to be high. Given homothetic preferences, a negative shock to the tradable goods
endowment y T generates a decline in the demand for both consumption goods. For a given level
of nontradable output - and, by market clearing, nontradable consumption - the equilibrium
relative price of nontradables pN must fall to induce agents to substitute tradable with nontrad-
able consumption. Crucial for our analysis is that a higher aggregate level of debt accumulated
at date 0 will similarly imply a lower level of tradable consumption and thus a lower price of
nontradables for any income shock at date 1. Through the credit constraint (5), this implies a
lower borrowing capacity and a tighter borrowing constraint when this constraint is binding.6
Individual agents do not internalize these effects, which generates a scope for welfare-improving
macroprudential regulation at date 0, as in Bianchi (2011) and others. In this context, the nov-
elty of our analysis regards the planner’s inability to tax or regulate the borrowing decision of a
subset of agents.
    At date 1, the economy’s aggregate state variables are given by the tradable goods en-
dowment y1T (s) and by the respective aggregate bond positions of unregulated and regulated
agents, BU 1 and BR1 . We denote the functions mapping these state variables into date t ag-
gregate tradable consumption, unregulated agents’ tradable consumption, and regulated agents’
tradable consumption by CtT (y1T (s), BU 1 , BR1 ), CUT t (y1T (s), BU 1 , BR1 ), and CRtT
                                                                                             (y1T (s), BU 1 , BR1 ),
respectively. Similarly, we respectively denote the functions mapping the state variables into
date t aggregate nontradable consumption, unregulated agents’ nontradable consumption, and
regulated agents’ nontradable consumption by CtN (y1T (s), BU 1 , BR1 ), CUNt (y1T (s), BU 1 , BR1 ), and
  N
CRt (y1T (s), BU 1 , BR1 ). Finally, we denote the pricing function by pN       T
                                                                            t (y1 (s), BU 1 , BR1 ). Depending
on which set(s) of agents is (are) credit constrained, the economy can be in four regions at date 1:
cc where both types of agents are constrained, cu where U agents are constrained and R agents
   6                                                                                                 ω
    From equation (16), an increase in aggregate consumption raises the price of nontradables by (1−ω)y N and
                                              ω
hence raises overall borrowing capacity by κ 1−ω , which by Assumption 2 is strictly lower than one.


                                                         8
are unconstrained, uc where U agents are unconstrained and R agents are constrained, and uu
where both types of agents are unconstrained. In each of these regions, tradable consumption
is linear in all three state variables. In particular, date 1 aggregate tradable consumption is
increasing in y1T (s), BU 1 , and BR1 . As a result, the date 1 price of nontradables is increasing
in y1T (s), BU 1 , and BR1 . In addition, these two date 1 variables are more sensitive to tradable
income when credit constraints are binding. Similarly, C1T and pN    1 are more sensitive to BU 1 and
BR1 in the regions where the credit constraints are binding. Appendix A formally establishes
these results and related ones.
    Figure 1 illustrates the sensitivity of the price of nontradables pN 1 with respect to the wealth
positions BR1 and BU 1 in the four regions, for a given realization of date 1 tradable income. The
downward-sloping light lines represent iso-price curves. Lines farther to the northeast represent
higher levels of pN 1 . Naturally, agents are constrained at lower wealth levels. The smaller distance
between the iso-price curves in the constrained regions reflects a higher sensitivity of pN 1 in these
regions. The intuition is as follows. When the credit constraint does not bind, consumption is
increasing in wealth because of a standard permanent income effect. When it does bind, however,
the sensitivity is higher because of an additional financial amplification effect working through
the price of nontradables. The larger the mass of constrained agents, the stronger this financial
amplification effect and thus the stronger the sensitivity of pN  1 to debt.




Figure 1: Date 1 price of nontradable good as a function of savings positions BR1 and BU 1 for a
given tradable endowment y1T .

    The properties of the equilibrium nontradable price function discussed above have key im-
plications for the spillover effects of macroprudential policy onto the unregulated sphere of the
economy. In particular, the increasingness of pN 1 in BR1 means that the date 1 total income at


                                                  9
market prices and the date 1 borrowing capacity of unregulated agents are both increasing in the
date 0 savings of the regulated agents. This in turn implies that for a given level of debt of unreg-
ulated agents, the consumption of these agents is higher the lower the debt of regulated agents.
This is illustrated in Figure 2, which represents unregulated agents’ date 1 tradable consumption
CUT 1 as a function of the realization of tradable income y1T , for two different regulated savings
levels B̄R1 < B̃R1 and a given unregulated savings level B̄U 1 = B̄R1 . The light curve represents
the consumption function for a high level of regulated agents’ debt (i.e., high BR1 ), while the dark
curve represents the function for a lower level of regulated agents’ debt (i.e., a lower BR1 ). The
figure shows that a lower level of regulated agents’ debt has several general equilibrium effects on
unregulated agents’ consumption. First, by increasing total income evaluated at market prices,
it shifts consumption up when all agents are unconstrained. Second, by propping up collateral
value, it shifts the region where unregulated agents become constrained to the left. Third, and
maybe more subtly, it reduces the sensitivity of (unregulated agents’) consumption to income for
intermediate levels of income at which unregulated agents are constrained but regulated agents
are not.




Figure 2: Unregulated agents’ date 1 consumption as function of the tradable endowment y1T ,
for given savings pairs (B̄U 1 , B̄R1 ) and (B̄U 1 , B̃R1 ), with B̄U 1 = B̄R1 < B̃R1 .

   The general equilibrium effects just described of regulated agents’ borrowing on unregulated
agents’ date 1 consumption profile naturally translate into spillovers from regulated agents’ bor-
rowing into unregulated agents’ borrowing at date 0. We elaborate on these in Section 2.4.
   At this stage, we can define the date 1 value in equilibrium of an agent of type i as a function




                                                 10
of the aggregate state variables of the economy as
                                X      h                              ω                              1−ω i
   Vi1 (y1T (s), BU 1 , BR1 ) =   β t−1 ln CitT (y1T (s), BU 1 , BR1 ) + ln CitN (y1T (s), BU 1 , BR1        .
                             t=1,2
                                                                                                           (17)
This value function will be useful for the normative analysis coming up in Section 2.5.

2.3     Date 0 unregulated equilibrium
We refer to the competitive equilibrium that prevails when the tax τR is set to zero as the
unregulated equilibrium. The unregulated equilibrium naturally displays symmetric borrowing
choices (BU 1 = BR1 ≡ B1ue ) and is characterized by the following Euler equation:
                                                                      
                                                       ω
                                 1 = E0                                  .             (18)
                                           C1T (y1T (s), B1ue , B1ue )

Lemma 1. The date 0 competitive equilibrium exists and is unique.

2.4     Equilibrium with exogenous tax
To lay the groundwork for our analysis of optimal macroprudential policy in the presence of leak-
ages, we start by characterizing the private sector’s response to an exogenous tax on borrowing.
In a second step, we will then solve for the optimal tax chosen by a benevolent government.
    A competitive regulated equilibrium can be conveniently characterized by a sole pair of Euler
equations,
                                                                          
                                                            ω
                                  1 = E0                                     ,               (19)
                                              CUT 1 (y1T (s), BU 1 , BR1 )
                                                                          
                               1                            ω
                                     = E0       T
                                                                             ,               (20)
                            1 + τR            CR1   (y1T (s), BU 1 , BR1 )

where (19) and (20) are the respective Euler equations for date 0 borrowing of unregulated and
regulated agents.
   Given a value for BR1 , (19) implicitly defines the equilibrium borrowing choice of unregulated
agents. Likewise, for a given value of BU 1 and a given tax τR , (20) implicitly defines the equilib-
rium borrowing choice of regulated agents. We can thus formally define the following equilibrium
responses of the two sectors.

Definition 1 (Equilibrium borrowing responses). BU 1 = φU (BR1 ) denotes the equilibrium bor-
rowing responses of U agents to the borrowing of R agents, as implicitly defined by (19). Similarly,
BR1 = φU (BU 1 , τR ) denotes the equilibrium borrowing responses of R agents to the borrowing of
U agents and a tax rate, as implicitly defined by (20).

    To understand the effect of macroprudential policy with leakages, a key issue is the impact

                                                       11
of a change in borrowing by one type of agent on the other agents’ borrowing choice. Our next
result characterizes such responses.
Proposition 1 (Substitutability in borrowing decisions). For a given tax rate, the equilibrium
borrowing of unregulated agents is decreasing in the amount of borrowing of R agents and vice
versa; that is, φ0U (BR1 ) < 0 and ∂φR (BU 1 , τR )/∂BU 1 < 0.

    Proposition 1 establishes that borrowing decisions by the two sets of agents are akin to strate-
gic substitutes. The less regulated agents borrow, the more unregulated agents find it optimal
to borrow (and vice versa). This result follows naturally from our discussion of how unregulated
agents’ date 1 consumption depended on regulated agents’ borrowing in the context of Figure
2.7 Lower borrowing by regulated agents at date 0 shifts unregulated agents’ consumption up
for any realization of the date 1 endowment, notably because it supports higher nontradable
goods prices and thus uniformly relaxes everyone’s date 1 borrowing constraint. Higher date 1
(tradable) consumption, and thus lower date 1 marginal utility, for a given level of BU 1 , in turn
induces unregulated agents to increase borrowing. The exact same logic applies to regulated
agents’ response to unregulated agents’ borrowing.
    While the substitutability emphasized in Proposition 1 is key to grasping our leakage phe-
nomenon, our ultimate interest lies in understanding how both sectors react to macroprudential
policy. Our next proposition describes how date 0 borrowing by the two sets of agents and date
1 borrowing capacity respond to changes in the tax rate.
Proposition 2 (Positive effect of small tax). Starting from the unregulated equilibrium, impos-
ing a small tax leads to strictly less borrowing by regulated agents, strictly more borrowing by
unregulated agents, and to an unambiguously larger borrowing capacity at date 1.

    Quite intuitively, Proposition 2 states that a tax on debt generates a decrease in regulated
agents’ date 0 borrowing. More importantly, and consistent with Proposition 2, it also says that
a larger tax causes an increase in unregulated agents’ date 0 borrowing.
    Figure 3 illustrates these results by representing the equilibrium response functions of the two
sets of agents in the (BR1 , BU 1 ) space. The solid line is the equilibrium response of unregulated
agents, while the other two lines are the equilibrium responses of regulated agents associated
with a zero tax (dash-dotted line) and a positive tax (dashed line). The intersection between
the unregulated agents’ equilibrium response and the regulated agents’ equilibrium response
associated with a zero tax coincides by definition with the unregulated equilibrium. A positive
tax causes a shift of the regulated agents’ equilibrium response to the right: for a given BU 1 choice,
regulated agents respond to the tax by borrowing less (it makes borrowing more costly). But
unregulated agents respond to this lower borrowing by R agents by borrowing more themselves.
This extra borrowing by U agents in turn induces R agents to borrow even less. And U agents
   7
    Note that this discussion focused on the effect of regulated agents’ borrowing on unregulated agents’ consump-
tion. But a similar logic applies for the effect of unregulated agents’ borrowing on regulated agents’ consumption.

                                                        12
Figure 3: Equilibrium response functions of regulated and unregulated agents in equilibrium
with exogenous tax (0 < γ < 1).

again respond by borrowing even more. This “process” continues until equilibrium is reached at
          τ
point (BR1  , BUτ 1 ). The equilibrium response of unregulated agents can thus be thought of as the
set of (BR1 , BU 1 ) combinations that a government could achieve by varying the tax τR .
    Finally, Proposition 2 indicates that the effect of a larger tax on the date 1 borrowing capacity
is positive. This effect can be traced back to the net effect of an increase in regulated agents’
wealth on the date 1 price of nontradable goods:
                                               +          +        −
                                    dpN
                                      1       ∂pN
                                                1        ∂pN
                                                           1 ∂BU 1
                                          =          +             .                            (21)
                                   dBR1       ∂BR1     ∂B ∂B
                                                       | U 1{z R1}
                                                         Leakage effect


That is, the direct effect of the tax on the date 1 price of nontradables via regulated agents’
borrowing (first term in (21)) necessarily dominates its indirect effect via unregulated agents’
borrowing (second term in (21)), resulting in a positive net effect. This suggests that, at least
locally, leakages may reduce the effectiveness of macroprudential policy by making future bor-
rowing capacity less responsive to a tax on current borrowing, but are not powerful enough to
overturn its effect.

2.5    Optimal macroprudential policy
The preceding section characterized the private sector’s response to an exogenous tax. Building
on this positive analysis, we now take a normative perspective and endogenize the level of the
tax as the outcome of an optimal policy problem.

                                                    13
    Before turning to a formal analysis of optimal policy, we find it useful to highlight the scope
for welfare improvements of macroprudential policy with the following preliminary result.

Proposition 3 (Welfare effect of small tax). If borrowing constraints bind with positive proba-
bility in the unregulated equilibrium, a small positive tax is welfare improving for all agents.

    This result, based on a perturbation argument, indicates that in spite of leakages, it is always
desirable for the planner to impose a small tax on regulated agents. According to Proposition 2,
such a tax leads to less borrowing by regulated agents, more borrowing by unregulated agents,
and a higher date 1 borrowing capacity. The only first-order effect on welfare (for both agents)
arises from the relaxation of the borrowing constraint at date 1 in states of nature where this
constraint binds and is positive. All other effects are of second order. This suggests that there
exists potential welfare gains from macroprudential policy despite leakages.




                   Figure 4: Contract curve and implementability constraint

    Figure 4 plots the unregulated agents’ equilibrium response function φU (BR1 ) together with
both types of agents’ iso-utility curves passing through the unregulated equilibrium (B1ue , B1ue ).
Proposition 3 implies that the segment of the unregulated agents’ equilibrium response function
situated immediately to the right of the unregulated equilibrium necessarily lies in the lens formed
by the two types of agents’ iso-utility curves passing through the unregulated equilibrium.
    Turning to optimal policy, we consider a planner maximizing a weighted sum of the agents’
utility subject to the date 1 and date 2 objects being the outcomes of a continuation equilibrium,
and subject to the unregulated agents’ private optimality condition for borrowing (19). The




                                                14
planner’s problem in primal form is thus given by

      max γδ −BU 1 + βE0 VU 1 y1T (s), BU 1 , BR1 + (1 − γ) −BR1 + βE0 VR1 y1T (s), BU 1 , BR1
                                                                                           
  BR1 ,BU 1

                                                                                                   (22)
                  subject to
                                                   
                                     ω
              1 = E0                                  ,
                       CUT 1 (y1T (s), BU 1 , BR1 )

where the functions VU 1 and VR1 are defined in (17) and δ is a relative Pareto weight on un-
regulated agents. When δ = 1, the planner’s objective becomes utilitarian, with the weight on
agents’ welfare being equal to their share in the population.
    Before formally characterizing the optimal policy, let us stress how the planner’s problem
differs from typical planning problems in environments with pecuniary externalities. As is stan-
dard, the planner effectively controls BR1 by means of the tax on borrowing. However, here the
choice of BU 1 is up to unregulated agents. As a result, the planner is constrained to choosing
a pair (BR1 , BU 1 ) from within the equilibrium best response function of unregulated agents, as
depicted by the solid line in Figure 4.8 Absent this constraint, the solution to the planning
problem would be the constrained-efficient allocation, depicted as the point (B1ce , B1ce ) in Figure
4.
    The planner’s optimal choice of BR1 is characterized by the following generalized Euler equa-
tion (GEE):
                                                          2 
                                          dpN                                             dpN
                                                                                           
       ω                              δγ    1
                                                         X        ω     ω      N      N      1
1 = E0 T + κE0                 µR1 +     µU 1    + γβE0         δ T − T       CRt − CU t
      CR1                            1−γ dBR1            t=1
                                                                 C U t C Rt                dBR1
                                                                                             (23)
                  T         T
where µi1 ≡ ω/Ci1 − ω/Ci2 ≥ 0 are the shadow costs associated with the credit constraints at
date 1, and dpN1 /dBR1 is given by (21).
    This GEE equates the marginal costs from reducing borrowing and consumption today with
the marginal benefits of having lower debt tomorrow. It resembles the private Euler equation (7),
but contains additional terms reflecting the planner’s internalization of pecuniary externalities
and spillovers to unregulated agents. The left-hand side is the same and corresponds to the
marginal utility cost of reducing consumption by one unit. Given linear utility, this term is a
constant equal to one. The first term on the right-hand side of (23) corresponds to the private
marginal utility cost from borrowing one less unit and raising consumption tomorrow, also present
in (7).
    The second term in (21) constitutes the pecuniary externality: the planner internalizes that
a lower level of debt leads to an increase in the price of nontradable goods at date 1 and a
  8
      Naturally, the unregulated equilibrium belongs to the set of feasible (BR1 , BU 1 ) pairs.


                                                           15
relaxation of collateral constraints for both regulated and unregulated agents at that date. The
benefit of relaxing the collateral constraint is an average of the Lagrange multipliers, weighted by
the relevant Pareto weights. A similar expression is common in the normative analysis of models
with credit constraints linked to market prices (e.g., Bianchi, 2011). However, unlike in models
with perfect financial regulation enforcement, it here embeds the unregulated agents’ response
to the borrowing choice of the planner for the regulated agents, through the negative partial
derivative ∂BU 1 /∂BR1 present in the price derivative term dpN   1 /dBR1 . This leakage effect lowers
the marginal value of saving on behalf of regulated agents for the planner and therefore reduces
the wedge between the planner’s and private agent’s perceived benefit of having lower debt. The
final term of the GEE reflects the planner’s marginal value of the wealth redistribution induced
by a higher price of nontradables.9
    The discrepancy between the planner’s GEE (23) and the regulated agent’s private Euler
equation for debt (7) calls for a Pigouvian tax on debt, as in the existing literature. The next
proposition establishes that as long as the planner can tax a subset of agents, irrespective of how
large (or small) this subset is, he will choose to set a strictly positive tax whenever the credit
constraint binds with strictly positive probability.

Proposition 4 (Optimal tax). The optimal tax is given by
           h                    N
                                    i        hP                                                                i
                   δγ         N dp1              2      ω                   ω         N
                                                                                                          dpN
       βE0 µR1 + 1−γ µU 1 κy dBR1 + γβE0         t=1 δ CUT −                T
                                                                           CRt
                                                                                     CRt   −   CUNt          t
                                                                                                          dBR1
                                                          t
  τR =                                     h    i                                                                    .   (24)
                                       E0 CωT
                                                           R1


As a result, the optimal tax on borrowing is strictly positive whenever the credit constraint binds
with positive probability in the unregulated equilibrium.

    The optimal tax captures the uninternalized marginal costs of borrowing from the GEE (23).
The optimal tax expression suggests an ambiguous effect of leakages on the magnitude of the
tax. Two key forces work in opposite directions. First, the leakage term in (21) reduces the
magnitude of the price derivative term dpN 1 /dBR1 , calling for a lower tax. Second, leakages lead
to higher shadow values of relaxing the collateral constraint for unregulated agents µU 1 , calling
for a higher tax. In other words, the macroprudential policy’s reduced effectiveness speaks in
favor of a lower tax, while larger benefits from financial stabilization speak in favor of a higher
tax, resulting in an ambiguous total effect. Similarly, the relationship between the size of the
unregulated sector γ and the optimal tax is a priori ambiguous.
   9
    A higher price of nontradables redistributes wealth from the net buyer of nontradables to the net sellers of
nontradables.




                                                      16
2.6         Endogenous fraction of unregulated agents
So far, our analysis of macroprudential policy with leakages has taken the size of the unregulated
sector as exogenously given. In this section, we present a simple way to endogenize this variable
with a model of free entry into the unregulated sphere.
    Our baseline model is extended by adding a period prior to date 0, labeled date −1, when
households choose whether they want to join the unregulated sector. To do so, they must pay
a linear tax circumvention cost ϕ randomly distributed over the population and realized before
the decision to circumvent is made.
    To choose whether to join the unregulated sector, agents conjecture a tax τRc to be set by the
government at date 0. It follows that an agent joins the unregulated sphere when

                                                    WU (τ c ) − ϕi > WR (τ c )

and remains in the regulated sphere otherwise.
   Assuming that the planner is unable to commit over the tax at date −1, the size of the
unregulated sector is a fixed point.10 For a given conjecture of the tax, households choose
whether they want to be unregulated. In turn, given the implied size of the unregulated sector,
the government chooses the tax expected by agents at date −1. It is easy to see that any γ
can be rationalized by some distribution of idiosyncratic costs. Following that logic, our insights
remain unchanged once we endogenize γ.

2.7         Insights from three-period model
This section presented a highly stylized model of imperfectly enforced macroprudential policy,
where the inherent motivation for a tax on borrowing derived from a pecuniary externality
caused by financial constraints linked to a market price. The key prediction of the model is that
in response to a tax on borrowing for the regulated sphere, borrowing by the unregulated sphere
increases. The main normative insight is that this leakage phenomenon exerts two counteracting
forces on the magnitude of the optimal macroprudential tax on borrowing. On the one hand,
the leakage makes the macroprudential tax on the regulated sphere less effective because the
reduction in the regulated sphere’s indebtedness is partially offset by an increase in borrowing by
  10
    Under commitment, there would be an additional effect. Defining ϕ∗ (τRc ) as the threshold satisfying W U (τRc )−
 ∗
ϕ (τRc ) = W R (τRc ) and denoting the cumulative density of ϕ by F , the planner would solve
                 Z   ϕ∗ (τ )
                               ϕdF + (1 − F (ϕ∗ (τ )) δ −BU 1 + βE0 VU 1 y1T (s), BU 1 , BR1
                                                                                            
       max −
     BR1 ,BU 1   0
                                                                  + F (ϕ∗ (τ )) −BR1 + βE0 VR1 y1T (s), BU 1 , BR1 . (25)
                                                                                                                 


The expression for the optimal tax would internalize the effect of the tax on the extent of circumvention, as
captured by the term F (ϕ∗ (τ )).



                                                                17
the unregulated sphere. On the other hand, the leakages make the macroprudential tax introduce
a new distortion that takes the form of an even more excessive indebtedness of the unregulated
sphere. Correcting this distortion requires reducing the economy’s indebtedness further and
therefore calls, paradoxically, for even tighter borrowing restrictions on the regulated sphere.


3     Quantitative Model
In this section, we embed the leakage phenomenon into a canonical quantitative model of financial
crisis. The goal is to assess the extent to which leakages limit the ability of macroprudential
regulation to reduce the exposure to financial crisis and to study how leakages affect the optimal
policy design. From a theoretical perspective, an additional element emerges in the infinite
horizon model. Given the forward-looking nature of the unregulated agents’ problem, these
agents’ borrowing decision depends not only on current regulation but also on their expectation
of future regulation. As a result, a new time inconsistency problem emerges that would not be
present with perfect enforcement of regulation.

3.1    Preferences and constraints in the infinite horizon model
As in the three-period model, there are two types of agents with identical preferences and en-
dowments, who only differ on whether they are subject to borrowing taxes. Preferences are given
by
                                          X∞
                                       E0     β t u(cit ),                                 (26)
                                              t=0

where u(·) is a standard concave, twice continuously differentiable function that satisfies the Inada
condition. The consumption basket c is an Armington-type CES aggregator with elasticity of
substitution 1/(η + 1) between tradable goods cT and nontradable goods cN , given by
                         h
                               T −η
                                                     i− η1
                                                    N −η
                     c= ω c           + (1 − ω) c              , η > −1, ω ∈ (0, 1).

In each period t, agents receive endowments of tradable goods ytT and nontradable goods ytN and
choose a one-period non-state-contingent bond denominated in units of tradables. The vector of
                          0
endowments y ≡ y T , y N ∈ Y ⊂ R++   2
                                        follows a first-order Markov process. The agents’ budget
constraints and credit constraints are given by
                           bit+1
                                     + cTit + pN  N           T    N N
                                               t cit = bit + yt + pt yt + Tit                   (27)
                         R(1 + τit )

and
                                      bit+1 ≥ −κ pN  N    T
                                                            
                                                  t yt + yt .                                   (28)

    As in the three-period model, we assume that τU t = TU t = 0 for all t ≥ 0. Given a tax

                                                    18
policy {τRt , TRt }t≥0 and initial levels of debt bU 0 , bR0 , a competitive equilibrium is defined as
a stochastic sequence of prices {pN                                         T  N
                                      t }t≥0 and households’ policies {cit , cit , bit+1 }t≥0,i∈{U,R} such
that (i) households maximize (26) subject to sequences of budget constraints (27) and credit
constraints (28), (ii) the market clears for nontradable goods (γcN                   N      N
                                                                      U t + (1 − γ)cRt = yt ), and (iii)
the government budget constraint holds TR = − bRRt 1+τ      τ
                                                               
                                                                 .11


3.2     Optimal time-consistent regulated equilibrium
As in Section 2.5, we consider the problem of a planner choosing the tax policy that delivers the
highest welfare in the regulated equilibrium.
    We assume that the planner makes decisions sequentially and without commitment, and we
study Markov-perfect equilibria. Focusing on a discretionary regime is useful for our purpose
given our goal of studying how leakages can undermine the effectiveness of regulation. We
let X = {BU , BR , y T , y N } denote the aggregate state vector of the economy, BR (X) denote
the policy rule for regulated bond holdings of future planners that the current planner takes
               
as given, and BU (X), CRT (X), CUT (X), CRN (X), CUN (X), P N (X) denote the associated recursive
functions returning unregulated agents’ bond holdings, consumption allocations, and the price
of nontradables under this policy rule.12
    The forward-looking nature of unregulated agents’ borrowing decisions introduces a time
consistency problem. To see why, consider the Euler equation of unregulated agents when it
holds with equality:
                                                           0      0
                               uT cTU , cN             T        N
                                                                   
                                         U = βREuT CU (X ), CU (X ) .                        (29)

As was the case of constraint (19) in the three-period model, this constraint is a key imple-
mentability constraint for the government in the infinite horizon model. It captures the spillover
effects from the planner’s debt choice for R agents onto U agents’ debt choice. However, in the
infinite horizon context where the planner regulates the economy in every period, this imple-
mentability constraint depends on next period’s regulatory policy. For example, a policy that
induces low consumption of U agents tomorrow (through a low tax on R agents in t + 1) will
indirectly push down these agents’ consumption today and moderate the overborrowing exter-
nality in the present. Moreover, if unregulated agents expect loose regulation in the future, they
have incentives to accumulate more precautionary savings today and borrow less. Tomorrow,
however, the planner acting without commitment will not internalize the benefits of such a loose
tax policy over previous periods.13
  11
     The definition of equilibrium in recursive form is given in Appendix C.
  12
     Notice that by a form of block recursivity, once the policy for regulated bond holdings is chosen, the rest of
the equilibrium objects can be obtained from the implementability constraints.
  13
     The time-inconsistency problem of macroprudential policy that we highlight is distinct from the one in Bianchi
and Mendoza (2018). In that paper, a time-inconsistency problem arises because of the presence of asset prices,
a forward-looking object, in collateral constraints. Here instead, it is due to imperfect regulation enforcement.


                                                        19
    Following again the primal approach adopted in the three-period model context (see Section
2.5), assuming a utilitarian objective, the optimal time-consistent (TC) planner’s problem can
be described by the following Bellman equation:

                                          γu c cTU , cN        + (1 − γ)u c cTR , cN          + βEV(X 0 )
                                                                                       
    V(X) =             max                            U                            R                         (Optimal TC)
              {cT   N 0               N
                i ,ci ,bi }i∈{U,R} ,p


                                                               subject to
                                                          b0i
                                      cTi + pN cN
                                                i +           = bi + y T + p N y N        for       i ∈ {U, R}
                                                          R
                                                          b0i ≥ −κ pN y N + y T
                                                                                     
                                                                                              for    i ∈ {U, R}
                                                          cTi
                                                      cN
                                                      Ti =         T
                                                                     yN    for i ∈ {U, R}
                                                    γcU + (1 − γ)cR
                                                                            η+1
                                                    1 − ω γcTU + (1 − γ)cTR
                                                         
                                                 N
                                                p =
                                                      ω            yN
                                                                  0      0
                                     uT cTU , cN               T       N
                                                                           
                                                U ≥ βREuT CU (X ), CU (X )
                             0                                                 0      0
                             bU + κ pN y N + y T × uT cTU , cN               T     N
                                                                                     
                                                              U − βREuT CU (X ), CU (X )    = 0.
                                                    
A Markov equilibrium is defined by policy functions BR (X)BU (X), CRT (X), CUT (X), CRN (X), CUN (X) ,
a value function V(X), and a pricing function P N (X) such that the value function and policy
                                                      
functions solve (Optimal TC) given perceived policies Bi (X), CiT (X), CiN (X) for i ∈ {U, R}
and P N (X).

3.3     Calibration
The calibration follows Bianchi (2011). The time period is one year. A first subset of parameters
is set independently using standard values from the literature: σ = 2, r = 0.04, 1/(η + 1) = 0.83,
and the endowment process is estimated based on the HP-filtered component of tradable and
nontradable GDP for Argentina. Assuming a first-order bivariate autoregressive process: ln y =
                                     0
ρ ln yt−1 + εt , where εt = εTt , εTt ∼ N (0, Σε ), we obtain the estimates
                          "                 #             "                 #
                            0.901 −0.453                    0.00219 0.00162
                      ρ=                            Σε =                      .
                            0.495 0.225                     0.00162 0.00167

The second subset of parameters {β, ω, κ} is set to match Argentina’s average net foreign asset
position, the share of nontradable output in Argentina, and the average frequency of financial
crises for emerging markets.14 This yields β = 0.91, ω = 0.31, κ = 0.32.
Other contributions studying optimal policy problems with Markov perfect equilibria include Klein, Quadrini and
Rios-Rull (2005), Klein, Krusell and Rios-Rull (2008), and Debortoli, Nunes and Yared (2017).
  14
     In both the model and the data, financial crises are defined as episodes in which the current account increases
by more than one standard deviation.

                                                                  20
   Finally, we solve our regulated equilibrium for different values of γ. For the most part, we
focus on values of γ ranging from 0 to 0.5. A value of 0.5 entails a substantial amount of leakages
by which 50% of the economy can evade regulation. Moreover, a value of γ = 0.5 is the value at
which the losses from a dispersion in consumption across agents are given the highest weight by
the planner.

                                      Table 1: Calibration
                                 Value                   Source/Target
      Interest rate              r = 0.04                Standard value
      Risk aversion              σ=2                     Standard value
      Elasticity of substitution 1/(1 + η) = 0.83        Conservative value
      Weight on tradables in CES ω = 0.31                Share of tradable output=32%
      Discount factor            β = 0.91                Average NFA-GDP ratio = −29%
      Credit coefficient         κT = 0.32               Frequency of crises = 5.5%
      Size of unregulated sector γ = [0, 0.5]            Baseline range



3.4    Numerical solution
The computation of the optimal regulated equilibrium follows a nested fixed point algorithm,
common to those used in studies of Markov perfect equilibria (e.g. Bianchi and Mendoza, 2018).
For a given conjectured policy followed by governments in the future, we solve for the current
optimal policy using value function iteration. Using this solution, we update our conjectured
policy. We iterate until the optimal policy coincides with the conjectured policy to obtain a
Markov-perfect equilibrium. Details are provided in Appendix D.

3.5    Overborrowing and leakages
We start our quantitative analysis by looking at how the distribution of debt of regulated and
unregulated agents differs across regimes. To show this, we conduct a 10,000-period simulation
for the unregulated equilibrium, the constrained-efficient allocation and the regulated equilibrium
for γ = 0.5 and provide a scatterplot of the bond positions.
    Panels (a) and (b) of Figure 5 correspond to the scatterplots of bond positions in the unregu-
lated equilibrium and constrained-efficient allocation. Vertical and horizontal lines show sample
averages. Because there is no distinction between U and R agents in these economies, all the
points line up on the 45-degree line. One can see, as expected, that the unregulated equilib-
rium displays simulations with higher levels of debt, which in turn are associated with a larger
frequency and severity of financial crises.
    Panel (c) of Figure 5 displays the case of the regulated equilibrium for γ = 0.5. In this case,
most pairs of bond positions are located below the 45-degree line, indicating higher levels of debt


                                                21
    (a) Unregulated equilibrium        (b) Constrained efficient    (c) Macropru w/leakages (γ = 0.5)




Figure 5: Scatterplots of debt positions in unregulated equilibrium, constrained-efficient alloca-
tion, and macroprudential policy with leakages.

for unregulated agents than for regulated agents. Interestingly, many simulation periods display
levels of debt for unregulated agents that are much higher than the maximum values of debt
observed in the unregulated equilibrium. This is the leakage effect at play: regulation worsens
the overborrowing problem for unregulated agents. Conversely, regulated agents’ borrowing in
the regulated equilibrium with leakages is lower on average than in the constrained-efficient
equilibrium. This suggests that the planner (at least partially) compensates for the unregulated
agents’ extra borrowing by commanding less borrowing for regulated agents.

3.6    Frequency and severity of crises
Next, we study the extent to which leakages undermine the effectiveness of regulation at reducing
the vulnerability to financial crises. We define financial crises as episodes in which the current
account increases by more than one standard deviation (or, equivalently, credit falls by more
than one standard deviation). Based on this definition, we study how the probability of crises
varies in regulated equilibria associated with a range of values for γ, and compare the severity
of crises in a regulated equilibrium where γ = 0.5 to the severity in the constrained-efficient
allocation and unregulated equilibrium.
    Figure 6 shows how the frequency of financial crises changes with the size of the unregulated
sphere γ. In the absence of leakages (i.e., when γ = 0), the frequency of crises is about 0.5%,
which is about 1/10th of the frequency of crises in the unregulated equilibrium. As expected,
the frequency of crises increases with γ. Quite strikingly, however, the increase is very modest
even for values of γ as large as 0.5. This suggests that as γ increases, the planner adjusts its
desired borrowing for regulated agents to offset the effect of leakages and achieve a given level of
financial stability.
    To study how leakages alter the government’s ability to reduce the severity of financial crises
using macroprudential regulation, we construct a comparable event analysis following a procedure
similar to Bianchi and Mendoza (2018). First, we simulate the decentralized equilibrium for a


                                                  22
                        6



                        5



                        4

                                unregulated equilibrium
                        3       constrained efficient
                                macropru w/leakages

                        2



                        1



                        0
                            0        10           20           30         40   50
                                      Fraction    of unregulated agents (%)


               Figure 6: Long-run frequency of financial crises as a function of γ.

large number of periods, identify all the financial crisis episodes, and construct 11-year window
events centered on the financial crisis episodes. Second, we take the average of key variables
across the window period for the decentralized equilibrium. Third, we feed in the initial state
and shock sequence that characterizes all financial crises in the unregulated equilibrium to the
policy functions of the regulated equilibrium. We do this for two degrees of leakages: γ = 0,
which corresponds to the constrained-efficient allocation, and γ = 0.5. Finally, we average the
key variables across the window period for the regulated equilibria. This experiment allows us
to do a counterfactual analysis that highlights how leakages lead to different financial crises
dynamics, controlling for the same sequence of shocks and the same initial states.
    Figure 7 shows the results of these simulations. In the top panels, we plot the income shocks,
the current account to GDP ratio, and the real exchange rate. In the bottom panels, we show the
debt of regulated agents, the debt of unregulated agents, and the optimal tax. All the plotted
paths correspond to averages across all the simulation samples from the event analysis. The
unregulated equilibrium (solid line) clearly displays a larger decline in credit and a larger current
account reversal, as well as a larger collapse in the real exchange rate (defined as the inverse of
the price of the composite good). The crises are preceded by increases in the amount of credit
and negative income shocks, and are triggered on impact by income shocks that are about 1.5
standard deviations on average. In contrast, the constrained-efficient equilibrium (dashed line)
displays a much smaller decline in credit (1% percent versus 10% for the unregulated equilibrium)
and a much smaller decline in the real exchange rate. Note that these differences in the event
dynamics emerge despite the two economies having the same initial conditions and being subject
to the same shock sequence.
    In terms of aggregate variables, one can see that the regulated equilibrium for γ = 0.5 (macro-

                                                          23
                           (a) Income                                                           (b) Current account to GDP (%)                                                            (c) Real exchange rate
1.02                                                                                       10                                                                               3.6


  1                                                                                         8                                                                               3.4

                                                                                            6
0.98                                                                                                                                                                        3.2

                                                                                            4
0.96
                                                                                                                                                                             3
                                                                                            2
0.94
                                                                                                                                                                            2.8
                                                                                            0
0.92
                                                                                                      unregulated equilibrium                                               2.6
                                                                                           -2
           tradable income                                                                            constrained efficient
 0.9       non-tradable income                                                                        macropru w/leakages
                                                                                           -4                                                                               2.4
   t-5   t-4   t-3    t-2     t-1         t       t+1         t+2     t+3     t+4    t+5     t-5    t-4    t-3   t-2   t-1      t   t+1     t+2     t+3       t+4     t+5     t-5   t-4    t-3   t-2   t-1   t   t+1   t+2   t+3   t+4   t+5




               (d) Debt of R agents                                                                        (e) Debt of U agents                                                            (f) Optimal tax (%)
  1                                                                                             1                                                                           10

                                                                                                                                                                             9
0.95                                                                                       0.95
                                                                                                                                                                             8

                                                                                                                                                                             7
 0.9                                                                                        0.9
                                                                                                                                                                             6

0.85                                                                                       0.85                                                                              5

                                                                                                                                                                             4
 0.8                                                                                        0.8
                                                                                                                                                                             3

                                                                                                                                                                             2
0.75                                                                                       0.75
                                                                                                                                                                             1

 0.7                                                                                        0.7                                                                              0
   t-6   t-5   t-4   t-3    t-2     t-1       t         t+1     t+2     t+3    t+4            t-6    t-5   t-4   t-3   t-2   t-1    t     t+1     t+2   t+3     t+4           t-5   t-4   t-3    t-2   t-1   t   t+1   t+2   t+3   t+4   t+5



                                                                                                    Figure 7: Event analysis.

prudential policy with leakages, dash-dotted line) is much closer to the constrained-efficient equi-
librium than to the unregulated equilibrium. This is consistent with the message from Figure
6 that the frequency of crises increases only modestly with γ. That is, overall, neither the fre-
quency nor the severity of financial crises increases substantially with leakages, even when as
much as 50% of the economy is left unregulated. However, these aggregate results hide impor-
tant disparities between the debt dynamics of the regulated and unregulated spheres across the
event window. Both debt positions start at exactly the same level (by construction), but unreg-
ulated agents start accumulating debt very rapidly (panel e), while regulated agents reduce their
indebtedness at a significantly faster pace than in the constrained-efficient equilibrium. Higher
taxes than in the constrained-efficient case (panel f), together with stronger precautionary mo-
tives due to the spillback effects from unregulated agents’ overborrowing, generates this sharp
deleveraging by regulated agents in the run-up to the crisis event.

3.7            Welfare effects
Finally, we study the welfare implications of macroprudential policy with leakages, focusing on
two key questions: By how much does average welfare fall because of the presence of leakages?
How are the welfare benefits of macroprudential policy distributed across regulated and unregu-
lated agents?


                                                                                                                             24
                        Unconditional welfare
0.25                                                                                       Welfare during Sudden Stops (γ = 0.5)
                                                                                0.25
                                                               U agents                                                       constrained efficient
                                                                                                                              macropru w/leakages
 0.2
                                                                                 0.2 U agents


0.15
                                                                                0.15
                                                                average
 0.1                                                                                   average
                                                                                 0.1


0.05
                                                               R agents
                                                                                0.05
             constrained efficient
             macropru w/leakages                                                       R agents
  0
       0   0.05   0.1   0.15   0.2   0.25   0.3   0.35   0.4    0.45      0.5
                                                                                  0
                  Fraction     of unregulated agents (%)                           t-5     t-4    t-3   t-2   t-1   t   t+1    t+2    t+3   t+4       t+5


            Figure 8: Welfare gains from macroprudential policy in the presence of leakages.
Note: Welfare gains are computed in consumption equivalence terms and expressed in percentages.


    Figure 8 displays measures of the welfare effects of macroprudential policy. In the left panel,
we report the unconditional welfare gains of moving from the unregulated equilibrium to the
regulated equilibrium for different degrees of leakages. We report welfare gains by agent type, as
well as average welfare gains.15 For comparison, we also show the welfare gains of moving from
the unregulated equilibrium to the constrained-efficient allocation, which are of course the same
for regulated and unregulated agents. A first observation is that the average welfare gains of
being in the regulated equilibrium decrease with the size of the unregulated sector. This finding
is natural, since with larger γ, the planner directly controls a smaller share of the economy
and thus becomes less effective at correcting the overborrowing externality. However, it is also
apparent that the decline in the average welfare gains associated with leakages is modest. This
suggests that macroprudential policy remains not only effective but also desirable, even with
significant leakages.
    This figure also reveals interesting insights about the distribution of these welfare effects
across the two spheres. First, welfare gains are higher for unregulated agents than for regulated
agents. For small values of γ, the welfare gains of macroprudential policy are about twice as
large for unregulated agents. The intuition is straightforward: unregulated agents enjoy the
same financial stability benefits of macroprudential regulation as regulated agents, but unlike
the latter, they do not bear the costs that arise from lower consumption ahead of (potential)
future crises. Second, welfare gains for regulated agents fall sharply as γ gets larger. Intuitively,
  15
    To compute unconditional gains, we first compute, for every possible state (BU , BR , y T , y N ), the propor-
tional increase in consumption across all possible future histories that would make households indifferent between
remaining in the unregulated equilibrium and switching to the regulated equilibrium with leakages. Then, we
compute the mean of this variable in the simulations.


                                                                           25
larger leakages imply that more unregulated agents overborrow and therefore impose a larger
externality on regulated agents, who bear a more concentrated cost regulation.
    The right panel of Figure 8 complements this analysis by representing the welfare gains of
macroprudential policy with leakages (for γ = 0.5), but through the event windows of Section 3.6
rather than unconditionally. The results are broadly consistent with the unconditional analysis,
with unregulated agents capturing the lion’s share of the gains. In addition, it is apparent that
the increase in the welfare gains of macroprudential policy in the run-up to a crisis event falls
disproportionately on unregulated agents. This strengthens the conclusion that these agents
become the main beneficiaries of macroprudential policy when leakages are large.


4    Conclusion
This paper conducted an investigation of macroprudential policies with limited regulation en-
forcement. We characterize the optimal policy for different degrees of enforcement and examine
the extent to which leakages undermine the effectiveness of capital flow management. Our results
show that the presence of leakages does not necessarily call for weaker intervention, as commonly
argued in policy discussions. Instead, our framework suggests that a stronger intervention may
well be needed. Quantitative results show that, thanks to a larger intervention, macroprudential
policy remains highly effective at reducing the vulnerability to financial crises.
    Even though we conduct our analysis in a small open economy model featuring excessive
external borrowing, we think that our insights regarding the two-way interaction between the
regulated and unregulated spheres of the economy and the trade-offs that emerge for optimal
regulation are likely to apply to a general class of models in which either financial or nominal
frictions generate excessive risk taking from a social point of view. Studying the interaction
of these frictions and exploring alternative policy responses is an interesting agenda for future
research.




                                               26
References
Acharya, Sushant and Julien Bengui, “Liquidity Traps, Capital Flows,” Journal of Inter-
 national Economics, 2018, 114, 276–298.

Ahnert, Toni, Kristin J Forbes, and Dennis Reinhardt, “Macroprudential FX Regula-
 tions: Shifting the Snowbanks of FX Vulnerability?,” 2018. Mimeo, MIT Sloan.

Aiyar, Shekhar, Charles W Calomiris, and Tomasz Wieladek, “Does macro-pru leak?
 Evidence from a UK policy experiment,” Journal of Money, Credit and Banking, 2014, 46.

Bengui, Julien, “Macro-Prudential Policy Coordination,” 2013. University of Montreal.

  , Javier Bianchi, and Louphou Coulibaly, “Financial Safety Nets,” International Eco-
  nomic Review, 2019.

Benigno, Gianluca, Huigang Chen, Christopher Otrok, Alessandro Rebucci, and
 Eric R. Young, “Financial Crises and Macro-Prudential Policies,” Journal of International
 Economics, 2013, 89 (2), 453–470.

Bianchi, Javier, “Overborrowing and Systemic Externalities in the Business Cycle,” American
  Economic Review, 2011, 101 (7), 3400–3426.

   and Enrique G Mendoza, “Optimal time-consistent macroprudential policy,” Journal of
  Political Economy, 2018, 126 (2), 588–634.

  , Chenxin Liu, and Enrique G Mendoza, “Fundamentals news, global liquidity and
  macroprudential policy,” Journal of International Economics, 2016, 99, S2–S15.

  , Emine Boz, and Enrique Gabriel Mendoza, “Macroprudential policy in a Fisherian
  model of financial innovation,” IMF Economic Review, 2012, 60 (2), 223–269.

Caballero, Ricardo J. and Arvind Krishnamurthy, “International and Domestic Collateral
 Constraints in a Model of Emerging Market Crises,” Journal of Monetary Economics, 2001,
 48 (1), 513–548.

Cerutti, Eugenio, Stinj Claessens, and Luc Laeven, “The use and effectiveness of macro-
 prudential policies: New evidence,” Journal of Financial Stability=, 2017, 28.

Coulibaly, Louphou, “Monetary Policy in Sudden Stop-Prone Economies,” Technical Report
 2018.

Dassatti, Cecilia and José-Luis Peydró, “Macroprudential and Monetary Policy: Loan-Level
 Evidence from Reserve Requirements,” 2013. Mimeo, Central Bank of Uruguay.

                                            27
Debortoli, Davide, Ricardo Nunes, and Pierre Yared, “Optimal time-consistent govern-
 ment debt maturity,” The Quarterly Journal of Economics, 2017, 132 (1), 55–102.

Devereux, Michael B, Eric R Young, and Changhua Yu, “Capital controls and monetary
 policy in sudden-stop economies,” Journal of Monetary Economics, 2018.

Farhi, Emmanuel and Ivan Werning, “Dealing with the trilemma: Optimal capital controls
  with fixed exchange rates,” 2012. NBER Working Paper.

   and Iván Werning, “A theory of macroprudential policies in the presence of nominal rigidi-
  ties,” Econometrica, 2016, 84 (5), 1645–1704.

   and Ivan Werning, “Fiscal Unions,” American Economic Review, 2017, 107 (12), 3788–
  3834.

   and Jean Tirole, “Shadow Banking and the Four Pillars of Traditional Financial Interme-
  diation,” 2017. Working Paper.

Flemming, Jean, Jean-Paul LHuillier, and Facundo Piguillem, “News and Macropru-
  dential Policy,” 2016.

Forbes, Kristin J., Marcel Fratzscher, and Roland Straub, “Capital Controls and Macro-
  prudential Measures: What Are They Good For?,” 2013. MIT Sloan.

Fornaro, Luca, “Financial crises and exchange rate policy,” Journal of International Economics,
  2015, 95 (2), 202–215.

   and Federica Romei, “The paradox of global thrift,” 2018. Mimeo, CREi.

Grochulski, Borys and Yuzhe Zhang, “Optimal Liquidity Regulation with Shadow Bank-
 ing,” 2015. Working paper WP 15-12R, Federal Reserve Bank Richmond.

Huang, Ji, “Banking and shadow banking,” 2014. Mimeo,.

Jeanne, Olivier and Anton Korinek, “Managing Credit Booms and Busts: A Pigouvian
  Taxation Approach,” 2012. NBER Working Paper 16377.

Jiménez, Gabriel, Steven Ongena, José-Luis Peydró, and Jesús Saurina, “Macro-
  prudential policy, countercyclical bank capital buffers and credit supply: Evidence from the
  Spanish dynamic provisioning experiments,” Journal of Political Economy, 2012.

Klein, Michael W, “Capital controls: Gates versus walls,” 2012. NBER Working Paper.

Klein, Paul, Per Krusell, and Jose-Victor Rios-Rull, “Time-consistent public policy,” The
 Review of Economic Studies, 2008, 75 (3), 789–808.

                                              28
  , Vincenzo Quadrini, and Jose-Victor Rios-Rull, “Optimal time-consistent taxation
  with international mobility of capital,” Advances in Macroeconomics, 2005, 5 (1).

Korinek, Anton, “Regulating capital flows to emerging markets: An externality view,” Journal
 of International Economics, 2018, 111, 61–80.

   and Alp Simsek, “Liquidity Trap and Excessive Leverage,” American Economic Review,
  2016, 106 (3), 699–738.

Lorenzoni, Guido, “Inefficient Credit Booms,” Review of Economic Studies, 2008, 75 (3),
  809–833.

Magud, Nicolas E., Carmen M. Reinhart, and Kenneth S. Rogoff, “Capital Controls:
 Myth and Reality - A Portfolio Balance Approach,” 2011. NBER.

Mendoza, Enrique G., “Credit, Prices, and Crashes: Business Cycles with a Sudden Stop,” in
 S. Edwards and J. Frankel, eds., Preventing Currency Crises in Emerging Markets, University
 of Chicago Press, 2002.

Ordonez, Guillermo, “Sustainable Shadow Banking,” American Economic Journal: Macroe-
 conomics, 2018, 10 (1), 33–56.

   and Facundo Piguillem, “Retirement in the Shadow (Banking),” 2018. Mimeo.

Ottonello, Pablo, “Optimal exchange rate policy under collateral constraints and wage rigid-
 ity,” manuscript, Columbia University, 2015.

Plantin, Guillaume, “Shadow Banking and Bank Capital Regulation,” Review of Financial
  Studies, 2015, 28 (1), 146–175.

Reyes-Heroles, Ricardo and Gabriel Tenorio, “Macroprudential Policy in the Presence of
 External Risks,” 2018. Mimeo, Board of Governors.

Schmitt-Grohé, Stephanie and Martın Uribe, “Downward Nominal Wage Rigidity, Cur-
  rency Pegs, and Involuntary Unemployment,” 2013. NBER Working Paper.

  and Martı́n Uribe, “Multiple equilibria in open economy models with collateral constraints:
  Overborrowing revisited,” Technical Report, National Bureau of Economic Research 2016.

   and , “Is Optimal Capital Control Policy Countercyclical in Open Economy Models with
  Collateral Constraints?,” IMF Economic Review, 2017, 65 (3), 498–527.

Seoane, Hernan D. and Emircan Yurdagul, “On Overborrowing: Trend Shocks and Capital
  Controls,” 2017. Unversidad Carlos III de Madrid Mimeo.

                                             29
Sergeyev, Dmitriy, “Optimal macroprudential and monetary policy in a currency union,”
  Manuscript, Universita Bocconi, 2016.

Stavrakeva, Vania, “Optimal bank regulation and fiscal capacity,” 2017. Mimeo, London
  Business School.




                                         30
A      Formal characterization of continuation equilibria
Lemma 2. For x ∈ {cc, uc, cu, uu}, aggregate date 1 consumption in region x is given by C1T (s) =
 x T
αy1 y1 (s) + αUx BU 1 + αR
                         x        x T
                           BR1 + αy2 y2 .

Proof. See Appendix B.2.

    Lemma 2 says that, within each region, date 1 aggregate consumption is linear in each of
the aggregate state variables (y1T (s), BU 1 , BR1 ). Date 2 aggregate consumption follows from the
economy’s intertemporal resource constraint (15) and is therefore also linear in (y1T (s), BU 1 , BR1 ).
Finally, according to (16), the equilibrium prices pN               N                  T           T
                                                       1 (s) and p2 (s) are linear in C1 (s) and C2 (s)
(respectively) and therefore also linear in (y1T (s), BU 1 , BR1 ). The next lemma characterizes the
aggregate consumption solution in more detail.

Lemma 3. The coefficients of the decision rule for C1T (s) are such that:
       x
   1. αy1 > 0 and αUx , αRx    x
                            , αy2                          x
                                  ≥ 0 with αUx = 0 (resp. αR = 0) iff γ = 0 (resp. γ = 1), and
       x
      αy2 = 0 iff x = cc.
                                                    uu     cu    uc    cc           uu    uc    cu
   2. if 0 ≤ γ ≤ 0.5 (resp. 0.5 ≤ γ ≤ 1), then αy1     ≤ αy1  ≤ αy1 ≤ αy1 , (resp. αy1 ≤ αy1 ≤ αy1 ≤
        cc
      αy1 ), with strict inequalities if 0 < γ < 0.5 (resp. 0.5 < γ < 1).

   3. αUuu ≤ αUcu ≤ αUcc and αUuu ≤ αUuc ≤ αUcc , with strict inequalities iff γ > 0.
       uu    cu    cc      uu    uc    cc
   4. αR  ≤ αR  ≤ αR  and αR  ≤ αR  ≤ αR  , with strict inequalities iff γ < 1.

Proof. See Appendix B.3.

   Part 1. of Lemma 3 establishes that aggregate consumption is increasing in each of the three
aggregate state variables (y1T (s), BU 1 , BR1 ), always strictly for y1T (s), and strictly for BU 1 unless
γ = 0 and for BR1 unless γ = 1. Part 2. of the lemma says that aggregate tradable consumption
is more sensitive to tradable income in the regions where the credit constraints are binding.
Similarly, parts 3. and 4. establish that aggregate tradable consumption is more sensitive to the
two sets of agents’ wealth positions in the regions where the credit constraints are binding.
   We define an individual’s credit constraint set as the set of tradable endowment realizations
such that her credit constraint is binding:

Q(bi1 ; BU 1 , BR1 , x) ≡ y1T (s) ∈ R+ |bunc bi1 ; y1T (s), BU 1 , BR1 , x < bcon bi1 ; y1T (s), BU 1 , BR1 , x .
                                                                                                             
                                         i2                                   i2


where x ∈ {cc, uc, cu, uu} denotes the region in which the economy is and determines the mapping
between (y1T (s), BU 1 , BR1 ) and (pN       N                           unc     con
                                     1 (s), p2 (s)) relevant to compute bi2 and bi2 . The four regions




                                                       31
can hence be represented by the following sets:

                   X cc (BU 1 , BR1 ) ≡ Q(BU 1 ; BU 1 , BR1 , cc) ∩ Q(BR1 ; BU 1 , BR1 , cc),              (A.1)
                 X uc (BU 1 , BR1 ) ≡ Qc (BU 1 ; BU 1 , BR1 , uc) ∩ Q(BR1 ; BU 1 , BR1 , uc),              (A.2)
                 X cu (BU 1 , BR1 ) ≡ Q(BU 1 ; BU 1 , BR1 , cu) ∩ Qc (BR1 ; BU 1 , BR1 , cu),              (A.3)
               X uu (BU 1 , BR1 ) ≡ Qc (BU 1 ; BU 1 , BR1 , uu) ∩ Qc (BR1 ; BU 1 , BR1 , uu).              (A.4)

Further, we define unions of some of these sets as X c? ≡ X cc ∪ X cu , X ?c ≡ X cc ∪ X uc , X u? ≡
X uu ∪ X uc and X ?u ≡ X uu ∪ X cu . These sets have some intuitive properties, summarized in the
following lemmas.

Lemma 4. There are thresholds ax and bx satisfying 0 ≤ ax ≤ bx (with ax = bx iff BU 1 = BR1 )
such that y1T (s) ∈ X cc iff y1T (s) < ax , y1T (s) ∈ X uu iff y1T (s) ≥ by , y1T (s) ∈ X cu iff ax ≤ y1T (s) < bx
and BU 1 < BR1 ; and y1T (s) ∈ X uc iff ax ≤ y1T (s) < bx and BU 1 > BR1 .

Proof. See Appendix B.4.

    Lemma 4 says that for a given pair (BU 1 , BR1 ), the regions are ordered along the real line,
that the poorest type of agents is never unconstrained when the other type is constrained, and
that when both types of agents have the same wealth only the symmetric regions cc and uu can
arise. It notably implies that X cc , X uc , X cu and X uu are disjoint, and that their union is R+ ,
meaning that for any triplet (y1T (s), BU 1 , BR1 ) the economy is always in one and only one region.
Finally, the next lemma offers comparative statics results.

Lemma 5. For a given BU 1 (resp. BR1 ) and any two BR1 , B̃R1 (resp. BU 1 , B̃U 1 ) such that
BR1 < B̃R (resp. BU 1 < B̃U ):

   1. for X = {X cc , X c? , X ?c }, if y1T (s) ∈ X (BU 1 , B̃R1 ) (resp. y1T (s) ∈ X (B̃U 1 , BR1 )), then
      y1T (s) ∈ X (BU 1 , BR1 ).

   2. for X = {X uu , X u? , X ?u }, if y1T (s) ∈ X (BU 1 , BR1 ), then y1T (s) ∈ X (BU 1 , B̃R1 ) (resp.
      y1T (s) ∈ X (B̃U 1 , BR1 )).

Proof. See Appendix B.5.

   Part 1. of Lemma 5 says that the region X cc where both types of agents are credit constrained,
and the regions X c? and X ?c where at least one type of agents is constrained are all shrinking in
BR1 and BU 1 . Part 2. says that the region X uu where both types of agents are unconstrained,
and the regions X u? and X ?u where at least one type of agents is unconstrained are all expanding
in BR1 and BU 1 .




                                                       32
A.1      Price and consumption functions
The price functions are related to the aggregate tradable consumption function, given in Lemma
2, by
                                                   1 − ω C1T (y1T (s), BU 1 , BR1 )
                       pN
                        1 (y T
                             1 (s), BU 1 , BR1 ) =                                  ,
                                                     ω              yN
and
                                                                                         y2T
                             (1 − ω)(1 + r) (1 + r)[γBU 1 + (1 − γ)BR1 ] + y1T (s) +    1+r
                                                                                               − C1T (y1T (s), BU 1 , BR1 )
pN   T
 2 (y1 (s), BU 1 , BR1 )   =                                                                                                  .
                                   ω                                        yN
    The remaining consumption functions are related to these price functions but the relationships
depend on which agents are constrained and unconstrained.
    When U agents are unconstrained (i.e., in regions uu and uc), their consumption functions
are given by

       CUT 1 (y1T (s), BU 1 , BR1 ) = CUT 2 (y1T (s), BU 1 , BR1 ) =
                                                                        y2T + pN   T                    N
                                                                                                         
              ω                       T            N   T             N         2 (y1 (s), BU 1 , BR1 )y
       =             (1 + r)BU 1 + y1 (s) + p1 (y1 (s), BU 1 , BR1 )y +                                     ,
          1+β                                                                        1+r

and
                                             1−ω
CUNt (y1T (s), BU 1 , BR1 ) =
                                 (1 + β)pN   T
                                         t (y1 (s), BU 1 , BR1 )
                                                                                      y2T + pN   T                    N
                                                                                                                       
                                                  T        N   T                   N         2 (y1 (s), BU 1 , BR1 )y
                                 × (1 + r)BU 1 + y1 (s) + p1 (y1 (s), BU 1 , BR1 )y +                                     ,
                                                                                                   1+r

for t = 1, 2. In contrast, when these agents are constrained (i.e., in regions cu and cc), their
consumption functions are given by

CUT 1 (y1T (s), BU 1 , BR1 ) = ω (1 + r)BU 1 + (1 + κ) y1T (s) + pN         T                    N
                                                                                                 
                                                                        1 (y1 (s), BU 1 , BR1 )y       ,
CUT 2 (y1T (s), BU 1 , BR1 ) = ω y2T + pN    T                   N                   T         N   T            N
                                                                                                                
                                         2 (y1 (s), BU 1 , BR1 )y − κ(1 + r) y1 (s) + p1 (y1 (s), BU 1 , BR1 )y      ,
                                                                 T           N  T                     N
                                                                                                         
                                      (1 + r)BU 1 + (1 + κ) y1 (s) + p1 (y1 (s), BU 1 , BR1 )y
CUN1 (y1T (s), BU 1 , BR1 ) = (1 − ω)                                                                      ,
                                                            pN   T
                                                             1 (y1 (s), BU 1 , BR1 )
                                                                                        T                             
  N      T                            y2T + pN    T                    N                             N   T
                                              2 (y1 (s), BU 1 , BR1 )y − κ(1 + r) y1 (s) + p1 (y1 (s), BU 1 , BR1 )y
                                                                                                                     N
CU 2 (y1 (s), BU 1 , BR1 ) = (1 − ω)                                                                                     .
                                                                      pN     T
                                                                        2 (y1 (s), BU 1 , BR1 )

   Similarly, when R agents are unconstrained (i.e., in regions uu and cu), their consumption
functions are given by

         T
       CR1                            T
           (y1T (s), BU 1 , BR1 ) = CR2 (y1T (s), BU 1 , BR1 ) =
                                                                      y2T + pN   T                    N
                                                                                                       
            ω                       T          N   T               N         2 (y1 (s), BU 1 , BR1 )y
       =            (1 + r)BR1 + y1 (s) + p1 (y1 (s), BU 1 , BR1 )y +                                     ,
          1+β                                                                      1+r


                                                       33
and

 N                                         1−ω
CRt (y1T (s), BU 1 , BR1 ) =
                               (1 + β)pN   T
                                       t (y1 (s), BU 1 , BR1 )
                                                                                   y2T + pN   T                    N
                                                                                                                    
                                               T        N   T                   N         2 (y1 (s), BU 1 , BR1 )y
                               × (1 + r)BR1 + y1 (s) + p1 (y1 (s), BU 1 , BR1 )y +                                     ,
                                                                                                1+r

for t = 1, 2. In contrast, when these agents are constrained (i.e., in regions uc and cc), their
consumption functions are given by

 T
    (y1T (s), BU 1 , BR1 ) = ω (1 + r)BR1 + (1 + κ) y1T (s) + pN            T                    N
                                                                                                 
CR1                                                                    1 (y 1 (s), BU 1 , BR1 )y       ,
 T
    (y1T (s), BU 1 , BR1 ) = ω y2T + pN     T                   N                   T          N    T          N
                                                                                                               
CR2                                     2 (y1 (s), BU 1 , BR1 )y − κ(1 + r) y1 (s) + p1 (y1 (s), BU 1 , BR1 )y      ,
                                                                T                                       
 N                                   (1 + r)BR1 + (1 + κ) y1 (s) + pN            T
                                                                             1 (y1 (s), BU 1 , BR1 )y
                                                                                                       N
CR1 (y1T (s), BU 1 , BR1 ) = (1 − ω)                                                                       ,
                                                           pN   T
                                                            1 (y1 (s), BU 1 , BR1 )
                                                                                       T                             
 N     T                             y2T + pN    T                    N                              N    T
                                             2 (y1 (s), BU 1 , BR1 )y − κ(1 + r) y1 (s) + p1 (y1 (s), BU 1 , BR1 )y
                                                                                                                    N
CR2 (y1 (s), BU 1 , BR1 ) = (1 − ω)                                                                                     .
                                                                     pN     T
                                                                       2 (y1 (s), BU 1 , BR1 )




B      Proofs
B.1      Proof of Lemma 1
Note that the private Euler equation (18) is given by g(bue     1 ) = 0, where
             Z ax                                             Z ∞
                               ω                     T                               ω
g(b) ≡ 1 −          cc T          cc      cc
                                               dF (y1 (s)) −         uu T          uu    uu        uu T
                                                                                                          dF (y1T (s))
              y   αy1 y1 (s) + (αU + αR )b                     ax αy1 y1 (s) + (αU + αR )b + αy2 y2

                        ω 1 − κ 1−ω                             ∞
             Z ax                                            Z
                                                     T                      ω(1 + β)
     = 1−                   T
                                   ω
                                               dF (y 1 (s)) −        T                     T
                                                                                             dF (y1T (s))
              y   (1  + κ)y 1 (s) +  (1 +  r)b                 ax  y 1 (s) + (1 + r)b + βy 2


g(b) is continuous, satisfies g(b) → −∞ for some finite b, limb→∞ g(b) = 1 > 0, and g 0 (b) > 0 for
the b range over which consumption is positive. It follows that there exists a single bue
                                                                                       1 for which
g(bue
   1 ) = 0.


B.2      Proof of Lemma 2
We consider each region in turn.
  cc In this case equilibrium is given by the system (12), (13), (14), (15) and (16). This system
     is block recursive in a linear system in C1T (s) and pN 1 (s). Solving this linear system yields
                                                  = (1 + κ)/ 1 − κ 1−ω                           1−ω
                                                                        cc                          
     the following coefficients for C1T (s): αy1
                                              cc
                                                                    ω
                                                                        , α U = γ(1 + r)/  1 − κ  ω
                                                                                                       ,
                                    1−ω
       cc
                                                cc
     αR = (1 − γ)(1 + r)/ 1 − κ ω and αy2 = 0.

  cu In this case equilibrium is given by the system (12) and (13) for i = U , (10) and (11)
     for i = R, (14), (15) and (16). This system is block recursive in a linear system in

                                                      34
      C1T (s), C2T (s), pN            N
                         1 (s) and p1 (s). Solving this linear system yields the following coefficients
                              γ(1+κ)+ 1−γ  1                 1
                                                     γ(1+r) 1+β (β+ 1−γ  +γ )                      1
                                                                                       (1−γ)(1+r) 1+β ( 1−γ +γ )
      for C1T (s): αy1cu
                          = 1−γ +γ 1−κ ω 1+β    cu
                                         1−ω , αU  =    1−γ
                                                                      ω
                                                                     1−ω      , α cu
                                                                                  R  =    1−γ
                                                                                                         ω
                                                                                                       1−ω       ,
                               ω    (     ω  )           ω
                                                            +γ ( 1−κ  ω  )                 ω
                                                                                              +γ (1−κ   ω  )
                   1−γ β
       cu           ω 1+β
      αy2 =   1−γ
                      1−κ 1−ω
                                    .
               ω
                  +γ (     ω    )
  uc In this case R agents are constrained, and equilibrium is given by the system (12) and
     (13) for i = R, (11) and (10) for i = U , (14), (15) and (16). This system is block
     recursive in a linear system in C1T (s), C2T (s), pN                    N
                                                              1 (s) and p1 (s). Solving this linear system
                                                                  (1−γ)(1+κ)+γ 1 1+β
                                                                                  1                   1
                                                                                              γ(1+r) 1+β ( ωγ +1−γ )
     yields the following coefficients for C1T (s): αy1  uc
                                                             = γ +(1−γ) 1−κω1−ω      , αUuc = γ +(1−γ)               ,
                                                                   ω       (     ω )           ω        (1−κ 1−ωω )
                        1       γ                           1   β
       uc   (1−γ)(1+r) 1+β  (β+ ω +1−γ )       uc         γω   1+β
     αR   =     γ              1−ω       and αy2  = γ
                                                                1−κ 1−ω
                                                                         .
                ω
                  +(1−γ) ( 1−κ  ω  )                ω
                                                      +(1−γ)  (      ω )


  uu In this case equilibrium is given by the system (10), (11), (14), (15) and (16). This system
     is block recursive in a linear system in C1T (s) and C2T (s). Solving this linear system yields
     the following coefficients for C1T (s): αy1
                                              uu
                                                  = 1/(1 + β), αUuu = γ(1 + r)/(1 + β), αR     uu
                                                                                                  =
                                    uu
     (1 − γ)(1 + r)/(1 + β) and αy2 = β/(1 + β).

B.3      Proof of Lemma 3
The proof of part 1. simply follows from an inspection of the expressions for the coefficients (see
proof of Lemma 2 above), noting that Assumption 2 implies 0 < 1 − κ 1−ω          ω
                                                                                      < 1.
                                                                                     uu            cc
    The proof of part 2. follows directly from the observations that (1) αy1 < 1 < αy1                ; (2) for
         cc      uc      cu      uu                     cc      cu        uc    uu            cu
γ = 0, αy1  = αy1   and αy1 = αy1   ; (3) for γ = 1, αy1    = αy1   and αy1  = αy1 ; (4) ∂αy1    /∂γ > 0 and
   uc                                   cu      uc
∂αy1 /∂γ < 0; and (5) for γ = 0.5, αy1 = αy1 .
    For part 3. we observe that if γ = 0, then αUuu = αUcu = αUuc = αUcc = 0, and that if γ > 0
assuming that αUuu ≥ αUcu , αUuu ≥ αUuc , αUcu ≥ αUcc and αUuc ≥ αUcc individually lead to contradictions.
                                                                    uu     cu     uc       cc
    Similarly, for part 4. we observe that if γ = 1, then αR           = αR   = αR    = αR     = 0, and that
                            uu       cu    uu       uc   cu      cc        uc     cc
if γ < 1 assuming that αR ≥ αR , αR ≥ αR , αR ≥ αR and αR ≥ αR individually leads to
contradictions.

B.4      Proof of Lemma 4
Let us define the thresholds ax ≡ min(0, ãx ),

              1 − κ 1−ω                                                                1 − κ 1−ω
   ãx ≡ −ω          ω
                        max (BR1 , BU 1 ) − (1 − ω) (1 + r) [γBU 1 + (1 − γ) BR1 ] + β        ω
                                                                                                 ȳ T ,
                  θ                                                                        θ
and
                                          1−ω
                                                                                     β 1 − 1−ω
                                                                                                
               1                              κ (1   + r)                                      κ
         bx ≡ − min (BR1 , BU 1 ) −        ω
                                                            [γBU 1 + (1 − γ) BR1 ] +        ω
                                                                                                  ȳ T ,
               θ                                 θ                                        θ



                                                         35
where
                                                                       1
                                                      θ ≡ (1 + κ) β + κ .
                                                                       ω
It can be easily verified that

   1. bunc        T                          con        T
       i2 (Bi1 ; y1 (s), BU 1 , BR1 , cc) < bi2 (Bi1 ; y1 (s), BU 1 , BR1 , cc) for i = U, R is equivalent to
      y1T (s) < ax ,

   2. bunc        T                          con        T
       i2 (Bi1 ; y1 (s), BU 1 , BR1 , uu) ≥ bi2 (Bi1 ; y1 (s), BU 1 , BR1 , uu) for i = U, R is equivalent to
      y1T (s) ≥ bx ,

   3. bunc          T                          con          T                            unc        T
       U 2 (BU 1 ; y1 (s), BU 1 , BR1 , cu) < bU 2 (BU 1 ; y1 (s), BU 1 , BR1 , cu) and bR2 (BR1 ; y1 (s), BU 1 , BR1 , cu) ≥
      bcon          T                                                   T
       R2 (BR1 ; y1 (s), BU 1 , BR1 , cu) is equivalent to ax ≤ y1 (s) < bx iif BU 1 < BR1 , and


   4. bunc          T                          con          T                            unc        T
       U 2 (BU 1 ; y1 (s), BU 1 , BR1 , uc) ≥ bU 2 (BU 1 ; y1 (s), BU 1 , BR1 , uc) and bR2 (BR1 ; y1 (s), BU 1 , BR1 , uc) <
      bcon          T                                                   T
       R2 (BR1 ; y1 (s), BU 1 , BR1 , uc) is equivalent to ax ≤ y1 (s) < bx iif BU 1 > BR1 .


B.5      Proof of Lemma 5
The proof simply follows from the fact that ax and bx are non-increasing in BU 1 and BR1 (see
expressions in proof of Lemma 4).

B.6      Proof of Proposition 1
We start by defining
                                                                                                                        
                                                 ω                                  1                       ω
hU (BU 1 , BR1 ) ≡ 1−E0                                   hR (BU 1 , BR1 ; τ ) ≡
                                                                  ,                    −E0
                                   CUT 1 (y1T (s), BU 1 , BR1 )                   1+τ            T
                                                                                               CR1  (y1T (s), BU 1 , BR1 )
                                                                                                          (B.1)
and note that the unregulated agents’ Euler equation (19) can be written as hU (BU∗ 1 , BR1          ∗
                                                                                                         ) = 0,
                                                                                  ∗    ∗
while the regulated agents’ Euler equation (20) can be written as hR (BU 1 , BR1 ; τ ) = 0.
    Let us consider the equilibrium response of U agents. We note that we can write hU as
                              Z ax                    Z bx                       Z ∞
                                    ω        T              ω         T                ω
       hU (BU 1 , BR1 ) = 1 −        T
                                        dF (y1 (s)) −        T
                                                                dF (y1 (s)) −           T
                                                                                           dF (y1T (s))
                               y   C U1                ax  C U1                   bx  C U1


where the arguments of CUT 1 , ax and bx are omitted in the interest of space. According to the
                                                   ∂hU /∂BR1
implicit function theorem we have dBU 1 /dBR1 = − ∂h U /∂BU 1
                                                              , with

                   ax                                            bx                                            ∞
                                ∂CUT 1                                        ∂CUT 1                                       ∂CUT 1
             Z                                              Z                                             Z
∂hU                       ω                                             ω                                             ω
     =                                 dF (y1T (s)) +                                dF (y1T (s)) +                               dF (y1T (s))
∂BR1                      T 2 ∂BR1                                      T 2 ∂BR1                                     T 2 ∂BR1
               y        (CU 1 )                              ax       (CU 1 )                             bx       (CU 1 )
                   ax                                            bx                                            ∞
                                ∂CUT 1                                        ∂CUT 1                                       ∂CUT 1
             Z                                              Z                                             Z
∂hU                       ω                                             ω                                             ω
      =                         2        dF (y1T (s))   +                     2        dF (y1T (s))   +                           dF (y1T (s))
∂BU 1                                                                                                                T 2 ∂BU 1
               y        (CUT 1 ) ∂BU 1                          ax    (CUT 1 ) ∂BU 1                          bx   (CU 1 )


                                                                      36
where we used the fact that terms containing derivatives of ax and bx drop out due to the
continuity of CUT 1 across regions.16 The derivatives in the various regions are given by

             ∂CUT 1    ω(1 + r)(1 + κ) 1−ω   (1 − γ)          ∂CUT 1                   (1 + κ) 1−ω
                                                                                                    
                                           ω                                                    ω
                                                                                                   γ
     cc :            =                                ;               = ω(1 + r) 1 +                   .
             ∂BR1                1 − κ 1−ω
                                         ω
                                                              ∂BU 1                      1 − κ 1−ω
                                                                                                ω
                                                         1−γ
                       ω(1 + r)(1 + κ) 1−ω
                                                                  
             ∂CUT 1                        ω
                                             (1 −  γ)     ω
                                                             +  γ
     cu :            =                                              ;
                            (1 + β) 1−γ                 1−ω
                                                           
             ∂BR1                      ω
                                           + γ  1 −  κ   ω
                                 "                                        #
                                                               1−γ
             ∂CUT 1                      (1 + κ) 1−ω
                                                   ω
                                                      γ   β +   ω
                                                                     + γ
                     = ω(1 + r) 1 +              1−γ
                                       (1 + β) ω + γ 1 − κ 1−ω
                                                                         
             ∂BU 1                                                    ω
                                 1−ω
                                                                ω(1 + r) 1 + 1−ω
                                                                                    
                 T     ω(1 + r) ω (1 − γ)                 T                        γ
             ∂CU 1                                   ∂CU 1                      ω
     uc :            =                        ;              =
             ∂BR1              1+β                   ∂BU 1               1+β
                       ω(1 + r) 1−ω                             ω(1 + r) 1 + 1−ω
                                                                                    
             ∂CUT 1               ω
                                     (1 − γ)         ∂CUT 1                     ω
                                                                                   γ
     uu :            =                        ;              =
             ∂BR1             (1 + β)                ∂BU 1              (1 + β)
                                           T
                                         ∂CU
Therefore, in every region the term      ∂BR1
                                             1
                                                 is non-negative (and strictly positive whenever γ < 1)
                 T
               ∂CU
and the term       1
               ∂BU 1
                     is strictly positive. It follows that for a given BR , ∂hU /∂BU 1 > 0 in the range
                    T
of BU for which CU 1 is always positive. The equilibrium response of U agents to BR is therefore
unique, and can be written as BU = φU (BR ). Further, in the range of BU and BR for which CUT 1
is always positive, we have ∂hU /∂BR1 ≥ 0, with strict inequality whenever γ < 1. It follows that
φ0U (BR ) ≤ 0, with strict inequality whenever γ < 1.
     For the equilibrium response of R agents, the proof is analogous and involves the derivatives
      T
of CR1  in the four regions. The equilibrium response of R agents to BU is unique and decreasing,
strictly whenever γ > 0.

B.7     Proof of Proposition 2
The proof relies on the relationship between the slopes φ0U and [∂φR /∂BU ]−1 at the unregulated
equilibrium debt choices, as well as on the sign of the partial derivative ∂φ0R (BU , τR )/∂τR .
                      ∂hU /∂BR1
   We have φ0U = − ∂h   U /∂BU 1
                                 and ∂φR /∂BU = − ∂h  R /∂BU 1
                                                    ∂hR /∂BR1
                                                               . At the unregulated equilibrium we
                ∗       ∗        ue
have τR = 0, BU 1 = BR1 = B1 , and therefore ax = bx and CUT 1 = CR1      T
                                                                             = C1T for any state at
                        Ra                               R∞
date 1. Defining ηcc = y x 1T 2 dF y1T (s) and ηuu = ax 1T 2 dF y1T (s) , we have
                                                                            
                             (C1 )                             (C1 )
                                                    (1+κ) 1−ω              1 1−ω
                                     ηcc (1 − γ) 1−κ 1−ωω
                                                            + ηuu (1 − γ) 1+β ω
                         0   ue
                        φU (B1 ) = − h                ω
                                               (1+κ) 1−ω
                                                          i                                            (B.2)
                                                                    1
                                                                       1 + γ 1−ω
                                                                                
                                    ηcc 1 + γ 1−κ 1−ω ω
                                                            + ηuu 1+β         ω
                                                           ω

  16
    Note that if BU 1 < BR1 the relevant intermediate region between ax and bx is x = cu, while if BU 1 > BR1
the relevant region is x = uc. If BU 1 = BR1 then ax = bx so this intermediate region drops out.




                                                      37
and
                                                      (1+κ) 1−ω
                                        h                          i
                                                                                  1
                                                                                       1 + (1 − γ) 1−ω
                                                                                                      
                                     ηcc 1 + (1 −   γ) 1−κ 1−ω
                                                             ω
                                                                           + ηuu 1+β                ω
       [∂φR (B1ue , 0)/∂BU ]−1 = −                          ω
                                                           (1+κ) 1−ω
                                                                                                           (B.3)
                                                                                1 1−ω
                                                   ηcc γ          ω
                                                            1−κ 1−ω
                                                                       + ηuu γ 1+β ω
                                                                 ω


For any value of γ, the numerator in (B.2) is smaller than the one in (B.3), and the denominator
in (B.2) is larger than the one in (B.3). It follows that |φ0U (B1ue )| < |[∂φR (B1ue , 0)/∂BU ]−1 | and
therefore φ0U (B1ue ) > [∂φR (B1ue , 0)/∂BU ]−1 .
    Furthermore, we have

                          ∂φ0R (BU , τR )    ∂hR /∂τR    −1/(1 + τR )2
                                          =−          =−               >0
                               ∂τR           ∂hR /∂BR     ∂hR /∂BR

since ∂hR /∂BR > 0.
    In the (BU 1 , BR1 ) space, the curve φR (BU , τR ) crosses the curve φU (BR ) from above at
(BU 1 , BR1 ) = (B1ue , B1ue ), and it shifts to the right as τR rises. Hence, in the neighborhood
of (B1ue , B1ue ), a rise in τR results in a downward movement of (BU∗ 1 , BR1  ∗
                                                                                  ) along the downward
                                                             ∗                            ∗
sloping φU (BR ) curve. It follows that for a small τR , BU 1 is decreasing in τR and BR1     is increasing
in τR .
                                                                                dpN     ∂pN       ∂pN
    The result on debt capacity follows from the sign of the derivative dBR1      1
                                                                                     ≡ ∂BR1
                                                                                          1
                                                                                              + ∂BU1 1 ∂B U1
                                                                                                       ∂BR1
                                                                                                             .
Evaluated at (BU 1 , BR1 ) = (B1ue , B1ue ), this derivative is given by

            dpN
                                                                       
              1          1 − ω (1 − γ)(1 + r)      γ(1 + r) 0        ue
                    =                           +            φU (B1 )
           dBR1            ω       1 − κ 1−ω
                                          ω
                                                   1 − κ 1−ω
                                                          ω
                                                                                           
                                                                          1
                         1 − ω (1 − γ)(1 + r)                 ηcc + ηuu 1+β
                    =                  1−ω
                                                   h
                                                           (1+κ) 1−ω
                                                                     i                     > 0
                           ω      1−κ ω                                      1
                                                                               
                                                ηcc 1 + γ 1−κ 1−ω + ηuu 1+β 1 + γ ω
                                                                  ω                   1−ω
                                                                       ω


in region cc, and by

          dpN
                                                           
            1   1 − ω (1 − γ)(1 + r) γ(1 + r) 0          ue
              =                        +          φ (B )
         dBR1     ω         1+β            1+β U 1
                                                                                  
                                                                1
                1 − ω (1 − γ)(1 + r)                ηcc + ηuu 1+β
              =                           h
                                                (1+κ) 1−ω
                                                          i                        > 0
                  ω       1+β          ηcc 1 + γ 1−κ 1−ω
                                                       ω           1
                                                            + ηuu 1+β
                                                                      
                                                                        1 + γ 1−ω
                                                                       ω
                                                                               ω


in region uu. Since cc and uu are the only two relevant regions when debt choices are symmetric,
                 dpN
it follows that dBR1
                   1
                     > 0.

B.8      Proof of Proposition 3
The proof relies on the result that starting from the unregulated equilibrium, a movement along
the best response of unregulated agents associated with a small tax τR leads to welfare gains for

                                                     38
agents of both types. To establish this result, we start by observing that
                                                               2
                                                               X
             Vi1 (y1T , BU 1 , BR1 )                                 β t−1 ω ln CitT + (1 − ω) ln CitN
                                                                                                     
                                       =         max
                                            T ,C N ,C T ,C N
                                           Ci1  i1   i2 i2     t=1

subject to
             2
             X         1       T
                               Cit − ytT + pN   T                 N      N
                                                                          
                          t−1               t (y1 , BU 1 , BR1 ) Cit − y      = (1 + r)Bi1
             t=1
                   (1 + r)

and

              T
                 − y1T + pN   T                 N      N
                                                           + κ y1T (s) + pN   T                 N
                                                                                               
(1 + r)Bi1 + Ci1          1 (y1 , BU 1 , BR1 ) Ci1 − y                    1 (y1 , BU 1 , BR1 )y     ≥ 0.

Therefore, using the Envelope theorem, we have
                                                                          2
                                                               ∂pN                                 N
                                                 
      ∂Vi1           ω               1    1                      1
                                                                     X      1      ω           N ∂pt
           = (1 + r) T + ω            T
                                        − T           κy N         +                T
                                                                                       y N
                                                                                           − C i1           (B.4)
      ∂Bi1          Ci1             Ci1 ci2                    ∂Bi1 t=1 (1 + r)t−1 Ci1             ∂Bi1

and
                                                                      2
                                                    ∂pN                                 N
                                            
             ∂Vi1              1    1               N 1
                                                          X      1      ω     N     N ∂pt
                  =ω            T
                                  − T            κy     +                T
                                                                            y   − C i1                      (B.5)
             ∂Bj1             Ci1 Ci2               ∂Bj1 t=1 (1 + r)t−1 Ci1             ∂Bj1
for j 6= i.
    Next, the date 0 welfare of an agent of type i associated with aggregate debt choices (BU 1 , BR1 )
can be written as
                          Wi0 (BU 1 , BR1 ) = −Bi1 + βE0 Vi1 (y1T , BU 1 , BR1 ).

Thus, the variation in welfare of an agent of type i caused by imposing a small tax on regulated
agents is proportional to
                                   dWi0     ∂Wi0    ∂Wi0 ∂BU 1
                                        =        +             .
                                   dBR1     ∂BR1 ∂BU 1 ∂BR1
   For unregulated agents, this variation is given by
                                                                
                         dWU 0         ∂VU 1               ∂VU 1 ∂BU 1
                                = βE0        + −1 + βE0                .
                          dBR1        ∂BR1                 ∂BU 1 ∂BR1

Using (B.4) and (B.5) and evaluating the expression at the unregulated equilibrium, the variation
reduces to                                                     N
                                                                    
                          dWU 0               1      1        N dp1
                                = βE0 ω          −         κy         .
                          dBR1              CUT 1 CUT 2        dBR1
Under the premise that borrowing constraints bind with positive probability in the unregulated
equilibrium, the term in round brackets is positive in some states of nature (and zero in the
                                                      dpN
others). Furthermore, Proposition 2 established that dBR1
                                                        1
                                                          > 0. It follows that dW U0
                                                                               dBR1
                                                                                     > 0.



                                                                39
    For regulated agent, the welfare variation is given by
                            dWR0            ∂VR1       ∂VR1 ∂BU 1
                                 = −1 + βE0      + βE0            .
                            dBR1            ∂BR1       ∂BU 1 ∂BR1
Using (B.4) and (B.5) and evaluating the expression at the unregulated equilibrium, the variation
reduces to                                                    N
                                                                    
                          dWR0                1      1       N dp1
                                = βE0 ω       T
                                                 − T κy               .
                          dBR1              CR1     CR2        dBR1
Again, under the premise that borrowing constraints bind with positive probability in the un-
regulated equilibrium, the term in round brackets is positive in some states of nature (and zero
                                                      dpN
in the others), while Proposition 2 established that dBR1
                                                        1
                                                          > 0. It follows that dW R0
                                                                               dBR1
                                                                                     > 0.

B.9     Proof of Proposition 4
The proof of the “if” part is by construction. Assume that the tax is zero. τR = 0 implies that
(BU 1 , BR1 ) = (B1ue , B1ue ), which implies symmetric allocations in all states of the world at date 1
and 2: CUT t = CRtT
                      and CUNt = CRt N
                                        for t = 1, 2. The optimal tax expression (24) then implies
                                           h                           i
                                                       γ             dpN
                                       βE0 µR1 + 1−γ     µU 1 κȳ N dBR1
                                                                       1

                                 τR =                  h   i               =0
                                                    E0 CωT
                                                       R1


since µR1 = µU 1 = 0 in all states of the world. τR = 0 is therefore indeed optimal.
    The proof of the “only if” part is by contradiction. Assume that the tax is zero and that credit
constraint binds, i.e. µR1 > 0 and/or µU 1 > 0, in some states of the world in the decentralized
equilibrium. τR = 0 implies that (BU 1 , BR1 ) = (B1ue , B1ue ), which induces symmetric allocations
in all states of the world at date 1 and 2: CUT t = CRtT
                                                          and CUNt = CRt N
                                                                           for t = 1, 2. The optimal
tax expression (24) then implies
                                          h                          i
                                                    γ              dpN
                                     βE0 µR1 + 1−γ    µU 1 κȳ N dBR11

                               τR =                 h    i                                     (B.6)
                                                 E0 CωT
                                                            R1


                                                       dpN
   The proof of Proposition 2 established that dBR11
                                                       > 0 necessarily hold at the unregulated
equilibrium debt choices. Thus, (B.6) implies τR > 0, a contradiction.


C      Recursive Competitive Equilibrium
We present the optimization problem of a representative agent in recursive form. The aggregate
state vector of the economy is X = {BU , BR , y T , y N }. The state variables for a type i agent’s
problem is the individual state bi and the aggregate states X. Agents need to forecast the future


                                                  40
price of nontradables. To this end, they need to forecast future aggregate bond holdings. We
denote by Γi (·) the forecast of aggregate bond holdings for the set of type i agents for every current
aggregate state X, i.e., Bi0 = Γi (X). Combining first-order conditions equilibrium conditions
cT , cN , budget constraints and market clearing, the forecast price function for nontradables can
be expressed as
                                                                                            η+1
                          ytN + [γBU + (1 − γ)BR ](1 + r) − [γΓU (X) + (1 − γ)ΓR (X)]
                      
     N     1−ω
   p (X) =                                                                                         .   (B.7)
            ω                                         yN

The problem of a type i agent can then be written as:

                             V (bi , X) = max u c cTi , cN        + βEV (b0i , X 0 )
                                                             
                                                         i                                             (B.8)
                                         b0i ,cT   N
                                               i ,ci


subject to
                            b0i + pN (X)cN     T                N    N
                                         i + ci = bi (1 + r) + p (X)y + y
                                                                          T


                                        b0i ≥ −κ pN (X)y N + y T
                                                                 

                                     Bj0 = Γj (X) for       j = {U, R}

The solution to this problem yields decision rules for individual bond holdings b̂(bi , X), tradable
goods consumption ĉT (bi , X) and nontradable goods consumption ĉN (bi , X). The decision rule
for bond holdings induces actual laws of motion for aggregate bonds, given by b̂(Bi , X).

Definition of unregulated Equilibrium. A recursive unregulated equilibrium is defined by
a pricing function pN (X), perceived laws of motions Γi (X) for i ∈ {U, R}, and decision rules
b̂(bi , X), ĉT (bi , X), ĉN (bi , X) with associated value function V (bi , X) such that:
                                      n                            o
    1. Agents’ optimization: b̂(bi , X), ĉT (bi , X), ĉN (bi , X) and V (bi , X) solve the agent’s i recur-
         sive optimization problem for i ∈ {U, R}, taking as given pN (X) and Γi (X) for i = {U, R}.

   2. Consistency: the perceived laws of motion for aggregate bonds are consistent with the
      actual laws of motion: Γi (X) = b̂(Bi , X) for i = {U, R}.

   3. Market clearing:
                                    γĉN (BU , X) + (1 − γ)ĉN (BR , X) = y N

      and

         γ ΓU (X) + ĉT (BU , X) − BU (1 + r) + (1 − γ) ΓR (X) + ĉT (BR , X) − BR (1 + r) = y T .
                                                                                       




                                                       41
D     Numerical solution
To solve for the regulated equilibrium when γ > 0, we adopt a nested fixed point algorithm
similar to those used in studies of Markov perfect equilibria (e.g., Bianchi and Mendoza, 2018,
Klein et al., 2005, Klein et al., 2008). Given future policies, we solve for policy functions and
value functions using value function iteration in an inner loop. In the outer loop, we update
future policies with the solution of the Bellman equation from the inner loop. The algorithm
follows these steps:

  1. Generate a discrete grid for the bond position of regulated agents GR = {b1 , b2 , . . . , bM },
     the bond position of unregulated agents GU = {b1 , b2 , . . . , bM } and the shocks GY =
     {s1 , s2 , . . . , sN } and choose an interpolation scheme for evaluating the functions outside
     the bond grids. We use 100 points for each bond grid and interpolate using piecewise
     linear approximation.

  2. Guess policy functions UU0 , P at step K ∀bR ∈ GR , ∀bU ∈ GU and ∀y ∈ GY . We use as
     initial policies the policies of the unregulated equilibrium.

  3. For given UU0 , P, solve for the value function and policy functions associated with the
     following Bellman equation:

                                                                                                     0
                  V (X) =             max                 γu(cTU , cN               T    N
                                                                    U ) + (1 − γ)u(cR , cR ) + βEV (X )    (B.9)
                            {cT   N 0                 N
                              i ,ci ,bi }i∈{U,R} ,µ,p


     subject to

                                 b0R = (1 + r)bR + y T − cTR + pN (y N − cN
                                                                          R)                              (B.10)
                                 b0U = (1 + r)bU + y T − cTU + pN (y N − cN
                                                                          U)                              (B.11)
                                                                   η+1
                                       1 − ω γcU + (1 − γ)cTR
                                              T                 
                                 pN =                                                                     (B.12)
                                         ω             yN
                                              cTR
                                 cN
                                  R  =                   yN                                               (B.13)
                                       γcTU + (1 − γ)cTR
                                              cTU
                                 cN
                                  U  =                   yN                                               (B.14)
                                       γcTU + (1 − γ)cTR
                                 b0R ≥ −κ(P(X)y N + y T )                                                 (B.15)
                                 b0U ≥ −κ(P(X)y N + y T )                                                 (B.16)
                                                                  0   0
                                   µ = uT (cTU , cN
                                                  U ) − β(1 + r)EUU (X )                                  (B.17)
                                   µ × [b0U + κ(P(X)y N + y T )] = 0                                      (B.18)
                                   µ ≥ 0.                                                                 (B.19)

     The Bellman equation is solved using value function iteration. In each state, the maxi-

                                                             42
  mization is performed using discrete search for b0R on the GR grid. For a given b0R , the
  value of all remaining variables (including b0U ), and therefore of the objective, follow from
  (B.10)-(B.19).

4. Denote by σ U and σ P the policy functions that solve the recursive problem in step 3.
   Compute the sup distance between UU and σ U , as well as between P and σ P . If the sup
   distance is higher than 1.0e-5, update UU and P and go back to step 2.




                                            43
