                                 NBER WORKING PAPER SERIES




                             IDENTIFYING LONG-RUN RISKS:
                        A BAYESIAN MIXED-FREQUENCY APPROACH

                                           Frank Schorfheide
                                             Dongho Song
                                              Amir Yaron

                                         Working Paper 20303
                                 http://www.nber.org/papers/w20303


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                       July 2014




We thank Bent J. Christensen, Frank Diebold, Emily Fox, Ivan Shaliastovich, Neil Shephard, Minchul
Shin, and seminar participants at the 2013 SED Meetings, the 2013 SBIES Meetings, the 2014 AEA
Meetings, the 2014 Aarhus Macro-Finance Symposium, the Board of Governors, the European Central
Bank, Universite de Toulouse, and the University of Pennsylvania for helpful comments and discussions.
Schorfheide gratefully acknowledges financial support from the National Science Foundation under
Grant SES 1061725. Yaron thanks the Rodney White Center for financial support. The views expressed
herein are those of the authors and do not necessarily reflect the views of the National Bureau of Economic
Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2014 by Frank Schorfheide, Dongho Song, and Amir Yaron. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
Identifying Long-Run Risks: A Bayesian Mixed-Frequency Approach
Frank Schorfheide, Dongho Song, and Amir Yaron
NBER Working Paper No. 20303
July 2014
JEL No. C11,C32,C58,E44,G12

                                              ABSTRACT

We develop a nonlinear state-space model that captures the joint dynamics of consumption, dividend
growth, and asset returns. Our model consists of an economy containing a common predictable component
for consumption and dividend growth and multiple stochastic volatility processes. The estimation is
based on annual consumption data from 1929 to 1959, monthly consumption data after 1959, and monthly
asset return data throughout. We maximize the span of the sample to recover the predictable component
and use high-frequency data, whenever available, to efficiently identify the volatility processes. Our
Bayesian estimation provides strong evidence for a small predictable component in consumption growth
(even if asset return data are omitted from the estimation). Three independent volatility processes capture
different frequency dynamics; our measurement error specification implies that consumption is measured
much more precisely at an annual than monthly frequency; and the estimated model is able to capture
key asset-pricing facts of the data.


Frank Schorfheide                                    Amir Yaron
University of Pennsylvania                           The Wharton School
Department of Economics                              University of Pennsylvania
3718 Locust Walk                                     2256 Steinberg-Dietrich Hall
Philadelphia, PA 19104-6297                          Philadelphia, PA 19104-6367
and NBER                                             and NBER
schorf@ssc.upenn.edu                                 yaron@wharton.upenn.edu

Dongho Song
University of Pennsylvania
Department of Economics
3718 Locust Walk
Philadelphia, PA 19104
donghos@sas.upenn.edu
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                  1


1      Introduction

Financial economists seek to understand the sources underlying risk and return in the economy. In
equilibrium models this endeavor hinges on the preference specification and the joint dynamics of
cash flows, which in an endowment economy correspond to consumption and dividends. There are
many equilibrium models that appeal to low-frequency components in these cash flows as well as
important time variation in the fundamentals (e.g., models of long-run risks (LRR) as in Bansal
and Yaron (2004), and models of rare disasters as in Barro (2009)). Identifying both of these
components is challenging. To measure the small persistent component in, say, consumption and
dividend growth one would want the longest span of data. On the other hand, to estimate the time
variation in second moments of cash flows one would ideally like to use high-frequency data. The
empirical analysis is constrained by the availability of consumption data. For the U.S., the longest
span of available data for consumption growth is at the annual frequency starting in 1929. The
highest-frequency consumption data is available at the monthly frequency from 1959. To exploit
all the available information in mixed-frequency data, this paper develops a Bayesian state-space
model that prominently features stochastic volatility and time-aggregates consumption whenever
it is observed only at a low frequency.

    Our state-space model is designed to capture the joint dynamics of consumption, dividend growth,
and asset returns. Building on the work of Bansal and Yaron (2004), the core of our model con-
sists of an endowment economy that is, in part, driven by a common predictable component for
consumption and dividend growth. Our model distinguishes itself from the existing LRR litera-
ture in several important dimensions. First, our state-space representation contains measurement
equations that time-aggregate consumption to the observed frequency, yet allow us to maintain
the likelihood representation (see Bansal, Kiku, and Yaron (2012b) for a generalized methods-of-
moments (GMM) approach using time aggregation). Our measurement-error specification accounts
for different types of measurement errors at monthly and annual frequencies while respecting the
constraint that monthly growth rates have to be consistent with annual growth rates.

    Second, we generalize the volatility dynamics of Bansal and Yaron (2004)’s model specification by
allowing for three separate volatility processes — one capturing long-run consumption innovations,
one capturing short-run consumption innovations, and a separate process for dividend dynamics.
We do so since our estimation procedure, which focuses on the joint distribution of consumption,
dividends, and asset prices, requires separate stochastic volatility processes to fit the data. Third,
we specify an additional process for variation in the time rate of preference as in Albuquerque,
Eichenbaum, and Rebelo (2012), which generates risk-free rate variation that is independent of
cash flows and leads to an improved fit for the risk-free rate.
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                             2


  The estimation of the state-space model generates several important empirical findings. First,
we find strong evidence for a small predictable component in consumption growth. This evidence
consists of two parts. We begin by estimating the state-space model on cash flow growth data
only.1 Our carefully specified measurement-error model for cash flow data allows us to measure
this component which otherwise is difficult to detect. We then proceed by adding asset return data
to the estimation and, in line with the existing LRR literature, find even stronger evidence for this
predictable component. The Bayesian approach allows us to characterize the uncertainty about the
persistence of the conditional mean growth process. We find that in spite of using a prior with a
mean of 0.9 and a standard deviation of 0.5 our estimation yields a posterior distribution that is
tightly centered around 0.99. Second, our estimated measurement errors for consumption growth
are consistent with the common view (see Wilcox (1992)) that consumption growth is measured
more precisely at an annual rather than monthly frequency.

  Third, all three stochastic volatility processes display significant time variation yet behave dis-
tinctly over time. The volatility processes partly capture heteroskedasticity of innovations, and
in part they break some of the tight links that the model imposes on the conditional mean dy-
namics of asset prices and cash flows. This feature significantly improves the model implications
for consumption and return predictability. As emphasized by the LRR literature, the volatility
processes have to be very persistent in order to have significant quantitative effects on asset prices.
An important feature of our estimation is that the likelihood focuses on conditional correlations
between the risk-free rate and consumption — a dimension often not directly targeted in the lit-
erature. We show that because consumption growth and its volatility determine the risk-free rate
dynamics, one requires another independent volatility process to account for the weak correlation
between consumption growth and the risk-free rate. In the generalized specification of the model
in which there are independent time rate of preference shocks, this correlation is further muted and
the model fit for the dynamics of the risk-free rate is improved.

  Fourth, it is worth noting that the median posterior estimate for risk aversion is 10-11 while it is
around 1.5 for the intertemporal elasticity of substitution (IES). These estimates are broadly con-
sistent with the parameter values highlighted in the LRR literature (see Bansal and Yaron (2004),
Bansal, Kiku, and Yaron (2012a), and Bansal, Kiku, and Yaron (2012b)). Fifth, at the estimated
preference parameters and those characterizing the consumption and dividend dynamics, the model
is able to successfully generate many key asset-pricing moments, and improve model performance
relative to previous LRR models along several dimensions. In particular, the posterior median of
   1
       Related evidence based on estimation is provided by Bansal and Yaron (2000) (ARMA(1,1) model for dividend
growth); by Bansal, Dittmar, and Lundblad (2005) (cointegration model for consumption and dividends); and Hansen,
Heaton, and Li (2008) (VAR for log consumption and earnings with cointegration restrictions).
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                  3


the equity premium is 6%, while the model’s posterior predictive distribution is consistent with
the observed large volatility of the price-dividend ratio at 0.45, and the R-squares from predicting
returns and consumption growth by the price-dividend ratio.

  Our paper also contains a number of technical innovations. First, in the specification of our
state-space model we follow the stochastic volatility literature and assume that volatilities evolve
according to exponential Gaussian processes that guarantee nonnegativity. In order to solve the
model, we approximate the exponential Gaussian volatility processes by linear Gaussian processes
such that the standard analytical solution techniques that have been widely used in the LRR
literature can be applied. However, the approximation of the exponential volatility process is used
only to derive the coefficients in the law of motion of the asset prices.

  Second, we use a Markov chain Monte Carlo (MCMC) algorithm to generate parameter draws
from the posterior distribution. This algorithm requires us to evaluate the likelihood function of our
state-space model with a nonlinear filter. Due to the high-dimensional state space that arises from
the mixed-frequency setting, this nonlinear filtering is a seemingly daunting task. We show how to
exploit the partially linear structure of the state-space model to derive a very efficient sequential
Monte Carlo (particle) filter.

  Our paper is related to several strands of the literature. In terms of the LRR literature, our paper
is closely related to that of Bansal, Kiku, and Yaron (2012b) who utilize time aggregation and GMM
to estimate the LRR model (see also Bansal, Gallant, and Tauchen (2007) for an approach using
the efficient method of moments (EMM) and Hansen, Heaton, and Li (2008) for a VAR-based
approach). As noted above, our likelihood-based approach provides evidence which is broadly
consistent with the results highlighted in that paper and other calibrated LRR models (see Bansal,
Kiku, and Yaron (2012a)). Our likelihood function implicitly utilizes a broader set of moments
than earlier GMM or EMM estimation approaches. These moments include the entire sequence of
autocovariances as well as higher-order moments of the time series used in the estimation and let
us measure the time path of the predictable component of cash flows as well as the time path of the
innovation volatilities. Rather than asking the model to fit a few selected moments, we are raising
the bar and force the model to track cash flow and asset return time series.

  To implement Bayesian inference, we embed a particle-filter-based likelihood approximation into a
Metropolis-Hastings algorithm as in Fernández-Villaverde and Rubio-Ramı́rez (2007) and Andrieu,
Doucet, and Holenstein (2010). Since our state-space system is linear conditional on the volatility
states, we can use Kalman-filter updating to integrate out a subset of the state variables. The
genesis of this idea appears in the auxiliary particle filter of Pitt and Shephard (1999) and Chen
and Liu (2000) and is recently discussed in Shephard (2013). Particle filter methods are also utilized
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                 4


in Johannes, Lochstoer, and Mou (2013), who estimate an asset pricing model in which agents have
to learn about the parameters of the cash flow process from consumption growth data. While
Johannes, Lochstoer, and Mou (2013) examine the role of parameter uncertainty for asset prices,
which is ignored in our analysis, they use a more restrictive version of the cash flow process and do
not utilize mixed-frequency observations.

    Our state-space setup makes it relatively straightforward to utilize data that are available at
different frequencies. The use of state-space systems to account for missing monthly observations
dates back to at least Harvey (1989) and has more recently been used in the context of dynamic
factor models (see, e.g., Mariano and Murasawa (2003) and Aruoba, Diebold, and Scotti (2009))
and VARs (see, e.g., Schorfheide and Song (2012)). Finally, there is a growing and voluminous
literature in macro and finance that highlights the importance of volatility for understanding the
macroeconomy and financial markets (see, e.g., Bansal, Khatacharian, and Yaron (2005), Bloom
(2009), Fernández-Villaverde and Rubio-Ramı́rez (2011), Bansal, Kiku, and Yaron (2012a), and
Bansal, Kiku, Shaliastovich, and Yaron (2013)). Our volatility specification that accommodates
three processes further contributes to identifying the different uncertainty shocks in the economy.

    The remainder of the paper is organized as follows. Section 2 introduces the model environment
and describes the model solution. Section 3 presents the empirical state-space model and describes
the estimation procedure. Section 4 discusses the empirical findings and Section 5 provides con-
cluding remarks.



2     The Long-Run Risks (LRR) Model

Our baseline LRR model is described in Section 2.1. The solution of the model is outlined in
Section 2.2. Section 2.3 presents a generalized version of the LRR with an exogenous shock to the
time rate of preference.


2.1     Model Statement

We consider an endowment economy with a representative agent that has Epstein and Zin (1989)
recursive preferences and maximizes her lifetime utility,
                                                                               θ
                                                 1−γ                    1       1−γ
                                                                  1−γ  θ
                           Vt = max (1 − δ)Ct     θ
                                                       +δ   Et [Vt+1 ]
                                Ct

subject to the budget constraint

                                         Wt+1 = (Wt − Ct )Rc,t+1 ,
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                                   5


where Wt is the wealth of the agent, Rc,t+1 is the return on all invested wealth, γ is risk aversion,
         1−γ
θ=      1−1/ψ ,   and ψ is intertemporal elasticity of substitution.

  Following Bansal and Yaron (2004),we decompose consumption growth, gc,t+1 , into a persistent
component, xt , and a transitory component, σc,t ηc,t+1 . The dynamics for the persistent conditional
mean follow an AR(1) with its own stochastic volatility process. Dividend streams have levered
exposures to both the persistent and transitory component in consumption which is captured by
the parameters φ and π, respectively. We allow σd,t ηd,t+1 to capture idiosyncratic movements in
dividend streams. Overall, the dynamics for the cash flows are

                                  gc,t+1 = µc + xt + σc,t ηc,t+1                                                   (1)
                                   xt+1 = ρxt + σx,t ηx,t+1
                                  gd,t+1 = µd + φxt + πσc,t ηc,t+1 + σd,t ηd,t+1 ,

where the conditional volatilities evolve according to2
                                                                       q
                  σi,t = ϕi σ̄ exp(hi,t ),   hi,t+1 = ρhi hi,t + σhi    1 − ρ2hi wi,t+1 ,   i = {c, x, d}          (2)

and the shocks are assumed to be

                                    ηi,t+1 , wi,t+1 ∼ N (0, 1),   i = {c, x, d}.

Relative to Bansal and Yaron (2004), the volatility dynamics contain three separate volatility
processes. More importantly, the logarithm of the volatility process is assumed to be normal,
which ensures that the standard deviation of the shocks remains positive at every point in time.


2.2       Solution

The Euler equation for any asset ri,t+1 takes the form

                                          Et [exp (mt+1 + ri,t+1 )] = 1,                                           (3)

where mt+1 = θ log δ − ψθ gc,t+1 + (θ − 1)rc,t+1 is the log of the real stochastic discount factor (SDF),
and rc,t+1 is the log return on the consumption claim. We reserve rm,t+1 for the log market return
— the return on a claim to the dividend cash flows. Given the cash flow dynamics in (1) and
   2
       Strictly speaking, to guarantee the existence of conditional moments involved in key equilibrium conditions, the
exponential function needs to be spliced together with a non-exponential function, e.g., a square-root function, for
volatilities exceeding some large threshold h̄i . See Chernov, Gallant, Ghysels, and Tauchen (2003) and Andreasen
(2010).
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                                                 6


the Euler equation (3), we derive asset prices using the approximate analytical solution described
in Bansal, Kiku, and Yaron (2012a) which utilizes the Campbell and Shiller (1988a) log-linear
approximation for returns.3

  However, since the volatility processes in (2) do not follow normal distributions, an analytical
expression to (3) is infeasible. To accommodate an analytical solution, we utilize a linear approxi-
mation to (2) and express volatility in (4) as a process that follows Gaussian dynamics:
                                                                                q
           2
         σi,t − (ϕi σ̄)2 = 2(ϕi σ̄)2 hi,t + O(|h2i,t |), hi,t+1 = ρhi hi,t + σhi 1 − ρ2hi wi,t+1
                                                                          q
                  2
                 σi,t+1  ≈ (ϕi σ̄)2 (1 − ρhi ) + ρhi σi,t
                                                        2
                                                          + (2(ϕi σ̄)2 σhi 1 − ρ2hi )wi,t+1
                               = (ϕi σ̄)2 (1 − νi ) + νi σi,t
                                                          2
                                                              + σwi wi,t+1 ,              i = {c, x, d}.                          (4)

The analytical solution afforded via this pseudo-volatility process is important since it facilitates
estimation (see details below).
                                                                                    2 + A σ 2 . As
  The solution to the log price-consumption ratio follows, pct = A0 + A1 xt + A2,c σc,t  2,x x,t
                                                              1
                                                           1− ψ
discussed in Bansal and Yaron (2004), A1 =                1−κ1 ρ ,     the elasticity of prices with respect to growth
prospects, will be positive whenever the IES, ψ, is greater than 1. Further, the elasticity of pct with
                                                                               1 2
                                         2 and σ 2 is                    θ (1− ψ )           θ (κ1 A1 )2
respect to the two volatility processes σc,t    x,t                      2 1−κ1 νc   and     2 1−κ1 νx     respectively; both will
be negative — namely, prices will decline with uncertainty — whenever θ is negative. A condition
that guarantees a negative θ is that agents have a preference for early resolution of uncertainty.
  State prices in the economy are reflected in the innovations to the stochastic discount factor
(SDF),

       mt+1 − Et [mt+1 ]   =           λc σc,t ηc,t+1         +     λx σx,t ηx,t+1       + λwx σwx wx,t+1 + λwc σwc wc,t+1 ,
                                       |    {z      }               |    {z      }         |             {z              }
                                 short-run consumption risk       long-run growth risk                volatility risks

where the derivation and λs are given in Appendix A. It is instructive to note that λc = −γ, λx =
     1
−(γ− ψ )κ1
  1−κ1 ρ     (and λwc and λwx ) is negative (positive) whenever preferences exhibit early resolution
of uncertainty γ > 1/ψ. Furthermore the λs (except λc ) will be zero when preferences are time
separable, namely, when θ = 1.

  Risk premia are determined by the negative covariation between the innovations to returns and
the innovations to the SDF. It follows that the risk premium for the market return, rm,t+1 , is
                     1
Et (rm,t+1 − rf,t ) + vart (rm,t+1 ) = −covt (mt+1 , rm,t+1 )                                                                           (5)
                     2
                                                2              2                                           2                   2
                                     = βm,c λc σc,t + βm,x λx σx,t                            + βm,wx λwx σw x
                                                                                                               + βm,wc λwc λc σw   ,
                                       | {z }           | {z }                                  |              {z                }c
                                                 short-run risk       long-run growth risk                     volatility risks

  3
      See Hansen, Heaton, and Li (2008) for an alternative approximation set around an IES that is equal to one.
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                           7


where the βs are given in Appendix A and reflect the exposures of the market return to the
underlying consumption risks. Equation (5) highlights that the conditional equity premium can be
attributed to (i) short-run consumption growth, (ii) long-run growth, (iii) short-run and long-run
volatility risks.

    A key variable for identifying the model parameters is the risk-free rate. Under the assumed
dynamics in (1), the risk-free rate is affine in the state variables and follows

                                                          2           2
                                rf,t = B0 + B1 xt + B2,c σc,t + B2,x σx,t ,

                                                                              1
where the Bs are derived in Appendix A. It is worth noting that B1 =          ψ   > 0 and the risk-free rate
rises with good economic prospects, while under ψ > 1, γ > 1 and whenever preferences exhibit
                                                                            1      1
                                                                        (1− ψ )(γ− ψ )κ21
early resolution of uncertainty, B2,c = − 21 ( γ−1
                                                ψ + γ) and B2,x = −       2(1−κ1 ρ) 2       are negative so the
risk-free rate declines with a rise in economic uncertainty.


2.3     Generalized Model

In this section we augment the baseline model, as highlighted in Albuquerque, Eichenbaum, and
Rebelo (2012), by allowing for a preference shock to the time rate of preference. Specifically, now
the utility function contains a time rate of preference shock, λt , so the lifetime utility is
                                               1−γ
                                                                       θ
                                                                    1 1−γ
                                                              1−γ  θ
                           Vt = max (1 − δ)λt Ct θ
                                                    + δ Et [Vt+1 ]        .
                                  Ct

The resulting SDF equals the SDF described above plus the term θxλ,t , where xλ,t = λt+1 /λt is
the growth rate of the preference shock. xλ is assumed to follow an AR(1) process with persistence
parameter ρλ and innovation shocks that are independent of other model shocks.

    which is assumed to follow an AR(1) process with persistence parameter ρλ (see Appendix A.6 for
derivation of this augmented SDF). Since xλ,t is known at time t, the risk-free rate will incorporate
its values and consequently allow this generalized model to fit the risk-free rate dynamics better
than the benchmark model.



3     State-Space Representation of the LRR Model

In order to conduct our empirical analysis, we cast the LRR model of Section 2 into state-space form.
The state-space representation consists of a measurement equation that expresses the observables
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                               8


as a function of underlying state variables and a transition equation that describes the law of motion
of the state variables. The measurement equation takes the form

                 yt+1 = At+1 D + Zst+1 + Z v svt+1 + Σu ut+1 , ut+1 ∼ iidN (0, I).
                                                            
                                                                                                               (6)

In our application, yt+1 consists of consumption growth, dividend growth, market returns, and the
risk-free rate. The vector st+1 stacks state variables that characterize the level of cash flows. The
vector svt+1 is a function of the log volatilities of cash flows, ht and ht+1 , in (2). Finally, ut+1 is a
vector of measurement errors and At+1 is a selection matrix that accounts for deterministic changes
in the data availability. The solution of the LRR model sketched in Section 2.2 provides the link
between the state variables and the observables yt+1 .
  The state variables themselves follow vector autoregressive processes of the form

                    st+1 = Φst + vt+1 (ht ),    ht+1 = Ψht + Σh wt+1 ,      wt+1 ∼ iidN (0, I),                (7)

where vt+1 (·) is an innovation process with a variance that is a function of the log volatility process
ht and wt+1 is the innovation of the stochastic volatility process. Roughly speaking, the vector st+1
consists of the persistent cash flow component xt (see (1)) as well as xλ,t in the generalized model
of Section 2.3. However, in order to express the observables yt+1 as a linear function of st+1 and
to account for potentially missing observations, it is necessary to augment st+1 by lags of xt and
xλ,t as well as the innovations for the cash flow process. Since the details are cumbersome and at
this stage non essential, a precise definition of st+1 is relegated to the appendix.
  A novel feature of our empirical analysis is the mixed-frequency approach. While dividend growth,
equity return, and risk-free rate data are available at a monthly frequency from 1929 onwards,
consumption data prior to 1959 are not available at a monthly frequency. Moreover, post-1959
monthly consumption growth data are subject to sizeable measurement errors, which is why many
authors prefer to estimate consumption-based asset pricing models based on time-aggregated data.
Our state-space approach avoids the loss of information due to time aggregation, yet we can allow
for imprecisely measured consumption data at a monthly frequency. We discuss the measurement
equations for consumption in Section 3.1 and the other observables in Section 3.2. Section 3.3
describes the implementation of Bayesian inference.


3.1       A Measurement Equation for Consumption

In our empirical analysis we use annual consumption growth rates prior to 1959 and monthly
consumption growth rates subsequently.4 The measurement equation for consumption in our state-
   4
       In principle we could utilize the quarterly consumption growth data from 1947 to 1959, but we do not in this
version of the paper.
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                9


space representation has to be general enough to capture two features: (i) the switch from annual to
monthly observations in 1959, and (ii) measurement errors that are potentially larger at a monthly
frequency than an annual frequency. To describe the measurement equation for consumption growth
data, we introduce some additional notation. We use the superscript o to distinguish observed con-
sumption and consumption growth, Cto and gc,t
                                          o , from model-implied consumption and consumption

growth, Ct and gc,t . Moreover, we represent the monthly time subscript t as t = 12(j − 1) + m,
where m = 1, . . . , 12. Here j indexes the year and m the month within the year.

  We define annual consumption as the sum of monthly consumption over the span of one year,
i.e.:
                                                             12
                                                             X
                                                  a
                                                 C(j) =             C12(j−1)+m .
                                                             m=1

Log-linearizing this relationship around a monthly value C∗ and defining lowercase c as percentage
deviations from the log-linearization point, i.e., c = log C/C∗ , we obtain
                                                              12
                                                           1 X
                                                ca(j) =          c12(j−1)+m .
                                                           12
                                                              m=1

Thus, monthly consumption growth rates can be defined as

                                                          gc,t = ct − ct−1

and annual growth rates are given by
                                                            23                
                        a
                                                            X    12 − |τ − 12|
                       gc,(j)   =   ca(j)   −   ca(j−1)   =                      gc,12j−τ +1 .   (8)
                                                                      12
                                                             τ =1


  We assume a multiplicative iid measurement-error model for the level of annual consumption,
which implies that, after taking log differences,

                                         a,o      a
                                                        + σa a(j) − a(j−1) .
                                                                             
                                        gc,(j) = gc,(j)                                          (9)

Moreover, consistent with the practice of the Bureau of Economic Analysis, we assume that the
levels of monthly consumption are constructed by distributing annual consumption over the 12
months of a year. This distribution is based on an observed monthly proxy series zt that is assumed
to provide a noisy measure of monthly consumption. The monthly levels of consumption are
determined such that the growth rates of monthly consumption are proportional to the growth rates
of the proxy series and monthly consumption adds up to annual consumption. A measurement-error
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                       10


model that is consistent with this assumption is the following:

           o
                                                                           
          gc,12(j−1)+1 = gc,12(j−1)+1 + σ 12(j−1)+1 − 12(j−2)+12                                     (10)
                                     12
                                1    X
                                           σ 12(j−1)+m − 12(j−2)+m + σa a(j) − a(j−1)
                                                                                           
                            −
                                12
                                     m=1
           o
                                                                      
          gc,12(j−1)+m   = gc,12(j−1)+m + σ 12(j−1)+m − 12(j−1)+m−1 ,            m = 2, . . . , 12

The term 12(j−1)+m can be interpreted as the error made by measuring the level of monthly con-
sumption through the monthly proxy variable, that is, in log deviations c12(j−1)+m = z12(j−1)+m +
12(j−1)+m . The summation of monthly measurement errors in the second line of (10) ensures
that monthly consumption sums up to annual consumption. It can be verified that converting the
monthly consumption growth rates into annual consumption growth rates according to (8) averages
out the measurement errors and yields (9).

  We operate under the assumption that the agents in the model observe consumption growth,
dividend growth, and asset returns in every period. As econometricians who are estimating the
model, we have to rely on the statistical agency to release the consumption growth data. While the
statistical agency may have access to the monthly proxy series zt in real time, it can only release
the monthly consumption series that is consistent with the corresponding annual consumption
observation at the end of each year. Thus, for months m = 1, . . . , 11 the vector y12(j−1)+m in (6)
does not contain any observations on consumption growth. At the end of each year, in month
m = 12, the vector y12(j−1)+m contains the 12 monthly growth rates of year j and (10) provides
the portion of the measurement equation for the consumption data. The vector st has to contain
sufficiently many lags of the model states as well as some lagged measurement errors such that it is
possible to write (10) as a linear function of st . For the earlier part of the sample in which monthly
consumption growth observations are not available, (10) is replaced by (8) and (9). The matrix At
in (6) adapts the system to the availability of consumption data and the changing dimension of the
vector yt . Further details are provided in the appendix.


3.2   Measurement Equations for Dividend Growth and Asset Returns

It is reasonable to believe that consumption measurement errors are large, but those for financial
variables (e.g., dividend streams, market returns, risk-free rates) are negligible. However, to be
chary, we introduce idiosyncratic components for dividend growth, market returns, and the risk-
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                                            11


free rate as well:

                                             o
                                            gd,t+1 = gd,t+1 + σd d,t+1                                                     (11)
                                             o
                                            rm,t+1 = rm,t+1 + σrm rm ,t+1
                                             o                              r
                                            rf,t+1 = rf,t+1 + σ f rf ,t+1 .

In the subsequent empirical analysis we consider a version of the model in which only the risk-free
                                                                        r
rate is measured with error, i.e., σd = 0, σrm = 0, σ f > 0. We believe that aggregate dividend
growth and stock market data are measured relatively cleanly and do not want to deviate too far
from the existing asset pricing literature.


3.3      Bayesian Inference

Equations (6) and (7) define a nonlinear state-space system in which the size of the vector of ob-
servables yt changes in a deterministic manner. The system matrices are functions of the parameter
vector
                                                                                                                       
                                                                                 r
          Θ=       δ, ψ, γ, ρ, φ, ϕx , ϕd , σ̄, µ, µd , π, σ , σa , ρλ , σλ , σ f , ρhc , σhc , ρhx , σhx , ρhd , σhd .   (12)

We will use a Bayesian approach to make inference about Θ and to study the implications of our
model. Bayesian inference requires the specification of a prior distribution p(Θ) and the evaluation
of the likelihood function p(Y |Θ). The posterior can be expressed as

                                                                p(Y |Θ)p(Θ)
                                                 p(Θ|Y ) =                  .                                                (13)
                                                                   p(Y )

We will use MCMC methods to generate a sequence of draws {Θ(s) }ns=1
                                                                  sim
                                                                      from the posterior distri-
bution.

  To generate the draws from the posterior distribution, we need to be able to numerically evaluate
the prior density and the likelihood function p(Y |Θ). Since our state-space system is nonlinear, it is
not possible to evaluate the likelihood function using the Kalman filter. Instead, we use a sequential
Monte Carlo procedure also known as particle filter. The particle filter creates an approximation
p̂(Y |Θ) of the likelihood function p(Y |Θ). It has been shown in Andrieu, Doucet, and Holenstein
(2010) that the use of p̂(Y |Θ) in MCMC algorithms can still deliver draws from the actual posterior
p(Θ|Y ) because these approximation errors essentially average out as the Markov chain progresses.

  Capturing the annual release schedule for the monthly consumption data described in Section 3.1
requires a high-dimensional state vector st . This creates a computational challenge for the eval-
uation of the likelihood function because the accuracy of particle filter approximations tends to
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                 12


decrease as the dimension of the latent state vector increases. In order to obtain a computation-
ally efficient filter, we exploit the fact that our state-space model is linear and Gaussian condi-
tional on the volatility states (ht , ht−1 ). We use a swarm of particles to represent the distribu-
tion of (ht , ht−1 )|Y1:t and employ the Kalman filter to characterize the conditional distribution of
st |(ht , ht−1 , Y1:t ). This idea has been used by Chen and Liu (2000) and more recently by Shephard
(2013). A full description of the particle filter is provided in the appendix. We embed the likelihood
approximation in a fairly standard random-walk Metropolis algorithm that is widely used in the
DSGE model literature; see for instance Del Negro and Schorfheide (2010).



4     Empirical Results

The data set used in the empirical analysis is described in Section 4.1. The subsequent analysis is
divided into two parts. In Section 4.2 we use consumption and dividend growth data to estimate
the persistent components in conditional mean and volatility dynamics of cash flows. In Section 4.3
we include the market return and risk-free rate data in the estimation and analyze the asset pricing
implications of our model.


4.1     Data

We use the per capita series of real consumption expenditure on nondurables and services from the
NIPA tables available from the Bureau of Economic Analysis. Annual observations are available
from 1929 to 2011, quarterly from 1947:Q1 to 2011:Q4, and monthly from 1959:M1 to 2011:M12.
We also use monthly observations of returns, dividends, and prices of the CRSP value-weighted
portfolio of all stocks traded on the NYSE, AMEX, and NASDAQ. Price and dividend series are
constructed on the per share basis as in Campbell and Shiller (1988b) and Hodrick (1992). The
stock market data are converted to real using the consumer price index (CPI) from the Bureau
of Labor Statistics. Finally, the ex ante real risk-free rate is constructed as a fitted value from
a projection of the ex post real rate on the current nominal yield and inflation over the previous
year. To run the predictive regression, we use monthly observations on the three-month nominal
yield from the CRSP Fama Risk Free Rate tapes and CPI series. A more detailed explanation
of the data sources is provided in Appendix B. Growth rates of consumption and dividends are
constructed by taking the first difference of the corresponding log series. The time-series span of
the stock market data and the risk-free rate is from 1929:M1 to 2011:M12.

    Table 1 presents descriptive statistics for aggregate consumption growth, dividend growth, ag-
gregate stock market returns, the risk-free rate, and the log price-dividend ratio. The statistics are
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                               13


                              Table 1: Descriptive Statistics - Data Moments

                                      Annual Frequency: 1930 to 2011
                                             ∆c       ∆d        rm       rf      pd
                               Mean         1.83     0.98     5.43     0.46    3.36
                               StdDev       2.19    11.24    19.98     2.78    0.43
                               AC1          0.48     0.21     0.01     0.72    0.90
                               AC2          0.18    -0.21    -0.16     0.40    0.81
                               AC3         -0.07    -0.15     0.01     0.31    0.75
                               Corr         1.00     0.56     0.12    -0.26    0.07

                                Monthly Frequency: 1929:M1 to 2011:M12
                                             ∆c       ∆d        rm       rf      pd
                               Mean             -    0.09     0.45     0.04    3.36
                               StdDev           -    1.68     5.50     0.24    0.44
                               AC1              -    0.20     0.11     0.98    0.99

                                Monthly Frequency: 1959:M2 to 2011:M12
                                             ∆c       ∆d        rm       rf      pd
                               Mean         0.16     0.11     0.43     0.10    3.57
                               StdDev       0.34     1.26     4.55     0.14    0.39
                               AC1         -0.16    -0.01     0.10     0.96    0.99
                               Corr         1.00     0.04     0.16     0.13    0.00

Notes: We report descriptive statistics for aggregate consumption growth (∆c), dividend growth (∆d), log returns
of the aggregate stock market (rm ), the log risk-free rate (rf ), and log price-dividend ratio (pd). It shows mean,
standard deviation, sample autocorrelations up to order three, and correlation with aggregate consumption growth.
Means and standard deviations are expressed in percentage terms.


computed for a sample of annual observations from 1930 to 2011, a sample of monthly observations
from 1929:M1 to 2011:M12, and a sample of monthly observations from 1959:M2 to 2011:M12.
Consumption data is only available for the shorter of the two monthly samples. For our subsequent
analysis, a few features of the data turn out to be important. First, the sample first autocorrela-
tion function of monthly and annual consumption have different signs. Second, consumption and
dividend growth are highly correlated at the low (annual) frequency but not at the high (monthly)
frequency. Third, the sample standard deviations for the long monthly sample starting in 1929:M1
are larger than the sample standard deviations for the post-1958 sample.
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                    14


4.2   Estimation with Cash Flow Data Only

We begin by estimating the state-space model described in Section 3 based only on consumption
and dividend growth data, dropping market returns and the risk-free rate from the measurement
equation. We employ the mixed-frequency approach by utilizing annual consumption growth data
from 1929 to 1959 and monthly data from 1960:M1 to 2011:M12.

Prior Distribution. We begin with a brief discussion of the prior distribution for the parameters
of the cash flow process specified in (1) and (2). In general, our prior attempts to restrict parameter
values to economically plausible magnitudes. The judgment of what is economically plausible is,
of course, informed by some empirical observations, in the same way the choice of the model
specification is informed by empirical observations. Percentiles of marginal prior distributions are
reported in Table 2.

  The prior 90% credible intervals for average annualized consumption and dividend growth range
from approximately ± 7%. In view of the sample statistics reported in Table 1, this range is
fairly wide and agnostic. The prior distribution for the persistence of the predictable cash flow
growth component xt is a normal distribution centered at 0.9 with a standard deviation of 0.5,
truncated to the interval (−1, 1). The corresponding 90% credible interval ranges from -0.1 to 0.97,
encompassing values that imply iid cash flow growth dynamics as well as very persistent local levels.
The priors for φ and π, parameters that determine the comovement of cash flows, are centered at
zero and have large variances. σ̄ is, roughly speaking, the average standard deviation of the iid
component of consumption growth. At an annualized rate, our 90% credible interval ranges from
1.2% to 7.2%. For comparison, the sample standard deviation of annual consumption growth and
annualized monthly consumption growth are approximately 2% and 4%, respectively (see Table 1).

  The parameters ϕd and ϕx capture the magnitude of innovations to dividend growth and the
persistent cash flow component relative to the magnitude of consumption growth innovations. The
prior for the former covers the interval 0.2 to 12, whereas the prior for the latter captures the
interval 0 to 0.11. Thus, a priori we expect dividends to be more volatile than consumption and
the persistent component of cash flow growth to be much smoother than the iid component. Our
prior interval for the persistence of the volatility processes ranges from -0.1 to 0.97 and the prior
for the standard deviation of the volatility process implies that the volatility may fluctuate either
relatively little, over the range of 0.67 to 1.5 times the average volatility, or substantially, over the
range of 0.1 to 7 times the average volatility.

Posterior Distribution. Percentiles of the posterior distribution are also reported in Table 2.
The most important result for the subsequent analysis of the asset pricing implications of the LRR
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                                       15


                                     Table 2: Posterior Estimates: Cashflows Only

                   Prior                     Posterior                          Prior                     Posterior
          Distr.   5%        95%       5%      50%       95%           Distr.   5%       95%       5%        50%      95%

                           Consumption Process                                     Dividend Process

  µc      N        [-.006    .006]   .0014    .0016      .0019   µd    N        [-.007   .006]   .0000      .0006     .0013
  ρ       NT       [-0.08    0.97]    0.95     0.97       0.98   φ     N        [-13.1   13.4]    2.04       2.11      2.20
  ϕx      G        [ 0.00    0.11]    0.17     0.20       0.22   π     N        [-1.68   1.63]   - 0.18      0.03      0.14
  σ̄      IG       [ .001    .006]   .0021    .0024      .0026   ϕd    G        [ 0.22   11.9]    4.92       5.30      5.78
  ρhc     NT       [-0.08    0.97]    .993     .995       .997   ρhd   NT       [-0.08   0.97]    0.83       0.89      0.94
  σhc     IG       [0.22     1.03]    0.31     0.39       0.49   σhd   IG       [0.22    1.03]    0.47       0.53      0.61
  ρhx     NT       [-0.08    0.97]    .979     .992       .998
  σhx     IG       [0.22     1.03]    0.23     0.43       1.07

Notes: We utilize the mixed-frequency approach in the estimation: For consumption we use annual data from 1929 to
1959 and monthly data from 1960:M1 to 2011:M12; we use monthly dividend growth data from 1929:M1 to 2011:M12.
For consumption we adopt the measurement error model of Section 3.1. We fix ϕc in (2) at ϕc = 1. N , N T , G,
and IG denote normal, truncated (outside of the interval (−1, 1)) normal, gamma, and inverse gamma distributions,
respectively.


model is the large estimate of ρ, the autocorrelation coefficient of the persistent cash flow component
xt . The posterior median of ρ is 0.97. Thus, according to our estimate, cash flow growth dynamics
are very different from iid dynamics; the half-life of the persistent component is about three years;
and the magnitude of the parameter estimate is quite close to the values used in the LRR literature
as, for example, in Bansal, Kiku, and Yaron (2012a)).5

  At first glance, the large estimate of ρ may appear inconsistent with the negative sample au-
tocorrelation of consumption growth and the near-zero autocorrelation of dividend growth at the
monthly frequency reported in the third panel of Table 1. However, these sample moments con-
found the persistence of the “true” cash flow processes and the dynamics of the measurement
errors. Our state-space framework is able to disentangle the various components of observed cash
flow growth, thereby detecting a highly persistent predictable component xt that is hidden under a
layer of measurement errors. Based on our measurement-error model, we can compute the fraction
of the variance of observed consumption growth that is due to measurement errors. In a constant-
volatility version of our state-space model, 46% of the observed consumption growth variation at
the monthly frequency is due to measurement errors. For annualized consumption growth data,
this fraction drops below 1%.
   5
       Hansen, Heaton, and Li (2008) provide a related measure of the long-run component based on their estimated
cointegration model.
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                 16


  The estimation results also provide strong evidence for stochastic volatility. According to the
posteriors reported in Table 2, both σc,t and σd,t exhibit significant time variation. The posterior
medians of ρhc and ρhd are .995 and 0.89, respectively, and the unconditional volatility standard
deviations σhc and σhd are 0.39 and 0.53, respectively. Also, the volatility of the growth prospect
component, σx,t , shows clear evidence for time variation: the posterior medians of ρhx and σhx are
0.992 and 0.43, respectively. It is evident that the estimation supports three independent volatility
processes for consumption growth and dividend growth.

Robustness. The evidence for a persistent component in consumption and dividend growth is
robust to the choice of estimation sample. We shift the beginning of our estimation sample from
1929:M1 to 1959:M1 and use only monthly data. Given that this shorter sample is dominated by
the Great Moderation and does not contain the fluctuations associated with the Great Depression,
this sample should be conservative in terms of providing evidence for predictable component and
aggregate stochastic volatility. Interestingly, we obtain similar estimates of ρ and find that changes
in the estimates of the other parameters are generally small.6 In all, this sample also provides
strong evidence for a predictable component as well as stochastic volatility in consumption and
dividends.


4.3      Estimation with Cash Flow and Asset Return Data

We now include data on market returns and the risk-free rate in the estimation of our state-space
model. Recall from Section 2 that we distinguish between a benchmark model and a generalized
model that allows for a shock to the time rate of preference. We will report estimates for both
specifications and discuss the role played by the preference shock in fitting our observations.

Prior Distribution. The prior distribution for the parameters associated with the exogenous
cash flow process are the same as the ones used in Section 4.2. Thus, we focus on the preference
parameters that affect the asset pricing implications of the model. Percentiles for the prior are
reported in the left-side columns of Table 3. The prior for the discount rate δ reflects beliefs about
the magnitude of the risk-free rate. For the asset pricing implications of our model, it is important
whether the IES is below or above 1. Thus, we choose a prior that covers the range from 0.3 to 3.5.
The 90% prior credible interval for the risk-aversion parameter γ ranges from 3 to 15, encompassing
the values that are regarded as reasonable in the asset pricing literature. We also use the same prior
for the persistence and the innovation standard deviation of the preference shock as we did for the
cash flow parameters ρ and σ̄. Finally, we assume that consumption growth is measured without
  6
      For brevity these results are not displayed, but they are available upon request.
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                            17


                                          Table 3: Posterior Estimates

                                                     Benchmark Model            Generalized Model
                                 Prior                      Posterior                   Posterior
                       Distr.   5%           95%      5%      50%       95%       5%      50%       95%

                                                       Preferences

                 δ     B        [.9951     .9999]   .9992    .9996      .9998   .9990    .9992      .9996
                 ψ     G        [0.31       3.45]    1.62      1.70      1.75    1.33      1.36      1.44
                 γ     G        [2.74      15.45]   10.14    10.84      11.37    9.88      9.97     10.32
                 ρλ    NT       [-0.08      0.97]       -         -         -    .935      .936      .938
                 σλ    IG       [.001       .006]       -         -         -   .0003    .0004      .0005

                                                      Consumption

                 µc    N        [-.006      .006]       -    .0016          -       -    .0016          -
                 ρ     NT       [-0.08      0.97]    .989      .993      .994    .990      .992      .994
                 ϕx    G        [0.00       0.11]    0.03      0.04      0.04    0.02      0.02      0.03
                 σ̄    IG       [.001       .006]    .004      .005      .006    .003      .004      .005
                 ρhc   NT       [-0.08      0.97]    .944      .956      .967   0.943      .946      .951
                 σhc   IG       [0.22       1.03]    0.55      0.60      0.67    0.83      0.84      0.84
                 ρhx   NT       [-0.08      0.97]    .981      .990      .993    .990      .992      .994
                 σhx   IG       [0.22       1.03]    0.50      0.53      0.54    0.56      0.57      0.57

                                                        Dividend

                 µd    N        [-.007      .006]       -    .0010          -       -    .0010          -
                 φ     N        [-13.07    13.40]    3.01      3.20      3.45    3.09      3.11      3.13
                 π     N        [-1.68      1.63]    1.08      1.17      1.25    1.13      1.19      1.31
                 ϕd    G        [0.22      11.90]    5.39      5.46      5.68    6.27      6.30      6.48
                 ρhd   NT       [-0.08      0.97]    .936      .940      .947    .939      .949      .952
                 σhd   IG       [0.22       1.03]    0.44      0.45      0.46    0.56      0.57      0.57

Notes: The estimation results are based on annual consumption growth data from 1930 to 1960 and monthly con-
sumption growth data from 1960:M1 to 2011:M12. For the other three series we use monthly data from 1929:M1 to
2011:M12. We fix µc = 0.0016, µd = 0.0010, and ϕc = 1 in the estimation. B, N , N T , G, and IG are beta, normal,
truncated (outside of the interval (−1, 1)) normal, gamma, and inverse gamma distributions, respectively.


error at the annual frequency. We estimate measurement errors only for monthly consumption
growth rates and the risk-free rates, using the same prior distributions as for σ̄.

Posterior Distribution. The remaining columns of Table 3 summarize the percentiles of the
posterior distribution for the parameters of the benchmark model and the generalized model. While
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                 18


the estimated cash flow parameters are, by and large, similar to those reported in Table 2 when
asset prices are not utilized, a few noteworthy differences emerge. The estimate of ρ, the persistence
of the predictable cash flow component, increases from 0.97 to 0.99 to capture part of the equity
premium. The time variation in the volatility of the long-run risk innovation, σhx , also increases,
reflecting the information in asset prices about growth uncertainty. The estimate of ϕx drops
from 0.20 to 0.03, which reduces the model-implied predictability of asset returns and consumption
growth and brings it more in line with the data. Finally, the estimate of σ̄ increases by a factor of
2 to explain the highly volatile asset prices data.

  Overall, the information from the market returns and risk-free rate reduces the posterior un-
certainty about the cash flow parameters and strengthens the evidence in favor of a time-varying
conditional mean of cash flow growth rates as well as time variation in the volatility components.
Table 3 also provides the estimated preference parameters. The IES is estimated above 1 with a
relatively tight credible band. Risk aversion is estimated at 11 for the benchmark model and 10
for the generalized model.

Matching First and Second Moments. Much of the asset pricing literature, e.g., Bansal,
Gallant, and Tauchen (2007), Bansal, Kiku, and Yaron (2012a), and Beeler and Campbell (2012),
uses unconditional moments to calibrate or estimate model parameters and judge model fit. While
these moments implicitly enter the likelihood function of our state-space model, it is instructive to
examine the extent to which sample moments implied by the estimated state-space model mimic the
sample moments computed from our actual data set. To do so, we conduct a posterior predictive
check (see, for instance, Geweke (2005) for a textbook treatment). We use previously generated
draws Θ(s) , s = 1, . . . , nsim , from the posterior distribution of the model parameters p(Θ|Y ) and
simulate for each Θ(s) the benchmark and the generalized LLR models for 996 periods, which
corresponds to the number of monthly observations in our estimation sample.7 This leads to nsim
simulated trajectories, which we denote by Y (s) . For each of these trajectories, we compute various
sample moments, such as means, standard deviations, cross correlations, and autocorrelations.
Suppose we denote such statistics generically by S(Y (s) ). The simulations provide a characterization
of the posterior predictive distribution p(S(Y (s) )|Y ). Percentiles of this distribution for various
sample moments are reported in Table 4. The table also lists the same moments computed from U.S.
data. “Actual” sample moments that fall far into the tails of the posterior predictive distribution
provide evidence for model deficiencies. The moments reported in Table 4 are computed for year-
on-year cash flow growth rates. Market returns, the risk-free rate, and the price-dividend ratio are
12-month averages.
  7
      To generate the simulated data, we also draw measurement errors.
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                                    19


                        Table 4: Moments of Cash Flow Growth and Asset Prices

                                       Data       Benchmark Model             Generalized Model
                                                  5%       50%      95%       5%       50%       95%

                  Mean (∆c)             1.83     0.91      1.89     2.79      0.88     1.93      2.86
                  StdDev (∆c)           2.19     1.65      2.19     2.99      1.52     2.22      3.49
                  AC1 (∆c)              0.48     0.09      0.32     0.56      0.08     0.33      0.57

                  Mean (∆d)             1.00     -2.55     1.02     4.61     -2.27     1.30      4.68
                  StdDev (∆d)          11.15    11.01     13.29     16.60    10.35     12.97    16.99
                  AC1 (∆d)              0.20     -0.19     0.03     0.23     -0.20     0.03      0.27
                  Corr (∆c, ∆d)         0.55     0.12      0.32     0.51      0.13     0.34      0.56

                  Mean (rm )            5.71     1.88      5.10     8.46      2.40     5.61      9.64
                  StdDev (rm )         19.95    14.70     20.30     38.04    13.38     19.99    46.21
                  AC1 (rm )            -0.01     -0.28    -0.06     0.17     -0.28     -0.05     0.17
                  Corr (∆c, rm )        0.12     -0.03     0.18     0.39     -0.06     0.17      0.40

                  Mean (rf )            0.44     -0.44     0.46     1.21     -0.39     0.67      1.49
                  StdDev (rf )          2.88     2.47      2.87     3.45      1.26     1.96      4.29
                  AC1 (rf )             0.64     -0.13     0.07     0.30      0.13     0.43      0.66

                  Mean (pd)             3.36     2.90      3.24     3.41      2.72     3.15      3.36
                  StdDev (pd)           0.45     0.15      0.27     0.64      0.13     0.27      0.86
                  AC1 (pd)              0.86     0.50      0.74     0.87      0.47     0.74      0.89

Notes: We present descriptive statistics for aggregate consumption growth (∆c), dividends growth (∆d), log returns
of the aggregate stock market (rm ), the log risk-free rate (rf ), and the log price-dividend ratio (pd). We report means
(Mean), standard deviations (StdDev), first-order sample autocorrelations (AC1), and correlations (Corr). Cash flow
growth rates are year-on-year (in percent); market returns, the risk-free rate, and the price-dividend ratio refer to
12-month averages (in percent).


  We first focus on the results from the benchmark model. Except for the first-order autocorrelation
(AC1) of the risk-free rate rf , all of the “actual” sample moments are within the 5th and the 95th
percentile of the corresponding posterior predictive distribution. The variance of the posterior
predictive distribution reflects the uncertainty about model parameters as well as the variability
of the sample moments. The 90% credible intervals for the consumption growth and risk-free rate
moments are much smaller than the intervals for the dividend growth and market-return moments,
indicating that much of the uncertainty in the posterior predictive moments is due to the variability
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                 20


of the sample moments themselves. The high volatility of dividend growth and market returns
translates into a large variability of their sample moments.

  More specifically, the benchmark model replicates well the first two moments of consumption
and dividend growth and their correlation. The benchmark model also generates a sizable equity
risk premium with a median value of 6%. The model’s return variability is about 20% with the
market return being not highly autocorrelated. As in the data, the model generates both a highly
variable and persistent price-dividend ratio. It is particularly noteworthy that the median and 95th
percentile of the price-dividend volatility distribution are significantly larger than in other LRR
calibrated models with Gaussian shocks. This feature owes in part to the fact that the models
contain three volatility components with underlying log-volatility dynamics, thus accommodating
some non-Gaussian features.

  The sample moments implied by the generalized model are very similar to those of the benchmark
model, except for the moments associated with the risk-free rate. Most notably, the benchmark
model generates a slightly negative autocorrelation of the risk-free rate, whereas the generalized
model with the preference shock is able to reproduce the strongly positive serial correlation in the
data.

Risk-Free Rate Dynamics. Our estimated state-space model can be used to decompose the
observed risk-free rate into the “true” risk-free rate and a component that is due to measurement
errors. Figure 1 overlays the actual risk rate and the smoothed “true” or model-implied risk-free
rate. It is clear from the top panel of the figure that the model has difficulties generating the high
volatility of the risk-free rate in the pre-1960 sample, the 1980s, and the period since 2002. The
benchmark model attributes these fluctuations to measurement errors. Recall that the risk-free
rate series is constructed by subtracting random-walk inflation forecasts from a nominal interest
rate series, which makes the presence of measurement errors plausible. In particular, our nominal
interest rate series includes several periods with negative nominal yields in the period from 1938
to 1941. The pre-1960 sample also contains periods with artificially large inflation rates, which are
partly due to price adjustments following price controls after World War II. Overall, the estimated
benchmark model implies that about 70-80% of the fluctuations in the risk-free rate are due to
measurement errors.

  The generalized model with the preference shock λt is able to track the risk-free rate much
better than the benchmark model. By construction, λt generates additional fluctuations in the
model-implied expected stochastic discount factor and hence the model-implied risk-free rate. The
likelihood-based estimation procedure reverses this logic. Persistent movements in the observed
risk-free rate suggest that λt fluctuated substantially between 1929 and 2011. The fraction of the
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                                21


                                    Figure 1: Model-Implied Risk-Free Rate

                                                 (a) Benchmark Model




                                                (b) Generalized Model




Notes: Blue lines depict the actual risk-free rate, and black lines depict the smoothed, model-implied risk-free rate
without measurement errors.


fluctuations in the risk-free rate attributed to measurement errors is now much smaller. In fact,
the bottom panel of Figure 1 illustrates that the difference between the observed series and the
smoothed, model-implied series is now very small. This is consistent with the predictive checks
reported in Table 4. Since the generalized model is more successful at tracking the observed risk-
free rate, we focus on the model specification with preference shock in the remainder of this section
unless otherwise noted.8

Smoothed Mean and Volatility States. Figure 2 depicts smoothed estimates of the predictable
component xt and the preference shock process xλ,t . Since the estimate of xt is, to a large extent,
determined by the time path of consumption, the 90% credible bands are much wider prior to 1960,
when only annual consumption growth data were used in the estimation. Post 1959, xt tends to
   8
       An alternative way to interpret the preference shocks is that the model requires correlated measurement errors
to capture the time series dynamics of the real risk-free rate.
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                              22


                                      Figure 2: Smoothed Mean States




Notes: Black lines represent posterior medians of smoothed states and gray-shaded areas correspond to 90% credible
intervals. In the top panel we overlay the smoothed state xt obtained from the estimation without asset prices (red
dashed line) and monthly consumption growth data (blue solid line). In the bottom panel we overlay a standardized
version of the risk-free rate (blue solid line). Shaded bars indicate NBER recession dates.


fall in recessions (indicated by the shaded bars in Figure 2), but periods of falling xt also occur
during expansions. We overlay the smoothed estimate of xt obtained from the estimation without
asset price data (see Section 4.2). It is very important to note that the two estimates are similar,
which highlights that xt is, in fact, detectable based on cash flow data only. We also depict the
monthly consumption growth data post 1959, which confirms that xt indeed captures low-frequency
movements in consumption growth. A visual comparison of the smoothed xλ,t process with the
standardized risk-free rate in the bottom panel of Figure 2 confirms that the preference shock in
the generalized model mainly helps track the observed risk-free rate.

  The smoothed volatility processes are plotted in Figure 3. Recall that our model has three
independent volatility processes, hc,t , hd,t , and hx,t , associated with the innovations to consumption
growth, dividend growth, and the predictable component, respectively. The most notable feature of
hc,t is that it captures a drop in consumption growth volatility that occurred between 1950 and 1965.
In magnitude, this drop in volatility is much larger than a subsequent decrease around 1984, the
year typically associated with the Great Moderation. The stochastic volatility process for dividend
growth shows a drop around 1955, but it also features an increase in volatility starting in 2000,
which is not apparent in hc,t . Overall, the smoothed hd,t seems to exhibit more medium- and high-
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                             23


                                   Figure 3: Smoothed Volatility States




Notes: Black lines represent posterior medians of smoothed states and gray-shaded areas correspond to 90% credible
intervals. Shaded bars indicate NBER recession dates.


frequency movements than hc,t . Finally, the volatility of the persistent component, hx,t , exhibits
substantial fluctuations over our sample period, and it tends to peak during NBER recessions.

Determinants of Asset Price Fluctuations. After a visual inspection of the latent mean and
volatility processes in Figures 2 and 3, we now examine their implications for asset prices. In
equilibrium, the market returns, the risk-free rate, and the price-dividend ratios are functions of
the mean and volatility states. Figure 4 depicts the contribution of various risk factors: namely,
the variation in growth prospects, xt , the preference shock, xλ,t , and the conditional variability of
growth prospects, σx,t , to asset price volatility. Given the posterior estimates of our state-space
model, we can compute smoothed estimates of the latent asset price volatilities at every point
in time. Moreover, we can also generate counterfactual volatilities by shutting down xt , xλ,t , or
σx,t . The ratio of the counterfactual and the actual volatilities measures the contribution of the
non-omitted risk factors. If we subtract this ratio from 1, we obtain the relative contribution of
the omitted risk factor, which is shown in Figure 4.
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                                         24


               Figure 4: Variance Decomposition for Market Returns and Risk-Free Rate

                                                 (a) Market Returns: rm




                                            (b) Log Price Dividend Ratio: pd




                                                  (c) Risk-Free Rate: rf




Notes: Fraction of volatility fluctuations (in percent) in the market returns, the price-dividend ratio, and the risk-free
                                     2                                                     2      2
rate that is due to xt , xλ,t , and σx,t , respectively. We do not present the graphs for σc,t , σd,t since their time-varying
shares are less than 1% on average. See the main text for computational details.


  While the preference shocks are important for the risk-free rate, they contribute very little to
the variance of the price-dividend ratio and the market return. The figure shows that most of the
variability of the price-dividend ratio is, in equal parts, due to the variation in xt and σx,t . As
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                25


Appendix A shows, the risk premium on the market return is barely affected by the preference
shocks and consequently its variation is almost entirely attributable to the time variation in the
                       2 and the growth prospect x . The remaining risk factors σ 2 and σ 2 have
stochastic volatility σx,t                        t                              c,t     d,t
negligible effects (less than 1% on average) on asset price volatilities.

  We assumed that in our endowment economy the preference shock is uncorrelated with cash flows.
In a production economy this assumption will typically not be satisfied. Stochastic fluctuations
in the discount factor generate fluctuations in consumption and investment, which in turn affect
cash flows. To assess whether our assumption of uncorrelated shocks is contradicted by the data,
we computed the correlation between the smoothed preference shock innovations ηλ,t and the cash
flow innovations ηc,t and ηx,t . We can do so for every parameter draw Θ(s) from the posterior
distribution. The 90% posterior predictive intervals range from -0.09 to 0.03 for the correlation
between ηλ,t and ηc,t and from 0 to 0.2 for the correlation between ηλ,t and ηx,t . Based on these
results we conclude that there is no strong evidence that contradicts the assumption of uncorrelated
preference shocks.

Predictability. One aspect of the data that is often discussed in the context of asset pricing models
— and in particular, in the context of models featuring long-run risks — is the low predictability
of future consumption growth by the current price-dividend ratio. Another key issue in the asset
pricing literature is return predictability by the price-dividend ratio (e.g., Hodrick (1992)). We
address these two issues in Figure 5 where we regress cumulative consumption growth and multi-
period excess returns on the current price-dividend ratio using OLS:
                                        H
                                        X
                                              ∆ct+h = α + βpdt + residt+H
                                        h=1
                          H
                          X
                                (rm,t+h − rf,t+h−1 ) = α + βpdt + residt+H .
                          h=1

The results are presented as posterior predictive checks, similar to those in Table 4, but now
depicted graphically. The statistics S(Y ) considered are the R2 values obtained from the two
regressions. The top and bottom ends of the boxes correspond to the 5th and 95th percentiles,
respectively, of the posterior predictive distribution, and the horizontal bars signify the medians.
The contribution of parameter uncertainty to the posterior predictive distribution is negligible.
The predictive intervals reflect the fact that we are repeatedly generating data from the model and
computing the sample statistics S(Y ) for each of these simulated trajectories. Finally, the small
squares correspond to statistics computed from “actual” U.S. data.

  The left panel of Figure 5 documents the predictability of consumption growth. While the model’s
median R2 value is somewhat larger (red lines) than the corresponding data estimate, the model’s
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                              26


                                Figure 5: Univariate Predictability Checks

                Consumption Growth                                          Excess Returns




Notes: Black boxes indicate regression R2 values from actual data. Figure also depicts medians (red lines) and 90%
credible intervals (top and bottom lines of boxes) of distribution of R2 values obtained with model-generated data.


finite sample R2 distribution for consumption growth encompasses the low data estimate. In terms
of return predictability, depicted in the right panel of Figure 5, the model’s median R2 for the
five-year horizon R2 is large at 15%, with a 95 percentile value of 47% that clearly contains the
data estimate. These model-implied R2 s are larger than what is typically found in models with
long-run risks (e.g., Bansal, Kiku, and Yaron (2012a)) — a feature attributable to the presence of
the three exponential volatility processes that allow this model specification for an improved fit.

  One may wonder whether the large predictive intervals depicted in Figure 5 are an artifact of the
LRR model used in our empirical analysis. To investigate this issue, we replaced the model-implied
structural relationship between the price-dividend ratio and our state variables by a reduced-form
relationship that was obtained by regressing the price-dividend ratio on the smoothed states using
an unrestricted OLS regression. We used the Campbell-Shiller approximation to map the predicted
price-dividend ratio into market returns. A predictive check based on the reduced-form relationship
yields credible intervals that were of similar size as the ones depicted in Figure 5. We concluded
from this exercise that it is not the LRR mechanism that generates the sampling uncertainty of the
R2 but the fact that the R2 values are obtained from regressions in which the persistent component
of the dependent variable (consumption growth or excess returns) is dominated by iid shocks and
the right-hand-side regressor is highly persistent. In fact, Valkanov (2003) derived an asymptotic
distribution of the R2 under the assumption that the regressor follows a local-to-unity process. He
shows that the goodness-of-fit measure converges to a random limit as the sample size increases. The
predictive intervals in Figure 5 essentially capture the quantiles of this limit distribution because
the effect of posterior parameter uncertainty on the predictive distribution is very small and our
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                              27


                                   Figure 6: VAR Predictability Checks

                Consumption Growth                                          Excess Returns




Notes: Black boxes indicate VAR R2 values from actual data. The figure also depicts medians (red lines) and 90%
credible intervals (top and bottom lines of boxes) of distribution of R2 values obtained with model-generated data.


sample size is large.

  It is well known that, in the data, the price-dividend ratio is very persistent, a feature that
can render the aforementioned regressions spurious (see Hodrick (1992) and Stambaugh (1999)).
In the model, and possibly in the data, the price-dividend ratio reflects multiple state variables.
Consequently, a VAR-based predictive regression may offer a more robust characterization. As in
Bansal, Kiku, and Yaron (2012a), Figure 6 displays the predictability of consumption growth and
the market excess returns based on a first-order VAR that includes consumption growth, the price-
dividend ratio, the real risk-free rate, and the market excess return. The first thing to note is that,
with multiple predictive variables, consumption growth is highly predictable. The VAR provides
quite a different view on consumption predictability relative to the case of using the price-dividend
ratio as a univariate regressor. In particular, now consumption growth predictability at the one-
year horizon is very large with an R2 of about 55% (see also Bansal, Kiku, Shaliastovich, and Yaron
(2013)). While the predictability diminishes over time, it is still nontrivial with an R2 of 14% at
the 10-year horizon. It is important to note that the model-based VAR yields very comparable
results (and in fact yields a median R2 for the one-year horizon that is somewhat lower than its
data estimate). On the other hand, since long-horizon return predictability is highly influenced
by the price-dividend ratio, the VAR-based implications for excess return predictability do not
change much relative to the univariate estimates. Nonetheless, the model performs well along this
dimension and its generated VAR-based R2 s are closer to their VAR data estimates, relative to the
R2 s based on univariate price-dividend regressor.
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                                  28


         Figure 7: Correlation between Market Return and Growth Rates of Fundamentals
                   PH              PH                                       PH               PH
           Corr(    h=1 rm,t+h ,    h=1 ∆ct+h )                     Corr(     h=1 rm,t+h ,    h=1 ∆dt+h )




Notes: Black boxes indicate sample correlations of actual data. The figure also depicts medians (red lines) and 90%
credible intervals (top and bottom lines of boxes) of distribution of sample correlations obtained with model-generated
data.


  One additional feature in which the generalized model performance is improved relative to the
benchmark model is the correlation between long-horizon return and long-horizon dividend and
consumption growth. Figure 7 presents these correlations in the data and the model. In the model,
the 10-year consumption growth and 10-year return have a correlation of 0.3, but with enormous
standard deviations that encompass -0.3 to 0.7, which contain the data estimate. The analogous
correlations for dividend growth are 0 to 0.9 with the data at 0.5 close to the model median estimate.
In the benchmark model, without the xλ process, this last correlation will be quite a bit larger for
all percentiles and would be a challenging dimension for the model.

IES Parameter. It is well understood that whether the IES parameter is above or below 1
plays a significant role in the asset pricing implication of the model. One common approach for
estimating the IES has been to regress the growth rate of consumption on the risk-free rate (e.g., Hall
(1988)). Bansal and Yaron (2004) and Bansal, Kiku, and Yaron (2012a) show that this regression is
misspecified in the presence of stochastic volatility and leads to downward-biased estimates of the
IES. Given that our estimation formally ascribes measurement errors to both consumption and the
risk-free rate, we revisit the implication of this regression for inference on the IES. For completeness,
we also run the reverse equation of regressing the risk-free rate on consumption growth. We use
the two-year lagged consumption growth, log price-dividend ratio, market return, and risk-free rate
as instrumental variables. As shown in Table 5, in both regression approaches the data based
estimates are in fact negative, but lie well within the very wide 90% model-based credible band,
even though in all model simulations the IES was set to its median estimate of 1.36. In totality,
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                                  29


                        Table 5: ψ (IES) from Instrumental Variables Estimation

                                  Specification      Data     Generalized Model
                                                               5%      50%     95%

                                  ∆c onto rf         -0.30    -0.45    0.56    1.50
                                  rf onto ∆c         -0.90    -5.53    1.26    6.80

Notes: The first row provides finite sample values of the ψ from the regression ∆ct+1 = constant + ψrf,t+1 + residt+1 ,
while the second row provides the ψ values from the regression rf,t+1 = constant+ ψ1 ∆ct+1 +residt+1 . The instruments
are lagged (two years) consumption growth, log price-dividend ratio, market return, and risk-free rate. The “true” ψ
value in the model is 1.36 from Table 3. Regressions are implemented at an annual frequency.


this evidence shows that, with the estimated levels of measurement errors, it is very difficult to
precisely estimate the IES via this regression approach.

Term Structure of Real Yields. Next, we briefly discuss the model implications for the term
structure of real yields. The evidence on the slope of the term structure of real bonds is mixed.
The data for the U.K., the longest sample available for real bond data, suggests the real yield
curve is downward sloping (see Evans (2003)). The evidence for the U.S. suggests a slight upward
sloping curve (see Gurkaynak, Sack, and Wright (2010)). However, it is well recognized that the
U.S. sample is very short and that the Treasury Inflation-Protected Securities (TIPS) market is
relatively illiquid. Posterior predictive distributions for average real yields are depicted in Figure 8.
The right panel of the figure is based on the generalized model with preference shock, whereas we
set xλ,t = 0 to generate the results presented in the left panel. We show predictive distributions
for the level of the 1-year yield and consider yield spreads of 5-year, 10-year, and 30-year securities
relative to the 1-year bond. The benchmark model, which abstracts from preference shocks, leads to
a very mild downward sloping real yield curve (model’s median estimates across simulations display
a decline of 50 basis points (bps) from the 1 year to the 30 year yield respectively). This feature
of the long-run risk model is well recognized (see Bansal, Kiku, and Yaron (2012a)) as well as the
fact that an upward nominal term structure will result if consumption growth and inflation are
negatively correlated as is the case in the data (see Piazzesi and Schneider (2006) and Bansal and
Shaliastovich (2013)). Our generalized model leads to a slight upward sloping real term structure
(an increase of about 100 bps when comparing the 30-year to the 1-year yield).

  We can use our state-space model to compute a time-path for the bond yields conditional on
the smoothed states. The results for 5, 10, and 20-year yields are depicted in Figure 9. We also
plot actual yields based on TIPS data obtained from the Board of Governors. Before and after the
Great Recession, the model tracks the TIPS data very well, despite the fact that they have not
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                                 30


                                  Figure 8: Term Structure of Real Yields

                  Model with xλ,t = 0                                       Generalized Model
    6                                                        6

    5                                                        5

    4                                                        4

    3                                                        3

    2                                                        2

    1                                                        1

    0                                                        0

   −1                                                       −1

   −2                                                       −2
           1Y         5Y−1Y       10Y−1Y       30Y−1Y               1Y         5Y−1Y        10Y−1Y       30Y−1Y


Notes: Boxes indicate 90% credible intervals for the posterior predictive distribution of the average 1-year yield and
three term spreads. Horizontal red lines indicate actuals computed from TIPS data of Gurkaynak, Sack, and Wright
(2010) updated by the Board of Governors.


                          Figure 9: Model-Implied vs. Actual Real Bond Yields




Notes: Black lines represent posterior medians of smoothed states and gray-shaded areas correspond to 90% credible
intervals. Blue lines indicate TIPS data from Gurkaynak, Sack, and Wright (2010). Shaded bars indicate NBER
recession dates.


been used to estimate the latent states. During the Great Recession, model predictions and actual
data move in the opposite direction. At that time the TIPS market was very illiquid and perhaps
mispriced (see, e.g. Lustig, Longstaff, and Fleckenstein (2014)), which can account for the artificial
low prices and high yields.
Schorfheide, Song, and Yaron (2014): June 24, 2014                                                31


5    Conclusion

We developed a nonlinear state-space model to capture the joint dynamics of consumption, divi-
dend growth, and asset returns. Building on Bansal and Yaron (2004), our model consists of an
economy containing a common predictable component for consumption and dividend growth and
multiple stochastic volatility processes. To maximize the economic span of the data for recovering
the predictable components and maximizing the frequency of data for efficiently identifying the
volatility processes, we use mixed-frequency data. Our econometric framework is general enough
to encompass other asset pricing models that can be written as state-space models that are linear
conditional on the volatility states. A careful modeling of measurement errors in consumption
growth reveals that the predictable cash flow component can be identified from consumption and
dividend growth data only. The additional inclusion of asset prices sharpens the inference. The
inclusion of two additional volatility processes improves the model fit considerably. The preference
shock included in the generalized version of our model mostly captures the dynamics of the risk-free
rate, but has little effect on market returns and price-dividend ratios. Overall, the estimated model
is able to capture key asset-pricing facts of the data.
References
Albuquerque, R., M. Eichenbaum, and S. Rebelo (2012): “Valuation Risk and Asset Pric-
  ing,” NBER Working Paper No. 18617.

Andreasen, M. (2010): “Stochastic Volatility and DSGE Models,” Economics Letters, 108, 7–9.

Andrieu, C., A. Doucet, and R. Holenstein (2010): “Particle Markov Chain Monte Carlo
  Methods (with Discussion),” Journal of the Royal Statistical Society, Series B, 72, 1–33.

Aruoba, S., F. Diebold, and C. Scotti (2009): “Real-Time Measurement of Business Condi-
  tions,” Journal of Business and Economic Statistics, 27(4), 417–427.

Bansal, R., R. F. Dittmar, and C. T. Lundblad (2005): “Consumption, Dividends, and the
  Cross-Section of Equity Returns,” Journal of Finance, 60(4), 1639–1672.

Bansal, R., A. Gallant, and G. Tauchen (2007): “Rational Pessimism, Rational Exuberance,
  and Asset Pricing Models,” Review of Economic Studies, 74, 1005–1033.

Bansal, R., V. Khatacharian, and A. Yaron (2005): “Interpretable Asset Markets?,” Euro-
  pean Economic Review, 49, 531–560.

Bansal, R., D. Kiku, I. Shaliastovich, and A. Yaron (2013): “Volatility, the Macroeconomy
  and Asset Prices,” Journal of Finance.

Bansal, R., D. Kiku, and A. Yaron (2012a): “An Empirical Evaluation of the Long-Run Risks
  Model for Asset Prices,” Critical Finance Review, 1, 183–221.

         (2012b): “Risks for the Long Run: Estimation with Time Aggregation,” Manuscript,
  University of Pennsylvania and Duke University.

Bansal, R., and I. Shaliastovich (2013): “A Long-Run Risks Explanation of Predictability
  Puzzles in Bond and Currency Markets,” Review of Financial Studies, 26, 1–33.

Bansal, R., and A. Yaron (2000): “Risks For the Long Run: A Potential Resolution of Asset
  Pricing Puzzles,” NBER Working Paper, 8059.

Bansal, R., and A. Yaron (2004): “Risks For the Long Run: A Potential Resolution of Asset
  Pricing Puzzles,” Journal of Finance, 59, 1481–1509.

Barro, R. (2009): “Rare Disasters, Asset Prices, and Welfare Costs,” American Economic Review,
  99, 243–264.
Schorfheide, Song, and Yaron (2014): June 24, 2014                                           33


Beeler, J., and J. Campbell (2012): “The Long-Run Risks Model and Aggregate Asset Prices:
  An Empirical Assessment,” Critical Finance Review, 1, 141–182.

Bloom, N. (2009): “The Impact of Uncertainty Shocks,” Econometrica, 77, 623–685.

Campbell, J., and R. Shiller (1988a): “The Dividend-Price Ratio and Expectations of Future
  Dividends and Discount Factors,” Review of Financial Studies, 1, 195–227.

         (1988b): “Stock Prices, Earnings, and Expected Dividends,” Journal of Finance, 43,
  661–676.

Chen, R., and J. Liu (2000): “Mixture Kalman Filters,” Journal of the Royal Statistical Society
  Series B, 62, 493–508.

Chernov, M., R. Gallant, E. Ghysels, and G. Tauchen (2003): “Alternative Models for
  Stock Price Dynamics,” Journal of Econometrics, 116, 225–257.

Del Negro, M., and F. Schorfheide (2010): “Bayesian Macroeconometrics,” in Handbook of
  Bayesian Econometrics, ed. by H. K. van Dijk, G. Koop, and J. Geweke. Oxford University Press.

Epstein, L., and S. Zin (1989): “Substitution, Risk Aversion and the Temporal Behavior of
  Consumption and Asset Returns: A Theoretical Framework,” Econometrica, 57, 937–969.

Evans, M. (2003): “Real Risk, Inflation Risk, and the Term Structure,” The Economic Journal,
  113, 345–389.

Fernández-Villaverde, J., and J. Rubio-Ramı́rez (2011): “Macroeconomics and Volatility:
  Data, Models, and Estimation,” in D. Acemoglu, M. Arellano and E. Deckel (eds.), Advances
  in Economics and Econometrics: Theory and Applications, Tenth World Congress of the Econo-
  metric Society, Cambridge University Press.

Fernández-Villaverde, J., and J. F. Rubio-Ramı́rez (2007): “Estimating Macroeconomic
  Models: A Likelihood Approach,” Review of Economic Studies, 74(4), 1059–1087.

Geweke, J. (2005): Contemporary Bayesian Econometrics and Statistics. New Jersey: John Wiley
  & Sons.

Gurkaynak, R., B. Sack, and J. Wright (2010): “The TIPS Yield Curve and Inflation Com-
  pensation,” American Economic Journal: Macroeconomics, 2(1), 70–92.

Hall, R. (1988): “Intertemporal Substitution in Consumption,” Journal of Political Economy, 96,
  339–357.
Schorfheide, Song, and Yaron (2014): June 24, 2014                                          34


Hansen, L. P., J. C. Heaton, and N. Li (2008): “Consumption Strikes Back? Measuring
  Long-Run Risk,” Journal of Political Economy, 116(2), 260–302.

Harvey, A. (1989): Forecasting, Structural Time Series Models and the Kalman Filter. Cambridge
  University Press.

Hodrick, R. (1992): “Dividend Yields and Expected Stock Returns: Alternative Procedures for
  Inference and Measurement,” Review of Financial Studies, 5, 357–386.

Johannes, M., L. Lochstoer, and Y. Mou (2013): “Learning about Consumption Dynamics,”
  Manuscript, Columbia Business School.

Lustig, H., F. Longstaff, and M. Fleckenstein (2014): “The TIPS-Treasury Bond Puzzle,”
  Journal of Finance, forthcoming.

Mariano, R., and Y. Murasawa (2003): “A New Coincident Index of Business Cycles Based
  on Monthly and Quarterly Series,” Journal of Applied Econometrics, 18, 427–443.

Piazzesi, M., and M. Schneider (2006): “Equilibrium Yield Curves,” NBER Macro Annual,
  pp. 389–442.

Pitt, M., and N. Shephard (1999): “Filtering via Simulation: Auxiliary Particle Filters,” Jour-
  nal of the American Statistical Association, 94, 590–599.

Schorfheide, F., and D. Song (2012): “Real-Time Forecasting with a Mixed-Frequency VAR,”
  Federal Reserve Bank of Minneapolis Working Paper 701.

Shephard, N. (2013): “Martingale Unobserved Component Models,” Manuscript, University of
  Oxford.

Stambaugh, R. F. (1999): “Predictive Regressions,” Journal of Financial Economics, 54, 375–
  421.

Valkanov, R. (2003): “Long-Horizon Regressions: Theoretical Results and Applications,” Journal
  of Financial Economics, 68, 201–232.

Wilcox, D. (1992): “The Construction of the U.S. Consumption Data: Some Facts and Their
  Implications for Empirical Work,” American Economic Review, 82, 922–941.
Schorfheide, Song, and Yaron (2014): Online Appendix                                            A-1


                                            Appendix


A       Solving the Long-Run Risks Model

This section provides solutions for the consumption and dividend claims for the endowment process:

                     gc,t+1 = µc + xt + σc,t ηc,t+1                                           (A.1)
                     gd,t+1 = µd + φxt + πσc,t ηc,t+1 + σd,t ηd,t+1
                      xt+1 = ρxt + σx,t ηx,t+1
                     xλ,t+1 = ρλ xλ,t + σλ ηλ,t+1
                      2
                     σc,t+1 = (1 − νc )(ϕc σ̄)2 + νc σc,t
                                                      2
                                                          + σwc wc,t+1
                      2
                     σx,t+1 = (1 − νx )(ϕx σ̄)2 + νx σx,t
                                                      2
                                                          + σwx wx,t+1
                      2
                     σd,t+1 = (1 − νd )(ϕd σ̄)2 + νd σd,t
                                                      2
                                                          + σwd wd,t+1
                                  ηi,t+1 , ηλ,t+1 , wi,t+1 ∼ N (0, 1),   i ∈ {c, x, d}.

The Euler equation for the economy is

                          Et [exp (mt+1 + ri,t+1 )] = 1,      i ∈ {c, m} ,                    (A.2)

where
                                                        θ
                         mt+1 = θ log δ + θxλ,t+1 −       gc,t+1 + (θ − 1)rc,t+1              (A.3)
                                                        ψ
is the log of the real stochastic discount factor (SDF), rc,t+1 is the log return on the consumption
claim, and rm,t+1 is the log market return. (A.3) is derived in Section A.6 below. Returns are given
by the approximation of Campbell and Shiller (1988a):

                            rc,t+1 = κ0 + κ1 pct+1 − pct + gc,t+1                             (A.4)
                           rm,t+1 = κ0,m + κ1,m pdt+1 − pdt + gd,t+1 .

The risk premium on any asset is
                                        1
                   Et (ri,t+1 − rf,t ) + V art (ri,t+1 ) = −Covt (mt+1 , ri,t+1 ).            (A.5)
                                        2
In Section A.1 we solve for the law of motion for the return on the consumption claim, rc,t+1 . In
Section A.2 we solve for the law of motion for the market return, rm,t+1 . The risk-free rate is
derived in Section A.3. All three solutions depend on linearization parameters that are derived in
Section A.4. Finally, as mentioned above, the SDF is derived in Section A.6.
Schorfheide, Song, and Yaron (2014): Online Appendix                                                             A-2


A.1    Consumption Claim

In order to derive the dynamics of asset prices, we rely on approximate analytical solutions. Specif-
ically, we conjecture that the price-consumption ratio follows

                                                                 2           2
                            pct = A0 + A1 xt + A1,λ xλ,t + A2,c σc,t + A2,x σx,t                                (A.6)

and solve for A’s using (A.1), (A.2), (A.4), and (A.6).

  From (A.1), (A.4), and (A.6)

              κ0 + A0 (κ1 − 1) + µc + κ1 A2,x (1 − νx )(ϕx σ̄)2 + κ1 A2,c (1 − νc )(ϕc σ̄)2
               
   rc,t+1 =                                                                                             (A.7)
             1                                                   2                     2
           +   xt + A1,λ (κ1 ρλ − 1)xλ,t + A2,x (κ1 νx − 1)σx,t    + A2,c (κ1 νc − 1)σc,t
             ψ
           + σc,t ηc,t+1 + κ1 A1 σx,t ηx,t+1 + κ1 A1,λ σλ ηλ,t+1 + κ1 A2,x σwx wx,t+1 + κ1 A2,c σwc wc,t+1

and from (A.1), (A.2), (A.4), and (A.6)

  mt+1 = (θ − 1) κ0 + A0 (κ1 − 1) + κ1 A2,x (1 − νx )(ϕx σ̄)2 + κ1 A2,c (1 − νc )(ϕc σ̄)2
                  
                                                                                                (A.8)
                          1                                        2                             2
       − γµ + θ log δ − xt + ρλ xλ,t + (θ − 1)A2,x (κ1 νx − 1)σx,t    + (θ − 1)A2,c (κ1 νc − 1)σc,t
                          ψ
       − γσc,t ηc,t+1 + (θ − 1)κ1 A1 σx,t ηx,t+1 + {(θ − 1)κ1 A1,λ + θ} σλ ηλ,t+1
           + (θ − 1)κ1 A2,x σwx wx,t+1 + (θ − 1)κ1 A2,c σwc wc,t+1 .

  The solutions for A’s that describe the dynamics of the price-consumption ratio are determined
from
                                                       1
                                  Et [mt+1 + rc,t+1 ] + V art [mt+1 + rc,t+1 ] = 0
                                                       2
and they are
                        1                                                                      θ
                   1−   ψ                       ρλ                  θ
                                                                    2 (κ1 A1 )
                                                                              2
                                                                                               2 (1   − ψ1 )2
           A1 =               ,     A1,λ =             ,   A2,x =                 ,   A2,c =                    (A.9)
                   1 − κ1 ρ                  1 − κ1 ρλ              1 − κ1 νx                  1 − κ1 νc
           A10 +A20
and A0 =    1−κ1 ,    where

                                                1
           A10 = log δ + κ0 + µ(1 −               ) + κ1 A2,x (1 − νx )(ϕx σ̄)2 + κ1 A2,c (1 − νc )(ϕc σ̄)2
                                                ψ
                       θ
           A20 =          (κ1 A1,λ + 1)2 σλ2 + (κ1 A2,x σwx )2 + (κ1 A2,c σwc )2 .
                       2

  For convenience, (A.8) can be rewritten as

  mt+1 − Et [mt+1 ] = λc σc,t ηc,t+1 + λx σx,t ηx,t+1 + λλ σλ ηλ,t+1 + λwx σwx wx,t+1 + λwc σwc wc,t+1 .
Schorfheide, Song, and Yaron (2014): Online Appendix                                                         A-3


Note that λs represent the market price of risk for each source of risk. To be specific,
                                             1     κ1             θ − κ1 ρλ
                λc = −γ,         λx = −(γ −    )          , λλ =            ,                             (A.10)
                                             ψ 1 − κ1 ρ           1 − κ1 ρλ
                         θ(γ − ψ1 )(1 − ψ1 )κ1      κ1     2
                                                                       θ(γ − ψ1 )(1 − ψ1 )κ1
              λwx    = −                       (          ) , λwc = −                        .
                             2(1 − κ1 νx )       1 − κ1 ρ                  2(1 − κ1 νc )

Similarly, rewrite (A.7) as

rc,t+1 − Et [rc,t+1 ] = −βc,c σc,t ηc,t+1 − βc,x σx,t ηx,t+1 − βc,λ σλ ηλ,t+1 − βc,wx σwx wx,t+1 − βc,wc σwc wc,t+1

where

      βc,c = −1,    βc,x = −κ1 A1 ,     βc,λ = −κ1 A1,λ ,    βc,wx = −κ1 A2,x ,     βc,wc = −κ1 A2,c .    (A.11)


  The risk premium for the consumption claim is
                     1
Et (rc,t+1 − rf,t ) + V art (rc,t+1 ) = −Covt (mt+1 , rc,t+1 )                                              (A.12)
                     2
                                                 2              2
                                      = βc,x λx σx,t + βc,c λc σc,t + βc,λ λλ σλ2 + βc,wx λwx σw
                                                                                               2
                                                                                                 x
                                                                                                                2
                                                                                                   + βc,wc λwc σw c
                                                                                                                    .


A.2     Market Return

Similarly, using the conjectured solution to the price-dividend ratio

                                                          2             2             2
             pdt = A0,m + A1,m xt + A1,λ,m xλ,t + A2,x,m σx,t + A2,c,m σc,t + A2,d,m σd,t                 (A.13)

the market return can be expressed as

rm,t+1 = κ0,m + A0,m (κ1,m − 1) + µd + κ1,m A2,x,m (1 − νx )(ϕx σ̄)2                                          (A.14)
         + κ1,m A2,c,m (1 − νc )(ϕc σ̄)2 + κ1,m A2,d,m (1 − νd )(ϕd σ̄)2 + {φ + A1,m (κ1,m ρ − 1)} xt
                                                           2                          2
         + (κ1,m ρλ − 1)A1,λ,m xλ,t + A2,x,m (κ1,m νx − 1)σx,t + A2,c,m (κ1,m νc − 1)σc,t
                                2
         + A2,d,m (κ1,m νd − 1)σd,t + πσc,t ηc,t+1 + σd,t ηd,t+1 + κ1,m A1,m σx,t ηx,t+1 + κ1,m A1,λ,m σλ ηλ,t+1
         + κ1,m A2,x,m σwx wx,t+1 + κ1,m A2,c,m σwc wc,t+1 + κ1,m A2,d,m σwd wd,t+1 .
Schorfheide, Song, and Yaron (2014): Online Appendix                                                     A-4


Given the solution for A’s, Am ’s can be derived as follows:

                               A1st    2nd
                                0,m + A0,m
                   A0,m =                                                                             (A.15)
                                1 − κ1,m
                                           1
                                    φ−     ψ
                   A1,m =
                               1 − κ1,m ρ
                                   ρλ
                  A1,λ,m =
                               1 − κ1,m ρλ
                                1
                                2   {(θ − 1)κ1 A1 + κ1,m A1,m }2 + (θ − 1)(κ1 νx − 1)A2,x
                  A2,x,m =
                                                        1 − κ1,m νx
                                1
                                2 (π   − γ)2 + (θ − 1)(κ1 νc − 1)A2
                  A2,c,m =
                                             1 − κ1,m νc
                                       1
                                       2
                  A2,d,m =                       ,
                               1 − κ1,m νd

where

  A1st                                                                2                           2
                          
   0,m = θ log δ + (θ − 1) κ0 + A0 (κ1 − 1) + κ1 A2,x (1 − νx )(ϕx σ̄) + κ1 A2,c (1 − νc )(ϕc σ̄)

          − γµ + κ0,m + µd + κ1,m A2,x,m (1 − νx )(ϕx σ̄)2 + κ1,m A2,c,m (1 − νc )(ϕc σ̄)2
          + κ1,m A2,d,m (1 − νd )(ϕd σ̄)2
                                                     2                                            2
            1                                               1
  A2nd
   0,m    =    κ1,m A2,x,m σwx + (θ − 1)κ1 A2,x σwx +           κ1,m A2,c,m σwc + (θ − 1)κ1 A2,c σwc
            2                                               2
                              2                                                  2
            1                          1
          +    κ1,m A2,d,m σwd +          κ1,m A1,λ,m σλ + (θ − 1)κ1 A1,λ σλ + θσλ .
            2                          2

  Rewrite market-return equation (A.14) as

rm,t+1 − Et [rm,t+1 ] = −βm,c σc,t ηc,t+1 − βm,x σx,t ηx,t+1 − βm,λ σλ ηλ,t+1 − βm,wx σwx wx,t+1 − βm,wc σwc wc,t+1 ,

where

                      βm,c = −π,               βm,x = −κ1,m A1,m ,   βm,λ = −κ1,m A1,λ,m ,            (A.16)
                    βm,wx    = −κ1,m A2,x,m ,           βm,wc = −κ1,m A2,c,m .


  The risk premium for the dividend claim is
                     1
Et (rm,t+1 − rf,t ) + V art (rm,t+1 ) = −Covt (mt+1 , rm,t+1 )                                              (A.17)
                     2
                                                 2              2
                                      = βm,x λx σx,t + βm,c λc σc,t + βm,λ λλ σλ2 + βm,wx λwx σw
                                                                                               2
                                                                                                 x
                                                                                                                2
                                                                                                   + βm,wc λwc σw c
                                                                                                                    .
Schorfheide, Song, and Yaron (2014): Online Appendix                                                A-5


A.3     Risk-Free Rate

The model-driven equation for the risk-free rate is
                                1
          rf,t = −Et [mt+1 ] − vart [mt+1 ]                                                       (A.18)
                                2
                                          θ                                    1
               = −θ log δ − Et [xλ,t+1 ] + Et [gc,t+1 ] + (1 − θ)Et [rc,t+1 ] − vart [mt+1 ] .
                                          ψ                                    2

Subtract (1 − θ)rf,t from both sides and divide by θ,

                      1              1               (1 − θ)                      1
      rf,t = − log δ − Et [xλ,t+1 ] + Et [gc,t+1 ] +         Et [rc,t+1 − rf,t ] − vart [mt+1 ]   (A.19)
                      θ              ψ                  θ                         2θ

From (A.1) and (A.8)

                                                               2           2
                         rf,t = B0 + B1 xt + B1,λ xλ,t + B2,x σx,t + B2,c σc,t ,

where

                1                                (1 − ψ1 )(γ − ψ1 )κ21               1 γ−1
        B1 =      ,   B1,λ = −ρλ ,    B2,x = −                           ,   B2,c = − (    + γ)   (A.20)
                ψ                                   2(1 − κ1    ρ)2                  2 ψ

and

  B0 = −θ log δ − (θ − 1) κ0 + (κ1 − 1)A0 + κ1 A2,x (1 − νx )(ϕx σ̄)2 + κ1 A2,c (1 − νc )(ϕc σ̄)2
                         

             1                        1                         1
     + γµ − {(θ − 1)κ1 A2,x σwx }2 − {(θ − 1)κ1 A2,c σwc }2 −        ((θ − 1)κ1 A1,λ + θ)2 σλ2 .
             2                        2                         2

A.4     Linearization Parameters

For any asset, the linearization parameters are determined endogenously by the following system
of equations:
                                                      X
                             ¯ = A0,i (pd
                            pd          ¯ )+                             ¯ ) × (ϕj σ̄)2
                                                                A2,i,j (pd
                               i          i                                i
                                                    j∈{c,x,d}
                                            ¯ )
                                       exp(pd i
                            κ1,i   =          ¯ )
                                     1 + exp(pd i
                            κ0,i                  ¯ )) − κ1,i pd
                                   = log(1 + exp(pd            ¯ .
                                                    i           i

                                                                                     ¯ .
The solution is determined numerically by iteration until reaching a fixed point of pd i
Schorfheide, Song, and Yaron (2014): Online Appendix                                                     A-6


A.5    Zero-Coupon Real Bonds

Let pn,t be the log t-price of an n-period zero-coupon real bond. Conjecture that pn,t is a linear
function of state variables

                                                                 2            2
                     pn,t = Cn,0 + Cn,1 xt + Cn,1λ xλ,t + Cn,2x σx,t + Cn,2c σc,t .                (A.21)

The pricing equation implies
                                                    1
                      pn,t = Et [pn−1,t+1 + mt+1 ] + V art [pn−1,t+1 + mt+1 ] .                    (A.22)
                                                    2
The coefficients of the pricing equation are expressed recursively as
                        1
   Cn,1 = Cn−1,1 ρ −                                                                               (A.23)
                        ψ
  Cn,1λ    = Cn−1,1λ ρλ + ρλ
                                                    1
  Cn,2x = Cn−1,2x νx + (θ − 1)A2,x (κ1 νx − 1) +      {Cn−1,1 + (θ − 1)κ1 A1 }2
                                                    2
                                                   1
  Cn,2c    = Cn−1,2c νc + (θ − 1)A2,c (κ1 νc − 1) + γ 2
                                                   2
           = θ log δ + (θ − 1) κ0 + (κ1 − 1)A0 + κ1 A2,x (1 − νx )(ϕx σ̄)2 + κ1 A2,c (1 − νc )(ϕc σ̄)2
                              
   Cn,0
               −γµ + Cn−1,0 + Cn−1,2x (1 − νx )(ϕx σ̄)2 + Cn−1,2c (1 − νc )(ϕc σ̄)2
                                                  2                                 2
                1                                       2  1                              2
               + Cn−1,1λ + {(θ − 1)κ1 A1,λ + θ} σλ +           (θ − 1)κ1 A2,x + Cn−1,2x σw  x
                2                                          2
                                         2
                1                              2
               + (θ − 1)κ1 A2,c + Cn−1,2c σw     c
                2

with initial conditions that C0,1 = C0,1λ = C0,2x = C0,2c = C0,0 = 0. However, in order to develop
economic intuition, it is useful to express them in a non-recursive fashion:

                1 (1 − ρn )
    Cn,1 = −                , n≥1
               ψ (1 − ρ)
                (1 − ρnλ )
  Cn,1λ    = ρλ            , n≥1
                (1 − ρλ )
                                                                           2 
                                              1 (1 − ρn−1 )                     (1 − νxn )
                                         
                                        1
   Cn,2x   =  (θ − 1)A2,x (κ1 νx − 1) +     −               + (θ − 1)κ1 A1                 ,     n≥2
                                        2     ψ (1 − ρ)                         (1 − νx )
                                        1 2 (1 − νcn )
                                          
   Cn,2c   =  (θ − 1)A2,c (κ1 νc − 1) + γ               , n ≥ 1.
                                        2     (1 − νc )

Define return on an n-period zero-coupon bond as

                                      rn,t+1 = pn−1,t+1 − pn,t .
Schorfheide, Song, and Yaron (2014): Online Appendix                                                                 A-7


The risk premium for the bond return is
                        1
   Et (rn,t+1 − rf,t ) + V art (rn,t+1 )                                                                          (A.24)
                        2
     = −covt (mt+1 , rn,t+1 )
                                 2                             2
      = −(θ − 1)κ1 A2,c Cn−1,2c σw c
                                     − (θ − 1)κ1 A2,x Cn−1,2x σw x
                                                                   − {(θ − 1)κ1 A1,λ + θ} Cn−1,1λ σλ2
                                  2
            −(θ − 1)κ1 A1 Cn−1,1 σx,t .


A.6       Deriving the Intertemporal Marginal Rate of Substitution (MRS)

We consider a representative-agent endowment economy modified to allow for time-preference
shocks. The representative agent has Epstein and Zin (1989) recursive preferences and maximizes
her lifetime utility
                                                                                       θ
                                                         1−γ                    1       1−γ
                                                                          1−γ  θ
                            Vt = max (1 − δ)λt Ct         θ
                                                               +δ   Et [Vt+1 ]
                                    Ct

subject to budget constraint
                                              Wt+1 = (Wt − Ct )Rc,t+1 ,

where Wt is the wealth of the agent, Rc,t+1 is the return on all invested wealth, γ is risk aversion, θ =
 1−γ                                                                                λt+1
1−1/ψ ,   and ψ is intertemporal elasticity of substitution. The ratio               λt       determines how agents trade
off current versus future utility and is referred to as the time-preference shock (see Albuquerque,
Eichenbaum, and Rebelo (2012)).
  First conjecture a solution for Vt = φt Wt . The value function is homogenous of degree 1 in wealth;
it can now be written as
                                                                                                      θ
                                                   1−γ                                        1       1−γ
                                                                                    1−γ
                     φt Wt = max (1 − δ)λt Ct       θ
                                                         + δ Et [(φt+1 Wt+1 )             ]    θ
                                                                                                                  (A.25)
                               Ct

subject to
                                              Wt+1 = (Wt − Ct )Rc,t+1 .

Epstein and Zin (1989) show that the above dynamic program has a maximum.
  Using the dynamics of the wealth equation, we substitute Wt+1 into (A.25) to derive
                                 1−γ
                                                                                θ
                                                   1−γ
                                                                        1−γ
                                                                             1 1−γ
          φt Wt = max (1 − δ)λt Ct θ
                                      + δ(Wt − Ct ) θ Et [(φt+1 Rc,t+1 ) ] θ        .                             (A.26)
                       Ct

At the optimum, Ct = bt Wt , where bt is the consumption-wealth ratio. Using (A.26) and shifting
the exponent on the braces to the left-hand side, and dividing by Wt , yields
                                1−γ                 1−γ
              1−γ
                               Ct     θ            Ct    θ                         1
            φt θ
                  = (1 − δ)λt            +δ 1−              Et [(φt+1 Rc,t+1 )1−γ ] θ                             (A.27)
                               Wt                 Wt
Schorfheide, Song, and Yaron (2014): Online Appendix                                                                                            A-8


or simply
                     1−γ                        1−γ                      1−γ                            1
                   φt θ = (1 − δ)λt bt θ + δ(1 − bt )                     θ      Et [(φt+1 Rc,t+1 )1−γ ] θ .                                 (A.28)

The first-order condition with respect to the consumption choice yields
                                   1−γ                                                                         1
                                         −1                         1−γ
                                                                        −1
                     (1 − δ)λt bt θ             = δ(1 − bt )         θ       Et [(φt+1 Rc,t+1 )1−γ ]             θ
                                                                                                                     .                       (A.29)

Plugging (A.29) into (A.28) yields
                                          θ
                                                          1−γ−θ                               ψ
                                                                                                                  1
                                   θ
                                         1−γ         Ct       1−γ                       ψ
                                                                                               ψ−1        Ct       1−ψ
                 φt = (1 − δ)     1−γ   λt                             = (1 − δ)       ψ−1   λt                              .               (A.30)
                                                     Wt                                                   Wt
The lifetime value function is φt Wt , with the solution to φt stated above. This expression for φt is
important: It states that the maximized lifetime utility is determined by the consumption-wealth
ratio.
  (A.29) can be rewritten as
                                                         − θ
                                                  bt            ψ
                           (1 −   δ)θ λθt                           = δ θ Et [(φt+1 Rc,t+1 )1−γ ].                                           (A.31)
                                                1 − bt
Consider the term φt+1 Rc,t+1 :
                                                                                             1
                                                                       ψ
                                                                                       
                                                             ψ
                                                                      ψ−1        Ct+1       1−ψ
                           φt+1 Rc,t+1 = (1 − δ)            ψ−1     λt+1                           Rc,t+1 .                                  (A.32)
                                                                                 Wt+1
                                                           Ct+1            Ct+1 /Ct           1            Gt+1               bt
After substituting the wealth constraint,                  Wt+1      =     Wt /Ct −1    ·   Rc,t+1    =    Rc,t+1        ·   1−bt ,   into the above
expression, it follows that
                                                                                  1                       1
                                                           ψ
                                                                                                  
                                                  ψ
                                                          ψ−1         bt         1−ψ       Gt+1          1−ψ
                 φt+1 Rc,t+1 = (1 − δ)           ψ−1   λt+1                                                    Rc,t+1 .                      (A.33)
                                                                    1 − bt                 Rc,t+1
After some intermediate tedious manipulations,
                                                                                           − θ
                    θ                   1−γ           θ                            bt          ψ     −θ
                   δ (φt+1 Rc,t+1 )             = δ (1 −        δ)θ λθt+1                             ψ
                                                                                                   Gt+1  θ
                                                                                                        Rc,t+1 .                             (A.34)
                                                                                 1 − bt
Taking expectations and substituting the last expression into (A.31) yields
                                   λt+1 θ − ψθ θ−1
                                      
                            θ
                           δ Et [         Gt+1 Rc,t+1 Rc,t+1 ] = 1.                                                                          (A.35)
                                    λt
From here we see that the MRS in terms of observables is
                                             θ    θ
                                      θ λt+1      −ψ    θ−1
                             Mt+1 = δ            Gt+1 Rc,t+1 .                                                                               (A.36)
                                          λt
The log of MRS is
                                                                       θ
                           mt+1 = θ log δ + θxλ,t+1 −                    gt+1 + (θ − 1)rc,t+1 ,                                              (A.37)
                                                                       ψ
where xλ,t+1 = log( λλt+1
                       t
                          ).
Schorfheide, Song, and Yaron (2014): Online Appendix                                             A-9


B     Data Source

B.1     Nominal PCE

We download seasonally adjusted data for nominal PCE from NIPA Tables 2.3.5 and 2.8.5. We
then compute within-quarter averages of monthly observations and within-year averages of quarterly
observations.


B.2     Real PCE

We use Table 2.3.3., Real Personal Consumption Expenditures by Major Type of Product, Quantity
Indexes (A:1929-2011)(Q:1947:Q1-2011:Q4) to extend Table 2.3.6., Real Personal Consumption
Expenditures by Major Type of Product, Chained Dollars (A:1995-2011) (Q:1995:Q1-2011:Q4).
Monthly data are constructed analogously using Table 2.8.3. and Table 2.8.6.


B.3     Real Per Capita PCE: ND+S

The LRR model defines consumption as per capita consumer expenditures on nondurables and
services. We download mid-month population data from NIPA Table 7.1.(A:1929-2011)(Q:1947:Q1-
2011:Q4) and from Federal Reserve Bank of St. Louis’ FRED database (M:1959:M1-2011:M12).
We convert consumption to per capita terms.


B.4     Dividend and Market Returns Data

Data are from the Center for Research in Security Prices (CRSP). The three monthly series from
CRSP are the value-weighted with-, RNt , and without-dividend nominal returns, RXt , of CRSP
stock market indexes (NYSE/AMEX/NASDAQ/ARCA), and the CPI inflation rates, πt . The
sample period is from 1928:M1 to 2011:M12. The monthly real dividend series are constructed as
in Hodrick (1992):

    1. A normalized nominal value-weighted price series is produced by initializing P0 = 1 and
      recursively setting Pt = (1 + RXt )Pt−1 .

    2. A normalized nominal divided series, dt , is obtained by recognizing that dt = (RNt −
      RXt )Pt−1 .
                                         P11
    3. The annualized dividend is Dt =    j=0 dt−j ,   which sums the previous 11 months of dividends
      with the current dividend. The first observation is 1928:M12.
Schorfheide, Song, and Yaron (2014): Online Appendix                                               A-10


Both dividend growth, log( DDt+1
                              t
                                 ), and market returns, RNt+1 , are converted from nominal to real
terms using the CPI inflation rates, which are denoted by gd,t+1 and rm,t+1 respectively. They are
available from 1929:M1 to 2011:M12.


B.5    Ex Ante Risk-Free Rate

The ex ante risk-free rate is constructed as in the online appendix of Beeler and Campbell (2012).
Nominal yields to calculate risk-free rates are the CRSP Fama Risk Free Rates. Even though our
model runs in monthly frequencies, we use the three-month yield because of the larger volume and
higher reliability. We subtract annualized three-month inflation, πt,t+3 , from the nominal yield,
if,t , to form a measure of the ex post (annualized) real three-month interest rate. The ex ante real
risk-free rate, rf,t , is constructed as a fitted value from a projection of the ex post real rate on the
current nominal yield, if,t , and inflation over the previous year, πt−12,t :

                            if,t − πt,t+3 = β0 + β1 if,t + β2 πt−12,t + εt+3
                                    rf,t = β̂0 + β̂1 if,t + β̂2 πt−12,t .

The ex ante real risk-free rates are available from 1929:M1 to 2011:M12.
Schorfheide, Song, and Yaron (2014): Online Appendix                                            A-11


C     The State-Space Representation of the LRR Model

C.1     Measurement Equations

In order to capture the correlation structure between the measurement errors at monthly frequency,
we assumed in the main text that 12 months of consumption growth data are released at the end
of each year. We will now present the resulting measurement equation. To simplify the exposition,
we assume that the monthly consumption data are released at the end of the quarter (rather than
at the end of the year). In the main text, the measurement equation is written as
                                                           
                                              v v      u
                 yt+1 = At+1 D + Zst+1 + Z st+1 + Σ ut+1 , ut+1 ∼ N (0, I).                   (A.38)

The selection matrix At+1 accounts for the deterministic changes in the vector of observables, yt+1 .
Recall that monthly observations are available only starting in 1959:M1. For the sake of exposition,
suppose prior to 1959:M1 consumption growth was available at a quarterly frequency. Then:

    1. Prior to 1959:M1:

       (a) If t + 1 is the last month of the quarter:
                                                                                  
                                     q                  1    2       2   1
                                    gc,t+1                       1           0 0 0
                                                     3    3       3   3       
                                  g                  0    0 0 0       0 1 0 0 
                                  d,t+1 
                          yt+1 =           , At+1 =                           .
                                                                                
                                  rm,t+1             0    0 0 0       0 0 1 0 
                                                                              
                                     rf,t               0    0 0 0       0 0 0 1

       (b) If t + 1 is not the last month of the quarter:
                                                                       
                                     gd,t+1               0 0 0 0 0 1 0 0
                                                                       
                          yt+1 =  rm,t+1  , At+1 =  0 0 0 0 0 0 1 0  .
                                                                        
                                      rf,t                0 0 0 0 0 0 0 1

    2. From 1959:M1 to present:

       (a) If t + 1 is the last month of the quarter:
                                                                                  
                                     gc,t+1              1 0 0       0 0 0 0 0
                                                                            
                                   gc,t               0 1 0       0 0 0 0 0 
                                                                            
                                                                            
                                   gc,t−1             0 0 1       0 0 0 0 0 
                           yt+1 = 
                                  
                                             , At+1 = 
                                                                             
                                     g                  0 0 0       0 0 1 0 0 
                                                                               
                                   d,t+1 
                                                                            
                                   rm,t+1             0 0 0       0 0 0 1 0 
                                                                            
                                       rf,t              0 0 0       0 0 0 0 1
Schorfheide, Song, and Yaron (2014): Online Appendix                                                 A-12


      (b) If t + 1 is not the last month of the quarter:
                                                                                     
                                    gd,t+1               0 0 0 0 0 1 0 0
                                                                                     
                         yt+1 =  rm,t+1  , At+1 =  0 0 0 0 0 0 1 0
                                                                                      .
                                                                                        
                                     rf,t                0 0 0 0 0 0 0 1

  The relationship between observations and states (ignoring the measurement errors) is given by
the approximate analytical solution of the LRR model described in Section A:

gc,t+1 = µc + xt + σc,t ηc,t+1                                                                                 (A.39)
gd,t+1 = µd + φxt + πσc,t ηc,t+1 + σd,t ηd,t+1
rm,t+1 = {κ0,m + (κ1,m − 1)A0,m + µd }
        + (κ1,m A1,m )xt+1 + (φ − A1,m )xt + (κ1,m A1,λ,m )xλ,t+1 − A1,λ,m xλ,t + πσc,t ηc,t+1 + σd,t ηd,t+1
                         2               2                    2               2                    2               2
        + (κ1,m A2,x,m )σx,t+1 − A2,x,m σx,t + (κ1,m A2,c,m )σc,t+1 − A2,c,m σc,t + (κ1,m A2,d,m )σd,t+1 − A2,d,m σd,t
                                         2           2
   rf,t = B0 + B1 xt + B1,λ xλ,t + B2,x σx,t + B2,c σc,t
            ηi,t+1 , ηλ,t+1 , wi,t+1 ∼ N (0, 1),   i ∈ {c, x, d}.

In order to reproduce (A.39) and the measurement-error structure described in Sections 3.1 and 3.2,
we define the vectors of states st+1 and svt+1 as
Schorfheide, Song, and Yaron (2014): Online Appendix                                                                                                                                   A-13


                                                                                     
                                                                  xt+1
                                                                                     
                                                          
                                                                 xt                  
                                                                                      
                                                          
                                                                 xt−1                
                                                                                      
                                                                                     
                                                          
                                                                 xt−2                
                                                                                      
                                                                  xt−3
                                                                                     
                                                                                     
                                                                                     
                                                          
                                                                 xt−4                
                                                                                      
                                                                                     
                                                          
                                                                 σc,t ηc,t+1         
                                                                                      
                                                          
                                                                 σc,t−1 ηc,t         
                                                                                      
                                                                                     
                                                          
                                                                 σc,t−2 ηc,t−1       
                                                                                                                             
                                                                                                                   2
                                                                  σc,t−3 ηc,t−2                                   σx,t+1
                                                                                     
                                                                                     
                                                                                                                2           
                                                          
                                                                 σc,t−4 ηc,t−3       
                                                                                                                σx,t         
                                                                                                                              
                                                                                                                   2
                                                                                     
                                                                  σ t+1                                        σc,t+1       
                                                                                                svt+1
                                                                                     
                                                  st+1   =                           ,                 =                    .                                                 (A.40)
                                                                                                                              
                                                                                                                   2
                                                          
                                                                 σ  t              
                                                                                                         
                                                                                                                 σc,t         
                                                                                                                               
                                                                                                                 2
                                                                  σ t−1                                         σd,t+1
                                                                                                                            
                                                                                                                            
                                                                                                                   2
                                                                  σ t−2                                         σd,t
                                                                                     
                                                                                     
                                                                                     
                                                          
                                                                 σ t−3             
                                                                                      
                                                                                     
                                                          
                                                                 σ t−4             
                                                                                      
                                                          
                                                                 σq qt+1           
                                                                                      
                                                                  σq qt
                                                                                     
                                                                                     
                                                                                     
                                                                  σq qt−1
                                                                                     
                                                                                     
                                                                                     
                                                          
                                                                 σq qt−2           
                                                                                      
                                                                                     
                                                          
                                                                 σd,t ηd,t+1         
                                                                                      
                                                          
                                                                 xλ,t+1              
                                                                                      
                                                                  xλ,t

        It can be verified that the coefficient matrices D, Z, Z v , and Σe are given by

                                                                                               −1
              
                 0      1     0       0   0       0      1        0       0   0   0   1                  0        0       0    0        0       0       0       0         0      0       0
                                                                                                                                                                                               
              
                0      0     1       0   0       0      0        1       0   0   0   0         1        −1       0       0    0        0       0       0       0         0      0       0     
                                                                                                                                                                                               
                                                                                      −1       −1        2    −2          1    1
                                                                                                                                                                                              
              
                0      0     0       1   0       0      0        0       1   0   0    3        3        3     3          3    3
                                                                                                                                        1       0       0       −1        0      0       0     
                                                                                                                                                                                               
                0      0     0       0   1       0      0        0       0   1   0   0         0        0        1       −1   0        0       0       0       0         0      0       0     
Z         =
                                                                                                                                                                                              
                                                                                                                                                                                              
              
                0      0     0       0   0       1      0        0       0   0   1   0         0        0        0       1    −1       0       0       0       0         0      0       0     
                                                                                                                                                                                               
              
                0      φ     0       0   0       0      π        0       0   0   0   0         0        0        0       0    0        0       0       0       0         1      0       0     
                                                                                                                                                                                               
                                                                                                                                                                                              
               µr,1   µr,2   0       0   0       0   µr,3        0       0   0   0   0         0        0        0       0    0        0       0       0       0        µr,4   µr,5    µr,6   
                 0     B1     0       0   0       0      0        0       0   0   0   0         0        0        0       0    0        0       0       0       0         0      0      B1,λ

                                                                                                                      0    0   0    0       0       0       0        0
              
                  0     0         0           0          0            0
                                                                                     
                                                                                           µ
                                                                                                                                                                         
              
                0      0         0           0          0            0 
                                                                        
                                                                                    
                                                                                      µ            
                                                                                                    
                                                                                                            
                                                                                                                     0    0   0    0       0       0       0        0     
                                                                                                                                                                           
                                                                                                                                                                      
                0      0         0           0          0            0              µ                            0    0   0    0       0       0       0        0     
                                                                                                                                                                      
    v
                0      0         0           0          0          0                µ            
                                                                                                          u
                                                                                                                     0    0   0    0       0       0       0        0     
Z         =                                                             ,        D=               ,   Σ =                                                              .
                                                                                                                                                                      
              
              
                0      0         0           0          0          0   
                                                                        
                                                                                    
                                                                                      µ            
                                                                                                    
                                                                                                            
                                                                                                                     0    0   0    0       0       0       0        0     
                                                                                                                                                                           
              
                0      0         0           0          0          0   
                                                                        
                                                                                     µ
                                                                                       d
                                                                                                    
                                                                                                    
                                                                                                            
                                                                                                                     0    0   0    0       0       0       0        0     
                                                                                                                                                                           
                                                                                                                                                                      
               µr,7   µr,8   µr,9        µr,10       µr,11       µr,12             µr,0                          0    0   0    0       0       0       0        0     
                                                                                                                                                                     rf
                  0    B2,x       0       B2,c           0          0                      B0                         0    0   0    0       0       0       0       σ
Schorfheide, Song, and Yaron (2014): Online Appendix                                                                                  A-14


  The coefficients µr,0     to µr,12 are obtained from the solution                  of the LRR model:
                                                         
           µr,0                κ0,m + A0,m (κ1,m − 1) + µd                                                                   
        
         µ 
                                                                                  µr,7                    κ1,m A2,x,m
         r,1 
                                         κ1,m A1,m                                                                         
                                                                                     µr,8   −A2,x,m
                                                                                                                            
                                                         
         µr,2                           φ − A
                                                                                                                               
                                                1,m                                                                        
                                                                                µr,9  =  κ1,m A2,m
                                                                                                                               
         µr,3  =                            π             ,                                                                 .
                                                         
                             
                                                                                     µr,10   −A2,m
                                                                                                                         
         µ                                                                                                                   
         r,4 
                                             1                                                                             
                                                                                             κ1,m A2,d,m
                                                                                     µr,11 
                                                                                                                            
                                                         
         µr,5                         κ1,m A 1,λ,m
                                                                                                                              
                                                                                 µr,12       −A2,d,m
           µr,6                           −A1,λ,m


C.2     State Transition Equations

Using the definition of st+1 in (A.40), we write the state-transition equation as

                                                    st+1 = Φst + vt+1 (ht ).                                                         (A.41)

Conditional on the volatilities ht , this equation reproduces the law of motion of the two persistent
conditional mean processes

                                                xt+1 = ρxt + σx,t ηx,t+1                                                             (A.42)
                                            xλ,t+1 = ρλ xλ,t + σλ ηλ,t+1

and it contains some trivial relationships among the measurement-error states. The matrices Φ
and vt+1 (ht ) are defined as
                                                                                                                           
                    ρ   0   0   0   0   0   0   0    0   0   0   0   0   0   0   0   0   0   0   0       0     0   0    0
                    1   0   0   0   0   0   0   0    0   0   0   0   0   0   0   0   0   0   0   0       0     0   0    0 
                                                                                                                         
              
                                                                                                                         
              
                   0   1   0   0   0   0   0   0    0   0   0   0   0   0   0   0   0   0   0   0       0     0   0    0 
                                                                                                                          
                    0   0   1   0   0   0   0   0    0   0   0   0   0   0   0   0   0   0   0   0       0     0   0    0 
                                                                                                                         
              
                                                                                                                         
              
                   0   0   0   1   0   0   0   0    0   0   0   0   0   0   0   0   0   0   0   0       0     0   0    0 
                                                                                                                          
              
                    0   0   0   0   1   0   0   0    0   0   0   0   0   0   0   0   0   0   0   0       0     0   0    0 
                                                                                                                          
              
                                                                                                                         
              
                   0   0   0   0   0   0   0   0    0   0   0   0   0   0   0   0   0   0   0   0       0     0   0    0 
                                                                                                                          
                                                                                                                         
                   0   0   0   0   0   0   1   0    0   0   0   0   0   0   0   0   0   0   0   0       0     0   0    0 
                                                                                                                         
              
                   0   0   0   0   0   0   0   1    0   0   0   0   0   0   0   0   0   0   0   0       0     0   0    0 
                                                                                                                          
                                                                                                                         
              
                   0   0   0   0   0   0   0   0    1   0   0   0   0   0   0   0   0   0   0   0       0     0   0    0 
                                                                                                                          
              
                   0   0   0   0   0   0   0   0    0   1   0   0   0   0   0   0   0   0   0   0       0     0   0    0 
                                                                                                                          
                                                                                                                         
                   0   0   0   0   0   0   0   0    0   0   0   0   0   0   0   0   0   0   0   0       0     0   0    0 
            Φ=                                                                                                           
              
                   0   0   0   0   0   0   0   0    0   0   0   1   0   0   0   0   0   0   0   0       0     0   0    0 
                                                                                                                          
                                                                                                                         
              
                   0   0   0   0   0   0   0   0    0   0   0   0   1   0   0   0   0   0   0   0       0     0   0    0 
                                                                                                                          
              
                   0   0   0   0   0   0   0   0    0   0   0   0   0   1   0   0   0   0   0   0       0     0   0    0 
                                                                                                                          
                                                                                                                         
              
                   0   0   0   0   0   0   0   0    0   0   0   0   0   0   1   0   0   0   0   0       0     0   0    0 
                                                                                                                          
                    0   0   0   0   0   0   0   0    0   0   0   0   0   0   0   1   0   0   0   0       0     0   0    0 
                                                                                                                         
              
                                                                                                                         
              
                   0   0   0   0   0   0   0   0    0   0   0   0   0   0   0   0   0   0   0   0       0     0   0    0 
                                                                                                                          
                    0   0   0   0   0   0   0   0    0   0   0   0   0   0   0   0   0   1   0   0       0     0   0    0 
                                                                                                                         
              
                                                                                                                         
              
                   0   0   0   0   0   0   0   0    0   0   0   0   0   0   0   0   0   0   1   0       0     0   0    0 
                                                                                                                          
                    0   0   0   0   0   0   0   0    0   0   0   0   0   0   0   0   0   0   0   1       0     0   0    0 
                                                                                                                         
              
                                                                                                                         
              
                   0   0   0   0   0   0   0   0    0   0   0   0   0   0   0   0   0   0   0   0       0     0   0    0 
                                                                                                                          
                    0   0   0   0   0   0   0   0    0   0   0   0   0   0   0   0   0   0   0   0       0     0   ρλ   0 
                                                                                                                         
              
                    0   0   0   0   0   0   0   0    0   0   0   0   0   0   0   0   0   0   0   0       0     0   1    0


  and
Schorfheide, Song, and Yaron (2014): Online Appendix                                                                   A-15


                                                                        
                                                          σx,t ηx,t+1
                                                                 0
                                                                        
                                                                        
                                                                        
                                                        
                                                                0       
                                                                         
                                                                 0
                                                                        
                                                                        
                                                                        
                                                        
                                                                0       
                                                                         
                                                                 0
                                                                        
                                                                        
                                                                        
                                                         σc,t η
                                                                 c,t+1
                                                                         
                                                                        
                                                                 0
                                                                        
                                                                        
                                                                        
                                                        
                                                                0       
                                                                         
                                                                        
                                                                0       
                                                                        
                                                        
                                                                0       
                                                                         
                                                                        
                                                            σ t+1     
                                           vt+1 (ht ) =                 .
                                                        
                                                                0       
                                                                         
                                                                        
                                                        
                                                                0       
                                                                         
                                                        
                                                                0       
                                                                         
                                                                        
                                                        
                                                                0       
                                                                         
                                                        
                                                                0       
                                                                         
                                                                 q
                                                            σq t+1
                                                                        
                                                                        
                                                                        
                                                                 0
                                                                        
                                                                        
                                                                        
                                                        
                                                                0       
                                                                         
                                                                 0
                                                                        
                                                                        
                                                                        
                                                         σ
                                                            d,t ηd,t+1
                                                                         
                                                                        
                                                                        
                                                         σλ ηλ,t+1      
                                                               0


  The law of motion of the three persistent conditional log volatility processes is given by

                                         ht+1 = Ψht + Σh wt+1 ,                                                       (A.43)

where
                                                                 
                       hx,t+1                 ρhx      0       0
                                              
        ht+1 = 
                hc,t+1
                          , Ψ =  0 ρh
                                         c  0  
                                                 
                 hd,t+1             0    0 ρhd
                    q                                                             
                 σhx 1 − ρ2hx
                                                                                                                 
                                    0             0                                                      wx,t+1
                                 q                                                                     
         Σh =          0      σhc 1 − ρ2hc       0                                ,     wt+1 = 
                                                                                                  wc,t+1  .
                                                                                                        
                                               q                                  
                        0           0        σhd 1 − ρ2hd                                          wd,t+1

We express

              σx,t = ϕx σ̄ exp(hx,t ),   σc,t = ϕc σ̄ exp(hc,t ),             σd,t = ϕd σ̄ exp(hd,t ),

which delivers the dependence on ht in the above definition of vt+1 (·).
Schorfheide, Song, and Yaron (2014): Online Appendix                                                                                                               A-16


D     Posterior Inference

As discussed in the main text, we use a particle-filter approximation of the likelihood function and
embed this approximation into a fairly standard random walk Metropolis algorithm.


D.1    Particle Filter

Our state-space representation, given by equations (A.38), (A.41), and (A.43), is linear conditional
on the volatility states ht . Thus, following Chen and Liu (2000), we update st+1 conditional on ht
using Kalman filter iterations, which improves the efficiency of the filter substantially. In the sub-
sequent exposition we omit the dependence of all densities on the parameter vector Θ. The particle
                                                                                             (i) N
                                                                                      n         o
                                                                                        (i)
filter approximates the sequence of distributions {p(zt |Y1:t )}Tt=1 by a set of pairs zt , πt     ,
                                                                                                                                                                   i=1
        (i)                                                      (i)
where zt      is the i0 th particle vector, πt                         is its weight, and N is the number of particles. As a
by-product, the filter produces a sequence of likelihood approximations p̂(yt |Y1:t−1 ), t = 1, . . . , T .

                                                                                             (i)
    • Initialization: We generate the particle values z0 by drawing the volatilities (h0 , h−1 ) from
      the unconditional distribution associated with (A.43). Conditional on the volatility state
        (i)     (i)           (i)
      (h0 , h−1 ), s0 is generated from the unconditional distribution associated with (A.41). We
              (i)
      set π0 = 1/N for each i.
                                                                                                                                                (i)    (i)
    • Propagation of particles: We simulate (A.43) forward to generate (ht , ht−1 ) conditional
              (i)           (i)                    (i)             (i)       (i)
      on (ht−1 , ht−2 ). Taking st−1 and (ht , ht−1 ) as given, for each particle we run one iteration
      of the Kalman filter based on the linear state-space system comprised of (A.38)and (A.41) to
                                      (i)         (i)      (i)                                                                                        (i)    (i)
      determine p(st |yt , st−1 , ht , ht−1 ). This distribution is normal with mean st|t and Pt|t . We
                      (i)                   (i)     (i)                              (i)
      sample st from N st|t , Pt|t ). We use q(zt |zt−1 , yt ) to represent the distribution from which
                        (i)
      we draw zt .

    • Correction of particle weights: Define the unnormalized particle weights for period t as
                                                                             (i)       (i)       (i)
                                      (i)                 (i)    p(yt |zt )p(zt |zt−1 )
                                    π̃t       = πt−1 ×                       (i)     (i)
                                                                                                                                                              (A.44)
                                                                       q(zt |zt−1 , yt )
                                                                                           (i)           (i)    (i)
                                                          (i)                  p(yt |zt )p(zt |zt−1 )
                                              = πt−1 ×                 (i)     (i)     (i)         (i)                  (i)       (i)
                                                                 p(st |ht , ht−1 , st−1 , yt )q(ht |ht−1 )
                                                                             (i)       (i)       (i)      (i)         (i)           (i)       (i)
                                                          (i)    p(yt |zt )p(st |ht , ht−1 , st−1 )p(ht |ht−1 )
                                              = πt−1 ×                       (i)     (i)     (i)         (i)                  (i)       (i)
                                                                       p(st |ht , ht−1 , st−1 , yt )q(ht |ht−1 )
                                                                             (i)       (i)       (i)      (i)         (i)
                                                          (i)    p(yt |zt )p(st |ht , ht−1 , st−1 )
                                              = πt−1 ×                       (i)     (i)     (i)         (i)
                                                                                                                              .
                                                                       p(st |ht , ht−1 , st−1 , yt )
Schorfheide, Song, and Yaron (2014): Online Appendix                                                                                                                    A-17

                      (i)                                                                                         (i)           (i)     (i)               (i)     (i)
      The term πt−1 is the initial particle weight and the ratio p(yt |zt )p(zt |zt−1 )/q(zt |zt−1 , yt )
      is the importance weight of the particle. The second equality is obtained by factorizing
          (i)   (i)                                  (i)
      q(zt |zt−1 , yt ) into the density of ht associated with the forward simulation of the volatility
                                                                         (i)         (i)         (i)
      states, and the conditional density of st |(yt , st−1 , ht , ht−1 ) is obtained from the Kalman filter
                                                                                                                                                                (i)         (i)
      updating step. The third equality is obtained by factorizing the joint density of (st , ht ),
          (i)   (i)                                                (i)                                                                        (i)     (i)
      p(zt |zt−1 ), into a marginal density for ht                       and a conditional density for st |ht . The last
                                                                                (i)        (i)                   (i)     (i)
      equality follows from the fact that we chose q(ht |ht−1 ) = p(ht |ht−1 ). We further simplify
      the expression in the last line of (A.44) in the next subsection.

      The log likelihood function approximation is given by
                                                                                                             N
                                                                                                                                !
                                                                                                                          (i)
                                                                                                             X
                               log p̂(yt |Y1:t−1 ) = log p̂(yt−1 |Y1:t−2 ) + log                                        π̃t         .
                                                                                                             i=1


   • Resampling: Define the normalized weights
                                                                                      (i)
                                                           (i)                   π̃t
                                                       πt          =       PN         (j)
                                                                                j=1 π̃t

                                                                               (i)         (i)
      and generate N draws from the distribution {st , πt }N
                                                           i=1 using multinomial resampling. In
                                                                                                                                                                      (i)
      slight abuse of notation, we denote the resampled particles and their weights also by st and
        (i)            (i)
      πt , where πt = 1/N .


D.2     Further Details on the Correction and Updating Step
                                             (i)     (i)     (i)
We now derive the density p(st |yt , st−1 , ht , ht−1 ) as well as a simplified expression for the density
ratio in the last line of (A.44). Recall that, conditional on the volatilities (ht , ht−1 ), the state-space
representation of our model takes the form

                             yt = At D + Zst + Z v svt + Σu ut ,
                                                              
                                                                                                       ut ∼ N (0, I)                                                  (A.45)
                             st = Φst−1 + vt (ht−1 ).                                                                                                                 (A.46)

                                                                                                                                                    (i)         (i)         (i)
We now proceed with a Kalman filter forecasting and updating step. Conditional on (st−1 , ht , ht−1 ),
the state-transition equation can be used to forecast st :

                                            (i)    (i) (i)         (i)      (i) 
                                       st (st−1 , ht , ht−1 ) ∼ N st|t−1 , Pt|t−1 ,

where
                                 (i)           (i)           (i)                            (i)            (i)
                               st|t−1 = Φst−1 ,            Pt|t−1 = E[vt (ht−1 )vt0 (ht−1 )].
Schorfheide, Song, and Yaron (2014): Online Appendix                                                                                                 A-18

                                                                                                                           (i)          (i)   (i)
Using the measurement equation we can forecast yt , conditional on (st−1 , ht , ht−1 ), as follows:

                                                  (i)    (i) (i)          (i)      (i) 
                                             yt (st−1 , ht , ht−1 ) ∼ N ŷt|t−1 , Ft|t−1 ,                                                          (A.47)

where

     (i)              (i)               (i) (i)                                  (i)                              (i)
   ŷt|t−1 = At D + Zst|t−1 + Z v svt (ht , ht−1 ) ,                            Ft|t−1 = (At Z)Pt|t−1 (At Z)0 + (At Σu )(At Σu )0 .

Finally, we can apply the Kalman filter updating step to obtain

                                                       (i)    (i) (i)         (i)    (i) 
                                             st (yt , st−1 , ht , ht−1 ) ∼ N st|t , Pt|t ,                                                          (A.48)

where

                             (i)                   (i)                    (i)            (i)                              (i)
                            st|t         = st|t−1 + (At ZPt|t−1 )0 (Ft|t−1 )−1 (yt − ŷt|t−1 )
                             (i)                    (i)                    (i)           (i)                               (i)
                           Pt|t          = Pt|t−1 − (At ZPt|t−1 )0 (Ft|t−1 )−1 (At ZPt|t−1 ).

                   (i)     (i)         (i)
  Define F (i) = {ht , ht−1 , st−1 } and consider the density ratio used to update the particle weights:

                             (i)             (i)     (i)    (i)     (i)                              (i)                        (i)
                    p(yt |zt )p(st |ht , ht−1 , st−1 )                                  p(yt |st , F (i) )p(st |F (i) )
                                 (i)     (i)       (i)     (i)
                                                                                 =                         (i)
                                                                                                                                                    (A.49)
                          p(st |ht , ht−1 , st−1 , yt )                                              p(st |yt , F (i) )
                                                                                               (i)
                                                                                        p(st |yt , F (i) )p(yt |F (i) )
                                                                                 =                         (i)
                                                                                                 p(st |yt , F (i) )
                                                                                 = p(yt |F (i) ).

The first equality in (A.49) follows from

                                   (i)                     (i)    (i)     (i)                    (i)         (i)         (i)          (i)
                         p(yt |zt ) = p(yt |st , ht , ht−1 ) = p(yt |st , ht , ht−1 , st−1 )

and the second equality in (A.49) is an application of Bayes’ Theorem. The expression for p(yt |F (i)
was previously derived in (A.47).
Schorfheide, Song, and Yaron (2014): Online Appendix                                             A-19


E     The Measurement-Error Model for Consumption

E.1    Monthly Interpolation and Adjustment of Consumption

For expositional purposes, we assume that the accurately measured low-frequency observations are
available at quarterly frequency (instead of annual frequency as in the main text). Correspondingly,
we define the time subscript t = 3(j − 1) + m, where month m = 1, 2, 3 and quarter j = 1, . . .. We
use uppercase C to denote the level of consumption and lowercase c to denote percentage deviations
from some log-linearization point. Growth rates are approximated as log differences and we use a
superscript o to distinguish observed from “true” values.

  The measurement-error model presented in the main text can be justified by assuming that the
statistical agency uses a high-frequency proxy series to determine monthly consumption growth
                                                                             q
rates. We use Z3(j−1)+m to denote the monthly value of the proxy series and Z(j) the quarterly
aggregate. Suppose the proxy variable provides a noisy measure of monthly consumption. More
specifically, we consider a multiplicative error model of the form

                                Z3(j−1)+m = C3(j−1)+m exp(3(j−1)+m ).                         (A.50)

                                                                                        o
  The interpolation is executed in two steps. In the first step we construct a series C̃3(j−1)+m , and
in the second step we rescale the series to ensure that the reported monthly consumption data add
up to the reported quarterly consumption data within the period. In Step 1, we start from the
                                        q
level of consumption in quarter j − 1, C(j−1) , and define
                                            !
        o               q,o     Z3(j−1)+1
      C̃3(j−1)+1   =   C(j−1)      q                                                           (A.51)
                                 Z(j−1)
                                            !                                 !
                                Z3(j−1)+1        Z3(j−1)+2          Z3(j−1)+2
                                                             
        o               q,o                                       q,o
      C̃3(j−1)+2   =   C(j−1)      q                    =        C(j−1)q
                                 Z(j−1)          Z3(j−1)+1           Z(j−1)
                                          !                                               !
                                Z3(j−1)+1    Z3(j−1)+2    Z3(j−1)+3              Z3(j−1)+3
                                                                  
        o           q,o                                                    q,o
      C̃3(j−1)+3 = C(j−1)          q                                  = C(j−1)      q        .
                                 Z(j−1)      Z3(j−1)+1    Z3(j−1)+2               Z(j−1)

Thus, the growth rates of the proxy series are used to generate monthly consumption data for
quarter q. Summing over the quarter yields
            3
                                   "                                      #            q
     q,o
           X                 q,o     Z 3(j−1)+1   Z 3(j−1)+2   Z 3(j−1)+3      q,o
                                                                                     Z(j)
                 o
   C̃(j) =     C̃3(j−1)+m = C(j−1)       q      +     q      +     q        = C(j−1) q     .   (A.52)
           m=1
                                       Z(j−1)       Z(j−1)       Z(j−1)             Z(j−1)
Schorfheide, Song, and Yaron (2014): Online Appendix                                              A-20

                                               o                       q,o    q,o
  In Step 2, we adjust the monthly estimates C̃3(j−1)+m by the factor C(j) /C̃(j) , which leads to
                                                            C q,o 
                            o                  o            (j)           q,o   Z3(j−1)+1
                           C3(j−1)+1    =    C̃3(j−1)+1     q,o        = C(j)       q            (A.53)
                                                          C̃(j)                   Z(j)
                                                         C q,o 
                            o                  o            (j)           q,o   Z3(j−1)+2
                           C3(j−1)+2 =       C̃3(j−1)+2     q,o        = C(j)       q
                                                          C̃(j)                   Z(j)
                                                         C q,o 
                            o                  o            (j)           q,o   Z3(j−1)+3
                           C3(j−1)+3 =       C̃3(j−1)+3     q,o        = C(j)       q
                                                          C̃(j)                   Z(j)

and guarantees that
                                                       3
                                             q,o
                                                       X
                                                              o
                                            C(j)   =         C3(j−1)+m .
                                                       m=1

                                  o = log C o − log C o
  We now define the growth rates gc,t      t         t−1 and gc,t = log Ct − log Ct−1 . By taking
logarithmic transformations of (A.50) and (A.53) and combining the resulting equations, we can
deduce that the growth rates for the second and third month of quarter q are given by

                            o
                           gc,3(j−1)+2 = gc,3(j−1)+2 + 3(j−1)+2 − 3(j−1)+1                     (A.54)
                            o
                           gc,3(j−1)+3 = gc,3(j−1)+3 + 3(j−1)+3 − 3(j−1)+2 .

The derivation of the growth rate between the third month of quarter j − 1 and the first month of
quarter j is a bit more cumbersome. Using (A.53), we can write the growth rate as

                        o                 q,o                        q
                       gc,3(j−1)+1 = log C(j) + log Z3(j−1)+1 − log Z(j)                         (A.55)
                                                q,o                          q
                                         − log C(j−1) − log Z3(j−2)+3 + log Z(j−1) .


  To simplify (A.55) further, we are using a log-linear approximation. Suppose we log-linearize an
equation of the form
                                q
                               X(j) = X3(j−1)+1 + X3(j−1)+2 + X3(j−1)+3

around X∗q and X∗ = X∗q /3, using lowercase variables to denote percentage deviations from the
log-linearization point. Then,
                                     1
                              xq(j) ≈ (x3(j−1)+1 + x3(j−1)+2 + x3(j−1)+3 ).
                                     3
Using (A.50) and the definition of quarterly variables as sums of monthly variables, we can apply
the log-linearization as follows:

             q,o        q                                1
                            = log(C∗q /Z∗q ) + q(j) −
                                                                                            
        log C(j) − log Z(j)                                3(j−1)+1 + 3(j−1)+2 + 3(j−1)+3 .   (A.56)
                                                         3
Schorfheide, Song, and Yaron (2014): Online Appendix                                    A-21


Substituting (A.56) into (A.55) yields

    o
   gc,3(j−1)+1 = gc,3(j−1)+1 + 3(j−1)+1 − 3(j−2)+3 + q(j) − q(j−1)                 (A.57)
                   1                                        1                          
                 − 3(j−1)+1 + 3(j−1)+2 + 3(j−1)+3 + 3(j−2)+1 + 3(j−2)+2 + 3(j−2)+3 .
                   3                                         3
An “annual” version of this equation appears in the main text.
