                                NBER WORKING PAPER SERIES




                    MACROECONOMIC REGIMES AND REGIME SHIFTS

                                         James D. Hamilton

                                        Working Paper 21863
                                http://www.nber.org/papers/w21863


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     January 2016




Prepared for: Handbook of Macroeconomics, Vol. 2. I thank Marine Carrasco, Steve Davis, Liang
Hu, Òscar Jordà, Douglas Steigerwald, John Taylor, Allan Timmermann, and Harald Uhlig for helpful
comments on earlier drafts. The views expressed herein are those of the author and do not necessarily
reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2016 by James D. Hamilton. All rights reserved. Short sections of text, not to exceed two paragraphs,
may be quoted without explicit permission provided that full credit, including © notice, is given to
the source.
Macroeconomic Regimes and Regime Shifts
James D. Hamilton
NBER Working Paper No. 21863
January 2016
JEL No. C32,E32,E37

                                             ABSTRACT

Many economic time series exhibit dramatic breaks associated with events such as economic recessions,
financial panics, and currency crises. Such changes in regime may arise from tipping points or other
nonlinear dynamics and are core to some of the most important questions in macroeconomics. This
paper surveys the literature for studying regime changes and summarizes available methods. Section
1 introduces some of the basic tools for analyzing such phenomena, using for illustration the move
of an economy into and out of recession. Section 2 focuses on empirical methods, providing a detailed
overview of econometric analysis of time series that are subject to changes in regime. Section 3 discusses
theoretical treatment of macroeconomic models with changes in regime and reviews applications in
a number of areas of macroeconomics. Some brief concluding recommendations for applied researchers
are offered in Section 4.


James D. Hamilton
Department of Economics, 0508
University of California, San Diego
9500 Gilman Drive
La Jolla, CA 92093-0508
and NBER
jhamilton@ucsd.edu
                                                                           CONTENTS



1. Introduction: Economic recessions as changes in regime . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1

2. Econometric treatment of changes in regime . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
   2.1. Multivariate or non-Gaussian processes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
   2.2. Multiple regimes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
   2.3. Processes that depend on current and past regimes . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
   2.4. Inference about regimes and evaluating the likelihood for the general case . . . . . . . 11
   2.5. EM algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
   2.6. EM algorithm for restricted models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
   2.7. Structural vector autoregressions and impulse-response functions . . . . . . . . . . . . . . . 17
   2.8. Bayesian inference and the Gibbs sampler . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
        Prior distributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
        Likelihood function and conditional posterior distributions . . . . . . . . . . . . . . . . . . . . . 21
        Gibbs sampler . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
   2.9. Time-varying transition probabilities . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
   2.10. Latent-variable models with changes in regime . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
   2.11. Selecting the number of regimes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
   2.12. Deterministic breaks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
   2.13. Chib’s multiple change-point model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
   2.14. Smooth transition models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33

3. Economic theory and changes in regime . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
   3.1. Closed-form solution of DSGE’s and asset-pricing implications . . . . . . . . . . . . . . . . . . . 34
   3.2. Approximating the solution to DSGE’s using perturbation methods . . . . . . . . . . . . . . . 36
   3.3. Linear rational expectations models with changes in regime . . . . . . . . . . . . . . . . . . . . . 40
   3.4. Multiple equilibria . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
   3.5. Tipping points and financial crises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
   3.6. Currency crises and sovereign debt crises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
   3.7. Changes in policy as the source of changes in regime . . . . . . . . . . . . . . . . . . . . . . . . . . 48

4. Conclusions and recommendations for researchers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48

References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51

Appendix: Derivation of EM equations for restricted VAR . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64

Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65

Figures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66
    Many economic time series exhibit dramatic breaks associated with events such as eco-

nomic recessions, ﬁnancial panics, and currency crises. Such changes in regime may arise

from tipping points or other nonlinear dynamics and are core to some of the most impor-

tant questions in macroeconomics. This chapter surveys the literature for studying regime

changes and summarizes available methods. Section 1 introduces some of the basic tools

for analyzing such phenomena, using for illustration the move of an economy into and out of

recession. Section 2 focuses on empirical methods, providing a detailed overview of econo-

metric analysis of time series that are subject to changes in regime.   Section 3 discusses

theoretical treatment of macroeconomic models with changes in regime and reviews appli-

cations in a number of areas of macroeconomics. Some brief concluding recommendations

for applied researchers are oﬀered in Section 4.




1     Introduction: Economic recessions as changes in regime.

Figure 1 plots the U.S. unemployment rate since World War II. Shaded regions highlight a

feature of the data that is very familiar to macroeconomists— periodically the U.S. economy

enters an episode in which the unemployment rate rises quite rapidly. These shaded regions

correspond to periods that the Dating Committee of the National Bureau of Economic Re-

search chose to designate as economic recessions. But what exactly does such a designation

signify?

    One view is that the statement that the economy has entered a recession does not have

any intrinsic objective meaning.    According to this view, the economy is always subject

                                              1
to unanticipated shocks, some favorable, others unfavorable.      A recession is then held

to be nothing more than a string of unusually bad shocks, with the bifurcation of the

observed sample into periods of “recession” and “expansion” an essentially arbitrary way of

summarizing the data.

   Such a view is implicit in many theoretical models used in economics today insofar as it

is a necessary implication of the linearity we often assume in order to make our models more

tractable.     But the convenience of linear models is not a good enough reason to assume

that no fundamental changes in economic dynamics occur when the economy goes into a

recession.     For example, we understand reasonably well that in an expansion, GDP will

rise more quickly at some times than others depending on the pace of new technological

innovations.     But what exactly would we mean by a negative technology shock?         The

assumption that such events are just like technological improvements but with a negative

sign does not seem like the place we should start if we are trying to understand what really

happens during an economic downturn.

   An alternative view is that on occasion some forces that are very diﬀerent from the usual

technological growth take over to determine employment and output, resulting for example

when a simultaneous drop in product demand across diﬀerent sectors and a rapid increase

in unemployed workers introduce new feedbacks of their own. The idea that there might be

a tipping point at which diﬀerent economic dynamics begin to take over will be a recurrent

theme in this chapter.

   Let’s begin with a very simple model with which we can explore some of the issues. We



                                             2
could represent the possibility that there are two distinct phases for the economy using the

random variable st . When st = 1, the economy is in expansion in period t and when st = 2,

the economy is in recession. Suppose that an observed variable yt such as GDP growth has

an average value of m1 > 0 when st = 1 and average value m2 < 0 when st = 2, as in


                                               yt = mst + εt                                          (1)


where εt ∼ i.i.d. N (0, σ 2 ). Suppose that the transition between regimes is governed by a

Markov chain that is independent of εt ,


                 Prob(st = j|st−1 = i, st−2 = k, ..., yt−1 , yt−2 , ...) = pij   i, j = 1, 2.         (2)


      Note that if both st and εt were observed directly, (1)-(2) in fact could still be described

as a linear process. We can verify directly from (2) that1


                                 E(mst |mst−1 , mst−2 , ...) = a + φmst−1                             (3)


where a = p21 m1 + p12 m2 and φ = p11 − p21 . In other words, mst follows an AR(1) process,


                                         mst = a + φmst−1 + vt .                                      (4)


The innovation vt can take on only one of 4 possible values (depending on the realization of

st and st−1 ) but by virtue of (3), vt can be characterized as a martingale diﬀerence sequence.

      Suppose however that we do not observe st and εt directly, but only have observations

of GDP up through date t − 1 (denoted Ωt−1 = {yt−1 , yt−2 , ...}) and want to forecast the

  1
      That is,
                   E(mst+1 |mst = m1 ) = p11 m1 + p12 m2 = p11 m1 + a − p21 m1 = a + φm1
E(mst+1 |mst = m2 ) = p21 m1 + p22 m2 = a − p12 m2 + p22 m2 = a − (1 − p11 )m2 + (1 − p21 )m2 = a + φm2 .


                                                      3
value of yt . Notice from equation (1) that yt is the sum of an AR(1) process (namely (4))

and a white noise process εt . Recall (e.g., Hamilton, 1994, p. 108) that the result could be

described as an ARMA(1,1) process. Thus the linear projection of GDP on its own lagged

values is given by


                      Ê(yt |Ωt−1 ) = a + φyt−1 + θ[yt−1 − Ê(yt−1 |Ωt−2 )]                (5)


where θ is a known function of φ, σ 2 , and the variance of vt (Hamilton, 1994, eq. [4.7.12]).

Note that we are using the notation Ê(yt |Ωt−1 ) to denote a linear projection (the forecast

that produces the smallest mean squared error among the class of all linear functions of Ωt−1 )

to distinguish it from the conditional expectation E(yt |Ωt−1 ) (the forecast that produces the

smallest mean squared error among the class of all functions of Ωt−1 ).

   Because of the discrete nature of st , the linear projection (5) would not yield the optimal

forecast of GDP. We can demonstrate this using the law of iterated expectations (White,

1984, p. 54):

                                   2
                 E(yt |Ωt−1 ) =         E(yt |st−1 = i, Ωt−1 )Prob(st−1 = i|Ωt−1 )
                                  i=1
                                   2
                              =        (a + φmi )Prob(st−1 = i|Ωt−1 ).                     (6)
                                  i=1


Because a probability is necessarily between 0 and 1, the optimal inference Prob(st−1 =

i|Ωt−1 ) is necessarily a nonlinear function of Ωt−1 . If data through t − 1 have persuaded us

that the economy was in expansion at that point, the optimal forecast is going to be close to

a + φm1 , whereas if we become convinced the economy was in recession, the optimal forecast

approaches a + φm2 . It is in this sense that we could characterize (1) as a nonlinear process

                                                 4
in terms of its observable implications for GDP.

   Calculation of the nonlinear inference Prob(st−1 = i|Ωt−1 ) is quite simple for this process.

We could start for t = 0 for example with the ergodic probabilities of the Markov chain:

                                                                  p21
                                    Prob(s0 = 1|Ω0 ) =
                                                               p21 + p12

                                                                  p12
                                    Prob(s0 = 2|Ω0 ) =                   .
                                                               p21 + p12

Given a value for Prob(st−1 = i|Ωt−1 ), we can arrive at the value for Prob(st = j|Ωt ) using

Bayes’s Law:
                                                Prob(st = j|Ωt−1 )f (yt |st = j, Ωt−1 )
                     Prob(st = j|Ωt ) =                                                 .    (7)
                                                            f (yt |Ωt−1 )

Here f (yt |st = j, Ωt−1 ) is the N(mj , σ 2 ) density,

                                                  1      −(yt − mj )2
                         f(yt |st = j, Ωt−1 ) = √    exp              ,                      (8)
                                                 2πσ         2σ 2

Prob(st = j|Ωt−1 ) is the predicted regime given past observations,


            Prob(st = j|Ωt−1 ) = p1j Prob(st−1 = 1|Ωt−1 ) + p2j Prob(st−1 = 2|Ωt−1 ),        (9)


and f(yt |Ωt−1 ) is the predictive density for GDP:

                                          2
                       f (yt |Ωt−1 ) =         Prob(st = i|Ωt−1 )f (yt |st = i, Ωt−1 ).     (10)
                                         i=1


Given a value for Prob(st−1 = i|Ωt−1 ), we can thus use (7) to calculate Prob(st = j|Ωt ),

and proceed iteratively in this fashion through the data for t = 1, 2, ...T to calculate the

necessary magnitude for forming the optimal nonlinear forecast given in (6).



                                                        5
   Note that another by-product of this recursion is calculation in (10) of the predictive

density for the observed data.    Thus one could estimate the vector of unknown popula-

tion parameters λ = (m1 , m2 , σ, p11 , p22 )′ by maximizing the log likelihood function of the

observed sample of GDP growth rates,
                                          T
                                 L(λ) =         log f (yt |Ωt−1 ; λ).                     (11)
                                          t=1

   If the objective is to form an optimal inference about when the economy was in a recession,

one can use the same principles to obtain an even better inference as more data accumulates.

For example, an inference using data observed through date t + k about the regime at date

t is known as a k-period-ahead smoothed inference,

                                      Prob(st = i|Ωt+k ),

calculation of which will be explained in equation (22) below.

   Though this is a trivially simple model, it seems to do a pretty good job at capturing

what is being described by the NBER’s business cycle chronology. If we select only those

quarters for which the NBER declared the U.S. economy to be in expansion, we calculate an

average annual growth rate of 4.5%, suggesting a value for the parameter m1 = 4.5. And we

observe that if the NBER determined the economy to be in expansion in quarter t, 95% of

the time it said the same thing in quarter t + 1, consistent with a value of p11 = 0.95. These

values implied by the NBER chronology are summarized in column 3 of Table 1. On the

other hand, if we ignore the NBER dates altogether, but simply maximize the log likelihood

(11) of the observed GDP data alone, we end up with very similar estimates, as seen in

column 4.

                                                  6
    Moreover, even given the challenges of data revision, the one-quarter-ahead smoothed

probabilities have an excellent out-of-sample record at tracking the NBER dates. Figure 2

plots historical values for Prob(st = 2|Ωt+1 , λ̂t+1 ) where only GDP data as it was actually

released as of date t + 1 was used to estimate parameters and form the inference plotted for

date t. Values before the vertical line are “simulated real-time” inferences from Chauvet and

Hamilton (2006), that is, values calculated in 2005 using a separate historical real-time data

vintage for each date t shown. Values after the vertical line are true real-time out-of-sample

inferences as they have been published individually on www.econbrowser.com each quarter

since 2005 without revision.

    One attractive feature of this approach is that the linearity of the model conditional on st

makes it almost as tractable as a fully linear model. For example, an optimal k-period-ahead

forecast of GDP growth based only on observed growth through date t can be calculated

immediately using (4),

                                                2
                       E(yt+k |Ωt ) = µ + φk        (mi − µ)Prob(st = i|Ωt )               (12)
                                               i=1


for µ = a/(1 − φ). Results like this make this model of changes in regime very convenient

to work with.


2     Econometric treatment of changes in regime.

This section discusses econometric inference for data that may be subject to changes in

regime, while Section 3 examines methods to incorporate changes in regime into theoretical

economic models.

                                                    7
2.1    Multivariate or non-Gaussian processes.

Although the model in Section 1 was quite stylized, the same basic principles can be used to

investigate changes in regime in much richer settings. Suppose we have a vector of variables

yt observed at date t and hypothesize that the density of yt conditioned on its past history

Ωt−1 = {yt−1 , yt−2 , ...} depends on parameters θ some or all of which are diﬀerent depending

on the regime st :


                      f(yt |st = i, Ωt−1 ) = f (yt |Ωt−1 ; θi )      for i = 1, ..., N.        (13)


In the example in Section 1, there were N = 2 possible regimes with θ1 = (m1 , σ)′ , θ2 =

(m2 , σ)′ , and f (yt |Ωt−1 ; θi ) the N (mi , σ 2 ) density. But the same basic approach would work

for an n-dimensional vector autoregression in which some or all of the parameters change

with the regime,


                     yt = Φst ,1 yt−1 + Φst ,2 yt−2 + · · · + Φst ,r yt−r + cst + εt

                         = Φst xt−1 + εt                                                       (14)


                                       εt |st , Ωt−1 ∼ N(0, Σst ),                             (15)

a class of models discussed in detail in Krolzig (1997). Here xt−1 is an (nr + 1) × 1 vector

consisting of a constant term and r lags of y:

                                            ′      ′           ′
                                   xt−1 = (yt−1 , yt−2 , ..., yt−r , 1)′ .




                                                     8
In this case the density of yt conditional on its own past values and the regime st taking the

value i would be

                                    1
   f (yt |st = i, Ωt−1 ) =                      exp −(1/2)(yt − Φi xt−1 )′ Σ−1
                                                                            i (yt − Φi xt−1 ) .   (16)
                             (2π)n/2 |Σi |1/2




   There is also no reason that a Gaussian density has to be used. For example, Dueker

(1997) proposed a model of stock returns in which the innovation comes from a Student t

distribution whose degrees of freedom parameter η changes with the regime.

2.2    Multiple regimes.

A convenient representation for a model with N > 2 regimes is obtained by collecting the

transition probabilities in a matrix P whose row j, column i element corresponds to pij (so

that columns of P sum to unity). We likewise summarize the regime at date t by an (N × 1)

vector ξ t whose ith element is unity when st = i and is zero otherwise— in other words, ξ t

corresponds to column st of IN . Notice that E(ξ t |st−1 = i) has the interpretation
                                                                       
                                         Prob(st = 1|st−1 = i)             pi1 
                                                                               
                                                   ..                       .. 
                   E(ξ t |st−1   = i) = 
                                                    .                 =
                                                                              . 
                                                                                  
                                                                               
                                                                               
                                          Prob(st = N |st−1 = i)              piN

meaning

                                           E(ξ t |ξ t−1 ) = Pξ t−1

and

                                                ξ t = Pξ t−1 + vt

                                                       9
for vt a discrete-valued martingale diﬀerence sequence whose elements always sum to zero.

Thus the Markov chain admits a VAR(1) representation, with k-period-ahead regime prob-

abilities conditional on the observed data Ωt given by
                                                                           
                      Prob(st+k = 1|Ωt )            Prob(st = 1|Ωt )       
                                                                           
                              ..                            ..             
                               .              = Pk           .             .               (17)
                                                                           
                                                                           
                                                                           
                       Prob(st+k = N |Ωt )             Prob(st = N |Ωt )
   Calculation of the moments and discussion of stationarity conditions for general processes

subject to changes in regime can be found in Tjøstheim (1986), Yang (2000), Timmermann

(2000), and Francq and Zakoïan (2001).

   Although most applications assume a relatively small number of regimes, Sims and Zha

(2006) used Bayesian prior information in a model with N as large as 10, while Calvet

and Fisher (2004) estimated a model with thousands of regimes by imposing a functional

restriction on the ways parameters vary across regimes.

2.3    Processes that depend on current and past regimes.

In the original model proposed by Hamilton (1989) for describing economic recessions, the

conditional density of GDP growth yt was presumed to depend not just on the current regime

but also on the r previous regimes:

      yt = mst + φ1 (yt−1 − mst−1 ) + φ2 (yt−2 − mst−2 ) + · · · + φr (yt−r − mst−r ) + εt .   (18)

While at ﬁrst glance this might not appear to be a special case of the general formulation

given in (13), this in fact is just a matter of representing (18) using the right notation.

Taking r = 1 for illustration, deﬁne

                                                  10
                                     
                                     
                                     
                                     
                                      1 when st = 1 and st−1 = 1
                                     
                                     
                                     
                                     
                                     
                                     
                                      2 when st = 2 and st−1 = 1
                             s∗t =                                      .
                                     
                                     
                                     
                                      3 when st = 1 and st−1 = 2
                                     
                                     
                                     
                                     
                                     
                                     
                                      4 when st = 2 and st−1 = 2

Then s∗t itself follows a 4-state Markov chain with transition matrix
                                                           
                                         p11      0    p11 0      
                                                                  
                                                                  
                                         p        0    p12 0      
                                      ∗
                                         12                       
                                     P =
                                        
                                                                   
                                                                   
                                         0        p21 0     p21   
                                                                  
                                                                  
                                                                  
                                          0        p22 0     p22

and the model (18) can indeed be viewed as a special case of (13), with for example

                                          1              [yt − m2 − φ1 (yt−1 − m1 )]2
            f (yt |s∗t = 2, Ωt−1 ) =               exp −                                .
                                       (2πσ 2 )1/2                  2σ 2

2.4    Inference about regimes and evaluating the likelihood for the
       general case.

For any of the examples above we could collect the set of possible densities conditional on

one of N diﬀerent possible regimes in an (N × 1) vector η t whose ith element is f (yt |st =

i, Ωt−1 ; λ) for Ωt−1 = {yt−1 , yt−2 , ..., y1 ) and λ a vector consisting of all the unknown

population parameters. For example, for the Markov-switching vector autoregression the

ith element of η t is given by (16) and λ is a vector collecting the unknown elements of

{Φ1 , ..., ΦN , Σ1 , ..., ΣN , P} for P the (N × N) matrix whose row j column i element is

Prob(st+1 = j|st = i) (so columns of P sum to unity). We likewise can deﬁne the (N × 1)

                                                   11
vector ξ̂t|t whose ith element is the probability Prob(st = i|Ωt ; λ). One goal is to take the

inference ξ̂ t−1|t−1 and update it to calculate ξ̂ t|t using the observation on yt . Hamilton (1994,

p. 692) showed that this can be accomplished by calculating


                                        ξ̂ t|t−1 = Pξ̂t−1|t−1

                                                 (ξ̂ t|t−1 ⊙ η t )
                                      ξ̂t|t =                                                      (19)
                                                1′ (ξ̂t|t−1 ⊙ η t )

where 1 denotes an (N × 1) vector of ones and ⊙ denotes element-by-element vector multi-

plication.

   If the Markov chain is known to be ergodic, we could begin the recursion for t = 1 by

setting ξ̂ 1|0 to the vector of unconditional probabilities, which as in Hamilton (1994, p. 684)

can be found from the (N + 1)th column of the matrix (A′ A)−1 A′ for
                                                   
                                                  IN − P 
                                       A        =
                                                 
                                                          .
                                                                                                  (20)
                                    (N+1)×N
                                                       ′
                                                     1

Alternative options are to treat the initial probabilities as separate parameters,
                                                             
                                Prob(s1 = 1|Ω0 )                   ρ1 
                                                                       
                                        ..                          .. 
                                         .               =           . 
                                                                       
                                                                       
                                                                       
                                 Prob(s1 = N |Ω0 )                    ρN

where ρi could reﬂect prior beliefs (e.g., ρ1 = 1 if the analyst knows the sample begins in

regime 1), complete ignorance (ρi = 1/N for i = 1, ..., N ), or ρ could be a separate vector

of parameters also to be chosen by maximum likelihood.                    Any of the last three options

is particularly attractive if the EM algorithm described in Section 2.5 or Gibbs sampler in

                                                   12
Section 2.8 are used, or if one wants to allow the possibility of a permanent regime shift

which would mean that the Markov chain is not ergodic.

    In a generalization of (10) and (11), the log likelihood function for the observed data is

naturally calculated as a by-product of the above recursion:

                             T                                T
                    L(λ) =   t=1   log f (yt |Ωt−1 ; λ) =     t=1   log[1′ (ξ̂ t|t−1 ⊙ η t )].   (21)


From (17) the k-period-ahead forecast of the regime, Prob(st+k = j|Ωt ; λ) is found from the

jth element of Pk ξ̂ t|t .

    It’s also often of interest to calculate an inference about the regime at date t conditional

on the full set of all observations through the end of the sample T, known as the “smoothed

probability.” The smoothed Prob(st = i|ΩT ; λ) is obtained from the ith element of ξ̂ t|T

which can be calculated as in Hamilton (1994, p. 694) by iterating backwards for t =

T − 1, T − 2, ..., 1 on

                              ξ̂ t|T = ξ̂ t|t ⊙ {P′ [ξ̂ t+1|T (÷) ξ̂ t+1|t ]}                    (22)

where (÷) denotes element-by-element division.

2.5     EM algorithm.

The unknown parameters λ could be estimated by maximizing the likelihood function (21)

using numerical search methods.          Alternatively, Hamilton (1990) noted that the EM al-

gorithm is often a convenient method for ﬁnding the maximum of the likelihood function.

This algorithm is simplest if we treat the initial probabilities ξ̂1|0 as a vector of free para-

meters ρ rather than using ergodic probabilities from (20). This section describes how the

                                                   13
EM algorithm would be implemented for the case of an unrestricted Markov-switching VAR

(14), in which case λ includes ρ along with the elements of {Φ1 , ..., ΦN , Σ1 , ..., ΣN , P}. The
                                                                                                                                       (ℓ)
EM algorithm is an iterative procedure for generating a sequence of estimates {λ̂ } where
                                                                                                                    (ℓ+1)
the algorithm guarantees that the log likelihood (21) evaluated at λ̂                                                       is greater than or
                         (ℓ)
equal to that at λ̂ . Iterating until convergence leads to a local maximum of the likelihood

function.
                                             (ℓ+1)                            (ℓ)
       To calculate the value of λ̂                  we ﬁrst use λ̂                 in equation (22) to evaluate the smoothed
                                               (ℓ)
probabilities Prob(st = i|ΩT ; λ̂ ) and also smoothed joint probabilities Prob(st = i, st+1 =
           (ℓ)
j|ΩT ; λ̂ ). The latter are obtained from the row i column j element of the (N × N ) matrix2



                                       (ℓ)                   (ℓ)                    (ℓ)       (ℓ)
                               {ξ̂ t|t (λ̂ )[ξ̂ t+1|T (λ̂ ) (÷) (P̂ ξ̂t|t (λ̂ )]′ } ⊙ P̂(ℓ)′ .                                                    (23)

We then use these smoothed probabilities to generate a new estimate ρ̂(ℓ+1) , whose ith
                                                                     (ℓ)
element is obtained from Prob(s1 = i|ΩT ; λ̂ ), along with a new estimate P̂(ℓ+1) whose row

j column i element is given by

                                                     T −1                                                 (ℓ)
                                   (ℓ+1)             t=1    Prob(st = i, st+1 = j|ΩT ; λ̂ )
                                 p̂ij      =                                                        (ℓ)
                                                                                                                .
                                                            T −1
                                                            t=1     Prob(st = i|ΩT ; λ̂ )

Updated estimates of the VAR parameters for i = 1, ..., N are given by

                                                                   (ℓ)                                                           (ℓ)         −1
       (ℓ+1)       T                                                                T
 Φ̂i           =   t=1   yt x′t−1 Prob(st = i|ΩT ; λ̂ )                             t=1   xt−1 x′t−1 Prob(st = i|ΩT ; λ̂ )                        (24)

   2
        The row i column j element of this matrix corresponds to

                                                                     Prob(st+1 = j|ΩT )
                                             Prob(st = i|Ωt )                           pij
                                                                     Prob(st+1 = j|Ωt )

which from equation [22.A.21] in Hamilton (1994) equals Prob(st = i, st+1 = j|ΩT ).


                                                                         14
                           T               (ℓ+1)                  (ℓ+1)                            (ℓ)
             (ℓ+1)         t=1 (yt   − Φ̂i         xt−1 )(yt − Φ̂i        xt−1 )′ Prob(st = i|ΩT ; λ̂ )
           Σ̂i       =                                                          (ℓ)
                                                                                                          .
                                                     T
                                                     t=1   Prob(st = i|ΩT ; λ̂ )
We thus simply iterate between calculating smoothed probabilities and OLS regressions of

yt on its lags weighted by those smoothed probabilities. The algorithm will converge to a

point that is at least a local maximum of the log likelihood (21) with respect to λ subject

to the constraints that ρ′ 1 = 1, 1′ P = 1′ , all elements of ρ and P are nonnegative, and Σj

is positive semideﬁnite for j = 1, ..., N.

2.6    EM algorithm for restricted models.

Often we might want to use a more parsimonious representation to which the EM algorithm

is easily adapted. For example, suppose that we assume that there are no changes in regime

for the equations describing the ﬁrst n1 variables in the system:


                                               y1t = Axt−1 + ε1t                                              (25)


                                              y2t = Bst xt−1 + ε2t                                            (26)
                                                                                     
                          
                                                          
                                                           
                            ε1t                           Σ11 Σ12,st                 
                         E 
                                       
                                       
                                              ′    ′
                                             ε1t ε2t    st   =
                                                                                          .
                                                                                          
                          
                                                          
                                                           
                           ε2t                                  Σ21,st Σ22,st

As in Hamilton (1994, p. 310) it is convenient to reparameterize the system by premultiplying

(25) by Σ21,st Σ−1
                11 and subtracting the result from (26) to obtain



                                       y2t = Cst y1t + Dst xt−1 + v2t                                         (27)


where Cst = Σ21,st Σ−1                      −1                       −1                  ′
                    11 , Dst = Bst −Σ21,st Σ11 A, v2t = ε2t −Σ21,st Σ11 ε1t , and E(v2t v2t |st ) =


Hst = Σ22,st −Σ21,st Σ−1
                      11 Σ12,st . Then the likelihood associated with the system (25) and (27)


                                                             15
factors into a regime-switching component and a regime-independent component parameter-

ized by A, Σ11 . In the absence of restrictions on Bst , Σ21,st , and Σ22,st , the values for A and

Σ11 do not restrict the likelihood for the regime-switching block, meaning full-information

maximum likelihood for the complete system can be implemented by maximizing the likeli-

hood separately for the two blocks. For the regime-independent block, the MLE is obtained

by simple OLS:
                                                                                                  −1
                                              T                          T
                                Â =          t=1   y1t x′t−1            t=1   xt−1 x′t−1

                                                  T
                          Σ̂11 = T −1             t=1 (y1t   − Âxt−1 )(y1t − Âxt−1 )′ .

The MLE for the regime-switching block can be found using the EM algorithm,

                                                                                                   −1
                                (ℓ+1)             T              (ℓ)           T             (ℓ)
                           Ĝi          =         t=1   y2t z′t pit            t=1   zt z′t pit

                                            T
                                            t=1 (y2t    − Ĝ(ℓ+1)
                                                            i     zt )(y2t − Ĝ(ℓ+1)
                                                                               i     zt )′ p(ℓ)
                                                                                            it
                        (ℓ+1)
                      Ĥi       =
                                                                       T      (ℓ)
                                                                       t=1   pit
                                            (ℓ)                                     (ℓ)
                                        pit = Prob(st = i|ΩT ; λ̂ )

            ′
with zt = (y1t , x′t−1 )′ and Gj =           Cj Dj           . The MLE for the original parameterization is

then found simply by reversing the transformation that led to (27), for example Σ̂21,j =

Ĉj Σ̂11 and B̂j = D̂j + Σ̂21,j Σ̂−1
                                  11 Â.


   Alternatively, suppose we want to restrict the switching coeﬃcients to apply only to a

subset x2,t−1 of the original regressors, as for example in a VAR in which only the intercept

(the last element of xt−1 ) is changing with regime,


                                        yt = Ax1,t−1 + Bst x2,t−1 + εt                                  (28)

                                                              16
with E(εt ε′t ) = Σ. In this case the EM equations take the form3

                                                                                            (ℓ)         (ℓ)
                     Â(ℓ+1) B̂1
                                    (ℓ+1)       (ℓ+1)
                                              B̂2         · · · B̂N
                                                                    (ℓ+1)       = Syx (λ̂ )S−1
                                                                                            xx (λ̂ )                       (29)

                      (ℓ)         T
               Syx (λ̂ ) =               yt                         (ℓ)              (ℓ)                  (ℓ)
                                  t=1         x′1,t−1 x′2,t−1 p1t           x′2,t−1 p2t    · · · x′2,t−1 pNt
                                                                                                                               
                                     ′                              (ℓ)                     (ℓ)                          (ℓ)
                       x1,t−1 x1,t−1               x1,t−1 x′2,t−1 p1t      x1,t−1 x′2,t−1 p2t    ···    x1,t−1 x′2,t−1 pNt     
                                                                                                                               
                                                                                                                               
                       x               (ℓ)               (ℓ)                                                                   
                       2,t−1 x′1,t−1 p1t x2,t−1 x′2,t−1 p1t          0                           ···            0              
                                                                                                                               
        (ℓ)       T 
                                                                                                                               
Sxx (λ̂ ) =                      ′      (ℓ)                                   (ℓ)
                                                              x2,t−1 x′2,t−1 p2t                                                
                  t=1  x2,t−1 x1,t−1 p2t         0                                               ···            0              
                                                                                                                               
                               ..                ..                  ..                           ..             ..            
                                .                 .                   .                            .              .            
                                                                                                                               
                                                                                                                               
                                                                                                                               
                                        (ℓ)                                                                               (ℓ)
                        x2,t−1 x′1,t−1 pNt        0                   0                           · · · x2,t−1 x′2,t−1 pNt
                                                                                                                                    ′
                   N        T                                      (ℓ+1)                                         (ℓ+1)                  (ℓ)
Σ̂(ℓ+1) = T −1     i=1      t=1   yt − Â(ℓ+1) x1,t−1 − B̂i                x2,t−1    yt − Â(ℓ+1) x1,t−1 − B̂i           x2,t−1 pit .

                                                                                                                           (30)

2.7      Structural vector autoregressions and impulse-response func-
         tions.

A Gaussian structural vector autoregression takes the form


                                               Ast yt = Bst xt−1 + ut


               ′      ′           ′
where xt−1 = (yt−1 , yt−2 , ..., yt−r , 1)′ and ut |st , Ωt−1 ∼ N (0, Dst ). Here the elements of

ut are interpreted as diﬀerent structural shocks which are identiﬁed by imposing certain

restrictions on Ai , Bi , and Di . For example, the common Cholesky identiﬁcation assumes

that the structural equations are recursive, with Di diagonal and Ai lower triangular with

  3
      See the appendix for more details.



                                                              17
ones along the diagonal. For an identiﬁed structure we could estimate parameters by setting

the ith element of η t in (19) to

                     1        |Ai |2
           η it =                      exp −(1/2)(Ai yt − Bi xt−1 )′ D−1
                                                                      i (Ai yt − Bi xt−1 )
                  (2π)n/2      |Di |

and then choosing {A1 , ..., AN , B1 , ..., BN , D1 , ..., DN , P} to maximize the likelihood (21).

   A faster algorithm is likely to be obtained by ﬁrst ﬁnding the MLE’s {Φ̂1 , ..., Φ̂N , Σ̂1 , ..., Σ̂N , P̂, ρ̂}

for the reduced form (14)-(15) using the EM algorithm in Section 2.5. If the model is just-

identiﬁed, we can just translate these into the implied structural parameters {Â1 , ..., ÂN , B̂1 , ...,

B̂N , D̂1 , ..., D̂N , P̂, ρ̂}, while for an over-identiﬁed model we could ﬁnd the values for the

structural parameters that are closest to the reduced form using minimum chi-square esti-

mation (e.g., Hamilton and Wu, 2012). For example, for the Cholesky formulation we would

just ﬁnd the Cholesky factorization P̂i P̂′i = Σ̂i for each i. The row j column j element of D̂i
                                                                                   1/2
is then the square of the row j column j element of P̂i . Then Âi = D̂i P̂−1
                                                                           i and B̂i = Âi Φ̂i .


   Users of structural vector autoregressions are often interested in structural impulse-

response functions, which in this case are functions of the regime at date t:

                      ∂E(yt+m |st = j, Ωt )   ∂E(yt+m |st = j, Ωt ) ∂εt
             Hmj =              ′
                                            =                            = Ψmj A−1
                                                                                j .
                            ∂ut                      ∂ε′t           ∂u′t

The nonorthogonalized or reduced-form IRF, Ψmj , can be found as follows.                     Suppose we

ﬁrst condition not just on the regime j at date t but also on a particular regime j1 for date

t + 1, j2 for t + 2, and jm for t + m, and consider the value of

                                       ∂E(yt+m |st = j, st+1 = j1 , ..., st+m = jm , Ωt )
                  Ψ̃m,j,j1 ,...,jm =                                                      .
                                                            ∂ε′t


                                                       18
Karamé (2010) noted that this (n × n) matrix can be calculated from the recursion


  Ψ̃m,j,j1 ,...,jm = Φ1,jm Ψ̃m−1,j,j1 ,...,jm−1 + Φ2,jm Ψ̃m−2,j,j1 ,...,jm−2 + · · · + Φr,jm Ψ̃m−r,j,j1 ,...,jm−r


for m = 1, 2, ... where Ψ̃0j = In and 0 = Ψ̃−1,. = Ψ̃−2,. = · · · . The object of interest is

found by integrating out the conditioning variables,

                         N             N
         Ψmj =           j1 =1   ···   jm =1   Ψ̃m,j,j1 ,...,jm Prob(st+1 = j1 , ..., st+m = jm |st = j)

                         N             N
                 =       j1 =1   ···   jm =1   Ψ̃m,j,j1 ,...,jm pj,j1 pj1 ,j2 · · · pjm−1 ,jm .


These magnitudes can either be calculated analytically for modest m and N or by simulation.

   Such regime-speciﬁc impulse-response functions are of interest for questions such as

whether monetary policy (Lo and Piger, 2005) or ﬁscal policy (Auerbach and Gorodnichenko,

2012) have diﬀerent eﬀects on the economy during an expansion or recession.

2.8    Bayesian inference and the Gibbs sampler.

Bayesian methods oﬀer another popular approach for econometric inference. The Bayesian

begins with prior beliefs about the unknown parameters λ which are represented using

a probability density f(λ) that associates a higher probability with values of λ that are

judged to be more plausible. The goal of inference is to revise these beliefs in the form of

a posterior density f(λ|ΩT ) based on the observed data ΩT = {y1 , ..., yT }. Often the prior

distribution f (λ) is assumed to be taken from a particular parametric family known as a

natural conjugate distribution. These have the property that the prior and posterior are

from the same family, as would be the case for example if the prior beliefs were based on


                                                            19
an earlier sample of data. Natural conjugates are helpful because they allow many of the

results to be obtained using known analytic solutions.

   Again we will illustrate some of the main ideas using a Markov-switching vector autore-

gression:

                                           yt = Φst xt−1 + εt

                                          εt |st = i ∼ N(0, Σi )

                                           Prob(s1 = i) = ρi

                                    Prob(st = j|st−1 = i) = pij .

   Prior distributions.

   The Dirichlet distribution is the natural conjugate for the parameters that determine the

Markov transition probabilities. Suppose z = (z1 , ..., zN )′ is an (N ×1) vector of nonnegative

random variables that sum to unity. The Dirichlet density with parameter α = (α1 , ..., αN )′

is given by
                                       Γ(α1 + · · · + αN ) α1 −1        αN −1
                             f (z) =                        z    · · · zN
                                        Γ(α1 ) · · · Γ(αN ) 1

for Γ(.) the gamma function, with the constant ensuring that the density integrates to unity

over the set of vectors z satisfying the speciﬁed conditions. The beta distribution is a special

case when N = 2, usually expressed as a function of the scalar z1 ∈ (0, 1),

                                          Γ(α1 + α2 ) α1 −1
                              f (z1 ) =               z     (1 − z1 )α2 −1 .
                                          Γ(α1 )Γ(α2 ) 1

We then represent prior beliefs over the (N ×1) vector of initial probabilities as (ρ1 , ..., ρN ) ∼

D(α1 , ..., αN ) and those for transition probabilities as (pi1 , ..., piN ) ∼ D(αi1 , ..., αiN ) for i =

                                                    20
1, ..., N.

    The natural conjugate for Σj ,the innovation variance matrix for regime j, is provided by

the Wishart distribution. Let zi be independent (n × 1) N(0, Λ−1 ) vectors and consider the

matrix W = z1 z′1 + · · · + zη z′η for η > n − 1. This matrix is said to have an n-dimensional

Wishart distribution with η degrees of freedom and scale matrix Λ−1 , whose density is


                     f(W) = c|Λ|η/2 |W|(η−n−1)/2 exp [−(1/2) tr (WΛ)]


where tr(.) denotes the trace (sum of diagonal elements). For a univariate regression (n = 1)

this becomes Λ−1 times a χ2 (η) variable, or equivalently a gamma distribution with mean

η/Λ and variance 2η/Λ2 . The constant c is chosen so that the density integrates to unity

over the set of all positive deﬁnite symmetric matrices W (e.g., DeGroot, 1970, p. 57):


                                                n                  −1
                                ηn/2 n(n−1)/4         η+1−j
                         c= 2       π               Γ                   .
                                                j=1
                                                        2

The natural conjugate prior for Σ−1
                                 j , the inverse of the innovation variance matrix in regime


j, takes the form of a Wishart distribution with η j degrees of freedom and scale Λ−1
                                                                                   j :


                                                                      !      "
                f (Σ−1
                    j ) = c|Λj |
                                 ηj /2
                                       |Σj |−(ηj −n−1)/2 exp −(1/2) tr Σ−1
                                                                        j Λj   .


    Prior information about the regression coeﬃcients ϕj = vec(Φ′j ) for regime j can be

represented with a N(mj , Mj ) distribution. The formulas are much simpler in the case of

no useful prior information about these coeﬃcients (which can be viewed as the limit of the

inference as M−1
              j → 0), and this limiting case will be used for the results presented here.




                                                21
   Likelihood function and conditional posterior distributions.

   Collect the parameters that characterize Markov probabilities in a set p = {ρj , p1j , ..., pNj }N
                                                                                                    j=1 ,


those for variances in a set σ = {Σ1 , ..., ΣN }, and VAR coeﬃcients ϕ = {Φ1 , ..., ΦN }. If

we were to condition on all of these parameters along with a particular numerical value for

the realization of the regime for every date S = {s1 , ..., sT } the likelihood function of the

observed data ΩT = {y1 , ..., yT } would be

                        T
                        #   1
f (ΩT |p, σ, ϕ, S) =          n/2
                                  |Σst |−1/2 exp[−(1/2)(yt − Φst xt−1 )′ Σ−1st (yt − Φst xt−1 )]
                     t=1 (2π)
                     #T     1       N
                   =          n/2
                                       δ jt |Σj |−1/2 exp[−(1/2)(yt − Φj xt−1 )′ Σ−1
                                                                                  j (yt − Φj xt−1 )]
                     t=1 (2π)      j=1


where δ jt = 1 if st = j and is 0 otherwise. With independent priors the joint density of the

data, parameters, and regimes is then


                   f (ΩT , p, σ, ϕ, S) = f (ΩT |p, σ, ϕ, S)f(p)f (σ)f (ϕ)f (S|p)                (31)

                                            N
                                            #     α −1 α1j −1          α       −1
                                 f (p) ∝         ρj j p1j       · · · pNjN j
                                           j=1

                                N
                                #                                    !       "
                       f(σ) ∝         |Σj |−(ηj −n−1)/2 exp −(1/2) tr Σ−1
                                                                       j  Λj
                                j=1


                                                  f (ϕ) ∝ 1

                                f (S|p) = ρs1 ps1 ,s2 ps2 ,s3 · · · psT −1 ,sT

where pst−1 ,st denotes the parameter pij when st−1 = i and st = j.

   Let ∆(j) = {t ∈ 1, ..., T : δ jt = 1} denote the set of dates for which the regime is j. From




                                                        22
(31) the posterior distribution of Σj conditional on ΩT , p, ϕ, S is given by

                                                               ! −1 "
     f (Σ−1
         j  |ΩT , p, ϕ, S) ∝ |Σj | −(η j −n−1)/2
                                                 exp[−(1/2) tr  Σj Λj ] ×
                                      #
                                             |Σj |−1/2 exp[−(1/2)(yt − Φj xt−1 )′ Σ−1
                                                                                   j (yt − Φj xt−1 )]
                                    t∈∆(j)

                             = |Σj |−(Tj +ηj −n−1)/2 exp[−(1/2)tr[Σ−1
                                                                   j (Λj + Hj )]                                        (32)

             T                                                                                                T
for Tj =     t=1   δ jt the number of dates characterized by regime j and Hj =                                t=1   δ jt (yt −

Φj xt−1 )(yt −Φj xt−1 )′ the sum of outer products of the residual vectors for those observations.

In other words, Σ−1
                 j |ΩT , p, ϕ, S has a Wishart distribution with Tj + η j degrees of freedom


and scale matrix (Λj + Hj )−1 .
                                                                                  −1
                                T                        T
   Likewise for Φ̂j =           t=1   δ jt yt x′t−1      t=1   δ jt xt−1 x′t−1         , that is for Φ̂j the OLS re-

gression coeﬃcients using only observations for regime j, the posterior distribution of ϕj =

vec(Φ′j ) conditional on ΩT , p, σ, S is

                            #
f (ϕj |ΩT , p, σ, S) ∝              exp[−(1/2)(yt − Φj xt−1 )′ Σ−1
                                                                j (yt − Φj xt−1 )]
                           t∈∆(j)
                            #
                       =            exp[−(1/2)(yt − Φ̂j xt−1 + Φ̂j xt−1 − Φj xt−1 )′ Σ−1
                                                                                      j ×
                           t∈∆(j)

                           (yt − Φ̂j xt−1 + Φ̂j xt−1 − Φj xt−1 )]
                            #
                       ∝            exp[−(1/2)x′t−1 (Φ̂j − Φj )′ Σ−1
                                                                  j (Φ̂j − Φj )xt−1 ]
                           t∈∆(j)
                            #
                       =            exp{−(1/2)(ϕ̂j − ϕj )′ [Σ−1        ′
                                                             j ⊗ xt−1 xt−1 ](ϕ̂j − ϕj )}
                           t∈∆(j)
                                $                                                                                          %
                                                                                                     −1 −1
                                                                            T
                       = exp −(1/2)(ϕj − ϕ̂j )′ Σj ⊗                        t=1   δ jt xt−1 x′t−1            (ϕj − ϕ̂j )

                                                                                           −1
                                                                   T
establishing that ϕj |ΩT , p, σ, S ∼ N            ϕ̂j , Σj ⊗       t=1   δ jt xt−1 x′t−1            for ϕ̂j = vec(Φ̂′j ).



                                                         23
      The conditional posterior distribution of ρ is found from


                                  f(ρ|ΩT , ϕ, σ, S) ∝ ρ1a1 −1 · · · ραNN −1 ρst


which will be recognized as D(α1 + δ 11 , ..., αN + δ N1 ), in other words, a Dirichlet dis-

tribution in which we have increased the parameter associated with the realized regime

for observation 1 by unity and kept all other parameters the same.                                            We similarly have
                                                                                                 T
(pi1 , ..., piN )|ΩT , ϕ, σ, S ∼ D(αi1 + Ti1 , ...., αiN + TiN ) for Tij =                       t=2    δ i,t−1 δ jt the number of

times that regime i is followed by j in the given sequence S.

      Gibbs sampler.

      The idea behind the Gibbs sampler is to take advantage of the above known conditional

distributions to generate a sequence of random variables whose unconditional distribution

will turn out to be the object we’re interested in. Suppose that as the result of a previous

iteration ℓ we had generated particular numerical values for ϕ, σ, p, S. We could for example

begin iteration ℓ = 1 with arbitrary initial guesses for the parameters along with a possible re-

alization of the regime for each date. Given the numbers from iteration ℓ, we could generate
  (ℓ+1)                                           (ℓ+1)
Σj        from expression (32), namely, Σj                is the inverse of a draw from a Wishart distribu-
              (ℓ)                                                                         (ℓ)                   (ℓ)        T           (ℓ)
tion with Tj +ηj degrees of freedom and scale matrix (Λj +Hj )−1 , where Tj                                           =    t=1        δjt is
                                                              (ℓ)        (ℓ)                                                   (ℓ)
a simple count of the number of elements in {s1 , ..., sT } that take the value j and Hj is the
                                                 T      (ℓ)             (ℓ)                      (ℓ)                                 (ℓ)
sum of the residual outer products               t=1   δ jt (yt − Φj xt−1 )(yt − Φj xt−1 )′ for those Tj                                   ob-

servations. Doing so for each j = 1, ..., N gives us the new σ (ℓ+1) . We get a new value for the
                                                                                                                          −1
                                         (ℓ+1)                  (ℓ+1)         (ℓ+1)             T       (ℓ)
VAR coeﬃcients by generating ϕj                  ∼N           ϕ̂j       , Σj          ⊗         t=1    δjt xt−1 x′t−1                where
  (ℓ+1)             (ℓ+1)′                                                                       (ℓ)                            (ℓ+1)
ϕ̂j       = vec Φ̂j          is obtained from OLS regression on these Tj                                observations: Φ̂j                    =

                                                              24
                                                        −1
    T      (ℓ)                 T      (ℓ)                                                                 (ℓ+1)          (ℓ+1)
    t=1   δ jt yt x′t−1        t=1   δ jt xt−1 x′t−1         . New initial probabilities (ρ1                      , ..., ρN      ) are gen-
                               (ℓ)                (ℓ)                                                        (ℓ+1)            (ℓ+1)
erated from D(α1 + δ 11 , ..., αN + δ N1 ) and new Markov probabilities (pi1                                         , ..., piN ) from
                 (ℓ)                 (ℓ)          (ℓ)                                         (ℓ)                                 (ℓ)
D(αi1 + Ti1 , ...., αiN + TiN ) for Tij the number of times st                                      = i is followed by st+1 = j
                                                  (ℓ)         (ℓ)
within the particular realization (s1 , ..., sT ).
                                                                    (ℓ+1)          (ℓ+1)
   Finally, we can get a new realization (s1                                , ..., sT      ) as a draw from the conditional

posterior f (S|ΩT , p(ℓ+1) , σ (ℓ+1) , ϕ(ℓ+1) ) by iterating backwards on a variant of the smoothing

algorithm in Section 2.4. Speciﬁcally, given the values (p(ℓ+1) , σ (ℓ+1) , ϕ(ℓ+1) ) we can iterate
                                                                                              (ℓ+1) T
on (19) for t = 1, ..., T to calculate the (N × 1) vector {ξ̂ t|t                                  }t=1    whose jth element is
                                                                                (ℓ+1)
Prob(st = j|Ωt , p(ℓ+1) , σ (ℓ+1) , ϕ(ℓ+1) ). To generate sT                            , we ﬁrst generate a U(0, 1) variate.
                                                                                                                                 (ℓ+1)
If this is smaller than the calculated Prob(sT = 1|ΩT , p(ℓ+1) , σ (ℓ+1) , ϕ(ℓ+1) ), we set sT                                           = 1.

If the uniform variable turns out to be between Prob(sT = 1|ΩT , p(ℓ+1) , σ (ℓ+1) , ϕ(ℓ+1) ) and

the sum Prob(sT = 1|ΩT , p(ℓ+1) , σ (ℓ+1) , ϕ(ℓ+1) )+ Prob(sT = 2|ΩT , p(ℓ+1) , σ (ℓ+1) , ϕ(ℓ+1) ), we set

s(ℓ+1)
 T     = 2, and so on. After we have generated a particular value for s(ℓ+1)
                                                                       T     we can use (23)

to calculate the probability

                                                    (ℓ+1)
                       Prob(sT −1 = i|sT = sT                , ΩT , p(ℓ+1) , σ (ℓ+1) , ϕ(ℓ+1) ) =
                                                                              (ℓ+1)
                                            Prob(sT −1 = i, sT = sT                   |ΩT , p(ℓ+1) , σ (ℓ+1) , ϕ(ℓ+1) )
                                                                     (ℓ+1)
                                                Prob(sT = sT                  |ΩT , p(ℓ+1) , σ (ℓ+1) , ϕ(ℓ+1) )
                                                (ℓ+1)
with which we generate a draw sT −1 . Iterating backwards in this manner gives us the full

sequence S (ℓ+1) .

   We now have a complete new set p(ℓ+1) , σ (ℓ+1) , ϕ(ℓ+1) , S (ℓ+1) , from which we can then

generate values for ℓ + 2, ℓ + 3, and so on.                             The idea behind the Gibbs sampler (e.g.,

Albert and Chib, 1993) is that the sequence corresponds to a Markov chain whose ergodic

                                                                    25
distribution under general conditions is the true posterior distribution f (p, σ, ϕ, S|ΩT ). The

proposal is then to discard the ﬁrst say 106 draws and retain the next 106 draws as a sample

from the posterior distribution.

   One can also adapt approaches like those in Section 2.6 to apply the Gibbs sampler to

restricted models. For example, if regime switching is conﬁned to a subset of the equations,

we can use the parameterization (27) and perform inference on the regime-switching subset

independently from the rest of the system.

   Although very convenient for many applications, one caution to be aware of in applying

the Gibbs sampler is the role of label switching. Strategies for dealing with this are discussed

by Celeux, Hurn and Robert (2000), Frühwirth-Schnatter (2001), and Geweke (2007).

2.9    Time-varying transition probabilities.

While the calculations above assumed that regimes are characterized by an exogenous

Markov chain, this is easily generalized. We could replace (2) with


           Prob(st = j|st−1 = i, st−2 = k, ..., Ωt−1 ) = pij (xt−1 ; λ)     i, j = 1, ..., N   (33)


where xt−1 is a subset of Ωt−1 or other observed variables on which one is willing to condition

and pij (xt−1 ; λ) is a speciﬁed parametric function. The generalization of (9) then becomes

                                           N
                   Prob(st = j|Ωt−1 ) =         pij (xt−1 ; λ)Prob(st−1 = i|Ωt−1 ).
                                          i=1


where the sequence Prob(st = i|Ωt ) can still be calculated iteratively as in (7),

                                          Prob(st = j|Ωt−1 )f (yt |Ωt−1 ; θj )
                     Prob(st = j|Ωt ) =                                                        (34)
                                                    f(yt |Ωt−1 )

                                                  26
with the predictive density in the denominator now

                                            N
                          f (yt |Ωt−1 ) =         Prob(st = i|Ωt−1 )f (yt |Ωt−1 ; θ i ).   (35)
                                            i=1


     Diebold, Lee and Weinbach (1994) showed how the EM algorithm works in such a setting,

while Filardo and Gordon (1998) developed a Gibbs sampler. Other interesting applications

with time-varying transition probabilities include Filardo (1994) and Peria (2002).

2.10         Latent-variable models with changes in regime.

A more involved case that cannot be handled using the above devices is when the conditional

density of yt depends on the full history of regimes (st , st−1 , ..., s1 ) through date t. One

important case in which this arises is when a process moving in and out of recession phase is

proposed as an unobserved latent variable inﬂuencing an (n × 1) vector of observed variables

yt . For example, Chauvet (1998) speciﬁed a process for an unobserved scalar business-cycle

factor Ft characterized by

                                            Ft = αst + φFt−1 + η t

which inﬂuences the observed yt according to


                                                  yt = ψFt + qt


for ψ an (n × 1) vector of factor loadings and elements of qt presumed to follow separate

autoregressions. This can be viewed as a state-space model with regime-dependent para-

meters in which the conditional density (13) turns out to depend on the complete history

(st , st−1 , ..., s1 ).


                                                         27
   One approach for handling such models is an approximation to the log likelihood and

optimal inference developed by Kim (1994).          Chauvet and Hamilton (2006) and Chauvet

and Piger (2008) demonstrated the real-time usefulness of this approach for recognizing U.S.

recessions with yt a (4 × 1) vector of monthly indicators of sales, income, employment and

industrial production, while Camacho, Perez-Quiros and Poncela (2014) have had success

using a more detailed model for the Euro area.

   The Gibbs sampler oﬀers a particularly convenient approach for this class of models. We

simply add the unobserved sequence of factors {F1 , ..., FT } as another random block to be

sampled from along with p, σ, ϕ, and S. Conditional on {F1 , ..., FT }, draws for those other

blocks can be performed exactly as in Section 2.8, while draws for {F1 , ..., FT } conditional on

the regimes and other parameters can be calculated using well-known algorithms associated

with the Kalman ﬁlter; see Kim and Nelson (1999a) for details.

2.11     Selecting the number of regimes.

Often one would want to test the null hypothesis that there are N regimes against the

alternative of N + 1, and in particular to test the null hypothesis that there are no changes

in regime at all (H0 : N = 1). A natural idea would be to compare the values achieved for

the log likelihood (21) for N and N +1. Unfortunately, the likelihood ratio does not have the

usual asymptotic χ2 distribution because under the null hypothesis, some of the parameters

of the model become unidentiﬁed.        For example, if one thought of the null hypothesis

in (1) as m1 = m2 , when the null is true the maximum likelihood estimates p̂11 and p̂22

do not converge to any population values.        Hansen (1992) and Garcia (1998) examined


                                               28
the distribution of the likelihood ratio statistic in this setting, though implementing their

procedures can be quite involved if the model is at all complicated. Cho and White (2007)

and Carter and Steigerwald (2012, 2013) suggested quasi-likelihood ratio tests that ignore

the Markov property of st . For discussion of some of the subtleties and possible solutions for

the case of i.i.d. regime changes see Hall and Stewart (2005) and Chen and Li (2009).

    An alternative is to calculate instead general measures that trade oﬀ the ﬁt of the like-

lihood against the number of parameters estimated.                     Popular methods such as Schwarz’s

(1978) Bayesian criterion rely for their asymptotic justiﬁcation on the same regularity con-

ditions whose failure causes the likelihood ratio statistic to have a nonstandard distribution.

But Smith, Naik, and Tsai (2006) developed a simple test that can be used to select the

number of regimes for a Markov-switching regression,


                                             yt = x′t β st + σ st εt                                    (36)


where εt ∼ N (0, 1) and st follows an N -state Markov chain.                      The authors proposed to

estimate the parameter vector λ = (β ′1 , ..., β ′N , σ 1 , ..., σ N , pij,i=1,...,N;j=1,..,N−1 )′ by maximum

likelihood for each possible choice of N and calculate

                                 T
                       T̂i =     t=1   Prob(st = i|ΩT ; λ̂MLE )         for i = 1, ..., N


using the full-sample smoothed probabilities. They suggested choosing the value of N for

which



                                                               N     T̂i (T̂i + Nk)
                               M SC = −2L(λ̂MLE )+             i=1
                                                                     T̂i − Nk − 2

                                                       29
is smallest, where k is the number of elements in the regression vector β. Other alternatives

are to use Bayesian methods to ﬁnd the value of N that leads to the largest value for the

marginal likelihood (Chib, 1998) or the highest Bayes factor (Koop and Potter, 1999).

       Another promising test of the null hypothesis of no change in regime was developed by

Carrasco, Hu, and Ploberger (2014). Let ℓt = log f (yt |Ωt−1 ; λ) be the log of the predictive

density of the tth observation under the null hypothesis of no switching. For the Markov-

switching regression (36), λ would correspond to the ﬁxed-regime regression coeﬃcients and

variance (β ′ , σ 2 )′ :
                                                                                    (yt − x′t β)2
                                         ℓt = −(1/2) log(2πσ 2 ) −                                .
                                                                                        2σ 2

Deﬁne ht to be the derivative of the log density with respect to the parameter vector,

                                                                     ∂ℓt
                                                         ht =
                                                                     ∂λ       λ=λ̂0


where λ̂0 denotes the MLE under the null hypothesis of no change in regime. For example,
                                                       
                                                                     (yt −x′t β̂)xt
                                                                         σ̂2                 
                                              ht = 
                                                   
                                                                                              
                                                                                              
                                                                                         2
                                                                              (yt −x′t β̂)
                                                           − 2σ̂1 2 +             2σ̂ 4

                                    −1                                                                       2
                    T                       T                                                T
where β̂ =          t=1    xt x′t           t=1   xt yt and σ̂ 2 = T −1                      t=1   (yt − x′t β̂) . To implement the

Carrasco, Hu, and Ploberger (2014) test of the null hypothesis of no change in regime

against the alternative that the ﬁrst element of β switches according to a Markov chain, let
 (1)
ℓt     denote the ﬁrst element of ht and calculate

                                                         (2)         ∂ 2 ℓt
                                                         ℓt =
                                                                     ∂λ21      λ=λ̂0
                                                                      2
                                                   (2)         (1)                                 (1)
                                     γ t (ρ) = ℓt + ℓt                    +2          s<t    ρt−s ℓt ℓ(1)
                                                                                                      s


                                                                     30
where ρ is an unknown parameter characterizing the persistence of the Markov chain. We

then regress (1/2)γ t (ρ) on ht , save the residuals ε̂t (ρ), and calculate
                                                                       2
                                                       T                
                                    1                  t=1 γ t (ρ)        .
                           C(ρ) =       max 0,
                                    2                    T            2 
                                                 2        t=1 [ε̂t (ρ)]


We then ﬁnd the value ρ∗ that maximizes C(ρ) over some range (e.g., ρ ∈ [0.2, 0.8]) and

bootstrap to see if C(ρ∗ ) is statistically signiﬁcant. This is done by generating data with no

changes in regime using the MLE λ = λ̂0 and calculating C(ρ∗ ) on each generated sample.

   Another option is to conduct generic tests developed by Hamilton (1996) of the hypothesis

that an N -regime model accurately describes the data. For example, if the model is correctly

speciﬁed, the derivative of the log of the predictive density with respect to any element of

the parameter vector,
                                    ∂ log p(yt |Ωt−1 ; λ)
                                                                      ,
                                            ∂λi             λ=λ̂MLE

should be impossible for predict from its own lagged values, a hypothesis that can be tested

using simple regressions.

2.12     Deterministic breaks.

Another common approach is to treat the changes in regime as deterministic rather than

random. If we wanted to test the null hypothesis of constant coeﬃcients against the alter-

native that a certain subset of the coeﬃcients of a regression switched at ﬁxed known dates

t1 , t2 , ..., tN , we could do this easily enough using a standard F test (see for example Fisher,

1970). If we do not know the dates, we could calculate the value of the F statistic for every

set of allowable N partitions, eﬃcient algorithms for which have been described by Bai and

                                                  31
Perron (2003) and Doan (2012), with critical values for interpreting the supremum of the

F statistics provided by Bai and Perron (1998).     Bai and Perron (1998) also described a

sequential procedure with which one could ﬁrst test the null hypothesis of no breaks against

the alternative of N = 1 break, and then test N = 1 against N = 2, and so on.

   Although simpler to deal with econometrically, deterministic structural breaks have the

drawback that they are diﬃcult to incorporate in a sensible way into models based on rational

decision makers. Neither the assumption that people knew perfectly that the change was

coming years in advance, nor the assumption that they were certain that nothing would

ever change (when in the event the change did indeed appear) is very appealing. There is

further the practical issue of how users of such econometric models are supposed to form

their own future forecasts. Pesaran and Timmermann (2007) suggested estimating models

over windows of limited subsamples, watching the data for an indication that it is time

to switch to using a new model.     Another drawback of interpreting structural breaks as

deterministic events is that such approaches make no use of the fact that regimes such as

business downturns may be a recurrent event.

2.13     Chib’s multiple change-point model.

Chib (1998) oﬀered a way to interpret multiple change-point models that gets around some

of the awkward features of deterministic structural breaks.     Chib’s model assumes that

when the process is in regime i the conditional density of the data is governed by parameter

vector θ i as in (13).   Chib assumed that the process begins at date 1 in regime st = 1

and parameter vector θ 1 , and will stay there the next period with probability p11 . With


                                             32
probability 1 − p11 we get a new value θ2 , drawn perhaps from a N (θ1 , Σ) distribution.

Conditional on knowing that there were N such breaks, this could be viewed as a special

case of an N -state Markov-switching model with transition probability matrix taking the

form                                                                     
                      p11        0     0          ···        0         0 
                                                                          
                                                                          
                      1−p       p22    0          ···        0         0 
                           11                                             
                                                                          
                                                                          
                        0     1 − p22 p33         ···        0         0 
                                                                          
                   P=
                     
                                                                           .
                        ..       ..    ..                    ..        .. 
                         .        .     .         ···         .         . 
                                                                           
                                                                          
                                                                          
                                                                          
                        0        0     0          ···    pN−1,N−1      0 
                                                                          
                                                                          
                         0        0     0          ···   1 − pN−1,N−1   1

The total number of regime changes N could then be selected using one of the methods

discussed above.

   Again it’s not clear how to form out-of-sample forecasts with this speciﬁcation.    Pe-

saran, Pettenuzzo, and Timmermann (2006) proposed embedding Chib’s model within a

hierarchical prior with which one could forecast future changes in regime based on the size

and duration of past breaks.

2.14    Smooth transition models.

Another econometric approach to changes in regime is the smooth transition regression model

(Teräsvirta, 2004):

                   exp[−γ(zt−1 − c)]                        1
          yt =                         x′t−1 β 1 +                      x′ β + ut .   (37)
                 1 + exp[−γ(zt−1 − c)]             1 + exp[−γ(zt−1 − c)] t−1 2



                                              33
Here the scalar zt−1 could be one of the elements of xt−1 or some known function of xt−1 .

For γ > 0, as zt−1 → −∞, the regression coeﬃcients go to β 1 , while when zt−1 → ∞, the

regression coeﬃcients approach β 2 . The parameter γ governs how quickly the coeﬃcients

transition as zt−1 crosses the threshold c.

    If xt−1 = (yt−1 , yt−2 , ..., yt−r )′ , this is Teräsvirta’s (1994) smooth-transition autoregres-

sion, for which typically zt−1 = yt−d for some lag d. More generally, given a data-generating

process for xt , (37) is a fully speciﬁed time-series process for which forecasts at any horizon

can be calculated by simulation.       One important challenge is how to choose the lag d or

more generally the switching variable zt−1 . Although in some settings the forecast might be

similar to that coming from (6), the weights Prob(st−1 = i|Ωt−1 ) in the latter would be a

function of the entire history {yt−1 , yt−2 , ..., y1 } rather than any single value.


3     Economic theory and changes in regime.

The previous section discussed econometric issues associated with analyzing series subject

to changes in regime.      This section reviews how these features can appear in theoretical

models of the economy.

3.1     Closed-form solution of DSGE’s and asset-pricing implica-
        tions.

In some settings it is possible to ﬁnd exact analytical solutions for a full dynamic stochastic

general equilibrium model subject to changes in regime. A standard ﬁrst-order condition




                                                 34
in many macro models holds that


                              U ′ (Ct ) = βEt [U ′ (Ct+1 )(1 + rj,t+1 )]                 (38)


where Ct denotes consumption of a representative consumer, β a time-discount rate, and

rj,t+1 the real return on asset j between t and t + 1. Lucas (1978) proposed a particularly

simple setting in which aggregate output comes solely from nonreproducible assets (some-

times thought of as fruit coming from trees) for which equilibrium turns out to require that

Ct equals the aggregate real dividend Dt paid on equities (or the annual crop of fruit). If

the utility function exhibits constant relative risk aversion (U (C) = (1 + γ)−1 C (1+γ) , the

aggregate equilibrium real stock price must satisfy

                                                ∞
                                                            (1+γ)
                                   Pt = Dt−γ         β k Et Dt+k .
                                               k=1


Since the dividend process {Dt+k } is exogenous in this model, one could simply assume that

the change in the log of Dt is characterized by a process such as (1). Cecchetti, Lam and

Mark (1990) used calculations related to those in (12) to ﬁnd the closed-form solution for

the general-equilibrium stock price,

                                            Pt = ρst Dt ,

where the values of ρ1 and ρ2 are given in equations (11) and (12) in their paper.

   Lucas’s assumption of an exogenous consumption and dividend process is obviously quite

restrictive.   Nevertheless, asset-pricing relations such as (38) have to hold regardless of

how we close the rest of the model.       We can always use (38) or other basic asset-pricing

conditions along with an assumed process for returns to ﬁnd the implications of changes

                                                 35
in regime for ﬁnancial variables in more general settings. There is a very large literature

investigating these issues, covering topics such as portfolio allocation (Ang and Bekaert,

2002a; Guidolin and Timmermann, 2008), ﬁnancial implications of rare-event risk (Evans,

1996; Barro, 2006), option pricing (Elliott, Chan, and Siu 2005), and the term structure of

interest rates (Bekaert, Hodrick, and Marshall, 2001; Ang and Bekaert, 2002b; Bansal and

Zhou, 2002). For a survey of this literature see Ang and Timmermann (2012).

3.2    Approximating the solution to DSGE’s using perturbation
       methods.

First-order conditions for a much broader class of dynamic stochastic general equilibrium

models with Markov regime-switching take the form


                       Et a(yt+1 , yt , xt , xt−1 , εt+1 , εt , θst+1 , θst ) = 0.    (39)


Here a(.) is an [(ny + nx) × 1] vector-valued function, yt an (ny × 1) vector of control

variables (also sometimes referred to as endogenous jump variables), xt an (nx × 1) vector

of predetermined endogenous or exogenous variables, εt an (nε × 1) vector of innovations

to those elements of xt that are exogenous to the model, and st follows an N-state Markov

chain. The example considered in the previous subsection is a special case of such a system




                                                  36
with ny = nx = 1, yt = Pt /Dt , xt = ln(Dt /Dt−1 ), θst = mst , and4


                          a(yt+1 , yt , xt , xt−1 , εt+1 , εt , mst+1 , mst ) =
                                                                                       
                           β exp[(1 + γ)(mst+1 + εt+1 )][(yt+1 + 1)/yt ] − 1 
                                                                             .
                                                                             
                                           xt − mst − εt

For that example we were able to ﬁnd closed-form solutions of the form


                                            yt = ρst (xt−1 , εt )

                                            xt = hst (xt−1 , εt ),


namely yt = ρst and xt = mst + εt .

      For more complicated models, solutions cannot be found analytically but can be approx-

imated using the partition perturbation method developed by Foerster, et al. (forthcom-

ing). Their method generalizes the now-standard perturbation methods of Schmitt-Grohe

and Uribe (2004) for ﬁnding linear and higher-order approximations to the solutions to

DSGE’s with no regime switching.               Foerster, et al.’s idea is to approximate the solutions

ρj (.) and hj (.) in a neighborhood around the deterministic steady-state values satisfying

a(y∗ , y∗ , x∗ , x∗ , 0, 0, θ∗ , θ ∗ ) = 0 where θ∗ is the unconditional expectation of θst calculated

from the ergodic probabilities of the Markov chain,

                                                  N
                                         θ∗ =          θj Prob(st = j).
                                                 j=1


  4
      Notice (38) can be written
                                                              Pt+1 + Dt+1
                                        Dtγ = βEt Dt+1
                                                   γ
                                                                   Pt
                                                 γ
                                         Dt+1          (Pt+1 /Dt+1 ) + 1     Dt+1
                            1 = βEt                                                 .
                                          Dt                Pt /Dt            Dt


                                                         37
For the Lucas tree example from the previous subsection, m∗ = (m1 p21 + m2 p12 )/(p12 + p21 ).

We then think of a sequence of economies indexed by a continuous scalar χ such that their

behavior as χ → 0 approaches the steady state, while the value at χ = 1 is exactly that

implied by (39):


                                            yt = ρst (xt−1 , εt , χ)                                           (40)

                                            xt = hst (xt−1 , εt , χ).                                          (41)


As χ → 0, the randomness coming from εt is suppressed, and it turns out to be necessary

to do the same thing for any elements of θ that inﬂuence the steady state in order to have

some ﬁxed point around which to calculate the approximation. For elements in θst that may

change with regime but do not matter for the steady state, Foerster, et al. (forthcoming)

showed that it is not necessary to shrink by χ in order to approximate the dynamic solution.

The authors thus speciﬁed
                                                                               
                                                       A∗
                                                 θ         +   χ(θA
                                                                   st
                                                                          A∗
                                                                        −θ ) 
                                    θ(st , χ) = 
                                                
                                                                             
                                                                             
                                                                 θB
                                                                  st


where θ A
        st denotes the subset of elements of θ st that inﬂuence the steady state. The economy


characterized by a particular value of χ thus needs to satisfy

         &   N
    0=             pst ,j a[ρj (xt , χεt+1 , χ), yt , xt , xt−1 , χεt+1 , εt , θ(j, χ), θ(st , χ)]dF (εt+1 )   (42)
             j=1


where F (εt+1 ) denotes the cumulative distribution function for εt+1 . Note (42) is satisﬁed

by construction when evaluated at yt = y∗ , xt = xt−1 = x∗ , εt = 0, χ = 0.


                                                         38
   We next substitute (40) and (41) into (42) to arrive at a system of N (ny + nx ) equations

of the form

                                   Qst (xt−1 , εt , χ) = 0         st = 1, ..., N

which have to hold for all xt−1 , εt , and χ. Taking derivatives with respect to xt−1 and

evaluating at xt−1 = x∗ , εt = 0, and χ = 0 (that is, using a ﬁrst-order Taylor approximation

around the steady state) yields a system of N(ny + nx )nx quadratic polynomial equations

in the N(ny + nx )nx unknowns corresponding to elements of the matrices

                                   ∂ρj (xt−1 , εt , χ)
                    Rxj       =                                                 j = 1, ..., N
                  (ny ×nx )
                                        ∂x′t−1            xt−1 =x∗ ,εt =0,χ=0

                                  ∂hj (xt−1 , εt , χ)
                    Hxj       =                                                 j = 1, ..., N.
                  (nx ×nx )
                                       ∂x′t−1            xt−1 =x∗ ,εt =0,χ=0

The authors proposed an algorithm for ﬁnding the solution to this system of equations, that

is, values for the above sets of matrices. Given these, other terms in the ﬁrst-order Taylor

approximation to (42) produce a system of N (ny + nx )nε equations that are linear in known

parameters and the unknown elements of

                                  ∂ρj (xt−1 , εt , χ)
                    Rεj       =                                                 j = 1, ..., N
                  (ny ×nε )
                                        ∂ε′t             xt−1 =x∗ ,εt =0,χ=0

                                  ∂hj (xt−1 , εt , χ)
                    Hεj       =                                                 j = 1, ..., N,
                  (nx ×nε )
                                        ∂ε′t             xt−1 =x∗ ,εt =0,χ=0

from which Rεj and Hεj are readily calculated. Another system of N (ny +nx) linear equations

yields
                                  ∂ρj (xt−1 , εt , χ)
                    Rχj =                                                       j = 1, ..., N
                   (ny ×1)
                                        ∂χ               xt−1 =x∗ ,εt =0,χ=0

                                  ∂hj (xt−1 , εt , χ)
                    Hχj =                                                       j = 1, ..., N.
                  (nx ×1)
                                        ∂χ               xt−1 =x∗ ,εt =0,χ=0


                                                          39
The approximation to the solution to the regime-switching DSGE is then


                        yt = y∗ + Rxst (xt−1 − x∗ ) + Rεst εt + Rχst

                        xt = x∗ + Hxst (xt−1 − x∗ ) + Hεst εt + Hχst .


   One could then go a step further if desired, taking a second-order Taylor approximation

to (42). Once the ﬁrst step (the linear approximation) has been completed, the second

step (quadratic approximation) is actually easier to calculate numerically than the ﬁrst step

was, because all the second-step equations turn out to be linear in the remaining unknown

magnitudes.

   Lind (2014) developed an extension of this approach that could be used to form approx-

imations to any model characterized by dramatic nonlinearities, even if regime-switching in

the form of (39) is not part of the maintained structure. For example, the economic relations

may change signiﬁcantly when interest rates are at the zero lower bound. Lind’s idea is to

approximate the behavior of a nonlinear model over a set of discrete regions using relations

that are linear (or possibly higher order polynomials) over individual regions, from which

one can then use many of the tools discussed above for economic and econometric analysis.

3.3    Linear rational expectations models with changes in regime.

Economic researchers often use a linear special case of (39) which in the absence of regime

shifts takes the form

                              AE(yt+1 |Ωt ) = d + Byt + Cxt                             (43)

                                    xt = c + Φxt−1 + vt

                                             40
for yt an (ny × 1) vector of endogenous variables, Ωt = {yt , yt−1 , ..., y1 }, xt an (nx × 1) vector

of exogenous variables, and vt a martingale diﬀerence sequence. Such a system might have

been obtained as an approximation to the ﬁrst-order conditions for a nonlinear DSGE using

the standard perturbation algorithm, or often is instead simply postulated as the primitive

conditions of the model of interest. If A−1 exists and the number of eigenvalues of A−1 B

whose modulus is less than or equal to unity is equal to the number of predetermined

endogenous variables, then a unique stable solution can be found of the form5


                                      kt+1 = hk0 + Hkk kt + Hkx xt


                                       dt = hd0 + Hdk kt + Hdx xt

where kt denotes the elements of yt that correspond to predetermined variables while dt

collects the control or jump variables. Algorithms for ﬁnding the values of the parameters

hi0 and Hij have been developed by Blanchard and Kahn (1980), Klein (2000), and Sims

(2001).

      We could also generalize (43) to allow for changes in regime,


                         Ast E(yt+1 |Ωt , st , st−1 , ..., s1 ) = dst +Bst yt + Cst xt          (44)


where st follows an exogenous N -state Markov chain and Aj denotes an (ny × ny ) matrix of

parameters when the regime for date t is given by st = j. To solve such a model, Davig and

Leeper (2007) suggested exploiting the feature that conditional on S = {st }∞
                                                                            t=1 the model is


linear. Let yjt correspond to the value of yt when st = j and collect the set of such vectors

  5
      Klein (2000) generalized to the case when A may not be invertible.

                                                      41
for all the possible regimes in a larger vector Yt :
                                                                   
                                                y1t                
                                                (ny ×1)            
                                                                   
                                       Yt =  ...
                                                                   
                                                                    .
                                     (Nny ×1)                      
                                                                   
                                                                   
                                                   yNt
                                                          (ny ×1)

If we restrict our consideration to solutions that satisfy the minimal-state Markov property,

then

                              E(yt+1 |S, Ωt ) = E(yt+1 |st+1 , st , Ωt )

and
                                              N
                    E(yt+1 |st = i, Ωt ) =         E(yt+1 |st+1 = j, st = i, Ωt )pij .
                                             j=1

Hence when st = i,

                          Ast E(yt+1 |st , Ωt ) = (p′i ⊗ Ai )E(Yt+1 |Yt )                   (45)

where                                                        
                                                       pi1 
                                                           
                                                        .. 
                                             pi = 
                                                         . 
                                                            
                                                           
                                                           
                                                        piN
denotes column i of the Markov transition probabilities, with elements of pi summing to

unity. Consider then the stacked structural system,

                               AE(Yt+1 |Yt ) = d + BYt + Cxt                                (46)
                                                                                     
                                    ′
                                p1 ⊗ A1                        d1                    
                                (1×N) (ny ×ny )                (ny ×1)               
                                                                                     
                      A
                               
                              =        ..       
                                                       d     =
                                                                 ..
                                                                 .
                                                                                        
                                                                                           (47)
                  (Nny ×Nny )           .          (Nny ×1)                          
                                                                                     
                                ′                                                    
                                  pN ⊗ AN                          dN
                                   (1×N)      (ny ×ny )                       (ny ×1)


                                                     42
                                                            
                                                                                                   
                              B1      0      ···    0 
                                                                                       C1        
                                                                                     (ny ×nx )   
                              0      B2      ··· 0                                               
                                                                                         ..      
                  B       =
                           
                                                                         C       =         .      .
              (Nny ×Nny )     ..       ..           ..              (N ny ×nx )                  
                               .        .    ···     . 
                                                                                  
                                                                                   
                                                                                                    
                                                                                                    
                                                       
                                                                                        CN
                                                                                        (ny ×nx )
                               0       0      · · · BN

This is a simple regime-independent system for which a solution can be found using the

traditional method.    For example, with no predetermined variables, if all eigenvalues of

A−1 B are outside the unit circle, then we can ﬁnd a unique stable solution of the form


                                 Yt          =      h       +      H        xt                           (48)
                               (Nny ×1)          (Nny ×1)       (Nny ×nx )(nx ×1)



which implies that

                                      yt      = hst + Hst               xt                               (49)
                                    (ny ×1)      (ny ×1)     (ny ×nx )(nx ×1)


for hi and Hi the ith blocks of h and H, respectively. If (48) is a solution to (46), then (49)




                                                        43
is a solution to (44).6

       However, Farmer, Waggoner, and Zha (2010) demonstrated that while (48) yields one

stable solution to (44), it need not be the only stable solution. For further discussion see

Farmer, Waggoner and Zha (2009).

3.4       Multiple equilibria.

Other economists have argued that models in which there are multiple possible solutions—

for example, system (43) with no predetermined variables and an eigenvalue of A−1 B inside

the unit circle— are precisely those we should be most interested in, given the perception that

sometimes consumers or ﬁrms seem to become highly pessimistic for no discernible reason,

bringing the economy into a self-fulﬁlling downturn; see Benhabib and Farmer (1999) for a

survey of this literature. One factor that could produce multiple equilibria is coordination

   6
       If (49) holds, then
                                                           N
                               E(yt+1 |Ωt , st = i) =           pij [hj + Hj (c + Φxt )].
                                                          j=1

Thus for (44) to hold it must be the case that for each i = 1, ..., N,
                                                 N
                                           Ai         pij Hj Φ = Bi Hi + Ci
                                                j=1

                                            N
                                      Ai         pij (hj + Hj c) = di + Bi hi .
                                           j=1

But if (48) is a solution to (46), then

                                A[h + H(c + Φxt )] = d + B(h + Hxt ) + Cxt

block i of which requires from (47) that

                                            (p′i ⊗ Ai )HΦ = Bi Hi + Ci

                                          (p′i ⊗ Ai )(h + Hc) = di + Bi hi
as were claimed to hold.




                                                           44
externalities.   The rewards to me of participating in a market may be greatest when I

expect large numbers of others to do the same (Cooper and John, 1988; Cooper, 1994).

Multiple equilibria could also arise when expectations themselves are a factor determining

the equilibrium (Kurz and Motolese, 2001). Kirman (1993) and Chamley (1999) discussed

mechanisms by which the economy might tend to oscillate periodically between the possible

regimes in multiple-equilibria settings.

   A widely studied example is ﬁnancial market bubbles. In the special case of risk-neutral

investors (that is, when U ′ (C) is some constant independent of consumption C), equation

(38) relating the price of the stock Pt to its future dividend Dt+1 becomes


                                   Pt = βEt (Pt+1 + Dt+1 ).                           (50)


One solution to (50) is the market-fundamentals solution given by

                                            ∞
                                    Pt∗ =         β j Et (Dt+j ).
                                            j=1


But Pt = Pt∗ + Bt also satisﬁes (50) for Bt any bubble process satisfying Bt = βEt Bt+1 .

Hall, Psaradakis and Sola (1999) proposed an empirical test of whether an observed ﬁnancial

price is occasionally subject to such a bubble regime. This test has been applied in dozens

of diﬀerent empirical studies.    However, Hamilton (1985), Driﬃll and Sola (1998), and

Gürkaynak (2008) noted the inherent diﬃculties in distinguishing ﬁnancial bubbles from

unobserved fundamentals.




                                                  45
3.5    Tipping points and ﬁnancial crises.

In other models, there may be a unique equilibrium but under the right historical conditions,

a small change in fundamentals can produce a huge change in observed outcomes.          Such

dynamics might be well-described as locally linear processes that periodically experience

changes in regime. Investment dynamics constitute one possible transmission mechanism.

The right sequence of events can end up triggering a big investment decline that in turn

contributes to a dramatic drop in output and an eﬀective change in regime. Acemoglu and

Scott (1997) presented a model where this happens as a result of intertemporal increasing

returns, for example, if an investment that leads to a signiﬁcant new discovery makes addi-

tional investments more proﬁtable for a short time. Moore and Schaller (2002), Guo, Miao,

and Morelle (2005), and Veldkamp (2005) examined diﬀerent settings in which investment

dynamics contribute to tipping points, often through a process of learning about current

opportunities. Startz (1998) demonstrated how an accumulation of small shocks could un-

der certain circumstances trigger a dramatic shift between alternative production technolo-

gies. Learning by market participants introduces another possible source of tipping-point

or regime-shift dynamics (Hong, Stein, and Yu, 2007; Branch and Evans, 2010). Gârleanu,

Panageas and Yu (2015) demonstrated how tipping points could emerge from the interaction

of limited market integration, leveraging, and contagion.

   Brunnermeier and Sannikov (2014) developed an intriguing description of tipping points

in the context of ﬁnancial crises. They posited two types of agents, designated “experts”

and “households”.     Experts can invest capital more productively than households, but


                                             46
they are constrained to borrow using only risk-free debt.      In normal times, 100% of the

economy’s equity ends up being held by experts.       But as negative shocks cause their net

worth to decline, they can end up selling oﬀ capital to less productive households, lowering

both output and investment.      This results in a bimodal stationary distribution in which

the economy spends most of its time around the steady state in which experts hold all the

capital.   But a sequence of negative shocks can lead the economy to become stuck in an

ineﬃcient equilibrium from which it can take a long time to recover.

   A large number of researchers have used regime-switching models to study ﬁnancial

crises empirically. These include Hamilton’s (2005) description of banking crises in the 19th

century, Asea and Blomberg’s (1998) study of lending cycles in the late 20th century, and

an investigation of more recent ﬁnancial stress by Hubrich and Tetlow (2015).

3.6    Currency crises and sovereign debt crises.

A sudden loss of conﬁdence in a country can lead to a ﬂight from the currency which in turn

produces a shock to credit and spending that greatly exacerbates the country’s problems. A

sudden wave of pessimism could be self-fulﬁlling, giving rise to multiple equilibria that could

exhibit Markov switching (Jeanne and Masson, 2000), or could be characterized by tipping

point dynamics where under the right circumstances a small change in fundamentals pushes

a country into crisis.   Empirical investigations of currency crises using regime-switching

models include Peria (2002) and Cerra and Saxena (2005).

   Similar dynamics can characterize yields on sovereign debt. If investors lose conﬁdence

in a country’s ability to service its debt, they will demand a higher interest rate as compen-


                                              47
sation. The higher interest costs could produce a tipping point that indeed forces a country

into default or to make drastic ﬁscal adjustments (Greenlaw, et al., 2013).      Analyses of

changes in regime in this context include Davig, Leeper, and Walker (2011) and Bi (2012).

3.7    Changes in policy as the source of changes in regime.

Another source of a change in regime is a discrete shift in policy itself.   One commonly

studied possibility is that control of monetary policy may periodically shift between hawks

and doves, the latter being characterized by either a higher inﬂation target or more willing-

ness to tolerate deviations of inﬂation from target. Analyses using this approach include

Owyang and Ramey (2004), Schorfheide (2005), Liu, Waggoner, and Zha (2011), Bianchi

(2013), and Baele, et al. (2015).

    An alternative possibility is that changes in ﬁscal regime can be a destabilizing factor.

Ruge-Murcia (1995) showed how a lack of credibility of the ﬁscal stabilization in 1984 con-

tributed to the changes in inﬂation Israel experienced, while Ruge-Murcia (1999) documented

the close connection between changes in ﬁscal regimes and inﬂation regimes for Brazil.


4     Conclusions and recommendations for researchers.

We have seen that researchers have a rich set of tools and speciﬁcations on which to draw

for interpreting data and building economic models for environments in which there may be

changes in regime. The chapter closes with some practical recommendations for researchers

as to which options are most promising.

    Although a researcher might be tempted to use the most general speciﬁcation possible,


                                             48
with all the parameters changing across a large number of regimes and time-varying tran-

sition probabilities, in practice this is usually asking more than the data can deliver. For

example, for postwar U.S. data we have only 11 recessions, which economic theory says

should be diﬃcult or impossible to predict (Hamilton, 2011). Building a richly parameter-

ized description of the transition into and out of recession could easily result in an overﬁtted

and misspeciﬁed model. By contrast, using a simple time-invariant Markov chain is likely

to give a reasonable and robust approximation to the key features of the data. Similarly, we

know from the analytic characterization of the maximum likelihood estimates (e.g., equa-

tion 24) that inference about parameters that only show up in regime i can only come from

observations within that regime. With postwar quarterly data that would mean about 50

observations from which to estimate all the parameters operating during recessions. One or

two parameters could be estimated fairly well, but overﬁtting is again a potential concern

in models with many parameters. For this reason researchers may want to limit the focus

to a few of the most important parameters that are likely to change, such as the intercept

and the variance.

   Where more than two regimes are required, there again are beneﬁts to keeping the model

parsimonious. For example, a common ﬁnding is that the variance of U.S. output growth

permanently decreased in 1984 (McConnell and Perez-Quiros, 2000) while the intercept peri-

odically shifts to negative during recessions. This requires 4 diﬀerent regimes— the economy

could be in expansion or recession and the date could be before or after the Great Mod-

eration. A useful simpliﬁcation treats the variance regime as independent of the recession



                                              49
regime, requiring estimation of only 4 transition probabilities rather than 12, as in Kim and

Nelson (1999b).

   Another feature of which researchers should be aware is that there can be multiple local

maxima to the likelihood function. It is therefore good practice to begin the EM iterations

from a large number of diﬀerent starting points to make sure we are always ending up

with the same answer, and also as a practical test of whether the algorithm has indeed

converged to a ﬁxed point. Likewise with Bayesian methods we want to make sure numerical

algorithms converge to the same posterior distribution under alternative starting points and

chain dynamics, and the procedure should take into account the label-switching problem.

   Provided researchers make note of these issues, these approaches oﬀer a ﬂexible way of

modeling some of the key nonlinearities in macroeconomic dynamics without sacriﬁcing the

simplicity and tractability of linear models.




                                                50
                                    References

   Acemoglu, Daron, and Andrew Scott (1997), “Asymmetric Business Cycles: Theory and

Time-Series Evidence,” Journal of Monetary Economics 40, 501-33.

   Albert, James, and Siddhartha Chib (1993), “Bayes Inference via Gibbs Sampling of Au-

toregressive Time Series Subject to Markov Mean and Variance Shifts,” Journal of Business

and Economic Statistics 11, 1-15.

   Ang, Andrew A., and Geert Bekaert (2002a), “International Asset Allocation with Regime

Shifts”, Review of Financial Studies 15, 1137-1187.

   Ang, Andrew A., and Geert Bekaert (2002b), “Regime Switches in Interest Rates,” Jour-

nal of Business and Economic Statistics 20, 163-182.

   Ang, Andrew A., and Allan Timmermann (2012), “Regime Changes and Financial Mar-

kets,” Annual Review of Financial Economics 4, 313-337.

   Asea, Patrick K., and Brock Blomberg (1998), “Lending Cycles,” Journal of Economet-

rics 83, 89-128.

   Auerbach, Alan and Yuriy Gorodnichenko (2012), “Measuring the Output Responses to

Fiscal Policy,” American Economic Journal: Macroeconomics 4, 1-27.

   Baele, Lieven, Geert Bekaert, Seonghoon Cho, Koen Inghelbrecht, and Antonio Moreno

(2015), “Macroeconomic Regimes,” Journal of Monetary Economics 70, 51-71.

   Bai, Jushan and Pierre Perron (1998), “Testing for and Estimation of Multiple Structural

Changes,” Econometrica 66, 47-78.

   Bai, Jushan and Pierre Perron (2003), “Computation and Analysis of Multiple Structural

                                            51
Change Models,” Journal of Applied Econometrics 18, 1-22.

   Bansal, Ravi, and Hao Zhou (2002), “Term Structure of Interest Rates with Regime

Shifts,” Journal of Finance 57, 1997-2042.

   Barro, Robert J. (2006), “Rare Disasters and Asset Markets in the Twentieth Century,”

Quarterly Journal of Economics 121, 823-866.

   Bekaert, Geert, Robert J. Hodrick, and David Marshall (2001), “Peso Problem Explana-

tions for Term Structure Anomalies,” Journal of Monetary Economics 48, 241-270.

   Benhabib, Jess, and Roger E. A. Farmer (1999), “Indeterminacy and Sunspots in Macro-

economics,” in Handbook of Macroeconomics, Vol. 1, edited by John Taylor and Michael

Woodford, North Holland.

   Bi, Huixin (2012), “Sovereign Default, Risk Premia, Fiscal Limits, and Fiscal Policy,”

European Economic Review 56, 389-410.

   Bianchi, Francesco (2013), “Regime Switches, Agents’ Beliefs and Post-World War II

U.S. Macroeconomic Dynamics,” Review of Economic Studies 80, 463-490.

   Blanchard, Olivier J. and Charles M. Kahn (1980), “The Solution of Linear Diﬀerence

Models under Rational Expectations,” Econometrica 48, 1305-1317.

   Branch, William A., and George W. Evans (2010), “Asset Return Dynamics and Learn-

ing,” Review of Financial Studies 23, 1651-1680.

   Brunnermeier, Markus K., and Yuliy Sannikov (2014), “A Macroeconomic Model with a

Financial Sector,” American Economic Review 104, 379-421.

   Calvet, Laurent, and Adlai Fisher (2004), “How to Forecast Long-Run Volatility: Regime-



                                             52
Switching and the Estimation of Multifractal Processes,” Journal of Financial Econometrics

2, 49-83.

   Camacho, Maximo, Gabriel Perez-Quiros, and Pilar Poncela (2014) “Green Shoots and

Double Dips in the Euro Are: A Real Time Measure,” International Journal of Forecasting

30, 520-535.

   Carrasco, Marine, Liang Hu, and Werner Ploberger (2014) “Optimal Test for Markov

Switching,” Econometrica 82, 765-784.

   Carter, Andrew V., and Douglas G. Steigerwald (2012), “Testing for Regime Switching:

A Comment,” Econometrica 80, 1809-1812.

   Carter, Andrew V., and Douglas G. Steigerwald (2013), “Markov Regime-Switching

Tests: Asymptotic Critical Values,” Journal of Econometric Methods 2, 25—34.

   Cecchetti, Stephen G., Pok-Sang Lam, and Nelson C. Mark (1990), “Mean Reversion in

Equilibrium Asset Prices,” American Economic Review 80, 398-418.

   Celeux, Gilles, Merrilee Hurn and Christian P. Robert (2000), “Computational and Infer-

ential Diﬃculties with Mixture Posterior Distributions,” Journal of the American Statistical

Association 95, 957-970.

   Cerra, Valerie, and Sweta Chaman Saxena (2005), “Did Output Recover from the Asian

Crisis?” IMF Staﬀ Papers 52, 1-23.

   Chamley, Christophe (1999), “Coordinating Regime Switches,” Quarterly Journal of Eco-

nomics 114, 869-905.

   Chauvet, Marcelle (1998), “An Economic Characterization of Business Cycle Dynamics



                                            53
with Factor Structure and Regime Switches,” International Economic Review 39, 969-996.

   Chauvet, Marcelle, and James D. Hamilton (2006), “Dating Business Cycle Turning

Points,” in Nonlinear Analysis of Business Cycles, pp. 1-54, edited by Costas Milas, Philip

Rothman, and Dick van Dijk, Amsterdam: Elsevier.

   Chauvet, Marcelle, and Jeremy Piger (2008), “A Comparison of the Real—Time Perfor-

mance of Business Cycle Dating Methods,” Journal of Business and Economic Statistics 26,

42-49.

   Chen, Jiahua and Pengfei Li (2009), “Hypothesis Test for Normal Mixture Models: The

EM Approach,” Annals of Statistics 37, 2523-2542.

   Chib, Siddhartha (1998), “Estimation and Comparison of Multiple Change-Point Mod-

els,” Journal of Econometrics 86, 221-241.

   Cho, Jin Seo, and Halbert White (2007), “Testing for Regime Switching,” Econometrica

75, 1671-1720.

   Christiano, Lawrence J., and Sharon G. Harrison (1999), “Chaos, Sunspots and Auto-

matic Stabilizers,” Journal of Monetary Economics 44, 3-31.

   Cooper, Russell (1994), “Equilibrium Selection in Imperfectly Competitive Economics

with Multiple Equilibria,” Economic Journal 104, 1106-1122.

   Cooper, Russell, and Andrew John (1988), “Coordinating Coordination Failures in Key-

nesian Models,” Quarterly Journal of Economics 103, 441-463.

   Dai, Qiang, Kenneth J. Singleton, and Wei Yang (2007), “Regime Shifts in a Dynamic

Term Structure Model of U.S. Treasury Bonds,” Review of Financial Studies 20, 1669-1706.



                                             54
   Davig, Troy (2004), “Regime-Switching Debt and Taxation,” Journal of Monetary Eco-

nomics 51, 837-859.

   Davig, Troy, and Eric M. Leeper (2007), “Generalizing the Taylor Principle,” American

Economic Review 97, 607-635.

   Davig, Troy, Eric M. Leeper, and Todd B. Walker (2011), “Inﬂation and the Fiscal

Limit,” European Economic Review 55, 31-47.

   DeGroot, Morris H. (1970), Optimal Statistical Decisions, New York: McGraw-Hill.

   Diebold, Francis X., Joon-Haeng Lee, and Gretchen C. Weinbach (1994), “Regime Switch-

ing with Time-Varying Transition Probabilities,” in Nonstationary Time Series Analysis and

Cointegration, edited by Colin P. Hargreaves, Oxford: Oxford University Press.

   Doan, Thomas (2012), RATS User’s Guide, Version 8.2 (http://www.estima.com).

   Driﬃll, John, and Martin Sola (1998), “Intrinsic Bubbles and Regime-Switching,” Jour-

nal of Monetary Economics 42, 357-374.

   Dueker, Michael (1997), “Markov Switching in GARCH Processes and Mean-Reverting

Stock-Market Volatility,” Journal of Business and Economic Statistics 15, 26-34.

   Elliott, Robert J., Leunglung Chan, and Tak Kuen Siu (2005), “Option Pricing and

Esscher Transform under Regime Switching,” Annals of Finance 1, 423—432.

   Evans, Martin D. D. (1996), “Peso Problems: Their Theoretical and Empirical Im-

plications,” in Handbook of Statistics, Vol. 14, edited by G. S. Maddala and C.R. Rao,

Amsterdam: Elsevier.

   Farmer, Roger E. A., Daniel F. Waggoner, and Tao Zha (2009), “Understanding Markov-



                                           55
Switching Rational Expectations Models,” Journal of Economic Theory 144, 1849-1867.

   Farmer, Roger E. A., Daniel F. Waggoner, and Tao Zha (2010), “Generalizing the Taylor

Principle: Comment,” American Economic Review 100, 608-617.

   Filardo, Andrew J. (1994), “Business Cycle Phases and Their Transitional Dynamics,”

Journal of Business and Economic Statistics 12, 299-308.

   Filardo, Andrew J., and Stephen F. Gordon (1998), “Business Cycle Durations,” Journal

of Econometrics 85, 99-123.

   Fisher, Franklin M. (1970), “Tests of Equality Between Sets of Coeﬃcients in Two Linear

Regressions: An Expository Note,” Econometrica 38, 361-366.

   Foerster, Andrew, Juan Rubio-Ramirez, Daniel F. Waggoner, and Tao Zha (forthcoming),

“Perturbation Methods for Markov-Switching DSGE Models,” Quantitative Economics.

   Francq, C., and J.-M. Zakoïan (2001), “Stationarity of Multivariate Markov-Switching

ARMA Models,” Journal of Econometrics 102, 339-364.

   Frühwirth-Schnatter, Sylvia (2001), “Markov Chain Monte Carlo Estimation of Classical

and Dynamic Switching and Mixture Models,” Journal of the American Statistical Associa-

tion 96, 194—209.

   Garcia, Rene (1998), “Asymptotic Null Distribution of the Likelihood Ratio Test in

Markov Switching Models,” International Economic Review 39, 763-788.

   Garcia, Rene, Richard Luger, and Eric Renault (2003), “Empirical Assessment of an

Intertemporal Option Pricing Model with Latent Variables,” Journal of Econometrics 116,

49-83.



                                           56
   Gârleanu, Nicolae, Stavros Panageas and Jianfeng Yu (2015), “Financial Entanglement:

A Theory of Incomplete Integration, Leverage, Crashes, and Contagion”, American Eco-

nomic Review, 105, 1979-2010.

   Geweke, John (2007), “Interpretation and Inference in Mixture Models: Simple MCMC

Works,” Computational Statistics and Data Analysis 51, 3529-3550.

   Gordon, Stephen and Andrew Filardo (1998), “Business Cycle Durations”, Journal of

Econometrics 85, 99-123.

   Greenlaw, David, James D. Hamilton, Peter Hooper, and Frederic Mishkin (2013),

“Crunch Time: Fiscal Crises and the Role of Monetary Policy,” in Proceedings of the U.S.

Monetary Policy Forum 2013, pp. 3-58, Chicago Booth School of Business: Initiative on

Global Markets.

   Guidolin, Massimo, and Allan Timmermann (2008) “International Asset Allocation un-

der Regime Switching, Skew, and Kurtosis Preferences,” Review of Financial Studies,21,

889-935.

   Guo, Xin, Jianjun Miao, and Erwan Morelle (2005), “Irreversible Investment with Regime

Shifts,” Journal of Economic Theory 122, 37—59.

   Gürkaynak, Refet S. (2008), “Econometric Tests of Asset Price Bubbles: Taking Stock,”

Journal of Economic Surveys 22, 166-186.

   Hall, Peter, and Michael Stewart (2005), “Theoretical Analysis of Power in a Two-

Component Normal Mixture Model,” Journal of Statistical Planning and Inference 134,

158-179.



                                           57
   Hall, Stephen G., Zacharias Psaradakis and Martin Sola (1999), “Detecting Periodically

Collapsing Bubbles: A Markov-Switching Unit Root Test,” Journal of Applied Econometrics

14, 43-154.

   Hamilton, James D. (1985), “On Testing for Self-Fulﬁlling Speculative Price Bubbles,”

International Economic Review 27, 545-552.

   Hamilton, James D. (1989), “A New Approach to the Economic Analysis of Nonstation-

ary Time Series and the Business Cycle,” Econometrica 57, 357-384.

   Hamilton, James D. (1990), “Analysis of Time Series Subject to Changes in Regime,”

Journal of Econometrics 45, 39-70.

   Hamilton, James D. (1994), Time Series Analysis, Princeton, NJ: Princeton University

Press.

   Hamilton, James D. (1996), “Speciﬁcation Testing in Markov-Switching Time-Series

Models,” Journal of Econometrics 70, 127-157.

   Hamilton, James D. (2005), “What’s Real About the Business Cycle?”, Federal Reserve

Bank of St. Louis Review 87, 435-452.

   Hamilton, James D. (2011), “Calling Recessions in Real Time,” International Journal of

Forecasting 27, 1006-1026.

   Hamilton, James D., and Gang Lin (1996), “Stock Market Volatility and the Business

Cycle,” Journal of Applied Econometrics 11, 573-593.

   Hamilton, James D., and Gabriel Perez-Quiros (1996), “What Do the Leading Indicators

Lead?”, Journal of Business 69, 27-49.



                                             58
   Hamilton, James D., and Raul Susmel (1994), “Autoregressive Conditional Heteroskedas-

ticity and Changes in Regime,” Journal of Econometrics 64, 307-333.

   Hamilton, James D., and Jing Cynthia Wu (2012), “Identiﬁcation and Estimation of

Gaussian Aﬃne Term Structure Models,” Journal of Econometrics 168, 315-331.

   Hansen, Bruce E. (1992), “The Likelihood Ratio Test under Non-Standard Conditions,”

Journal of Applied Econometrics 7, S61-82. Erratum, 1996, 11, 195-198

   Hong, Harrison, Jeremy C. Stein, and Jialin Yu (2007), “Simple Forecasts and Paradigm

Shifts,” Journal of Finance 62, 1207-1242.

   Hubrich, Kirstin, and Robert J. Tetlow (2015), “Financial Stress and Economic Dynam-

ics: The Transmission of Crises,” Journal of Monetary Economics 70, 100-115.

   Jeanne, Olivier and Paul Masson (2000), “Currency Crises, Sunspots, and Markov-

Switching Regimes,” Journal of International Economics 50, 327-350.

   Karamé, Frédéric (2010), “Impulse-Response Functions in Markov-Switching Structural

Vector Autoregressions: A Step Further,” Economics Letters 106, 162-165.

   Kim, Chang Jin (1994), “Dynamic Linear Models with Markov-Switching,” Journal of

Econometrics 60, 1-22.

   Kim, Chang Jin, and Charles R. Nelson (1999a), State-Space Models with Regime Switch-

ing, Cambridge, Massachusetts: MIT Press.

   Kim, Chang-Jin, and Charles R. Nelson (1999b) “Has the U.S. Economy Become More

Stable? A Bayesian Approach Based on a Markov-switching Model of the Business Cycle”,

Review of Economics and Statistics 81, 608—616.



                                             59
   Kirman, Alan (1993), “Ants, Rationality, and Recruitment,” Quarterly Journal of Eco-

nomics 108, 137-156.

   Klein, Paul (2000), “Using the Generalized Schur Form to Solve a Multivariate Linear

Rational Expectations Model,” Journal of Economic Dynamics and Control 24, 1405-1423.

   Koop, Gary, and Simon N. Potter (1999), “Bayes Factors and Nonlinearity: Evidence

from Economic Time Series,” Journal of Econometrics 88, 251-281.

   Krolzig, Hans-Martin (1997), Markov-Switching Vector Autoregressions : Modelling, Sta-

tistical Inference, and Application to Business Cycle Analysis, Berlin: Springer.

   Kurz, Mordecai, and Maurizio Motolese (2001), “Endogenous Uncertainty and Market

Volatility,” Economic Theory 17, 497-544.

   Lind, Nelson (2014), “Regime-Switching Perturbation for Non-Linear Equilibrium Mod-

els,” working paper, UCSD.

   Liu, Zheng, Daniel F. Waggoner, and Tao Zha (2011), “Sources of Macroeconomic Fluc-

tuations: A Regime-Switching DSGE Approach,” Quantitative Economics 2, 251-301.

   Lo, Ming Chien, and Jeremy Piger (2005), “Is the Response of Output to Monetary

Policy Asymmetric? Evidence from a Regime-Switching Coeﬃcients Model,” Journal of

Money, Credit and Banking 37, 865-886.

   Lucas, Robert E., Jr. (1978), “Asset Prices in an Exchange Economy,” Econometrica 66,

1429-1445.

   McConnell, Margaret M. and Gabriel Perez-Quiros (2000), “Output Fluctuations in the

United States: What Has Changed Since the Early 1980’s?,” American Economic Review



                                             60
90, 1464-1476.

   Moore, Bartholomew and Huntley Schaller (2002), “Persistent and Transitory Shocks,

Learning, and Investment Dynamics,” Journal of Money, Credit and Banking 34, 650-677.

   Owyang, Michael, and Garey Ramey (2004), “Regime Switching and Monetary Policy

Measurement, Journal of Monetary Economics 51, 1577-1597.

   Peria, Maria Soledad Martinez (2002), “A Regime-Switching Approach to the Study of

Speculative Attacks: A Focus on EMS Crises,” in Advances in Markov-Switching Models,

edited by James D. Hamilton and Baldev Raj, Heidelberg: Physica-Verlag.

   Pesaran, M. Hashem, Davide Pettenuzzo, and Allan Timmermann (2006), “Forecasting

Time Series Subject to Multiple Structural Breaks,” Review of Economic Studies 73, 1057-

1084.

   Pesaran, M. Hashem, and Allan Timmermann (2007), “Selection of Estimation Window

in the Presence of Breaks,” Journal of Econometrics 137, 134-161.

   Ruge-Murcia, Francisco J. (1995), “Credibility and Changes in Policy Regime,” Journal

of Political Economy 103, 176-208.

   Ruge-Murcia, Francisco J. (1999), “Government Expenditure and the Dynamics of High

Inﬂation,” Journal of Development Economics 58, 333-358.

   Schmitt-Grohe, Stephanie and Martin Uribe (2004), “Solving Dynamic General Equi-

librium Models using a Second-order Approximation,” Journal of Economic Dynamics and

Control 28, 755-775.

   Schorfheide, Frank (2005), “Learning and Monetary Policy Shifts,” Review of Economic



                                           61
Dynamics 8, 392-419.

   Schwarz, Gideon (1978), “Estimating the Dimension of a Model,” Annals of Statistics 6,

461-464.

   Sims, Christopher (2001), “Solving Linear Rational Expectations Models,” Journal of

Computational Economics 20, 1-20.

   Sims, Christopher, and Tao Zha (2006), “Were There Regime Switches in U.S. Monetary

Policy?”, American Economic Review 96, 54-81.

   Smith, Aaron, Prasad A. Naik, and Chih-Ling Tsai (2006), “Markov-Switching Model

Selection using Kullback—Leibler Divergence,” Journal of Econometrics 134, 553—577.

   Startz, Richard (1998), “Growth States and Shocks,” Journal of Economic Growth 3,

203-15.

   Teräsvirta, Timo (1994), “Speciﬁcation, Estimation, and Evaluation of Smooth Transi-

tion Autoregressive Models,” Journal of the American Statistical Association 89, 208-218.

   Teräsvirta, Timo (2004), “Smooth Transition Regression Modelling,” in Applied Time

Series Econometrics, pp. 222-242, edited by Helmut Lütkepohl and Markus Krätziģ, Cam-

bridge, U.K.: Cambridge University Press.

   Timmermann, Allan (2000), “Moments of Markov Switching Models,” Journal of Econo-

metrics 96, 75-111.

   Tjøstheim, Dag (1986), “Some Doubly Stochastic Time Series Models,” Journal of Time

Series Analysis 7, 51-72.

   Veldkamp, Laura L. (2005), “Slow Boom, Sudden Crash,” Journal of Economic Theory



                                            62
124, 230-257.

   Yang, Min Xian (2000), “Some Properties of Vector Autoregressive Processes with Markov-

Switching Coeﬃcients,” Econometric Theory 16, 23-43.

   White, Halbert (1984), Asymptotic Theory for Econometricians, Orlando: Academic

Press.




                                           63
      Appendix: Derivation of EM equations for restricted VAR.
      As noted by Hamilton (1990, p. 47), the M or maximization step of the EM algorithm

can be implemented by ﬁnding the ﬁrst-order conditions associated with maximizing the

likelihood conditional on a particular set of realizations for the regimes S = {s1 , ..., sT } and

then weighting these by the smoothed probability of S and summing over all the possible

realizations of S. For a VAR restricted as in (28), the conditional likelihood is

          1                                T
                       exp −(1/2)          t=1 (yt   − Ax1,t−1 − Bst x2,t−1 )′ Σ−1 (yt − Ax1,t−1 − Bst x2,t−1 )
(2π)nT /2 |Σ|T /2

with ﬁrst-order conditions

                                       T
                                       t=1 (yt   − Ax1,t−1 − Bst x2,t−1 )x′1,t−1 = 0                         (51)

                      T
                      t=1 (yt   − Ax1,t−1 − Bst x2,t−1 )x′2,t−1 δ(st = i) = 0      for i = 1, ..., N         (52)

                T
                t=1 (1/2) [Σ      − (yt − Ax1,t−1 − Bst x2,t−1 )(yt − Ax1,t−1 − Bst x2,t−1 )′ ] = 0          (53)

where δ(st = i) denotes unity if st = i and zero otherwise. Stacking (51)-(52) horizontally

gives

  T                                                     T
  t=1 (yt     − Ax1,t−1 − Bst x2,t−1 )z′t−1 =           t=1   yt −    A B1 B2 · · ·       BN     zt−1 z′t−1 = 0

                                                                                                             (54)

for


              z′t−1       =      x′1,t−1 x′2,t−1 δ(st = 1) x′2,t−1 δ(st = 2) · · · x′2,t−1 δ(st = N)     .
        [1×(nk1 +Nk2 )]

                                                                                                  (ℓ)
Multiplying the tth term within the sums in (54) and (53) by Prob(st = i|ΩT ; λ̂ ), summing

over i = 1, ..., N and rearranging gives equations (29) and (30).

                                                              64
                                           Table 1

                                                     Value from NBER
     Parameter            Interpretation                                 Value from GDP alone
                                                      classiﬁcations
        (1)                    (2)                                                 (4)
                                                           (3)

        m1        average growth in expansion              4.5                    4.62

        m2         average growth in recession            −1.2                   −0.48

         σ        standard deviation of growth             3.5                    3.34

        p11        prob. expansion continues               0.95                   0.92

        p22         prob. recession continues              0.78                   0.74

   Parameter estimates based on characteristics of expansions and recessions as classiﬁed by

NBER (column 3), and values that maximize the observed sample log likelihood of postwar

GDP growth rates (column 4), 1947:Q2-2004:Q2. Source: Chauvet and Hamilton (2006).




                                             65
                              Unemployment rate
  11


  10


   9


   8


   7


   6


   5


   4


   3


   2
          1950 1955 1960 1965 1970 1975 1980 1985 1990 1995 2000 2005 2010 2015

Figure 1. U.S. civilian unemployment rate, seasonally adjusted, 1948:M1-2015:M11.
Shaded regions correspond to NBER recession dates.
.




                                         66
                     GDP-based Recession indicator index
  125


  100


    75


    50


    25


     0


   -25
              1970   1975    1980   1985    1990   1995    2000   2005    2010   2015


Figure 2. One-quarter-ahead smoothed probabilities         ( = 2|Ω ,         ), 1967:Q4-
2014:Q2, as inferred using solely GDP data as reported as of date t +1. Shaded regions
correspond to NBER recession dates which were not used in any way in constructing the
probabilities. Prior to 2005, each point on the graph corresponds to a simulated real-time
inference that was constructed from a data set as it would have been available four
months after the indicated date, as reported in Chauvet and Hamilton (2006). After 2005,
points on the graph correspond to actual announcements that were publicly released four
months after the indicated date. Source: updated from Hamilton (2011) and
www.econbrowser.com.




                                           67
