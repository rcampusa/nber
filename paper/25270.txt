                              NBER WORKING PAPER SERIES




                        NON-RANDOMLY SAMPLED NETWORKS:
                             BIASES AND CORRECTIONS

                                       Chih-Sheng Hsieh
                                        Stanley I. M. Ko
                                        Jaromír Ková ík
                                         Trevon Logan

                                      Working Paper 25270
                              http://www.nber.org/papers/w25270


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                           November 2018, Revised June 2019




We are grateful to Aureo de Paula, Marco van der Leij, and participants at numerous seminars for
comments and suggestions. Jaromír Ková ík acknowledges financial support from the Basque
Government (IT-783-13), Ministerio de Economía y Competividad and Fondo Europeo de
Desarrollo Regional (ECO2015- 64467-R MINECO/FEDER and ECO 2015-66027-P), and the
Grant Agency of the Czech Republic. The views expressed herein are those of the authors and do
not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2018 by Chih-Sheng Hsieh, Stanley I. M. Ko, Jaromír Ková ík, and Trevon Logan. All rights
reserved. Short sections of text, not to exceed two paragraphs, may be quoted without explicit
permission provided that full credit, including © notice, is given to the source.
Non-Randomly Sampled Networks: Biases and Corrections
Chih-Sheng Hsieh, Stanley I. M. Ko, Jaromír Ková ík, and Trevon Logan
NBER Working Paper No. 25270
November 2018, Revised June 2019
JEL No. C4,D85,L14,Z13

                                         ABSTRACT

This paper analyzes statistical issues arising from networks based on non-representative samples
of the population. We first characterize the biases in both network statistics and estimates of
network effects under non-random sampling theoretically and numerically. Sampled network data
systematically bias the properties of observed networks and suffer from non-classical
measurement-error problems when applied as regressors. Apart from the sampling rate and the
elicitation procedure, these biases depend in a non-trivial way on which subpopulations are
missing with higher probability. We propose a methodology, adapting post-stratification
weighting approaches to networked contexts, which enables researchers to recover several
network-level statistics and reduce the biases in the estimated network effects. The advantages of
the proposed methodology are that it can be applied to network data collected via both designed
and non-designed sampling procedures, does not require one to assume any network formation
model, and is straightforward to implement. We apply our approach to two widely used network
data sets and show that accounting for the non-representativeness of the sample dramatically
changes the results of regression analysis.

Chih-Sheng Hsieh                                Jaromír Kováík
Chinese University of Hong Kong                 Departamento Fundamentos Análisis Económico I
Department of Economics                         Universidad del País Vasco
Room 911 Esther Lee Building                    Av. Lehendakari Aguirre 83
Hong Kong                                       Spain
cshsieh@cuhk.edu.hk                             jaromir.kovarik@ehu.eus

Stanley I. M. Ko                                Trevon Logan
University of Macau                             The Ohio State University
Department of Finance and                       410 Arps Hall
Business Economics                              1945 N. High Street
Faculty of Business Administration              Columbus, OH 43210
Room 4003, E22                                  and NBER
Macau                                           logan.155@osu.edu
stanleyko@umac.mo
1       Motivation
There is growing interest in understanding the role of networks in Economics.1 Different
“micro” and “macro” features of network architecture shape diffusion, learning, behavior, and
other substantive phenomena in a variety of contexts.2 Due to the increasing availability of
large network data sets and increasing computational power, empirical network research is now
a dynamic part of this literature. At the same time, empirical network analysis generates new
econometric challenges (Fortin and Boucher, 2015; De Paula, 2017; Jackson et al., 2017). This
paper investigates issues arising with non-randomly sampled network data, the most common
network data used.
    The vast majority of empirical network studies analyze partial samples, and the sampling
rates are typically low.3 Even though the literature across several disciplines has noted that
using sampled data may lead to considerable biases and other statistical issues (see below
for references), the typical approach is to treat the data “as if” it were complete.4 In a
recent contribution, Chandrasekhar and Lewis (2016) show formally that, even in absence of
other econometric issues and even if the nodes are selected randomly, sampled networks differ
systematically from the population networks and that inference on sampled network data
leads to measurement errors and inconsistency problems when identifying network effects.
The estimates from using sampled networks may suffer from attenuation, but also expansion
or even sign switching. As such, one cannot rely on solutions to classical measurement-error
problems to correct these issues “even if ” the sample is representative.
    Furthermore, samples in network studies are typically non-representative. Apart from
problems inherent in sampling, non-representativeness of network data may be caused by
the sampling strategy itself (Frank, 1981; Kossinets, 2006; Kolaczyk, 2009; Handcock and
Gile, 2010). For instance, snowball sampling, one prominent sampling method in applied
work, is prone to finding nodes with higher connectivity than nodes with a small number
of network neighbors. The reason is that people are found through network links. Having
more connections thus increases the probability of being sampled.5 Other issues arise with
“truncated” methods due to either the specification of network boundary or fixed-choice design
(e.g., nominate five friends). Last, several data sets exploit stratified network samples to better
approximate the missing-at-random assumption. Unfortunately, it is difficult and costly to
stratify on all relevant characteristics. Many of the issues with collection of network data
might generate, and often do, samples in which the observed network structure is endogenous
to the missing data mechanism.
    In this paper, we document that two very carefully elicited and widely applied network
data sets – The National Longitudinal Study of Adolescent to Adult Health (hereafter Add
Health), collected with the truncated fixed-choice design, and a more recent stratified data
    1
     See Vega-Redondo (2007), Jackson (2010b), and Goyal (2012) for reviews.
    2
     Jackson (2010a) provides a survey of economic applications. Jackson et al. (2017) develop a taxonomy of
macro, aggregate, or global network properties as opposed to micro, local, or individual ones, which we adopt
here. They consequently review the influence of these characteristics at both levels in different socio-economic
settings.
   3
     An important reason behind the common use of partial samples is that network elicitation is typically
more costly than collection of basic individual characteristics (Breza et al., 2017). Chandrasekhar and Lewis
(2016) report that the median sampling rate in applied work in Economics is 25% and more than 66% of
network studies have a sampling rate lower than 51%. Similar rates are found in other fields.
   4
     Exceptions include Ammermueller and Pischke (2009), Conley and Udry (2010), and Conti et al. (2013).
   5
     Similar issues arise with other edge-based sampling strategies, such as independent edge sampling.


                                                       1
set on microfinance take-up in a number of Indian villages (Banerjee et al., 2013) – are indeed
non-random samples of the population under scrutiny. We argue that the existing approaches
to sampled network data do not eliminate the statistical problems arising from non-random
sampling and show how failure to account for non-representativeness of the sample causes
problems with inference about the size and even the direction of network effects.
    To intuitively explain the issues arising from non-random sampling, we informally de-
compose the problem into two effects, scaling and non-representativeness. Scaling refers to
observing fewer people and relationships than there exist in the population, independently of
the (non-) representativeness of the sample. In contrast, non-representativeness corresponds
to non-randomness of the sample. If nodes are missing at random, only scaling matters. As an
example of the effect of random missing, consider the average degree of a network.6 If the links
between the sampled and non-sampled individuals are not observed, then the sample average
degree is biased downwards by construction. In addition, imagine that the population average
degree is correlated with the diffusion properties of the network. Applying the observed sam-
ple average degree in a regression therefore inflates the estimated impact of average degree on
diffusion under random missing. This is an example of expansion of the estimated effect and
thus non-classical measurement error. However, if nodes are not missing at random, whether
the observed average degree and the estimates will be inflated or attenuated will depend on
who is missing. For example, if less connected nodes are missing with higher probability (a
problem inherent in snowball sampling), scaling and non-representativeness can bias the aver-
age degree and the estimates in opposite directions, and one cannot easily predict which force
will dominate. In contrast to average degree, the homophily index and clustering coefficient
can be unbiased in representative samples.7 Nevertheless, in samples in which different types
of nodes are missing with differing probabilities, homophily will be biased by definition. Since
clustering is typically associated with connectivity in social networks (Jackson and Rogers,
2007), it is also likely to be mismeasured. The magnitude and direction of the biases in
these characteristics and in their estimated effects in regressions again depend crucially and
non-trivially on who is missing.
    This study provides a systematic analysis of the problems arising from examining non-
randomly sampled network data8 and proposes a solution that (i) allows researchers to re-
cover the true population network properties and (ii) mitigates biases in regressions testing
the impact of network features (such as the average degree, total clustering, or homophily of
a network) on either individual or group-level behaviors and outcomes.9 We first characterize
analytically and numerically the extent of biases under non-random missing both in the struc-
tural properties of observed networks and in estimates from a regression analysis, employing
raw sampled networks as well as the existing corrections based on the missing-at-random as-
sumption. Second, we propose a set of analytical corrections which allow us to recover the true
values of several network characteristics widely used in applications. Third, we test the ability
   6
     Average degree is the average number of connections per person in a network. It is formally defined in
Section 2.
   7
     Homophily is the tendency to associate with higher probability with similar others and the clustering
coefficient is a measure of local density within one’s neighborhood. See Section 2 for definitions.
   8
     Formal definition of (non-)randomness can be found in Section 2.1.
   9
     Our study also improves inferences in network-formation applications studying contextual determinants of
the network architecture (i.e. applying different network properties as regressands). Since network formation
represents a key topic in the network literature (see Jackson (2005) for a review), it enlarges the applicability
of the proposed methodology. However, since mismeasured dependent variables are less problematic as they
only affect the estimated errors, this study focuses on regressions including network properties as regressors.


                                                       2
of our approach to mitigate these biases vis-à-vis the raw data, true population statistics, and
random corrections. Last, the proposed methodology is applied to the Add Health data and
the Indian village network data from Banerjee et al. (2013). These data sets are particularly
suited for our approach because they contain a relatively large number of networks, are widely
employed in empirical work,10 and a node and link have different meanings in each setting,
illustrating the broad applicability of our approach. Crucially, both data sets were very care-
fully collected, following standard sampling procedures in applied network research. We thus
believe that our analysis can be viewed as a conservative perspective on the severity of the
issue in applied work.
    The first contribution of this study is to show that relying on the missing-at-random
assumption to adjust the raw network sample, which is rarely satisfied empirically, may be as
serious as applying raw network data. Since the direction and magnitude of the biases depend
on who is missing, we demonstrate the necessity of accounting for potential different missing
rates of different segments of the population in applied work. This is particularly important
in network data as population and distributional parameters are of main interest.
    As a second and main contribution of this paper, we propose analytical corrections for a
set of network characteristics widely used in applications: average degree, degree distribution,
clustering coefficient, graph span, epidemic threshold, bounds on the maximal eigenvalue of
the adjacency matrix of a network, and homophily. These network features represent fun-
damental aspects of network architecture commonly employed in theoretical and empirical
research and provide intuitive insights regarding the way social organization shapes individual
and group-level phenomena (Jackson et al., 2017). To that aim, we take explicit account of
the missing rates of different sub-populations and adapt standard (i.e., network-free) post-
stratification weighting approaches to networked contexts. There is a general agreement that
when population information is available, post-stratification weighting can correct sampling
biases due to varying response rates among different demographic or socioeconomic categories
and thus improve the precision of sample estimates for objective variables of interest.11 Intu-
itively, we assume that the population can be divided into a finite number T ∈ N of disjoint
types or groups and that sampling (or conversely missing) rates differ across types.12 The
main difference between the standard post-stratification and our approach is to weight on net-
work links, triples, or triangles, rather than on individuals. Since the proposed corrections are
asymptotically unbiased, regressing economic outcomes on the corrected network measures,
or using the corrected network features as dependent variables, delivers consistent estimates
under standard assumptions. Moreover, our methodology nests the existing corrections de-
signed for random sampling as a special case (e.g., Frank, 1980, 1981, Kolaczyk, 2009, Zhang
et al., 2015, Chandrasekhar and Lewis, 2016). Both approaches perform similarly both the-
oretically and in our numerical experiments if the sample is indeed representative. However,
our methodology outperforms approaches based on the missing-at-random assumption if the
sample is non-representative, making our methodology more broadly applicable.
  10
     See e.g., Moody (2001); Echenique and Fryer (2007); Bramoullé et al. (2009); Currarini et al. (2009, 2010);
Calvó-Armengol et al. (2009) among many others for the friendship networks and Chandrasekhar and Lewis
(2016); Jackson et al. (2012); Banerjee et al. (2013, 2014) and De Paula et al. (2018) for the latter.
  11
     See Holt and Smith (1979), Little (1993) and Valliant (1993) for statistical properties of poststratification
weighting.
  12
     These types or groups are thought to represent, say, gender, race, ethnicity, location, age, education, etc.
or their combinations (say, “white women of an age between 20 and 30 with an yearly income below $50,000”
or “men of other race of an age over 70 with an income over $100,000.”). The variable resulting from combining
different types is termed rake in the post-stratification literature and throughout our paper.


                                                        3
    Our applications corroborate that one cannot easily predict the direction and magnitude of
these biases, and that they are substantively significant. The Indian village networks stratified
on religion and geographical location are non-representative in terms of age and gender, while
senior and non-white students are overrepresented in the Add Health data. We report that
not accounting for unequal missing rates of different segments of the population affects the
estimated network effects significantly in either data set. In a battery of regressions, we
frequently observe attenuation and false negative findings, but expansion, sign-switching, and
false positives are also commonplace. Moreover, the biases are economically important; in
many instances, the network effects are over/underestimated by roughly 100% or more.
    The present paper connects to three literatures. First, we connect to the literature on miss-
ing social network data. Numerous studies across fields drew attention to the issues arising
with sampled networks and how particular sampling methods affect observed networks, some
of which provide partial solutions to different issues (Frank, 1980, 1981; Stork and Richards,
1992; Stumpf et al., 2005; Kossinets, 2006; Huisman, 2009; Handcock and Gile, 2010). Within
this literature, Zhang et al. (2015) build on Frank (1980, 1981) and propose an estimation
procedure to recover the true degree distribution from sampled data if all randomness comes
from the sampling method itself. We generalize their methodology to other potential sources
of non-randomness. Our approach has certain parallelism with respondent driven-sampling, a
methodology that combines snowball sampling with a model that weights the sample to com-
pensate for the non-representativeness of the sample (Heckathorn, 1997), as well as statistical
sampling theory that has developed procedures for how to recover true population networks if
the only source of randomness is the sampling design (see Kolaczyk (2009) for a survey). Our
weighting method has the same goals but differs substantially from these approaches in the
underlying assumptions and in applicability: the former approaches are only applicable under
specific sampling designs, whereas our approach can be applied both under designed sampling
that depends on the network structure (such as snowball sampling) and also in cases in which
networks are not elicited via designed sampling (as the case in e.g., the Add Health data or the
stratified sample in Banerjee et al. (2013)).13 Moreover, existing approaches assume certain
forms of representativeness in the sampling process ex ante, while our proposed methodology
exploits the ex-post non-representativeness of the sample.
    Second, our methodology complements an emerging econometric literature on imperfectly
measured network data and the estimation of network effects. Chandrasekhar and Lewis (2016)
propose an integral methodology of how to deal with randomly sampled networks. Similar
to this paper, they show that estimations with sampled networks suffer from non-classical
measurement error and propose a method to ensure consistent estimates. Their methodology
consists of two alternative strategies. First, they provide formal corrections for average degree,
clustering coefficient, and graph span under an assumption of random sampling. Our approach
generalizes this first strategy. As a second solution, they propose a graphical reconstruction
technique that delivers consistent estimates in both network-level and individual-level regres-
sions.14 The procedure is to first estimate a network formation model, and then employ the
estimated model to interpolate over missing parts of the network. As mentioned in their pa-
per, the network reconstruction approach requires a correct model specification and certain
  13
     For sake of brevity, we focus on two sampling designs in this paper, but our methodology can be applied
to other sampling methods as discussed in Section 6.
  14
     This includes the estimation of network effects using instrumentation techniques proposed by Bramoullé
et al. (2009) and De Giorgi et al. (2010). Liu (2013) shows that the solution in Chandrasekhar and Lewis
(2016) may still suffer from weak-instrument problems.


                                                     4
assumptions to ensure consistency of the network statistics. This second approach does not
necessarily recover the network properties, however. Most importantly for the present work,
both approaches are based on a missing-at-random assumption. Breza et al. (2017) propose a
two-stage strategy for network elicitation using responses to questions such as “How many of
your social connections have trait k?” that permits the estimation of both node- or graph-level
network properties. Chandrasekhar and Jackson (2016) propose a network formation model
similar in the spirit to our recovery methodology in that it is also based on subgraphs in
function of types of the nodes. The advantage of our approach, as opposed to the graphical
reconstruction in Chandrasekhar and Lewis (2016) and the approaches in Breza et al. (2017)
and Chandrasekhar and Jackson (2016), is that our methodology does not rely on any par-
ticularly assumed network formation model. This is crucial because when the model is fitted
on non-representative network samples, the estimated network-formation parameters in the
first stage will likely be biased and potentially inconsistent even if the assumed model is cor-
rect. As a result, none of these approaches can effectively recover the true network formation
process from non-representative samples. Our methodology overcomes this issue as well as
additional statistical problems arising from assuming an incorrect network formation model
and introducing additional uncertainty via the two-stage procedures in Chandrasekhar and
Lewis (2016), Breza et al. (2017), and Chandrasekhar and Jackson (2016). More recently,
De Paula et al. (2018) propose a methodology allowing estimates of the entire network struc-
ture from panel data simultaneously with peer effects if either no or partial information on
networks is available. The latter is, by definition, restricted to panel data containing a large
enough number of time series units, a very strong requirement in many applications.15 We
are interested in recovering the true network of interest from partial network data and how
global network properties shape individual and group-level behaviors and outcomes, a type
of network effects on which their approach does not apply. Hence, our work complements
and expands the above studies by providing the first step toward the statistical treatment of
network data coming from non-representative samples of the population, which is the most
common type of network data available.
    Last, we contribute to better practices in the empirical evaluation of the effects of global
network features in socio-economic environments. Our study shows that even in the absence
of other econometric issues, mismeasured network data with non-representative samples might
lead to a serious misunderstanding of network effects. However, our methodology mitigates
this issue and provides an additional argument for the employment of sampling in empirical
network work. As network data and empirical techniques continue to be widely used, the
proposed approach can serve to improve the inference that we draw from network studies
more generally, and as a standard robustness check of empirical results.


2      Framework
2.1     Notation
A population network (graph) is a pair G = (V, E) of a set of nodes V and edges E. Denote
n = |V | the cardinality of V . The network is represented with an n×n adjacency matrix W (G).
We follow the theoretical and empirical literature and focus on undirected and unweighted
  15
    More importantly, the main objective of De Paula et al. (2018) is to estimate endogenous network effects
in the classic Manski (1993) specification.


                                                     5
networks.16 Therefore, Wij = 1(0) if i and j are (not) connected and Wij = Wji for each
i, j ∈ V . Following convention, we set Wii = 0. We assume that the population can be
classified into T disjoint types with a generic type t P   ∈ {1, 2, ..., T }. Let Vt be the set of nodes
of type t, nt = |Vt | is the size of subpopulation t, and Tt=1 nt = n. We write ti = t if individual
i is of type t. Then, ti = tj (ti 6= tj ) indicates that i and j are (not) of the same type.
     Rather than the whole network, researchers observe only sample of the population network.
Let S ⊂ V be the set of sampled nodes of size m = |S| = ψn, where ψ = m               n
                                                                                         is the sampling
rate. Analogously, mt = ψt nt is the sampled number of individuals of type t and ψt is type t’s
sampling rate.
     There are two types of sampled networks.17 The first is the induced subgraph, denoted by
G|s . The induced graph restricts the network links among the m sampled nodes. The second
is the star subgraph, denoted by Gs . The star network samples S but allows for a link of the
m sampled nodes to anyone in V . That is, G|s = (S, E |S ) and Gs = (V, E S ) where E |S is set
of edges between the sampled nodes and E S is set of all edges such that at least one of nodes
is in S.
     We concentrate on several network statistics, and denote a generic network statistic as
w(G). It can represent a scalar, vector, or even the whole adjacency matrix itself (i.e., w(G) =
W (G)). The dimension of w(G) will depend on the application and will be defined in each
context. Let w(G), G ∈ {Gs ,G|s }, be the corresponding network statistic using the sample
network G and w(G) e       the corrected network statistic in question proposed         to mitigate the
                                                                                1
                                                                                  P P
sample biases with respect to the population. For example, w(G) = n i∈V j∈V Wij is the
average degree of a graph, which we denote d(G) below. Hence, d(G) is the average degree of
the sample network and d(G)  e     the proposed correction of the sample average degree to mitigate
biases with respect to the true d(G).
     We assume that the sampling is non-random in the     P following sense. The analyst observes
mt ≤ nt individuals of type t, with mt = ψt nt and t mt = m. If ψt = ψ for all t ∈ T , the
sample is representative. Our framework allows for ψt 6= ψs for any t, s ∈ T , but nests the
random sampling case. We make the following assumption for the heterogeneous sampling
rates:
                                                                                                 mt
Assumption 1. The sampling rates for each type t are asymptotically stable, i.e.                 nt
                                                                                                      = ψt as
nt → ∞, for all t ∈ T .
Note that this assumption is much milder than a network formation model specification as-
sumed in many previous studies.
    In applications, the researcher may observe R different networks with a generic term r ∈
{1, 2, ..., R}. If a measure refers to a specific network, we use a subscript r to specify it.
                                                      |s
That is, Gr is the graph of population r, Gr ∈ {Gsr ,Gr } the corresponding sampled graphs of
network r, and accordingly for the other variables. Therefore, nr,t and mr,t are the number of
nodes of type t in the population network r and their corresponding sampled number. Once
again, ψr = m   r
               nr
                  and ψr,t = m r,t
                             nr,t
                                   .

2.2        Econometric Modeling
In addition to the reconstruction of network properties of interest, we also analyze regres-
sion analysis with non-randomly sampled networks. Our approach is suitable for models
  16
       Most of the analysis extends for directed and weighted graphs.
  17
       Section 6 discusses other sampling schemes and their relation with the proposed methodology.


                                                       6
where – apart from other variables – one or more network-wide characteristics are regressors.
Throughout the analysis, we focus on regressions in which the researchers are interested in
understanding whether and how the global properties of a network (e.g., average degree or
the average distance in the network) influence a particular outcome. Formally,

                                    yr = α + w(Gr )β + xr γ + r ,                                   (1)

where yr is the outcome variable of population or network r, xr is the set of network-level
controls, and w(Gr ) is the true network property (or properties) of interest. The researcher
is interested in estimating the parameters α, β, and γ. (We mostly focus on the estimations
of β.) Examples of applications of (1) in the literature include Alatas et al. (2016) who
regress the ability of villages to aggregate information on a set of network characteristics in
Indonesian villages, Banerjee et al. (2013) who model microfinance take-up rate in rural India,
Currarini et al. (2009, 2010) and Golub and Jackson (2012a,b) who relate homophily with
school-level statistics using Add-Health data, Toomet et al. (2013) who link regional wage
differences between ethnicities with region-level homophily, or the innovation literature that
model the ability of different regions to generate knowledge depending on the structure of
regional research networks (e.g., Fleming et al., 2007). Such regressions are also of interest
theoretically. For example, the overall clustering of a network may explain the magnitude and
efficiency of risk-sharing within a society (Bloch et al., 2008), the stability of behavior in a
society may be related to the minimal eigenvalue of the adjacency matrix (Bramoullé et al.,
2014).
    The proposed approach also applies to models studying whether and how the overall prop-
erties of a network affect outcomes at the individual level: yir = α + w(Gr )β + xir γ + λr + ir ,
with yir is the behavior of an individual i in network r, xir is her heterogeneity (that can
include the heterogeneity of i’s neighborhood), and λr are random effects. For instance, the
decision of an individual to adopt a product (e.g., microfinance as in Banerjee et al., 2013),
participate in an activity (e.g., recreational activity as in Bramoullé et al., 2009), or behave in
a particular way (Centola, 2010) can depend on the overall structure of the network. In the
same vein, the innovation literature studies how the structure of regional networks shapes in-
novative performance of individual innovators (Schilling and Phelps, 2007; Whittington et al.,
2009). There also exist theories arguing that the overall structure of a network may determine
the behavior at the individual level (see e.g., Ballester et al., 2006; Bramoullé and Kranton,
2007; or Bramoullé et al., 2014).
    With sampled data on the network, the researchers observe G ∈ {GS , G|S } which is mis-
measured, rather than G. Therefore, scholars typically estimate

                                    yr = α + w(Gr )β + xr γ + r ,                                   (2)
leading to a measurement error in the regressors. The classic measurement error and the
resulting attenuation bias are based on several assumptions not generally satisfied in the case of
network measures (see e.g., Wooldridge, 2015, or Hyslop and Imbens, 2001).18 Chandrasekhar
and Lewis (2016) show formally and via simulations that the biases are generally not tractable
and can lead to expansion or sign switching even in the simplest cases and under purely random
sampling. The issues become even more problematic if the missing-at-random assumption is
  18
    While there are other challenges typically present in network regressions, such as endogeneity and/or
omitted variable problems, our argument is that sampling presents an issue even in the absence of these
problems.


                                                   7
violated. Moreover, if multiple regressors are included into the model as in (2), the estimates
of independent variables measured without error also become biased when another one is
mismeasured. That is, even if network properties only serve as controls, they may bias the
estimates of the main variables of interest.
    In the following sections, we show how the biases depend on who is missing in the sam-
ple. Section 5 further illustrates that two widely used network data sets come from non-
representative samples of the population under study.


3      Analytic corrections for sample network measures
This section shows formally the biases in some commonly used network characteristics arising
from sampling and proposes how to correct them using post-stratification approaches.19 Since
each network r ∈ {1, .., R} is corrected separately, the main text illustrates our approach for
a generic network r. All the derivations are based on Assumption 1.

3.1     Average Degree
The degree of a node is the number of his/her network connections. The average degree
of population graph Gr is simply   Pthe P  average number of network links per person in the
network, defined as d(Gr ) = n1r i∈Vr j∈Vr Wij,r . The degree is a basic measure of local
node’s importance or centrality. It has been applied as a regressor in numerous empirical
studies and contexts (see, e.g., Kremer and Miguel, 2007; Branas-Garza et al., 2010; Kovárı́k
et al., 2012; Banerjee et al., 2013; Alatas et al., 2016, among many others).
                                                                                                     |s
    For induced subgraphs, the sample average degree is defined as d(G|s ) = m1r i∈Sr j∈Sr Wij,r .
                                                                                    P    P

We can show that20
                                                                                                     
                     T                                            T    T                           
        |s       1 X      X             ψr,t (ψr,t + o(1))    1 XX          X             ψr,t ψr,` 
E(d(Gr )|Gr ) =                 Wij,r                       + nr
                                                                                   Wij,r              .
                 nr t=1  i,j∈V                  ψr                t=1 `6=t
                                                                            
                                                                              i,j∈V
                                                                                               ψ  r
                                                                                                        
                                    r                                                           r
                              ti =tj =t                                                  ti =t,tj =`
                                                                                                   (3) P
The intuition behind the conditional expectation in (3) is theP       following: There are i,j∈Vr Wij,r
edges in the population network of interest, out of which i,j∈Vr :ti =tj =t Wij,r edges link two
                                                           P
individuals of the same type t ∈ {1 · · · , T }, and i,j∈Vr :ti =t,tj =` Wij,r edges connect two indi-
                  P types, t 6= `. Given the sampling rate of each type, we only observe, for
viduals of different
          ψ ψ
example, r,tψr r,` i,j∈Vr :ti =t,tj =` Wij,r of the cross-type edges in expectation. As long as ψr < 1
                                                          |s
for some r, the conditional expectation of d(Gr |Gr ) is not equal to the true d(Gr ) and bias
emerges even if the sample is representative due to scaling. Moreover, as ψr,t and ψr,` are not
  19
     In the standard case, for each type t, there are nt individuals in the population of a total of n individuals
and mt observations in the sample of size m. The poststratification weight assigned to a sampled individual i
depends on which categories she belongs to. Formally, pti = mntt /n
                                                                 /m . Whenever the sampled ratio in category t is
smaller (larger) than that in the population, the weight is larger (smaller) than one. In other words, it raises (or
decreases) the weights for types of individuals who are underrepresented (or overrepresented) compared to the
population. Below, we introduce a similar approach but applied to different types of relationships (or subgraphs
in the terminology of Chandrasekhar and Jackson, 2016).
  20
     The details of derivation are relegated into Appendix A.1.



                                                         8
necessarily the same as ψr , we have the second source of bias, non-representativeness, and the
issue becomes more complicated.
    To correct the biases from both scaling and non-representativeness, we follow the principle
of Horvitz-Thompson (Horvitz and Thompson, 1952) to propose the weighted sample average
degree:
                                                                                         
                 T                  2 −1          T    T                              −1
                                    ψr,t
                                                                            
      |s     1 X      X       |s
                                                1 XX          X       |s    ψr,t ψr,`     
   d(Gr ) =
   e                        Wij,r
                                            +                      W ij,r
                                                                                             . (4)
            mr t=1  i,j∈S          ψr      mr
                                                   t=1 `6=t
                                                            
                                                               i,j∈S
                                                                                ψ  r
                                                                                            
                            r                                              r
                      ti =tj =t                                     ti =t,tj =`

                                                                                                   −1
                                                                                              ψ ψ
Based on (3), we multiply each observed cross-type link by a post-stratification weight r,tψr r,`       .
                                                          −1
                         P                  |s   ψ ψ
Note that the product i,j∈Sr :ti =t,tj =` Wij,r r,tψr r,`      accounts for two effects: the possible
missing rates of these links in the sample and the number of such links in the observed part
of the network. That is, the corrections respect the observed      correlations in who is connected
                                                          ψ2
                                                              −1
to whom. Similarly, we propose to multiply by ψr,t      r
                                                                all edges between two individuals of
the same type t. Note the presence of the “error” terms o(1) in (3). The proposed corrected
e |s
d(G r ) is only unbiased if a network grows large; otherwise it is subject to an error due to the
randomness in the sampling. Since samples are finite in applications, Section 4 complements
this section with numerical analysis using standard population and sample sizes.
    For star networks, the sample average degree is defined as d(Gsr ) = m1r i,j∈Sr Wij,r    s
                                                                                   P
                                                                                               . In
Appendix A.1 we show that
                                                                         
                     T                  2
                                        ψr,t + 2ψr,t (1 − ψr,t ) + o(1) 
                                                                        
       s          1 X      X
E(d(Gr )|Gr ) =                 Wij,r                                    
                 nr t=1  i,j∈V                        ψr                 
                                    r
                           ti =tj =t
                                                                                                    
                       T    T                                                                       
                   1 XX          X            ψr,t ψr,` + ψr,` (1 − ψr,t ) + ψr,t (1 − ψr,` ) + o(1) 
                 +                    Wij,r                                                           .
                   nr t=1 `6=t  i,j∈V                                   ψr                            
                                               r
                                        ti =t,tj =`
                                                                                                    (5)

Again, as long as ψr 6= 1 and the sampling rate across types are not the same, i.e., ψr,t 6= ψr,` ,
the conditional expectation of d(Gsr ) in (5) does not equal to d(Gr ). To correct the bias, our
proposed weighted sample average degree takes the following form:
                                                                    
                 T                                             ! −1
                                        2
       s     1 X       X
                                s
                                      ψr,t + 2ψr,t (1 − ψr,t )       
    d(Gr ) =
    e                       W ij,r
                                                                     
             mr t=1  i,j∈S                    ψr                    
                                r
                        ti =tj =t
                                                                                           
                T    T                                                                   −1
            1 XX          X
                                  s     (ψr,t ψr,` + ψr,` (1 − ψr,t ) + ψr,t (1 − ψr,` ))     
          +                    Wij,r                                                         .    (6)
            mr t=1 `6=t 
                          i,j∈S
                                                              ψ r
                                                                                              
                                        r
                              ti =t,tj =`




                                                      9
    Note that if ψr,t = ψr,` = ψr (that is, under random sampling), expression (3) collapses to
      |s
E[d(Gr )|Gr ] = (ψr +o(1))d(Gr ) and expression (5) to E[d(Gsr )|Gr ] = [1 − (1 − ψr )2 + o(1)] d(Gr ),
which would be exactly the same as shown by Chandrasekhar and Lewis (2016). The key dif-
ference between the correction approach proposed in Chandrasekhar and Lewis (2016) and
the weighted sample average degrees in (4) or (6) is that the corrections based on the missing-
at-random assumption are only a rescaling of the corresponding sample average degree, while
matters become more complex if sampling differs across groups and the network is homophilous
or heterophilous. In such a case, one has to rescale on links and different links have to be
weighted differently to yield an asymptotically unbiased correction. If one applies the random
corrections to non-representative data, biases emerge and there is no reason for these biases
to be smaller than in the raw (uncorrected) data.

3.2     Degree distribution
Average degree is the first moment of the degree distribution of a graph. Nevertheless, other
higher order moments and, in fact, the whole degree distribution are fundamental descriptors of
a network structure with important consequences (Vega-Redondo, 2007; Jackson and Rogers,
2007; Jackson, 2010b). Both the first and the second moments of the degree distribution as
well as the tails of the distribution are key for the understanding of diffusion properties of
a graph (see e.g., Acemoglu et al. (2012) for an application in Economics; see Sections 3.4
and 3.5 for further discussion of diffusion properties of a network), the degree distribution
also affects behavior in network games, as in Jackson and Yariv (2007); Galeotti et al. (2010).
Moreover, different moments may serve for the computation of bounds on spectral properties
of a graph as illustrated in Section 3.5.
     In this section, we show how one can estimate the whole degree distribution from non-
randomly sampled network data. To that aim, we generalize the approaches of Frank (1980,
1981) and Zhang et al. (2015). In the main text, we focus on adapting the estimators from
Frank (1980, 1981). 21
     Since we observe the sizes of the (sub)population(s), our strategy targets the degree counts
(rather then percentages). Let Ndt` (Gr ) denote the number of nodes of type t in Gr who have
                                                            t
d connections to nodes of type `. Analogously,   P Ndt(Gr ) is the number of nodes of type t who
have degree d. Consequently, Nd (Gr ) = t∈T Nd (Gr ) is the number of nodes with degree
d. N t` (Gr ), N t (Gr ), and N (Gr ) are the corresponding vectors of the numbers of nodes with
different degrees in the network in function of the types. Last, υ t` (Gr ), υ t (Gr ), and υ(Gr )
stand for the largest number of links between two individuals of types t and `, the maximal
degree of type-t nodes, and the maximal degree in network Gr , respectively. Hence, the vectors
N t` (Gr ), N t (Gr ), and N (Gr ) are of sizes υ t` (Gr ), υ t (Gr ), and υ(Gr ).
     Under the induced subgraph sampling, the probability that a node of type t with d links
to individuals of type ` in the population network Gr is selected and observed to have d0 ≤ d
  21
   Since Zhang et al. (2015)’s strategy is to apply a complex constrained, penalized weighted least-squares
approach to the estimator proposed by Frank (1980, 1981), we discuss the strategy of Zhang et al. (2015) in
Appendix A.2.




                                                    10
                                |s
links to type-` nodes in Gr is approximately22,23
                             
              |s             d                0              0
                    0
            Pr,t` (d , d) =    0
                                 ψr,t (ψr,` )d (1 − ψr,` )d−d               for 0 ≤ d0 ≤ d ≤ υ t` (Gr ).
                             d
                |s                                              |s
Naturally, Pr,t` (d0 , d) = 0 for d0 > d. Let Pr,t` denote the υ t` (Gr ) × υ t` (Gr ) matrix of all
such probabilities for any d, d0 ≤ υ t` (Gr ). Note that there are T 2 such matrices, one for each
(t, `) pair (including pairs of the same type). The conditional expectation for the number of
                                                         |s
sampled nodes of type t have degree d to type ` in Gr is:
                                              υ t` (Gr )    
                                               X           j
                      E[Ndt` (G|s
                               r )|Gr ]   =                   ψr,t (ψr,` )d (1 − ψr,` )j−d Njt` (Gr ).
                                                j=d
                                                           d

                 |s                                   |s
                                   E[Ndt` (Gr )|Gr ]. The naive estimators for N t` (Gr ) and N (Gr )
                              PP
Also, E[Nd (Gr )|Gr ] =
                           t∈T `∈T
         e t` (G|s
then are N         ) = (P
                          |s −1 t`    |s        e |s      P P e t` |s 24
                r         r,t` ) N (Gr ) and N (Gr ) =          N (Gr ).
                                                                       t∈T `∈T
     The matter is simpler under the star subgraph sampling because the true degree of each
sampled node is observed without error. Hence, the probability that a type-t node has degree
d in the true population network Gr have degree d0 in Gsr corresponds to the probability that
she is sampled. That is, Pr,t    s
                                   (d0 , d) = ψr,t if d = d0 and Pr,t
                                                                   s
                                                                      (d0 , d) = 0 otherwise. Consequently,
Pr,t = ψr,t 1υt (Gr ) , is a υ (Gr ) × υ (Gr ) diagonal matrix with the type-specific sampling rate
  s                            t           t

ψr,t on the main diagonal that summarizes all these probabilities. In this case,          P we    only need
T such Pr,t matrices, one for each type. As a result, E[Nd (Gr )|Gr ] = E[ t Nd (Gsr )|Gr ] =
              s                                                                s                t

            t                                       t                            et s         −1 t   s
P
   t ψr,t Nd (Gr ) and the estimators of Nd (Gr ) and Nd (Gr ) are Nd (Gr ) = ψr,t Nd (Gr ) and
 ed (Gs ) =       et s                                    e s                s −1 t   s
               P                                                   P
N      r        t Nd (Gr ). In matrix terminology, N (Gr ) =           t (Pr,t ) N (Gr ).
     Observe that, if ψr,t = ψr,` = ψr for each t, ` ∈ T , E[N (Gr )|Gr ] = P r N (Gr ) where
           |s                       |s
Gr ∈ {Gr , Gsr } and P r ∈ {Pr , Prs } and the naive estimators for N (Gr ) collapse to N          e (Gr ) =
  −1
P r N (Gr ), the estimator proposed by Frank (1980, 1981).
     The proposed corrections notwithstanding, Zhang et al. (2015) show that the estimators
of Frank (1980, 1981) are ill-posed in two respects. The operators P r ’s are not necessarily
invertible in general and even if they are the elements of N             e (Gr ) may be non-negative. The
                            |s         s
particular matrices Pr,t` and Pr,t are invertible because the former is upper triangular and the
latter is diagonal. However, they can still generate negative estimates of the number of nodes
of certain degree. In fact, our simulations corroborate this concern for induced subgraphs.
To overcome these issues, Zhang et al. (2015) propose a constrained, penalized weighted least
squares estimator which avoids the inversion of P r ’s and for which the estimator N̂ (Ḡr ) ≥ 0
by construction. Appendix A.2 outlines how their procedure adapts to data coming from
                                                         |s       s
non-representative samples. The operators Pr,t` and Pr,t              developed above play a key role in
the recovery process.
  22
     See Appendix A.2 for the derivation.
  23
     For example, the probability that a sampled node of type t with two friends of type ` in Gr has degree 1
     |s                                       |s                     |s
in Gr (that is, the element (1,2) of matrix Pr,t` defined below) is Pr,t` (1, 2) = 21 ψr,t (ψr,` ) (1 − ψr,` ). This
                                                                                     

probability takes into account that the node in question is sampled and has two neighbors of type ` and that
one of these neighbors is sampled while the other is not.
  24
     Zhang et al. (2015) show that the estimator of Frank (1980, 1981) is ill-posed. They thus label this
estimator as naive. We follow this terminology.


                                                               11
    One may wonder why we still propose the correction for the average degree in Section 3.1
if one can compute it from the corrected degree counts in this section. First, since a researcher
has to estimate the degree counts separately for different types or even type pairs, estimating
the degree distribution may be computationally costly with a large number of types. Such a
concern is particularly relevant for the estimation strategy proposed by Zhang et al. (2015),
described in Appendix A.2. Second, the estimators differ in their accuracy. Estimating the
average degree improves with the size of the sample while the estimates of counts depend on
the sampling rate (e.g., Zhang et al., 2015). Hence, we still propose corrections for the average
degree (Section 3.1) and the average degree squared (as part of the epidemic threshold in
Section 3.4).

3.3         Clustering Coefficient
The clustering coefficient of a node i measures the fraction of the pairs of i’s network neighbors
who are neighbors themselves. The total clustering of a graph is the ratio between the number
of triangles and the number of connected triples in the network,25 calculated as c(Gr ) = τρ(G  r)
                                                                                              (Gr )
                                                                                                    ,
where
                    XX X                                          XX X
         ρ(Gr ) = 3              Wij,r Wjk,r Wki,r and τ (Gr ) =                Wij,r Wjk,r .
                          i∈Vr k>i j6=i,k                                i∈Vr k>i j6=i,k


    The clustering coefficient has traditionally been considered a measure of one’s social capital.
For example, it plays an important role in risk-sharing (Bloch et al., 2008), trust building (Kar-
lan et al., 2009), and enhancing cooperation (Granovetter, 1985). Several additional empirical
papers have used the clustering as a regressor or the dependent variable (e.g., Fleming et al.,
2007; Kovářı́k and Van der Leij, 2014; Alatas et al., 2016; Kovářı́k et al., 2017).
    For induced subgraphs, the sample number      P of P triangles
                                                              P and the     sample number of con-
                                           |s                           |s   |s    |s          |s
nected triples are computed by ρ(Gr ) = 3 i∈Sr k>i j6=i,k Wij,r Wjk,r Wki,r and τ (Gr ) =
P       P P               |s   |s
   i∈Sr   k>i    j6=i,k Wij,r Wjk,r . In Appendix A.3 we show that the sample clustering coefficient
                 |s
       |s    ρ(Gr )
c(Gr ) =         |s    is biased. Thus, we propose the following weighted estimator for the number
             τ (Gr )

  25
    A triangle refers to a complete subnetwork of three individuals, while a triple is a three-node subnetwork,
in which at least two edges are present. Hence, every triangle is also a triple but the converse is not true.




                                                      12
of triangles,

                ρ(G|s
                e  r) =
                                                     
                   T
                       X X X |s    |s    |s    3 −1 
                  X                                 
                +     3     Wij,r Wjk,r Wki,r ψr,t   
                    t=1        i∈Sr k>i j6=i,k
                                 ti =tj =tk =t
                                                                          
                    T X
                      T
                    X    X X X |s      |s    |s    2
                                                            −1 
                +       3
                              W ij,r Wjk,r Wki,r ψr,t ψr,`
                                                                
                                                                
                    t=1 `6=t          i∈Sr k>i j6=i,k
                                       ti =tj =t,tk =`
                                                                          
                  T X
                    T
                  X    X X X |s      |s   |s    2
                                                         −1 
                +     3
                            W ij,r W    W
                                     jk,r ki,r ψr,t ψr,`
                                                             
                                                             
                    t=1 `6=t          i∈Sr k>i j6=i,k
                                       tj =tk =t,ti =`
                                                                          
                  T X
                    T
                  X    X X X |s     |s   |s    2
                                                        −1 
                +     3
                            W     W    W
                               ij,r jk,r ki,r ψr,t ψr,`
                                                            
                                                            
                    t=1 `6=t          i∈Sr k>i j6=i,k
                                       ti =tk =t,tj =`
                                                                                  
                    T X T
                      T X
                    X      X X X |s     |s     |s                      −1 
                                                                           
                +         3
                                Wij,r W jk,r W ki,r (ψ r,t ψr,` ψ r,h )   ,          (7)
                    t=1 `6=t h6=t,`           i∈Sr k>i j6=i,k
                                              ti =t,tj =`,tk =h


and analogously, the weighted estimator for the number of connected triples,
                                                                
                             T
                                                           3 −1 
                             X X X X |s             |s
                  τ (G|s
                                                               
                  e   r  ) =                W     W
                                               ij,r jk,r ψ r,t   
                                     t=1      i∈Sr k>i j6=i,k
                                                ti =tj =tk =t
                                                                      
                      T X
                        T
                      X   X X X |s     |s    2
                                                        −1 
                    +     
                               W     W
                                  ij,r jk,r ψ r,t ψ r,`
                                                            
                                                            
                          t=1 `6=t         i∈Sr k>i j6=i,k
                                            ti =tj =t,tk =`
                                                                      
                      T X
                        T
                      X   X X X |s    |s    2
                                                     −1 
                    +     
                               Wij,r Wjk,r ψr,t ψr,`   
                          t=1 `6=t         i∈Sr k>i j6=i,k
                                            tj =tk =t,ti =`
                                                                      
                      T X
                        T
                      X   X X X |s     |s     2
                                                         −1 
                    +     
                               Wij,r W jk,r ψ r,t ψ r,`
                                                             
                                                             
                          t=1 `6=t         i∈Sr k>i j6=i,k
                                            ti =tk =t,tj =`
                                                                              
                      T X
                        T X
                          T
                      X     X X X |s    |s                    −1 
                                                                  
                    +       
                                 W    W
                                   ij,r jk,r (ψr,t ψr,` ψr,h )    .                   (8)
                          t=1 `6=t h6=t,`         i∈Sr k>i j6=i,k
                                                  ti =t,tj =`,tk =h



                                                                  13
                                                            −3
Based on (7) and (8), we propose to multiply by ψr,t            all triangles and triples composed of
three individuals of the same type t, by (ψr,t     2
                                                     ψr,` )−1 those with two individuals of type t
and one of type ` 6= t, and finally by (ψr,t ψr,` ψr,h )−1 the triangles and triples containing three
individuals of three different types. The proposed weighted sample clustering coefficient is thus
    |s        |s      |s
c(Gr ) = e
e          ρ(Gr )/e
                  τ (Gr ). Since the clustering coefficient is measured using triples and triangles,
the corrections differ from average degree in that, instead of pairs, we correct “relationships”
of three individuals depending on how they are interconnected (triple or triangle) and their
type composition.
    The matters are somewhat more complex for the star subgraph. We propose the following
weighted estimator for the number of triangles for the star subgraph:
                                                                             
            T
           X XX X                                                        −1 
ρ̃(Gsr ) =    3
                                  s
                               Wij,r   s
                                     Wjk,r  s
                                           Wki,r   3
                                                 ψr,t       2
                                                      + 3ψr,t  (1 − ψr,t ) 
          t=1        i∈Sr k>i j6=i,k
                       ti =tj =tk =t
                                                                                              
  T X
    T
  X    XX X s       s     s     2                                    2
                                                                                      −1 
+     3
           W ij,r Wjk,r Wki,r ψr,t ψr,` + 2(1 − ψr,t )ψ r,t ψr,` + ψ r,t (1 − ψr,` )     
                                                                                          
   t=1 `6=t       i∈Sr k>i j6=i,k
                   ti =tj =t,tk =`
                                                                                              
  T X
    T
  X    XX X s      s    s     2                                    2
                                                                                   −1 
+     3
           W     W    W
              ij,r jk,r ki,r ψr,t ψr,` + 2(1 − ψr,t )ψ r,t ψr,` + ψr,t (1 − ψr,` )     
                                                                                       
   t=1 `6=t       i∈Sr k>i j6=i,k
                   tj =tk =t,ti =`
                                                                                              
  T X
    T
  X    XX X s     s     s     2                                   2
                                                                                  −1 
+     3
           Wij,r Wjk,r Wki,r ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` )   
   t=1 `6=t       i∈Sr k>i j6=i,k
                   ti =tk =t,tj =`
                     
  T X
  X T X
      T                        
         XX X s     s     s
+       3
             Wij,r Wjk,r Wki,r ψr,t ψr,` ψr,h + (1 − ψr,t )ψr,` ψr,h + ψr,t (1 − ψr,` )ψr,h
   t=1 `6=t h6=t,`       i∈Sr k>i j6=i,k
                         ti =t,tj =`,tk =h
                                                                              !
                                                                          −1
                                                   + ψr,t ψr,` (1 − ψr,h )     .                   (9)




                                                 14
     The weighted estimator for the number of connected triples has the following form:
                                                                                     
            T
            X X X X                                                              −1 
τ̃ (Gsr ) =   
                             s
                          Wij,r   s
                                Wjk,r  3
                                      ψr,t     2
                                           + 3ψr,t (1 − ψr,t ) + ψr,t (1 − ψr,t )2 
           t=1       i∈Sr k>i j6=i,k
                       ti =tj =tk =t
                                                                                             
  T X
    T
  X   X X X s      s      2                                      2
                                                                                −1 
+     
           Wij,r W jk,r ψ r,t ψr,` + 2(1 − ψ r,t )ψr,t ψ r,` + ψr,t (1 − ψr,` )    
                                                                                    
   t=1 `6=t       i∈Sr k>i j6=i,k
                   ti =tj =t,tk =`
                                                                                             
  T X
    T
  X   X X X s     s     2                                      2
                                                                              −1 
+     
           W    W
             ij,r jk,r ψ r,t ψr,` + 2(1 − ψ r,t )ψr,t ψ r,` + ψr,t (1 − ψr,` )    
                                                                                  
   t=1 `6=t       i∈Sr k>i j6=i,k
                   tj =tk =t,ti =`
                                                                                                                 
  T X
    T
  X   X X X s     s     2                                   2
                                                                                                −1 
+     
           Wij,r Wjk,r ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` ) + (1 − ψr,t )2 ψr,`   
   t=1 `6=t       i∈Sr k>i j6=i,k
                   ti =tk =t,tj =`
                     
  T X
  X T X
      T                  
        X X X s     s
+       
             Wij,r Wjk,r ψr,t ψr,` ψr,h + (1 − ψr,t )ψr,` ψr,h + ψr,t (1 − ψr,` )ψr,h
   t=1 `6=t h6=t,`       i∈Sr k>i j6=i,k
                         ti =t,tj =`,tk =h
                                                                                                      !
                                                                                                  −1
                                             + ψr,t ψr,` (1 − ψr,h ) + (1 − ψr,t )ψr,` (1 − ψr,h )     .

                                                                                                           (10)

Similar to the case of induced subgraph, we multiply different weights shown in (9) and (10)
to the edges in which all triangles and triples composed of three individuals of the type t,
two individuals of type t and one of type ` 6= t, and the triangles and triples containing three
individuals of three different types. The final weighted sample clustering coefficient is thus
c(Gsr ) = e
e         ρ(Gsr )/e
                  τ (Gsr ).

3.4     Epidemic Threshold
There is increasing interest in understanding the diffusion properties of networks. The ap-
plications range from diffusion of innovation (e.g., Valente, 1996; Cowan and Jonard, 2004),
product adoption (Banerjee et al., 2013; Hu et al., 2014), spread of information (Alatas et al.,
2016) to spread of behaviors (Centola, 2010; Jackson and Yariv, 2007). The epidemic threshold
is one way to quantify how easy it is for a disease, information, idea, or behavior to propagate
through a network. Traditionally, the lower the threshold the easier the propagation. There
are a large variety of epidemic thresholds, depending on the diffusion conditions and network
properties (see e.g., Vega-Redondo, 2007, or Jackson, 2010b). We focus on the following simple
version which is widely used, based on mean-field approximations:
                                            1
                                              P       P
                                                 i∈Vr       Wij,r
                              T hrldr = 1 Pnr
                                                     P j∈Vr        2
                                                                     .
                                          nr   i∈Vr (  j∈Vr Wij,r )


                                                    15
The threshold is simply the ratio between the average degree, d(Gr ), and the average squared
degree, denoted by ds(Gr ). The corrections of d(Gr ) are treated above (see also Appendix A.1).
In Appendix A.4, we show that
                                                       1 XXX
                            ds(Gr ) = d(Gr ) +                         Wij,r Wik,r .                                 (11)
                                                       nr i∈V j∈V k6=j
                                                                 r       r


As a consequence, we only focus on the second term in (11). For the case of induced subgraph,
                                                     |s
we propose the following weighted estimator for ds(Gr ),
                                                                            
                                        T                            3 −1
                    |s       |s     1 X    X X X |s            |s   ψr,t    
               ds(Gr ) = d(Gr ) +
                e        e                             Wij,r Wik,r          
                                   mr t=1 i∈S j∈S k6=j
                                                                    ψr      
                                                             r       r
                                                           ti =tj =tk =t
                                                                                              
                        T    T                                                2          −1
                                                                             ψr,t ψr,`
                                                                         
                    1 XX        X X X |s            |s
                                                                                               
                  +                         Wij,r Wik,r                                       
                    mr t=1 `6=t i∈S j∈S k6=j
                                                                              ψr              
                                        r      r
                                     ti =tj =t,tk =`
                                                                                              
                        T    T                           2        −1
                    1 XX         X X X |s          |s   ψr,t ψr,`     
                  +                         W    W                    
                    mr t=1 `6=t i∈S j∈S k6=j ij,r ik,r    ψr          
                                        r      r
                                     tj =tk =t,ti =`
                                                                                              
                          T    T                                              2          −1
                                                                             ψr,t ψr,`
                                                                         
                      1 XX         X X X |s          |s
                                                                                               
                  +                           W W                                             
                      mr t=1 `6=t i∈S j∈S k6=j ij,r ik,r                      ψr              
                                        r      r
                                     ti =tk =t,tj =`
                                                                                                          
                        T    T    T                                                                 −1
                    1 XX X             X X X |s            |s                      ψr,t ψr,` ψr,h         
                  +                                Wij,r Wik,r                                            .        (12)
                    mr t=1 `6=t h6=t,` i∈S j∈S k6=j
                                                                                        ψr                
                                                r      r
                                            ti =t,tj =`,tk =h

                                  3 −1
                                    ψ
That is, we propose to multiply ψr,t  r
                                           to the triple (i, j, k) in which three individuals are of
                          2        −1
                           ψ ψ
the same type t; multiply r,tψr r,`     to the triple (i, j, k) in which two individuals are of the
                                                                    −1
                                                      ψr,t ψr,` ψr,h
same type t and the other is of type `; multiply            ψt
                                                                         to the triple (i, j, k) in which
                                                                                                                |s
three individuals are of different types, t, `, and h, to correct the second term of ds(Gr ). The
                                                           ˜ |s
first term follows the correction of average degree, i.e. d(G  r ). The proposed weighted sample
                              ^|s e |s            e |s
epidemic threshold is thus T hrldr = d(Gr )/(ds(G     r ).




                                                           16
   For star subgraphs, we consider the following weighted estimator for ds(Gsr ),
                                                                                                    
                       T                            3       2                                   −1
    s         s    1 X    XXX                      ψr,t + 3ψr,t (1 − ψr,t ) + ψr,t (1 − ψr,t )2     
ds(Gr ) = d(Gr ) +
e         e                           Wij,r Wjk,r                                                   
                   mr t=1 i∈S j∈S k6=j
                                                                      ψr                            
                                             r     r
                                           ti =tj =tk =t
                                                                                                                           
        T    T                                                  2                                   2                 −1
                                                               ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` )
                                                           
    1 XX         XXX                                                                                                       
+                            Wij,r Wjk,r                                                                                   
    mr t=1 `6=t i∈S j∈S k6=j                                                          ψr                                   
                        r      r
                     ti =tj =t,tk =`
                                                                                                                           
      T    T                              2                                   2               −1
  1 XX         XXX                       ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` )     
+                          W ij,r Wjk,r
                                                                                                   
  mr t=1 `6=t i∈S j∈S k6=j                                       ψr                               
                        r      r
                     ti =tk =t,tj =`
                                                                                                                                      
      T    T                            2                                   2                                   −1
  1 XX        XXX                      ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` ) + (1 − ψr,t )2 ψr,`     
+                         Wij,r Wjk,r                                                                               
  mr t=1 `6=t i∈S j∈S k6=j
                                                                         ψr                                         
                        r      r
                     tj =tk =t,ti =`
                       
        T    T    T
    1 XX X              XXX                     
                                                     −1
                                                        
+                                   W     W
                                       ij,r jk,r   ψr     ψr,t ψr,` ψr,h + (1 − ψr,t )ψr,` ψr,h + ψr,t (1 − ψr,` )ψr,h
    mr t=1 `6=t h6=t,` i∈S j∈S k6=j
                                r      r
                            ti =t,tj =`,tk =h
                                                                                                                         −1 
                                                                     +ψr,t ψr,` (1 − ψr,h ) + ψr,t (1 − ψr,` )(1 − ψr,h )       .
                                                                                                                                (13)
To correct the second term of ds(Gsr ), we multiply different weights shown in (13) to the edges
in which all triples composed of three individuals of the type t, two individuals of type t and
one of type ` 6= t, and the triples containing three individuals of three different types. The
final weighted sample epidemic threshold is T^  hrldsr = d(G     e s ). All the derivations can
                                                          e s )/ds(G
                                                             r       r
be found in Appendix A.4.

3.5      Largest eigenvalue of a network
Spectral properties of the adjacency matrix provide rich information about many topological
properties of a network, including features of the degree distribution, component and com-
munity structure, and network distances, to name a few examples (see e.g., Faloutsos et al.,
1999; Van Mieghem, 2010). They are particularly useful for modelling dynamic phenomena
that take place on networks. For instance, the epidemic threshold from Section 3.4 is a good
measure of how a network diffuses viruses, diseases, or behaviors if there are no degree cor-
relations. If a network exhibits such correlations (and real-life networks typically do), the
epidemic threshold is equal to the inverse of the largest eigenvalue of the adjacency matrix,
λ1 (Gr ) (e.g., Boguñá et al., 2003). The largest eigenvalue also plays a role in network games
(e.g., Ballester et al., 2006), public good provision (Elliott and Golub, 2019), or propagation of
shocks in interbank or financial networks (Bardoscia et al., 2017). The remaining eigenvalues
have also shown to matter for dynamics, speed, and stability of learning and behavior (Golub
and Jackson, 2010, 2012b; Bramoullé et al., 2014).

                                                                     17
    Since spectral properties depend on the whole network architecture, our approach that re-
lies on nodes’ local information cannot recover their exact values. Indeed, no existing approach
can without assumptions on the whole network. Nevertheless, to illustrate another application
of our approach, we propose corrections for the bounds on λ1p    (Gr ) from a sampled network.26
Lovász (2007) and Van Mieghem (2010) show that d(Gr ) ≤ ds(Gr ) ≤ λ1 (Gr ) ≤ Ur , where
Ur = (2|Er |(nr − 1)/nr )1/2 . That is, the largest eigenvalue is bounded below by the average
degree and the square root of the average squared degree and bounded above by an expression
that depends on the number of nodes and edges in the graph. Notice that, even though we
cannot recover the eigenvalue precisely, the true values of the bounds can be estimated using
our approach.
    We only focus on λ1 (Gr ) here, but large literature across disciplines has also proposed
bounds for other eigenvalues (e.g., Das and Kumar, 2004; Walker, 2011) or the average be-
tweenness centrality of a graph (Comellas and Gago, 2007). Hence, one could potentially
employ poststratification weighting to propose population-level bounds for other features of
the network that cannot be recovered exactly on basis of local information only. Such a
strategy enlarges the applicability of the methodology proposed in this study.

3.6       Graph span
Another important network measure is the distance between nodes. The path length between
i and j is the minimum number of edges between them. The average path length is simply the
average path length over all finite paths. Naturally, the shorter the distance between nodes
the easier for them is to communicate, transmit information, or influence each other. Shorter
average distances consequently allow for easier transmission throughout the whole population.
Therefore, distances play important role in diffusion (similarly to the epidemic threshold
and spectral properties), but also in risk-sharing or flow of capital among others. Several
recent papers have analyzed distances in several applications. Examples include Kinnan and
Townsend (2012), Leider et al. (2009), Goeree et al. (2010), Banerjee et al. (2013), and Alatas
et al. (2016).
    Despite their intuition and use in many applications, path lengths are complex objects and
their analytical forms are only available for specific network architectures. We focus on graph
span, a measure than approximates the average path length in many networks (Watts and
Strogatz, 1998; Jackson, 2008). Graph span is defined as

                                                 log n − log d(Gr )
                                   `(Gr ) =                             + 1,
                                              log d2 (Gr ) − log d(Gr )

where d2 (Gr ) = n1 ni=1 j>i k6=i,j Wij,r Wjk,r is the average number of second-order neigh-
                   P P P
bors (that is, nodes at distance two or simply neighbors of neighbors).
 26
      This approach was inspired by Zhang et al. (2015).




                                                      18
                                                                                                             |s
    For the case of induced subgraph, we propose the following weighted estimator for d2 (Gr )
                                                                        
                               T                                 3    −1
                                                                ψr,t
                                                                    
                ˜     |s   1 X     X X X |s              |s
                                                                         
                d2 (Gr ) =                       Wij,r Wjk,r
                                                                         
                           mr t=1 i∈S j>i k6=i,j               ψr       
                                                r
                                              ti =tj =tk =t
                                                                                        
                         T    T                             2        −1
                     1 XX         X X X |s            |s   ψr,t ψr,`     
                   +                           W    W                    
                     mr t=1 `6=t i∈S j>i k6=i,j ij,r jk,r    ψr          
                                          r
                                       ti =tj =t,tk =`
                                                                                        
                         T    T                              2        −1
                     1 XX        X X X |s             |s    ψr,t ψr,`     
                   +                           Wij,r Wjk,r                
                     mr t=1 `6=t i∈S j>i k6=i,j
                                                              ψr          
                                          r
                                       tj =tk =t,ti =`
                                                                                        
                         T    T                                         2          −1
                                                                       ψr,t ψr,`
                                                                   
                     1 XX        X X X |s             |s
                                                                                         
                   +                           Wij,r Wjk,r                              
                     mr t=1 `6=t i∈S j>i k6=i,j
                                                                        ψr              
                                          r
                                       ti =tk =t,tj =`
                                                                                            
                         T    T    T                                              −1
                     1 XX X              X X X |s            |s    ψr,t ψr,` ψr,h     
                   +                                  W    W                          .                  (14)
                     mr t=1 `6=t h6=t,` i∈S j>i k6=i,j ij,r jk,r        ψr            
                                                    r
                                              ti =t,tj =`,tk =h


                                       ψ3
                                            −1     
    Hence, we propose to multiply ψr,t    r
                                                to the triple (i, j, k) in which three individuals are
                              2         −1
                               ψr,t ψr,`
of the same type t; multiply     ψr
                                              to the triple (i, j, k) in which two individuals are of
                                                                                 −1
                                                                   ψr,t ψr,` ψr,h
the same type t and the other is of type `; multiply                     ψt
                                                                                      to the triple (i, j, k) in
                                                                                           |s
which three individuals are of different types, t, `, and h, to correct d2 (Gr ). The proposed
                                                         −1           ˜ r)|s
weighted sample graph span is thus `(G   ˜ |s
                                            r) =
                                                  log(ψr mr )−log d(G
                                                             |s               + 1.
                                                                     ˜ |s
                                                   log d˜2 (Gr )−log d(G r )




                                                              19
    For star subgraph, we propose the following weighted estimator for d2 (Gsr ),
                                                                                             
               T                             3       2                                   −1
           1 X     XX X                     ψr,t + 3ψr,t (1 − ψr,t ) + ψr,t (1 − ψr,t )2
˜    s                             s    s
                                                                                              
d2 (Gr ) =                      W    W                                                       
           mr t=1 i∈S j>i k6=i,j ij,r jk,r                     ψr                            
                              r
                            ti =tj =tk =t
                                                                                                                
      T    T                              2                                   2               −1
  1 XX        XX X
                               s    s
                                          ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` )     
+                           Wij,r Wjk,r                                                           
  mr t=1 `6=t i∈S j>i k6=i,j
                                                                 ψr                               
                        r
                     ti =tj =t,tk =`
                                                                                                                
      T    T                                         2                                   2                 −1
                                                    ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` )
                                                
  1 XX        XX X
                               s    s
                                                                                                                 
+                           Wij,r Wjk,r                                                                         
  mr t=1 `6=t i∈S j>i k6=i,j
                                                                           ψr                                   
                        r
                     tj =tk =t,ti =`
                                                                                                                           
      T    T                             2                                   2                                   −1
  1 XX         XX X
                               s    s
                                         ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` ) + (1 − ψr,t )2 ψr,`     
+                           W    W                                                                                   
  mr t=1 `6=t i∈S j>i k6=i,j ij,r jk,r                                    ψr                                         
                        r
                     ti =tk =t,tj =`
                       
        T    T    T
    1 XX X              XX X                   
+                                    W s
                                           W s
                                                 ψ −1 ψr,t ψr,` ψr,h + (1 − ψr,t )ψr,` ψr,h + ψr,t (1 − ψr,` )ψr,h
    mr t=1 `6=t h6=t,` i∈S j>i k6=i,j ij,r jk,r r
                                  r
                            ti =t,tj =`,tk =h
                                                                                                          !
                                                                                                     −1
                                                + ψr,t ψr,` (1 − ψr,h ) + (1 − ψr,t )ψr,` (1 − ψr,h )      .

                                                                                                                     (15)
Similar to the case of induced subgraph, we multiply different weights shown in (15) to the
edges in which all triangles and triples composed of three individuals of the type t, two
individuals of type t and one of type ` 6= t, and the triangles and triples containing three
                                                                                    ˜ s) =
individuals of three different types. The final weighted sample graph span is thus `(G  r
       −1          ˜  s
log(ψr mr )−log d(Gr )
 log d˜ (Gs )−log d(G
                  ˜ s)  + 1. See Appendix A.5 for details.
      2   r      r



3.7       Homophily index
Many social and economic networks exhibit a feature called homophily, a tendency to bond
with similar individuals. In social and professional networks, who links with whom is typically
correlated with characteristics such as gender, age, race, social and economic status, among
others (see McPherson et al. (2001) for a survey). This phenomenon of “birds of a feather flock
together” gains particular relevance in our approach, because we explicitly consider types in
the population and network, respectively. Homophily is an important measure of cross-type
segregation and affects many economically relevant phenomena such as diffusion or learning
and their speeds (Golub and Jackson, 2012a,b), labor market outcomes (Calvo-Armengol and
Jackson, 2004; Toomet et al., 2013), or individual and firm-level success (McPherson and
Smith-Lovin, 1987; Ibarra, 1992).
   We adapt the homophily index from Currarini et al. (2009). For Gr , the homophily index
within group t is defined as Ht (Gr ) = sr,ts+d
                                             r,t
                                                 r,t
                                                     , where sr,t (Gr ) denotes the average number

                                                          20
of friendships that agents of type t have with agents of the same type and dr,t (Gr ) denotes
the average number of friendships that type t form with agents of type different than t. The
homophily index of a network is simply the average homophily across all nodes. We use t to
represent different demographic characteristics, such as gender, race, age, or their combinations
(i.e., rake). Specifically, let Vr,t denotes a set of nodes of type t. Then,
                                           1 X                                   1 X X
                          sr,t (Gr ) =               Wij,r ,    dr,t (Gr ) =             Wij,r .
                                          nr,t i,j∈V                            nr,t i∈V
                                                   r,t                                      r,t   j ∈V
                                                                                                    / r,t


    In the case of induced subgraph, fixing type t, we propose the following weighted estimators
                                                                                
                                                                            T
                |s          1 X                                |s     1 X        X
                                             −1
                                                         and d˜r,t =                           −1 
                                                                                                  
             s̃r,t =                  Wij,r ψr,t                                      Wij,r ψr,` .
                           mr,t i,j∈S                                mr,t `6=t  i,j∈S
                                      r                                                             r
                                ti =tj =t                                                  ti =t,tj =`

                                                                          |s                 |s
                                −1
Therefore, we propose multiply ψr,t                                                −1
                                    on each link for the calculation of s̃r,t and ψr,` for d˜r,t .
                                                                              |s
                                                                            s̃r,t
                                       e t (G|s
The weighted sample homophily index is H     r) =                        |s       |s   .
                                                                       s̃r,t +d˜r,t
    In the case of star subgraph, fixing type t, we propose the following weighted estimators
                                    1 X                               −1
                          s̃sr,t =            Wij,r ψr,t + 2(1 − ψr,t )                   (16)
                                   mr,t i,j∈S
                                                          r
                                                   ti =tj =t


and                                                                                                        
                                         T                                        −1 
                           ˜s      1 X        X         
                           dr,t =                  Wij,r ψr,` /ψr,t + (1 − ψr,` )    .                        (17)
                                  mr,t `6=t  i,j∈S                                   
                                                         r
                                                  ti =t,tj =`

                                            2
                                                                 −1
Therefore, we propose to multiply ψr,t        + 2ψr,t (1 − ψr,t )    on each link for the calculation of
  s                                           −1      ˜s
s̃r,t and multiply (ψr,t /ψr,` + (1 − ψr,` )) for dr,t . The weighted sample homophily index is
                  s
He t (Gsr ) = s s̃r,t s . The derivations can be found in Appendix A.6.
           s̃r,t +d˜r,t



4     Monte Carlo Simulations
This section evaluates numerically the extent of biases in the network measures (in Section
4.1) and the estimates using these measures as regressors (in Section 4.2), depending on the
sampled network type (induced vs. star subgraph), sampling rate, and (non-)randomness
of the sample. We quantify the biases in raw sampled data and in corrections based on the
missing-at-random assumption, and compare their performance vis-à-vis our poststratification
weighting. We concentrate on a scenario that mimics our modeling assumptions. This provides
a natural testing ground of our approach.
    To illustrate the usefulness of our poststratification weighting approach, we focus on six
network characteristics from Section 3 in the simulation exercise: average degree, total clus-
tering, graph span, epidemic threshold, homopily, and bounds on the maximal eigenvalue. We
do not include the degree distribution because it relies on a complex constrained penalized

                                                                21
weighted least square approach from Zhang et al. (2015) and it is beyond the scope of this
paper to demonstrate that detailed procedure. Moreover, one objective of this study is to
analyze how the proposed estimates perform in regression analysis. It is thus not clear how
to incorporate the degree distribution into a regression.27
    The population data in our simulation study is adopted from the Add Health Wave-I In-
school data.28 In particular, we adopt one Add Health school as a prototype.29 By adopting
a real-life sample school, we can preserve certain real-life relationships between individuals’
characteristics and the network. For example, white students have on average more net-
work (friendship) connections than black students and the latter are on average more con-
nected than other races in the data, and the patterns of homophily depend systematically on
the race composition of each school (Currarini et al., 2009, 2010).
    For ease of interpretation we manipulate the size of the population to 1,500 so that the
numbers of whites, blacks, and other races are all equal to 500 in each race group. We use
three demographic characteristics from the prototype to define individual’s type: seniority
(C1), gender (C2), and race (C3). Seniority takes value of one if an individual is older than
the population average and zero otherwise. For gender, one stands for male and zero for
female. For race, one denotes White, two denotes Black, and three stands for other races. We
also combine these three characteristics to form 2 × 2 × 3 = 12 cross-characteristics, denoted
by Rake throughout.30 Seniority and gender are largely uncorrelated with individual network
connectivity. In contrast, race is strongly correlated with network degree in the data. The
average degree of white students is 9.60, black students have an average of 7.38, whereas
the average connectivity is 4.39 for other races. Naturally, the three variables can partially
predict who is connected to whom. In the following sections, homophily mostly refers on rake
homophily. The results are very similar in case of homophily on other variables.

4.1     Network characteristics
As a first step, we quantify the biases in network measures in sample networks using raw data,
corrections assuming representativeness, and our postsratification weighting approach. From
the above described population, we generate 100 artificial sampled networks using a number
of removal schemes. In particular, we vary the removal strategy in three dimensions. First, we
apply two sampled network types, induced and star subgraphs. In the induced subgraphs, we
remove a fraction of nodes and all their links (including their connections to the non-removed
individuals); for the star subgraphs, we remove a fraction of nodes and only their links to
other removed individuals. Second, we consider three sampling rates, ψ = 80%, 60%, and 40%
  27
     The same issue applies to the bounds on the maximal eigenvalue. Should we use the lower or the upper
bound, or the middle point between these two? We therefore skip the bounds on the maximal eigenvalue in
the regression analysis.
  28
     This is a program project designed by J. Richard Udry, Peter S. Bearman, and Kathleen Mullan Harris,
and funded by a grant P01-HD31921 from the National Institute of Child Health and Human Development,
with cooperative funding from 17 other agencies. Special acknowledgment is due Ronald R. Rindfuss and
Barbara Entwisle for assistance in the original design. Persons interested in obtaining data files from Add
Health should contact Add Health, Carolina Population Center, 123 W. Franklin Street, Chapel Hill, NC
27516-2524 (addhealth@unc.edu). No direct support was received from grant P01-HD31921 for this analysis.
  29
     The adopted school is a public suburban school with 1606 student from grades 9 to 12. The school is
located in the southern U.S.
  30
     Rake combines the previous three variables such that the types are for example “senior black female,”
“junior male of other race,” and so on.



                                                    22
(or alternatively three removal rates, 1 − ψ = 20%, 40%, and 60%, respectively). Third, we
employ four removal strategies with respect to the representativeness of the artificially sampled
subgraphs. We either remove people randomly (Scenario R) or on basis of their connectivity.
In the latter case, we employ three scenarios: (i) removal of high-degree nodes with higher
probability (Scenario H), (ii) removal of intermediate-degree nodes with higher probability
(Scenario M), and (iii) removal of low-degree nodes with higher probability (Scenario L).31
Since race is strongly correlated with network degree in the data, when we generate our
artificial samples and would like non-random (disproportional) missing, we use race for such
purposes.More precisely, if we want to remove highly connected nodes with higher probability,
we remove white students with higher probability and so on.32 We perform 100 repetitions of
each constellation.
    Figures 1 and 2 summarize the first set of results from our Monte Carlo simulations for
the induced- and the star-subgraph sampling, respectively. In Figures 1 and 2, the y-axes
reflect the average magnitudes and signs of the biases (out of 100 runs of each constellation)
in percentage terms with respect to the population values. The x-axes list the five network
characteristics under scrutiny in the following order: average degree, total clustering, graph
span, epidemic threshold, and homophily on rake.33,34 The blue bars represent the raw sample
data and the red bars, denoted Random, reflect the corrections based on the missing-at-random
assumption. The remaining three cases are variations of our methodology. The light green
bars weight on the network-unrelated C1, whereas the last two bars represent, respectively,
the weighting on C3 only (brown) and Rake (i.e., the combination of C1-C3; gray).35 The
rows and columns represent the four different removal strategies, Scenario R, H, M, L, and
the three sampling rates, ψ = 80%, 60%, and 40%, in these orders.
    Biases in the raw data. We first discuss the biases that arise in the considered mea-
sures if raw sampled data are used to compute the network statistics and stress the effect
of non-representativeness. This exercise reveals that treating the data “as if” complete leads
to large differences between the population and sample networks under virtually all removal
strategies. Not surprisingly, the biases are larger in the induced subnetwork (as less informa-
tion is available about the network, conditional on the sampling rate) and decrease with the
sampling rate (increase with the missing rate). The most biased characteristics are average
degree, graph span, and the epidemic threshold. The raw sample data consistently make the
network appear less connected, exhibiting longer average distances, and as less epidemic-prone
than it actually is. All these findings are direct consequences of observing fewer links than
there actually exist in the population.
    To provide some rough quantification of the biases in the sample average degrees, the biases
are in the range of 20%, 40%, and 50% in the induced subgraphs and 3%, 15%, and 20% in the
star subgraphs for ψ = 80%, 60%, and 40%, respectively. The extent of biases in the average
degree are clearly associated with who is removed and in the expected direction. Under non-
random missing and conditional on ψ, we always detect the largest biases when there is a
  31
      We use the notation R(andom), H(igh), M(edium), and L(ow) to make sure that the readers associate the
letter with the removal strategy.
   32
      Specifically, the amounts of removal for (white, black, other races) are ( 1−ψ 1−ψ 1−ψ
                                                                                  2 , 3 , 6 ) × 1500 in scenario
H, ( 1−ψ   1−ψ 1−ψ                                  1−ψ 1−ψ 1−ψ
       4 , 2 , 4 ) × 1500 in scenario M, and ( 6 , 3 , 2 ) × 1500 in scenario L.
   33
      To save on space, we do not include the results for the bounds on the maximal eigenvalue in the main
text; they can be found in Figures C.1 and C.2 in Appendix C.
   34
      The results are qualitatively similar if we focus on gender or race homophily instead.
   35
      Weighting on C2 performs very similarly to weighting on C1 and is thus omitted.


                                                      23
                                                                                                                                                        150
                        30




                                                                                           60
                                                                                                                                                                                                        Raw
                                                                                                                                                                                                        Random
                        20




                                                                                           40




                                                                                                                                                        100
                                                                                                                                                                                                        C1
                                                                                                                                                                                                        C3
                     10




                                                                                             20
                                                                                                                                                                                                        Rake
              Bias (%)




                                                                                       Bias (%)




                                                                                                                                                   Bias (%)
 Scenario R




                                                                                                                                                       50
                0




                                                                                       0




                                                                                                                                                        0
                        −10




                                                                                           −20
                        −20




                                                                                                                                                        −50
                                                                                           −40
                                       Ave Deg    Clus   Span   Epid Thrld   HI−Rake               Ave Deg    Clus   Span   Epid Thrld   HI−Rake                  Ave Deg    Clus   Span   Epid Thrld   HI−Rake




                                                                                                                                                        400
                        30




                                                                                           80
                                                                                           60
                        20




                                                                                                                                                        300
                                                                                           20 40
                                  10




                                                                                                                                                   100 200
                         Bias (%)




                                                                                       Bias (%)




                                                                                                                                                    Bias (%)
 Scenario H
              −30 −20 −10 0




                                                                                       0




                                                                                                                                                        0
                                                                                           −40




                                                                                                                                                        −100
                                       Ave Deg    Clus   Span   Epid Thrld   HI−Rake               Ave Deg    Clus   Span   Epid Thrld   HI−Rake                  Ave Deg    Clus   Span   Epid Thrld   HI−Rake




                                                                                                                                                        100
                        40




                                                                                           60
                        30




                                                                                           40




                                                                                                                                                            50
                 10 20




                                                                                              20
 Scenario M
              Bias (%)




                                                                                       Bias (%)




                                                                                                                                                   Bias (%)
                                                                                         0




                                                                                                                                                   0
                        0




                                                                                           −20
                        −20 −10




                                                                                                                                                        −50
                                                                                           −40




                                       Ave Deg    Clus   Span   Epid Thrld   HI−Rake               Ave Deg    Clus   Span   Epid Thrld   HI−Rake                  Ave Deg    Clus   Span   Epid Thrld   HI−Rake
                        20




                                                                                           40




                                                                                                                                                        60
                        10




                                                                                           20




                                                                                                                                                        40
              Bias (%)




                                                                                       Bias (%)




                                                                                                                                                   Bias (%)
                                                                                                                                                         20
 Scenario L
                 0




                                                                                          0




                                                                                                                                                   0
                        −10




                                                                                           −20




                                                                                                                                                        −40 −20
                        −20




                                                                                           −40




                                       Ave Deg    Clus   Span   Epid Thrld   HI−Rake               Ave Deg    Clus   Span   Epid Thrld   HI−Rake                  Ave Deg    Clus   Span   Epid Thrld   HI−Rake




                                                 1 − ψ = 20%                                                 1 − ψ = 40%                                                    1 − ψ = 60%

Figure 1: Induced subgraph: Biases (%) of network measures and their corrected versions
with respect to the population network for ψ = 80% (left), 60% (center), 40% (right) and four
different removal strategies.




                                                                                                             24
                 10




                                                                            20
                                                                                                                                                                                        Raw




                                                                                                                                         40
                                                                                                                                                                                        Random
                                                                                                                                                                                        C1




                                                                            10
                 5




                                                                                                                                             20
                                                                                                                                                                                        C3
                                                                                                                                                                                        Rake
              Bias (%)




                                                                         Bias (%)




                                                                                                                                    Bias (%)
 Scenario R
                 0




                                                                            0




                                                                                                                                       0 −20
                                                                            −10
                 −5




                                                                                                                                         −40
                 −10




                                                                            −20
                         Ave Deg    Clus   Span   Epid Thrld   HI−Rake              Ave Deg    Clus   Span   Epid Thrld   HI−Rake                 Ave Deg    Clus   Span   Epid Thrld   HI−Rake
                 10




                                                                            20




                                                                                                                                         40
                                                                            10
                 5




                                                                                                                                             20
              Bias (%)




                                                                         Bias (%)




                                                                                                                                    Bias (%)
 Scenario H
                 0




                                                                            0




                                                                                                                                       0 −20
                                                                            −10
                 −5




                                                                                                                                         −40
                 −10




                                                                            −20




                         Ave Deg    Clus   Span   Epid Thrld   HI−Rake              Ave Deg    Clus   Span   Epid Thrld   HI−Rake                 Ave Deg    Clus   Span   Epid Thrld   HI−Rake
                 10




                                                                            20




                                                                                                                                         40
                                                                            10
                 5




                                                                                                                                             20
 Scenario M
              Bias (%)




                                                                         Bias (%)




                                                                                                                                    Bias (%)
                 0




                                                                            0




                                                                                                                                       0 −20
                                                                            −10
                 −5




                                                                                                                                         −40
                 −10




                                                                            −20




                         Ave Deg    Clus   Span   Epid Thrld   HI−Rake              Ave Deg    Clus   Span   Epid Thrld   HI−Rake                 Ave Deg    Clus   Span   Epid Thrld   HI−Rake
                 10




                                                                            20




                                                                                                                                         40
                                                                            10
                 5




                                                                                                                                             20
              Bias (%)




                                                                         Bias (%)




                                                                                                                                    Bias (%)
 Scenario L
                 0




                                                                            0




                                                                                                                                       0 −20
                                                                            −10
                 −5




                                                                                                                                         −40
                 −10




                                                                            −20




                         Ave Deg    Clus   Span   Epid Thrld   HI−Rake              Ave Deg    Clus   Span   Epid Thrld   HI−Rake                 Ave Deg    Clus   Span   Epid Thrld   HI−Rake




                                   1 − ψ = 20%                                                1 − ψ = 40%                                                   1 − ψ = 60%

Figure 2: Star subgraph: Biases (%) of network measures and their corrected versions with
respect to the population network for ψ = 80% (left), 60% (center), 40% (right) and four
different removal strategies.




                                                                                              25
tendency not to observe relatively connected individuals, followed by the removal of nodes
with intermediate connectivity, and then with the removal of low-degree nodes exhibiting the
lowest biases in average degrees. Random removal mostly leads to biases comparable to the
removal of nodes with intermediate degrees. As for the graph span, the sample networks always
exhibit longer average distances, compared to the population graphs, and the biases follow
the same patterns as the average degree: they rise with the missing rate and the tendency to
remove more connected nodes. The biases are respectively 8-20%, 21-69%, and 38-386% for
the induced subgraph and 1-4%, 5-16%, and 11-52% for the star subgraph. Last, observing
only a sample of nodes increases the epidemic threshold. Once again, larger missing rate is
associated with larger biases and with the tendency to remove more connected individuals,
with the exception of the induced network and ψ = 80% where the largest bias occurs if
intermediate nodes are missing with higher probability. The epidemic threshold is biased
respectively almost up to 36%, 77%, and 163% in the induced graphs, and 5%, 19%, and 44%
in the star subnetworks.
    The biases are quantitatively much lower and exhibit more complex patterns in case of
the clustering coefficient and the homophily index, two network characteristics that represent
shares and are thus restricted to values between zero and one. They also increase with the
sampling rate, but they are not necessarily lower in the star graph and their magnitudes and
signs are highly sensitive to the removal strategy.
    The clustering coefficient in the induced subgraph is only mildly biased (less than 2%)
under random removal and this removal scheme always deviates the clustering coefficient the
least from its true population value. Removing more connected nodes with higher probability
(Scenario H) always drives the clustering coefficient down, while Scenarios M and L inflate
it. Quantitatively speaking, the sampled clustering coefficients are biased (downwards) by
-5.1%, -10.7%, and -16.8% for ψ = 80%, 60%, and 40% when more higher-degree nodes are
not observed; the corresponding figures are positive and relatively similar for Scenarios M and
L (3.9%, 9.3%, and 16.7% vs. 4.8%, 10.9%, and 23.4%).
    In contrast to the induced graph, the biases in the clustering coefficient are always negative
and even the random removal can bias the coefficient downwards considerably under the star-
network sampling scheme. This naturally arises due to the fact that many neighbors of the
sampled nodes are not observed. The mutual links of the latter are thus not recorded, lowering
the clustering of the sampled subjects. Hence, the network always looks less clustered than
it actually is in the star subnetworks. Under random missing, the observed biases are -3.4%,
-12.6%, and almost -30% as the missing rate increases. Compared to the missing-at-random
situation, the biases are always larger in absolute terms if high-degree nodes are removed with
higher probability (Scenario H: -6.1%, -22.0%, and -45.6% for ψ = 80%, 60%, and 40%) and
lower in the other two cases (Scenario M: -2.6%, -8.3%, and -13.35; Scenario L: -1.6%, -6.1%,
and -12.42%). This is an example showing that non-random missing may generate lower biases
than representative samples if the “right” nodes are removed.
    Regarding homophily on rake, it exhibits no biases whatsoever under random missing
(less than 0.15%). This is probably the reason why the literature has ignored the effects of
sampling on homophily. However, non-random missing leads to mismeasured values. Under
disproportional missing of different types, the biases again decrease with the sampling rate.
Overall, sampling makes the networks look less homophilous than they are, except when
relatively non-connected nodes are missing with higher probability in the induced graph.36
 36
      One non-regular exception is the case of higher missing of high-degree nodes with ψ = 40%.


                                                      26
Virtually no biases are detected in the star graph and they are very low for the induced graph
if ψ = 80%. For ψ = 60%, the biases in absolute value do not exceed 7% and 4% in the induced
and star graph, respectively. Nevertheless, the biases start to be severe (10% or more) if the
sampling rate is low.
     Biases in the corrections. The second objective of this section is to compare the raw
sample statistics with the random corrections and three variations of weights that apply our
methodology. Remember that seniority (C1) is largely uncorrelated with connectivity while
race (C3) is associated strongly, but both variables determine who links with whom. Therefore,
we first discuss the case of C1. One would expect C1 to correct at least the scaling effect. This
exercise is of interest to illustrate what happens when a researcher weights on a variable that
contains little information about the network. Can such a variable hurt, rather than help? If
so, one should be very careful selecting the variables. Second, we weight on C3, which should
correct the scaling problem and provide additional improvement, since this variable correlates
with one’s position. Last, we weight on rake (that is, the combination of C1, C2, and C3). We
hypothesize these corrections should outperform the previous cases, since they employ most
of the available information.
     With very few exceptions, all correction strategies outperform the raw data. As expected,
the corrections assuming randomness work well under random sampling and their performance
is similar to our weighting methodology. Nevertheless, the random corrections and the weight-
ing approach diverge once the missing-at-random assumption is violated. As hypothesized,
the random corrections and weighting on the network-irrelevant C1 perform very similarly
overall. This is an important result, since it shows that weighting on any variable still mit-
igates the biases and does not hurt, compared to the raw data and the random corrections.
However, these corrections are still biased and these biases increase with the missing rate and
are lower in the star-subnetwork sampling scheme. The biases are minimal if we weight either
on C3 or rake and both approaches virtually always outperform all other methods. In fact,
both weighting schemes almost eliminate any biases arising from sample network data. The
maximum biases are 1.1%, 1.6%, and 6.8% for ψ = 80%, 60%, and ψ = 40% for the induced
subgraphs; the figures are even lower for the star subnetwork.37
     To investigate the stability of the proposed corrections in finite samples, Figures C.3 -
C.18 in Appendix C complement the above analysis by displaying the whole distribution
of the corrections network by network using standard samples sizes in applications. More
precisely, the figures plot the true population network statistics for each network on the y-
axes and, respectively, their (raw) sample values, the corrections based on randomness, and
the corrections weighted on rake on the horizontal axes.38 The reported graphs enable one
to evaluate two particular features of the finite-sample performance of the raw data and the
corrections: (a) the slope of the estimators in comparison with the 45o line, and (b) their
dispersion around the 45o line. Ideally, an estimator recovers a network statistic free of any
error. All points in each panel would thus lie right on the 45o line. In the other extreme,
the raw data as well as the corrections might be systematically related to the magnitude of
the population statistic and the corrections might be unstable. This would be the case if
the biases in the corrected value of, say, average degree would be systematically higher for
  37
    Our approach perform even better in case of the bounds on the maximal eigenvalue. See Appendix C.
  38
    Appendix C reports 16 figures, corresponding to the two sampling methods, four removal strategies, and
two sampling rates 40% and 80%. Since all the conclusions extend to ψ = 60%, we save on space and do not
include the graphs for ψ = 60%. Each figure contains six panels, one for each network statistic under study.
Each circle in each panel corresponds to one network.


                                                    27
networks with low average connectivity compared to networks with high connectivity and the
proposed corrections would systematically lie far away from the true values. Regarding the
stability of the corrections, some dispersion is expectable and inevitable in finite samples. As
for the slope, only attenuation would be an issue in simple linear regressions applying these
corrections as long as the distribution of the corrected values preserve the slope of the 45o
line.39 If the corrections had a slope lower than the 45o line, attenuation would be reinforced,
although the likelihood of false negatives (and type I error) would increase. However, the
most serious problem arises if a corrections exhibits a slope higher than one in the figures.
In such a case, expansion of network effects would take place and the probability of type II
would increase if the correction was applied as a regressor in a simple linear regression model.
Note that the corrected network statistics might still inflate the estimated network effects
even if the corrections work well on average in Figures 1 or 2.40 It is, therefore, crucial to
account for such a possibility. The matters become naturally more complex and problematic
in multivariate regressions or non-linear models.
    Appendix Figures C.3 - C.18 reveal that the raw-data network statistics are systematically
unstable and biased. Moreover, the slopes of the corrections differ typically from 45o line
(independently of the statistic under scrutiny, the parameter values, and the removal strategy),
and the raw-data statistics deliver largely unstable estimates of the true value. Therefore, if
the raw network statistics are employed as regressors, the estimates will be seriously biased,
and acceptance of spurious network effects would be frequent. These issues are particularly
severe under non-representative sampling strategies.
    The corrections based on the missing-at-random assumption and our poststratification ap-
proach perform similarly under random missing and successfully recover the true population
values. In addition, the estimates under both methodologies are very stable as they only
deviate slightly from the 45o line under random sampling. They should both eliminate the
expansion problem and only suffer mildly from attenuation if applied as regressors in repre-
sentative samples. In contrast, our weighting approach clearly outperforms any other method
once we depart from the missing-at-random assumption: the weighted corrections always ex-
hibit slopes equal to the 45o degree line in Appendix Figures C.3 - C.18 and they are never
more dispersed than the raw-data statistics or the corrections assuming representativeness.
The increased performance of the weighting methodology is more pronounced as the miss-
ing rate increases in case of all the studied network statistics. Our approach particularly
outperforms the random corrections if low-degree nodes are more likely to be missing in the
induced subgraphs and if high-degree nodes are missing with higher probability under the
star-subgraph sampling. In sum, our methodology outperforms the corrections based on the
missing-at-random assumption both in terms of the average performance and in their stability
while recovering the network statistics.
    As a result, the proposed approach should improve inference on sampled networks by
delivering the least biased and more stable estimates of network effects compared to raw data
  39
     If the slope is one in the figures, the estimated network effect would be attenutated even if the values of
the corrected variable are on average shifted downwards of upwards from the 45o line. Such shifts would be
absorbed by the estimated intercept.
  40
     This would be the case if a statistic corrected well on average was inflated for below-average values while
reduced for above-average values. This is common under the raw data and still the case in several instances
while employing the corrections based on randomness in Appendix Figures C.3 - C.18. Regressing a variable
of interest on such incorrectly corrected statistic will naturally lead to expansion and the possibility to accept
a network effect that does not exist even in simple linear regression models. This never happens under our
weighting approach though (see Appendix Figures C.3 - C.18).


                                                       28
and random corrections. Appendix Figures C.3 - C.18 additionally suggest that, under our
approach, we should mostly expect attenuation and if some biases remain they would be more
pronounced in the induced subgraphs. The next section analyzes these conjectures.

4.2     Network effects
We now turn the attention to the performance of the poststratification weighting in a regression
framework, aiming at estimating global network effects on economic outcomes. Since our
weighting approach is designed for global network measures, the independent variables of
network measures in the regressions are measured at the network-wide level. We also limit
the present analysis to network-level dependent variables, such as the mean, median, or other
statistics computed from individuals’ outcome in the network. However, as discussed above,
the method can be extended to models in which we directly regress individual behaviors or
outcomes on global network properties or in which the network properties are the dependent
variables.
    To generate the population data, we again take the manipulated Add Health school sample
of the size 1,500 individuals as the phototype. We create 200 artificial populations of the size
1,500 with the node characteristics adopted from this phototype sample. Then, based on the
average connectivity, clustering coefficient, and homophily index corresponding to different
types of individuals in this phototype sample, we simulate network links in these 200 artificial
populations. That is, we generated 200 population networks that have the same size, same
node characteristics (i.e., C1, C2, and C3), but different network configurations. Particularly,
simulated links exhibit uneven connectivity across types, where white nodes on average have
the highest degree, followed by blacks and then nodes of other races. There are also features
of clustering and homophily in different types. To simulate the population dependent variable
y in each network, we follow a simple linear regression model: yr = α + βw(Gr ) + εr , with εr
being an i.i.d. random error from N (0, 1). We generate the data with designed parameters
α = 1 and different β’s corresponding to different network measure w(Gr ): β = 0.5 for
average degree; β = 5 for the clustering coefficient; β = −0.5 for the epidemic threshold;
β = −0.5 for graph span; and β = −0.5 for each of the homophily indices. Lastly, for each
of the population networks, we generate 100 artificial samples following the same removal
strategies from the previous section. This generates the artificial raw data, on which we
apply the corrections based on the missing-at-random assumption and our poststratification
weighting approach. We estimate the model using the three types of network measures (raw
data, random corrections, and poststratification weighting on rake) and compare them to the
estimates with the artificial population networks.
    Figures 3 and 4 report the average biases in the estimated β’s (out of 100 Monte Carlo
repetitions) with respect to the population for the induced and star subgraphs, respectively.41
Again, y-axes reflect the biases in percentage terms and their signs and x-axes the five network
statistics.42 The blue bars correspond to the raw data, the red ones to the corrections based
on random missing, and the gray bars to weighting on rake.
    The general results regarding the biases mimic those of network characteristics, in most re-
spects. The biases in the estimates–both from the raw data and after applying the corrections–
  41
     For clarity, we omit the results corresponding to weighting on seniority, gender, or race only. The biases
in the estimates behave similarly to the biases detected in the previous subsection.
  42
     For reasons exposed in the beginning of this section, we perform this analysis neither for the degree
distribution nor for the bounds for the maximal eigenvalue.


                                                      29
                                                                                                                                         150
                 30




                                                                            60
                                                                                                                                                                                       Raw
                                                                                                                                                                                       Random




                                                                                                                                         100
                                                                                                                                                                                       Rake
                 20




                                                                            40
 Scenario R
              Bias (%)




                                                                         Bias (%)




                                                                                                                                      Bias (%)
                                                                                                                                          50
                 10




                                                                            20




                                                                                                                                         0
                 0




                                                                            0




                                                                                                                                         −50
                 −10




                                                                            −20
                         Ave Deg    Clus   Span   Epid Thrld   HI−Rake                Ave Deg    Clus   Span   Epid Thrld   HI−Rake              Ave Deg    Clus   Span   Epid Thrld   HI−Rake




                                                                                                                                         150
                 30




                                                                            80
                                                                            60




                                                                                                                                         100
                 20




                                                                            20 40
 Scenario H
              Bias (%)




                                                                         Bias (%)




                                                                                                                                      Bias (%)
                                                                                                                                          50
                 10




                                                                            0




                                                                                                                                         0
                 0




                                                                            −40 −20




                                                                                                                                         −50
                 −10




                         Ave Deg    Clus   Span   Epid Thrld   HI−Rake                Ave Deg    Clus   Span   Epid Thrld   HI−Rake              Ave Deg    Clus   Span   Epid Thrld   HI−Rake




                                                                                                                                         150
                 30




                                                                            80
                                                                            60




                                                                                                                                         100
                 20




                                                                            20 40
 Scenario M
              Bias (%)




                                                                         Bias (%)




                                                                                                                                      Bias (%)
                                                                                                                                          50
                 10




                                                                            0




                                                                                                                                         0
                 0




                                                                            −40 −20




                                                                                                                                         −50
                 −10




                         Ave Deg    Clus   Span   Epid Thrld   HI−Rake                Ave Deg    Clus   Span   Epid Thrld   HI−Rake              Ave Deg    Clus   Span   Epid Thrld   HI−Rake
                                                                                                                                         150
                 30




                                                                            80
                                                                            60




                                                                                                                                         100
                 20




                                                                            20 40
 Scenario L
              Bias (%)




                                                                         Bias (%)




                                                                                                                                      Bias (%)
                                                                                                                                          50
                 10




                                                                            0




                                                                                                                                         0
                 0




                                                                            −40 −20




                                                                                                                                         −50
                 −10




                         Ave Deg    Clus   Span   Epid Thrld   HI−Rake                Ave Deg    Clus   Span   Epid Thrld   HI−Rake              Ave Deg    Clus   Span   Epid Thrld   HI−Rake




                                   1 − ψ = 20%                                                  1 − ψ = 40%                                                1 − ψ = 60%

Figure 3: Induced subgraph: Biases (%) in network effects and their corrected versions with
respect to the population network for ψ = 80% (left), 60% (center), and 40% (right) and four
different removal strategies.




                                                                                                   30
                 15




                                                                            40




                                                                                                                                        60
                                                                                                                                                                                      Raw




                                                                                                                                        50
                                                                                                                                                                                      Random




                                                                            30
                                                                                                                                                                                      Rake
                 10




                                                                                                                                    20 30 40
 Scenario R




                                                                               20
              Bias (%)




                                                                         Bias (%)




                                                                                                                                    Bias (%)
                 5




                                                                         10




                                                                                                                                        10
                 0




                                                                            0




                                                                                                                                        0
                                                                            −10




                                                                                                                                        −10
                 −5




                         Ave Deg    Clus   Span   Epid Thrld   HI−Rake              Ave Deg    Clus   Span   Epid Thrld   HI−Rake               Ave Deg    Clus   Span   Epid Thrld   HI−Rake
                 15




                                                                            40




                                                                                                                                        60
                                                                                                                                        40
                                                                            30
                 10




                                                                                                                                           20
 Scenario H




                                                                               20
              Bias (%)




                                                                         Bias (%)




                                                                                                                                    Bias (%)
                 5




                                                                                                                                      0
                                                                         10




                                                                                                                                        −20
                 0




                                                                            0




                                                                                                                                        −40
                                                                            −10
                 −5




                         Ave Deg    Clus   Span   Epid Thrld   HI−Rake              Ave Deg    Clus   Span   Epid Thrld   HI−Rake               Ave Deg    Clus   Span   Epid Thrld   HI−Rake
                 10




                                                                            40




                                                                                                                                        60
                 8




                                                                                                                                        40
                                                                            30
                 6
 Scenario M




                                                                                                                                           20
                                                                               20
              Bias (%)




                                                                         Bias (%)




                                                                                                                                    Bias (%)
                2    4




                                                                                                                                      0
                                                                         10
                 0




                                                                                                                                        −20
                 −4 −2




                                                                            0




                                                                                                                                        −40
                                                                            −10




                         Ave Deg    Clus   Span   Epid Thrld   HI−Rake              Ave Deg    Clus   Span   Epid Thrld   HI−Rake               Ave Deg    Clus   Span   Epid Thrld   HI−Rake
                 10




                                                                            40




                                                                                                                                        60
                 8




                                                                                                                                        40
                                                                            30
                 6




                                                                                                                                           20
 Scenario L




                                                                               20
              Bias (%)




                                                                         Bias (%)




                                                                                                                                    Bias (%)
                2    4




                                                                                                                                      0
                                                                         10
                 0




                                                                                                                                        −20
                 −4 −2




                                                                            0




                                                                                                                                        −40
                                                                            −10




                         Ave Deg    Clus   Span   Epid Thrld   HI−Rake              Ave Deg    Clus   Span   Epid Thrld   HI−Rake               Ave Deg    Clus   Span   Epid Thrld   HI−Rake




                                   1 − ψ = 20%                                                1 − ψ = 40%                                                 1 − ψ = 60%

Figure 4: Star subgraph: Biases (%) in network effects and their corrected versions with
respect to the population network for ψ = 80% (left), 60% (center), and 40% (right) and four
different removal strategies.




                                                                                                 31
increase in the missing rate, are higher for the induced networks compared to star subgraphs,
where less data is missing (conditional on the sampling rate), and depend on who is missing.
The raw network data exhibit very large biases in the estimates for all network statistics and
expansion is commonplace. The performance of the corrections based on randomness and
the weighting approach is similar if the data are missing at random, but they generally di-
verge otherwise. Both types of corrections mitigate the biases with respect to the raw data,
but accounting for the non-representativeness of the sample using our methodology generally
reduces the biases as compared to the corrections based on randomness.
    In the induced networks, the biases in the estimates using raw data are typically con-
siderable in percentage terms. These biases are specifically large for the average degree, the
epidemic threshold, and the graph span. The raw data always inflate the network effects of
these corrections. Hence, expansion and non-classical measurement error problem present a
serious issue in these cases. The effects of the average degree are inflated by more than 20%,
40%, and 50% for 1−ψ = 20, 40, 60%, with the exception of Scenario L under which the figures
are lower but still important. The biases in the effects of the graph span and the epidemic
threshold are comparable to those of average degrees. The biases are considerably lower in
case of the clustering coefficient and homophily on rake. The random corrections correspond
to their observed sample values in the induced case. Indeed, the biases are relatively low for
random removal (below 11% and 2% for clustering and homophily, respectively). However, the
matters change if we abandon the missing-at-random framework. The effect of clustering is
mostly underestimated, while that of homophily either unbiased or overestimated. The biases
in case of clustering increase with the missing rate and are very sensitive to ψ, being this sensi-
tivity particularly large if relatively more connected nodes are missing with higher probability
(3%, 14%, and 74% for 1 − ψ = 20, 40, 60%). They are somewhere below 9% for ψ = 80%,
around 20% if ψ = 60%, and between 30% and 74% if ψ = 40% under non-representative
missing. In case of homophily, the estimates are biased more than 15% only if more connected
nodes are missing with higher probability and ψ < 80%.
    The biases are generally reduced considerably under this sampling strategy when the cor-
rections are applied. As for the comparison between random corrections and post-stratification
weighting, the former already outperform the latter under random removal. Remember that
this due to the lower error rates exhibited by our approach in Appendix Figures C.3 - C.18.
The estimates under our approach are thus less attenuated. Furthermore, once the removal is
not random, the differences between both correction types become larger even though there
are few cases, in which both methodologies perform similarly. In quantitative terms and with
few exceptions, our corrections exhibit biases below 5%, 10%, and 20% as the missing rate
increases in Figure 3, whereas these numbers are in the order of 10%, 40%, and 50-60% under
random corrections. We only observe systematically serious biases in our approach for the
highest missing rate considered, but in all the cases we outperform the alternative strategies.
There are some cases, in which the bias under random corrections exceeds that of the raw
data; this never happens with our corrections. Moreover, whenever there is a different sign
in the estimates between the random corrections and our weighting approach, it is always the
case that the estimates are attenuated under the weighting but inflated while employing the
random corrections. Hence, our methodology is generally the most successful mitigating the
biases in the network effects and preventing the false positive findings in the induced sub-
graphs. As for the remaining biases, they are inevitable in finite samples due to the errors
induced by sampling. However, Section 4.1 (and Figures C.3 - C.18 in Appendix C) show that
they mostly lead to attenuation.

                                                32
    The star-subgraph statistics exhibit lower biases than the induced graphs and this also
holds when the estimated network statistics are applied as regressors. With few exceptions,
the biases in the estimates of network effects using the raw data are mostly below 5%, 20%,
and 50% for ψ = 80%, 60%, and 40%. Once again, the effect of average degree and graph
span are inflated, but this time the effect of the epidemic threshold is overestimated only
for ψ = 60%. The effect of the clustering coefficient is overestimated in many instances and
relatively large. Both types of corrections reduce the biases drastically. Random corrections
never outperform our weighting approach and they particularly fail to recover the true effect
of the clustering coefficient and the graph span for high missing rates in every non-random
missing scenario. Under the star sampling procedure, our weighting approach eliminates
virtually all the serious biases in the estimates. Overall, our approach is remarkably successful
recovering the true network effects under the star-subgraph sampling.


5      Empirical applications
In this section, we apply the proposed methodology to two data sets with the objective to illus-
trate how statistical inference can be affected if one does not account for non-representativeness
of network samples. In the first subsection, we use network data from rural India. In the sec-
ond, we employ adolescent friendship networks from U.S. high schools. Both data sets contain
information on (non-network) characteristics for the whole population, but only sampled data
on networks.43

5.1     Village Networks in Rural India
Banerjee et al. (2013) elicit a large variety of characteristics including network data from 75
villages in southern Karnattaka, India, corresponding to 75 different networks. The authors
initially collected the census information for each household (on age and gender of household
members) in all villages and later conducted detailed follow-up survey with a subsample of the
population of each village. In the latter, they also elicit the network of relationships among
individuals. Two features of this data make them particularly interesting for our purpose.
First, as in most studies, the survey respondents only represent a sample of each village
and thus their reported network is an induced subgraph of the population network. The
average sampling rate across villages is 35%. The crucial aspect of their sampling design is
the stratification by religion and geographic sub-location, generating a representative sample
with respect to these two variables. This is a common approach in many applications. The
stratification on religion and geography notwithstanding, Table 1 reveals that the data are not
representative in terms of age, gender, and–to a lesser extent–household size. Below, we test
to what extent the differences between the sample and population shares of these categories
affect the estimation of network effects in regressions like (1).
  43
    Similarly to Section 4.2, the applications focus on the average degree and the epidemic threshold, and
abstract from the degree distribution and the bounds on the maximal eigenvalue.




                                                   33
              Table 1: Population and sample shares of different characteristics
              categories and labor outcomes in the Indian rural village data from
              Banerjee et al. (2013).
                                        Population      Sample Difference (p-value)
                Age
                 < 30                     38.71%        30.97%      7.74% (0.000)
                 30 - 50                  39.60%        54.11%     -14.51% (0.000)
                 > 50                     21.69%        14.92%      6.77% (0.000)

                Male Ratio                50.34%        44.57%      5.77% (0.000)

                Household Size
                 <3                       17.26%        15.49%       1.77% (0.038)
                 3-8                      71.57%        73.48%      -1.91% (0.039)
                 >8                       11.17%        11.03%       0.14% (0.879)

                Labor Outcome
                 employed                               62.49%
                 work outside                           21.21%
                Num. of Villages            75            75
                Observations              48,646        16,995

    Second, the data contain several variables regarding the labor market outcomes of the
participants, such as the employment status, whether they work outside the village, and
their occupation. Since the important role of social networks in labor markets is widely
acknowledged in the literature and documented in the data,44 this application is interesting in
its own right. The theoretical literature argues that the degree distribution (Calvo-Armengol
and Jackson, 2004) and the average clustering coefficient (Espinosa et al., 2018) might affect
the employment prospects directly, while average network distances and the epidemic threshold
might influence the flow of labor-market information and thus the labor outcomes indirectly
(see Calvo-Armengol and Jackson (2004) for examples). Similarly, the extent of segregation
may determine who hears about jobs and who does not. However, little empirical evidence
exists regarding the impact of different macro features of networks on labor markets, due
primarily to the lack of suitable data containing enough networks. We thus ask how the village
employment rate and the fraction of people working outside the village are determined by the
global features of the underlying network of relationships within the village. Most importantly,
for the present study, we ask how the estimated network effects change if we account for missing
network data and non-randomness of the sample. Specifically, we hypothesize that the over-
representation of people aged 30-50 and under-representation of men in the sample (see Table
1), those who typically actively participate in labor markets in a country like India, might
bias the estimated network effects if their misrepresentation is not accounted for.
    Table 2 reports the estimated network effects in a series of estimations differing in (i)
the dependent variable (I. employment rate; II. fraction of population working outside the
  44
    Granovetter (1985), Montgomery (1991), or Calvo-Armengol and Jackson (2004) are three standard ref-
erences. See also Granovetter (2005) for a review.


                                                   34
village), (ii) whether raw or corrected networks are used (columns) and (iii) different network
characteristics (rows). Once again, to separate the effect of scaling from the effect on non-
randomness of the sample, we use the raw network data, corrections based on randomness,
and our approach in which we weight on a rake variable (incorporating the information on age,
gender, and household size). Each row reports the estimated network effect (and the standard
error robust to heteroscedasticity in parentheses) from a regression of one dependent variable
on the corresponding network statistic and village size. There are two important things to
note. First, we also apply the post-stratification rake weighting on the dependent variables,
i.e., employment and working outside villages, at the village level to correct measurement
errors due to non-randomness of the sample.45 Second, we use the network constructed by
the union of all relationships reported by survey respondents, e.g., borrowing, lending, seeking
advices, going to temple together, visiting home, and others following Banerjee et al. (2013).
We also study the network effects which are only based on reported friendships and find similar
results (see Appendix Table B.1).


      Table 2: Estimated network effects on the share of population in rural India village
      that (I) employed and (II) work outside the village.
        Dependent Variable             (I) Employed (%)                   (II) Work Outside Village (%)
                                 Raw        Random           Rake         Raw        Random        Rake
        Degree                0.0269∗∗∗      0.0091∗∗    0.0088∗∗        -0.0235∗   -0.0093∗∗     -0.0101∗
                                (0.0095)     (0.0035)     (0.0039)       (0.0120)    (0.0044)      (0.0051)
        Cluster                0.1663∗∗      0.1663∗∗    0.1413∗∗       -0.2137∗∗   -0.2137∗∗    -0.1665∗∗∗
                                (0.0643)     (0.0643)     (0.0610)       (0.0889)    (0.0889)      (0.0626)
        Span                   -0.0248∗∗    -0.0746∗∗     -0.0650∗      0.0335∗∗∗   0.1253∗∗∗     0.1255∗∗∗
                                (0.0096)     (0.0349)     (0.0345)       (0.0117)    (0.0427)      (0.0435)
        Epid. Thrld           -1.1530∗∗∗   -2.3017∗∗∗    -2.0965∗∗       0.9357∗∗    2.3498∗∗     2.3924∗∗
                                (0.3589)     (0.8442)     (0.8341)       (0.4148)    (0.9967)      (1.0430)
        HI-sex                   0.1622       0.1622       0.0974         -0.0689     -0.0689       -0.0368
                                (0.1017)     (0.1017)     (0.0929)       (0.1344)    (0.1344)      (0.1473)
        HI-age                  0.4015∗      0.4015∗       -0.1271        -0.1253     -0.1253     0.4875∗∗
                                (0.2356)     (0.2356)     (0.1932)       (0.3026)    (0.3026)       0.1953
        HI-householdsize         0.0176       0.0176       -0.0127       0.2465∗∗    0.2465∗∗       0.0950
                                (0.1036)     (0.1036)     (0.1003)       (0.0968)    (0.0968)      (0.1163)
        HI-rake                  0.2484       0.2484        0.0443        0.4158∗    0.4158∗      0.5957∗∗∗
                                (0.1790)     (0.1790)     (0.1628)       (0.2098)    (0.2098)      (0.2135)
       Note: Regression is based on 75 villages. Standard errors robust to heteroscedasticity are reported in
      parentheses. *, **, *** stand for significance at 10%, 5%, and 1% respectively. Each row corresponds
      to one regression and the village size is included as a default control.

    Regarding the main purpose of our exercise, Table 2 shows the sensitivity of results with
respect to no-representative sampling. First, the estimates using raw data or corrections based
on the missing-at-random assumption might be attenuated, expanded, and can even switch
signs, compared to the corrections that account for both scaling and the non-representativeness
of the network data. There are examples of false positive findings: two regressions in Table 2
detect a significant network effect using both the raw network statistics and those correcting
for scaling, but this effect disappears if we correct for non-randomness of the network sample.
There exist one case, in which we detect no effect using the raw data and random corrections
 45
      See also footnote 19.


                                                        35
but we do using our weighting approach. The sign switching occurs three times in case of the
raw data and three times in case of the random corrections; it always concerns the effect of
homophily. Second, overestimation with respect of the effect of the weighted network statistics
– disregarding the (non-)significance – is commonplace.
    In the 2 × 8 = 16 regressions employing the raw network data, the biases in the estimates
are always higher than 10% and 10 of the regressions are overestimated. Under overestimation,
the estimates are inflated between 17% in case of clustering and 2,226% in case of the average
degree; if attenuated, the biases range from 30% in case of homophily on rake to 415% in case
of the age homophily. The remaining biases are spread somehow in between these extremes
and are overally economically important.
    In case of the random corrections, 11 (out of the 16) estimates reported in Table 2 are
biased more than 10% with respect to the weighting approach. The biases are below 10%
in case of the average degree and the epidemic threshold in both applications and in case of
graph span when regressed on the fraction of people working outside the village. If biased
more than 10%, the estimates are inflated in 7 regressions (43.8%). These biases lie between
14.8% in case of the clustering coefficient and 460.7% for rake homophily. Underestimation of
the estimates by more 10% is observed in 4 instances (25%) and the biases range from 30%
in case of rake homophily to 415.9% in case of age homophily. Again, the remaining cases are
distributed in between.
    In sum, there are important biases in the estimates under both the raw data as well
as corrections assuming representativeness. Crucially, false positives, expansion of network
effects, and sign switching are common. More important, the direction and the magnitude of
the biases depend non-trivially on the particular network statistics, the dependent variable
under study, and who is missing.46 Hence, researchers cannot easily predict the direction of
the biases and thus cannot rely on classical measurement-error solutions, even in the simplest
cases analyzed here.
    As for how the village networks shape labor outcomes, we corroborate the literature in
that the architecture of social structures plays a key role in labor markets. Accounting for
the non-representativeness of the sample (that is, columns denoted Rake in Table 2) shows
that virtually all the features of social organizations under study matter for the average labor
outcomes in the village and the effects of the different characteristics are to a large extent
consistent with each other. More precisely, both higher average degrees and more dense
social circles stimulate employment and prevent people from having to travel for work outside
their village. Higher average degree favors the flow of information about jobs throughout the
village, naturally making people more likely to find a job and to find it within the village.
As for the clustering coefficient, it is an important measure of whether people take care of
each other within a village in adverse situations, such as unemployment (Coleman, 1988).
Indeed, the estimated effect is positive, suggesting that more clustered villages exhibit higher
employment rates and less need to search for jobs outside the village. Relatedly, shorter
distances and higher epidemic thresholds lead to lower employment rates and more traveling
for work outside the community. This is in line with the idea that higher values of both
variables correspond to less integration, hindering–among other things–the flow of job-related
information from more distant network neighborhoods. Last, homophily does not seem to
effect the labor outcomes systematically. The only exception is age homophily. The estimates
  46
   Observe that the largest biases are detected in case of age-related statistics, the category that differs the
most between the population and the sample.



                                                      36
reveal that higher segregation across different age categories makes people more likely to work
outside the village. Recall that higher homophily corresponds to less connections and thus
lower information flow across different subgroups in the village population. This effect is thus
in line with the effect of the graph span.

5.2     Adolescent friendship networks in U.S. high schools
As a second application, this subsection applies our approach to the Add Health data set.
These data contain extensive information on friendship networks in selected U.S. high/middle
schools and detailed data on individual heterogeneity. The schools are representative.47 Even
though the data collectors interviewed all the students present during the questionnaire day,
the average sampling rate is 63.6% of the school census. We combine the sampled network data
with certain information on the roster in each school. Since the participation was determined
non-randomly, we can expect non-representativeness of the sample. As Table 3 indeed shows,
the sample and the population differ in terms of race and grade compositions. In particular,
white students and students of the ninth grade are underrepresented in the sample. We already
know that white students are more connected. Thus, higher missing of white students will
directly affect the observed network connectedness and the degree of race segregation. As for
the grade composition, younger students might for instance be less integrated in the school
networks, compared to their older schoolmates. Hence, there are good reasons to believe that
the observed school networks are mismeasured and that this may affect inferences on these
networks.


               Table 3: Population and sample statistics of different characteris-
               tics categories and school activities in the Add Health data.
                                         Population       Sample Difference (p-value)
                 White Ratio               60.43%         53.32%       7.11% (0.214)

                 Year grade
                  9th                      32.22%         30.00%        2.22% (0.044)
                  10th                     25.63%         26.53%       -0.90% (0.121)
                  11th                     22.06%         23.00%       -0.94% (0.139)
                  12th                     20.09%         20.47%       -0.38% (0.566)

                 Activity
                  club                                     2.03
                  exercise                                 4.35
                 Num. of Schools              48            48
                 Observations               66,025        40,898

   We present two particular applications here. The first application is inspired by Bramoullé
et al. (2009) who find large peer effects in club participation using the Add Health data.
  47
     We use 48 high schools (out of 80) in Add Health data which consist of year 9 to year 12 and student of
different races. These 480 schools have a complete registration record (i.e., population record) on race and
year compositions of their students.


                                                     37
This raises the question of whether the global features of friendship networks predict the
average club participation at high schools. The second presented application is inspired by the
experiments of Centola (2010, 2011) regarding the effect of friendship networks on the spread
of health-related behaviors. He reports that health related behaviors, including exercising,
are heavily influenced by the clustering coefficient, network distances (Centola, 2010), and
homophily (Centola, 2011). Therefore, we regress two dependent variables, the average club
participation and average exercise frequency in the schools, on the same network characteristics
as in Section 5.1 and the school size. Table 4 reports the estimates using again raw network
data, networks corrected for scaling, and those corrected by our poststratification weighting.
The table has the same structure as Table 2.



Table 4: Estimated network effects on club participation and frequency of exercise in U.S. high
schools.
 Dependent Variable        Number of clubs attended                  Frequency of exercise
                         Raw        Random          Rake          Raw       Random         Rake
 Degree                 0.0681∗∗   0.0646∗∗      0.0660∗∗       0.0970∗∗    0.0526∗∗∗    0.0498∗∗∗
                        (0.0329)   (0.0257)      (0.0255)       (0.0421)     (0.0186)    (0.0194)
 Cluster                 -0.0116    -0.0116       -0.0583        0.5104       0.5104       0.4591
                        (0.3729)   (0.3729)      (0.3571)       (0.6480)     (0.6480)    (0.6289)
 Span                    -0.0009  -0.2886∗∗     -0.3561∗∗∗     -0.0079∗∗∗    -0.1940∗    -0.2399∗∗
                        (0.0012)   (0.1117)      (0.1240)       (0.0014)     (0.1049)    (0.1192)
 Epid Thrld             -2.3991∗ -10.7449∗∗∗    -12.9819∗∗     -4.8215∗∗∗    -6.6086∗    -8.3189∗∗
                        (1.3756)   (3.7717)      (4.0284)       (1.5809)     (3.3198)    (3.9157)
                               ∗∗
 HI-grade               2.4168     2.4168∗∗      2.6725∗∗        1.3443       1.3443       0.6779
                        (1.0237)   (1.0237)      (1.0310)       (1.1274)     (1.1274)    (1.3677)
                                ∗
 HI-race                -0.8281    -0.8281∗        0.0248      -1.9841∗∗∗   -1.9841∗∗∗    -0.8637
                        (0.4314)   (0.4314)      (0.5886)       (0.6582)     (0.6582)    (0.7602)
 HI-rake                  0.1263    0.1263        1.2347∗       -1.6500∗     -1.6500∗     -0.4103
                        (0.7949)   (0.7949)      (0.6998)       (0.9354)     (0.9354)    (0.8941)
 Note: Regression is based on 48 schools. *, **, *** stand for significance at 10%, 5%, and 1%
respectively. Each row corresponds to one regression with the school size included as a default
control.
    Again, we observe that some network effects appear and some disappear, and there are
two instances of sign switching once we account for non-randomness. Similarly, the (non-)
significance can persist, appear, or disappear. There are three cases in the table, in which
both the raw data and the random corrections generate significant impact on the dependent
variables, while they become insignificant with our weighting approach; in one case, the op-
posite occurs. Contrary to Section 5.1, whether the effects are overall attenuated or inflated
depends crucially on the dependent variable.
    In case of the club participation, the only case in which we detect expansion corresponds to
the effect of average degree using the raw data and the bias is small (3.2%). All the remaining
effects are attenuated with respect to our weighting approach. The attenuation is small for
the effect of the average degree corrected for random samples (-2.1%) and homophily on grade

                                               38
(-9.6%). Nevertheless, the estimated effects are biased downwards considerably for the other
variables. The estimated effects are more biased for the raw data. The effects of clustering
are biased downwards by 80.1%, whereas those of the graph span and epidemic threshold
by more than 80% and roughly 18% for the raw data and random corrections, respectively.
The more dramatic biases appears–similarly to Section 5.1–for the variables affected the most
by the differing sampling probabilities of different types. The estimated effect of homophily
on race, the variable closely related to network positioning in the data, is biased downwards
by more than 3,000% if we do not correct for the higher missing rates of races other than
white. Race homophily seems to affect negatively club participation if we disregard the non-
representativeness of the network data, but once we correct for it the effect switches the sign
and becomes statistically non-significant.
    As for the exercise frequency, the effects of the average degree, the clustering coefficient,
and homophily are always overestimated, while those of the epidemic threshold and graph
span are attenuated using both the raw data and corrections assuming representativeness.
The biases in the effects of average degree are 94.8% with raw data but only 5.6% if corrected
for scaling. The effect of the clustering coefficient is overestimated by 11.2% in both cases. The
influence of homophily is always inflated by more than 98% independently of the homophily
type. The estimated effects of graph span and epidemic threshold are underestimated by
around 20% if we employ random corrections; the figures are considerably larger with the raw
network data.
    Regarding the effects of the network if corrected for both scaling and non-representativeness,
the average connectivity of the network stimulates both club participation and exercise fre-
quency, and longer distances and higher epidemic threshold hinder them. All these features
reflect different aspects of higher network integration and the signs are aligned with the in-
tuition. Homophily only affects positively the club attendance but does not influence how
much people exercise. The former finding confirms Centola (2011) in that higher homophily
stimulates diffusion, but the latter contradicts his findings that higher homophily stimulates
the adoption of health behaviors. In contrast to Centola (2010), the clustering does not ex-
plain any dependent variable. Since the experiment of Centola (2010) cannot disentangle the
effect of clustering from that of distances by design, we reestimated the models from Table 4
including both the clustering coefficient and graph span in one model (see Appendix A.1) but
the results do not change. Hence, the (treatment) effect detected by Centola (2010) seems to
be driven by network distances, whereas the effect of clustering might play a minor role in
promoting health behaviors in his data. This conclusion is reinforced by the fact that it holds
for both dependent variables.
    Once again, there is no general tendency in the biases and in how significance levels are
affected. We observe attenuation, expansion, and sign switching, and the (non-) significance
can persist, appear or disappear under our corrections. Most importantly, these applications
illustrate that both the magnitudes and the directions of the biases depend non-trivially on
the dependent variable under study.


6    Discussion
To conclude, we briefly comment on potential extensions and limitations of our methodol-
ogy regarding other sampling methods and network characteristics. We also provide several
recommendations concerning the selection of the weighting variables.


                                               39
Alternative sampling strategies. Although this paper focuses on two particular sam-
pling methods, the induced- and star-subgraph elicitation, the proposed methodology can be
adopted to other sampling schemes as long as the researcher knows the strategy employed for
the elicitation of the sample and possesses some information on the whole population. In the
following, we provide several examples illustrating the applicability of the proposed approach
to other sampling strategies.
     As a first example, consider the issue known as the boundary specification problem. Re-
gardless of whether a researcher elicits a complete or sampled network, she must set a boundary
to determine the population of interest. Imagine for simplicity that the researcher elicits the
entire network structure within one class in a school, disregarding any individual from other
classes and the ties from the class under scrutiny to people outside the class. It is very likely
that there exist connections between the members of the class and other people who do not
belong to the class. Hence, even if there exist a clearly defined boundary and the class network
is complete, the true social network of the studied population is most likely incomplete. If one
would like to study the complete network, say, at the school level and individual characteristics
are available for the whole school, one can mitigate the boundary specification problem by
applying directly our method because setting a boundary is mathematically equivalent to our
induced graph sampling.48
     As a second example, consider snow-ball sampling, a sampling procedure commonly applied
in Sociology, Marketing and Epidemiology (Berg, 2004; Browne, 2005; Chen et al., 2013).
Under the snow-ball sampling, a researcher initially selects a randomly selected subset of
nodes. Then, she performs the first wave by eliciting all the contacts of the initially selected
nodes. In the second wave, she elicits all the contacts of the nodes found in the first wave,
and so on. Observe that the star-network sampling treated above is formally equivalent to
one-wave snow-ball sampling and our methodology directly applies. Nevertheless, there is a
difference between our approach and the corrections proposed in the literature for one-wave
snow-ball sampling: they only coincide if each type is missing with the same probability or if
the weighting variables provide no information about the network under study (see Kolaczyk
(2009); Zhang et al. (2015)). This paper argues this is rarely the case even in very carefully
and systematically collected data sets.
     Unsurprisingly, the corrections proposed in Section 2 cannot be employed directly under
other sampling designs. However, our weighting approach should be adapted to the employed
sampling strategy in most cases. Consider, for example, random selection of links (also known
as incident edge sampling) such that an individual i belongs to the sample if only if at least
one of her edges is sampled. Such sampling is commonplace in communication data, where
only a random sample of phone calls or e-mails is selected. The main problem of this sampling
design is to compute the theoretical probability with which a particular individual belongs
to the sample, but this probability is observed in the type of data we target by this study.
Additionally, since the probability of being sampled depends on nodes’ degrees, the differing
sampling rates across types already provide information regarding the different connectivity
of each type. On the other hand, the probability of each dyad to belong to the sample is the
same for each link. Hence, combining this information with the observed connectivity across
and within types, one can compute, for instance, the expected average degree of the network
a là Section 2 but such computation might be more involved. A similar approach would apply
  48
   As we show above, the estimates will be preciser and more stable with higher fractions of the whole school
population.



                                                     40
for other network measures of interest. In fact, Zhang et al. (2015) show for representative
samples that the corrections for the degree distribution under the incidence edge sampling
are very similar to those under the induced graph sampling; see Lee et al. (2006) for other
network measures. Hence, one can propose the corresponding estimates following Section
3.2. As for snow-ball sampling, it is equivalent to our star subgraph elicitation only if one
wave is executed. Although the computation becomes increasingly complex as more and more
waves are preformed, one can adapt our approach to multiple waves taking into account the
missing frequencies of each type and the information about the within-type and across-type
connectivity from the observed part of the network using combinatorial arguments (see e.g.,
Frank (1977); Snijders (1992)). It is also possible to take into account that all connections
are observed for one part of the sample and apply the corrections to nodes for which some
information might be missing. This notwithstanding, the complexity of the problem increases
with the number of waves as mentioned above and the literature almost exclusively focuses
on the one-wave variant even if all the randomness solely comes from the sampling process
(Frank, 1977). Similar considerations apply for forest-fire sampling, a generalization of snow-
ball sampling. It again starts with a set of randomly chosen individuals and operates in waves.
In the first wave, the analyst elicits the links from the initially chosen individuals, but each
link is only followed with a probability p ≤ 1, and similarly in the following waves. Naturally,
if p = 1 forest-fire sampling is equivalent to snow-ball sampling. Again, one can incorporate
the probability p to the variations of our corrections adapted to snow-ball sampling.
    More generally, parting form the Horvitz-Thompson estimator (Horvitz and Thompson,
1952) the statistical sampling theory has developed a number of estimators of different network
measures under a variety of sampling schemes (see Frank (2005) or Kolaczyk (2009) for text-
book treatments) and our approach combines their developments with the ideas of post-
stratification weighting. Whenever a correction exists under random sampling, it can be
generalized to non-representative samples.
    There are three ways how our methodology enriches the existing methods. First, the
inclusion probability of one particular individual in the sample is typically difficult to compute
using the approach of statistical sampling theory, but such issue is overcome in our case
by comparing the population and sample frequencies of each type. Moreover, the existing
literature assumes representative sampling, while we take into account the possibility that
different types may be selected with different probabilities beyond the non-randomness caused
by the sampling method and we respect the observed homophily patterns. This provides a
better estimate of the network statistics of interest if the types are correlated with network
positioning and/or predict who is connected to whom, two prevalent features of real-life social
networks. Last but not least, in contrast to the statistical sampling theory, the proposed
methodology does not rely on graph-based sampling designs and can be applied to e.g., samples
stratified on certain non-network characteristics, a common approach in the collection of
network data in, for example, Labor and Development Economics.

Other network statistics. For their theoretical and empirical relevance, this study focuses
on seven basic network properties: average degree, degree distribution, total clustering, graph
span, epidemic threshold, the maximal eigenvalue, and homophily index (Jackson et al., 2017).
Nevertheless, one can easily adapt the methodology to any other large-scale network measure




                                               41
that solely requires the knowledge of nodes’ local information.49 The examples include the
assortativity coefficient, the average size of the second-order neighborhood, network entropy,
or the average number of cycles of size four within nodes’ neighborhoods. Assortativity is
a common feature of network architectures and measures a correlation between the degrees
of connected nodes.50 Assortativity plays a crucial rule in diffusion: it can slow down or
enhance the disease transmission but also that of behaviors and social norms (Newman, 2002;
Jackson et al., 2017). Social networks typically exhibit positive assortativity, the tendency
of more connected individuals to be connected to more connected individual. In contrast,
many technological or biological networks exhibit negative correlations between the degrees
of connected individuals. Lee et al. (2006) show how to recover assortativity from samples
obtained through several sampling schemes. The average size of the second-order neighborhood
(compared to that of direct neighborhood) enables to assess how fast diffusion spreads and
it has also shown to be important in labour markets (Calvo-Armengol and Jackson, 2004).
Since the computation of both the assortativity coefficient and the second-order neighborhood
only requires the knowledge of one’s degree and the degree of her neighbors, ther weighted
corrections follow directly from Section 2.
    Other measures do not follow directly from Section 2, but our approach can still be ap-
plied. For instance, Eagle et al. (2010) apply the concept of network entropy that reflects the
diversity of connections of an individual to different groups (or types in the terminology of the
current paper) in the population. They report large economic advantages from belonging to
communities with geographically diversified distributions of contacts. Since their measure only
relies on the distribution of different types in the neighborhood of each node, the corrected
variation of this measure for sampled networks is straightforward. Similarly, cycles of size
four have recently received certain attention in Sociology (Opsahl, 2013), Physics (Yin et al.,
2018), and Economics (Espinosa et al., 2018). One can recover it following our approach using
the combinatorial logic. Since these characteristics are extensions of the ideas of homophily
and the clustering coefficient, respectively, we focus on the more common variations and do
not propose the corrections of these two in this study.
    These examples notwithstanding, the proposed methodology cannot be applied in other
cases. First, it does not allow to recover exactly global network measures computed on basis
of the whole network architecture such as the spectral properties, the average betweenness
or eigenvalue centrality, or network distances. However, as illustrated in Section 3, one can
overcome this problem by using approximations and bounds computed on basis of local infor-
mation. There is a rich literature proposing approximations of average and maximal distances
and bounds on the leading eigenvalue, and an emerging literature for other eigenvalues and
measures (see Sections 3.4 and 3.5 for references). Clearly, the proposed approach cannot re-
cover the network characteristics at the individual level. Similarly to the degree distribution,
one can propose recovery strategies for the distributions of, say, the clustering coefficient or
the homophily but not their values for one particular node. Whether and how the logic of our
methodology can be applied in these cases is left for future research.

Selection of (auxiliary) weighting variables. A natural question arising from the pro-
posed methodology is the choice of the (auxiliary) weighting variables. Our approach is based
  49
     In this paper, local information always refers to the first- and second-order neighborhoods of each node.
One can go further and incorporate more distant neighbors probably at the cost of lower precision of the
proposed corrections.
  50
     Assortativity can be understood as degree homophily.


                                                     42
  on the idea that individual heterogeneity and the observed part of the network provide valuable
  information about the missing part. The evidence supports this assumption and reveals that
  two types of correlations are of particular relevance: the positioning in a network correlates
  with a series of individual characteristics and similar people (or dissimilar as in, say, romantic
  networks) are more likely to be connected. However, the evidence also points out that different
  characteristics matter in different contexts and situations. For instance, Morelli et al. (2017)
  report that positive emotions explain positioning in network reflecting time sharing, while
  empathy plays a role in intimate networks of the same people describing trust and support.
  Similarly, firms will probably form ties differently if searching for providers, compared to in-
  novation collaborations. Hence, one has to know the particular application under study to
  assess which node-level characteristic might provide valuable information about the network
  and we prefer to refrain from making general recommendations regarding the application of
  particular variables.
      Practically speaking, most data sets we are aware of are restricted to a relatively small
  number of variables at the population level. Since our results show that the performance
  increases with more information and that applying variables that provide no information about
  the network does not affect the performance negatively, we would recommend to employ all
  the available information in such cases.
      If, in contrast, too many variables are available for weighting, one would like to avoid to
  having too many types and probably disregard some of them. In such a situation, the main
  problem would be to have too few observations in each stratified cell. It may increase the
  variance–and thus the efficiency–of the proposed weighting estimates of the characteristic un-
  der study and thus decrease the performance of the corrections. One straightforward solution
  is to apply the principal component analysis to filter the relevant independent information
  from a large number of potentially correlated variables. Another solution can be a simple two-
  step algorithm. Consider a set Z of population-level variables with z = |Z|. Denote w       e−i (G)
  the correction of a network statistics using all the available variables but i. Last, let θ ≥ 0
  be a (small) threshold chosen by the researcher. Then, we propose the following algorithm to
  eliminate some of the variables available at the population level:

Step 1: use all the available z variables and generate the correction w(G)
                                                                      e    of the network char-
        acteristic of interest;

                                           e−i (G). If |w(G)
Step 2: for each i = 1, 2, ..., z, compute w            e    −w
                                                              e−i (G)| ≤ θ, remove variable i.

      Despite its simplicity, the proposed algorithm targets several key features of the selection of
  the “right” variables. The main contribution of the proposed algorithm lies in eliminating the
  variables that either provide too little information for the network statistic of interest (where
  too little is determined by the researcher with choice of θ) or provide the same information as
  some other considered variable (thus providing too little additional information). Moreover,
  the algorithm selects endogenously the most suitable variables for each network statistic. As
  a result, different network statistics might be corrected with different variables.51
      As for θ, it represents a threshold to be decided by the researcher. It can be set to zero
  if the researcher would like to maintain all the information; alternatively, it can be set equal
    51
      This is an important issue as different features of network positioning are commonly explained by different
  individual characteristics. For instance, in the context of friendships, Branas-Garza et al. (2010) report that
  social-norm adherence explains one’s centrality but not the clustering coefficient whereas Kovářı́k and Van der
  Leij (2014) document that risk attitudes predict the clustering coefficient but not the centrality.


                                                         43
to any arbitrary (most likely) small number or computed on basis of a desirable percentage
improvement if the research would like to filter out only the most relevant variables. We
remain agnostic about the specific approach a researcher would take for a particular project.
We stress, however, that researchers should be aware of the inferential problem addressed here
and the general limits of assumed randomness of the network sampled. Given that sensitivity,
a variety of weights should be used to discover if results are sensitive to the random network
assumption. Such analysis should serve as a standard robustness check of empirical network
results, giving scholars confidence that the results reflect network effects and are not a figment
of the sampling strategy.




                                               44
References
Acemoglu, Daron, Vasco M Carvalho, Asuman Ozdaglar, and Alireza Tahbaz-Salehi (2012)
  “The network origins of aggregate fluctuations,” Econometrica, Vol. 80, pp. 1977–2016.

Alatas, Vivi, Abhijit Banerjee, Arun G Chandrasekhar, Rema Hanna, and Benjamin A Olken
  (2016) “Network structure and the aggregation of information: Theory and evidence from
  Indonesia,” American Economic Review, Vol. 106, pp. 1663–1704.

Ammermueller, Andreas and Jörn-Steffen Pischke (2009) “Peer effects in European primary
 schools: Evidence from the progress in international reading literacy study,” Journal of
 Labor Economics, Vol. 27, pp. 315–348.

Ballester, Coralio, Antoni Calvó-Armengol, and Yves Zenou (2006) “Who’s who in networks.
  Wanted: The key player,” Econometrica, Vol. 74, pp. 1403–1417.

Banerjee, Abhijit, Arun G Chandrasekhar, Esther Duflo, and Matthew O Jackson (2013) “The
  diffusion of microfinance,” Science, Vol. 341, p. 1236498.

      (2014) “Gossip: Identifying central individuals in a social network,” No. w20422
  NBER Working paper.

Bardoscia, Marco, Stefano Battiston, Fabio Caccioli, and Guido Caldarelli (2017) “Pathways
  towards instability in financial networks,” Nature Communications, Vol. 8, p. 14416.

Berg, Sven (2004) “Snowball samplingI,” Encyclopedia of statistical sciences, Vol. 12.

Bloch, Francis, Garance Genicot, and Debraj Ray (2008) “Informal insurance in social net-
  works,” Journal of Economic Theory, Vol. 143, pp. 36–58.

Boguñá, Marián, Romualdo Pastor-Satorras, and Alessandro Vespignani (2003) “Epidemic
  spreading in complex networks with degree correlations,” in Statistical mechanics of complex
  networks: Springer, pp. 127–147.

Bramoullé, Yann, Habiba Djebbari, and Bernard Fortin (2009) “Identification of peer effects
  through social networks,” Journal of Econometrics, Vol. 150, pp. 41–55.

Bramoullé, Yann and Rachel Kranton (2007) “Public goods in networks,” Journal of Economic
  Theory, Vol. 135, pp. 478–494.

Bramoullé, Yann, Rachel Kranton, and Martin D’amours (2014) “Strategic interaction and
  networks,” American Economic Review, Vol. 104, pp. 898–930.

Branas-Garza, Pablo, Ramón Cobo-Reyes, Marı́a Paz Espinosa, Natalia Jiménez, Jaromı́r
  Kovářı́k, and Giovanni Ponti (2010) “Altruism and social integration,” Games and Eco-
  nomic Behavior, Vol. 69, pp. 249–257.

Breza, Emily, Arun G Chandrasekhar, Tyler H McCormick, and Mengjie Pan (2017) “Using
  Aggregated Relational Data to feasibly identify network structure without network data,”
  No. w23491. NBER Working paper.



                                             45
Browne, Kath (2005) “Snowball sampling: using social networks to research non-heterosexual
  women,” International Journal of Social Research Methodology, Vol. 8, pp. 47–60.

Calvo-Armengol, Antoni and Matthew O Jackson (2004) “The effects of social networks on
  employment and inequality,” American Economic Review, Vol. 94, pp. 426–454.

Calvó-Armengol, Antoni, Eleonora Patacchini, and Yves Zenou (2009) “Peer effects and social
  networks in education,” Review of Economic Studies, Vol. 76, pp. 1239–1267.

Centola, Damon (2010) “The spread of behavior in an online social network experiment,”
  Science, Vol. 329, pp. 1194–1197.

        (2011) “An experimental study of homophily in the adoption of health behavior,”
  Science, Vol. 334, pp. 1269–1272.

Chandrasekhar, Arun G and Matthew O Jackson (2016) “A network formation model based
 on subgraphs,” arXiv:1611.07658v1.

Chandrasekhar,     Arun and Randall Lewis (2016) “Econometrics of sam-
 pled networks,”       Available at SSRN: https://ssrn.com/abstract=2660381 or
 http://dx.doi.org/10.2139/ssrn.2660381.

Chen, Xinlei, Yuxin Chen, and Ping Xiao (2013) “The impact of sampling and network topol-
 ogy on the estimation of social intercorrelations,” Journal of Marketing Research, Vol. 50,
 pp. 95–110.

Coleman, James S (1988) “Social capital in the creation of human capital,” American Journal
  of Sociology, Vol. 94, pp. S95–S120.

Comellas, F and S Gago (2007) “Spectral bounds for the betweenness of a graph,” Linear
  Algebra and its Applications, Vol. 423, pp. 74–80.

Conley, Timothy G and Christopher R Udry (2010) “Learning about a new technology:
  Pineapple in Ghana,” American Economic Review, Vol. 100, pp. 35–69.

Conti, Gabriella, Andrea Galeotti, Gerrit Mueller, and Stephen Pudney (2013) “Popularity,”
  Journal of Human Resources, Vol. 48, pp. 1072–1094.

Cowan, Robin and Nicolas Jonard (2004) “Network structure and the diffusion of knowledge,”
  Journal of Economic Dynamics and Control, Vol. 28, pp. 1557–1575.

Currarini, Sergio, Matthew O Jackson, and Paolo Pin (2009) “An economic model of friend-
 ship: Homophily, minorities, and segregation,” Econometrica, Vol. 77, pp. 1003–1045.

        (2010) “Identifying the roles of race-based choice and chance in high school friendship
  network formation,” Proceedings of the National Academy of Sciences, Vol. 107, pp. 4857–
  4861.

Das, Kinkar Ch and Pawan Kumar (2004) “Some new bounds on the spectral radius of graphs,”
 Discrete Mathematics, Vol. 281, pp. 149–161.



                                              46
De Giorgi, Giacomo, Michele Pellizzari, and Silvia Redaelli (2010) “Identification of social
  interactions through partially overlapping peer groups,” American Economic Journal: Ap-
  plied Economics, Vol. 2, pp. 241–275.

De Paula, Aureo (2017) “Econometrics of Network Models,” In B. Honoré, A. Pakes, M. Pi-
  azzesi, & L. Samuelson (Eds.), Advances in Economics and Econometrics: Eleventh World
  Congress (Econometric Society Monographs, pp. 268-323). Cambridge: Cambridge Univer-
  sity Press.

De Paula, Áureo, Imran Rasul, and Pedro Souza (2018) “Recovering social networks from
  panel data: Identification, simulations and an application,” working paper.

Dong, Jianping and Jeffrey S Simonoff (1994) “The construction and properties of bound-
 ary kernels for smoothing sparse multinomials,” Journal of Computational and Graphical
 Statistics, Vol. 3, pp. 57–66.

Eagle, Nathan, Michael Macy, and Rob Claxton (2010) “Network diversity and economic
  development,” Science, Vol. 328, pp. 1029–1031.

Echenique, Federico and Roland G Fryer (2007) “A measure of segregation based on social
  interactions,” Quarterly Journal of Economics, Vol. 122, pp. 441–485.

Elliott, Matthew and Benjamin Golub (2019) “A network approach to public goods,” Journal
  of Political Economy, Vol. 127, pp. 730–776.

Espinosa, M.P., J. Kovářı́k, and S. Ruiz-Palazuelos (2018) “Are close-knit communities good
  for employment and wages?” mimeo.

Faloutsos, Michalis, Petros Faloutsos, and Christos Faloutsos (1999) “On power-law relation-
  ships of the internet topology,” in ACM SIGCOMM computer communication review, Vol.
  29, pp. 251–262, ACM.

Fleming, Lee, Charles King III, and Adam I Juda (2007) “Small worlds and regional innova-
  tion,” Organization Science, Vol. 18, pp. 938–954.

Fortin, Bernard and Vincent Boucher (2015) “Some Challenges in the Empirics of the Effects
  of Networks,” in The Oxford Handbook of the Economics of Networks.

Frank, Ove (1977) “Survey sampling in graphs,” Journal of Statistical Planning and Inference,
  Vol. 1, pp. 235–264.

         (1980) “Estimation of the number of vertices of different degrees in a graph,” Journal
  of Statistical Planning and Inference, Vol. 4, pp. 45–50.

        (1981) “A survey of statistical methods for graph analysis,” Sociological Methodology,
  Vol. 12, pp. 110–155.

        (2005) “Network sampling and model fitting,” Models and Methods in Social Network
  Analysis, pp. 31–56.

Galeotti, Andrea, Sanjeev Goyal, Matthew O Jackson, Fernando Vega-Redondo, and Leeat
 Yariv (2010) “Network games,” Review of Economic Studies, Vol. 77, pp. 218–244.

                                              47
Goeree, Jacob K, Margaret A McConnell, Tiffany Mitchell, Tracey Tromp, and Leeat Yariv
 (2010) “The 1/d law of giving,” American Economic Journal: Microeconomics, Vol. 2, pp.
 183–203.
Golub, Benjamin and Matthew O Jackson (2010) “Naive learning in social networks and the
 wisdom of crowds,” American Economic Journal: Microeconomics, Vol. 2, pp. 112–49.
         (2012a) “Does homophily predict consensus times? Testing a model of network struc-
  ture via a dynamic process,” Review of Network Economics, Vol. 11.
        (2012b) “How homophily affects the speed of learning and best-response dynamics,”
  Quarterly Journal of Economics, Vol. 127, pp. 1287–1338.
Goyal, Sanjeev (2012) Connections: an introduction to the economics of networks: Princeton
 University Press.
Granovetter, Mark (1985) “Economic action and social structure: The problem of embedded-
  ness,” American Journal of Sociology, Vol. 91, pp. 481–510.
        (2005) “The impact of social structure on economic outcomes,” Journal of Economic
  Perspectives, Vol. 19, pp. 33–50.
Handcock, Mark S and Krista J Gile (2010) “Modeling social networks from sampled data,”
  Annals of Applied Statistics, Vol. 4, p. 5.
Heckathorn, Douglas D (1997) “Respondent-driven sampling: a new approach to the study of
  hidden populations,” Social Problems, Vol. 44, pp. 174–199.
Holt, D and TM Fred Smith (1979) “Post stratification,” Journal of the Royal Statistical
  Society. Series A (General), pp. 33–46.
Horvitz, Daniel G and Donovan J Thompson (1952) “A generalization of sampling without
  replacement from a finite universe,” Journal of the American Statistical Association, Vol.
  47, pp. 663–685.
Hu, Mandy, Chih-Sheng Hsieh, and Jianmin Jamie Jia (2014) “Predicting Social Influence
 Based on Dynamic Network Structures,” mimeo.
Huisman, Mark (2009) “Imputation of missing network data: Some simple procedures,” Jour-
 nal of Social Structure, Vol. 10, pp. 1–29.
Hyslop, Dean R and Guido W Imbens (2001) “Bias from classical and other forms of mea-
 surement error,” Journal of Business & Economic Statistics, Vol. 19, pp. 475–481.
Ibarra, Herminia (1992) “Homophily and differential returns: Sex differences in network struc-
  ture and access in an advertising firm,” Administrative Science Quarterly, pp. 422–447.
Jackson, Matthew O (2005) “A survey of network formation models: stability and efficiency,”
  Group Formation in Economics: Networks, Clubs, and Coalitions, pp. 11–49.
        (2008) “Average distance, diameter, and clustering in social networks with ho-
  mophily,” in International Workshop on Internet and Network Economics, pp. 4–11,
  Springer.

                                             48
         (2010a) “An overview of social networks and economic applications,” Handbook of
  Social Economics, Vol. 1, pp. 511–85.

        (2010b) Social and Economic Networks: Princeton university press.

Jackson, Matthew O, Tomas Rodriguez-Barraquer, and Xu Tan (2012) “Social capital and
  social quilts: Network patterns of favor exchange,” American Economic Review, Vol. 102,
  pp. 1857–1897.

Jackson, Matthew O and Brian W Rogers (2007) “Meeting strangers and friends of friends:
  How random are social networks?” American Economic Review, Vol. 97, pp. 890–915.

Jackson, Matthew O, Brian W Rogers, and Yves Zenou (2017) “The economic consequences
  of social-network structure,” Journal of Economic Literature, Vol. 55, pp. 49–95.

Jackson, Matthew O and Leeat Yariv (2007) “Diffusion of behavior and equilibrium properties
  in network games,” American Economic Review, Vol. 97, pp. 92–98.

Karlan, Dean, Markus Mobius, Tanya Rosenblat, and Adam Szeidl (2009) “Trust and social
 collateral,” Quarterly Journal of Economics, Vol. 124, pp. 1307–1361.

Kinnan, Cynthia and Robert Townsend (2012) “Kinship and financial networks, formal finan-
  cial access, and risk reduction,” American Economic Review, Vol. 102, pp. 289–293.

Kolaczyk, Eric D (2009) Statistical Analysis of Network Data: Methods and Models: Springer
 Science & Business Media.

Kossinets, Gueorgi (2006) “Effects of missing data in social networks,” Social Networks, Vol.
 28, pp. 247–268.

Kovárı́k, Jaromı́r, Pablo Brañas-Garza, Ramón Cobo-Reyes, Marı́a Paz Espinosa, Natalia
 Jiménez, and Giovanni Ponti (2012) “Prosocial norms and degree heterogeneity in social
 networks,” Physica A Statistical Mechanics and its Applications, Vol. 391, pp. 849–853.

Kovářı́k, Jaromı́r, Pablo Brañas-Garza, Michael W Davidson, Dotan A Haim, Shannon Car-
 celli, and James H Fowler (2017) “Digit ratio (2D: 4D) and social integration: an effect of
 prenatal sex hormones,” Network Science, Vol. 5, pp. 476–489.

Kovářı́k, Jaromı́r and Marco J Van der Leij (2014) “Risk aversion and social networks,” Review
 of Network Economics, Vol. 13, pp. 121–155.

Kremer, Michael and Edward Miguel (2007) “The illusion of sustainability,” Quarterly Journal
  of Economics, Vol. 122, pp. 1007–1065.

Lee, Sang Hoon, Pan-Jun Kim, and Hawoong Jeong (2006) “Statistical properties of sampled
  networks,” Physical Review E, Vol. 73, p. 016102.

Leider, Stephen, Markus M Möbius, Tanya Rosenblat, and Quoc-Anh Do (2009) “Directed
  altruism and enforced reciprocity in social networks,” Quarterly Journal of Economics, Vol.
  124, pp. 1815–1851.



                                              49
Little, Roderick JA (1993) “Post-stratification: a modeler’s perspective,” Journal of the Amer-
  ican Statistical Association, Vol. 88, pp. 1001–1012.

Liu, Xiaodong (2013) “Estimation of a local-aggregate network model with sampled networks,”
  Economics Letters, Vol. 118, pp. 243–246.

Lovász, László (2007) Combinatorial Problems and Exercises, Vol. 361: American Mathemat-
  ical Soc.

Manski, Charles F (1993) “Identification of endogenous social effects: The reflection problem,”
 Review of Economic Studies, Vol. 60, pp. 531–542.

McPherson, J Miller and Lynn Smith-Lovin (1987) “Homophily in voluntary organizations:
 Status distance and the composition of face-to-face groups,” American Sociological Review,
 pp. 370–379.

McPherson, Miller, Lynn Smith-Lovin, and James M Cook (2001) “Birds of a feather: Ho-
 mophily in social networks,” Annual Review of Sociology, Vol. 27, pp. 415–444.

Montgomery, James D (1991) “Social networks and labor-market outcomes: Toward an eco-
 nomic analysis,” American Economic Review, Vol. 81, pp. 1408–1418.

Moody, James (2001) “Race, school integration, and friendship segregation in America,”
 American Journal of Sociology, Vol. 107, pp. 679–716.

Morelli, Sylvia A, Desmond C Ong, Rucha Makati, Matthew O Jackson, and Jamil Zaki (2017)
 “Empathy and well-being correlate with centrality in different social networks,” Proceedings
 of the National Academy of Sciences, Vol. 114, pp. 9843–9847.

Newman, Mark EJ (2002) “Assortative mixing in networks,” Physical Review Letters, Vol. 89,
  p. 208701.

Opsahl, Tore (2013) “Triadic closure in two-mode networks: Redefining the global and local
 clustering coefficients,” Social Networks, Vol. 35, pp. 159–167.

Pastor-Satorras, Romualdo and Alessandro Vespignani (2002) “Immunization of complex net-
  works,” Physical Review E, Vol. 65, p. 036104.

Schilling, Melissa A and Corey C Phelps (2007) “Interfirm collaboration networks: The impact
  of large-scale network structure on firm innovation,” Management Science, Vol. 53, pp.
  1113–1126.

Snijders, Tom AB (1992) “Estimation on the basis of snowball samples: how to weight?”
  Bulletin of Sociological Methodology/Bulletin de Méthodologie Sociologique, Vol. 36, pp. 59–
  70.

Stork, Diana and William D Richards (1992) “Nonrespondents in communication network
  studies: Problems and possibilities,” Group & Organization Management, Vol. 17, pp. 193–
  209.




                                              50
Stumpf, Michael PH, Carsten Wiuf, and Robert M May (2005) “Subnets of scale-free networks
  are not scale-free: sampling properties of networks,” Proceedings of the National Academy
  of Sciences, Vol. 102, pp. 4221–4224.

Toomet, Ott, Marco Van Der Leij, and Meredith Rolfe (2013) “Social networks and labor
  market inequality between ethnicities and races,” Network Science, Vol. 1, pp. 321–352.

Valente, Thomas W (1996) “Network models of the diffusion of innovations,” Computational
  & Mathematical Organization Theory, Vol. 2, pp. 163–164.

Valliant, Richard (1993) “Poststratification and conditional variance estimation,” Journal of
  the American Statistical Association, Vol. 88, pp. 89–96.

Van Mieghem, Piet (2010) Graph Spectra for Complex Networks: Cambridge University Press.

Vega-Redondo, Fernando (2007) Complex Social Networks, No. 44: Cambridge University
  Press.

Walker, Stephen G (2011) “Bounds for the second largest eigenvalue of a transition matrix,”
 Linear and Multilinear Algebra, Vol. 59, pp. 755–760.

Watts, Duncan J and Steven H Strogatz (1998) “Collective dynamics of “small-world” net-
 works,” Nature, Vol. 393, pp. 440–442.

Whittington, Kjersten Bunker, Jason Owen-Smith, and Walter W Powell (2009) “Networks,
 propinquity, and innovation in knowledge-intensive industries,” Administrative Science
 Quarterly, Vol. 54, pp. 90–122.

Wooldridge, Jeffrey M (2015) Introductory Econometrics: A Modern Approach: Nelson Edu-
 cation.

Yin, Hao, Austin R Benson, and Jure Leskovec (2018) “Higher-order clustering in networks,”
  Physical Review E, Vol. 97, p. 052306.

Zhang, Yaonan, Eric D Kolaczyk, Bruce D Spencer et al. (2015) “Estimating network degree
  distributions under sampling: An inverse problem, with applications to monitoring social
  media networks,” The Annals of Applied Statistics, Vol. 9, pp. 166–199.




                                             51
                                                          Supplementary Appendix

A             Derivation of Corrections
                                         n
                                           
In the following derivations, we denote m    the number of all possible sample of size m from a
set of n nodes. We use I(A) to denote an indicator function which equals to 1 if the condition
A satisfies and 0 otherwise. We also use the notation o(1) to denote a term which converges
to zero when the sample size goes to infinity. All the derivations are based on Assumption 1.

A.1            Conditional expectation of the average degree
                                                                                                                                                                                             |s
For induced subgraphs, the conditional expectation of the sample average degree, d(Gr ), is
                                                                       !
                                       1 X       |s
 E(d(G|s
      r )|Gr )         =E                       Wij,r Gr
                                       mr i,j∈S
                                                      r
                                                                                                                                                       
     T                                                                                   T X
                                                                                           T
     X      1           X                                                          X           1              X                                
 =         
            mr                       Wij,r E I ti,j∈S r
                                                 i =tj =t
                                                           Gr 
                                                              +
                                                                                                    
                                                                                                     mr                         Wij,r E I tii,j∈S r
                                                                                                                                             =t,tj =`  Gr 
                                                                                                                                                          
     t=1              i,j∈Vr                                                             t=1 `6=t                   i,j∈Vr
                     ti =tj =t                                                                                    ti =t,tj =`
                                                                                                                                                                                                     
                                                      nr,t −2 Q       nr,q !                                                                       nr,t −1       nr,` −1                    nr,q
                                                                                                                                                                        Q                      !
     T                                                                         T T
     X      1         X                              mr,t −2   q6=t mr,q    XX 1                                       X                        mr,t −1       mr,` −1        q6=t,`      mr,q        
 =         
            mr                      Wij,r                QT     nr,q
                                                                           +
                                                                            
                                                                                   
                                                                                    mr                                              Wij,r                       QT         nr,q
                                                                                                                                                                                                       
                                                                                                                                                                                                        
     t=1              i,j∈Vr                               q=1       mr,q                       t=1 `6=t                 i,j∈Vr                                    q=1      mr,q
                     ti =tj =t                                                                                         ti =t,tj =`
                                                                                                                                                     
       T                                        T  T                                                                                               
   1 X     X           ψr,t (ψr,t + o(1)) 
                                           + 1
                                                 XX                                                                X                        ψr,t ψr,` 
 =             Wij,r                                                                                                          Wij,r                   .
   nr t=1 i,j∈V
                               ψr           nr t=1   
                                                                                                                i,j∈Vr
                                                                                                                                               ψr       
                                r                                                                    `6=t
                     ti =tj =t                                                                                ti =t,tj =`



 The conditional expectation of average degree for the star subgraph, d(Gsr ), is
                                                                     !
                                     1 X
E(d(Gsr )|Gr )       =E                        s
                                              Wij,r Gr
                                     mr i,j∈S
                                                  r
                                                                                                                                                                                                         
    T                                                                 T XT
    X      1          X                                       X       1                                                       X                                             
=         
           mr             Wij,r E I ti,j∈S
                                      i =tj
                                            r
                                            =t ∨ i or j∈Sr
                                                  ti =tj =t   Gr
                                                                  +
                                                                  
                                                                           
                                                                            mr                                                                Wij,r E I tii,j∈S r    i or j∈Sr
                                                                                                                                                           =t,tj =` ∨ ti =t,tj =`   Gr 
                                                                                                                                                                                       
    t=1              i,j∈V  r                                        t=1                                      `6=t                 i,j∈Vr
                   ti =tj =t                                                                                                     ti =t,tj =`
                                                                                                          
                                                                               Q                     
                                                      nr,t −2          nr,t −2                      nr,q
                                                                
  T
  X  1               X                               mr,t −2
                                                                    +2 m r,t −1     q6=t            mr,q   
=   
     mr                            Wij,r                           QT      nr,q
                                                                                                         
                                                                                                           
    t=1             i,j∈Vr                                               q=1      mr,q
                   ti =tj =t
                                                                                                                                                                                           
                                                                                nr,` −1                          nr,` −1
                                                                                                                                                              Q                      
                                                                    nr,t −1                         nr,t −1                          nr,t −1       nr,` −1                   nr,q
                                                                                                                                           
          T X
          X T
                      1               X                            mr,t −1       mr,` −1
                                                                                                +    mr,t          mr,` −1
                                                                                                                                 +   mr,t −1        mr,`           q6=t,`    mr,q       
     +               
                      mr                         Wij,r                                                          QT         nr,q
                                                                                                                                                                                      
                                                                                                                                                                                        
          t=1 `6=t                    i,j∈Vr                                                                         q=1     mr,q
                                    ti =t,tj =`
                                                                                                   
      T                 2
                        ψr,t + 2ψr,t (1 − ψr,t ) + o(1) 
                                                       
  1 X       X
=               Wij,r                                   
  nr t=1  i,j∈V                      ψr                 
                            r
                   ti =tj =t
                                                                                                                    
           T  T                                                                                                    
       1 XX                           X                      ψr,t ψr,` + ψr,` (1 − ψr,t ) + ψr,t (1 − ψr,` ) + o(1) 
     +                                           Wij,r                                                              .
       nr t=1   
                                      i,j∈Vr
                                                                                       ψr                            
                     `6=t
                                    ti =t,tj =`




                                                                                                        1
A.2        Estimating the degree distribution
This subsection first derives the corrections for degree counts under the induced subgraph
sampling outlined in Section 3.2 and then illustrates how to employ the methodology proposed
by Zhang et al. (2015) to estimate the degree distribution in non-representative samples.
    First, under the induced subgraph sampling, the probability that a node of type t with d
links to individuals of type ` 6= t in the population network Gr is selected and observed to
                                         |s
have d0 ≤ d links to type-` nodes in Gr corresponds to the joint probability that (i) the node
of type t is in the sample and (ii) d0 out of her d neighbors are in the sample. Formally,
                                                       d
                                                           nr,` −d 
                                   |s             mr,t d0   mr,` −d0
                                 Pr,t` (d0 , d) =          mr,`
                                                                
                                                  nr,t      n                    r,`

If the network is large enough and the sampling rates low enough,
                                              0                   0
                                    d mr,t mdr,` (nr,` − mr,` )d−d
                                                                     
                |s                                                     d        d0                0
               Pr,t` (d0 , d)    '   0                 d
                                                                    =   0
                                                                          ψr,t ψr,` (1 − ψr,` )d−d
                                    d nr,t            nr,`             d
For ` = t,
                                     d
                                         nr,t −1−d                          0               0
                |s              mr,t d0    mr,t −1−d0       d mr,t (mr,t − 1)d (nr,t − mr,t )d−d
               Pr,t` (d0 , d) =           mr,t −1     '
                                                           d0 nr,t
                                                   
                                nr,t       nr,t −1
                                                                             (nr,t − 1)d
                                 
                                 d                      0                      0
                              =    0
                                     ψr,t [ψr,t + o(1)]d [1 − (ψr,t + o(1))]d−d
                                 d
                   |s
Naturally, Pr,t` (d0 , d) = 0 for d0 > d.
   For the illustration of the methodology proposed by Zhang et al. (2015), consider the T 2
           |s                          s                                                      |s
matrices Pr,t` and the T matrices Pr,t    developed in Section 3.2 and remember that E[N t` (Gr )|Gr ] =
  |s                                      s
Pr,t` N t` (Gr ) and E[N t (Gsr )|Gr ] = Pr,t N t (Gr ). Since a naive inversion of the matrices a là Frank
(1980, 1981) is problematic, Zhang et al. (2015) propose a constrained, penalized weighted
                                                                                                 |s
least-squares estimation framework, which we extend as follows. N̂ (Gr ), Gr ∈ {Gr , Gsr }, is
the solution resulted from the following minimization problem:
                                                                −1
                                   min (P N − N )T C                 (P N − N ) + λ · pen(N )
                                     N
                                   s.t.   Ni ≥ 0, i = 0, 1, ..., υ(Gr ),
                                           υ t (Gr )
                                            X
                                                       Nit = nt , t ∈ {1, ..., T }.
                                             i=0

where N is the estimated vector of degree counts with an element Ni .1 P and N are re-
spectively the operator of the problem and the degree counts in the sampled graph (both
defined below) and C is (the approximation of) the covariance matrix of N . λ is a smoothing
parameter and pen(N ) reflects the penalty on the complexity of N .
                                                                                 |s
    In case of the induced graphs, consider N = [N t` (Gr )]t`∈T and N = [N t` (Gr )]t`∈T . The
operator P is constructed as follows:
   1
                   Pυt (Gr )
                               Nit = nt for each t implies that
                                                                         P
       Note that        i=0                                              i   Ni = n.


                                                                     2
                                               |s                          
                                               P11 0          ···     0
                                               0 P |s        ···     0     
                                                    12
                                           P = .
                                                                           
                                               .. ..         ..      ..    
                                                    .            .     .    
                                                                     |s
                                                0  0          · · · PT ×T
   Last, Zhang et al. (2015) show that, even though C |s = cov(N ) has non-zero off-diagonal
elements under the induced graph sampling, it is well approximated by a diagonal matrix2

                                             C |s = diag(N smooth ) + δ 1.                                                (1)
The term diag(N smooth ) in (1) is a diagonal matrix with the diagonal elements being equal
to the smoothed version of the observed degree counts N , for which they propose to employ
the smoothing method of Dong and Simonoff (1994). The second part of (1) ensures that the
approximation of C |s is positive definite. Zhang et al. (2015) discuss the choice of δ in detail.
    As for the star subgraph, N = [N t (Gr )]t∈T , N = [N t (Gsr )]t∈T , and
                                                            
                                          P1s 0 · · · 0
                                          0 Ps ··· 0 
                                                  2
                                   P =  ..               ..  .
                                                            
                                                .. . .
                                          .     .     .   . 
                                           0 0 · · · PTs
    Since the covariance matrix is diagonal under the star sampling scheme, no approximation
is necessary and

        ψ (1 − ψ )diag[N 1 (Gs )]                  0                ···                              0
                                                                                                                     
          r,1    r,1          r
                                                            2   s
                     0             ψ r,2 (1 − ψ r,2 )diag[N   (Gr )] ···                              0
   Cs =                                                                                                             .
                                                                                                                    
                     ..                             ..               ..                               ..
                           .                              .                    .                       .
                           0                              0                  ···     ψr,T (1 − ψr,T )diag[N T (Gsr )]

    For both sampling schemes, we refer to Zhang et al. (2015) for an exhaustive discussion
and analysis of the selection of both the smoothing parameter λ and the penalty function
pen(N ) in the above optimization problem. Under a convex penalty, the above minimization
problem belongs to the class of convex optimization problems and standard software can be
applied. Since Zhang et al. (2015) recommend the use of an `2 norm, the optimization becomes
a quadratic programming exercise.
                                                       |s
    The estimated degree counts N̂ (Gr ), Gr ∈ {Gr , Gsr }, are obtained by adding up the
                 |s
estimated N̂t` (Gr ) for the induced subgraph and N̂t (Gsr ) for the star network case.

A.3        Conditional expectation of clustering coefficient
The clustering coefficient of a graph is a ratio of the number of triangles to the number of
connected triples, calculated as c(Gr ) = τρ(G r)
                                            (Gr )
                                                  , where
                        XX X                                                       XX X
           ρ(Gr ) = 3                     Wij,r Wjk,r Wki,r and τ (Gr ) =                            Wij,r Wjk,r .
                        i∈Vr k>i j6=i,k                                            i∈Vr k>i j6=i,k

  2
      1 is an identity matrix of a size corresponding to the dimension of the problem.

                                                          3
                                                                                            |s
For induced subgraphs, the conditional expectation of ρ(Gr ) can be decomposed as follows,
                                                                                            
                                                                        |s    |s    |s
                                                     XX X
                  E(ρ(G|s
                       r )|Gr )       = E3                            Wij,r Wjk,r Wki,r   Gr 
                                                     i∈Sr k>i j6=i,k
                                                                                                 
                       T
                       X                                                        
                              XX X                               i,j,k∈Sr
                   =         3
                                   W ij,r W jk,r W ki,r E  I  ti =t j =tk =t   Gr
                                                                                    
                                                                                    
                       t=1        i∈Vr k>i j6=i,k
                                   ti =tj =tk =t
                                                                                                     
                     T X
                     X T                                                
                          XX X                          i,j,k∈Sr
                   +     3
                               Wij,r Wjk,r Wki,r E I ti =t j =t,tk =`
                                                                         Gr 
                                                                            
                       t=1 `6=t       i∈Vr k>i j6=i,k
                                       ti =tj =t,tk =`
                                                                                                     
                       T X
                       X T                                                       
                                   XX X                          i,j,k∈Sr
                   +              3
                                        Wij,r Wjk,r Wki,r E I tj =t k =t,ti =`
                                                                                  Gr 
                                                                                     
                       t=1 `6=t       i∈Vr k>i j6=i,k
                                       tj =tk =t,ti =`
                                                                                                     
                       T X
                         T                                                      
                                          |s    |s    |s
                       X           XX X                          i,j,k∈Sr
                   +              3
                                        Wij,r Wjk,r Wki,r E I ti =tk =t,tj =`
                                                                                 Gr 
                                                                                    
                       t=1 `6=t       i∈Vr k>i j6=i,k
                                       ti =tk =t,tj =`
                                                                                                          
                       T X
                       X T        T
                                  X                                                              
                                          XX X                                i,j,k∈Sr
                   +                     3
                                               W ij,r W jk,r W ki,r E  I t i =t,t j =`,t k =h   Gr
                                                                                                     .
                                                                                                     
                       t=1 `6=t h6=t,`        i∈Vr k>i j6=i,k
                                             ti =t,tj =`,tk =h



When three individuals are of the same type, i.e., ti = tj = tk = t, we have
                                                 nr,t −3 Q        nr,q
                                                                      !
                            i,j,k∈Sr
                                               mr,t −3   q6 =t mr,q
                    E I ti =t  j =tk =t
                                         Gr =        QT     nr,q
                                                                         .
                                                                                     q=1 mr,q


When two individuals are of the same type and the third is of a different type, including
ti = tj = t and tk = `; tj = tk = t and ti = `; and ti = tk = t and tj = `,
                                                                                          
                   i,j,k∈Sr                         i,j,k∈Sr                        i,j,k∈Sr
          E I ti =t  j =t,tk =`  G  r   = E  I   tj =t k =t,t i =`  Gr   = E  I  ti =tk =t,tj =`  Gr
                nr,t −2
                         nr,` −1  Q       nr,q !
                                                
                 mr,t −2      mr,` −1         q6=t,`      mr,q
           =                 QT       nr,q
                                                                      .
                                  q=1 mr,q


When three individuals are of different types, i.e., ti = t, tj = `, tk = h,
                                           nr,t −1
                                                    nr,` −1  nr,h −1  Q                                nr,q
                                                                                                                 !
                                                                       q6=t,`,h
                   i,j,k∈Sr                mr,t −1   mr,` −1 mr,h −1                                      mr,q
          E I ti =t,t j =`,tk =h
                                  Gr =                     QT       nr,q
                                                                                                                     .
                                                                                       q=1 mr,q




                                                                           4
Therefore, we can further obtain

E(ρ(G|s
     r )|Gr ) =
                                                                                                                                             
    T
    X                                                                            T X
                                                                                   T
           XX X                    3                                          X           XX X                    2              
=         3
                Wij,r Wjk,r Wki,r ψr,t        +
                                        + o(1)                                             3
                                                                                                  Wij,r Wjk,r Wki,r ψr,t ψr,` + o(1) 
                                                                                                                                      
    t=1        i∈Vr k>i j6=i,k                                                   t=1 `6=t        i∈Vr k>i j6=i,k
                ti =tj =tk =t                                                                     ti =tj =t,tk =`
                                                                                                                                                     
    T X
    X T                                                                                     T X
                                                                                              T
                XX X                    2                                                X            XX X                    2              
+              3
                     Wij,r Wjk,r Wki,r ψr,t             +
                                             ψr,` + o(1)                                               3
                                                                                                              Wij,r Wjk,r Wki,r ψr,t ψr,` + o(1) 
                                                                                                                                                  
    t=1 `6=t       i∈Vr k>i j6=i,k                                                          t=1 `6=t         i∈Vr k>i j6=i,k
                    tj =tk =t,ti =`                                                                           ti =tk =t,tj =`
                                                                                      
    T X
    X T X
        T
           XX X                                    
+         3
                Wij,r Wjk,r Wki,r (ψr,t ψr,` ψr,h )
                                                    .
    t=1 `6=t h6=t,`         i∈Vr k>i j6=i,k
                           ti =t,tj =`,tk =h


                                                                                                 |s
 The conditional expectation of the denominator τ (Gr ) has the following form:
                                                                  
                                                  |s    |s
                               XX X
E(τ (G|s
      r )|Gr )     = E                          Wij,r Wjk,r     Gr 
                               i∈Sr k>i j6=i,k
                                                                                                                                                 
    T
    X                                                   XT X
                                                                T                                              
          X X X                        i,j,k∈Sr
                                                                  X X X                        i,j,k∈Sr
=         
                W ij,r W jk,r E  I  ti =t j =t k =t   Gr
                                                           +
                                                           
                                                                  
                                                                        W ij,r W jk,r E  I  ti =tj =t,t k =`  Gr
                                                                                                                   
                                                                                                                   
    t=1    i∈Vr k>i j6=i,k                                                            t=1 `6=t        i∈Vr k>i j6=i,k
            ti =tj =tk =t                                                                              ti =tj =t,tk =`
                                                                                                                                                     
  T X
  X T                                          XT X
                                                       T                                        
      X X X                    i,j,k∈Sr
                                                         X X X                    i,j,k∈Sr
+     
            Wij,r Wjk,r E I tj =t k =t,ti =`
                                               Gr 
                                                  +
                                                         
                                                               Wij,r Wjk,r E I ti =tk =t,tj =`
                                                                                                 Gr 
                                                                                                    
    t=1 `6=t     i∈Vr k>i j6=i,k                                                            t=1 `6=t        i∈Vr k>i j6=i,k
                  tj =tk =t,ti =`                                                                            ti =tk =t,tj =`
                                                                                               
  T X
  X T X
      T                                           
        X X X                     i,j,k∈Sr
+       
              Wij,r Wjk,r E I ti =t,t j =`,tk =h
                                                   Gr 
                                                      .
    t=1 `6=t h6=t,`     i∈Vr k>i j6=i,k
                       ti =t,tj =`,tk =h



 When three individuals are of the same type, i.e., ti = tj = tk = t, we have
                                                  nr,t −3 Q        nr,q
                                                                       !
                             i,j,k∈Sr
                                                m r,t −3  q6 =t m r,q
                     E I ti =t  j =tk =t
                                          Gr =        QT     nr,q
                                                                          .
                                                                                                    q=1 mr,q


When two individuals are of the same type and the third is of a different type, including
ti = tj = t and tk = `; tj = tk = t and ti = `; and ti = tk = t and tj = `,
                                                                                           
                   i,j,k∈Sr                            i,j,k∈Sr                      i,j,k∈Sr
          E I ti =t  j =t,tk =`
                                   G  r   = E  I    tj =tk =t,ti =`  Gr   = E  I  ti =tk =t,tj =`  Gr
                nr,t −2     nr,` −1           nr,q
                                    Q             !
                            mr,t −2      mr,` −1        q6=t,`    mr,q
                   =                    QT         nr,q
                                                                            .
                                               q=1 mr,q


When three individuals are of different types, i.e., ti = t, tj = `, tk = h,
                                           nr,t −1
                                                    nr,` −1  nr,h −1  Q                                                      nr,q
                                                                                                                                       !
                                                                       q6=t,`,h
                   i,j,k∈Sr                mr,t −1 mr,` −1 mr,h −1                                                              mr,q
          E I ti =t,t j =`,tk =h
                                  Gr =                     QT       nr,q
                                                                                                                                           .
                                                                                                        q=1 mr,q




                                                                                  5
Therefore,

   E(τ (G|s
         r )|Gr ) =
                                                                                                                                      
   T
   X                                                                       T X
                                                                             T
          X X X              3                                          X          X X X              2              
          
                Wij,r Wjk,r ψr,t        +
                                  + o(1)                                             
                                                                                            Wij,r Wjk,r ψr,t ψr,` + o(1) 
                                                                                                                          
    t=1    i∈Vr k>i j6=i,k                                                 t=1 `6=t       i∈Vr k>i j6=i,k
            ti =tj =tk =t                                                                  ti =tj =t,tk =`
                                                                                                                                                     
        T X
        X T                                                                               T X
                                                                                            T
                   X X X              2                                                X          X X X              2              
    +              
                         Wij,r Wjk,r ψr,t ψr,` + o(1) 
                                                       +
                                                                                                     
                                                                                                           Wij,r Wjk,r ψr,t ψr,` + o(1) 
                                                                                                                                         
        t=1 `6=t    i∈Vr k>i j6=i,k                                                       t=1 `6=t       i∈Vr k>i j6=i,k
                     tj =tk =t,ti =`                                                                      ti =tk =t,tj =`
                                                                                     
        T X
        X T X
            T
              X X X                              
    +         
                                                 .
                     Wij,r Wjk,r (ψr,t ψr,` ψr,h )
        t=1 `6=t h6=t,`      i∈Vr k>i j6=i,k
                            ti =t,tj =`,tk =h


                                                                                |s                       |s                   |s                   |s
 The resutling conditional expectation of c(Gr ) is E(c(Gr |Gr )) = E(ρ(Gr )|Gr )/E(τ (Gr )|Gr ).
                                                                |s
If ψr,t = ψr,` = ψr,h , the above result will collapse to E(ρ(Gr |Gr )) = (ψr3 + o(1))ρ(Gr ) and
        |s                                       |s
E(τ (Gr |Gr )) = (ψr3 + o(1))τ (Gr ) and E(c(Gr )|Gr ) = c(Gr ), the results derived in Chan-
                                              |s
drasekhar and Lewis (2016). However, c(Gr ) would be a biased estimator of c(Gr ) in non-
representative samples.
   For star subgraphs, the conditional expectation of the sample number of triangles is
                                                                                 
                                     XX X
  E(ρ(Gsr )|Gr ) = E  3                                s
                                                       Wij,r  s
                                                             Wjk,r  s
                                                                   Wki,r Gr 
                                     i∈Sr k>i j6=i,k
                                                                                                                                  
                           T
                           X                                                                   
                              XX X
                       =     3
                                   Wij,r Wjk,r Wki,r E I ti i,j,k∈S
                                                             =tj =tk =t ∨
                                                                    r     any two of i,j,k∈Sr
                                                                             ti =tj =tk =t      Gr 
                                                                                                   
                           t=1        i∈Vr k>i j6=i,k
                                       ti =tj =tk =t
                                                                                                                                             
                                 T X
                                 X T                                                                              
                                             XX X                          i,j,k∈Sr
                           +                3
                                                  Wij,r Wjk,r Wki,r E I ti =t j =t,tk =`
                                                                                          ∨ anytitwo of i,j,k∈Sr
                                                                                                  =tj =t,tk =`     Gr 
                                                                                                                      
                                 t=1 `6=t       i∈Vr k>i j6=i,k
                                                 ti =tj =t,tk =`
                                                                                                                      
                                 T X
                                 X T                                                                              
                                             XX X                          i,j,k∈Sr
                                                                                          ∨ anytjtwo of i,j,k∈Sr
                                                                                                                       
                           +                3
                                                  Wij,r Wjk,r Wki,r E I tj =t k =t,ti =`         =tk =t,ti =`     Gr 
                                 t=1 `6=t       i∈Vr k>i j6=i,k
                                                 tj =tk =t,ti =`
                                                                                                                      
                                 T X
                                 X T                                                                              
                                             XX X                          i,j,k∈Sr
                                                                                          ∨ anytitwo of i,j,k∈Sr
                                                                                                                       
                           +                3
                                                  Wij,r Wjk,r Wki,r E I ti =t k =t,tj =`         =tk =t,tj =`     Gr 
                                 t=1 `6=t       i∈Vr k>i j6=i,k
                                                 ti =tk =t,tj =`
                                                                                                                                                       
                             T X
                             X T X
                                 T                                                                         
                                    XX X                           i,j,k∈Sr
                           +       3
                                         Wij,r Wjk,r Wki,r E I ti =t,t j =`,tk =h
                                                                                   ∨ any  two of i,j,k∈Sr
                                                                                       ti =t,tj =`,tk =h    Gr 
                                                                                                               .
                                 t=1 `6=t h6=t,`        i∈Vr k>i j6=i,k
                                                       ti =t,tj =`,tk =h




When three individuals are of the same type, i.e., ti = tj = tk = t, we have
                                                                                Q                                                         
                                                          nr,t −3        nr,t −3                                                       nr,q
                                                                  
                                                                    +3                q6=t
            i,j,k∈Sr      any two of i,j,k∈Sr           mr,t −3 Q mr,t −2                                                            mr,q
                                                  
     E I ti =t j =tk =t ∨    ti =tj =tk =t      Gr   =                 T       nr,q
                                                                                                                                              .
                                                                                                                   q=1 mr,q




                                                                                  6
When two individuals are of the same type and the third is of a different type, including
ti = tj = t and tk = `; tj = tk = t and ti = `; and ti = tk = t and tj = `,
                                                                                                 
       i,j,k∈Sr
E I ti =tj =t,tk =`
                     ∨ anytitwo of i,j,k∈Sr
                             =tj =t,tk =`
                                                           i,j,k∈Sr
                                               Gr = E I tj =t k =t,ti =`
                                                                         ∨ anytjtwo of i,j,k∈Sr
                                                                                 =tk =t,ti =`       Gr
                                                                nr,` −1                   nr,` −1                          Q                
                                                        nr,t −2                     nr,t −2                   nr,t −2     nr,` −1            nr,q
                                                                                                                      
                                                    m r,t −2    m     −1
                                                                             +2 m     r,t −1   m     −1
                                                                                                          + m  r,t −2      mr,`     q6=t,`   mr,q
          i,j,k∈Sr
                       ∨ anytitwo of i,j,k∈Sr                         r,`                        r,`
=E I ti =t  k =t,tj =`         =tk =t,tj =`     Gr =                                         QT       nr,q
                                                                                                                                                   .
                                                                                                  q=1   mr,q



When three individuals are of different types, i.e., ti = t, tj = `, tk = h,
                                                 
        i,j,k∈Sr         any two of i,j,k∈Sr
E I ti =t,t j =`,tk =h
                       ∨   ti =t,tj =`,tk =h    G r

     T              ! −1                                                                          
    Y         nr,q                  nr,t − 1      nr,` − 1    nr,h − 1       nr,t − 1     nr,` − 1      nr,h − 1
 =                                                                      +
    q=1
              mr,q                 mr,t − 1 mr,` − 1 mr,h − 1                mr,t − 1      mr,`         mr,h − 1
                                                                                    Y              #
              nr,t − 1      nr,` − 1         nr,h − 1       nr,t − 1    nr,` − 1     nr,h − 1               nr,q
       +                                                +
                mr,t        mr,` − 1 mr,h − 1               mr,t − 1 mr,` − 1         mr,h        q6=t,`,h
                                                                                                            mr,q

Therefore, we can further obtain
                                                                                                 
                 T
                 X  XX X
E(ρ(Gsr )|Gr ) =                             3       2                     
                   3
                         Wij,r Wjk,r Wki,r ψr,t + 3ψr,t (1 − ψr,t ) + o(1) 
                                                                            
                     t=1        i∈Vr k>i j6=i,k
                                 ti =tj =tk =t
                                                                                                                    
      T X
      X T
                  XX X                    2                                   2                     
  +              3
                       Wij,r Wjk,r Wki,r ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` ) + o(1) 
                                                                                                      
      t=1 `6=t       i∈Vr k>i j6=i,k
                      ti =tj =t,tk =`
                                                                                                                    
      T X
      X T
                  XX X                    2                                   2                     
  +              3
                       Wij,r Wjk,r Wki,r ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` ) + o(1) 
                                                                                                      
      t=1 `6=t       i∈Vr k>i j6=i,k
                      tj =tk =t,ti =`
                                                                                                                    
      T X
      X T
                  XX X                    2                                   2                     
  +              3
                       Wij,r Wjk,r Wki,r ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` ) + o(1) 
                                                                                                      
      t=1 `6=t       i∈Vr k>i j6=i,k
                      ti =tk =t,tj =`
                                                                                                                                                    
    T X
    X T X
        T
           XX X                                                                                                         
  +       3
                Wij,r Wjk,r Wki,r (ψr,t ψr,` ψr,h + (1 − ψr,t )ψr,` ψr,h + ψr,t (1 − ψr,` )ψr,h + ψr,t ψr,` (1 − ψr,h ))
                                                                                                                         .
      t=1 `6=t h6=t,`        i∈Vr k>i j6=i,k
                            ti =t,tj =`,tk =h




                                                                      7
 The conditional expectation of τ (Gsr ) is:
                                                                  
                             XX X
E(τ (Gsr )|Gr )   = E                          s
                                               Wij,r  s
                                                     Wjk,r    Gr 
                             i∈Sr k>i j6=i,k
                                                                                                                           
                      T
                      X                                                                                         
                            X X X                        i,j,k∈Sr       any two of i,j,k∈Sr     only j∈Sr
                  =         
                                  W ij,r W jk,r E  I  ti =t j =t k =t ∨    t i =tj =t k =t  ∨ t i =tj =t k =t  Gr
                                                                                                                    
                                                                                                                    
                      t=1     i∈Vr k>i j6=i,k
                               ti =tj =tk =t
                                                                                                                                      
                        T X
                        X T                                                                                  
                            X X X                    i,j,k∈Sr
                      +     
                                  Wij,r Wjk,r E I ti =t j =t,tk =`
                                                                    ∨ anytitwo of i,j,k∈Sr
                                                                            =tj =t,tk =`   ∨ tionly j∈Sr
                                                                                               =tj =t,tk =`   Gr 
                                                                                                                 
                            t=1 `6=t     i∈Vr k>i j6=i,k
                                          ti =tj =t,tk =`
                                                                                                                                      
                            T X
                            X T                                                                                         
                                       X X X                    i,j,k∈Sr
                      +                
                                             Wij,r Wjk,r E I tj =t k =t,ti =`
                                                                               ∨ anytjtwo of i,j,k∈Sr
                                                                                       =tk =t,ti =`   ∨ tjonly j∈Sr
                                                                                                          =tk =t,ti =`   Gr 
                                                                                                                            
                            t=1 `6=t     i∈Vr k>i j6=i,k
                                          tj =tk =t,ti =`
                                                                                                                                      
                            T X
                            X T                                                                                                
                                       X X X                        i,j,k∈Sr        any two of i,j,k∈Sr       only j∈Sr
                      +                
                                             W ij,r W jk,r E  I  ti =tk =t,t j =` ∨   ti =t k =t,t j =` ∨ t i =tk =t,t j =`   Gr
                                                                                                                                   
                                                                                                                                   
                            t=1 `6=t     i∈Vr k>i j6=i,k
                                          ti =tk =t,tj =`
                                                                                                                                                
                            T X
                            X T        T
                                       X                                                                                                       
                                              X X X                         i,j,k∈Sr          any two of i,j,k∈Sr           only j∈Sr
                      +                       
                                                    W ij,r W jk,r E  I  ti =t,t j =`,t k =h ∨   t i =t,t j =`,t k =h ∨ t i =t,t j =`,t k =h   Gr
                                                                                                                                                   .
                                                                                                                                                   
                            t=1 `6=t h6=t,`     i∈Vr k>i j6=i,k
                                               ti =t,tj =`,tk =h



When the three individuals involved are of the same type, i.e., ti = tj = tk = t, we have
                                                                                                     Q                                               
                                                                  nr,t −3       nr,t −3       nr,t −3                                             nr,q
                                                                                       
                                                                            + 3           +                q6=t
       i,j,k∈Sr
                   ∨ any ttwo of i,j,k∈Sr
                                          ∨ tionly j∈Sr         mr,t −3        mr,t −2      mr,t −1                                              mr,q
                                                           
E I ti =t j =tk =t        i =tj =tk =t         =tj =tk =t Gr =                     QT       nr,q
                                                                                                                                                        .
                                                                                                                   q=1 mr,q


When two individuals are of the same type and the third is of a different type that ti = tj = t
and tk = ` or tj = tk = t and ti = `
                                                                       
        i,j,k∈Sr          any two of i,j,k∈Sr        only j∈Sr
E I ti =tj =t,tk =` ∨ ti =tj =t,tk =` ∨ ti =tj =t,tk =` Gr
                                                                             
              i,j,k∈Sr         any two of i,j,k∈Sr        only j∈Sr
 = E I tj =t     k =t,ti =`
                            ∨     tj =tk =t,ti =`    ∨  tj =tk =t,ti =`    G  r
                                                                                              nr,` −1 Q             
        nr,t −2      nr,` −1          nr,t −2     nr,` −1         nr,t −2
                                                                       nr,` −1   nr,t −2                      nr,q
        mr,t −2 mr,` −1
                               +   2  mr,t −1 mr,` −1
                                                            +    mr,t −2       mr,`
                                                                                     + mr,t −1    mr,`       t6=t,` mr,q
 =                                                          QT         nr,q
                                                                                                                         ;
                                                                           q=1 mr,q


and for ti = tk = t and tj = `,
                                                                        
         i,j,k∈Sr       any two of i,j,k∈Sr          only j∈Sr
E I ti =t  k =t,tj =`
                      ∨     ti =tk =t,tj =`     ∨ ti =tk =t,tj =`    G   r
                                                                                                                         Q                 
           nr,t −2    nr,` −1           nr,t −2    nr,` −1         nr,t −2
                                                                         nr,` −1                 nr,t −2
                                                                                                                 nr,` −1               nr,q
           mr,t −2 mr,` −1
                                 +2 m     r,t −1   m  r,` −1
                                                              +    m r,t −2      mr,`
                                                                                       +                mr,t      mr,` −1        t6=t,` mr,q
  =                                                           QT         nr,q
                                                                                                                                               
                                                                            q=1 mr,q




                                                                             8
Last, when the three individuals are of different types, i.e., ti = t, tj = `, tk = h,
                                                                      
         i,j,k∈Sr        any two of i,j,k∈Sr         only j∈Sr
E I ti =t,t j =`,tk =h
                       ∨   ti =t,tj =`,tk =h  ∨  ti =t,tj =`,tk =h   G r

       T            ! −1                                                                                  
      Y       nr,q                  nr,t − 1        nr,` − 1        nr,h − 1          nr,t − 1     nr,` − 1     nr,h − 1
  =                                                                               +
      q=1
              mr,q                 mr,t − 1 mr,` − 1 mr,h − 1                         mr,t − 1       mr,`       mr,h − 1
                                                                                                         
                            nr,t − 1         nr,` − 1         nr,h − 1           nr,t − 1     nr,` − 1     nr,h − 1
                        +                                                  +
                               mr,t          mr,` − 1 mr,h − 1                   mr,t − 1 mr,` − 1          mr,h
                                                                   Y               #
                            nr,t − 1         nr,` − 1         nr,h − 1                nr,q
                        +                                                                     .
                               mr,t          mr,` − 1           mr,h        q6=t,`,h
                                                                                      mr,q

Therefore, we obtain the following:
                                                                                                           
                    T
                    X     X X X
E(τ (Gsr )|Gr ) =                             3       2
                                                          (1 − ψr,t ) + ψr,t (1 − ψr,t )2 + o(1) 
                                                                                                
                          
                                Wij,r Wjk,r ψr,t + 3ψr,t                                        
                    t=1       i∈Vr k>i j6=i,k
                               ti =tj =tk =t
                                                                                                                       
                T X
                X T
                    X X X              2                                   2                     
              +     
                          Wij,r Wjk,r ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` ) + o(1) 
                                                                                                   
                    t=1 `6=t       i∈Vr k>i j6=i,k
                                    ti =tj =t,tk =`
                                                                                                                       
                T X
                X T
                    X X X              2                                   2                     
              +     
                          Wij,r Wjk,r ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` ) + o(1) 
                                                                                                   
                    t=1 `6=t       i∈Vr k>i j6=i,k
                                    tj =tk =t,ti =`
                                                                                                                                          
                    T X
                    X T
                               X X X              2                                   2
                                                                                           (1 − ψr,` ) + (1 − ψr,t )2 ψr,` + o(1) 
                                                                                                                                 
              +                
                                     Wij,r Wjk,r ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t                                        
                    t=1 `6=t       i∈Vr k>i j6=i,k
                                    ti =tk =t,tj =`
                                      
                    T X
                    X T         T
                                X                          
                                      X X X
              +                       
                                            W ij,r W jk,r  ψr,t ψr,` ψr,h + (1 − ψr,t )ψr,` ψr,h + ψr,t (1 − ψr,` )ψr,h
                    t=1 `6=t h6=t,`      i∈Vr k>i j6=i,k
                                        ti =t,tj =`,tk =h
                                                                                                                                   !
                                                                                                                                  
                                                                          + ψr,t ψr,` (1 − ψr,h ) + (1 − ψr,t )ψr,` (1 − ψr,h )        .


 Again, the corrections based on random samples in Chandrasekhar and Lewis (2016) are spe-
cial cases of these expressions. Chandrasekhar and Lewis (2016) show that E[ρ(Gsr |Gr )] =
(3ψr2 (1 − ψr ) + ψr3 + o(1)ρ(Gr ) and E[τ (Gsr |Gr )] = (ψr (1 − ψr )2 + 3ψr2 (1 − ψr ) + ψr3 +
o(1))τ (Gr ). Therefore, the analytically corrected estimator for c(Gr ) based on Gsr is c̃(Gsr ) =
              −1
   ψr (3−2ψr )
  1+ψr (1−ψr )
                   c(Gsr ).

A.4        Conditional expectation of epidemic threshold
There is one version of epidemic threshold condition based on the mean-field approxima-
tion (Pastor-Satorras and Vespignani, 2002), which is stated as
                                         1
                                           P        P
                                              i∈Vr         Wij,r
                                        nr
                             T hrldr = 1 P         P j∈Vr          2
                                                                     .
                                       nr   i∈V r
                                                  (  j∈V r
                                                           W ij,r )


                                                                     9
The numerator is the average degree denoted by d(Gr ) and the denominator is average of
degree square denoted by ds(Gr ). The corrections of d(Gr ) are derived in section A.1. Here
we discuss the correction of ds(Gr ). Since
                                                                   !2
                             1 X                    X                         1 X              1 XXX
                   ds(Gr ) =                               Wij,r          =            Wij,r +                 Wij,r Wik,r
                             nr i∈V                 j∈Vr
                                                                              nr i,j∈V         nr i∈V j∈V k6=j
                                             r                                         r                         r      r

                                          1 XXX
                               = d(Gr ) +                 Wij,r Wik,r ,
                                          nr i∈V j∈V k6=j
                                                               r   r


we only need to consider the second term in the above equation.
   For induced subgraph,
                                  
   1   X X X |s            |s
E                  Wij,r Wik,r Gr 
   mr i∈S j∈S
         r   r k6=j
                                                                                                                                                
    T                                                                                  T X
                                                                                         T
    X      1 X XX                                                                X           1 X XX               
                                                                                                                              i,j,k∈Sr
                                                                                                                                               
=         
           mr     Wij,r Wik,r E I ti i,j,k∈Sr
                                      =tj =tk =t     +
                                                  Gr                                             
                                                                                                   mr     Wij,r Wik,r E I ti =t j =t,tk =`
                                                                                                                                              Gr 
                                                                                                                                                 
    t=1            i∈Vr j∈Vr k6=j                                                      t=1 `6=t           i∈Vr j∈Vr k6=j
                    ti =tj =tk =t                                                                          ti =tj =t,tk =`
                                                                                                                                                    
    T X
      T                                                                    T XT
    X           1 X XX                      
                                                   i,j,k∈Sr
                                                                      X       1 X XX                      
                                                                                                                    i,j,k∈Sr
                                                                                                                                     
+              
                mr         W ij,r W ik,r E  I  tj =t k =t,t i =`  Gr
                                                                       +
                                                                       
                                                                                
                                                                                 mr         W ij,r W ik,r E  I  ti =tk =t,t j =`  Gr
                                                                                                                                       
                                                                                                                                       
    t=1 `6=t        i∈V j∈V r    r k6=j                                   t=1        i∈V j∈V       `6=t              r    r k6=j
                        tj =tk =t,ti =`                                                                          ti =tk =t,tj =`
                                                                                             
    T X
      T X
        T
    X                  1   X XX                    
                                                           i,j,k∈Sr
                                                                              
+                                 W ij,r W ik,r E  I  ti =t,t j =`,t k =h  Gr
                                                                                .
    t=1 `6=t h6=t,`
                       mr i∈V j∈V                                              
                                  r    r k6=j
                             ti =t,tj =`,tk =h



When three individuals are of the same type, i.e., ti = tj = tk = t, we have
                                                 nr,t −3 Q        nr,q
                                                                      !
                            i,j,k∈Sr
                                               mr,t −3   q6=t mr,q
                    E I ti =t  j =tk =t
                                         Gr =        QT     nr,q
                                                                         .
                                                                                              q=1 mr,q


When two individuals are of the same type and the third is of a different type, including
ti = tj = t and tk = `; tj = tk = t and ti = `; and ti = tk = t and tj = `,
                                                                                        
                   i,j,k∈Sr                         i,j,k∈Sr                      i,j,k∈Sr
          E I ti =t  j =t,tk =`
                                 G  r   = E  I   tj =tk =t,ti =`  Gr   = E  I  ti =tk =t,tj =`  Gr
                nr,t −2
                         nr,` −1  Q       nr,q !
                                                
                           mr,t −2        mr,` −1      q6=t,`      mr,q
                   =                      QT    nr,q
                                                                             .
                                            q=1 mr,q


When three individuals are of different types, i.e., ti = t, tj = `, tk = h,
                                           nr,t −1
                                                    nr,` −1  nr,h −1  Q                                                         nr,q
                                                                                                                                          !
                                                                       q6=t,`,h
                   i,j,k∈Sr                mr,t −1 mr,` −1 mr,h −1                                                                 mr,q
          E I ti =t,t j =`,tk =h
                                  Gr =                     QT       nr,q
                                                                                                                                              .
                                                                                                   q=1 mr,q




                                                                                  10
Therefore,
                                  
   1   X X X |s            |s
E                  Wij,r Wik,r Gr 
   mr i∈S j∈S
         r   r k6=j
                                                                                                     
       T                              3                 T  T                         2              
   1 X    X XX                       ψr,t + o(1) + 1
                                                         XXX XX                       ψr,t ψr,` + o(1) 
 =                     Wij,r Wik,r                                     Wij,r Wik,r                    
   nr t=1 i∈V j∈V
                                          ψr        nr t=1   
                                                                 i∈V j∈V
                                                                                              ψ r
                                                                                                        
                      r    r k6=j                                               `6=t       r    r k6=j
                   ti =tj =tk =t                                                       ti =tj =t,tk =`
                                                                                                           
            T  T                        2                     T  T                        2              
        1 XX      X XX                 ψr,t ψr,` + o(1) 
                                                         + 1
                                                               XXX XX                      ψr,t ψr,` + o(1) 
      +                  Wij,r Wik,r                                        Wij,r Wik,r                     
        nr t=1   
                  i∈V j∈V
                                               ψ r
                                                           nr
                                                               t=1
                                                                     
                                                                      i∈V j∈V
                                                                                                   ψ r
                                                                                                              
                   `6=t           r    r k6=j                                                 `6=t          r    r k6=j
                              tj =tk =t,ti =`                                                           ti =tk =t,tj =`
                                                                                
              T  T T                                       
          1 XX X      X XX                   ψr,t ψr,` ψr,h 
      +                      W ij,r W ik,r
                                                              .
          nr t=1     
                      i∈V j∈V
                                                    ψr        
                   `6=t h6=t,`           r    r k6=j
                                    ti =t,tj =`,tk =h

                                                                                           3
                                                                                                  −1
                                                                                           ψr,t
 Hence, in the general case, we propose to multiply                    to the triple (i, j, k) in which
                                                                                           ψr
                                                        2         −1
                                                         ψr,t ψr,`
three individuals are of the same type t; multiply         ψr
                                                                       to the triple (i, j, k) in which
                                                                                                    −1
                                                                                      ψr,t ψr,` ψr,h
two individuals are of the same type t and the other is of type `; multiply                 ψt
                                                                                                         to
the triple (i, j, k) in which three individuals are of different types, t, `, and h, to correct the
                          |s
second term of E(ds(Gr )|Gr ). The first term follows the correction of average degree.
   For star subgraphs, the conditional expectation is
                                       
        1   X XX s              s
     E                  Wij,r Wik,r Gr 
        mr i∈S j∈S
              r   r k6=j
                                                                                                                          
          T
          X 1 X XX                      
                                               i,j,k∈Sr      any two of i,j,k∈Sr     only i∈Sr
                                                                                                     
     =     
            mr         W ij,r W ik,r E  I t i =t j =tk =t ∨    ti =tj =tk =t    ∨ ti =t j =tk =t  Gr
                                                                                                       
                                                                                                       
       t=1      i∈V j∈V      r    r k6=j
                          ti =tj =tk =t
                                                                                                                                      
            T X
              T
            X    1 X XX               
                                            i,j,k∈Sr
                                                                                                    
          +     
                 mr     Wij,r Wik,r E I ti =tj =t,tk =`
                                                         ∨ anytitwo of i,j,k∈Sr
                                                                 =tj =t,tk =`   ∨ tionly i∈Sr
                                                                                    =tj =t,tk =`   Gr 
                                                                                                      
              t=1 `6=t            i∈Vr j∈Vr k6=j
                                   ti =tj =t,tk =`
                                                                                                                                      
            T X
              T
            X    1 X XX               
                                            i,j,k∈Sr
                                                                                                     
          +     
                 mr     Wij,r Wik,r E I ti =tk =t,tj =`
                                                         ∨ anytitwo of i,j,k∈Sr
                                                                 =tk =t,tj =`
                                                                                     only i∈Sr
                                                                                ∨ ti =tk =t,tj =`
                                                                                                    Gr 
                                                                                                       
              t=1 `6=t            i∈Vr j∈Vr k6=j
                                   ti =tk =t,tj =`
                                                                                                                                      
              T X
                T
              X    1 X XX               
                                              i,j,k∈Sr
                                                                                                        
          +       
                   mr     Wij,r Wik,r E I tj =t k =t,ti =`
                                                            ∨ anytjtwo of i,j,k∈Sr
                                                                    =tk =t,ti =`   ∨ tj only i∈Sr
                                                                                        =tk =t,ti =`   Gr 
                                                                                                          
              t=1 `6=t            i∈Vr j∈Vr k6=j
                                   tj =tk =t,ti =`
                                                                                                                                             
              T X
                T         T
              X           X      1 X XX               
                                                             i,j,k∈Sr
                                                                                                                         
          +                     
                                 mr     Wij,r Wik,r E I ti =t,t j =`,tk =h
                                                                            ∨ any  two of i,j,k∈Sr      only i∈Sr
                                                                                ti =t,tj =`,tk =h ∨ ti =t,tj =`,tk =h   Gr 
                                                                                                                           .
              t=1 `6=t h6=t,`               i∈Vr j∈Vr k6=j
                                           ti =t,tj =`,tk =h


When three individuals are of the same type, i.e., ti = tj = tk = t, we have
                                                                                                                                          Q               
                                                               nr,t −3      nr,t −3                                             nr,t −3                nr,q
                                                                                   
                                                               m r,t −3
                                                                         +3 m r,t −2
                                                                                      +                                         mr,t −1           q6=t mr,q
      i,j,k∈Sr    any two of i,j,k∈Sr    only i∈Sr
                                                       
E I t =t  =t =t
          i   j
                ∨  k t =t =t =t      i
                                      ∨ t =t =t =t
                                           j    k
                                                     Gr   = 
                                                               i   j   k       Q                                          T   nr,q
                                                                                                                                                             .
                                                                                                                          q=1 mr,q


                                                                           11
When two individuals are of the same type and the third is of a different type that ti = tj = t
and tk = ` or ti = tk = t and tj = `
                                                                       
        i,j,k∈Sr          any two of i,j,k∈Sr        only i∈Sr
E I ti =tj =t,tk =` ∨ ti =tj =t,tk =` ∨ ti =tj =t,tk =` Gr
                                                                             
              i,j,k∈Sr         any two of i,j,k∈Sr         only i∈Sr
 = E I tj =t     k =t,ti =`
                            ∨     tj =tk =t,ti =`    ∨  tj =tk =t,ti =`    G  r
                                                                                               nr,` −1 Q              
        nr,t −2      nr,` −1          nr,t −2     nr,` −1         nr,t −2    nr,` −1    nr,t −2                       nr,q
                                                                               
        mr,t −2 mr,` −1
                               +   2  mr,t −1 mr,` −1
                                                             +    mr,t −2      mr,`
                                                                                      + mr,t −1    mr,`       t6 =t,` mr,q
 =                                                          QT         nr,q
                                                                                                                           ;
                                                              q=1 mr,q


and for tj = tk = t and ti = `,
                                                                       
         i,j,k∈Sr       any two of i,j,k∈Sr          only i∈Sr
E I ti =t  k =t,tj =`
                      ∨     ti =tk =t,tj =`    ∨  ti =tk =t,tj =`   G   r
                                                                                                         Q                 
           nr,t −2    nr,` −1           nr,t −2    nr,` −1         nr,t −2
                                                                        nr,` −1     nr,t −2
                                                                                                   nr,` −1             nr,q
           mr,t −2 mr,` −1
                                 +  2   mr,t −1 mr,` −1
                                                              +    mr,t −2      mr,`
                                                                                      +    mr,t     mr,` −1      t6=t,` mr,q
  =                                                           QT        nr,q
                                                                                                                              
                                                               q=1 mr,q


When three individuals are of different types, i.e., ti = t, tj = `, tk = h,
                                                                      
        i,j,k∈Sr         any two of i,j,k∈Sr         only i∈Sr
E I ti =t,t j =`,tk =h
                       ∨   ti =t,tj =`,tk =h  ∨  ti =t,tj =`,tk =h   G r

      T             ! −1                                                                                   
     Y        nr,q                  nr,t − 1        nr,` − 1        nr,h − 1          nr,t − 1      nr,` − 1     nr,h − 1
 =                                                                                +
     q=1
              mr,q                 mr,t − 1 mr,` − 1 mr,h − 1                         mr,t − 1        mr,`       mr,h − 1
                                                                                                          
                            nr,t − 1         nr,` − 1         nr,h − 1           nr,t − 1      nr,` − 1     nr,h − 1
                        +                                                  +
                               mr,t          mr,` − 1 mr,h − 1                   mr,t − 1 mr,` − 1           mr,h
                                                                   Y                #
                              nr,t − 1       nr,` − 1 nr,h − 1                        nr,q
                        +                                                                      .
                            mr,t − 1           mr,`             mr,h        q6=t,`,h
                                                                                      m r,q




                                                               12
   Therefore, we can further obtain
                                   
    1   X XX s              s
 E                  Wij,r Wik,r Gr 
    mr i∈S j∈S
          r   r k6=j
                                                                                         
        T                             3       2                                 2
                                      ψr,t + 3ψr,t (1 − ψr,t ) + ψr,t (1 − ψr,t ) + o(1) 
                                                                                        
    1  X    X   X   X
  =                     Wij,r Wjk,r                                                      
    nr t=1 i∈V j∈V                                           ψr                          
                          r    r k6=j
                       ti =tj =tk =t
                                                                                                                           
            T X
              T                                               2                                   2
                                                                  ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` ) + o(1) 
                                                                                                                       
       1    X          X XX                                 ψr,t
   +                        Wij,r Wjk,r                                                                                 
       nr   t=1 `6=t
                       
                           i∈Vr j∈Vr k6=j
                                                                                         ψr                              
                            ti =tj =t,tk =`
                                                                                                                           
            T X
              T                                               2                                   2
                                                                  ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` ) + o(1) 
                                                                                                                       
       1    X          X XX                                 ψr,t
   +                        Wij,r Wjk,r                                                                                 
       nr   t=1 `6=t
                       
                           i∈Vr j∈Vr k6=j
                                                                                         ψr                              
                            ti =tk =t,tj =`
                                                                                                                                            
            T X
              T                                               2                                   2
                                                                  ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` ) + (1 − ψr,t )2 ψr,` + o(1) 
                                                                                                                                           
       1    X          X XX                                 ψr,t
   +                        Wij,r Wjk,r                                                                                                     
       nr   t=1 `6=t
                       
                           i∈Vr j∈Vr k6=j
                                                                                                  ψr                                         
                            tj =tk =t,ti =`
                              
            T X
              T         T
       1    X           X     X XX                
   +                               Wij,r Wjk,r ψr−1 ψr,t ψr,` ψr,h + (1 − ψr,t )ψr,` ψr,h + ψr,t (1 − ψr,` )ψr,h
       nr   t=1 `6=t h6=t,`
                              
                                  i∈Vr j∈Vr k6=j
                                 ti =t,tj =`,tk =h
                                                                                                                                      !
                                                                                 +ψr,t ψr,` (1 − ψr,h ) + ψr,t (1 − ψr,` )(1 − ψr,h ))) .




A.5         Conditional expectation of graph span
The graph span is defined as

                                                                    log n − log d(Gr )
                                                     `(Gr ) =                              + 1,
                                                                 log d2 (Gr ) − log d(Gr )

where d2 (Gr ) = n1 ni=1 j>i k6=i,j Wij,r Wjk,r is the average number of second neighbors.
                     P P P
Chandrasekhar and Lewis (2016) show that, for the star subgraph, E[d2 (Gsr )|GR ] = (k(ψ) +
                                                                                          |s
o(1))d2 (Gr ), where k(ψ) = ψ +ψ 2 −ψ 3 , while for the induced subgraph, E(d2 (Gr )|Gr ) = (ψ 2 +
                                                                    |s         |s
o(1))d2 (Gr ). Therefore, let d˜2 (Gsr ) = d2 (G2r )/k(ψ) and d˜2 (Gr ) = d2 (Gr )/ψ 2 , the analytically
                                                         |s
corrected estimators for `(Gr ) based on Gsr and Gr are

                               log n − log d(G˜ s)                                         ˜ |s
                                                                       log(ψ −1 m) − log d(G   r)
        ˜ s) =
        `(G                                       r           ˜  |s
                                                      + 1 and `(Gr ) =                            + 1.
           r
                            log d˜2 (Gsr ) − log d(G
                                                 ˜ s)
                                                    r
                                                                                 |s
                                                                       log d˜2 (Gr ) − log d(G
                                                                                              |s
                                                                                           ˜ r)




                                                                            13
      For the case of induced subgraph,
                                                       
                              1   XX X    |s    |s
E(d2 (G|s
       r )|Gr )          = E            Wij,r Wjk,r Gr 
                              mr i∈S j>i
                                              r        k6=i,j
                                                                                                       
  T                                                   T X
                                                        T
  X  1  X X X                                    X    1  X X X               
                                                                                        i,j,k∈Sr
                                                                                                        
               Wij,r Wjk,r E I ti i,j,k∈Sr
                                                                                                         
=   
     mr                          =tj =tk =t   Gr +
                                                          
                                                           mr       Wij,r Wjk,r E I ti =t j =t,tk =`
                                                                                                       Gr 
                                                                                                          
     t=1           i∈Vr j>i k6=i,j                                                           t=1 `6=t             i∈Vr j>i k6=i,j
                    ti =tj =tk =t                                                                                  ti =tj =t,tk =`
                                                                                                           
  T X
    T                                                     T X
                                                            T
  X    1  X X X               
                                    i,j,k∈Sr
                                                       X    1  X X X               
                                                                                            i,j,k∈Sr
                                                                                                            
+     
       mr       Wij,r Wjk,r E I tj =t k =t,ti =`      +
                                                    Gr       
                                                               mr       Wij,r Wjk,r E I ti =tk =t,tj =`
                                                                                                          Gr 
     t=1 `6=t              i∈Vr j>i k6=i,j                                                         t=1 `6=t             i∈Vr j>i k6=i,j
                            tj =tk =t,ti =`                                                                              ti =tk =t,tj =`
                                                                                                     
   T XT X
        T
  X        1 XX X                   
                                           i,j,k∈Sr
                                                             
+         
           mr         Wij,r Wjk,r E I ti =t,t j =`,tk =h
                                                            Gr 
                                                               .
  t=1          i∈V j>i
           `6=t h6=t,`                 r      k6=i,j
                                  ti =t,tj =`,tk =h


 When three individuals are of the same type, i.e., ti = tj = tk = t, we have
                                                  nr,t −3 Q        nr,q
                                                                       !
                             i,j,k∈Sr
                                                mr,t −3   q6 =t mr,q
                     E I ti =t  j =tk =t
                                          Gr =        QT     nr,q
                                                                          .
                                                                                                  q=1 mr,q

When two individuals are of the same type and the third is of a different type, including
ti = tj = t and tk = `; tj = tk = t and ti = `; and ti = tk = t and tj = `,
                                                                                        
                   i,j,k∈Sr                         i,j,k∈Sr                      i,j,k∈Sr
          E I ti =t  j =t,tk =`
                                 G  r   = E  I   tj =tk =t,ti =`  Gr   = E  I  ti =tk =t,tj =`  Gr
                nr,t −2
                         nr,` −1  Q       nr,q !
                                                
                               mr,t −2        mr,` −1            q6=t,`   mr,q
                   =                          QT      nr,q
                                                                                .
                                                  q=1 mr,q

When three individuals are of different types, i.e., ti = t, tj = `, tk = h,
                                           nr,t −1
                                                    nr,` −1  nr,h −1  Q                                                            nr,q
                                                                                                                                             !
                                                                       q6=t,`,h
                   i,j,k∈Sr                mr,t −1 mr,` −1 mr,h −1                                                                    mr,q
          E I ti =t,t j =`,tk =h
                                  Gr =                     QT       nr,q
                                                                                                                                                 .
                                                                                                        q=1 mr,q

      Therefore,
E(d2 (G|s
       r )|Gr ) =
                                                                                                                       
     T                                                   3                 T  T                        2              
1    X     X X X                                        ψr,t   + o(1) 
                                                                       + 1
                                                                            XXX X X                     ψr,t ψr,` + o(1) 
                 Wij,r Wjk,r                                                             Wij,r Wjk,r                    
nr   t=1
           
               i∈Vr j>i k6=i,j
                                                                ψr      nr
                                                                            t=1
                                                                                  
                                                                                   i∈V j>i
                                                                                                                ψr        
                                                                                      `6=t        r      k6=i,j
                ti =tj =tk =t                                                                 ti =tj =t,tk =`
                                                                                                                                                   
      T  T                        2                       T  T                        2              
  1 XX       XX X                ψr,t ψr,` + o(1)     1 XX       XX X                ψr,t ψr,` + o(1) 
+                   Wij,r Wjk,r                     + nr
                                                                         Wij,r Wjk,r                    
  nr t=1   
             i∈V j>i
                                         ψr                t=1
                                                                 
                                                                   i∈V j>i
                                                                                               ψr         
                `6=t           r     k6=i,j                                                         `6=t           r     k6=i,j
                           tj =tk =t,ti =`                                                                     ti =tk =t,tj =`
                                                                                        
      T  T T                                        
  1 XX X       XX X                   ψr,t ψr,` ψr,h 
+                     W ij,r W jk,r
                                                      .
  nr t=1     
               i∈V j>i
                                             ψr       
                `6=t h6=t,`          r      k6=i,j
                                ti =t,tj =`,tk =h

                                                                                                      3
                                                                                                             −1
                                                                                                      ψr,t
 Hence, in the general case, we propose to multiply               to the triple (i, j, k) in which    ψr
                                                    2        −1
                                                    ψr,t ψr,`
three individuals are of the same type t; multiply     ψr
                                                                  to the triple (i, j, k) in which

                                                                                     14
                                                                                                                                         −1
                                                                                                                         ψr,t ψr,` ψr,h
two individuals are of the same type t and the other is of type `; multiply                      to                            ψt
the triple (i, j, k) in which three individuals are of different types, t, `, and h, to correct the
                          |s
second term of E(ds(Gr )|Gr ).
   For star subgraph, the conditional expectation is
                                                         
                          1  XX X
E(d2 (Gsr )|Gr )   = E                     s     s
                                           Wij,r Wjk,r Gr 
                         mr i∈S j>i
                                r   k6=i,j
                                                                                                                     
                      T
                     X 1 X X X                                                                                  
                                            Wij,r Wjk,r E I ti i,j,k∈S      any two of i,j,k∈Sr
                                                                                                ∨ tionly j∈Sr
                                                                                                                      
                                                               =tj =tk =t ∨
                                                                       r
                   =     
                          mr                                                  ti =tj =tk =t         =tj =tk =t   Gr 
                     t=1      i∈V j>i   r     k6=i,j
                                     ti =tj =tk =t
                                                                                                                                           
                          T X
                            T
                          X           1 XX X                      
                                                                         i,j,k∈Sr        any two of i,j,k∈Sr     only j∈Sr
                                                                                                                                     
                      +              
                                      mr         W ij,r W jk,r E  I t i =tj =t,t k =` ∨   ti =t j =t,t k =` ∨ ti =t j =t,t k =`   Gr
                                                                                                                                       
                                                                                                                                       
                          t=1 `6=t        i∈V j>ir      k6=i,j
                                             ti =tj =t,tk =`
                                                                                                                                           
                        T X
                          T
                        X    1 XX X               
                                                        i,j,k∈Sr
                                                                                                                 
                      +     
                             mr     Wij,r Wjk,r E I tj =t k =t,ti =`
                                                                      ∨ anytjtwo of i,j,k∈Sr
                                                                              =tk =t,ti =`   ∨ tjonly j∈Sr
                                                                                                 =tk =t,ti =`   Gr 
                                                                                                                   
                          t=1 `6=t          i∈Vr j>i k6=i,j
                                             tj =tk =t,ti =`
                                                                                                                                           
                          T
                        T X
                        X    1 XX X               
                                                        i,j,k∈Sr
                                                                                                                 
                      +     
                             mr     Wij,r Wjk,r E I ti =tk =t,tj =`
                                                                     ∨ anytitwo of i,j,k∈Sr
                                                                             =tk =t,tj =`   ∨ ti only j∈Sr
                                                                                                 =tk =t,tj =`   Gr 
                                                                                                                   
                          t=1 `6=t          i∈Vr j>i k6=i,j
                                             ti =tk =t,tj =`
                                                                                                                                                   
                         T XT X
                              T
                        X        1 XX X                   
                                                                 i,j,k∈Sr
                                                                                                                             
                      +         
                                 mr         Wij,r Wjk,r E I ti =t,t j =`,tk =h
                                                                                ∨ any  two of i,j,k∈Sr      only j∈Sr
                                                                                    ti =t,tj =`,tk =h ∨ ti =t,tj =`,tk =h   Gr 
                                                                                                                               .
                        t=1          i∈V j>i
                              `6=t h6=t,`              r      k6=i,j
                                                  ti =t,tj =`,tk =h



 When three individuals are of the same type, i.e., ti = tj = tk = t, we have
                                                                                                         
                                                                    nr,t −3         nr,t −3       nr,t −3
                                                                                           
                                                                         −3
                                                                              + 3  mr,t −2
                                                                                              +  mr,t −1
         i,j,k∈Sr
                     ∨ any ttwo of i,j,k∈Sr
                                            ∨ tionly j∈Sr         mr,tQ
                                                             
  E I ti =t j =tk =t        i =tj =tk =t         =tj =tk =t Gr =                nr,q QT
                                                                                               nr,q
                                                                                                            .
                                                                                               q6=t mr,q           q=1 mr,q


    When two individuals are of the same type and the third is of a different type that ti =
tj = t and tk = ` or tj = tk = t and ti = `
                                                                          
             i,j,k∈Sr       any two of i,j,k∈Sr        only j∈Sr
   E I ti =t   j =t,tk =`
                          ∨    ti =tj =t,tk =`   ∨   ti =tj =t,tk =`    G  r
                                                                          
             i,j,k∈Sr       any two of i,j,k∈Sr         only j∈Sr
 =E I tj =tk =t,ti =` ∨ tj =tk =t,ti =` ∨ tj =tk =t,ti =` Gr
                                                                                            nr,` −1 Q             
        nr,t −2
                  nr,` −1         nr,t −2
                                              nr,` −1         nr,t −2
                                                                         nr,` −1   nr,t −2                      nr,q
        mr,t −2 mr,` −1
                             +   2  mr,t −1 mr,` −1
                                                          +    mr,t −2       mr,`
                                                                                   + mr,t −1    mr,`       t6=t,` mr,q
 =                                                        QT         nr,q
                                                                                                                       ;
                                                                       q=1 mr,q


and for ti = tk = t and tj = `,
                                                                
         i,j,k∈Sr      any two of i,j,k∈Sr       only j∈Sr
E I ti =tk =t,tj =` ∨ ti =tk =t,tj =` ∨ ti =tk =t,tj =` Gr
                                                                                                                    Q                     
           nr,t −2
                    nr,` −1        nr,t −2
                                               nr,` −1     nr,t −2
                                                                      nr,` −1                  nr,t −2
                                                                                                              nr,` −1                 nr,q
           mr,t −2 mr,` −1
                               +2 m    r,t −1   mr,` −1
                                                          + m r,t −2      mr,`
                                                                                +                 mr,t         mr,` −1        t6=t,`   mr,q
  =                                                      QT       nr,q
                                                                                                                                               
                                                                        q=1 mr,q


                                                                        15
When three individuals are of different types, i.e., ti = t, tj = `, tk = h,
                                                                      
        i,j,k∈Sr         any two of i,j,k∈Sr         only j∈Sr
E I ti =t,t j =`,tk =h
                       ∨   ti =t,tj =`,tk =h  ∨  ti =t,tj =`,tk =h   G r

      T             ! −1                                                                                  
     Y        nr,q                  nr,t − 1        nr,` − 1        nr,h − 1          nr,t − 1     nr,` − 1     nr,h − 1
 =                                                                                +
     q=1
              mr,q                 mr,t − 1 mr,` − 1 mr,h − 1                         mr,t − 1       mr,`       mr,h − 1
                                                                                                         
                            nr,t − 1         nr,` − 1         nr,h − 1           nr,t − 1     nr,` − 1     nr,h − 1
                        +                                                  +
                               mr,t          mr,` − 1 mr,h − 1                   mr,t − 1 mr,` − 1          mr,h
                                                                   Y               #
                            nr,t − 1         nr,` − 1         nr,h − 1                nr,q
                        +                                                                     .
                               mr,t          mr,` − 1           mr,h        q6=t,`,h
                                                                                      mr,q

Therefore, we can further obtain
                                                                                                                                  
                          T                                               3           2                                 2
                                                                                               − ψr,t ) + ψr,t (1 − ψr,t ) + o(1) 
                                                                                                                              
                     1    X     X X X                                   ψr,t   +   3ψr,t (1
E(d2 (Gsr )|Gr ) =                    Wij,r Wjk,r                                                                                
                     nr   t=1
                                
                                  i∈Vr j>i k6=i,j
                                                                                                       ψr                         
                                   ti =tj =tk =t
                                                                                                                                            
                     T  T                       2                                   2
                                                ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` ) + o(1) 
                                                                                                           
                 1 XX      XX X
               +                  Wij,r Wjk,r                                                               
                 nr t=1   
                           i∈V j>i
                                                                            ψr                               
                                `6=t           r      k6=i,j
                                           ti =tj =t,tk =`
                                                                                                                                            
                     T  T                       2                                   2
                                                ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` ) + o(1) 
                                                                                                           
                 1 XX      XX X
               +                  Wij,r Wjk,r                                                               
                 nr t=1   
                           i∈V j>i
                                                                            ψr                               
                                `6=t           r     k6=i,j
                                           tj =tk =t,ti =`
                                                                                                                                                             
                     T  T                         2                                   2
                                                  ψr,t ψr,` + 2(1 − ψr,t )ψr,t ψr,` + ψr,t (1 − ψr,` ) + (1 − ψr,t )2 ψr,` + o(1) 
                                                                                                                                 
                 1 XX      XX X
               +                  W ij,r W jk,r
                                                                                                                                  
                 nr t=1   
                           i∈V j>i
                                                                                       ψr                                         
                                `6=t           r     k6=i,j
                                           ti =tk =t,tj =`
                                              
                          T X
                            T          T
                     1    X            X      X X X            
               +                                    Wij,r Wjk,r ψr−1 ψr,t ψr,` ψr,h + (1 − ψr,t )ψr,` ψr,h + ψr,t (1 − ψr,` )ψr,h
                     nr   t=1 `6=t h6=t,`
                                              
                                                 i∈Vr j>i k6=i,j
                                                ti =t,tj =`,tk =h
                                                                                                                                                      !
                                                                                                                                                 
                                                                                         + ψr,t ψr,` (1 − ψr,h ) + (1 − ψr,t )ψr,` (1 − ψr,h )            .




A.6        Conditional expectation of homophily index
Currarini et al. (2009) define the homophily index of graph Gr as Hr,t = sr,ts+d    r,t
                                                                                        r,t
                                                                                            , where sr,t
denotes the average number of friendships that agents of type t have with agents of the same
type and dr,t denotes the average number of friendships that type t form with agents of type
different than t. Here we may use type t to represent different demographic characteristics,
e.g., gender, race, and age, etc. Specifically, let Vr,t denotes a set of notes with type t.

                                                    1 X                                         1 X X
                                       sr,t =                 Wij,r ,               dr,t =              Wij,r .
                                                   nr,t i,j∈V                                  nr,t i∈V
                                                               r,t                                      r,t   j ∈V
                                                                                                                / r,t




                                                                                16
   In the general case of induced subgraph, fixing type t, we have
                                                        

                        |s
                                       1 X           |s
                                                             
                     E(sr,t |Gr ) = E 
                                       mr,t       W ij,r Gr
                                                             
                                                             
                                             i,j∈S                   r
                                                              ti =tj =t
                                             1 X                                  i,j∈Sr
                                                                                                  
                                        =              Wij,r E I                 ti =tj =t    Gr
                                            mr,t i,j∈V
                                                               r
                                                     ti =tj =t
                                                                              nr,t −2 Q         nr,q
                                                                                                          !
                                           1 X                                mr,t −2    q6=t mr,q
                                        =            Wij,r                        QT      nr,q
                                                                                               
                                          mr,t i,j∈V                                 q=1 mr,q
                                                               r
                                                     ti =tj =t
                                             1 X
                                        =              Wij,r (ψr,t + o(1)) ,
                                            nr,t i,j∈V
                                                              r
                                                    ti =tj =t


and                                                                           
                             T
                |s
                             X   1                    X              |s
                                                                             
            E(dr,t |Gr ) =     E
                                 mr,t                              Wij,r Gr 
                                                                             
                             `6=t                     i,j∈Sr
                                                    ti =t,tj =`
                                                                                                      
                         T
                         X  1                     X                      
                                                                              i,j∈Sr
                                                                                         
                       =   
                            mr,t                                 Wij,r E I ti =t,tj =` Gr 
                                                                                           
                             `6=t                  i,j∈Vr
                                                 ti =t,tj =`
                                                                                                                         
                                                                          nr,t −1     nr,k −1 Q                  nr,q !
                                                                                                                   
                         T
                         X  1                     X                      mr,t −1     mr,k −1          q6=t,`    mr,q     
                       =   
                            mr,t                             Wij,r                   QT      nr,q
                                                                                                                         
                                                                                                                          
                             `6=t                 i,j∈Vr                                  q=1 mr,q
                                                ti =t,tj =`
                                                                         
                                    T
                              1 X        X                
                       =                      W ij,r ψr,`
                                                           .
                             nr,t `6=t  i,j∈V             
                                                       r
                                                ti =t,tj =`

                                −1                                                −1                            |s            |s
Therefore, we propose multiply ψr,t on each link for the calculation of sr,t and ψr,` for dr,t .




                                                                    17
    In a general case of star subgraph, fixing type t, we have
                                                   
                                       1 X                  
                    E(ssr,t |Gr ) = E 
                                       mr,t       W  s
                                                     ij,r Gr
                                                             
                                                             
                                             i,j∈S              r
                                                          ti =tj =t
                                           1 X                                   i,j∈Sr
                                                                                             ∨ itor j∈Sr
                                                                                                                    
                                     =               Wij,r E I                  ti =tj =t        i =tj =t
                                                                                                                Gr
                                          mr,t i,j∈V
                                                          r
                                                 ti =tj =t
                                                                                                        Q                          
                                                                               nr,t −2           nr,t −2                       nr,q
                                                                                         
                                           1       X                           mr,t −2
                                                                                             +2 m r,t −1      q6=t             mr,q
                                     =                        Wij,r                          QT       nr,q
                                                                                                                                      
                                          mr,t    i,j∈Vr                                          q=1 mr,q
                                                 ti =tj =t
                                           1 X
                                     =               Wij,r (ψr,t + 2(1 − ψr,t ) + o(1)) ,
                                          nr,t i,j∈V
                                                        r
                                                 ti =tj =t


and
E(dsr,t |Gr )
                                                  
  T
  X   1                  X
                                       s
                                              
=   E
      mr,t                          Wij,r Gr 
                                              
    `6=t                 i,j∈Sr
                       ti =t,tj =`
                                                                                             
  T
  X  1               X                   
                                              i,j∈Sr      i or j∈Sr
                                                                       
=   
     mr,t                        Wij,r E I ti =t,tj =` ∨ ti =t,tj =` Gr 
                                                                         
    `6=t              i,j∈Vr
                    ti =t,tj =`
                                                                                                                                                              
                                              nr,t −1
                                                           nr,` −1
                                                                             nr,t −1
                                                                                        nr,` −1
                                                                                                           nr,t −1
                                                                                                                                   Q
                                                                                                                             nr,` −1                 nr,q
                                                                                                                                                            
  T
  X  1               X                       mr,t −1       mr,` −1
                                                                          +    mr,t      mr,` −1
                                                                                                       +    mr,t −1           mr,`          q6=t,`   mr,q       
=   
     mr,t                        Wij,r                                                  QT            nr,q
                                                                                                                                                               
                                                                                                                                                                
    `6=t              i,j∈Vr                                                                  q=1 mr,q
                    ti =t,tj =`
                                                                                            
           T
     1 X        X                                           
=                    Wij,r (ψr,` /ψr,t + (1 − ψr,` ) + o(1))
                                                             .
    nr,t `6=t 
                i,j∈V     r
                ti =t,tj =`

                                           2
                                                                 
Therefore, we propose multiply ψr,t           + 2ψr,t (1 − ψr,t ) on each link for the calculation of ssr,t
and
(ψr,t ψr,` + ψr,` (1 − ψr,t ) + ψr,t (1 − ψr,` ))−1 for dsr,t .




                                                                              18
B       Additional Results
B.1      Empirical results

        Table B.1: Estimated network effects on the share of population in rural India
        village that (I) employed and (II) work outside the village – based on friendship
        network
         Dependent Variable                 Employed(%)                   Work Outside Village(%)
                                  Raw         Random           Rake     Raw       Random       Rake
         Degree                  0.0425∗∗     0.0161∗∗       0.0120     -0.0216    -0.0103     -0.0118
                                 (0.0197)      (0.0075)     (0.0076)   (0.0213)   (0.0083)    (0.0090)
         Cluster                0.2490∗∗∗     0.2490∗∗∗     0.1272∗∗     0.0194    0.0194       0.0464
                                 (0.0714)      (0.0714)     (0.0555)   (0.0935)   (0.0935)    (0.0629)
         Span                     0.0001        -0.0102      -0.0033     0.0001     0.0145      0.0022
                                 (0.0002)      (0.0097)     (0.0077)   (0.0001)   (0.0103)    (0.0083)
         Epid Thrld             -0.4304∗∗     -0.7882∗       -0.4498     0.2627    0.6378       0.4709
                                 (0.2005)      (0.3997)     (0.3608)   (0.1893)   (0.3876)    (0.3552)
         HI-sex                 0.3504∗∗∗     0.3504∗∗∗     0.2745∗∗    -0.0008    -0.0008      0.0926
                                 (0.1107)      (0.1107)     (0.1106)   (0.1401)   (0.1401)    (0.1416)
         HI-age                 0.4039∗∗∗     0.4039∗∗∗      0.0603     -0.1427    -0.1427   0.4020∗∗
                                 (0.1437)      (0.1437)     (0.1478)   (0.2374)   (0.2374)    (0.2086)
         HI-householdsize         0.0377        0.0377       -0.0382   0.1901∗∗   0.1901∗∗      0.1004
                                 (0.0842)      (0.0842)     (0.0832)   (0.0820)   (0.0820)    (0.0968)
         HI-rake                  0.1905        0.1905       0.0181    0.2488∗    0.2488∗    0.4177∗∗∗
                                 (0.1221)      (0.1221)     (0.1166)   (0.1344)   (0.1344)    (0.1362)
         Note: Regression is based on 75 villages. Standard errors robust to heteroscedasticity are
        reported in parentheses. *, **, *** stand for significance at 10%, 5%, and 1% respectively.
        Each row corresponds to one regression and the village size is included as as a default control.

Table B.2: Effects of clustering and graph span on club participation and frequency of exercise
in U.S. high schools.
 Dependent Variable            Number of clubs attended                       Frequency of exercise
                              Raw        Random             Rake          Raw        Random           Rake
 Cluster                     0.0519   -0.3535               -0.3891     1.1620∗∗      0.3139        -0.3891
                            (0.4294) (0.3895)              (0.3718)     (0.5264)     (0.6989)      (0.3718)
 Span                        -0.0010 -0.3079∗∗            -0.3779∗∗∗   -0.0103∗∗∗    -0.1769∗     -0.3779∗∗∗
                            (0.0014) (0.1160)              (0.1237)     (0.0019)     (0.1152)      (0.1237)
 Note: Regression is based on 48 schools. *, **, *** stand for significance at 10%, 5%, and 1%
respectively. The model includes both the clustering coefficient and graph span as network
regressors, and has the school size included as a default control.




                                                          19
C     Additional Figures
In this section, we report two types of figures: (i) the simulation results on the bounds of
the maximal eigenvalues of a network and (ii) the distribution of the corrections network by
network.
    Figures C.1 and C.2 for induced and star subgraphs, respectively, present the results of
our simulation exercise for the bounds of the maximal eigenvalue in terms of box plots with
estimates from 100 repetitions. Again, we compare the population values (lines), raw data,
as well as the two types of corrections (box plots). We only consider the sampling rates
ψ = 80% and ψ = 40% for simplicity. The results for the intermediate    p sampling rate are in
line with those reported here. While the two lower bounds (d(G) and ds (G)) and the upper
bound (U ) (from Section 3.5) are all positive, they are quite different in magnitudes, so for a
better exposition, we transform them into reciprocals. The blue lines in the figures represent
the true value of the bounds and the red line represents the true maximal eigenvalue.
    The results clearly show that the bounds computed from the raw sample largely biased
from their true values upwards in the reciprocal form (i.e., downwards in their original form).
As expected, the biases scale down with the sampling rate. The random corrections eliminate
the biases in scenario R, but important biases remain under non-random sampling. In fact,
the corrections based on the missing-at-random assumption may even change the sign of the
biases compared to raw data and remain large. In contrast, our poststratification weighting
is remarkably successful eliminating the biases in the bounds.
    In case of (ii), Figures C.3 - C.18 complement the analysis in the main text by providing
a look at the efficiency of proposed estimators. See Section 4.1 for the details regarding the
structure of the figures and the description of the results.




                                              20
        Scenario R
        Scenario H
        Scenario M
        Scenario L




                       1 − ψ = 20%                         1 − ψ = 60%
Figure C.1: Induced subgraph: Boxplots of bounds corrections with respect to the population
network for ψ = 80% (left), and 40% (right) and four different removal strategies.

                                            21
        Scenario R
        Scenario H
        Scenario M
        Scenario L




                      1 − ψ = 20%                        1 − ψ = 60%
Figure C.2: Star subgraph: Boxplots of bounds corrections with respect to the population
network for ψ = 80% (left), and 40% (right) and four different removal strategies.

                                          22
Figure C.3: Recovering network properties. Induced subgraph, random removal of 20% of
nodes (ψ = 80%).




                                         23
Figure C.4: Recovering network properties. Induced subgraph, random removal of 60% of
nodes (ψ = 40%).




                                         24
Figure C.5: Recovering network properties. Induced subgraph, removal of highly connected
nodes with higher probability, 20% of nodes (ψ = 80% ).




                                          25
Figure C.6: Recovering network properties. Induced subgraph, removal of highly connected
nodes with higher probability, 60% of nodes (ψ = 40% ).




                                          26
Figure C.7: Recovering network properties. Induced subgraph, removal of people with median
connectivity with higher probability, 20% of nodes (ψ = 80%).




                                           27
Figure C.8: Recovering network properties. Induced subgraph, removal of people with median
connectivity with higher probability, 60% of nodes (ψ = 40%).




                                           28
Figure C.9: Recovering network properties. Induced subgraph, removal of people with low
connectivity with higher probability, 20% of nodes (ψ = 80%).




                                          29
Figure C.10: Recovering network properties. Induced subgraph, removal of people with low
connectivity with higher probability, 60% of nodes (ψ = 40%).




                                          30
Figure C.11: Recovering network properties. Star subgraph, random removal of 20% of nodes
(ψ = 80%).




                                           31
Figure C.12: Recovering network properties. Star subgraph, random removal of 60% of nodes
(ψ = 40%).




                                           32
Figure C.13: Recovering network properties. Star subgraph, removal of highly connected
nodes with higher probability, 20% of nodes (ψ = 80%).




                                         33
Figure C.14: Recovering network properties. Star subgraph, removal of highly connected
nodes with higher probability, 60% of nodes (ψ = 40%).




                                         34
Figure C.15: Recovering network properties. Star subgraph, removal of people with median
connectivity with higher probability, 20% of nodes (ψ = 80%).




                                          35
Figure C.16: Recovering network properties. Star subgraph, removal of people with median
connectivity with higher probability, 60% of nodes (ψ = 40%).




                                          36
Figure C.17: Recovering network properties. Star subgraph, removal of people with low
connectivity with higher probability, 20% of nodes (ψ = 80%).




                                         37
Figure C.18: Recovering network properties. Star subgraph, removal of people with low
connectivity with higher probability, 60% of nodes (ψ = 40%).




                                         38
