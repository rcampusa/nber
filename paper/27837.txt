                              NBER WORKING PAPER SERIES




              ON THE EQUILIBRIUM PROPERTIES OF NETWORK MODELS
                        WITH HETEROGENEOUS AGENTS

                                         Treb Allen
                                       Costas Arkolakis
                                        Xiangliang Li

                                      Working Paper 27837
                              http://www.nber.org/papers/w27837


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                   September 2020




We thank Truman Bewley, Vasco Carvalho, Xiaohong Chen, Yi Chen, Dave Donaldson, John
Geanakoplos, Johannes Horner, Steve Redding, Andres Rodriguez-Clare, Larry Samuelson,
Alireza Tahbaz-Salehi, Xinyang Wang, and Ivan Werning for helpful comments and suggestions.
Ari Boyarsky, Joonhyuk Lee, and Fan Wu offered excellent research assistance. This paper has
been previously circulated under the title "On the Existence and Uniqueness of Trade Equilibria".
The authors acknowledge support by the National Science Foundation under grants SES-1658838
and SES-1658875. All errors are our own. The views expressed herein are those of the authors and
do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2020 by Treb Allen, Costas Arkolakis, and Xiangliang Li. All rights reserved. Short sections of
text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
On the Equilibrium Properties of Network Models with Heterogeneous Agents
Treb Allen, Costas Arkolakis, and Xiangliang Li
NBER Working Paper No. 27837
September 2020
JEL No. C6,D85,E23,F4,O18,R13

                                         ABSTRACT

In this note, we consider a broad class of network models where a large number of heterogeneous
agents simultaneously interact in many ways. We provide an iterative algorithm for calculating an
equilibrium and offer sufficient and "globally necessary" conditions under which the equilibrium
is unique. The results arise from a multi-dimensional extension of the contraction mapping
theorem which allows for the separate treatment of the different types of interactions. We
illustrate that a wide variety of heterogeneous agent economies ­ characterized by spatial,
production, or social networks ­ yield equilibrium representations amenable to our theorem's
characterization.

Treb Allen                                      Xiangliang Li
Department of Economics                         Department of Economics
Dartmouth College                               Yale University
6106 Rockefeller Hall                           28 Hillhouse Ave
Hanover, NH 03755                               New Haven, CT, 06520-8268
and NBER                                        lxlnemo@gmail.com
treb@dartmouth.edu

Costas Arkolakis
Department of Economics
Yale University, 28 Hillhouse Avenue
P.O. Box 208268
New Haven, CT 06520-8268
and NBER
costas.arkolakis@yale.edu
1     Introduction
The twenty first century has witnessed the rise of big data and big models in the social
sciences. Exponential growth in computational capacity combined with access to new micro-
level datasets have allowed the empirical implementation of models where large numbers of
heterogeneous agents interact simultaneously with each other in myriad ways. While the rise
of big data and big models has introduced empirical content to traditionally theoretical fields,
important questions about the positive properties of these big models remain unresolved.
Two concerns ­ critical for applied work ­ are particularly pressing: How can we compute
the solution of an equilibrium system with hundreds or thousands of heterogeneous agents
efficiently? And even if we do calculate a solution, how do we know that the equilibrium we
find is the only possible one?
     In this note, we answer these questions for a large class of models where many hetero-
geneous agents simultaneously interact in many ways. In particular, we consider systems
where N heterogeneous agents engage in H types of interactions whose equilibrium can be
reduced to a set of N × H equations of the following form:

                                             N
                                    xih =          fijh (xj 1 , ..., xjH ) ,                         (1)
                                            j =1


                    ×H
where {xih }  RN   ++    reflect the (strictly positive) equilibrium outcomes for each agent of
each interaction and fijh : RH  ++  R++ are the known (differentiable) functions that govern
the interactions between different agents. In particular, fijh is the function that governs the
impact that an interaction with agent j has on agent i's equilibrium outcome of type h.1
As we illustrate, this formulation is sufficiently general to capture models of many different
economic networks ­ from firm linkages to social networks to the spatial structure of cities.
    The contribution of the paper is to provide conditions under which an equilibrium sat-
isfying equation (1) is unique and can be calculated using an iterative algorithm. The key
insight, loosely speaking, is to simplify the analysis by abstracting from agent heterogeneity
and focusing on the strength of economic interactions. Formally, rather than focusing on the
N 2 × H functions {fijh }, we instead focus on the H × H matrix of the uniform bounds of the
                                    ln fijh ({xjh } )
elasticities hh  supi,j,{xjh }           ln xjh
                                                   h
                                                      . The conditions provided depend only on
a single statistic of this matrix: its spectral radius being less than one (or, with additional
restrictions on {fijh }, equal to one).2 Moreover, the conditions provided are shown to be
   1
     These interactions could be market interactions or non-market interactions (as discussed by Glaeser,
Sacerdote, and Scheinkman (2003); Glaeser and Scheinkman (2002)).
   2
     The spectral radius plays a number of important roles in economics, e.g. in the characterization of


                                                       2
"globally necessary", i.e. they are the best possible conditions that are agnostic about the
heterogeneity across agents: formally, we show that if the conditions are not satisfied, there
exist {fijh } where multiplicity is assured.
    Our main result relies on a multi-dimensional extension of the contraction mapping the-
orem, which ­ to our knowledge ­ is new and of independent interest in its own right. The
insight of this extension is that it is possible to partition the space of endogenous variables
into subsets, each of which operates in a different metric subspace. This partition is particu-
larly helpful in economic models where heterogeneous agents interact in many ways (i.e. H
is large), as it allows us to separate the study of each type of interaction.
    To illustrate the versatility of our approach, consider two alternative strategies often
employed to analyze the equilibrium properties of a system. The first alternative strategy
is to recursively apply a process of substitution to re-define the equilibrium system as a
function of fewer economic interactions. For example, in a simple exchange economy with
multiple agents and multiple goods, there are two interactions ­ buying and selling, which
in equilibrium can be summarized by the value of each agent's endowment (wages) and
consumption bundle (price index). Alvarez and Lucas (2007) characterize the equilibrium
of such a system by first substituting wages into the price index and then analyzing the
structure of the model only in terms of wages.3 While feasible for small H , the complexity of
this strategy increases exponentially with the number of interactions in the model, creating
a curse of dimensionality for large H .
    The second alternative strategy is to "stack" all economic outcomes into a single N H × 1
vector and apply standard contraction mapping arguments. The disadvantage of such an
approach is that it treats different types of economic outcomes identically ­ despite the fact
that they may play very different roles in the equilibrium system. The results in a loss of
information and introduces the possibility that the sufficient conditions may fail despite the
system being unique.4 In contrast, our approach both avoids the curse of dimensionality of
macro-economic stability (see e.g. Hawkins and Simon (1949)) and the solution of linearized DSGE models
(Fern´ andez-Villaverde, Rubio-Ram´  irez, and Schorfheide (2016)). More recently, Elliott and Golub (2019)
shows that the spectral radius characterizes the efficiency of public goods provision in networks with non
uniform externalities. To our knowledge, this note is the first to show that the spectral radius of a matrix
of elasticities of economic interactions characterizes the uniqueness of (and the speed of convergence of an
iterative algorithm to) the equilibrium of a network model with many heterogenous agents.
    3
      Indeed, Allen, Arkolakis, and Takahashi (2020) show that the sufficient conditions presented in Alvarez
and Lucas (2007) ­ which rely on showing the gross substitutes property of the system, c.f. Mas-Colell,
Whinston, and Green (1995) ­ can be relaxed when treating wages and the price index separately. The
results here extend those of Allen, Arkolakis, and Takahashi (2020) both by allowing for general (non-
constant elasticity) functional forms and by allowing for more than two types of economic interactions.
                                                                                  1                 1
   4
     A simple example is the following system where N = 1 and H = 2: x11 = x11    2
                                                                                    x2
                                                                                     12 + 1, x12 = x12 + 1. It
                                                                                                    2


is straightforward to show that by treating x11 and x12 as a single vector variable, the standard contraction
conditions that the matrix norm (induced by the vector norm) of the system's Jacobian matrix is strictly


                                                      3
the first strategy and the loss of information inherent to the second, permitting an analysis
of economic systems with large numbers of interactions.
    We provide additional results for a special case of equation (1) where the elasticities
 ln fijh ({xjh } )
      ln xjh
                h
                   are constant and identical across agents. This case has emerged as the de-
facto benchmark in the "quantitative" spatial literature, spanning the fields of international
trade, economic geography, and urban economics (see e.g. the excellent review articles by
Costinot and Rodriguez-Clare (2013) and Redding and Rossi-Hansberg (2017)). We also
offer results that facilitate the analytical characterization of the spectral radius condition
and, as a result, the parametric region where uniqueness and computation is feasible.
    We finally apply our theorem to offer new results and extensions of seminal models from
disparate fields in economics, illustrating its broad applicability. In particular, in the field
of spatial economics, we provide uniqueness conditions for quantitative urban models in the
spirit of Ahlfeldt, Redding, Sturm, and Wolf (2015) in the presence of spatial productivity
and amenity spillovers. In the field of macroeconomics, we provide uniqueness results for
the sectoral production network in the spirit of Acemoglu, Carvalho, Ozdaglar, and Tahbaz-
Salehi (2012) but generalized to allow for non unit elasticities of substitution as in Carvalho,
Nirei, Saito, and Tahbaz-Salehi (2019). In the field of social networks, we provide uniqueness
conditions for a model of discrete choice with social interactions in the spirit of Brock and
Durlauf (2001) but generalized to allow for many choices and arbitrary weights on others'
actions.
    A voluminous literature in economic theory has used fixed point theorems to analyze
existence and uniqueness of solutions of economic models. The literature has offered three
main approaches in order to characterize the positive properties of economic models: (1)
use of the contraction mapping theorem; (2) conditions on the Jacobian matrix such as it
satisfying gross substitution or it being an M-matrix (see e.g. Mas-Colell, Whinston, and
Green (1995) chapter seventeen, Arrow, Hahn, et al. (1971) chapter nine, and Gale and
Nikaido (1965)); or (3) the Index Theorem.5 This paper follows the first approach. While
less than one (see e.g. Olver (2008) Chapter 9) are not satisfied, whereas the multi-dimensional contraction
mapping conditions we provide are satisfied. See Online Appendix B.3.1 for details.
    5
      Notice that substitutability conditions are effectively conditions on the cross-derivatives of the Jacobian.
Berry, Gandhi, and Haile (2013) show that a relaxed form of substitutability, weak gross-substitutes, together
with strict connectedness are sufficient for invertibility (in our context, uniqueness). In a setup that main-
tains the assumptions of a typical Walrasian economy, Iritani (1981) shows that Weak Indecomposability is
necessary and sufficient for uniqueness. He also shows that a stronger form of Weak Indecomposibility im-
plies Weak Gross substitutability so these analysis are intimately related. Kennan (2001) shows that concave
monotonically increasing functions have a unique positive fixed point; here, we make no restrictions that the
functions be monotonic, increasing, or concave (although the condition that the spectral radius of the matrix
of bounds of the elasticities be no greater than one does simplify to a requirement of quasi-concavity in the
special case where N = H = 1 and the function being considered is monotonically increasing).



                                                        4
the latter two approaches are powerful, they are often impractical to apply to situations
where many agents interact in many ways. For example, the Jacobian of equation (1) is of
size HN 2 × HN 2 , making it difficult to characterize; in contrast, the conditions below depend
on a single statistic of an H × H matrix.6 Similarly, the the Index Theorem has typically
proven impractical to apply to production economies.7 Our contribution to this literature is
to show that for a general class of models with heterogeneous agents and multiple interactions
a multi-dimensional extension of the contraction mapping theorem can be a powerful tool in
characterizing their properties. The resulting theorem provides easy-to-verify conditions for
uniqueness of an equilibrium and an algorithm for its computation.
    The structure of the remainder of the note is as follows: Section 2 presents the multi-
dimensional contraction mapping extension (Lemma 1), offers the main result (Theorem 1),
and makes five remarks. Section 3 presents three applications of the result to the fields
of spatial networks, sectoral production networks, and social networks, respectively. For
brevity, the proof of Lemma 1 and Theorem 1 are presented in the Appendix, and details of
the remarks and applications are presented in the Online Appendix.


2       Main Results
We start our presentation by offering a multi-dimensional extension of the standard contrac-
tion mapping theorem. While of interest in itself, it also facilitates the proof of Theorem 1
below.

Lemma 1. Let {(Xh , dh )}h=1,2,...,H be H metric spaces where Xh is a set and dh is its
corresponding metric. Define X  X1 × X2 × ... × XH , and d : X × X  RH               + such
                                                                            
                                                              d1 (x1 , x1 )
that for x = (x1,..., xH ) , x = x1,..., xH  X, d (x, x ) =       ...       . Given operator
                                                                            

                                                             dH (xH , xH )
T : X  X , suppose for any x, x  X

                                      d (T (x) , T (x ))  Ad (x, x ) ,                                        (2)
    6
      Even when the Jacobian can be characterized, the conditions required to establish uniqueness may be too
                                                       N
stringent. For example, consider the system xi = j =1 Kij x     j for Kij > 0 and   (0, 1). The i
                                                                                                       th
                                                                                                          diagonal
                                   -1
term of its Jacobian is 1 - Kii xi       which can be negative or positive, violating e.g. the classical condition
of Gale and Nikaido (1965) that all principal submatrices of the Jacobian have positive determinants. In
contrast, the spectral radius of the elasticity is  < 1, so uniqueness is established immediately by the
Theorem presented here.
    7
      See an extensive discussion on the applications of the index theorem to exchange and production
economies in Kehoe (1985); Kehoe, Whalley, et al. (1985). While mathematically powerful, the index theo-
rem conditions typically lose their sufficiency when attempted to translate them in economically interpretable
conditions.

                                                        5
where A is a non-negative matrix and the inequality is entry-wise. Denote  (A) as the
spectral radius (largest eigenvalue in absolute value) of A.
   If  (A) < 1 and for all h = 1, 2, ..., H , (Xh , dh ) is complete, there exists a unique fixed
point of T , and for any x  X , the sequence of x, T (x), T (T (x)), ... converges to the fixed
point of T .

Proof. See Appendix A.1.

    Lemma 1 extends the standard contraction mapping result to multiple dimensions by
replacing the contraction constant with the matrix A. It then states that a simple sufficient
statistic of that matrix ­ its spectral radius  (A) ­ replaces the role of the contraction
constant in determining the contraction of the system. This sufficient statistic succinctly
summarizes the role of the asymmetry of the impact of the different variables in determining
the positive properties of the system: as long as the spectral radius is less than one there exists
a unique fixed point, and it can be computed by applying the mapping T (x) iteratively, which
converges to the fixed point at a rate  (A). Intuitively, a spectral radius of less than one
holds if and only if the sequence limk Ak converges to zero so that repeated applications
of the operator eventually bound the set of points of the sequence arbitrarily close to the
fixed point. Note that Lemma 1 reduces to the standard contraction mapping theorem if
H = 1 (see e.g. Theorem 3.2 of Lucas and Stokey (1989)).


2.1     Main Theorem
As mentioned in the introduction, the main result of the paper concerns systems whose
equilibrium can be written as in equation (1). Before presenting our main result, some
additional notation is in order. Let N  {1, ..., N } and H  {1, ..., H } correspond to the set
of economic agents and the set of economic interactions, respectively. Let x be an N -by-H
matrix of endogenous economic outcomes, where for i  N and h  H, we (slightly abuse
notation) and let xi denote x's ith row and x.h to denote x's hth column. We restrict our
                                                      ×H
attention to strictly positive {xih }iN ,hH  RN      ++    and strictly positive and differentiable
                                                         ln fijh (xj )
{fijh }. Finally, define the elasticity ijh,jh (xj )   ln x            , i.e. ijh,jh (xj ) is the impact of
                                                               jh
agent j s outcome of type h on agent i s outcome of type h.

Theorem 1. Suppose there exists an H -by-H matrix A such that for all i, j  N , h, h  H,
and xj  RH  ++ | ijh,jh (xj )|  (A)hh . Then:
    (i). If  (A) < 1, then there exists a unique solution to equation (1) and the unique
solution can be computed by iteratively applying equation (1) with a rate of convergence
 (A);

                                                    6
    (ii). If  (A) = 1 and:
    a. If | ijh,jh (xj )| < (A)hh for all i, j  N and h, h  H when (A)hh = 0, then equation
(1) has at most one solution x;
    b. If ijh,jh (xj ) = hh  R where |hh | = (A)hh for all i, j  N and h, h  H i.e.
                            hh
fijh (xj ) = Kijh h H xjh        for some Kijh > 0­then equation (1)'s solution is column-wise
up-to-scale unique, i.e. for any h  H and solutions x and x it must be x.h = ch x.h for some
scalar ch > 0;
                                                                        hh
    (iii). If  (A) > 1, N  2H + 1, and fijh (xj ) = Kijh h H xjh            , then there exists
some {Kijh > 0}i,j N ,hH such that equation (1) has multiple solutions that are column-wise
up-to-scale different.

Proof. See Appendix A.2.

    It is important to emphasize that the conditions provided in the Theorem 1 abstract from
the particular heterogeneity of agents ­ i.e. the particular functions {fijh } ­ and instead focus
on the magnitude of the economic interactions across all agents, i.e. the uniform bounds on
elasticities | ijh,jh (xj )|  (A)hh . Loosely speaking, the matrix (A)hh captures the degree to
which the economic outcome of any agent of type h can impact any other agents' economic
outcome of type h. Such conditions that focus on the strength of the economic interactions
rather than the heterogeneity of the agents themselves are advantageous in settings where
the same economic model may be applied to different empirical contexts. For example, in
spatial models, the heterogeneity of agents captures such things like the specific underlying
geography (e.g. trade costs) which are highly context dependent; in contrast, the elasticities
govern the strength of economic interactions (e.g. the elasticity of demand) that may be
similar across locations.
    Part (i) of the Theorem applies Lemma 1 to show that there exists a unique solution and
that solution can be computed with an iterative algorithm that converges at a rate  (A).
In particular, denote equation (1) as x = T (x); then for any initial "guess" of a positive
                      ×H
solution x0  RN                                 1        0     2        1    3          2
                    ++ , one simply iterates x = T (x ), x = T (x ), x = T (x ), ... until
convergence. The restriction that fijh : RN   ++  R++ further guarantees that the solution is
strictly positive (something not guaranteed by the original Lemma).
    Part (ii) of the Theorem deals with the case of  (A) = 1, which turns out to be a
common phenomenon in economic modeling (see Remark 4 below). It establishes uniqueness
by imposing extra conditions on the elasticities ih,jh (xj ): if either the elasticities are strictly
smaller than their bounds (part ii.a) or the elasticities are constant (part ii.b) then uniqueness
can be assured.
    Finally, since whether or not a system of the form of equation (1) has a unique solution


                                                 7
in general depends on the particular specification of heterogeneity of agents, our choice to
abstract from agent heterogeneity comes at the cost of preventing us from providing necessary
conditions for uniqueness. Nonetheless, part (iii) of Theorem 1 shows that the conditions
provided are "globally necessary". That is, for any matrix of elasticity bounds A such that
 (A) > 1, one can construct a set functions that govern the interactions {fijh } with a
corresponding A where multiple equilibria are assured.8 Such functions can be constructed
even restricting attention only to functions with constant elasticities. Put another way, the
sufficient conditions for uniqueness provided in the Theorem 1 are the best that can be
provided when abstracting from agent heterogeneity.


2.2     Remarks
We provide below five remarks that both facilitate the implementation and extend Theorem
1. Details are presented in Online Appendix B.1.
   The first two remarks provide extensions to Theorem 1.
Remark 1. (Generalized Domain) Although above we define fijh (·) as a function solely of
xj , Theorem 1 can be extended to allow fijh (·) to be a function of the full set of equilibrium
                                    ×H
outcomes x for all j i.e. fijh : RN++   R++ . Doing so requires replacing the condition on
                                              ln fijh (x)
elasticity | ijh,jh (xj )|  (A)hh with mN  ln x            (A)hh . The remainder of Theorem
                                                    mh
1 and its proof is unchanged. This generalization allows that the impact that agent j has
on agent i through an interaction of type h can depend on the equilibrium outcomes of any
other agents (including i's own outcomes).

Remark 2. (Presence of Endogenous Scalars) In addition to equilibrium outcomes for
each agent and interaction, certain economic systems also contain an endogenous scalar that
reflects e.g. the aggregate welfare of the system, as in:

                                             N
                                  h xih =          fijh (xj 1 , ..., xjH ) ,                       (3)
                                            j =1


where h > 0 is endogenous. We offer two results for such systems.
   The first result concern the equilibrium system (3) with constant elasticities (as in The-
orem 1 part(ii)b). For this form, if  (A) = 1, we have the same conclusion as in part (ii)b:
the {xih } of any solution is column-wise up-to-scale unique. If  (A) < 1, it is possible to
subsume the endogenous scalars into the equilibrium outcomes through a change in vari-
ables, expressing equation (3) as in equation (1), which in turn implies that the {xih } are
  8
   Part (iii) of Theorem 1 extends the result of Allen and Donaldson (2018) to equilibrium systems with
more than two equilibrium interactions (i.e. H > 2).

                                                     8
column-wise up-to-scale unique. (Separating the {xih } and {h } to determine the scale of
{xih } requires the imposition of further equilibrium conditions, e.g. aggregate labor market
clearing conditions).
    The second result concerns the the equilibrium system (3) with H additional aggregate
constraints of the form N  i=1 xih = ch for known constants ch > 0. This system has a unique
                              1
solution as long as  (A) < 2    , where A is defined as in Theorem 1. Intuitively,  (A) < 1 2
ensures that the feedback effect from changes in the endogenous scalar are small enough to
continue to ensure a contraction.

   The next remark facilitates implementation of Theorem 1.
Remark 3. (Change of variables) It is often useful to consider a change of variables of
one's original equilibrium system when writing it in the form of equation (1). A particularly
important example that has found widespread use in spatial economics9 is the following
economic system in which the elasticities are constant:


                                                                        
                                    xih
                                      hh
                                           =         Kijh         xih
                                                                    hh
                                                                       xjh
                                                                         hh
                                                                            .                       (4)
                              h H              j N          h H


for all i  N and h  H where hh , hh , and hh are (h, h )th cells of matrix , K , and B,
respectively. To transform equation (4) to the form of equation (1), if  - K is invertible,
                                hh -hh
we can redefine x ~ih  h H xih          . Substituting this definition into the right-hand-side
                                      hh
we obtain x ~ih = j N Kijh h H x     ~jh , where hh is the corresponding element of matrix
           -1
B(-K) , which is in the form of (1) with (A)hh = |hh |. Note that a change of variables
is not just analytically convenient: the presence of the absolute value operator in Theorem 1
means that a change of variables may reduce the spectral radius, making it more likely that
the sufficient conditions for uniqueness are satisfied.

   The last two remarks offer details about the spectral radius.
Remark 4. (Spectral Radius of 1) In practice,  (A) = 1 is a general phenomenon in
economic systems which include nominal variables (e.g. prices). Indeed, any economic
system of the form (4) that is homogeneous of degree 0 in at least one of its arguments will
have spectral radius  (A) equal to 1 or larger. This implies that part (i) of Theorem 1 is
applicable to economic systems where all economic interactions are real, whereas part (ii) of
Theorem 1 is applicable to economic systems where some economic interactions are nominal.
   9
     See e.g. Eaton and Kortum (2002); Alvarez and Lucas (2007); Chaney (2008); Arkolakis, Costinot, and
Rodr´ iguez-Clare (2012); Allen and Arkolakis (2014); Redding (2016); Monte, Redding, and Rossi-Hansberg
(2018).


                                                     9
Remark 5. (Characterization of the Spectral Radius) While it is straightforward to
numerically calculate  (A) to apply the results of Theorem 1, analytical characterizations
are also possible. We offer two results to facilitate such characterization. The first is well
known: the Collatz­Wielandt Formula (e.g. see Page 670 in Meyer (2000)), implies that if
the summation of each row (or column) of A is less than 1, then  (A)  1.
    The second is, to our knowledge, new. Define g (s) as the determinant of matrix sI - A
i.e. g (s) = |sI - A| and denote its k -th derivative as g (k) (s). For any constant s > 0,
 (A)  s if and only if g (k) (s)  0 for all k = 0, 1, 2, ..., n - 1.


3     Applications
In this Section, we apply Theorem 1 to provide new results to three seminal papers examining
spatial networks, production networks, and social networks, respectively. For brevity, we
present only a brief summary of the results here, relegating a more detailed discussion of
each application to Online Appendix B.2.


3.1    Spatial Networks
The first example we consider is one of a urban spatial network. We follow the seminal
work of Ahlfeldt, Redding, Sturm, and Wolf (2015), where agents choose where to reside and
work in a city subject to commuting costs in the presence of spatial agglomeration spillovers
which decay over space. In that paper, uniqueness is proven only in the absence of these
spillovers. Here, we use Theorem 1 to provide conditions for uniqueness in the presence
of agglomeration spillovers. Unlike Ahlfeldt, Redding, Sturm, and Wolf (2015), however,
we assume residential and commercial floor spaces are exogenously given. Interpreting the
spatial network model through the lens of our framework, an economic agent is a city block
and there are three types interactions between agents: interactions through the goods market,
interactions through the labor (commuting) market, and interactions through the spatial
productivity spillovers. These interactions in turn determine the three types of equilibrium
(strictly positive) outcomes for each agent: the residential floor price, the number of workers
employed, and the productivity. As in the original paper, let  denote the labor share in
the production function,  > 0 denote the commuting elasticity, and  denote the strength
of the agglomeration spillover. Applying Theorem 1, a sufficient condition for uniqueness is
                   
  min 1 - , 1+        , i.e. uniqueness is guaranteed as long as the agglomeration spillovers are
not too large and are bounded above by a combination of the land share and the commuting
elasticity.


                                               10
    We note that this commuting model is one example of how to apply theorem Theorem 1
to spatial networks. In Online Appendix B.2 we also apply Theorem 1 to (1) trade models
with tariffs and and input-output interactions (extending the parameter range provided by
Alvarez and Lucas (2007) where uniqueness is assured); and (2) economic geography models
with agglomeration productivity spillovers that decay across space (extending the frameworks
of Allen and Arkolakis (2014) and Redding (2016), where spillovers are assumed to only be
local).


3.2     Production Networks
The second example we consider is one of a sectoral production network. We follow the
seminal work of Acemoglu, Carvalho, Ozdaglar, and Tahbaz-Salehi (2012), who consider a
production economy where each sector uses intermediate inputs from every other sector.
In that paper, the production function is assumed to be Cobb-Douglas between labor and
intermediates and Cobb-Douglas across intermediates. Here, we use Theorem 1 to provide
conditions for uniqueness when we allow for a more general production function with non-unit
elasticities of substitution both between labor and intermediates and across intermediates.10
    Interpreting this production network through our framework, an economic agent is a
sector, and the interactions are through intermediate input usage. Using Theorem 1, we can
show that the equilibrium is always unique, regardless of the unit elasticity of substitution.


3.3     Social Networks
The third example we consider is one of a social network. We follow the seminal work of
Brock and Durlauf (2001), where agents make a discrete choice over a set of actions and
their payoffs of each actions depends on the choices on others in their social network. In
that paper, conditions for uniqueness are provided when agents have a choice set of two
actions and the effect of others' actions on an agent's payoffs is summarized by their mean
actions. Here, we apply Theorem 1 to an extension with an arbitrary number of actions in
the choice set and where the effect of others' actions on an agent's payoffs is summarized by
a generalized weighted mean, where weights can be individual specific, i.e. we allow for an
arbitrary social network. Unlike Brock and Durlauf (2001), however, we assume private and
social component of utility are proportional rather than additive.
    Through the lens of our framework, each individual in the social network is an economic
agent and each of the actions in the choice set comprises a different economic interaction.
  10
   Carvalho, Nirei, Saito, and Tahbaz-Salehi (2019) consider this general formulation and Carvalho and
Tahbaz-Salehi (2019) the case with unit elasticities between labor and intermediates.


                                                 11
Each of these interactions in turn result in an equilibrium outcomes for each agent, which
is the expected payoff of choosing each action. As in the original paper, let  denote the
shape value of the extreme value distribution (which governs the relative importance of the
random utility coefficient in agent's payoff) and let J denote the strength of social spillovers.
                                                                      1
Applying Theorem 1, a sufficient condition for uniqueness is J < H      where H is the number
of actions in the choice set, i.e. the greater the number of economic interactions, the weaker
the social spillovers must be to ensure uniqueness.


4     Conclusion
In this note, we provide sufficient conditions for the uniqueness and computation of the
equilibrium for a broad class of models with large numbers of heterogeneous agents simul-
taneously interacting in a large number of ways. The conditions are written in terms of the
elasticities of the economic interactions across agents. These results are based on a multi-
dimensional extension of the contraction mapping theorem which allows for the separate
treatment of the different types of these interactions. We illustrate that a wide variety of
heterogeneous agent economies ­ characterized by spatial, production, or social networks ­
yield equilibrium representations amenable to our theorem's characterization.
    By construction, the conditions provided here depend only on the uniform bound of the
elasticities of agent's interactions on each other's outcomes rather than the particular form
of the network model; that is, the conditions provided abstract from agent heterogeneity.
We show that should the conditions provided not hold, there exist network models for which
multiplicity is guaranteed, i.e. our conditions are "globally" necessary. However, an out-
standing and important question remains about how agent heterogeneity itself shapes the
positive properties of model equilibria.




                                               12
References
Acemoglu, D., V. M. Carvalho, A. Ozdaglar, and A. Tahbaz-Salehi (2012): "The network
 origins of aggregate fluctuations," Econometrica, 80(5), 1977­2016.

Ahlfeldt, G. M., S. J. Redding, D. M. Sturm, and N. Wolf (2015): "The economics of
 density: Evidence from the Berlin Wall," Econometrica, 83(6), 2127­2189.

Allen, T., and C. Arkolakis (2014): "Trade and the Topography of the Spatial Economy," The
  Quarterly Journal of Economics.

Allen, T., C. Arkolakis, and Y. Takahashi (2020): "Universal gravity," Journal of Political
  Economy, 128(2), 393­433.

Allen, T., and D. Donaldson (2018): "The geography of path dependence," Unpublished
  manuscript.

Alvarez, F., and R. E. Lucas (2007): "General Equilibrium Analysis of the Eaton-Kortum
  Model of International Trade," Journal of Monetary Economics, 54(6), 1726­1768.

Arkolakis, C., A. Costinot, and A. Rodr´   iguez-Clare (2012): "New Trade Models, Same
 Old Gains?," American Economic Review, 102(1), 94­130.

Arrow, K. J., F. Hahn, et al. (1971): "General competitive analysis," .

Baqaee, D. R., and E. Farhi (2018): "Macroeconomics with heterogeneous agents and input-
  output networks," Discussion paper, National Bureau of Economic Research.

Berry, S., A. Gandhi, and P. Haile (2013): "Connected substitutes and invertibility of de-
  mand," Econometrica, 81(5), 2087­2111.

Brock, W. A., and S. N. Durlauf (2001): "Discrete choice with social interactions," The Review
  of Economic Studies, 68(2), 235­260.

Carvalho, V. M., M. Nirei, Y. Saito, and A. Tahbaz-Salehi (2019): "Supply chain dis-
 ruptions: Evidence from the great east japan earthquake," forthcoming, Quarterly Journal of
 Economics.

Carvalho, V. M., and A. Tahbaz-Salehi (2019): "Production networks: A primer," Annual
 Review of Economics, 11, 635­663.

Chaney, T. (2008): "Distorted Gravity: The Intensive and Extensive Margins of International
 Trade," American Economic Review, 98(4), 1707­1721.

Costinot, A., and A. Rodriguez-Clare (2013): "Trade theory with numbers: Quantifying the
 consequences of globalization," Discussion paper, National Bureau of Economic Research.

Eaton, J., and S. Kortum (2002): "Technology, Geography and Trade," Econometrica, 70(5),
  1741­1779.

Elliott, M., and B. Golub (2019): "A network approach to public goods," Journal of Political
  Economy, 127(2), 730­776.


                                             13
Ferna´ ndez-Villaverde, J., J. F. Rubio-Ram´   irez, and F. Schorfheide (2016): "Solution
  and estimation methods for DSGE models," in Handbook of macroeconomics, vol. 2, pp. 527­724.
  Elsevier.

Fine, B., and G. Rosenberger (1997): The Fundamental Theorem of Algebra. Springer Science
  & Business Media.

Gale, D., and H. Nikaido (1965): "The Jacobian matrix and global univalence of mappings,"
 Mathematische Annalen, 159(2), 81­93.

Glaeser, E., and J. Scheinkman (2002): "Non-Market Interactions," in In Advances in Eco-
 nomics and Econometetrics: Theory and Applications, Eighth World Congress, ed. by M. Arm-
 strong, and R. Porter. Cambridge, UK: Cambridge University Press.

Glaeser, E. L., B. I. Sacerdote, and J. A. Scheinkman (2003): "The social multiplier,"
 Journal of the European Economic Association, 1(2-3), 345­353.

Hawkins, D., and H. A. Simon (1949): "Note: some conditions of macroeconomic stability,"
 Econometrica, Journal of the Econometric Society, pp. 245­248.

Iritani, J. (1981): "On uniqueness of general equilibrium," The Review of Economic Studies, 48(1),
  167­171.

Kehoe, T. J. (1985): "Multiplicity of equilibria and comparative statics," The Quarterly Journal
 of Economics, pp. 119­147.

Kehoe, T. J., J. Whalley, et al. (1985): "Uniqueness of equilibrium in large-scale numerical
 general equilibrium models," Journal of Public Economics, 28(2), 247­254.

Kennan, J. (2001): "Uniqueness of positive fixed points for increasing concave functions on Rn:
 An elementary result," Review of Economic Dynamics, 4(4), 893­899.

Lucas, R., and N. L. Stokey (1989): Recursive methods in economic dynamics. Harvard Uni-
  versity Press.

Mas-Colell, A., M. D. Whinston, and J. R. Green (1995): Microeconomic Theory. Oxford
 University Press, Oxford, UK.

Meyer, C. D. (2000): Matrix analysis and applied linear algebra. Siam.

Monte, F., S. J. Redding, and E. Rossi-Hansberg (2018): "Commuting, migration, and local
 employment elasticities," American Economic Review, 108(12), 3855­90.

Olver, P. J. (2008): "Numerical analysis lecture notes," mimeo.

Redding, S. J. (2016): "Goods trade, factor mobility and welfare," Journal of International Eco-
 nomics, 101, 148­167.

Redding, S. J., and E. A. Rossi-Hansberg (2017): "Quantitative Spatial Economics," Annual
 Review of Economics, 9(1).




                                               14
A      Appendix
A.1     Proof of Lemma 1
Proof. We prove that the sequence generated by the operator converges to a unique point.
    To prove convergence we first prove that the sequence is a Cauchy sequence on a complete
metric space. Define dmax (x, x ) = max (d (x, x )) as the metric in space X . Clearly (X, dmax )
is complete. Now consider any x  X . Denote x0 = x and for integer n  1 xn = T (xn-1 ).
For integers n and m, suppose n < m. We have

                d (xn , xm )  d xn , xn+1 + d xn+1 , xn+2 + ... + d xm-1 , xm
                          < An + An+1 + ... + Am-1 d x0 , x1
                           An + An+1 + ... + Am-1 + Am + ... d x0 , x1
                           An (I - A)-1 d x0 , x1 .                                          (5)

Notice if  (A) < 1 then An converges to zero matrix and (I - A)-1 is finite. Furthermore,
for n < m, dmax (xn , xm )  0 as n  . Therefore {xn }n=1,2,... is a Cauchy sequence on a
complete metric space and it has a limit.
    To prove existence denote the limit of the sequence y = limn xn in X . We claim
T (y ) = y . This is because T (·) is continuous, which is implied by the following formula


                           dmax (T (x) , T (x ))  max (Ad (x, x ))
                                                  Ha¯ max (d (x, x ))
                                                 = Ha
                                                    ¯dmax (x, x )

where a¯ is the largest element of matrix A. Finally, by a standard contradiction argument
the point has to be unique. We thus have established convergence, existence, and uniqueness.




A.2     Proof of Theorem 1.
Proof. Define y = ln x i.e. for any h  H i  N yik = ln xik . Thus, equation (1) can
be equivalently rewritten as yih = ln j N fijh (exp yj ) . Denote its right side as function
gih (y ), thus
                             gih     ijh,jh (exp yj ) fijh (exp yj )
                                 =                                                       (6)
                            yjh             j N fijh (exp yj )




                                               15
For any y and y , according to mean value theorem, there exists some tih  [0, 1] such that
^ = (1 - tih ) y + tih y satisfies for each i and h
y

                       gih (y ) - gih (y ) = gih (^ y ) (y - y )
                                                        gih (^y)
                                           =                     yjh - yjh                             (7)
                                             j N ,h H
                                                         y  jh


   Part (i): Combine the above two equations (6) and (7) with condition |                  ih,jh   (xj )| 
(A)hh , we have

                                                   (A)hh fijh (exp yj )
                 |gih (y ) - gih (y )|                                  yjh - yjh
                                          j N ,h H   j N fijh (exp yj )

                                                (A)hh max yjh - yjh .                                  (8)
                                                        j N
                                          h H


    For any h  H , define dh (yh , yh ) = max yjh - yjh and Yh = RN . dh (·, ·) is a metric
                                            j N
                                                                                            
                                                                              d1 (y1 , y1 )
on Yh . Furthermore, define Y = Y1 × Y2 × ... × YH and d (y, y ) =                ...        for
                                                                             dH (yH , yH )
y, y  Y . Notice that inequality (8) then becomes d (g (y ) , g (y )) Ad (y, y ). Thus we can
apply Lemma 1 to obtain the desired results (existence, uniqueness and computation).
    For the purpose of the computation, instead of applying the iterative procedure in the
space Y = RN ×H according to Lemma 1, it is equivalent to do so in the space where x lies
            ×H
on, i.e. RN++ .
    Part (ii.a):Suppose there are two distinct solutions y and y i.e. yih = gih (y ) and
yih = gih (y ). We will arrive at a contradiction. Substitute these two solutions into equation
(7). Also | ih,jh (xj )| < (A)hh when (A)hh , as long as the right side of equation (8) is not
zero, we have

                           |yih - yih | <         (A)hh max |yih - yih | .                             (9)
                                                         j N
                                            h H

Thus we have d (y, y )  Ad (y, y ) and the inequality strictly holds as long as the right side is
not zero. Since y and y are distinct. We must have d (y, y ) as a nonzero nonnegative vector.
                                                                                     (Ad)
Thus according to the Collatz­Wielandt Formula ( (A) = maxdRH       + ,y =0
                                                                            min1hH zh h Page
                                                                                       dh =0

670 in Meyer (2000)), we have  (A) > 1. A contradiction.
    Part (ii.b): We will again argue by contradiction. Suppose a pair of solutions
                                                                                x   and x
                                                                                 d1
to equation (1) exists that are column-wise up-to-scale different. That is d =  ...  is a
                                                                                 dH
nonzero vector where dh = minmax yjh - yjh + s . For any h  H, we can suppose we have
                             sR j N
sh and jh such that dh = yjh h - yjh h + sh .
   Combine the above two equations (6) and (7) with condition                ih,jh   (xj ) = hh where

                                                   16
|hh | = (A)hh , we have


                                                                fijh (exp y
                                                                          ^j )
        |gih (y ) - gih (y ) + s
                               ^h | =           hh                                  yjh - yjh + sh
                                         h H         j N      j N fijh (exp y  ^j )

                                                |hh | dh                                                        (10)
                                         h H

   where s
         ^h =        h H    hh sh . Notice that dh  max |yih - yih + s
                                                                     ^h |. Therefore we have
                                                                  iN
dh      h H |hh | dh          h H (A)hh dh i.e.

                                                     d     Ad.                                                  (11)

    If dh > 0, there there must exists h such that dh > 0 and hh = 0. For any h dh > 0,
according to the definition of dh there must exist some j  N such that yjh - yjh + sh <
dh . Thus inequality (10) must strictly hold for all i  N whenever dh > 0. Therefore
dh < h H |hh | dh  h H (A)hh dh . Thus, again, according to the Collatz­Wielandt
Formula, we have  (A) > 1, which is a contradiction.
    Part (iii): Consider {Kijh > 0}i,j N ,hH which satisfies j N Kijh = 1 for any i. Ob-
viously, x = 1 is one solution of equation (4). In the following we are going to construct
{Kijh > 0}i,j N ,hH such that there exists another different solution.
    As we have  (A) > 1, suppose z is A's non-negative eigenvector such that  (A) z =
                                                                   -                         +
Az . For a given h, divide H = {1, 2, ..., H } into two sets Hh       = {h |hh  0} and Hh      =
{h |hh > 0}; also arbitrarily divide N = {1, 2, ..., N } into 2H + 1 non-empty disjoint sets
    +     -
 Nh   , Nh   hH
                  and N 0 .
                                   ×H
    Now we construct x     ¯  RN  ++     . If j  N 0 , for any h , x
                                                                   ¯jh = 1; if j  Nh   +
                                                                                         , x
                                                                                           ¯jh =
                       +                                             +
  exp (zh )     h  Hh                -           exp (-zh ) h  Hh
                       -
                         ;  if j   N h ,  ¯
                                          x jh =                     -
                                                                       . Obviously, x is column-
  exp (-zh ) h  Hh                               exp (+zh ) h  Hh
wise up-to-scale different from x. In below, we show there exists {Kijh > 0}i,j N ,hH such
that x¯ is also a solution of equation (1).Notice that

                                   
                     Kijh         x
                                  ¯jh
                                    hh
                                       =
               j N          h H
                                                                                                     
           =          Kijh         x
                                   ¯jh
                                     hh
                                        +           Kijh          ¯jh
                                                                  x hh
                                                                       +               Kijh         x
                                                                                                    ¯jh
                                                                                                      hh

                  +          h H                -          h =H                +   -          h H
               j Nh                          j Nh                          j N
                                                                             / h ,Nh


           = exp             |hh | zh              Kijh + exp -               |hh | zh              Kijh +
                      h =H                     +                       h =H                  -
                                            j Nh                                          j Nh
                                             
               +              Kijh          x
                                            ¯jh
                                              hh
                                                                                                                (12)
                       +  -           h H
                   j N
                     / h Nh

                                                    +  -
   In the last term of above equation, for any j / Nh Nh , we have exp                              h H    |hh | zh 

                                                         17
        
  h H  x¯jh
          hh
              exp - h H |hh | zh . Notice that exp                h H |hh | zh = exp ( (A) zh )
where  (A) > 1. Therefore, we can adjust the value of {Kijh }j I while keeping j N Kijh =
                                                                                                hh
1 such that equation (12) is equal to exp (zh ) or exp (-zh ). That is we have j N Kijh h H x ¯jh  =
x
¯ih as desired.




                                             18
B      Online Appendix (not for publication)
B.1     Further Details of Remarks
   In this section, we provide further details for the remarks discussed in the paper.
B.1.1 Remark 1

    Extending the domain of fijh to all x requires only a small change to the proof of Theorem
                                                                                               ln fimh (x)
                                                                                          m     ln xjh
                                                                                                           fimh (exp y )
                                                                             gih
1, where equality (6) and inequality (8) respectively become                 yjh
                                                                                   =                  fijh (exp y )
                                                                                                j N
and
                                                                          ln fimh (x)
                                                            j N    m       ln xjh
                                                                                          fimh (exp y )
        |gih (y ) - gih (y )|          max yjh - yjh
                                 h H
                                       j N
                                                                        j N   fijh (exp y )
                                                                         ln fimh (x)
                                                           m      j N     ln xjh
                                                                                        fimh (exp y )
                           =           max yjh - yjh
                                 h H
                                       j N
                                                                       j N   fijh (exp y )

                                       (A)hh max yjh - yjh .
                                             j N
                                 h H

The rest of the proof of Theorem 1 remains unchanged.
B.1.2 Remark 2

    Consider first the equilibrium system (3) with constant elasticities, which can be written
as follows:
                                                        hh
                                  h xih =     Kijh     xjh ,                              (13)
                                               j N        h H

where h > 0 is endogenous. In the case that  (A) = 1, we have the same conclusion as
in part (ii)b: the {xih } of any solution is column-wise up-to-scale unique. The proof of this
result is exactly the same as part (ii)b of Theorem 1.
    If  (A) < 1, it is possible to subsume the endogenous scalars into the equilibrium out-
comes through a change in variables, expressing equation (13) as in equation (1). To do so,
                           d
define x~ih  xih h H hh h , where dh h is the h hth element of the H × H matrix (I - )-1
and   (hh ) (i.e.  is the matrix of elasticities without the absolute value taken) so the
system becomes:
                                                         hh
                                    x
                                    ~ih =      Kijh    x
                                                       ~jh  .
                                              j N         h H

Note that because  (A) < 1, then so too is  () < 1, so that (I - )-1 exists. From
Theorem 1 part (i), the {x~ih } are unique and can be calculated using an iterative algorithm,
which in turn implies that the {xih } are column-wise up-to-scale unique. (Separating the
{xih } and {h } to determine the scale of {xih } requires the imposition of further equilibrium
conditions, e.g. aggregate labor market clearing conditions).
   Consider now equilibrium system (3) with H additional aggregate constraints N      i=1 xih =


                                                     19
ch for known constants ch > 0.
    The second result concerns the general case with an endogenous scalar:
                                                       N
                                       h xih =               fijh (xj 1 , ..., xjH )
                                                      j =1


with H additional aggregate constraints N   i=1 xih = ch for known constants ch > 0. Substi-
tuting in the aggregate constraints allows us to express the equilibrium system as:
                                N
                                                           fijh (xj 1 , ..., xjH )
                        xih =              1        N          N
                                                                                                     ,
                                j =1      ch        i =1       j =1   fi j h (xj 1 , ..., xj H )

                                                                                                1        N      N
where the denominator is equal to the endogenous scalar, i.e. h =                              ch        i =1   j =1   fi j h (xj 1 , ..., xj H ).
We can define the new function:
                                                            fijh (xj 1 , ..., xjH )
                          gij,h (x)         1        N           N
                                           ch        i =1        j =1   fi j h (xj 1 , ..., xj H )

so that the equilibrium system becomes:
                                                             N
                                                   xih =            gijh (x) .
                                                             j =1


We can then bound the elasticities, following Remark 1. Note:
                            
                              ln fij,h               fij (xp,l )
                 ln gij,h   ln xj,l          1-                                               if m = j
                                                  o,p fop ({xp,l })
                         =
                 ln xm,l                 ln fom,h     fom,k (xp,l )
                            -                                                                 if m = j
                                                    o,p fop,k ({xp,l })
                                    o    ln xm,l


so that:                               
                                           ln fij,h                      fij,k (xp,l )
                      ln gij,h
                                                             1-                               if m = j
                                                                               ({xp,l })
                                           ln xml
                                                                        o,p fop
                               =
                      ln xm,l                       ln fom,h            fom,k (xp,l )
                                                                                              if m = j
                                 
                                                                      o,p fop,k ({xp,l })
                                               o    ln xm,l

   so that:                            
                                                                      fij,k (xp,l )
                        ln gij,h       |Akh | 1 -
                                                                                            if m = j
                                                                     o,p fop ({xp,l })
                                 
                        ln xm,l   |Akh |                       f
                                                             o om,k   (x p,l )
                                                                                            if m = j
                                  
                                                           o,p fop,k ({xp,l })




                                                               20
Finally, we can sum across all m locations to yield:

         ln gij,k                    fij,k (xp,l )                              o fom,k (xp,l )
                   |Akl | 1 -                             +          |Akl |                           
    m
         ln xm,l                    o,p fop ({xp,l })         m=j             o,p fop,k ({xp,l })

         ln gij,k                    fij,k (xp,l )                     fij,k (xp,l )
                   |Akl | 1 -                         +       1-                                
    m
         ln xm,l                    o,p fop ({xp,l })                 o,p fop ({xp,l })

         ln gij,k
                   2 |Akl | .
    m
         ln xm,l

Hence, from Remark 1, we have uniqueness as long as  (A) < 1
                                                           2
                                                             , as required.
B.1.3 Remark 3

   Here we provide a simple example of the claim that "The presence of the absolute value
operator in Theorem 1 means that a change of variables may reduce the spectral radius,
making it more likely that the sufficient conditions for uniqueness are satisfied."
   Consider the equilibrium system:
                                               N
                                                           -1
                                       xi =          Kij xi 2 xj .
                                              j =1

                                                                                     ln fijh (x)
From Remark 1, a sufficient condition for uniqueness is that                  mN     ln xmh
                                                                                                     (A)hh =
                                                                      2                     3
 -21
       + |1| = 32
                                           ~i = N
                  . The transformed system x       j =1 Kij x
                                                            ~j , where x
                                                                      3
                                                                       ~i = xi has a spectral
                                                                                            2

            2
radius of 3 . Hence, the sufficient condition for uniqueness provided from Theorem 1 is
satisfied for the transformed system but not the original system.
B.1.4 Remark 4

    Consider equation (4). We will directly prove that  (A) =  B-1  1. Suppose for
some h¯  1 that {x.h }            ¯ are nominal variables. Then if we construct {x
                                                                                 ¯.h }hH by scaling
                          h=1,...,h
{x.h }h=1,...,h
              ¯ up to t times and keeping all other entries unchanged, the constructed {x  ¯.h }hH
should still solve the equation. Therefore we can write

                                            T = BT,
where T is a H -by-1 vector and

                                              t hh  ¯
                                     Th =                  .
                                              0 other case

Notice that this further implies -1 B has eigenvalue of 1. Furthermore, because B-1 =
 -1 B -1 , B-1 also has eigenvalue of 1. We define matrix A as the absolute value of
B-1 (i.e. each entry of matrix A is the absolute value of the corresponding entry in matrix
                                                                                       1
B-1 ). Therefore  (A) must be weakly larger than 1 because  (A) = limn An n 


                                                     21
                     1
                 n
limn B-1      n
                =  B-1 .
B.1.5 Remark 5

     We prove a necessary and sufficient condition such that  (A)  1.
Lemma 2. Let A be a non-negative n × n matrix. The function f () is defined as the
determinant of matrix I - A i.e. f () = |I - A| , and its k -th derivative is denoted by
f (k) (). Then  (A)  s if and only if f (k) (s)  0 for all k = 0, 1, 2, ..., n - 1.

Proof. If part: Notice that f (n) (s) = n! > 0. Then f (n-1) () strictly increases with .
So f (n-1) () > 0 for   [s, ). Using deduction we obtain f () is strictly increasing and
f ()  0 for any   [s, ]. According to Perron­Frobenius theorem,  (A) is A's largest
eigenvalue, so that f ( (A)) = 0. Thus, by strict monotonicity it must be  (A)  s.
    Only If part: According to the Fundamental Theorem of Algebra (e.g. see Corollary
3.6.3 of Fine and Rosenberger (1997)), f () can be decomposed as f () = f1 () f2 ()
such that f1 () = iC ( - i )  - i and f2 () = iR ( - i ) where i is conjugate
of i and C and R are set of indexes. For all i  C , i is a complex number and for all
i  R i is a real number. Clearly, i and i are eigenvalues of A.Notice that f (k) () =
                  (k1 )     (k )
   (k1, k2 )Dk , f1     () f2 2 () where Dk = {k1 , k2 |k1 + k2 = k, k1 , k2  0}. When i  R i 
                                                       (k2 )                                (k1 )
 (A) (from Perron­Frobenius theorem), we have f2               (s)  0. Additionally, f1             () =
       2                   (k2,i )
  iC  - i + i  + i i               where k2,i  0 and           iC k2,i = k2 . Notice that

                                                2
                                                s - i + i s + i i > 0         k2,i   =0
                                               2 (s - Re ( ))
                                   (k2,i )                i                   k2,i   =1
           s2 - i + i s + i i                =                                          ,
                                                2>0                           k2,i   =2
                                               
                                                0                             k2,i   >3

where Re (i ) is real part of i . As Re (i ) < i   (A)  s (the second inequality is also
                                                         (k2,i )
from Perron­Frobenius theorem), so s2 - i + i s + i i             0. In all, f (k) (s)  0
k = 0, 1, 2, ..., n - 1.




B.2     Applications
   In this section, we provide more detail for the three examples discussed in Section 3.
B.2.1 Spatial Networks

   The first set of applications is examples where interactions across heterogeneous agents
take place in space. We consider an urban model (extending the results of Ahlfeldt, Redding,
Sturm, and Wolf (2015)), an economic geography model (extending the results of Allen and
Arkolakis (2014)), and a trade model (extending the results of Alvarez and Lucas (2007)) in
turn.

                                                 22
    Here we prove the uniqueness of the quantitative urban framework of Ahlfeldt, Redding,
Sturm, and Wolf (2015) with endogenous agglomeration spillovers but assume residential
and commercial land are exogenously given. In terms of our framework, each city block is a
different economic agent and there are three different economic interactions, each represented
by an equilibrium condition. The first economic interaction is through the goods market,
where we require the goods markets clear, i.e. the income in a city block is equal to its total
sales:
                                                 S
                                                                  - (1- )    1+
                                         Ii =          Kij Qi               wj                             (14)
                                                j =1

where Ii = Qi H
                Ri
                    is the total income of the residents living in location i, Qi is the rental
price in location i, wj , is the wage in location j , and Kij = -1 Ti Ej d-
                                                                          ij H > 0 is a matrix
incorporating the commuting costs between locations.
    The second economic interaction is through the labor (commuting) market, where we
require that the total number of agents working in a location, HM i , is equal to the number
of workers choosing to commute there, i.e.:
                                                       S
                                                                    - (1- )
                                        HM i =              Kji Qj            wi ,                         (15)
                                                     j =1


   Finally, the third economic interaction is through the spatial productivity spillover, where
the productivity of a city block depends on the density of nearby workers, i.e:
                                                            S
                                            1          1          e-ij
                                         Ai = a i
                                                       
                                                                       HM j .                              (16)
                                                           j =1
                                                                   Kj

   Given the assumed Cobb-Douglas production function and the assumed fixed amount of
                                                                             -1 1-
land in each location used for production, we substitute wi = Ai HM           i LM i into above
equations to create three equilibrium conditions that are a function of three outcomes:
the price of residential land, the number of agents working in a location, and the pro-
ductivity of a location. Observe that equations above are of the form of equation 4 with
{Qi , HM i , Ai }i=1,...,S as endogenous outcome variables.11 And the corresponding  and B are
                                                                                               
                  1 + (1 -  )            0        0                 0      ( - 1) (1 + ) 1 +
respectively               0       1 + (1 - ) -  and  - (1 -  )                  0         0 .
                                                   1
                           0             0        
                                                                    0            1         0
Then we have
                                                 (1-)(1+ )   (1+ )
                                                                      
                                           0      1+ (1-)   1+ (1-)
                                           - )
                                A =  1+(1(1          0         0      .
                                                                      
                                             - )
                                                      1        
                                           0      1+ (1-)   1+ (1-)

    Recall from Remark 5 that if the summation of each row of A is less than 1, then we have
  11
     Although  is also an endogenous variable, it is not location specific. Treating it exogenously is equivalent
with the equilibrium. (The equivalence can be shown by scaling {Qi , HM i , Ai }i=1,...,S .)



                                                            23
                                                                              
 (A)  1. Specifically, from Theorem 1(i), Ax  x holds as long as   min 1 - , 1+ ,
as claimed.



    We now consider the framework of Allen and Arkolakis (2014). The model yields the same
mathematical equilibrium system as in Redding (2016) and Allen, Arkolakis, and Takahashi
(2020) and thus the results apply in all these models. We extend that framework to allow
for productivity spillovers that decay over space of the form:
                                                        N
                                                ¯i
                                           Ai = A             A 
                                                             Kij Lj ,
                                                      j =1


where Ai represents the productivity of region i, A¯i its exogenous component and Li the labor
                                                 A
in region i that is determined in equilibrium. Kij  represents spatial spillovers in productivity
and  the spillover elasticity that is common across locations. Furthermore, appropriately
replacing the equilibrium conditions (corresponding to equations 10 and 11 of Allen and
Arkolakis (2014) that represent interactions through trade and the labor market) we obtain:
                                                    N
                                   -           1-            1-  -1     1+ ( -1)
                            Li A 1
                                 i  wi   =W                Tij u
                                                               ¯j Lj                
                                                                                   wj
                                                    j =1

                                                        N
                              (1- ) 1-           1-           1-  -1  -1 1-
                            Li     wi      =W                Tji u
                                                                 ¯i Aj wj ,
                                                      j =1

where wi is the wage in location i, u
                                    ¯i the exogenous amenity,  the local amenity spillover
elasticity and  the demand elasticity. Tij represents the matrix of trade costs to ship goods
across locations.12
    We can write the parametric parametric matrices corresponding to Theorem 1 as
                                                                                   
                    1     1-                         1 +  ( - 1)      0       
          =   (1 -  )       0    1 -  , B =                0         - 1 1 -  .
                    0       1       0                                 0       0

Therefore,
                                              
                                                          
                                      1       -1
                                                   -1
                           -1    =   ( - 1)  1 +  ( - 1)2 
                                               1
                                      0     - -  1
                                                   0
and
                                                  - 1 +  ( - 1)2
                                                                 
                         1 +  ( - 1)    
               B-1     =   ( - 1)2    ( - 1) + 1  - 1 +  ( - 1)3  .
                                        
                                        -1
                                                     ( - 1)
  12
                                                       ¯i L
     Overall amenity of living in a location i is ui = u   i ,i.e. it depends on local population. The amenity
is assumed to affect welfare of a location multiplicatively.


                                                      24
   We consider the case that  < 0 <  which allows for the spectral radius to be less
or equal than one. The case ,   0 always implies a spectral radius bigger than one.
When  < 0 the first two rows of B-1 may be negative. Notice that ( - 1) B-1 22 <
( - 1) B-1 11 = B-1 13 and ( - 1) B-1 22 < B-1 23 . There is a number of
cases to discuss. Here we only consider the case B-1 22  0; other cases can be derived
similarly.
   If B-1 22 > 0 i.e.  > - (1    -1)
                                     , then we have

                                                - 1 +  ( - 1)2
                                                               
                         1 +  ( - 1) -
             B-1      =  - ( - 1)2  ( - 1) + 1  - 1 +  ( - 1)3  .
                                      
                                      -1
                                                   ( - 1)

A sufficient condition for  B-1  1 is that the summation of each column is smaller
than 1 (see Remark 5). Thus we have

                                  +  ( - 1) (2 -  )  0
                                   
                                      +  (2 -  )  0
                                  -1
                                                                     1
                                             +  ( - 1)                  - 2.
                                                                     -1

The three inequalities and  > - (1
                                 -1)
                                     can guarantee  B-1                              1 and, therefore, unique-
ness.



   We now analyze the celebrated Ricardian model developed by Eaton and Kortum (2002)
specified with tariffs and input-output network as in Alvarez and Lucas (2007).
   The equilibrium of their model can be characterized by the three equations below (cor-
responding to equations 3.8, 3.15, and 3.17 respectively in Alvarez and Lucas (2007)),
                                                                                    1
                                      n                         -                  -
                                                 1 AB                          -
                                                                       1-
                          pmi =             j                        wj pmj              ,                (17)
                                     j =1
                                                 ij ij

                                                       n        w j 1 - sf
                                                                         j
                             Li wi (1 - sf i ) =           Lj                 Dji ji ,                    (18)
                                                   j =1
                                                                     Fj
                                                           n
                                                Fi =           Dij ij ,                                   (19)
                                                       j =1

                1-    -              -1/
             (wj pj )        AB
where Dij       p-           ij ij
                                            j is country i's per capita spending on tradeables that is
                 mi
                                           [1-(1- )Fi ]
spent on goods from country j and sf
                                   i = (1-)Fi +[1-(1- )Fi ] is labor's share in the production
of final goods (equations 3.10 and 3.16 in Alvarez and Lucas (2007)) and the endogenous

                                                           25
variables are: pmi , the price index of tradeables in country i; Fi , the fraction of country i's
spending on tradeables that reaches producers; and wi , country i's wage. Finally, ij is the
bilateral tariff.
    Now we show how to transform the equilibrium equations into the form of equation (4).
                                                                                                              -
                                                                                                      1 AB            1
First, raise both sides of equation (17) to the power of - and denote j                               ij ij
                                                                                                                  as Kij ,
then we can rewrite equation (17) as
                                               n
                                                        1 -           -(1- )
                                   p-
                                    mi
                                      
                                         =             Kij wj pmj              ;                                     (20)
                                             j =1

Second, substitute the expression of Dij into equation (19), multiply both sides by p- 
                                                                                     mi , and
                       -
               1 AB            2
denote ij j    ij ij
                           as Kij , then we can rewrite equation (19) as
                                                   n
                                                        2 -            -(1- )
                                  p- 
                                   mi Fi   =           Kij wj pmj                  ;                                 (21)
                                               j =1

              ~i  +( - ) Fi , substitute equation (19) into it, and notice that n Dij =
Third, define F                                                                 j =1
1. Thus we have F~i = n Dij [ + ( - ) ij ] . Again, substitute the expression of Dij ,
                      j =1
                                                                                               -
multiply both sides by p- 
                        i , and denote [ + ( - ) ij ] j
                                                                                       1 AB
                                                                                       ij ij
                                                                                                       3
                                                                                                   as Kij , then we can
have equation
                                                   n
                                      ~                  3 -            -(1- )
                                  p-
                                   mi Fi   =            Kij wj pmj                                                   (22)
                                               j =1

Last, substitute the expressions of sf i and Dji into equation (18) , subsequently replace
                                                                                     -
 + ( - ) Fi with F   ~i , multiply both sides by p(1- ) w and define Lj ji j 1 AB       as
                                                  mi     i            Li      ij ij
 4
Kij , then we can rewrite equation (18) as
                                                               n
                             (1- ) ~ -1 w1+                            4     ~ -1 p
                            pmi Fi F i   i                =           Kij wj F j   mj .                              (23)
                                                              j =1

    Now we have transformed the equilibrium equations into the form (4) but with four
                                       ~i , wi
set of endogenous variables pmi , Fi , F                                       1
                                               . Notice that all the kernels, Kij         4
                                                                                  , ..., Kij ,
                                                        i=1,2,...,n
defined above are positive when , ,  > 0 and 0 < ij  1. Then we have the corresponding
parameter matrices
                                                                           
                    -       0 0     0              - (1 -  )  0 0 -
                    -       1 0     0    , B =  - (1 -  )  0 0 - 
                                                                           
          =         -       0 1     0              - (1 -  )  0 0 - 
                 (1 -  )  1 1 1 +                             0 -1     1
                         1
The determinant of  is - 2 +
                             = 0. This implies  is always invertible as long as  > 0.
Therefore, we have


                                                         26
                                                                                          
                                               1-             0         0            
                                 -1
                                                0             0         0            0    
                             B        =
                                                                                          
                                                0             0         0            0    
                                                                                          
                                              1-(1- )2              1        |1-(1- )|
                                                +1/
                                                              0     +1          +1

    Here 1  (1 -  ) or   1             2
                                         is sufficient for  B-1  1 i.e. we have (up-to-
scale) uniqueness. In comparison, the essential conditions for uniqueness in Alvarez and
                                                                      2
Lucas (2007) are i) (mini,j =1,2,...,n {ij } mini,j =1,2,...,n {ij })   1 -  ; ii)    ; iii) 1 -
                         
mini,j =1,2,...,n {ij }  - 
                            (see their Theorem 3).13



B.2.2       Production Networks

   We next study economic interactions that arise from from input-output production link-
ages.
   Constant Elasticity Among Intermediates
   We first consider a direct extension of the framework by Acemoglu, Carvalho, Ozdaglar,
and Tahbaz-Salehi (2012) where the production function is Cobb-Douglas in labor and inter-
mediates. Instead, we assume that intermediates across all sectors are aggregated through
a constant elasticity of substitution aggregator different sectors with an elasticity  . This
extension is explicitly discussed in Carvalho and Tahbaz-Salehi (2019) as a special case of the
nested CES case considered by Baqaee and Farhi (2018). Formally the production function
is                                                       
                                                           2
                                                                             -1
                                                                    -1
                                                 1
                                      yi =   zi li                xji
                                                                                  
                                                          j

where zi stands for the productivity and is exogenous, li is the labor, xji is the intermediate
goods from sector j , and 1 + 2 = 1.
   Therefore, from cost minimization we have the price of the goods produced in sector i
                                                        ¯ 1
                                              pi =         w (Pi )2                                             (24)
                                                        zi
                       1 2
where we define ¯ = 1   2 , w is the wage, and the price index of intermediate goods Pi is
determined in the following equation

                                             Pi1- =            1- 1-
                                                               ji pj                                            (25)
                                                          j

  13                                                                                            (1- )-
       If 1  (1 -  ) , we can solve explicitly the eigenvalues are                   0, 0, 1,     1+
                                                                                                         . Obviously,
 (1- )-
   1+        < 1, thus the uniqueness holds. If 1 < (1 -  ) , the characteristic polynomial is f (x) =
        2                  3   2
          -2 +/ 3
x4 + 2     +1/     x + 2 -4 +      +/ -1/ 2
                                 +1/        x . According to Lemma 2, we can check the value of f (k) (1) for
k = 0, 1, 2, 3, a sufficient condition to guarantee  B-1  1 is   2       1
                                                                           . (In this case the sufficient and
                            3     2                        3    2
necessary condition is 4 - 2 + 2/ + 5/  0 and 2 + 2 +  + 4/ - 1/  0 when 1 < (1 -  ) .)


                                                          27
where ji stands for the standard iceberg trade cost but can be interpreted here as the cost
of adaption of the good as an intermediate in another sector. Substitute the expression of
      ¯ 1 2
pj = z j
         w Pj (equation (24)), into (25) we immediately obtain

                                                               1-
                                               ¯ 1                                  2 (1- )
                                  Pi1- =          w                  1-
                                                                     ji Pj                    .        (26)
                                           j
                                               zj

   Normalize the wage w to be 1. Notice that since zi is exogenous, this equation (for all i)
determines the price indexes {Pi }. Therefore, as long as consumer utility function satisfies
concavity condition, this equation alone can represent the equilibrium. Define xi  Pi1-
                             1-
                 ¯ 1              1-
and fij (xj )   zj
                   w              ji xj , thus the above equation is the form of equation (1). We
                    ln f
immediately  have  ln xijj
                          = 2 , so uniqueness and convergence of an iterative operator require
|2 | < 1, which is satisfied as long as labor is used in production.



    We now consider the generalization of the production networks setup in Acemoglu,
Carvalho, Ozdaglar, and Tahbaz-Salehi (2012) as discussed in Carvalho, Nirei, Saito, and
Tahbaz-Salehi (2019) to incorporate constant elasticity of substitution between intermediate
goods.
    Consider a static economy consisting of n competitive firms denoted by {1, 2, · · · , n}, each
of which producing a distinct product. Firms employ nested CES production technology
                                                                                           
                                               1                -1          1        -1    -1
                              yi =  (1 - µ) (zi li )
                                                                     + µ Mi          




where li is the amount of labor, zi is the (exogenous) labor productivity, and the intermediate
input bundle Mi is a CES aggregate of inputs purchased from other firms:
                                                                         
                                                    n      1      -1     -1
                                                                  
                                        Mi =              aij xij               .
                                                   j =1


We remark that Carvalho, Nirei, Saito, and Tahbaz-Salehi (2019) also include firm-specific
capital in the production function; however, given that it is assumed to be supplied inelas-
tically, it is isomorphic to the exogenous labor productivity term zi .
    Solving the cost minimization problem of the firm results in the following system of
equations for equilibrium prices:
                                                                                                  1-
                                                                        n                         1-
                            -                       1-                                 -
                         p1
                          i   = (1 - µ) (zi w)             +µ                   asm p1
                                                                                     m
                                                                       m=1




                                                          28
which in turn can be written as:
                                                            1-
                                                                      n
                               - (1 - µ) (zi w)1-
                             -                              1-
                          p1
                           i                                                      -
                                                                 =         asm p1
                                                                                m .
                                     µ                               m=1

                                                                                     1-
                                                            -
                                                         p1   -(1-µ)(zi w)1-         1-
Normalizing the wage w = 1 and defining xi                i
                                                                  µ
                                                                                          , this becomes:

                                  N                                         1-
                                                 1-                         1-
                                                 1-                 1-
                          xi =          aij µxj       + (1 -    µ) zj            ,
                                 j =1

                                                                                                   1-
                                                                     1-                            1-
                                                                     1-                       1-
which is a special case of equation (1) with fij  aij µxj                  + (1 - µ) (zj )              .
   Note that:
                                                                       1-

                   ln fij      1-          1-                      µxj1-
                          =                              1-                                =
                   ln xj       1-          1-
                                                       µxj1- + (1 - µ) (zj )1-
                                           1-

                  ln fij                 µxj1-
                         =       1-                         < 1,
                  ln xj
                              µxj1- + (1 - µ) (zj )1-

so that by Theorem 1 (part ii.a), there exists at most one equilibrium.



B.2.3    Social Networks

    Here we consider a discrete choice framework with social interactions as in Brock and
Durlauf (2001), generalized to include a choice set of more than two actions. Suppose there
are N individuals where each individual i  {1, ..., N } chooses from a set of H actions, where
hi  {1, ..., H } indicates her choice. Let the N -tuple   {h1 , ...., hN } denote the actions by
entire population and let  -i denote the actions of all individuals except i.
    Let agent i s payoffs for choosing action h consists of three components:

                                   Vih = uih + Sih ( -i ) + ih ,

where uih is the private utility associated with choice h, Sih ( -i ) is the social utility as-
sociated with the choice, and ih is a random utility term, independently and identically
distributed across agents. In equilibrium, an agent will choose the action hi that maximizes
her payoffs given the actions of others, i.e:

                               hi ( -i )  arg         max       Vih ( -i ) .
                                                  h{1,...,H }


Define µijh to be the conditional probability measure agent i places on the probability that

                                                   29
agent j chooses action h. We assume that Sih ( -i ) takes the following form:
                                                              1
                                                                
                                                                                   
                                                                             
                          Sih ( -i ) = J ln                  ij,h (µijh )             ,
                                                     j =i


where J governs the strength of the social interaction, ij,h (normalized so that j =i ij,h =
1) are weights that agent i places on agent j 's choice of action h to capture heterogeneity in
the social network connections, and the parameter   (-, ) determines what type of
mean aggregation is used across other individuals (e.g.  = - is the minimum,  = -1 is
the harmonic mean;  = 0 is the geometric mean;  = 1 is the arithmetic mean; and  = 
is the maximum). We note that the log transform on the social utility function ­ not present
in the primary case considered by Brock and Durlauf (2001) ­ ensures that the uniqueness of
the equilibrium can be characterized without reference to an (endogenous) threshold value
(c.f. Brock and Durlauf (2001) Proposition 2).
    The presence of weights ij,h and the flexibility of the particular mean function (governed
by parameter  ) ­ both of which are absent in the particular functional forms characterized
by Brock and Durlauf (2001) ­ allow for flexible social interactions between individuals in
the network. However, the uniqueness conditions provided below turn out to only depend on
the strength of the social interaction J . Note that without loss of generality we can define
the private utility as follows uih  ln vih , which allows us to interpret J as the parameter
which governs the extent to which social interactions determine the choice of agents. A value
of J = 0 means that decisions are only made by private considerations of utility, whereas a
value J = 1 means that social utility and private utility vih are given equal proportions in
the utility function.
    Retaining the assumption from Brock and Durlauf (2001) that the random utility term
follows an extreme value distribution with shape parameter  and agent's conditional prob-
abilities are rational (so that µijh = µjh for all j  {1, ..., N } and µjh is equal to the
probability agent j actually chooses action h) results in the following equilibrium conditions
for all i  {1, ..., N } and for all h  {1, ..., N }:
                                                                                      1   J
                                                                                      
                               exp (uih ) ×              j =i   ij,h (µjh )
                    µih =                                                                 1      J
                                                                                                     (27)
                               H                                                          
                               k=1   exp (uik ) ×               j =i   ij,k (µjk )

Note this is a system of N × H equilibrium conditions in N × H unknown probabilities µjh .
                                                                                              
                                                                  J
Equation (27) is a special case of (1). To see this, define yih  µih , so that equation (27)
becomes:
                                                                             J
                                       exp    u
                                             J ih
                                                         ×      j =i   ij,h yjh
                       yih =                                                       J
                                                                                           
                                                                                          J
                                     H                                       J      
                                     k=1     l=i   exp    u
                                                         J ik
                                                                       il,k ylk




                                                    30
                                                           J
Furthermore, define xih         l=i   exp     u
                                             J ih
                                                     il,h ylh so that equation (27) becomes:
                                                            xih
                                           yih =                             .
                                                                   J     J
                                                         H          
                                                         k=1   xik

Then given the definition of xih , we have:
                                                                                            J

                                                                             xjh           
                      xih =          exp      uih ij,h                                          .                 (28)
                                                                                           
                                                                                           

                              j =i
                                            J                            H
                                                                                   J
                                                                                    
                                                                                         J 

                                                                         k=1     xjk

                                                                           J

                                 
                                                             xjh           
Finally, defining fijh  exp       u
                                 J ih
                                           ij,h                 J
                                                                        
                                                                                       if j = i and fiih = 0 results in
                                                                       J   
                                                         H       
                                                         k=1   xjk

equation (28) be written as:
                                               N
                                      xih =          fijh (xj 1 , ..., xjH ) ,
                                              j =1


as in (1). It is straightforward to provide bounds on the elasticities of interactions as follows:
                                                    J     
                                                     
                             ln fij,h              xjh
                                      = J 1 -          J
                                                            [0, J ]
                             ln xj,h              H     
                                                  k=1 xjk

and, for h = h:                                                J         
                                                              
                            ln fij,h                        xjh
                                     = -J                            J
                                                                           [-J, 0]
                            ln xj,h                        H          
                                                           k=1     xjk
   So that if we define:
                                               (A)hh  J
then we have for all h, h :
                                              ln fij,h
                                                        (A)hh
                                              ln xj,h
Since the largest eigenvalue of a constant positive square matrix is that constant divided by
                                                                                    1
the number of rows, Theorem 1(i) implies that we have uniqueness as long as J < H     . Hence,
as as the size of agent's choice set increases, guaranteeing uniqueness requires increasingly
weak social spillovers.




                                                        31
B.3     Additional Remarks

B.3.1   Footnote 4

   Here we illustrate the importance of treating the endogenous as H vectors with N ele-
ments instead of one giant variable with N H elements. To focus on the ideas, we set N = 1.
Consider the below example:
                                                   1
                                       x11 = x11
                                              2
                                                 x2
                                                  12 + 1
                                                        1
                                        x12 = x12
                                               2
                                                  +1
   (Here, in order to be consistent with the paper, we do not suppress the notation of N .)
We show when the system is treated as a single 2 × 1 vector, it is not a contraction. We
consider its log transformation by setting y1 = ln x11 and y2 = ln x12 . Thus the above two
equations become:
                                             1
                                   y1 = ln e 2 y1 +2y2 + 1                             (29)
                                                       1
                                     y2 = ln e 2 y2 + 1 .                                  (30)

   Denote its right side as T (·) : R2  R2 . Its Jacobian matrix is
                                         1 y +2y      1 y +2y 
                                       1 e2 1      2            2e 2     1   2
                                          1 y +2y
                                       2 e2                      1
                           J (y ) =          1   2 +1           e 2 y1 +2y2 +1    .
                                                                        1
                                                                  1 e 2 y2
                                               0                  2 e12 y2 +1


   Notice that the tight upper bound of the Jacobian matrix is
                                                    1
                                                    2
                                                            2
                                       A=                   1        .
                                                   0        2

    For two y and y , applying the mean value theorem on the two single-valued functions of
T (·), we have
                                 |T (y ) - T (y )|  A |y - y |                         (31)
  To apply the standard contraction mapping, we treat y1 and y2 as a single vector variable.
We consider two natural choices of norms to serve for the metric used in the contraction
                                                                                    2    2
mapping: 1. the max norm y max = max (y1 , y2 ); 2. the Euclidean norm y = y1         + y2 .
  For the first norm, according to inequality (31), we have

                             T (y ) - T (y )   max         2 y-y                 max   .

Clearly, the standard contraction mapping does not apply.




                                                   32
   For the second norm, again according to inequality (31), we have

                               T (y ) - T (y )  A     y-y

where A is the A's matrix norm. Here A  2.118. Again, the standard contraction
mapping does not apply.
   In constrast, applying our multi-dimension contraction mapping, we treat y1 and y2 as
two separate variables.We immediately have  (A) = 1  2
                                                       , so that inequality (31) implies the
uniqueness.




                                            33
