                              NBER WORKING PAPER SERIES




                IMPERFECT RISK-SHARING AND THE BUSINESS CYCLE

                                       David W. Berger
                                         Luigi Bocola
                                       Alessandro Dovis

                                      Working Paper 26032
                              http://www.nber.org/papers/w26032


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                    July 2019




We thank Adrien Auclert, Anmol Bhandari, Loukas Karabarbounis, Greg Kaplan, Patrick Kehoe,
Dirk Krueger, Guido Lorenzoni, Alisdair McKay, Kurt Mitman, Luigi Pistaferri and seminar
participants at SED 2018, Atlanta Fed, Chicago Fed, UCLA, Wharton, Stanford, Harvard, UC
Davis, Saint Louis Fed, Minneapolis Fed, AEA 2019, Princeton, AMCM conference, CREI, LSE,
Bocconi, the National Bank of Belgium, University of Chicago, and EIEF. We thank Aniket
Baksy for excellent research assistance. The views expressed herein are those of the authors and
do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2019 by David W. Berger, Luigi Bocola, and Alessandro Dovis. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including © notice, is given to the source.
Imperfect Risk-Sharing and the Business Cycle
David W. Berger, Luigi Bocola, and Alessandro Dovis
NBER Working Paper No. 26032
July 2019
JEL No. E32,E44

                                         ABSTRACT

This paper studies the aggregate implications of imperfect risk-sharing implied by a class of New
Keynesian models with idiosyncratic income risk and incomplete financial markets. The models
in this class can be equivalently represented as an economy with a representative household that
has state-dependent preferences. These preference "shocks" are functions of households'
consumption shares and relative wages in the original economy with heterogeneous agents, and
they summarize all the information from the cross-section that is relevant for aggregate
fluctuations. Our approach is to use this representation as a measurement device: we use the
Consumption Expenditure Survey to measure the preference shocks, and feed them into the
equivalent representative-agent economy to perform counterfactuals. We find that deviations
from perfect risk-sharing were an important determinant of the behavior of aggregate demand
during the US Great Recession.

David W. Berger                                 Alessandro Dovis
Department of Economics                         Department of Economics
Northwestern University                         University of Pennsylvania
2001 Sheridan Road                              The Ronald O. Perelman Center
Evanston, IL 60208                               for Political Science and Economics
and NBER                                        133 South 36th Street
david.berger@northwestern.edu                   Philadelphia, PA 19104
                                                and NBER
Luigi Bocola                                    adovis@upenn.edu
Department of Economics
Landau 342
Stanford University
579 Serra Mall
Stanford, CA 94305-6072
and NBER
lbocola@stanford.edu
1     Introduction
A classic question in macroeconomics is to what extent household heterogeneity and devi-
ations from perfect risk-sharing are important for aggregate fluctuations. For a long time,
most business cycle studies relied on the representative-agent paradigm, an approach that
was partly justified by the influential result in Krusell and Smith (1998) that distributional is-
sues play a limited role for macroeconomic dynamics in standard real business cycle models.
More recently, a new line of research is reevaluating this question. Studies have shown that
in environments where risk-sharing is limited, time-varying precautionary saving motives
of households can be quite relevant for the behavior of aggregate demand, and can thus play
an important role for the business cycle if output is partly demand-determined, see Krueger,
Mitman, and Perri (2016) and Kaplan and Violante (2018) for surveys of this literature. The
answers to this question given so far, however, depend on specific features of the structural
model that are hard to discipline empirically, such as the precise set of financial assets and
risk-sharing mechanisms that are available to households and the nature of idiosyncratic risk
they face.1
    The main contribution of our paper is to demonstrate that one does not need to take a
stand on these modeling features to address this question. Our approach builds on research
by Nakajima (2005), Krueger and Lustig (2010) and Werning (2015), who show that models
where households face idiosyncratic income risk and incomplete financial markets can be
equivalently represented as an economy with a representative agent. In this equivalent
representation, the stand-in household has state-dependent preferences, which are functions
of the joint distribution of households' consumption shares and relative wages in the original
heterogeneous agent economy. These preference "shocks" capture deviations from perfect
risk-sharing, and they summarize all the information from the cross-section that is relevant
for aggregate fluctuations. The key idea in this paper is to use this representation as a
measurement device: we first measure the preference shocks using household-level data,
and show how to combine these series with the equivalent representative-agent economy to
quantify the role of imperfect risk-sharing for business cycle fluctuations. In our application,
we find that deviations from perfect risk-sharing contributed significantly to the output
decline observed during the US Great Recession but this contribution was short-lived.
    We begin by describing a class of New Keynesian models where households face idiosyn-
    1A  prominent example is Kaplan and Violante (2014), which shows that the consumption response to fiscal
transfers is very different if households can trade one liquid asset or one liquid and one illiquid asset. In ad-
dition, researchers have shown that many other modeling choices, which are inconsequential in representative
agent economy, matter in heterogeneous agent economies. These include the timing and distribution of the fis-
cal transfers (Kaplan, Moll, and Violante, 2018), how profits get distributed across households (Broer, Hansen,
Krusell, and Oberg, 2018), and the cyclicality of idiosyncratic risk and access to liquidity (Werning, 2015).



                                                       1
cratic income risk and have isoelastic preferences over consumption and hours worked. The
models in this class share the same specification for households' preferences, technology,
goods and labor market structure, and the conduct of monetary policy. They can differ in
the nature of idiosyncratic risk faced by households, the set of assets they can trade, and
their financial constraints. Each of these potential specifications imposes a particular set of
restrictions on the joint distribution of households' consumption and labor choices. How-
ever, as we show in the paper, the law of motion for aggregate variables for all the models
in this class has the same representation: that of an economy with a representative house-
hold whose preferences involve a time-varying and stochastic rate of time preference and
disutility of labor. Importantly, the mapping between these preference shocks and house-
holds' choices is the same for all the models in this class: conditional on observing their
consumption and wages, we do not need to take a stance on the details of the risk-sharing
mechanisms available and how they are modeled.
   Frictions that impede risk-sharing are summarized in this equivalent representation by
shocks to the discount factor of the stand-in household. This discount factor is the product
of the "true" rate of time-preference of households and the expectation of the inverse of
the change in consumption shares for the savers, that is the households that are on their
Euler equation for liquid assets. To understand this result, consider first the case of complete
financial markets. With our preferences, the allocation features constant consumption shares,
and the discount factor of the stand-in household coincides at every point in time with the
households' rate of time preferences. When risk-sharing is not perfect, consumption shares
are state dependent, and the two no longer coincide.
   The discount factor for the stand-in household is typically higher than the true rate of
time preference, capturing the fact that a household facing uninsurable idiosyncratic risk has
more incentives to save than a stand-in household that only needs to smooth consumption
and hours over aggregate shocks.2 Thus, the stand-in household must be more "patient"
to be on his Euler equation at the interest rate implied by the heterogenous agent economy.
The wedge between the true discount factor and the one in the equivalent representative-
agent economy can be time varying, reflecting movements in the expected growth rate of the
savers' consumption shares and their volatility.
   In addition to a time-varying discount factor, the stand-in household in the equivalent
representation also features a state-dependent preference for leisure. This preference shock
is a function of the joint distribution of idiosyncratic labor productivity and consumption
shares, and it captures compositional changes in hours worked that occur in the original
economy with heterogeneous households. As an example, consider the case in which house-
   2 Mechanically,   this follows from Jensen's inequality: if the consumption share is constant in expectation
but volatile, the expectation of the inverse of the change in consumption share is greater than one.


                                                      2
holds with relatively high productivity also have relatively high consumption. An increase
in the cross-sectional dispersion in consumption shares induces high productivity house-
holds to work less and low productivity households to work more because of wealth effects,
a compositional change that reduces worked hours in efficiency units. In the equivalent
representative-agent economy, these effects are captured by an increase in the disutility of
labor of the stand-in household ­ a reduction in labor supply.
  After describing this equivalent representation, we turn to measurement. We use the
Consumer Expenditure Survey to compute changes in consumption shares and labor pro-
ductivity at the household level for the 1996-2012 period. We divide households into groups,
depending on their income and net worth, and compute cross-sectional averages of the in-
verse change in consumption shares to measure the discount factor for different sub-groups
of the population. In the cross-section, we find that high income households have typically
higher implicit discount rates which, through the lens of our framework, identifies them
as the savers. In the time series, we find that the implicit discount factor of high income
households increases substantially during the Great Recession, which signals an increase in
their self-insurance motives. It is well known in the literature that an increase in the dis-
count factor can induce sizable output drops in New Keynesian models, especially when
nominal interest rates cannot fall because of the zero lower bound as during the Great Re-
cession (Christiano, Eichenbaum, and Rebelo, 2011). An important question is whether these
movements are large enough to be an important source of business cycle fluctuations.
  To address this question, we estimate the parameters of the equivalent representative-
agent economy and of the process governing the preference shocks and construct the coun-
terfactual path for aggregate output, inflation and nominal interest rates that would have
emerged in an economy with complete financial markets--that is, an economy with time-
invariant consumption shares and a constant discount factor. The difference between the
observed path and this counterfactual isolates the aggregate implications of imperfect risk-
sharing. Our main finding is that imperfect risk-sharing through the implied movements
in the discount factor had sizable albeit transitory macroeconomic effects, accounting for
roughly one fifth of the output decline observed in 2009 and 2010. We show that the pres-
ence of a binding zero lower bound plays a key role in amplifying these shocks, and in
reversing the positive impact that a higher propensity to save would otherwise have on
aggregate investment.
  It is important to stress that our approach is not designed to identify the primitive frictions
driving the observed deviations from perfect risk-sharing. As a last exercise, we investigate
what features of the data are responsible for the increase in the measured discount factor
during the Great Recession. Mechanically, this increase can happen for two mutually non-
exclusive reasons: the consumption shares of savers fell, or there was an increase in the

                                               3
cross-sectional dispersion of their consumption shares. We show that the observed increase
in the discount factor during the Great Recession is driven mostly by the latter effect. This
finding suggests that models aimed at capturing these patterns in the data should focus on
frictions that generate uninsured idiosyncratic risk within the group of savers.3 In addition,
we show that the increase in the cross-sectional dispersion is driven by a reduction in the
ability to smooth negative income shocks rather than by an increase in the volatility of their
labor income. These findings provide support for research that emphasizes the importance
of households' credit constraints over this episode or, alternatively, to the view that income
shocks occurring at the time were perceived to be particularly persistent.


Related Literature. Our research contributes to a growing literature that introduces hetero-
geneous agents and incomplete financial markets in New Keynesian models of the business
cycle. Researchers have used these environments to study how frictions impeding risk-
sharing across households affect the transmission mechanism of monetary and fiscal policy,4
and more generally the business cycle. In this respect, the literature has stressed the in-
teractions between households' precautionary savings and aggregate demand: when the
former increase, the latter falls, resulting in lower levels of economic activity. These changes
in households' precautionary behavior may occur via different mechanisms. Guerrieri and
Lorenzoni (2017) and Jones, Midrigan, and Philippon (2018) show that a tightening of indi-
vidual borrowing constraints can induce households to save more because of self-insurance.
Other researchers highlight the importance of time-varying labor income risk, see for exam-
ple McKay (2017), Challe, Matheron, Ragot, and Rubio-Ramirez (2017), Den Haan, Rendahl,
and Riegler (2017) and Bayer, Lütticke, Pham-Dao, and Tjaden (2019) for quantitative analy-
ses and Heathcote and Perri (2018) and Ravn and Sterk (2017) for more stylized frameworks.
   All these papers consider specific departures from perfect risk-sharing by imposing a
given asset structure, income process and set of borrowing constraints. We instead take a
more agnostic approach about the amount of risk-sharing available to households and infer
it from their observed choices. We think that these two approaches are complementary.
We identify a set of cross-sectional moments that are informative about the macroeconomic
effects of imperfect risk-sharing in this class of models and, consistent with some of the
above-mentioned papers, we document that their behavior points toward an important role
for micro-level frictions in explaining the decline in aggregate demand during the Great
   3 This effect is, by construction, absent in models with simple form of heterogeneity, such as the "two-agent"
New Keynesian model studied in Galí, López-Salido, and Vallés (2007), Bilbiie (2008), and Debortoli and Galí
(2017).
    4 See Kaplan, Moll, and Violante (2018); Auclert (2017); McKay, Nakamura, and Steinsson (2016); McKay

and Reis (2016); Hagedorn, Manovskii, and Mitman (2019); Gornemann, Kuester, and Nakajima (2016) for
recent contributions.



                                                       4
Recession.5 However, our approach is mostly silent about the set of underlying frictions and
shocks that can replicate the observed patterns of the preferences shocks. Identifying these
frictions is important because we cannot use our framework for policy evaluation, and so a
fully specified structural model is needed.
   The counterfactuals that we perform are related to the business cycle accounting method-
ology of Chari, Kehoe, and McGrattan (2007). The time varying preference shocks of the
stand-in household in our approach can also be interpreted as "wedges" in the Euler equa-
tion and in the labor supply condition of the representative-agent economy. Beside the dif-
ferent focus, there are two main differences between these procedures. First, in our approach
the preference shocks are measured using household-level observations, rather than being
chosen to replicate the observed path of aggregate data. Second, our main quantitative ex-
periment constructs the path for macroeconomic variables in a counterfactual economy with
complete financial markets. This is not equivalent to the approach of Chari, Kehoe, and
McGrattan (2007), which assesses the effects of specific wedges on the business cycle.
   Our approach builds on a large literature that uses data on household consumption, labor
supply, and earnings to measure the degree of risk-sharing in the data without explicitly
specifying the mechanisms through which households share risk. See for example Blundell,
Pistaferri, and Preston (2008) and the survey in Jappelli and Pistaferri (2010). The paper that
is closer to our approach is Heathcote, Storesletten, and Violante (2014) who use households'
optimality conditions and PSID and CEX data to measure the extent of risk-sharing present
in the U.S. economy. The contribution of our paper relative to this literature is to study how
the measured degree of partial risk-sharing affects aggregate dynamics.
   Finally, our paper is related to the literature that evaluates asset pricing models where
aggregation does not hold using households' consumption data. See for example Brav, Con-
stantinides, and Geczy (2002), Vissing-Jørgensen (2002), Krueger, Lustig, and Perri (2008),
and Kocherlakota and Pistaferri (2009). The goal of these papers is to estimate the stochas-
tic discount factor with micro data given a particular form of market incompleteness. This
is similar to the construction of the discount factor in the equivalent representative-agent
economy in our approach. Clearly the scope of our analysis differs from these papers.


Layout. The paper is organized as follows. Section 2 introduces the class of heterogeneous
agents economies at the center of our application, derives the equivalent representative-agent
representation and explains the nature of our counterfactuals. In Section 3 we use the CEX to
   5 The   literature emphasizes the role of the distribution of marginal propensities to consume (MPCs) as
a critical statistic to discipline these structural models. Auclert, Rognlie, and Straub (2018) show that the
distribution of MPCs at different time horizons ­ what they term intertemporal MPCs ­ is a sufficient statistic
for the response of output to fiscal shocks in a class of New Keynesian models. In Appendix A we derive
formally the relation between the cross-sectional moments we identify and the intertemporal MPCs.


                                                      5
measure the preference shocks. Section 4 combines the measured preference shocks and the
equivalent representative-agent economy to perform the main counterfactual of the paper.
Section 5 discusses possible models that are consistent with the pattern we identify in the
micro data. Section 6 concludes.



2     New Keynesian models with heterogeneous agents
We start in Section 2.1 by introducing a class of New Keynesian models with isoelastic pref-
erences, idiosyncratic income risk, and incomplete financial markets. The models in this
class share the same specification for households' preferences, technology, market structure
and the conduct of monetary policy. However, they can differ in the cyclicality of idiosyn-
cratic risk faced by households, the set of assets they can trade, their financial constraints, as
well as the timing and distribution of fiscal transfers.
    After defining an equilibrium, we show in Section 2.2 that all the models in this class
admit an equivalent representation: that of a representative-agent economy where the stand-
in household has a state-dependent rate of time preference and disutility of labor. Section 2.3
derives analytically this representation for specific models in this class. Section 2.4 discusses
at a conceptual level how we can use this representation to measure the macroeconomic
effects of imperfect risk-sharing.


2.1    The model

Time is discrete and indexed by t = 0, 1, .... The economy is populated by a continuum
of households, final good producers, intermediate good firms, and the monetary authority.
Households are divided into a finite number of types i  I . Let i be the measure of type
i households in the economy. There are two types of states: aggregate and idiosyncratic.
We denote the aggregate state by zt and the idiosyncratic state by vt , both of which are
potentially vector valued. Let zt = (z0 , z1 , ..., zt ) be a history of realized aggregate states up
to period t and vt = (v0 , v1 , ..., vt ) be a history of idiosyncratic states up to period t. We
also let st = (zt , vt ) and st = zt , vt . Let Pri st |st-1 be the probability of a history st . We
assume that Pri (st |st-1 ) = Pri (vt |vt-1 , zt ) Pr(zt |zt-1 ) so we allow for the possibility that the
aggregate state affects the cross-sectional distribution of the idiosyncratic state and that the
agent's type affects the probability of drawing a given vt .
    Households are infinitely lived and have preferences over consumption, ci st , and hours




                                                   6
worked, li st , given by

                            
                             t Pri              s t | s0 ~ ( z t )U c i s t , l i s t     ,    (1)
                           t =0 s t


where  is the discount factor and ~(zt ) is a shock to the marginal utility of consumption
and disutility of labor. This preference shock is commonly used in the literature to obtain
a binding zero lower bound constraint, a feature that will be important in the quantitative
analysis. We further assume that the period utility is given by

                                                     c 1-  - 1   l 1+ 
                                      U ( c, l ) =             -       ,                       (2)
                                                        1-       1+

with  > 0 and  > 0.
  The final good is produced combining differentiated intermediate goods according to the
technology
                                                             1           1
                                                                                  µ
                                            t                        t
                                       Y (z ) =                  y j (z ) dj
                                                                         µ            ,        (3)
                                                         0

where µ is related to the (constant) elasticity of substitution across varieties, , by the follow-
ing, µ = / ( - 1). The intermediate inputs are produced using labor

                                           y j ( z t ) = A ( z t ) n j ( z t ),                (4)

where A(zt ) is an aggregate technology shock, common across firms, and n j (zt ) is labor in
efficiency units utilized by the producer of intermediate good j. Feasibility requires that

                            n j (zt )dj =        i  Pri (vt |zt )e(vt )li (vt , zt ).          (5)
                                                 i      vt


That is, each individual vt is associated to a particular level of efficiency e(vt ): hiring more
high-efficiency types, holding total hours worked fixed, results in higher output produced
by the firm. This individual-specific productivity shock e(vt ) generates idiosyncratic income
risk for households.
  We now define the market structure for this economy with a particular emphasis on the
households side.


Households. Households enter the period with financial assets and they work for interme-
diate good producers. They choose consumption, new financial positions and labor in order
to maximize their expected life-time utility.


                                                             7
   We model financial markets in a flexible way. First, we assume that households can
trade a risk-free nominal bond. We denote by bi (st ) the position taken today by a house-
hold of type i and by 1 + i zt the nominal return on the bond. We also assume that
the household can trade a set K of possible assets, with the nominal payout of a generic
asset k  K given by Rk (st , st+1 ). We let qk (zt , vt ) be the price of the asset. This formula-
tion allows for different types of financial assets: individual Arrow securities, shares of the
intermediate good firms, complex financial derivatives, etc. We let ak,i zt-1 , vt-1 be the
holdings of assets k that a household of type i with history vt-1 has accumulated after an
aggregate history zt-1 . Trades in these additional financial assets potentially require trans-
action costs T ({ ak,i (st-1 )}kK , { ak,i (st )}kK , st ) that can depend on the inherited portfolio
{ ak,i (st-1 )}kK , the new portfolio { ak,i (st )}kK , and st .
   In addition, we allow for a number of constraints that potentially restricts the financial
positions that households can choose,

                                  Hi bi st , ak,i st       kK
                                                                   , st  0                              (6)

for some vector-valued function Hi . We refer to the set of constraints in (6) as trading restric-
tions.
   The set of assets K, the transaction costs T , and the trading restrictions in (6) are a flex-
ible way of representing different sets of risk-sharing mechanisms available to households.
The only restriction that we impose is that purchasing risk-free nominal bonds weakly re-
laxes these constraints,  Hi b, { ak }kK , st /b  0, and does not require a transaction cost.
By doing so we are ruling out limited participation economies where agents must pay a
fixed cost to have access to the risk-free nominal bond. Our formulation nests the complete
financial market case, when the set of tradable assets spans all possible aggregate and id-
iosyncratic histories and there are no transaction costs or trading restrictions. In addition, it
encompasses as special cases a large class of models with incomplete financial markets: the
Bewley-Huggett-Aiyagari economy, the two-assets economy in Kaplan and Violante (2014)
and Kaplan, Moll, and Violante (2018), the endogenous debt limits in Alvarez and Jermann
(2000), or the various forms of restrictions on asset trading in Chien, Cole, and Lustig (2011,
2012). Note, also, that the Hi function can depend on st , which implies that we are allowing
for aggregate and idiosyncratic shocks to affect the financial constraints of households.
   The problem of households is to choose [ci (st ), li (st ), bi (st ), { ak,i (st )}kK ] to maximize util-




                                                     8
ity (1) subject to the nominal budget constraint,

                         bi s t
                       1 + i (zt ) k
     P z t ci s t +               +   qk (st ) ak,i st + T ({ ak,i (st-1 )}kK , { ak,i (st )}kK , st )
                                    K

                W zt e(vt )li vt , zt - Ti (st ) + bi st-1 +                               R k s t - 1 , s t a k ,i s t - 1 ,
                                                                                   kK


where W zt is the nominal wage per efficiency units and Ti (st ) are lump-sum taxes, and
the trading restrictions in (6) given initial asset holdings.
   Because of the assumption that  Hi /b  0, a necessary condition for optimality is
                                                                                                           
                                          Pr st+1 |st  (zt+1 ) c st , s                                - 
                         1
                                  
                                            i                   i       t +1
                             t
                                                      t + 1             t
                                                                                                               ,                (7)
                     1 + i (z )   s t +1      1 +  (z )           ci ( s )                                 


where  (zt+1 ) = ~ ( z t +1 ) / ~(zt ) and  (zt+1 ) = P(zt+1 )/ P(zt ) - 1 is the net inflation rate.
The condition must hold with equality if the trading restrictions on the nominal bond do
not bind. For the rest of the paper, we assume that there always exist an agent for which
equation (7) holds as an equality.6 Because we have assumed that  Hi /b  0, equation
(7) holds with equality for the agents with the highest valuation for the risk-free bond.7
Moreover, labor supply must satisfy

                                       c i ( s t ) -  w ( z t ) e ( v t ) =  li ( s t )                                         (8)

where w(zt ) = W (zt )/ P(zt ) is the real wage per efficiency unit.


Final good producers.          The final good is produced by competitive firms that operate the
production function in (3). From their decision problem, we can derive the demand function
for the j-th variety
                                                                     µ / (1- µ )
                                          t           Pj zt
                                     y j (z ) =                                    Y (zt )                                      (9)
                                                      P(zt )
                                                                                                    1- µ
where Pj (zt ) is the price of variety j and P(zt ) =                     Pj (zt )1/(1-µ) dj               is the price index.
   6 This   assumption implicitly imposes restrictions on the set of additional assets available, the trading re-
strictions, and the shocks. As an example, the assumption is automatically satisfied in a Huggett economy
where the only asset available is the nominal risk-free bond in zero net supply and the trading restrictions are
a debt limit of the form b  - with  > 0.
     7 To see this, simply note that the agents that attains the maximum in the right side of (7) are the ones with

the lowest multipliers on the trading restriction constraints.




                                                              9
Intermediate good producers.                 Each intermediate good is supplied by a monopolistic com-
petitive firm. The monopolist of variety j operates the technology (4). As in Rotemberg
(1982), we assume that the firm faces quadratic costs to adjust its price,

                                                                                 2
                                                        Pj zt
                                                                     -1              ,                                                      (10)
                                             2    Pj (zt-1 ) (1 + ¯)

where ¯ is the inflation target of the monetary authority.
   The problem of firm j is to choose its price Pj zt given its previous price Pj zt-1 to
maximize the present discounted value of real profits. We assume that the firm discounts
future profits using the real state price
                                                                                                                                   
                                                                                                                              - 
                                                                                                    ci     z t +1 , v t +1
  Q zt+1 =  max
                       i ,v t
                                   Pr zt+1 |zt  (zt+1 )     Pri      v t +1 | z t +1 , v t
                                                                                                          ci ( z t , v t )
                                                                                                                                        .   (11)
                                                          v t +1                                                                   

That is, firms discount future profits using the marginal rate of substitution of the agent
that values dividends in the aggregate state the most.8 The firm's problem can be written
recursively as
                                                                                         2
                                      pj yj                               pj
      V Pj , z   t
                     = max
                       p j ,y j ,n j P ( z t )
                                               - w(zt )n j (zt ) -
                                                                   2 Pj (1 + ¯)
                                                                                -1           +    Q ( z t +1 | z t ) V       p j , z t +1   (12)
                                                                                                 z t +1


subject to the production function (4) and the demand function (9).
   The solution to the firm's problem together with symmetry across firms requires that the
following version of the New Keynesian Phillips curve holds in equilibrium

                                       1               w(zt )
                     ~ zt =
                                             Y (zt ) µ         - 1 +  Q ( z t +1 | z t ) ~ z t +1                                           (13)
                                    ( µ - 1)           A (zt )       z t +1


where we define ~ zt = [( (zt ) - ¯ ) / (1 + ¯ )] × [( (zt ) + 1)/(1 + ¯ )] and w(zt )/ A(zt ) is
the real marginal cost for producing a unit of the final good.


Monetary policy and market clearing.                     We assume that the monetary authority follows a
standard Taylor rule
                                                                                                                                    
                                                                                                 y 1 -  i
                                                        1 +  (zt )            Y (zt )                                               
   1 + i (zt ) = max        [1 + i (zt-1 )]i (1 + i
                                                  ¯)                                                          exp{ m (zt )}, 1          ,   (14)
                                                          1+¯               Y pot (zt )                                             

   8 Ifall agents could trade Arrow securities contingent on the aggregate state then this would be the equilib-
rium state price.



                                                              10
            ¯) = (1 + 
 where (1 + i         ¯ )/  is the nominal interest in a deterministic steady state of the
model, Y pot (zt ) is potential output and  m (zt ) is a monetary shock.9 Note that we allow for
the possibility of a binding zero lower bound constraint.
   The evolution of the aggregate supply of the nominal bond, B(zt ), and taxes, Ti (st ), must
satisfy the government budget constraint,

                                                     B(zt )
                                  B ( z t -1 ) =           t
                                                              +  i  Pri (vt |zt ) Ti (zt , vt )                                            (15)
                                                   1 + i (z )   i  vt


   In equilibrium, the labor market, goods markets, and financial markets clear. Specifically,
market clearing in the nominal bond market requires that

                                            i  Pri                v t | z t bi z t , v t = B ( z t ) .                                     (16)
                                            i       vt

Since firms' equity is the only asset in positive net supply other than the nominal risk-free
bond, market clearing in all the other assets requires that the value of inherited assets must
equal the nominal value of the firm cum-dividend,

                    i  Pri             vt |zt            R k ( s t - 1 , s t ) a k ,i s t - 1 = P ( z t ) V ( P ( z t - 1 ) , z t ) ,      (17)
                    i        vt                 kK

and the total value of new asset positions must equal to the nominal value of the firm ex-
dividend,

             i  Pri               vt |zt    q k ( s t ) a k ,i     st = P(zt )           Q ( z t +1 | z t ) V        P ( z t ), z t +1 .   (18)
             i          vt                 kK                                          z t +1


   We can then define an equilibrium for this economy.

Definition 1. Given an asset structure (K, T , Rk , H ), the distribution of initial assets and lagged
prices, an equilibrium is a set of households' allocations {ci (st ), li (st ), bi (st ), ak,i (st )}, a fiscal policy
{ B(zt ), Ti (st )}, prices { P(zt ), W (zt ), 1 + i (zt ), Q(zt ), qk (zt )}, and aggregates {C (zt ), Y (zt )} such
that i) the households' allocation solves the households' decision problem, ii) the price for the final
good solve (12) with P(zt ) = Pj (zt ), iii) the state price is given by (11), iv) the nominal interest rate
satisfies the Taylor rule (14), v) the government budget constraint (15) is satisfied, and vi) markets
clear in that (16)­(18) hold and
                                                                                                2
                                            t              (zt ) - 
                                                             t     ¯
                                       Y (z ) = C (z ) +                                            + T (zt )
                                                         2 1+    ¯
    9 Potential   output is the level of output that would prevail in an economy with no price-adjustment costs.


                                                                         11
where aggregates are given by

                                Y (zt ) = A(zt )  i  Pri (vt |zt )e(vt )li (vt , zt ),
                                                                 i        vt
                                C (zt ) =        i  Pr
                                                     i
                                                       ( v | z t ) c i ( z t , v t ),
                                                                           t
                                                    i           vt


and T (zt ) are the aggregate transaction costs,

                    T (zt ) =  i  Pr(vt |zt )T ({ ak,i (st-1 )}kK , { ak,i (st )}kK , st ).
                                                i
                                   i       vt


2.2    Equilibrium representation

We now show that the law of motion for aggregate variables in this class of New Key-
nesian models can be equivalently derived from the equilibrium conditions of a fictitious
representative agent economy where the stand-in household has a time-varying rate of time
preference and disutility of labor. These "preference shocks" summarize all the implications
that household-level heterogeneity has on aggregate variables. To this end, we define

                                                                                                                                    -
                                                                                     c i ( z t +1 , v t , v t +1 ) / C ( z t +1 )
                    t
              i (v , z   t +1
                                )       Pri                          t
                                                         v t +1 | v , z   t +1
                                                                                               ci ( z t , v t ) /C ( z t )
                                                                                                                                             (19)
                                       v t +1
                                                                                                    -                    -
                                                                                 ci ( z t , v t )                 1+ 
                     zt                   i  Pri                     vt |zt
                                                                                   C (zt )
                                                                                                        e (vt )                .             (20)
                                           i            vt

We have the following proposition where we assume that the aggregate transaction costs are
negligible, T (zt ).

Proposition 1. Given              i v t , z t +1 ,  z t                  defined in (19) and (20), the equilibrium aggregate
consumption, output, inflation, and nominal interest rate, C zt , Y zt ,  zt , i (st ), Q(zt+1 )
must satisfy the aggregate Euler equation,
                                                                                                                                     
                                       Pr zt+1 |zt  (z )  vt , zt+1                                                                 - 
               1                                                                                                C     z t +1
                      =  max 
                                                      t +1 i
                   t
                                                                                                                                         ,   (21)
           1 + i (z )         t
                         i , v z t +1            1 +  ( z t +1 )                                                 C (zt )             

the Phillips curve,

                                                                          
                       Y (zt )    Y z t C z t  z t
          ~ z
                t
                    =           µ             1 +
                                                   - 1 +  Q ( z t +1 | z t ) ~ z t +1                                                        (22)
                       ( µ - 1)        A(zt )     
                                                         z t +1




                                                                          12
the Taylor rule (14), the resource constraint

                                                                                                                     2
                                                                                      (zt ) - ¯
                                                    Y (zt ) = C (zt ) +                                                   ,                                     (23)
                                                                                    2 1+    ¯

and                                                                                                                                            
                     t +1        t                                    t   t +1                t +1        t              t +1       C z t +1
               Q z          |z       =  max  i v , z                                Pr z             |z             (z          )                 .             (24)
                                                i ,v t                                                                               C (zt )


   The proof for this result is straightforward. The aggregate Euler equation (21) is obtained
by using (19) to substitute for the marginal rate of substitution (ci (st+1 )/ci (st ))- in the in-
dividual Euler equation (7) and noting that under our assumptions it holds with equality for
the agent with the highest marginal valuation of the bond-- the "max" in equation (21). The
Phillips curve (22) can be derived by substituting for the wage in (13) using the individual
labor supply decisions. Indeed, multiplying both side of equation (8) by e(vt )/C (zt )-/
and averaging both sides across individuals we obtain
                                                                      -
           1                                       ci ( z t , v t )                 1+               1
                i  Pri                                                                                         i  Pri (vt |zt )e(vt )li (st )
                                                                                                                                                             
       t                              t     t
   w(z )                             v |z                                 e (vt )            =                                                        C (zt )  .
               i      vt
                                                     C (zt )                                                   i         vt


We can then use the production function (4) to express the real wage as

                                                                                          
                                                                           Y (zt )
                                                     w(zt ) =                                C ( z t )   ( z t ),
                                                                           A(zt )

and substitute it in equation (13) to obtain the Phillips curve (22). To obtain (23) we simply
substitute the adjustment costs (10) in the resource constraint.
   Equations (14), (21), (22), (23) and (24) are equivalent to those of a representative agent
economy with "shocks" to the rate of time preferences and to the disutility of labor. Thus,
the effects that micro heterogeneity on macroeconomic variables can be represented in this
class of models as if the stand-in household in a representative-agent economy becomes
more/less patient or more/less inclined to work. See Nakajima (2005), Krueger and Lustig
(2010), and Werning (2015) for related results.
   Proposition 1 has two main implications. The first implication is that  i (vt , zt+1 ) and  (zt )
defined in equations (19) and (20) summarize all the information from the "micro block" of
the model that is needed to characterize the behavior of aggregate variables. That is, we do
not need to know the specifics of the model regarding the set of assets traded, the transaction
costs and trading restrictions faced by households, the fiscal policy { B(zt ), Ti (st )}, and the
nature of their idiosyncratic income risk to characterize the behavior of macro aggregates, as
long as we know how {  i (vt , zt+1 ),  (zt )} evolve. Of course, all these elements are important

                                                                                 13
determinants of {  i (vt , zt+1 ),  (zt )} but knowing this process is enough for the evolution of
aggregates. Second, the mapping between individual allocations and the preference shock
defined in (19) and (20) is invariant to the specifics of the model considered. Thus, as long
as we observe households' choices, we do not need to take a stand on the specifics of the
model to measure {  i (vt , zt+1 ),  (zt )}.


2.3   Examples

Before moving to show how to combine the measured {  i (vt , zt+1 ),  (zt )} with the repre-
sentation in Proposition 1 to quantify the contribution of imperfect risk-sharing to business
cycle fluctuations, we further illustrate the main result of this section with three examples.
We start by considering an economy with complete markets as a benchmark. We then study
two simple examples of economies with incomplete markets where we can derive explicit
formulas for  i (vt , zt+1 ) and  (zt ). Both examples are motivated by recent research sug-
gesting that microeconomic frictions might have been important factors behind the Great
Recession. The first of these two example isolates the implications of a rise in idiosyncratic
labor income risk on precautionary saving motives of households, a mechanism studied by
Ravn and Sterk (2017) and Heathcote and Perri (2018) among others. The second shows how
a tightening of credit constraints at the micro level can lead to a fall in aggregate demand, see
Eggertsson and Krugman (2012) and Guerrieri and Lorenzoni (2017). This second example
also shows how the behavior of households that are not on their Euler equation indirectly
affects the discount factor for the stand-in household in Proposition 1.
   These two examples illustrate the two main forces that can generate fluctuations in the dis-
count factor of the stand-in household in our equivalent representation. Broadly speaking,
as shown in Krueger and Lustig (2010), if there is no time variation in idiosyncratic labor in-
come risk or in the household's ability to smooth income shocks (borrowing constraints, less
assets available, etc.) then there is no variation in (vt , zt+1 ) and the heterogeneous agent
economy is equivalent to a representative agent economy with a different time-invariant
discount factor.


Example 1: Complete markets.          We start by considering the complete markets benchmark.
The set of assets K contains Arrow securities contingent on the realizations of the aggre-
gate and idiosyncratic state and there are no trading restrictions other than a non-binding
no-Ponzi condition. Clearly, the equilibrium outcome in this economy is Pareto efficient and
both aggregate and idiosyncratic risk are shared efficiently: the ratio of the marginal utility
between any two individuals is constant for all histories: for all vt+1 , v
                                                                          ~ t+1 , i, and j it must
be that Uc,i zt+1 , vt+1 /Uc,i zt , vt = Uc, j zt+1 , v
                                                      ~ t+1 /Uc, j zt , v
                                                                        ~ t . Given our isoelastic pref-

                                                  14
erences in (2), this implies that individual consumption is a constant fraction of aggregate
consumption,
                                        c i z t , v t =  i ( v0 ) C z t

for some consumption share i (v0 ) constant over time and histories. Thus the discount factor
in (19) for the stand-in household in the equivalent representation equals 1 for all histories,

                                                 t t +1
                                             cm
                                             i (v , z   ) = 1.                                         (25)

Moreover, the disutility of labor for the stand-in household in (20) is given by

                                                                                         -
                                                                      -            1+ 
                         cm    t
                              (z ) =    i  Pri (v |z ) i (v0 )
                                                        t   t             e(vt )             .         (26)
                                       i      vt

The above expression can be time-varying even in presence of complete markets. To under-
stand this expression, suppose that  = 1 and households have the same initial wealth, so
that i (v0 ) = 1 for all i. In this case,  (zt ) equals the inverse of the cross-sectional variance
in households' idiosyncratic productivity. This expression reflects compositional change in
the labor force that take place in the heterogeneous agent economy: when the cross-sectional
variance of e(vt ) increases, the labor supplied by high productivity households increases and
the one supplied by the low productivity households decline because of a substitution effect.
This development is captured in the equivalent representative-agent economy by a decline
in  (zt ), that is, by an increase in the willingness to work of the stand-in household.


Example 2: Labor income risk and aggregate demand.                        Suppose there is only one type of
agent and drop the subscript i from allocations to economize on notation. Let  = 1 and the
idiosyncratic productivity shocks evolve according to

                                           e (zt )2
                     log[e(vt )] = -                + t          t |zt  N 0, e (zt )2 .
                                              2

That is, idiosyncratic productivity is a random walk with Gaussian shocks. The standard
deviation of individual productivity growth varies over time with the aggregate state zt :
when e (zt+1 )2 is high, households face higher idiosyncratic risk.
  To obtain analytical expressions for the (vt , zt+1 ) and the  (zt ) implied by this model, we
assume that households can only trade the risk-free bond and that they face the borrowing
limit b(st )  0. Because households cannot trade stocks of the firms, we also assume that
the government levies taxes on the intermediate good producers and transfers the profits to
the households in proportion to the realization of idiosyncratic productivity, e(vt ) T (zt ).


                                                      15
   The tight borrowing limits, coupled with the fact that bonds are in zero net-supply, implies
that households in equilibrium cannot save.10 Thus, every household is hand-to-mouth and
every period every period consumes all their cash on hand,

                                      c(st ) = e(vt ) w(zt )l (st ) + T (zt ) .

Furthermore, we can verify from the labor supply condition (8) and  = 1 that l (st ) is the
same across individuals. So, it must also be that c(st ) = e(vt )C (zt ) from the aggregate
resource constraint.
   Given the equilibrium consumption function, the relative marginal rate of substitution of
the households are just functions of the idiosyncratic income process,

                                                                                 -
                                  c i ( z t +1 , v t , v t +1 ) / C ( z t +1 )             e(vt )
                                                                                     =                ,
                                            ci ( z t , v t ) /C ( z t )                  e ( v t +1 )

and the consumption share of an individual with history st is c(st )/C (zt ) = e(vt ).
   Substituting these expressions in equation (19) and (20) we can compute the implied
(vt , zt+1 ) and  (zt ) in this specific model:

                      ( v t , z t +1 ) =      Pr(vt+1 |vt , zt+1 ) exp {- log[e(vt+1 )]}
                                            v t +1
                                     = exp{e (zt+1 )2 }

and  (zt ) = 1. Note that in this example (vt , zt+1 ) does not depend on individual histories
and  (zt ) does not vary over time. These two expressions, coupled with equations (14), (21),
(22) and (23), are enough to characterize the law of motion for aggregate variables in this
specific example.
   This representation is useful to understand how the interaction between idiosyncratic risk
and incomplete financial markets can affect aggregate variables in this class of models. Sup-
pose that households face today higher idiosyncratic risk, that is they expect higher e (zt+1 ).
If financial markets were complete, this shocks would not have any effects on the allocation.
Because of incomplete financial markets, however, households have a precautionary motive
to save in the risk-free bond. This increase in the propensity to save at the micro level can be
represented as an increase in the discount factor in the equivalent representative agent New
Keynesian model.
   10 The  literature refers to this example with tight borrowing limits and bonds in zero net supply as the zero
liquidity limit. See Werning (2015) and Ravn and Sterk (2017) for example.




                                                                  16
Example 3: Credit constraints and aggregate demand.                                          Consider now an economy where
the debt limit depends on aggregate conditions. For simplicity, assume that there are only
two types of agents, i = 1, 2 of equal measure. When the aggregate state zt realizes, one
the types samples a high efficiency labor units, e H , while households in the other type draw
e L . To simplify the algebra, we further assume that households within types have no further
idiosyncratic shocks to their efficiency of labor and that profits from the monopolistic com-
petitive firms are distributed to households so that Ti (zt ) + w(zt )ei (zt )li (zt ) = ei (zt )C (zt ).
     Households can trade only a non-contingent bond in zero-net supply, subject to the debt
limit (zt ). Thus, asset holdings must be such that

                                                     bi ( z t )  -  ( z t )

In what follows, we assume that (zt ) is sufficiently small so that the debt limit is always
binding for the agents with a low realization of the individual productivity shock, e L . Thus
the individual consumption allocations are given by
                                      
                                      e L C (zt ) +  bi ( z t - 1 )     (zt )
                                                    1+  ( z )    t  + 1+ i ( z t )
                                                                                               if ei (zt ) = e L
                       ci ( z t ) =                            -
                                       e C ( z t ) + bi ( z ) -  ( z t )
                                                             t   1
                                                                                               if ei (zt ) = e H
                                        H            1+  ( z t )       1+ i ( z t )


where bi zt-1 depends on the particular history:
                                                 
                                                   z t -1                        if ei (zt-1 ) = e H
                              bi z t - 1       =
                                                  -  z t -1                      if ei (zt-1 ) = e L


     We can then express the  i (zt+1 ) for the type that attains the maximum in the aggregate
Euler equation (21) ­ the agent with a high realization of the individual productivity in zt ­
as                                                                                                                   -
                                                                                    bi ( z t + 1 )
                                
                                                              (zt )
                               ei ( z t +1 ) +                                  - 1+ i                 /C   z t +1
                                                          1 +  ( z t +1 )                ( z t +1 )
                      t +1
                                                                                                                     
                i z          =                                                                                           .
                                                               bi ( z t - 1 )        (zt )
                                                                                                                     
                                      e H (zt ) +              1+  ( z t )
                                                                                -   1+ i ( z t )
                                                                                                      /C (zt )

From the expression above, it is evident how a tightening of the debt limit, a reduction in
(zt ), increases  i (zt , zt+1 ) for the marginal agent. Intuitively, a reduction in (zt ) means that
agent with a low income shock can borrow less to smooth their consumption. In equilibrium,
this implies that the agent with currently higher income must save less and consume more
to clear the asset market. The increase in current consumption share makes this agent more
willing to save and thus the measured  i (st ) increases for the marginal agent.



                                                                 17
  This example illustrates two properties of our equivalent representation. First, the be-
havior of non-marginal households is not irrelevant for the dynamics of aggregates despite
only the consumption profile for agents on their individual Euler equation for the nominal
bond is appearing in the aggregate Euler equation (21). Here the behavior of borrowing con-
strained households affects the discount factor of the stand-in household through a general
equilibrium relationship. This is important because the literature so far has emphasized the
role of these agents with high marginal propensity to consume as critical for the propagation
of aggregate shocks. Our representation does not contradict this intuition.
  Second, the above expression for  i (zt , zt+1 ) shows how the "micro-block" is not indepen-
dent from the "macro-block" that determines the dynamics of aggregates as the  i (zt , zt+1 )
depends on aggregate consumption, the inflation rate, and the policy rate. Conversely, from
Proposition 1, the evolution of these aggregates is affected by  i (zt ). Despite this caveat, we
can still use the representation to assess the role of imperfect risk sharing in accounting for
aggregate fluctuations as we next show.


2.4   Counterfactuals at a conceptual level

We now explain how to use the representation in Proposition 1 and {  i (vt , zt+1 ),  (zt )} to
evaluate the macroeconomic implications of imperfect risk sharing over the business cycle.
For now, we assume that we know the probability distribution of zt and the process for
{ (.), A(.),  m (.),  i (.),  (.)}. Thus, given a realization of zt , we can use the representation
in Proposition 1 to obtain the underlying equilibrium path for aggregate variables-- output,
inflation and nominal interest rates.
  Our approach involves comparing these benchmark paths to those that would arise in
an economy with complete financial markets. In the previous section we have seen that
the economy with complete financial markets features a different stochastic process for
 i (vt , zt+1 ) and  (zt ) given by (25) and (26). Because of this difference, it also features a
different behavior for the aggregate variables. We label these the complete markets paths.
The comparison between the benchmark and the complete markets paths isolates the impact
that imperfect risk-sharing across households has for macroeconomic aggregates over the
particular history zt .
  Our main application will be to quantify the importance of imperfect risk sharing during
the Great Recession. As we mentioned earlier, several papers in the literature have sug-
gested that the deep decline in real economic activity during the Great Recession was partly
induced by an increase in households' propensity to save, either because of an increase in
precautionary motives or because of a tightening of individual's borrowing constraints. If
these mechanisms were important, we should observe the output trajectory in the bench-

                                                18
mark to be substantially below its complete market counterfactual when feeding the history
zt that led to the Great Recession.
   In this discussion we have assumed that we know Pri (st |st-1 ), the realization of zt in a
particular event, and how it affects { (, ), A(.),  m (.),  i (.),  (.)}. In practice, however, we
need to estimate these stochastic processes, and we need a procedure to retrieve zt from the
data. In the following sections we discuss how to use survey data to obtain the time path for
the preference shocks and how to implement in practice the counterfactuals. Before getting
there, it is important to emphasize two points.
   First, while we are agnostic about the "micro" aspect of the model, we did make specific
assumptions about technology, aggregate structural shocks, monetary policy rule etc, as
we carried the analysis within the context of the standard three equations New Keynesian
model. This is a deliberate choice because it keeps the analysis transparent. The result in
proposition 1 is more general, and can be derived in richer versions of the model. In the
robustness analysis of Section 4.5, for example, we introduce capital accumulation in the
model. Similarly, we could accommodate different types of nominal rigidities and different
preferences for households. As it will become apparent from Section 3, however, a critical
assumption for the measurement of the preference shock in the data is that households
have the same preferences and there are no idiosyncratic shock to the marginal utility of
consumption. This assumption is shared by most of the quantitative heterogeneous agent
models.
   Second, our approach is silent about the forces behind the fluctuations of the preference
shocks, and cannot be used to understand how imperfect risk-sharing affects the propagation
of specific structural shocks.11 In this respect, we differ in objectives from recent papers that
identify statistics that are sufficient to measure the response of macroeconomic variables
to aggregate shocks in this class of models. Auclert, Rognlie, and Straub (2018) show that
the distribution of households' marginal propensity to consume (MPCs) at different time
horizons ­ what they term intertemporal MPCs ­ is a sufficient statistic for the response of
output to fiscal shocks in a class of New Keynesian models.12 Our objective is, instead, to
measure the overall macroeconomic impact of imperfect risk-sharing. As we have shown,
there is no need to estimate intertemporal MPCs to address this question.
  11 In principle,one could estimate the impulse response function of the preference shocks to identified shocks
and use the equivalent representative-agent formulation to adress these questions. This is an interesting avenue
for future research, but it is outside the scope of this paper.
   12 In Appendix A we formally derive the mapping between the iMPCs and the preference shocks in the

equivalent representative-agent economy.




                                                      19
3      Measuring the preference shocks
We now use household-level observations to measure the preference shocks defined in
equation (19)-(20). In order to compute these objects, we need information on the change
in consumption shares, (cit-1 /Ct-1 )/(cit /Ct ), and on the relative wage per hour worked,
eit = Wit /Wt . Section 3.1 describes the data sources. Section 3.2 and 3.3 present the behavior
of the measured preference shocks over the sample. Section 3.4 discusses issues related to
the presence of measurement errors in the survey.


3.1     Data description

The main data set is the Consumer Expenditure Survey (CEX), which collects information on
income, expenditures, employment outcomes, wealth and demographic characteristics for a
panel of US households selected to be representative of the population. Households report
information on consumption expenditures for a maximum of four consecutive quarters, in-
come and employment information is collected in the first and last interview, and wealth
information in the last interview only.13
    Our measure of consumption is dollar spending on non-durables and services by the
household. We measure wage per hour worked by scaling total labor income by total hours.
Labor income is a pre-tax measure, and it includes wages and salaries, bonuses, overtime,
tips plus income from a business, while total hours worked include hours worked by the
head of household and the spouse over the entire year in all jobs. In addition to the variables
that are necessary for the calculation of the preference shocks, we obtain socio-demographics
indicators about the households (education, sex, family size, etc.) and information on assets
and liabilities. Specifically, we use in our analysis an indicator of net-worth (assets minus
liabilities) at the household level. The precise definition of the variables used in the analysis
is in Appendix B.
    The baseline sample includes all households where the head of the household is between
the ages of 22 and 64. We only use households who participate in all four interviews in the
CEX. We restrict the sample to those which the CEX labels as "complete income reporters,"
corresponding to households with at least one non-zero response to any of the income and
benefits questions. We use the assigned "replicate" or sample weights, designed to map
the CEX into the national population in all calculations. We use the CPI-U to express all
monetary variables in constant 2000 dollars. To eliminate outliers and mitigate any impact
    13 The
         CEX asks questions about how assets and liabilities have changed in the preceding year, which allows
us to back-date wealth information. See https://www.bls.gov/opub/mlr/2012/05/art3full.pdf for more
details.



                                                     20
of time-varying top-coding, we drop observations in the top and bottom one percent of the
consumption, hours, labor income, wage per hour, total assets, total liabilities and net-worth
distribution. Further details about sample selection are discussed in Appendix B.
  The model of Section 2 abstracts from important features of the micro data, such as de-
mographics and life-cycle dynamics. In order to have a clear mapping between model and
data, we use panel regressions to partial out the effects of these possible confounders. Let
~it be the log of consumption expenditures and y
c                                               ~it the log of labor income. We estimate the
following linear equation
                                        ~it =  +  Xi + y y
                                        c                ~it + eit ,

where Xi includes dummies for the sex, race, education, age of the head of household and
the state of residence. After estimating this regression, we predict consumption only using
labor income and the residual,
                                             p
                                            ~it =  + y y
                                            c          ~it + eit .

We repeat this procedure for all variables used in the analysis.14 After estimating these
relationships, we divide all variables in levels, with the exception of wage per hour, by the
number of family members in order to obtain per-capita figures.
  Appendix B presents summary statistics of the underlying micro data and some compar-
isons with previous studies in the literature. Households' characteristics in our sample are
comparable with the ones reported in Heathcote and Perri (2018). In line with their findings,
we also verify that the behavior of aggregate consumption expenditures, labor income and
hours worked implied by the CEX tracks the corresponding national statistics reasonably
well. We finally compute a set of cross-sectional statistics and show that their behavior over
time closely mirrors results reported in previous papers in a large body of work on con-
sumption and income inequality (Blundell, Pistaferri, and Preston, 2008; Krueger and Perri,
2006; Aguiar and Bils, 2015; Attanasio and Pistaferri, 2016).


3.2   Measuring  it

We now use the data to obtain an empirical counterpart to  it . For the subsequent analysis,
we will set  = 1. From equation (19) we can then see that  it is the conditional expectations,
across idiosyncratic histories, of the inverse change in the consumption share of household
i between time t - 1 and time t. Because we observe only one realization of the change
in consumption share for each i, we need to estimate this conditional expectation. Our
approach consists in grouping households with similar observable characteristics at time
  14 We                  ~it when predicting labor income.
          do not include y



                                                      21
t - 1 and computing
                                                    Ni     c jt-1 /Ct-1
                                             1
                                         it 
                                             Ni                c jt /Ct
                                                                        ,                                    (27)
                                                   j =1

where Ni is the number of households in the group at time t - 1.
   The logic of equation (27) builds on two premises. The first is that, by grouping individ-
uals along certain observable characteristics, we are effectively proxying for an individual
history vt-1 and type. The second is that the size of the groups is large enough, so that
 it in equation (27) approximates the conditional expectation in equation (19). That is, the
cross-sectional average is intended to proxy for an expectation over realizations of vt , for
households with a common vt-1 .
   We partition households into different groups following the structure of baseline incom-
plete markets models. In the basic version of these models, the current level of income and
net worth are sufficient statistics for individual histories. We follow this insight and group
households according to whether their income at date t - 1 is above or below median in-
come and, within each of these two groups, weather the level of their net worth is above
or below the group median. Thus, for each t - 1, we end up with four different groups of
households of approximately equal size: low income/low net worth, low income/high net worth,
high income/low net worth and high income/high net worth. For each group i, we use equation
(27) to construct  it .15
   We measure  it at annual frequency. Following Vissing-Jørgensen (2002), we compute the
semi-annual consumption change for each household in our dataset,

                                c m + c m +1 + c m +2 + c m +3 + c m +4 + c m +5
                              cm+6 + cm+7 + cm+8 + cm+9 + cm+10 + cm+11

and scale it by an equivalent semi-annual change in aggregate consumption over the same
horizon constructed using monthly data of aggregate consumption of non-durable and ser-
vices from NIPA. We square the resulting ratio to obtain an annualized change. In order to
aggregate up to an annual frequency we must allocate this to a given year. This is easiest
when the CEX interview aligns perfectly with the calendar year (that is, m = 1). In this case
we assign this observation solely to this year. However, this case only happens 1/12 of the
time. For the rest of the cases we assign the observation to a given year in proportion to its
time in that year. For example, suppose that a particular household's last interview was in
month 7 of year t. In that case, this observation would receive a weight of (7/12) in year t
   15 Inprinciple, one could consider finer partitions of the joint distribution of income and net worth. However,
given the sample size in the CEX, this would produce substantially noisier estimates of  it . With our partitions,
we have roughly 600 households per year within each group. However, in Appendix B.5 we consider alternative
partitions including four income groups, two total asset and two income groups, two liquid asset and two
income groups. See Figure A-3 for details.


                                                          22
                               Figure 1: Changes in consumption shares by group


                          low income/low net worth                           low income/high net worth
            1.05




                                                               1.05
            .95




                                                               .95
            .85




                                                               .85
                   1995     2000       2005   2010    2015            1995      2000       2005   2010    2015

                                   1           max                                     2           max



                          high income/low net worth                          high income/high net worth
            1.05




                                                               1.05
            .95




                                                               .95
            .85




                                                               .85




                   1995     2000       2005   2010    2015            1995      2000       2005   2010    2015

                                   3           max                                     4           max


Notes: Each panel shows an estimate of  it for four groups of roughly equal size: low income/low net worth, low
income/high net worth, high income/low net worth and high income/high net worth (red dashed line) along with the
year-by-year value of the maximum across the four groups (solid black line) over the periods 1996-2012. The red
dotted lines are 90% confidence bands.


and a weight of (5/12) in year t - 1.16
   Figure 1 plots the time path of  it for each group along with the year-by-year value of the
maximum across the four groups. The path for max  it is normalized to have a mean of 1,
and we normalize the other  it relative to this value.17 This statistic plays an important role
in our analysis because, up to a first-order approximation, households with the highest  it
are the ones on their Euler equation, see equation (21).
   There are two important facts about Figure 1 that we want to emphasize. First, the high
income groups have higher implicit discount factors relative to low income households in
most years. This is shown in the bottom two panels of Figure 1, as the  it for the two high
income groups is equal to the year-by-year max value across all groups (solid line) for most
of the years. Second, the discount factor measured in our approach displays a substantial
increase during the Great Recession. Figure A-3 shows that both of these results are robust
   16 Our   results are robust to only using observations that fall mostly within one calendar year.
   17 As   we show in Section 3.4, the level of  it is affected by the presence of classical measurement errors.


                                                          23
                              Figure 2: Changes in consumption vs. changes in income




                                                                                                     2.5
               1.07




                                                                                                     2
                   1.04
       (Cit / Cit-1)




                                                                                                Yit / Yit-1
                                                                                                  1.5
               1.01




                                                                                                     1
               .98




                                                                                                     .5
                          0   1                     2                    3             4                      0                  50000                100000   150000
                                                Yit / Yit-1                                                                                   Yit-1


                                         cit              yit                                                                          yit
                                  (a)   cit-1   vs       yit-1                                                                  (b)   yit-1   vs yit-1
Notes: Panel (a) displays a binned scatter plot of changes in households' consumption (cit /cit-1 ) and income
(yit /yit-1 ). Panel (b) displays a binned scatter plot of households' changes in income t - 1 and t and the level of
income at t - 1.


when we consider different partitions of the data.
   Why are households with high income at t - 1 the ones with the highest  it ? Figure 2
shows that this is due to two features of the data: sensitivity of consumption to negative
income changes and the presence of mean-reversion in households' income. Panel (a) of
the figure reports a binned scatter plot of the change in households' consumption and the
change in their income. The figure displays a non-linear relation: households whose income
falls between year t - 1 and year t experience on average a large decline in their consumption
expenditures. Because of that, households with negative income changes between time t - 1
and time t tend to have on average a high measured  it , the average of the inverse change
in consumption shares. Panel (b) of the figure plots the relation between yit /yit-1 and yit-1 :
households that at time t - 1 have relatively high income experience, on average, a fall in
their income between t - 1 and t. Taken together, these facts explain why the high income
group is the one with the highest measured  it : they are the group whose income is expected
to fall the most between t - 1 and t, and so they are more likely to experience a decline of
their consumption expenditures in relative terms.
   Why is the  it of high income households increasing during the Great Recession? To
answer this question, it is useful to decompose  it as follows
                                                                                                                                          
                                                                                                                   Ni
                                                                       Ct /Ct-1                    Ni              j= 1 c jt / c jt-1
                                           it =                                                                                           .                         (28)
                                                                 1      N                                            c jt /c jt-1
                                                                 Ni    j=i
                                                                           1 c jt / c jt-1      j =1

                                                                              AVG,it                                  JEN ,it



                                                                                           24
                                              Figure 3: Decomposition of equation (28)




                                  8
                                                                                            
                                                                                            AVG
                                                                                            Jensen
                                  6
                           Percent Change
                             2    0
                                  -2  4




                                            2007          2008           2009                  2010

Notes: This figure plots the decomposition described in equation (28) for the marginal group during the Great
Recession (the high income/high net worth group). In particular, it shows how to decompose       ¯ it (solid black line)
into the average the consumption growth of the group ( ¯ AVG,it : red dotted line) and a component that measures the
increase in dispersion of consumption growth within the group (   ¯ JEN ,it : dashed blue line).


Mechanically,  it can increase for two reasons. First, if the average change in consumption
between time t - 1 and time t for a given group i decreases relative to the change in aggregate
consumption over the same period. This effect is captured by the term  AVG,it in the above
expression. Second, because of Jensen's inequality,  it can increase because of an increase
in the cross-sectional dispersion of c jt /c jt-1 , an effect that is captured by  JEN ,it in equation
(28). This decomposition is shown in Figure 3 for the high income/high net worth group, the
one with the highest  it during the Great Recession. While both components increase, most
of the increase is due to an increase in  JEN ,it . In Section 5 we explore possible explanations
for the increase in the cross-sectional dispersion of c jt /c jt-1 for the high income/high net
worth group during the Great Recession.


3.3     Measuring t

We now turn to the measurement of t in equation (20). For each household in our panel,
we compute the consumption share, it = cit /Ct and combine it with the relative wage,
        wit                                                                                                -  /  (1+  ) / 
eit =   Wt ,   to construct t .18 In particular, we compute for each household it                               eit        ,
take the cross-sectional average for each t, and raise it to -1/ power. We set  = 1, a
common value used in the business cycle literature. In order to compute the value of t
   18 Weassign a productivity level of zero for households that report zero hours worked for the entire year.
These cases are rare in our dataset.


                                                                 25
                                             Figure 4: The evolution of t




                                                                                          .55
      1




                                                           
                                                           cm
                                                           




                                                                                                           .5
      .95




                                                                            Cross-sectional variance of ei
                                                                                              .45
      .9




                                                                                    .4
      .85




                                                                         .35
      .8




                                                                                          .3
            1995   2000           2005           2010          2015                                             1995          2000           2005            2010   2015


                                    cm
                          (a) t and t                                                                                  (b) Cross-sectional variance of eit



that would prevail in a world with complete financial markets, we need to know the initial
distribution of consumption shares and its correlation with eit for every t, see equation (26).
We assume that the moments of the initial distribution are those of the first year in our
                                  cm as follows
sample, 1996. That is, we compute t

                                         N                       N
                                                                                                                                                    -1
                                     1                     1
                      cm
                      t       =
                                     N          -1
                                                i 1996   ×
                                                           N            2
                                                                       eit                + cov                            -1
                                                                                                                           i         2
                                                                                                                             1996 , ei1996               .
                                         j =1                   j =1

                                                         cm . We can see that both series
   Panel (a) in Figure 4 plots the time series for t and t
display a downward trend. This pattern is explained almost entirely by the increase in the
cross-sectional variance of eit , see panel (b) of the figure.19 As explained in Section 2.3,
an increase in the cross-sectional variance of individual productivity induces compositional
change in the labor force that are captured by a lower disutility of labor in the equivalent rep-
resentative agent economy. We can also observe from the figure that the deviations between
       cm are typically small relative to the overall variability in the series. Throughout
it and it
                                  cm . Through the lens of our framework, this means
the Great Recession, t lies above t
that the impact of imperfect risk-sharing on labor supply during the Great Recession can be
interpreted as an increase in the marginal disutility of labor in the equivalent representative
agent economy.
   19 Heathcote,
               Perri, and Violante (2010) also finds that the cross-sectional variance of log wages are increasing
in the CEX, PSID and CPS, see Figure 16 in their paper for more details.




                                                                  26
3.4   Measurement error

A possible concern with our analysis is that the fluctuations we measure in  it and t are due
to measurement error. While we cannot rule out arbitrary measurement error, in this section
we try to gauge whether our results can be attributed to specific forms of measurement error.
  One form of measurement error is simply recording errors in the CEX that create extreme
outliers. This could be particularly relevant for our analysis because errors in (log) levels
of consumption are magnified when they are differenced. When selecting the sample, we
remove the top and bottom 1% (year by year) of the observations for all the variables used
in the analysis. In addition, we follow Vissing-Jørgensen (2002) and remove observations
in consumption growth that are less 0.20 and greater than 5 (this removes 10 observations).
Trimming more aggressively (top/bottom 2%) led to similar estimates of  it and t .
  The second way we address potential measurement error in consumption growth is by
adopting the approach in Vissing-Jørgensen (2002) of using semi-annual changes in order to
minimize time aggregation and category switching concerns due to the fact that households
may only purchase certain categories of goods infrequently. This aggregation from quarterly
to semi-annual consumption changes removes a significant amount of the variation in con-
sumption growth: the standard deviation of consumption growth falls from 0.311 to 0.248.
This suggests that time aggregation and category switching are a significant phenomena in
the micro data that the Vissing-Jørgensen (2002) procedure helps to remove.
  Third, it is worth noting that  it and t are cross-sectional averages of household-level
observations, an operation that tends to reduce the impact of measurement errors. To see
why, suppose that the observed consumption of an household is related to the true con-
                                  ~jt × exp{ jt } where  jt is a Gaussian iid measurement error
          ~jt , as follows c jt = c
sumption, c
with mean -    2 /2 and variance 2 . Assume further that  is independent from the true
                                                         jt
level of consumption c~jt . Then, we have

                     Ni   c jt-1     Ni                            Ni
                1                1                            1
                Ni    c jt = Ni       exp{- log(c
                                                ~jt )} ×
                                                              Ni    exp{-jt }
                     j =1            j =1                          j =1
                             + Cov exp{- log(c
                                             ~jt )}, exp{- jt } .

If Ni  , then the covariance term goes to zero and the measured  it becomes

                                       it = ~ it × exp{2
                                                         },

where ~ it is the statistics computed using the true consumption. That is, in the case of
classical measurement errors, our  it statistics is off relative to the truth by a time-invariant



                                               27
factor.20 A similar derivation can be done for t . Because our analysis is not focused on the
levels of these variables but rather on their changes over time, it is robust to the presence of
classical multiplicative measurement errors in consumption.
    In the discussion above, we have assumed that the distribution of the measurement errors
is uncorrelated with households' characteristics. Aguiar and Bils (2015) provide evidence
that rich households systematically underreport consumption. Mean differences in mea-
surement error (µY       > µY ) is not a problem for our approach because the difference
                       high   low
in means cancels in the above calculation. Furthermore, Figure A-3 in Appendix B.5 shows
that we find a similar time-series pattern and relative ranking for  it 's when we measure  it
in the PSID, a data set where there is no concern about differential measurement error.
    Fourth, in the implementation of the counterfactual in the next section, we will add Gaus-
sian measurement errors on both  it and t . This feature is intended to mitigate the impact
that non-classical errors have on the measured preference shocks.



4     Imperfect risk-sharing and the US Great Recession
In this section we exploit the representation in Proposition 1 along with the time series for
            cm to quantify the macroeconomic effects of imperfect risk-sharing during the
 it , t and t
US Great Recession. We start in Section 4.1 by detailing how we implement in practice
the counterfactuals that we discussed in Section 2.4. As we explain there, a preliminary step
consists in choosing the structural parameters of the model, which we estimate in Section 4.2.
Section 4.3 presents the impulse response functions to  it and t , an exercise that is useful to
understand how changes in these preference shocks feed back to macroeconomic variables
in the estimated model. Section 4.4 reports the results of the counterfactual. In Section 4.5
we perform a sensitivity analysis of our results by introducing capital accumulation in the
model.


4.1    Counterfactuals in practice

In order to implement the counterfactuals discussed in Section 2.4 we need a procedure to
estimate the stochastic processes { (zt ), A(zt ),  m (zt ),  i (vt-1 , zt ),  (zt )} and to retrieve the
realization of zt from the data.
  We start by assuming a Markovian structure for the states, Pri (st |st-1 ) = Pri (st |st-1 ).
Without loss of generality, we can then set z1,t = ^t , z2,t = A
                                                               ^ t and z3,t =  m,t , where   ^t
   20 In our applications, the group have a size of roughly 600 observations in each year. Through Monte Carlo

simulations we have verified that this is enough for the law of large numbers to apply when  jt is iid.


                                                     28
    ^ t are the logarithm of these two variables. The vector zt could potentially incorporate
and A
other aggregate shocks (for example, shocks affecting financial constraints), and we leave
that unrestricted. Following much of the existing literature, we assume that the aggregate
preference shock and the technology shocks follow AR(1) processes,

                                 ^t =  
                                       ^t-1 +   ,t                 ,t  N (0, 2
                                                                               )
                                ^ t = a A
                                A       ^ t -1 +  A,t                        2
                                                                  A,t  N (0, A ),

                2 ).
and  m,t  N (0, m
   Making assumptions about  i (vt , zt+1 ) and  (zt ) is conceptually more problematic, be-
cause those are not fundamental shocks and do not necessarily inherit the Markov structure
of st .21 To explain the nature of the problem, suppose that households can only save/borrow
in a risk-free nominal bond and they face a borrowing limit bi (st )  -. In a recursive
competitive equilibrium, the distribution of assets is an aggregate state variable that itself
follows a Markov process. The implied process for  i (vt-1 , zt ) and  (zt ), however, will be
a vector moving average of order infinity, which is not a feasible process for estimation. In
time series analysis, these processes are approximated with finite-order ones. We follow this
strategy and approximate their law of motion using independent AR(1) processes. Specifi-
cally, let  t  maxi  it-1 and define Tt = [ ^ t, ^ t ] to be the de-meaned logarithm of these
processes.22 We assume that Tt follows the process

                                               T t =  T t -1 +  T ,t ,                                           (29)

where  T,t  N (0, ), and the restriction is that  and  are diagonal matrices. In our
application, we choose a parsimonious stochastic process due to the limited length of the
sample.
   Let us emphasize two features of the system in (29). First, the process for  it is individual-
specific. Given our strategy of grouping households, we should in principle include in Tt
the measured  it for each group. In our application, we only include the "max" in Tt .
This simplification allows us to economize on the number of state variables when solving
the equivalent representative-agent economy with global methods. In addition, it is worth
noting that in our sample the max is achieved in almost every period by the income-rich
   21 A similar issue arises in the accounting procedure of Chari, Kehoe, and McGrattan (2007), see their dis-
cussion in Section 2.
   22 To understand why we lag  by one period, consider 
                                     it                           i2008 defined in equation (27). This variable
measures the cross-sectional average of the inverse changes in consumption shares for group i within the 2008
calendar year. This corresponds in the model to realization of the discount factor for the Euler equation that
holds at the beginning of 2008, see equation (21). The realization of this variable is relevant for forecasting the
discount factor in the Euler equation at the beginning of 2009, explaining why   ^ i2008 is a state variable for 2009.



                                                         29
households which have similar stochastic properties for  it .23 Therefore, we do not think
we are losing much in practice by using maxi  it in our application. Second, we are not
allowing the structural shocks to load on Tt . This is mostly an ex-post result, rather than an
actual restriction: when estimating the model, we found that these loadings were imprecisely
estimated, so we decided to set them to zero.
   Given a stochastic process for Xt = [^t , A
                                             ^ t ,  m,t , Tt ] and numerical values for the model
parameters, we can then solve for the aggregate variables as a function of the state St =
[it-1 , Xt ] using the system of equations in Proposition 1. For this purpose, we employ a
variant of the algorithm developed in Gust, Herbst, López-Salido, and Smith (2017) to solve
the representative agent New Keynesian model with an occasionally binding zero lower
bound constraint, see Appendix C for a detailed description of the algorithm. We can then
implement the counterfactuals described in Section 2.4 in three steps.
   In the first step, we estimate the parameters of the equivalent representative-agent econ-
omy using the measured preference shocks and macroeconomic variables that are routinely
used to estimate the three-equations representative agent New Keynesian model: nominal
interest rates, inflation and real GDP.
   In the second step, we apply a non-linear filter to the estimated model and retrieve the
sequence of shocks that rationalizes the path of the observed variables in the sample. This
step provides us with an estimate of the aggregate shocks, {^t , A
                                                                 ^ t ,  m,t } .
   In the third and final step, we obtain the paths for macroeconomic variables in a coun-
terfactual economy with complete financial markets. To do so, we first solve for the policy
function of the system in Proposition 1 under the assumption that ^ t = 0, t. We then obtain
the counterfactual path for the aggregate variables by feeding these policy functions with
the time path of {^t , A
                       ^ t ,  m,t } estimated in step 2 and  cm measured in Section 3.
                                                                    t



4.2     Estimation

The model is estimated at an annual frequency on the 1997-2012 period. We map the log of
                     ^t , to the percentage deviations of log real GDP from a linear determin-
output in the model, Y
istic trend.24 The inflation rate t is the annual percent change in the consumer price index,
and it is mapped to the annual effective federal funds rate.
   The model parameters are the ones governing preferences, [ , , , ], the importance of
price adjustment costs  , the elasticity of substitution across varieties µ, the behavior of the
monetary authority [i ,  , y ,   ] and the stochastic process for Xt .
   23 For   3t , the first-order autocorrelation in the sample is 0.39 and its standard deviation is 0.043. For  4t
these statistics are 0.33 and 0.043.
   24 In the model, output is net of adjustment costs.



                                                        30
  We fix a subset of these parameters to conventional values in the literature. Consistent
with the measurement of the preference shocks, we set  =  = 1. We let µ = 1.2 and
set  to 1/µ, so that consumption and output equal 1 in a deterministic steady state of the
model. Finally, we set the target inflation rate to 2%, and  = 0.99, values that guarantee
that the model matches the average inflation and nominal interest rate in our sample in a
deterministic steady state.
    The remaining parameters, [ , i ,  , y ] and [ ,  ,  A , A , m , , ] are estimated. Let
       ^t , it , t , Tt ] be the vector of observable variables, and denote by Y T all the observations
Y t = [Y
in our sample. The state vector is St = [it-1 , ^t , A
                                                     ^ t ,  m,t , Tt ]. The model of Section 2 defines
the non-linear state space model

                                       Y t = g ( S t ;  ) + t
                                        S t = f ( S t -1 ,  t ;  ),                               (30)

where g(.) and f(.) represent the policy functions of the model,  the vector of parameters to
be estimated,  t collects the innovations to the stochastic variables of the model. The vector
t collects Gaussian measurement errors that capture deviations between the data Yt and
g(St ; ). We introduce measurement errors only for the preference shocks, as those are mea-
sured using survey data, and fix their variance to 10% of the unconditional variance of these
series. In Appendix D.3 we repeat the analysis with a larger variance for the measurement
errors.
  Given this representation, we can apply filtering techniques to the state-space system
and evaluate the likelihood of the model, L(|Y T ). We can then combine the likelihood
function with a prior for the structural parameters, p(), and apply the Metropolis-Hastings
algorithm to sample from the posterior distribution of  (An and Schorfheide, 2007),

                                     p (  | Y T )  p (  ) L (  | Y T ).


  Appendix D describes the algorithm for estimating the model and its in-sample fit. For
the purpose of estimation, we solve for the policy functions with a first-order perturbation.
The first-order perturbation solution is much faster and numerically more stable than the
global approximation discussed in Appendix C, and it allows us to use the Kalman filter for
the evaluation of the likelihood function. The main drawback is that, by using perturbation
methods, we do not account for the possibility of a binding zero lower bound constraint
on nominal interest rates when estimating the model parameters. The non-linear model,
however, fits the data remarkably well once we apply the parameters estimates that we
obtain here (see the model-fit analysis in Appendix D), so we believe we would obtain very


                                                    31
                   Table 1: Prior and posterior distribution of model parameters

                                          Prior                               Posterior
                    Parameter Distribution Mean                St. dev. Mean 90% Interval
                    4×        Gamma         85.00               15.00   73.71 [52.17, 93.81]
                    i         Beta           0.50                0.25    0.57    [0.34, 0.80]
                              Normal         1.50                2.00    3.72    [1.91, 5.41]
                    y         Normal         1.00                2.00    0.18    [0.00, 0.42]
                              Beta           0.50                0.28    0.69    [0.49, 0.90]
                    A         Beta           0.50                0.28    0.91    [0.83, 0.99]
                     ,        Beta           0.50                0.25    0.33    [0.06, 0.55]
                      ,       Beta           0.50                0.25    0.86    [0.74, 0.99]
                    100 ×     InvGamma       1.00                5.00    2.48    [1.02, 4.02]
                    100 × A   InvGamma       1.00                5.00    2.18    [0.73, 2.89]
                    100 × m   InvGamma       1.00                5.00    1.94    [1.15, 2.69]
                    100 ×     InvGamma       1.00                5.00    2.24    [1.51, 2.96]
                    100 ×     InvGamma       1.00                5.00    2.28    [1.29, 3.25]
Notes: The prior on  and y is truncated at zero. The posterior statistics reports the mean, fifth and ninety-fifth
percentile of the posterior distribution estimated by pooling 2 Markov chains with 100,000 draws each (including a
100,000 draw burn-in period for each chain).


similar parameter estimates if we were to estimate it with non-linear methods.
   Table 1 reports posterior statistics for the model parameters. The structural parameters
defining the behavior of the monetary authority and the price adjustment costs are in line
with previous estimates reported in the literature. For instance, they are comparable to the
estimates reported in the working paper version of Gust et al. (2017), who used aggregate
data to estimate a similar version of our model ­ a representative agent three-equations New
Keynesian with technology shocks, discount factor shocks and monetary policy shocks. An
important parameter for the analysis that follows is the persistence of ^ t ,  , , because this
parameter influences the effect that a high realization of ^ t has on the discount factor in the
Euler equation of the model. When  , = 0, for example, a high value of         ^ t has no impact
on this discount factor, and so it does not affect the behavior of aggregate variables. The
posterior mean of this parameter is 0.33, which is close to the OLS coefficient estimated by
fitting an AR(1) process on ^ t (0.27).


4.3    Impulse response functions

Before moving to our counterfactual, it is useful to study how changes in ^ t and ^ t --the
preference shifters measured using households-level data--affect aggregate variables in the
estimated model.

                                                          32
   For this purpose, we fix the model parameters at the posterior mean of Table 1, solve
the model numerically, and compute impulse response functions (IRFS) to a 2 standard
deviations increase in ^ t and a 0.14 standard deviation increase in  ^ t . We chose a 0.14
standard deviation shock to mimic the typical deviation between  ^ t and     cm in Figure 4.25
                                                                            ^t
Because the model is non-linear, the IRFs are potentially state-dependent. The solid line in
Figure 5 reports the IRFs when the initial state S0 is at the ergodic mean while the circled
line reports IRFs when S0 is such that the implied level of the nominal interest rate absent
the shock equals zero.26
   Starting with the top panels of the figure, we can study the effects of an increase in  t , as
we have seen for example during the 2008-2010 recession. This increase in patience induces
a decline in aggregate consumption for a given level of the real interest rate. This decline
in aggregate demand lowers inflation which, for a given level of the nominal interest rate,
increases real interest rates and further depresses aggregate consumption. When nominal
interest rates are positive, as in the case described by the solid line in the figure, the central
bank responds to the shock by cutting nominal interest rates by 130 basis points, given the
estimated Taylor rule. This mitigates the aggregate effects of the  t shock: a two standard
deviations increase in  t results in a 0.6% (0.10 standard deviations) decline in aggregate
output and 0.4% (0.23 standard deviations) decline in inflation. When the economy is at the
zero lower bound, instead, the central bank cannot cut nominal interest rates further and the
shock has larger effects on output (-1.5%) and inflation (-0.5%).
  The bottom panels in Figure 5 reports the response to an increase in ^ t , in line with the
behavior of ^t -  cm during the 2008-2010 recession. This shock reduces labor supply and
                 ^t
it increases the marginal cost for firms, leading to an increase in inflation and a reduction
in output. The central bank responds by increasing nominal and real interest rates, which
further depress output and mitigate the rise in inflation. At the zero lower bound, the
central bank cannot respond to the shock. Because expected inflation increase, real interest
rates on nominal bonds fall, thus mitigating the impact of the shock on output: given our
parametrization, output slightly increases at the zero lower bound. We can see from the
figure, however, that these changes have quantitatively small effects on aggregate variables
in the estimated model, implying that the measured differences between    ^ t and  cm are not
                                                                                  ^t
large enough to induce sizable movements in aggregate variables.
   25 The  ratio between Stdev(   ^tcm -  ^ t ) and Stdev(^ t ) is 0.07. Thus, 0.14 corresponds to a two standard
deviations change in the value of leisure due to imperfect risk-sharing.
   26 We compute non-linear IRFs following Koop, Pesaran, and Potter (1996). Consider the IRFs to        ^ t . Given
an initial condition S0 , we compute 2 × M simulations of the model of length T . In the first M simulations,
we restrict the innovations to  ^ t at t = 1 to equal 2 ×  . The innovations in the second M simulations are the
same as in the first, with the exception that  ,1 = 0. To obtain the IRFs, we average the first and second sets of
simulations across M and take the difference between the two paths. The IRFs to t are computed in a similar
fashion. In the figure, we set M = 10, 000 and T = 10.


                                                        33
                                     Figure 5: IRFs to preference shocks

      0                                      0                                     0


    -0.5                                  -0.2                                   -0.5



      -1                                  -0.4                                     -1


                                                                                 -1.5
    -1.5                                  -0.6
           0   2   4     6     8    10           0   2   4     6     8     10           0   2   4     6     8    10



   0.08                                    0.1                                   0.05

                                          0.08
   0.06                                                                            0
                                          0.06
   0.04                                                                         -0.05
                                          0.04
   0.02                                                                          -0.1
                                          0.02

      0                                      0                                  -0.15
           0   2   4     6     8    10           0   2   4     6     8     10           0   2   4     6     8    10
Notes: The solid lines reports IRFs when setting S0 to the ergodic mean. The circled lines report IRFs for an
economy that is at the zero lower bound. Specifically, we set the i0 = 0 and 0 = 0.08 while keeping the other state
variables at their ergodic mean. These conditions guarantee that the economy is at the zero lower bound. The IRFs
are computed as explained in footnote 26, and they are reported in percentages.


4.4        Counterfactuals

We can now use the estimated model to measure the macroeconomic effects of imperfect
risk-sharing during the Great Recession. We start by applying the particle filter to the state-
space representation (30) and obtain an estimate for the latent variables St . Because it and
Tt are elements of Yt , the truly latent states are [^t , A
                                                          ^ t ,  m,t ]. Consistent with the estimation
of the model, we set a measurement error for Tt equal to 10% of its unconditional variance,
while we introduce a small measurement error for the macroeconomic variables (1% of their
unconditional variance) in order to increase the stability of the filter.
   Figure 6 reports the data used in the experiment along with the mean of the filtered states
and endogenous variables implied by the model. By construction, the model tracks almost
perfectly the real GDP, inflation and nominal interest rates over the sample because the
measurement errors on these variables are small, and it follows closely the behavior of ^ t and
 ^ t . As for the structural shocks, the model requires a persistent decline in technology shocks
and a persistent increase in      ^t in order to replicate the dynamics of the macroeconomic
variables during the Great Recession.
   Equipped with the path St , we can then construct the trajectories for real GDP, nomi-
nal interest rates and inflation that would prevail in an economy with complete financial

                                                          34
                                       Figure 6: Data and model objects


                                         0.06
  2
  0                                      0.04                                          0
 -2                                      0.02
                                                                                  -0.05
 -4                                         0
 -6                                     -0.02                                       -0.1
        2000      2005         2010             2000         2005        2010              2000         2005        2010


 5                                       0.05                                      0.02
                                                                                      0
                                            0                                     -0.02
                                        -0.05                                     -0.04
 0                                       -0.1                                     -0.06
        2000      2005         2010             2000         2005        2010              2000         2005        2010

                                         0.06
 3                                       0.04
 2                                       0.02
 1                                          0
                                        -0.02
 0                                      -0.04
        2000      2005         2010             2000         2005        2010
Notes: The circled line reports the data used in the experiment. The solid lines report the filtered series for Yt and
St in the model.


markets. For that purpose, we solve numerically for the policy functions of the equivalent
representative-agent economy with no shocks to ^ t . After obtaining these policy functions,
we construct the counterfactual path for the macroeconomic variables by feeding these pol-
icy functions with the estimated path for [^t , A
                                                ^ t ,  m,t ] and ^ cm , see Appendix D for a detailed
                                                                              t
description of this experiment.
      Figure 7 compares the trajectories for output, inflation and nominal interest rates in this
counterfactual (circled lines) with the actual trajectories in US data (solid lines) during the
2007-2011 period. From peak to through, de-trended real GDP in the US fell by 8% in 2009-
2010. The counterfactual economy with  t = 1 displays a smaller decline in real economic
activity during this period, respectively 6.1% and 6.4%. Thus, our findings are consistent
with the view that deviations from perfect risk-sharing was an important dimension of the
US Great Recession, accounting for roughly 20% of the observed output declines.
  Why do we observe these differences between the baseline and the counterfactual econ-
omy? From Figure 6 we can see that ^ t was sensibly above the mean in those years. As we
have seen from the impulse response analysis, a higher rate of time preference contributes
to a decline in aggregate demand and inflation, amplified by the fact that nominal interest
rates were at zero in 2009. In the counterfactual economy with  t = 1, these developments
are absent, explaining the differences between the data and the counterfactual.

                                                            35
                    Figure 7: Imperfect risk-sharing and the US Great Recession


   0                                      6                                      1

                                                                               0.5
                                          5
  -2
                                                                                 0

                                          4                                   -0.5
  -4
                                                                                -1
                                          3
                                                                              -1.5
  -6
                                          2                                     -2

                                                                              -2.5
  -8
                                          1
                                                                                -3

-10                                      0                                    -3.5
  2007 2008 2009 2010 2011               2007 2008 2009 2010 2011               2007 2008 2009 2010 2011
Notes: The solid line reports real GDP, nominal interest rates and inflation during the 2007-2011 period. We
normalize real GDP and inflation to 0 in 2007. The circled line reports the same variable in the counterfactual
economy with complete financial markets.


   While this exercise detects an important role for imperfect risk-sharing in 2009-2010, it
also points toward fairly transitory effects. This is due to two features. First, by 2011 the
measured   ^ t falls back to its unconditional mean. Second, the model of Section 2 lacks an
internal propagation mechanism, as nominal interest rates are the only endogenous variable
and they are equal to zero during this period.


4.5    Adding capital accumulation

So far, we have conducted our analysis in the context of the standard three-equations New
Keynesian model. While we have deliberately chosen this framework for its simplicity, a
natural question is whether the results of the counterfactual would be sensibly different if
we were to consider, instead, a New Keynesian model closer to the ones used in quantitative
analyses. Introducing capital accumulation might be particularly relevant in this respect. In
a model with physical capital, an increase in households' propensity to save ­ a higher  t
­ tends to increase aggregate investment, a feature that counteracts the negative effects that
this shock has on consumption. In the context of our counterfactual, this could potentially
reduce the output losses displayed in Figure 7. We argue, however, that this mechanism


                                                        36
is not particularly relevant for our application. As we show next, when the zero lower
bound constraint binds, an increase in  t reduces not only aggregate consumption but also
aggregate investment.
  We introduce physical capital in the model of Section 2 by assuming that the intermediate
good producers have a Cobb-Douglas production function,

                                                                                1- 
                              y j ( z t ) = A ( z t ) k j ( z t -1 )  n j z t         .

The intermediate good producers rent capital from a capital good producing firm that dis-
count dividend using the state price (24). Physical capital depreciates at the rate , and it is
accumulated following the law of motion

                                K ( z t ) = ( 1 -  ) K ( z t -1 ) + I ( z t ).

In addition, we assume that capital good producers pay a quadratic cost when adjusting the
capital stock,
                                                                2
                                           I (zt )
                                                       -            K ( z t -1 ).
                                    2     K ( z t -1 )
  These features change the decision problem of the firms presented in Section 2.1, while
they leave the decision problem of households mostly unaffected. The only difference is that
that the assets traded by the households must include claims on the capital stock. Appendix
E discusses the details of this extension, and formally states a version of Proposition 1 in this
environment. In addition to the resource constraint, the Phillips curve, the Euler equation
for nominal bonds and the Taylor rule, the equivalent representative-agent economy now
features also an Euler equation for capital.
  To explore how capital accumulation affects our results, we set  = 0.33,  = 0.10 and  =
1, standard values in the business cycle literature, while we keep the remaining parameters
at the posterior mean reported in Table 1. We then apply our global solution algorithm
to obtain the model's policy functions. Figure 8 reports IRFs to a two standard deviations
increase in ^ t . Similarly to the previous analysis, we report the IRFs at two different points
in the state space: the ergodic mean (solid line), where nominal interest rates are positive,
and an initial state such that nominal interest rates are at the zero lower bound (circled line).
  At the ergodic mean, an increase in ^ t leads to a reduction in aggregate consumption,
inflation and nominal interest rates, as it was the case for the economy without capital.
Because nominal interest rates decline by more than expected inflation, the real interest
rate on nominal bonds decreases. This reduction in real interest rates induces an increase in
aggregate investment through the Euler equation for capital. Thus, away from the zero lower


                                                        37
                               Figure 8: IRFs to ^ t in the model with capital


       0                                      0
                                                                                   0.4
    -0.1                                   -0.5
                                                                                   0.2
                                             -1
    -0.2                                                                            0
                                           -1.5
                                                                                  -0.2
    -0.3                                     -2
           0   2    4     6     8    10           0   2    4     6     8    10           0   2    4     6     8    10


                                              4                                     1
       0
                                                                                    0
      -1                                      2
                                                                                    -1
                                              0
      -2
                                                                                    -2
                                             -2
      -3                                                                            -3
           0   2    4     6     8    10           0   2    4     6     8    10           0   2    4     6     8    10
Notes: The solid lines reports IRFs when setting S0 to the ergodic mean. The circled lines report IRFs for an economy
that is at the zero lower bound. The initial conditions are set at their long run average under the assumption that
t = 0.10  t. These conditions guarantee that the economy is at the zero lower bound. The IRFs are computed as
explained in footnote 26, and they are reported in percentages.


bound, the increase in patience moves consumption and investment in opposite directions.
Given our calibration, the overall effects of the shocks on output are small and positive:
that is, an increase in households' incentives to save in the model with capital are typically
expansionary.
   When the economy is at the zero lower bound, however, the dynamics are different. The
increase in ^ t still reduces aggregate consumption and inflation, but now the monetary
authority cannot reduce nominal interest rates. Because the decline in inflation is persistent,
the real interest rate on nominal bonds increases. The increase in real interest rates reduces
the incentives to accumulate capital, and so also aggregate investment falls. Hence, at the
zero lower bound an increase in households' incentives to save generates a fall in aggregate
consumption and investment, which implies that the overall effects are recessionary as in
our benchmark model.
   Comparing the IRFs in Figure 8 with those in the top panel of Figure 5, we can see
that the overall output effects of a two standard deviations increase in ^ t are quantitatively
comparable across the two models when the zero lower bound constraint binds: if anything,
the model with capital produces slightly larger output losses. We conclude that the results
of the main counterfactual would not be sensibly different in more quantitatively plausible


                                                           38
versions of the model, because the measured increase in ^ t took place when nominal interest
rates were at zero.



5     Inspecting the mechanism
The dynamics of {  it , t } summarize all the information from cross-sectional data that is
needed to asses the aggregate implications of imperfect risk-sharing in the class of models
studied in this paper. That is, two economies with different primitives that generate the
same stochastic process for {  it , t } imply the same pattern for macroeconomic aggregates.
While our approach is not designed to discriminate between alternative models, we can use
the information in the CEX to evaluate different mechanisms that have been proposed in the
literature.
    From the analysis in Section 3, we know that the Jensen term in the decomposition of
equation (28) accounts for 5/8 of the increase in 2008 in  it for the savers. That is, most of
the increase in the measured discount factor during the Great Recession is due to an increase
in the dispersion of consumption changes for the high income group. This observation casts
some doubts on the empirical relevance of the so-called "two-agent" New Keynesian models
studied for example in Galí, López-Salido, and Vallés (2007), Bilbiie (2008), and Debortoli and
Galí (2017). These models emphasize differential consumption growth across two groups of
households, hand-to-mouth and savers, as the key mechanism through which imperfect risk-
sharing impact the aggregate. By construction, they do not generate dispersion within the
group of savers. Our analysis, instead, shows that idiosyncratic risk within this group is
of first-order importance for understanding deviations from perfect risk-sharing during the
Great Recession.
    There are two mutually non exclusive channels that have been proposed in the literature
that can explain this increase in dispersion. One channel emphasizes a deterioration of
the risk-sharing mechanisms available during the Great Recession, such as a tightening of
borrowing constraints. A tightening of individual borrowing constraints can generate higher
sensitivity of consumption to negative income changes, leading to an increase in  it in the
equivalent representative-agent economy. A second force that can lead to an increase in the
cross-sectional dispersion of consumption shares would be an increase in idiosyncratic labor
income risk, see our example in Section 2.3.
    We can use the household-level data to investigate which of these two mechanisms bet-
ter account for the dynamics of  it . We first check whether there has been a change in the
distribution of yt /yt-1 during the Great Recession for the high income groups, the one we
identify as savers. The top panel of the Table 2 displays the percentiles of yt /yt-1 before


                                               39
and during the Great Recession. The two distributions appear remarkably similar, suggest-
ing that changes in the distribution of labor income for this group of households did not
contribute to the increase in their measured  it .27
   Second, we check if there has been an increase in the sensitivity of consumption to income
changes during the Great Recession. Specifically, we estimate the following linear relation

                        c jt-1 /Ct-1                y jt                  y jt
                                         = +                + rect +             × rect + e jt ,
                            c jt /Ct               y jt-1               y jt-1

where rect is an indicator function equal to 1 for t = 2008 or t = 2009 and we condition
only on households experiencing negative income changes (yit /yit-1 < 1).28 A negative
value of  implies that, for a given negative change in income, households were cutting
their consumption expenditures more in 2008-2009 than they did in 2006-2007. The bottom
panel of Table 2 reports the estimates for all households, and when partitioning individuals
along the income and net worth dimension. We can detect an increase in the sensitivity of
consumption to income during the Great Recession for households with high income and
high net worth, the group with the highest measured  it over this period.
   The evidence in Table 2 suggests that structural models that emphasize a reduction in the
ability of savers to smooth income shocks during the Great Recession have a better chance of
being consistent with the micro data than structural models emphasizing a pure increase in
idiosyncratic labor income risk. A labor-income risk explanation can however be consistent
with the evidence of Table 2 if the Great Recession was associated with a change in the nature
of idiosyncratic income shocks affecting high income individuals. For instance, consider a
shift in the composition between a permanent and a transitory component of idiosyncratic
income shocks.29 If the permanent component increases while the transitory decreases, this
could rationalize why in Table 2 we detect an increase in the responsiveness to negative
income shock in absence of significant shifts in the distribution of income changes. This is
because permanent shocks are harder to smooth than transitory ones in baseline incomplete
   27 These  results are consistent with previous papers that examined the cyclical behavior of income changes.
While Storesletten, Telmer, and Yaron (2004) found evidence of countercyclical income risk, their estimates are
obtained from an estimated income process for the entire population, and it is not comparable to the results
in Table 2 that condition on sub-group of the population. The work by Heathcote, Perri, and Violante (2010)
finds little cyclical variation in earnings growth for households between the 50th and 90th percentiles of the
earnings distribution, which corresponds roughly to the sub-group displayed in Table 2 (households with
income above the median). The authors document significant cyclical variation for poorer households due to a
higher incidence of unemployment during recessions, a result that is confirmed by Guvenen, Ozkan, and Song
(2014) with Social Security Administration data.
   28 This sample restriction is motivated by the fact that sharp non-linearity in the relationship between relative

consumption shares and income growth occurs when individual income growth falls. See panel (a) of Figure 2
for a graphical illustration.
   29 This hypothesis is similar to the mechanism in Blundell, Pistaferri, and Preston (2008) to account for the

changes in the consumption distribution relative to the income distribution over the 1970s to 1990s.


                                                           40
                Table 2: Explaining the rise in  JEN ,it during the Great Recession


                                       Distribution of Income Growth Rates


                  YH Households            p1     p5     p10     p25    p50    p75    p90    p95     p99
                    2006-2007             0.25   0.44    0.69    0.80   0.94   1.06   1.23   1.41    2.00
                    2008-2009             0.21   0.45    0.69    0.81   0.95   1.07   1.23   1.38    1.89

              YH , NWH Households
                    2006-2007             0.25   0.44    0.61    0.80   0.94   1.05   1.23   1.45    2.06
                    2008-2009             0.23   0.44    0.58    0.79   0.95   1.06   1.24   1.43    1.93



                            Consumption Response to Income Changes in 2006-2009
                            All Groups                                  Separate Groups
                                                    (YH )    (YL , NWL ) (YL , NWH ) (YH , NWL )       (YH , NWH )
    Y                   -0.431       -0.247        -0.146     -0.579        -0.213      -0.203            -0.0909
                         (-4.04)     (-2.47)      (-1.07)      (-2.28)      (-1.39)     (-0.90)            (-0.59)
    Recession                         0.287      0.630         -0.240      -0.0274       0.179            1.078
                                      (1.59)       (2.07)      (-0.88)      (-0.16)      (0.73)             (1.96)
    Recession x Y                   -0.369       -0.733         0.220      -0.0584      -0.198           -1.272
                                     (-1.74)      (-2.05)      (0.69)       (-0.28)     (-0.68)            (-1.96)
    _cons               1.611       1.468        1.377        1.726       1.472       1.438              1.318
                         (17.79)     (17.49)      (12.14)      (7.95)      (11.77)      (7.66)            (10.22)
    N                     9016         9016         4818        2032         2166         2305               2513
    Weights                 Y           Y             Y            Y           Y           Y                  Y
  Notes: The top panel displays the distribution in income growth for two time periods (2006/2007 and 2008/2009).
  The first two rows reports the distribution for households with income above the median and the third and fourth
  rows report it for households with income and net worth above the median. The bottom panel reports the OLS
  estimates of the following relation over the 2006-2009 period

                               cit-1 /Ct-1               yit            y
                                               = +            + rect +  it × rect + eit ,
                                  cit /Ct               yit-1          yit-1

  where rect is an indicator function equal to 1 for t = 2008 or t = 2009. All t statistics are reported in parentheses
  and all regressions use robust standard errors. The first and second column reports the estimates when using all
  households. The third column when using households with yit-1 above median. The remaining columns report the
  estimates separately for each of the group.


markets model, and so consumption is more sensitive to the former than the latter.




                                                            41
6     Conclusion
This paper has proposed a simple approach to assess the macroeconomic implications of im-
perfect risk-sharing implied by a class of New Keneysian models with isoelastic preferences,
idiosyncratic income risk and incomplete financial markets. In this class of models, house-
holds' inability to insure idiosyncratic risk is reflected in time-variation in their consumption
shares. Leveraging this insight, we use households' consumption choices to directly measure
the degree of imperfect risk-sharing for the US economy. We document a deterioration of
risk-sharing during the US Great Recession, as the cross-sectional dispersion of households'
consumption shares increases throughout this period. In addition, we show that households'
self-insurance motives associated to this shift contributed to a decline in aggregate demand
and they accounted for roughly 20% of the output losses observed in 2009 and 2010.
    Our approach is silent about the shocks and frictions that contribute to the observed
deviations from perfect risk-sharing. As a result, it is not designed to address important
questions in the literature, such as the transmission mechanisms of monetary policy when
financial markets are incomplete or the effects of specific shocks and frictions on households'
precautionary savings. To address these questions, one needs fully specified structural mod-
els. Our paper clarifies that different model ingredients matter for aggregate fluctuations
only through their impact on two summary statistics of the distribution of households' con-
sumption shares and relative wages ­ what we labeled preference shocks. We believe that
structural models with heterogeneous agents interested in aggregate fluctuations should be
calibrated/estimated to match the statistical properties of these two summary statistics.



References
Aguiar, Mark and Mark Bils. 2015. "Has consumption inequality mirrored income inequal-
    ity?" American Economic Review 105 (9):2725­56.

Alvarez, Fernando and Urban J Jermann. 2000. "Efficiency, equilibrium, and asset pricing
    with risk of default." Econometrica 68 (4):775­797.

An, Sungbae and Frank Schorfheide. 2007. "Bayesian analysis of DSGE models." Econometric
    reviews 26 (2-4):113­172.

Attanasio, Orazio P and Luigi Pistaferri. 2016. "Consumption inequality." Journal of Economic
    Perspectives 30 (2):3­28.

Auclert, Adrien. 2017. "Monetary policy and the redistribution channel." Tech. rep., National
    Bureau of Economic Research.


                                                42
Auclert, Adrien, Matthew Rognlie, and Ludwig Straub. 2018. "The Intertemporal Keynesian
  Cross." Tech. rep., January 2017 working paper.

Bayer, Christian, Ralph Lütticke, Lien Pham-Dao, and Volker Tjaden. 2019. "Precautionary
  savings, illiquid assets, and the aggregate consequences of shocks to household income
  risk." Econometrica 87 (1):255­290.

Bilbiie, Florin O. 2008. "Limited asset markets participation, monetary policy and (inverted)
  aggregate demand logic." Journal of Economic Theory 140 (1):162­196.

Blundell, Richard, Luigi Pistaferri, and Ian Preston. 2008. "Consumption inequality and
  partial insurance." American Economic Review 98 (5):1887­1921.

Brav, Alon, George M Constantinides, and Christopher C Geczy. 2002. "Asset pricing with
  heterogeneous consumers and limited participation: Empirical evidence." Journal of Polit-
  ical Economy 110 (4):793­824.

Broer, Tobias, Niels-Jakob H. Hansen, Per Krusell, and Erik Oberg. 2018. "The New Keyne-
  sian Transmission Mechanism: A Heterogeneous-Agent Perspective." Review of Economic
  Studies forthcoming.

Challe, Edouard, Julien Matheron, Xavier Ragot, and Juan F Rubio-Ramirez. 2017. "Precau-
  tionary saving and aggregate demand." Quantitative Economics 8 (2):435­478.

Chari, Varadarajan V, Patrick J Kehoe, and Ellen R McGrattan. 2007. "Business cycle account-
  ing." Econometrica 75 (3):781­836.

Chien, YiLi, Harold Cole, and Hanno Lustig. 2011. "A multiplier approach to understanding
  the macro implications of household finance." The Review of Economic Studies 78 (1):199­
  234.

------. 2012. "Is the volatility of the market price of risk due to intermittent portfolio
  rebalancing?" American Economic Review 102 (6):2859­96.

Christiano, Lawrence, Martin Eichenbaum, and Sergio Rebelo. 2011. "When is the govern-
  ment spending multiplier large?" Journal of Political Economy 119 (1):78­121.

Debortoli, Davide and Jordi Galí. 2017. "Monetary policy with heterogeneous agents: In-
  sights from TANK models." Manuscript, September .

Den Haan, Wouter J, Pontus Rendahl, and Markus Riegler. 2017. "Unemployment (fears)
  and deflationary spirals." Journal of the European Economic Association 16 (5):1281­1349.

Eggertsson, Gauti B and Paul Krugman. 2012. "Debt, deleveraging, and the liquidity trap:
  A Fisher-Minsky-Koo approach." The Quarterly Journal of Economics 127 (3):1469­1513.


                                              43
Galí, Jordi, J David López-Salido, and Javier Vallés. 2007. "Understanding the effects of gov-
  ernment spending on consumption." Journal of the european economic association 5 (1):227­
  270.

Gornemann, Nils, Keith Kuester, and Makoto Nakajima. 2016. "Doves for the rich, hawks
  for the poor? Distributional consequences of monetary policy." .

Guerrieri, Veronica and Guido Lorenzoni. 2017. "Credit crises, precautionary savings, and
  the liquidity trap." The Quarterly Journal of Economics 132 (3):1427­1467.

Gust, Christopher, Edward Herbst, David López-Salido, and Matthew E Smith. 2017. "The
  empirical implications of the interest-rate lower bound."        American Economic Review
  107 (7):1971­2006.

Guvenen, Fatih, Serdar Ozkan, and Jae Song. 2014. "The Nature of Countercyclical Income
  Risk." Journal of Political Economy 122 (3):621­660.

Hagedorn, Marcus, Iourii Manovskii, and Kurt Mitman. 2019. "The fiscal multiplier." Tech.
  rep., National Bureau of Economic Research.

Heathcote, Jonathan and Fabrizio Perri. 2018. "Wealth and volatility." The Review of Economic
  Studies 85 (4):2173­2213.

Heathcote, Jonathan, Fabrizio Perri, and Gianluca Violante. 2010. "Unequal We Stand: An
  Empirical Analysis of Economic Inequality in the United States 1967-2006." The Review of
  Economic Dynamics 13 (1):15­51.

Heathcote, Jonathan, Kjetil Storesletten, and Giovanni L Violante. 2014. "Consumption and
  labor supply with partial insurance: An analytical framework." American Economic Review
  104 (7):2075­2126.

Jappelli, Tullio and Luigi Pistaferri. 2010. "The consumption response to income changes." .

Jones, Callum, Virgiliu Midrigan, and Thomas Philippon. 2018. "Household Leverage and
  the Recession." Tech. rep., National Bureau of Economic Research.

Kaplan, Greg, Benjamin Moll, and Giovanni L Violante. 2018. "Monetary policy according
  to HANK." American Economic Review 32 (3):697­743.

Kaplan, Greg and Giovanni L Violante. 2014. "A model of the consumption response to fiscal
  stimulus payments." Econometrica 82 (4):1199­1239.

------. 2018. "Microeconomic Heterogeneity and Macroeconomic Shocks." Journal of Eco-
  nomic Perspectives 108 (3):167­194.



                                              44
Kitagawa, Genshiro. 1996. "Monte Carlo Filter and Smoother for Non-Gaussian Nonlinear
  State Space Models." Journal of Computational and Graphical Statistics 5:1­25.

Kocherlakota, Narayana and Luigi Pistaferri. 2009. "Asset pricing implications of Pareto
  optimality with private information." Journal of Political Economy 117 (3):555­590.

Koop, Gary, M Hashem Pesaran, and Simon M Potter. 1996. "Impulse response analysis in
  nonlinear multivariate models." Journal of econometrics 74 (1):119­147.

Krueger, Dirk and Hanno Lustig. 2010. "When is market incompleteness irrelevant for the
  price of aggregate risk (and when is it not)?" Journal of Economic Theory 145 (1):1­41.

Krueger, Dirk, Hanno Lustig, and Fabrizio Perri. 2008. "Evaluating asset pricing models with
  limited commitment using household consumption data." Journal of the European Economic
  Association 6 (2-3):715­726.

Krueger, Dirk, Kurt Mitman, and Fabrizio Perri. 2016. "Macroeconomics and household
  heterogeneity." In Handbook of Macroeconomics, vol. 2. Elsevier, 843­921.

Krueger, Dirk and Fabrizio Perri. 2006. "Does income inequality lead to consumption in-
  equality? Evidence and theory." The Review of Economic Studies 73 (1):163­193.

Krusell, Per and Anthony A Smith, Jr. 1998. "Income and wealth heterogeneity in the macroe-
  conomy." Journal of political Economy 106 (5):867­896.

McKay, Alisdair. 2017. "Time-varying idiosyncratic risk and aggregate consumption dynam-
  ics." Journal of Monetary Economics 88:1­14.

McKay, Alisdair, Emi Nakamura, and Jón Steinsson. 2016. "The power of forward guidance
  revisited." American Economic Review 106 (10):3133­58.

McKay, Alisdair and Ricardo Reis. 2016. "The role of automatic stabilizers in the US business
  cycle." Econometrica 84 (1):141­194.

Nakajima, Tomoyuki. 2005. "A business cycle model with variable capacity utilization and
  demand disturbances." European Economic Review 49 (5):1331­1360.

Ravn, Morten O and Vincent Sterk. 2017. "Job uncertainty and deep recessions." Journal of
  Monetary Economics 90:125­141.

Rotemberg, Julio J. 1982. "Sticky prices in the United States." Journal of Political Economy
  90 (6):1187­1211.

Storesletten, Kjetil, Chris Telmer, and Amir Yaron. 2004. "Cyclical Dynamics in Idiosyncratic
  Labor Market Risk." Journal of Political Economy 112 (3):695­717.



                                                 45
Vissing-Jørgensen, Annette. 2002. "Limited asset market participation and the elasticity of
  intertemporal substitution." Journal of political Economy 110 (4):825­853.

Werning, Iván. 2015. "Incomplete markets and aggregate demand." Tech. rep., National
  Bureau of Economic Research.




                                              46
    Appendix to "Imperfect Risk-Sharing and the Business
                           Cycle"
                  by David Berger, Luigi Bocola and Alessandro Dovis



A      Relation with Auclert, Rognlie, and Straub (2018)
There is a large and growing literature that has emphasized the role of the distribution of
marginal propensities to consume (MPCs) as a critical statistic to discipline structural New
Keynesian models with heterogeneous agents. This is because MPCs are informative about
the response of aggregate variables to redistributive polices or to shocks like the tightening
of borrowing constraints in partial equilibrium. Auclert, Rognlie, and Straub (2018) show
that a summary statistic for the distribution of MPCs at different time horizons ­ what they
term intertemporal MPCs ­ is a sufficient statistic for the response of output to fiscal shocks in
a class of New Keynesian models. Here we show how our work is connected to this line of
research. In particular, we show that there is a mapping between the relevant statistic of the
distribution of intertemporal MPCs and the impulse response function to aggregate shocks
of the discount factor and disutility of leisure of the stand-in household in our framework.
We do so within the context of a simple two-period economy with shocks to fiscal policy
that satisfies the conditions in Auclert, Rognlie, and Straub (2018).
    Let t = 1, 2 and assume that wages are sticky in period 1 and flexible in period 2. Assume
there are two types of agents, i  { L, H }. Agents differ only in their endowment of efficiency
unit of labor in period 1, e H > e L . Since wages are sticky in period 1, we need to postulate
a mechanism for the allocation of labor between the two types of agents. We assume each
agent works the same amount of hours so that the real labor income of type i agent is ei Y1 .
The resource constraints are then

                                    Y1 =             i ei li1 ,         Y2 =     i li2
                                                      i                        i


    Fiscal policy consists of a lump-sum transfer in period 1 financed by issuing debt to be
repaid in period 2 with lump-sum taxes. For simplicity we allow for taxes in period 2 to
depend on the household's type.
    The problem for a household of type i is

                                                       2                           1+ 
                                                                                 l
                                  max               
                              c 1i , a i , c 2i , l 2i t = 1
                                                               t -1
                                                                      log cit -  it
                                                                                1+



                                                                  A-1
subject to
                                            c1i + ai  ei Y1 + T

                                c2i  w2 l2i - 2i ( T ) + (1 + r ) ai

                                                   ai  0

where ai are the holdings of government debt, T are lump-sum transfers in period 1, and
i ( T ) are lump-sum taxes in period 2.
   The government budget constraint in period 1 is

                                                 T=    i ai
                                                      i

and in period 2 is
                                    i (1 + r)ai =  i i (T )
                                       i                   i

   To simplify the algebra, we assume that taxes in period 2 are given by L ( T ) = 0 and
H ( T ) = T / H so that there are no wealth effect in period 2 and both types of agents
consume and work the same amount. Finally, we assume that monetary policy targets a real
rate r as Auclert, Rognlie, and Straub (2018).
   We can then characterize the equilibrium in this economy as a function of T . In period 2,
                                           1          
the output is efficient and it solves      Y2   = Y2 . We normalize  to one so that Y2 = c2 H =
c2 L = 1.
   If T is small enough, the debt limit ai  0 is binding for the type L agents and the
allocations in period 1 are given by

                                                    1        1 - H
                                Y1 =                       +       T
                                              (1 + r ) e H    eH H
                                                      1 - H
                               c1 H        = e H Y1 -         T
                                                         H
                                c1 L       = e L Y1 + T

Thus the effect of an increase in transfers in period 1 is expansionary and given by

                                                Y1   1 - H
                                                   =       .
                                                T     eH H

   Consider now our representative agent formulation for this economy. The taste shock for




                                                    A-2
the marginal agent,  H , is given by

                                                 -1
                                  c1 H Y1 H                            1 - H
                    H (T ) =          /                   =  eH - T          /Y1 ( T )
                                  c2 H Y2                                H

and the aggregate Euler equation is

                                          1                        1
                                                =  H ( T )(1 + r )
                                       Y1 ( T )                    Y2

so
                                      Y1 ( T )   Y ( T )  H ( T )
                                               =- 1                                       (A.1)
                                       T          H (T ) T
where
                                       H ( T )    1 -  H  H (T )
                                               =-
                                      T            e H  H Y1 ( T )
Thus, if we know how a fiscal policy shock in the detailed economy affect the discount
factor in our representative agent formulation,  H ( T )/ T , we can calculate the response of
output to T by calculating the response of output to the change in the discount factor in the
representative agent formulation.
     We now show how we can use the logic in Auclert, Rognlie, and Straub (2018) to express
the change in output as a function of the intertemporal MPCs. Let x = (Y1 , T ) and note that
the solution to the household problem can be expressed as functions c1i ( x ), c2i ( x ). Market
clearing in the consumption good market requires

                                        Y1 ( T ) =    i c1i (Y1, T )
                                                      i

totally differentiating the expression above we obtain

                                            c 1i      c       c 
                         dY1 =    i        Y1
                                                 dY1 + 1i dT + 1i i dT
                                                      T       i  T
                                  i

Letting MPCi, (t, j) be agent i's marginal propensity to consume in period t income earned
in period j, we can write
                                                             
                                                                1
                               c 1i                                 if i = H
                                    = MPCi (1, 1) = 1+ 
                              T                    1                if i = L

                                                          
                                                                1
                             c 1i                                       if i = H
                                  = MPCi (1, 2) = (1+ )(1+r)
                                                 0                      if i = L


                                                     A-3
and
                                            c 1i
                                                 = ei MPCi (1, 1)
                                           Y
Thus we can combine the expressions above to obtain

                                                              2
                    Y1
                          1 -  i ei MPCi (1, 1)          =     i MPCi (1, t)dIt,i
                    T          i                             t =1 i

where dIt,i is the direct income change induced by the fiscal policy to agent i in period t:
                                            
                                             1        if t = 1
                                            
                                   dIt,i   = - 1      if t = 2, i = H .
                                               H
                                            
                                            0         if t = 2, i = L
                                            


    Thus
                           Y1  2      MPCi (1, t)dIt,i     1 - H
                              = t =1 i i                 =                                (A.2)
                           T    (1 - i i ei MPCi (1, 1))    eH H
    Comparing (A.1) with (A.2) we have:

                           2t=1 i i MPCi,1t dIt,i   Y ( T )  H ( T )
                                                  =- 1
                           (1 - i i ei MPCi,11 )     H (T ) T

    Our approach has the advantage that it can be more easily implemented without the need
for natural experiments that are necessary for estimating intertemporal MPCs. However,
while we can measure  i from the data, without knowledge of the impulse response func-
tions (e.g.  H ( T )/ T ), we cannot study how imperfect risk-sharing affects the propagation
of specific structural shocks (eg. a fiscal policy shock).



B     Data
In this appendix we give more details about sample selection and variables definition. We
also present some summary statistics of the raw data and show that our sample both aggre-
gates reasonably and is consistent with recent work on consumption inequality.


B.1    Definition of variables and sample selection in the CEI

Consumption expenditures. Our measure of consumption expenditure is close to the NIPA
definition of nondurable and services expenditures. It is constructed by aggregating up the


                                                   A-4
following expenditure sub-categories: food, tobacco, domestic services, adult and child care,
utilities, transportation, pet expenses, apparel, education, work-related and training, health-
care, insurance, furniture rental and small textiles, housing related expenditures excluding
rent.

Total hours worked. We compute total hours worked for the head of household by multiply-
ing the number of weeks worked full or part time over the last year (INCWEEK1) multiplied
by the numbers of hours usually worked per week (INC_HRS1). We obtain the same indica-
tor for the spouse and add the two.

Labor income. We compute labor income as the sum of total household (CU) income from
earnings before taxes (FSALARYI), plus the total income received from farm (FFRMINCI)
and nonfarm business (FNONFRMI).

Liquid assets. It includes the total amount the households held in savings accounts in
financial institutions (SAVACCTI), checking and brokerage accounts (CKBKACTI). In the CEI,
these amounts are only reported in the last interview. Thus they represent end of period
values for the household. In order to define beginning of period values for these assets,
we use the following variables (COMPSAVI and COMPCKGI), which report the total change
in savings and checking accounts over the previous year, respectively. Then beginning of
period values are defined as end of period values minus the change in value.

Illiquid Assets. It includes the value of owned automobiles (NETPURI), residential housing
(PROPVALI), U.S. savings bonds (USBNDI), the value of all securities directly held by the
household (include stocks, mutual funds and non U.S. savings bonds) (SECESTI), and money
owned to the household by individuals outside of the household (MONYOWDI). The value
of U.S. savings bonds and total securities are only reported in household interview. In
order to define beginning of period values for these assets, we use the following variables
(COMPBNDI and COMPSECI), which report the total change in U.S. savings bonds and all
securities over the previous year, respectively. Then beginning of period values are defined
as end of period values minus the change in value.

Total assets. It is the value of liquid assets plus illiquid assets each household owns.

Liabilities. It is the current value of the household's home mortgage (QBLNCM3I) plus the
outstanding principal balance on auto debt. (QBALNM3I).

Net worth. Net Worth is total assets minus liabilities.


                                             A-5
  Taking 2006 as the year of reference, we have 5180 households that report full consumption
information in all four interviews. We next keep households whose head is in the age
bracket 22-64, leaving us with 3890 households that reported income and consumption in
2006. Within this group, we keep households that are considered "full income responders"
(3163), and drop any household that observed a change in family size between the first
and the last interview (2736). We then drop observations on consumption, labor income,
total hours, wage per hour, disposable income, liquid assets and net worth that fall below
the 1st percentile or above the 99th percentile of the distribution of these variables in each
year, leaving us with 2508 households for 2006. Finally, we are not able to run our Mincer
regressions for households that do not report information on their education, sex, marital
status, race or state of residence. This leaves us with 2328 households in 2006.


B.2    Summary statistics

Table A-1 reports selected households' characteristics for 2006. In the CEI, the average age
for the head of household was 44 years, and roughly 34% of the households' head held a
college degree. The average size of the household was 2.7. On average, households spent
roughly 10000 dollars per person in non-durables and services, and the average income per
person was 26000 dollars. Households worked 1300 hours per year per person on average,
earning an average wage of 19.80 dollars per hour. The mean net worth for the household
was 142000 dollars, with 14000 dollars in liquid assets. As a comparison with previous
papers, the average characteristics of the household in our sample are very close to those
reported in Heathcote and Perri (2018), see Table 1 in their paper.


B.3    Aggregation

In this section we examine whether the dynamics of aggregate consumption, income, and
total hours per capita in our cross sectional data capture the broad contours of national
income and product accounts (NIPA) aggregates. The results are shown in figure A-1. Each
graph is normalize to 1 in 2004.30
  The top left panel of figure A-1 shows the dynamics of average per capita expenditures
in the CEI and the equivalent measure in the NIPA. The top left panel shows average per
capita disposable income in the CEI and NIPA. The bottom panel shows average total hours
worker per capita in the CEI as well as its aggregate counterpart obtained from the BLS.
While the fit is not perfect, it is clear that both datasets capture the broad contour of each
  30 These   figures are constructed before any sample selection.




                                                      A-6
                            Table A-1: Average characteristics of households in 2006
                                                                       CEI
                               Age of head                            44.10
                               Household size                          2.71
                               Head with college (%)                  34.25
                               Consumption expenditures per person 10330.98
                               Labor income per person              26456.95
                               Disposable income per person         26492.00
                               Hours worked per person               1301.17
                               Wage per hour                          21.69
                               Household's net worth               142174.40
                               Liquid assets                        14296.21
Notes: The sample size is 2328 households. All statistics are computed using sample weights. All monetary variables
are expressed in 2000 U.S. dollars.


                            Figure A-1: Comparing aggregates across micro data sets

                                  Consumption                                            Income
               1.2




                                                                    1.2
               .9




                                                                    .9
               .6




                                                                    .6




                     1995      2000         2005   2010     2015          1995   2000         2005   2010     2015

                                      CEX            NIPA                               CEX            NIPA



                                       Hours
               1.1
               1
               .9




                     1995      2000         2005   2010     2015

                                      CEX            BLS


       Top panel compares the behavior of nominal consumption and disposable income per capita in the CEI
and NIPA. The bottom panel shows the behavior of total hours worker per capita in the two data sets (CEI and
BLS). Each graph is normalize to 1 in 2004 because the levels vary somewhat across data sets.


aggregate series during the Great Recession.31
   31 Our figure A-1 is very similar to the relevant panels in figure 13 of Heathcote and Perri (2018) giving us
further confidence.


                                                              A-7
                                     Figure A-2: Consumption Inequality in the CEI
                        .31
                        .28
          Var(log(C))
                        .25
                        .22




                              1980              1990               2000              2010



B.4   Trends in inequality

A large literature has documented that consumption inequality has increased in the U.S.
since 1980 (Blundell, Pistaferri, and Preston (2008); Krueger and Perri (2006); Aguiar and
Bils (2015); Attanasio and Pistaferri (2016)). Consistent with this literature, we find that
the variance on log consumption has increased significantly in the CEI. These results are
displayed in figure A-2. There is clear visual evidence that consumption volatility has in-
creased. Moreover, the levels of consumption inequality that we find are very similar to
previous work in the literature. In particular, we find that the variance of log consumption
has increased from 0.23 to 0.28 in the CEI over the period 1985 to 2005, which is almost the
exact same increase in both levels and changes that Heathcote, Perri, and Violante (2010) find
over the same time period (see figure 1 in the recent survey by Attanasio and Pistaferri (2016)
for more details). Overall, this suggests that our sample selection procedure is reasonable.


B.5    measurement robustness

Figure 1 shows the results of our baseline measurement of the (max)  it where we grouped
households according to whether their income at date t - 1 is above or below median income
and, within each of these two groups, weather the level of their net worth is above or below


                                                          A-8
         1.05
         1
         .95
                                   Figure A-3:  measurement robustness




                            baseline                    Income,Liquid Assets
                            Income,Assets               4 Income groups
         .9




                1995                2000                    2005                   2010                    2015

Notes: This figure shows an estimate of the max  it for four different partitions of the data: our baseline with two
income and two net worth groups (solid black line), two income and two liquid asset groups (red dashed line), two
income and two total asset groups (blue dotted line), and four income groups (green dash-dotted line), all over the
period 1996-2012.


the group median. Figure A-3 reports results when we use partition households using the
following different t - 1 state variables: two income and two liquid asset groups (red dashed
line), two income and two total asset groups (blue dotted line), and four income groups
(green dash-dotted line). Our baseline group is shown in the black dotted line. The main
takeaway from this exercise is that all four time-series look very similar with each showing
a similarly large increase during the Great Recession. This suggests that our results are
robustness to using other natural partitions of the CEI data.
   Figure A-4 shows a different robustness check on our measurement of  it . Here we
report results for a baseline partition where we group households according to whether
their income and net worth at date t - 1 in the bi-annual Panel Survey of Income Dynamics
(PSID) over the period 1999-2015. Concretely, at each t - 1, we end up with four different
groups of households of approximately equal size: low income/low net worth, low income/high
net worth, high income/low net worth and high income/high net worth. For each group i, we
use equation (27) to construct  it in the PSID. Comparing Figure A-4 with Figure 1, we see


                                                          A-9
                                        Figure A-4: Measured  in the PSID


                        low income/low net worth                            low income/high net worth
          1.05




                                                              1.05
          .95




                                                              .95
          .85




                                                              .85
                 2000        2005         2010         2015          2000        2005       2010         2015

                                    1            max                                    2          max



                        high income/low net worth                           high income/high net worth
          1.05




                                                              1.05
          .95




                                                              .95
          .85




                                                              .85




                 2000        2005         2010         2015          2000        2005       2010         2015

                                    3            max                                    4          max


Notes: Each panel shows an estimate of  it in the PSID for four groups of roughly equal size: low income/low
net worth, low income/high net worth, high income/low net worth and high income/high net worth (red dashed
line) along with the year-by-year value of the maximum across the four groups (solid black line) over the periods
1999-2015. Over this period the PSID is bi-annual.


there are many broad similarities. In particular, the high income groups have higher implicit
discount factors relative to low income households in most years (particularly so for the high
income/ high net worth group). That is, we find similar relative rankings of groups in both
the CEI and the PSID. This suggests that our measurement approach is capturing relevant
variation in the data and not just measurement error.



C      Numerical solution
Let the state vector be St = [it-1 , ^t , A
                                          ^ t ,  m,t , ^ t, ^ t ]. The equilibrium conditions of the model
can be summarized by the following equations




                                                         A-10
                                                               2
                                                    (St ) - 
                      Y (St )    = C (St ) +                                                                                  (A.3)
                                               2     1+
                                                       
                                           ^ t } 1+ 
                                      exp{ A
                                                     1+
                   Y pot (St )   =                                                                                            (A.4)
                                      exp{  ^ t }µ
                                                                                                                           
                                                                                                           y (1-i )
                                         
                                                           ¯)      1 +  (St )                 Y (St )                      
                  1 + i (St )    =   max (1 + it-1 )i (1 + i                                                          ,1      (A.5)
                                                                     1 +                     Y pot (St )                   
                                                                                             -
                                                        ^t+1 + ^ t +1 }       C ( S t +1 )           1
                            1    = [1 + i (St )] Et exp{                                                                      (A.6)
                                                                               C (St )           1 +  ( S t +1 )
       (St ) -   1 +  (St )              1               Y (St ) C (St ) exp{  ^ t}
                                 =             Y (St ) µ                            -1
        1 +        1 +                ( µ - 1)                       ^ t } 1+ 
                                                                exp{ A
                                                                              -
                                            ^t+1 + ^ t +1 }    C ( S t +1 )        ( S t +1 ) -   1 +  ( S t +1 )
                                 +   Et exp{                                                                      .           (A.7)
                                                                C (St )               1 +            1 + 



  Given policy functions for C (St ) and  (St ), we can use equations (A.3)-(A.5) to solve for
Y (St ) and i (St ). Thus, the numerical solution of the model can be equivalently expressed as
approximating C (St ) and  (St ).
  Due to the max operator in equation (A.5), C (St ) and  (St ) may have kinks in a region of
St where the zero lower bound constraint starts binding, a feature that makes it challenging
to approximate these functions with smooth polynomials. We approach this feature follow-
ing Gust et al. (2017). Specifically, we approximate these variables using a piece-wise smooth
function,

                                ~(St ) > 1)no
              x ( S t ) = 1(1 + i          x
                                              zlb                   ~(St )  1)zlb
                                                  T ( S t ) + 1(1 + i         x T ( S t ),                                    (A.8)

                      ~(St ) is the "notional" interest rate at St (the first term inside the max
where x = {C,  }, 1 + i
operator of equation (A.5)), T(St ) is a vector collecting Chebyshev's polynomials evaluated
at St and {no
           x
              zlb , zlb } a set of coefficients.
                    x

  The numerical solution of the model consists in choosing  = {no    x
                                                                       zlb , zlb }
                                                                             x     x =C, so that
                                                                        ~ i  S . The choice
equations (A.6) and (A.7) are satisfied for a set of collocation points S
of collocation points and the associated Chebyshev's polynomials follows the method of
Smolyak. Conditional expectations in equations (A.6) and (A.7) are evaluated using Gauss-
Hermite quadrature.
  The algorithm for the numerical solution of the model is as follows:

      Step 0.A: Defining the grid and the polynomials. Set upper and lower bounds on the
                      ~ = [i, 
      state variables S       ^, A
                                 ^ ,  m, ^, ^ ]. Given these bounds, construct a Smolyak grid and


                                                       A-11
      the associated Chebyshev's polynomials.

      Step 1: Equilibrium conditions at the candidate solution. Start with a guess for the
      model's policy functions c . For each S       ~ i , compute Cno zlb (S
                                                                           ~ i ), Czlb (S
                                                                                        ~ i ),  no zlb (S~ i)
                ~ i ) using the coefficients in c . Evaluate equation (A.3) using Cno zlb (S
      and  zlb (S                                                                                 ~ i ) and
       no zlb (S ~ i ) to obtain Y no zlb (S
                                           ~ i ), and similarly obtain a value for Y zlb (S       ~ i ). Use equation
      (A.4) and (A.5) along with Y no zlb (S        ~ i ) and  no zlb (S~ i ) to obtain the notional interest rate
      1+i ~(S~ i ). Compute the actual interest rate 1 + i (S          ~ i ) = max{1 + i  ~(S
                                                                                            ~ i ), 1}.

                                                    ~ i , compute the residual equations
      Step 3: Evaluate residual equations. For each S

                                                                                          -
                   ~ i ))          1                                        C (S )                1
              R1 ( S                      - E exp{ +  }
                                   ~(S
                                 1+i ~ i)                                          ~ i)
                                                                          Cno zlb (S          1 +  (S )
                                                                          -
                   ~ i ))  1 - E exp{ +  }                    C (S )              1
              R2 ( S                                                                    .
                                                                   ~ i)
                                                             Czlb (S          1 +  (S )

                             ~ i ) and R4 (S
      Similarly, compute R3 (S             ~ i ) using equation (A.7).

      Step 4: Iteration. Let R(c ) the vector collecting all the computed residuals at the
      collocation point, and let r be its Euclidean norm. If r  10-10 , stop the algorithm. If
      not, update the guess and repeat Step 1-4.

  The specifics for the algorithm are as follows. The bounds on [^, A
                                                                    ^ ,  m, ^, ^ ] are +/- 3
standard deviations from their mean. The bounds on i is set to [0, 0.20], wide enough to
span the ergodic distribution of nominal interest rates. We consider a second-order Smolyak
grid, and use 243 points for Gauss-Hermite quadrature (three points for each shock and
tensor multiplications). Finally, we use a Newton algorithm to find the zeros of R(c ) at the
collocation points.



D     Quantitative analysis
In this Appendix we present additional details regarding the quantitative experiments of
Section 4. We start with the estimation of the model and a discussion of model fit. We then
present some details of the counterfactual of Section 4.4.


D.1    Model estimation

We estimate a first-order approximation of the New Keynesian model, ignoring the presence
of the zero lower bound constraint on nominal interest rates. This has two advantages.

                                                      A-12
                               Table A-2: Sample statistics: model vs. data

                                            Data    Model (linear) Model (non-linear)
                        Mean(t )            2.69        2.00             1.87
                        Mean(it )           3.87        3.00             3.57
                        Stdev(Yt )          4.15        3.42             5.85
                        Stdev(t )           1.23        1.59             1.50
                        Stdev(it )          3.02        2.68             3.16
                        Corr(Yt , Yt-1 )    0.93        0.85             0.81
                        Corr(it , it-1 )    0.90        0.72             0.42
                        Corr(t , t-1 )      0.51        0.14             0.17
                        Corr(Yt , it )      0.11       -0.08             0.04
                        Corr(Yt , t )       0.14        0.12             0.14
                        Corr(it , t )       0.71        0.52             0.68
Notes: Model statistics are computed on a long simulation (T = 100, 000) from the model solved using a first-order
approximation ("Model (linear)") and global methods ("Model (non-linear)"). Data statistics are computed over the
1984-2017 period.


First, the solution of the model is fast and numerically more stable than the global solution
described in Appendix C. Second, the likelihood function can be evaluated with the Kalman
filter. These two features make the estimation sensibly more tractable than the alternative of
estimating the model with non-linear methods.
   Draws from the posterior distribution of the model parameters are generated using the
random walk Metropolis Hastings described in An and Schorfheide (2007). The proposal
distribution is a multivariate normal, with variance-covariance matrix given by c, where 
is the negative of the inverse hessian of the log-posterior evaluated at the posterior mode
and c is a constant that we set to obtain roughly a 30% acceptance rate in Markov chain.
We generate 2 Markov chains of 200,000 each, and discard the first 100,000 draws in each
chain. The statistics of the posterior distribution of model parameters reported in Table 1 are
computed by combining the last 100,000 draws for each chain.
   The purpose of the estimation step is to have a parametrized model that fits US data
reasonably well in the sample, an important pre-condition for carrying out the proposed
counterfactuals. Table A-2 reports a set of summary statistics for output, inflation and nomi-
nal interest rates in the data, in the first-order approximation of the model ("Model (linear)")
and in the model solved using the global method described in C.
   We can verify that the estimated model replicates key features of US data. We can also
see that the model solved with non-linear methods implies statistics that are close to both
US data and those derived in the first-order approximation of the model.



                                                        A-13
D.2    Counterfactuals

We now detail the counterfactual experiment of Section 4. We first explain how we use
the particle filter to obtain an estimate of the structural shocks. Next, we discuss how we
generate the decomposition of Figure 7.
  The equivalent representative-agent economy has the state space representation

                                              Y t = g ( S t ) + t
                                              S t = f ( S t -1 ,  t ).

The first set of equations describe the evolution of the observables Yt , with t being a vector
of iid Gaussian errors with a diagonal variance-covariance matrix equal to H. The second
equation describes the evolution of the state variables St . The vector  t collects the innova-
tions to the structural shocks ^t , A
                                    ^ t , and  m,t and the preference "shocks"  ^ t and ^ t . The
functions g(.) and f (.) are generated using the numerical algorithm described previously
and they depend implicitly on the structural parameters of the model. For these experi-
ments, we set the estimated parameters at their posterior mean reported in Table 1
  Let Yt = [Y1 , . . . , Yt ], and denote by p(St |Yt ) the conditional distribution of the state
vector given observations up to period t. Although the conditional density of Yt given St is
known and Gaussian, there is no analytical expression for the density p(St |Yt ). We use the
particle filter to approximate this density for each t. The approximation is done via a set of
pairs {Si   ~i
         t, w
                 N
              t }i =1 , in the sense that

                                        N
                                   1
                                        f (Sit )w
                                                          a.s.
                                                ~it        E[ f ( S t ) | Y t ].
                                   N   i =1


We refer to Si                      ~i
             t as a particle and to w t as its weight. The algorithm used to approximate
{ p(St |Yt )}t builds on Kitagawa (1996), and it goes as follows:

                                                      i,w
      Step 0: Initialization. Set t = 1. Initialize {S0 ~0i } N and set w
                                                                        ~0i = 1 i.
                                                             i =1

      Step 1: Prediction. For each i = 1, . . . , N , obtain a realization for the state vector Si
                                                                                                 t | t -1
      given Si
             t-1 by simulating the model forward.

      Step 2: Filtering. Assign to each particle Si
                                                  t | t -1
                                                           the weight

                                              wi               i
                                                                          ~i
                                               t = p ( Y t | S t | t -1 ) w t -1 .


      Step 3: Resampling. Rescale the weights {wi t } so that they add up to one, and denote
                                ~i
      these rescaled values by {w t }. Sample N values for the state vector with replacement


                                                       A-14
      from {Si
             t | t -1
                       ~i
                      ,w    N                                   i          ~i
                         t }i =1 , and denote these draws by { St }i . Set w t = 1 i. If t < T , set
      t = t + 1 and go to Step 1. If not, stop.

   In our exercise, the measurement equation includes nominal interest rates, linearly de-
trended real GDP, inflation, ^ t and ^ t . The variance on the measurement errors on the first
three variables is set to 1% of their unconditional variance, while we set the variance of the
measurement errors on     ^ t and ^ t to 10% of the unconditional variance of these series. We set
N to 5,000,000. Figure 6 reports the (mean) Yt and St obtained when applying the particle
filter to the model over our sample. That is, for each variable yt = gy (St ) in the observation
equations, we compute
                                                        N
                                            ymodel
                                             t     =    gy (Sit )w
                                                                 ~it.
                                                       i =1

We repeat this for every variable in the state equations, using the policy functions f(.).
    In order to generate the counterfactual of Figure 7, we first solve the model without the ^t
shock, obtaining the policy function gno  (.) and fno  (.). We then compute the counterfactual
value of a variable yt as
                                                            N
                                                            gy
                                                                  no 
                                       ycounterfactual
                                        t              =                (Sit )w
                                                                              ~it,
                                                           i =1

where Si     ^i ^ i i           i × (
                               ^t     cm / 
                                     ^t    ^ t )].
       t = [  t , A t ,  m,t , 



D.3     Sensitivity to the measurement errors

In this section we study the sensitivity of our results to the measurement errors we added
on Tt . In our benchmark, we set the variance of these measurement errors to be equal to
10% of the unconditional variance on ^ t and ^ t . We now re-estimate the model and perform
the counterfactual by doubling the variance on these measurement errors.
    Table A-3 reports prior and posterior distribution of the model parameters in this scenario.
By and large, the posterior distribution is very similar to that reported in our benchmark,
with the exception that the credible sets on the parameters of the preference shocks are now
larger. In Figure A-5 we report the main counterfactual of the paper in this specification. We
can again see that the results are fairly similar to those reported in the main text.



E     The model with capital
In this section, we describe in more detail the model with capital in Section 4.5.



                                                     A-15
Table A-3: Prior and posterior distribution of model parameters: larger measurement errors

                                          Prior                      Posterior
                    Parameter Distribution Mean       St. dev. Mean 90% Interval
                    4×        Gamma         85.00      15.00   73.53 [53.10, 93.57]
                    i         Beta           0.50       0.25    0.57    [0.34, 0.81]
                              Normal         1.50       2.00    3.67    [1.90, 5.38]
                    y         Normal         1.00       2.00    0.23    [0.00, 0.53]
                              Beta           0.50       0.28    0.69    [0.49, 0.90]
                    A         Beta           0.50       0.28    0.92    [0.84, 0.99]
                     ,        Beta           0.50       0.25    0.39    [0.09, 0.69]
                      ,       Beta           0.50       0.25    0.85    [0.72, 0.99]
                    100 ×     InvGamma       1.00       5.00    2.46    [0.94, 3.99]
                    100 × A   InvGamma       1.00       5.00    2.01    [1.30, 2.68]
                    100 × m   InvGamma       1.00       5.00    1.95    [1.15, 2.72]
                    100 ×     InvGamma       1.00       5.00    1.85    [0.97, 2.69]
                    100 ×     InvGamma       1.00       5.00    2.09    [1.16, 3.03]
Notes: See the notes to Table 1.


                     Figure A-5: Counterfactual with larger measurement errors


   0                                 6                                1

                                                                     0.5
                                     5
  -2
                                                                      0

                                     4                              -0.5
  -4
                                                                      -1
                                     3
                                                                    -1.5
  -6
                                     2                                -2

                                                                    -2.5
  -8
                                     1
                                                                      -3

-10                                  0                              -3.5
  2007 2008 2009 2010 2011           2007 2008 2009 2010 2011         2007 2008 2009 2010 2011

Notes: See the notes to Figure 7.


   Capital is accumulated by a financial intermediary that rents it out to monopolistic com-


                                               A-16
petitive firms. We assume that the financial intermediary discounts the future dividends
using the real state price Q(zt ). The problem for the representative intermediary is

                            ( K ( z t -1 ), z t ) =                    max
                                                              K ( z t ), I ( z t ),d ( z t )
                                                                                                                    Q(z j )d(zt )                                 (A.9)
                                                                                               t     zt   zj   zt


subject to its budget constraint,

                                                                                           2
                                                            I (zt )
                          t
                      d(z ) + I (z ) +    t
                                                                        -                      K ( z t -1 )  r ( z t ) K ( z t -1 ),
                                       2                   K ( z t -1 )

and the law of motion of capital,

                                               K ( z t )  (1 -  ) K ( z t -1 ) + I ( z t ),                                                                      (A.10)

and r zt = R zt / P zt is the real rental rate of capital.
   The optimality conditions are


                      q zt           =     Q              z t +1         r ( z t +1 ) + q z t +1 (1 -  ) -
                                           z t +1
                                                                               2
                                                    I ( z t +1 )                                   I ( z t +1 )                  I ( z t +1 )
                                                                 -                 +                            -                             ,                  (A.11)
                                           2         K (zt )                                        K (zt )                       K (zt )

where the price of capital q(zt ) ­ the normalized multiplier on (A.10) ­ is

                                                                                     I (zt )
                                                    q zt = 1 +                                   -                                                               (A.12)
                                                                                    K ( z t -1 )

   A monopolistic competitive firm produces the intermediate input using the technology
                                                    1- 
y i z t = A ( z t ) k i z t -1          ni z t            . The problem for a monopolistic competitive firm can
be split in two subproblems. First, the firm chooses the optimal input mix to minimize its
marginal cost:
                                                                             W zt        R zt
                                              mc zt = min                            n +         k
                                                                    k ,n     P (zt )     P (zt )
subject to
                                                             A ( z t ) k  n 1-   1

Second, given the optimal factor allocation, the firm chooses its price to solve:
                                                                                                               2
                                      pj yj                       pj
        V Pj , zt    = max
                          p j ,y j        t
                                     P (z )
                                            - mc(zt )y j -
                                                           2 Pj (1 + ¯)
                                                                        -1                                          +    Q ( z t +1 | z t ) V     p j , z t +1   (A.13)
                                                                                                                        z t +1



                                                                           A-17
subject to the demand function (9).
      The solution to the firm's problem together with symmetry across firms requires that the
following version of the New Keynesian Phillips curve holds in equilibrium

                                          1
                       ~ zt =
                                                Y (zt ) µmc(zt ) - 1 +  Q(zt+1 |zt )~ z t +1                                                      (A.14)
                                       ( µ - 1)                        z t +1

and the marginal cost is given by

                                                                                                   1- 
                                                                    r zt            w zt                     1
                                                  mc(zt ) =                                                                                       (A.15)
                                                                        (1 -  )1-                          A (zt )

      The problem for the household is unchanged and so it the monetary policy rule. Market
clearing in assets markets now must account for the stock of capital. Specifically, equilibrium
in financial markets requires that the value of inherited assets must equal the nominal value
of the monopolistic competitive and capital firms cum-dividend and ,

  i  Pri              vt |zt         Rk (st-1 , st ) ak,i st-1 = P(zt )[V ( P(zt-1 ), zt ) + (K (zt-1 ), zt )], (A.16)
  i       vt                   kK

and the total value of new asset positions must equal to the nominal value of the two firms
ex-dividend,

       i  Pri         vt |zt    q k ( s t ) a k ,i   st = P(zt )  Q(zt+1 |zt )[V ( P(zt ), zt+1 ) + (K (zt ), zt+1 )].                            (A.17)
      i    vt                  k K                                      z t +1




      We then have the analog of Proposition 1:

Proposition 2. Given  i vt , zt+1 ,  zt                                     defined in (19) and (20) and the initial capital stock,
the equilibrium aggregate consumption, investment, capital, gross output, inflation, price of capital,
and nominal interest rate, C (zt ), I (zt ), K (zt ), Y (zt ),  (zt ), q(zt ), i (st ) must satisfy the aggregate
Euler equation (21), the Euler equation for capital

                                                                                     Y (zt )
                               q z t =  z t +1 Q z t +1                                            + q z t +1 (1 -  )                             (A.18)
                                                                                    K ( z t -1 )
                                                                                 2
                                                         I ( z t +1 )                              I ( z t +1 )       I ( z t +1 )
                                                  -2      K (zt )
                                                                        -            +              K (zt )
                                                                                                                  -    K (zt )


and (A.12), the Phillips curve (A.14) the Taylor rule (14), the resource constraint

                                                                                      2                                       2
                                            (zt ) - ¯                                          I (zt )
                  t              t
               Y (z ) = C (z ) + I (z ) +     t
                                                                                          +                -                      K ( z t -1 ),   (A.19)
                                          2 1+    ¯                                         2 K ( z t -1 )

                                                                           A-18
and the law of motion for the capital stock (A.10), where the real state prices is given by (24), and the
marginal cost is

                                                                         / (1-  )
                                           -          Y (zt )                                 1- 
                                      zt                                            C zt
                    Y    zt                       A(zt )K (   z t -1
                                                                  )                                   1
     mc zt =                                                                                                  (A.20)
                   K ( z t -1 )                        (1 -  )        1-                            A (zt )


   The critical assumption for the equivalent representation for the model with capital is that
the firm that does the capital accumulation process uses the aggregate state price (24) to dis-
count dividends in (A.9). This assumption mirrors the one for the monopolistic competitive
firms in (12).32 Our implicit assumption is that firms value dividends in a given state zt
using the valuation of the agent with the highest valuation. This choice is not innocuous but
in any model with incomplete markets a there is a degree of freedom in choosing the firms'
discount factor. With richer data that would allow us to identify the households that actively
trade shares in the firms, we could measure the wedge between the aggregate state price in
(24) and the stochastic discount factor of the marginal agent pricing capital.




  32 Thisassumption allows us to consolidate the two problems and consider one firm that produces the
intermediate good and makes investment decisions.


                                                   A-19
