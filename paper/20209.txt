                              NBER WORKING PAPER SERIES




                                 MISSPECIFIED RECOVERY

                                        -DURVODY%RURYLþND
                                          Lars P. Hansen
                                       José A. Scheinkman

                                       Working Paper 20209
                               http://www.nber.org/papers/w20209


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     June 2014




We thank Fernando Alvarez, Anmol Bhandari, Kyle Jurado and Stavros Panageas for useful comments.
The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2014 by -DURVODY%RURYLþND, Lars P. Hansen, and José A. Scheinkman. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.
Misspecified Recovery
-DURVODY%RURYLþND, Lars P. Hansen, and José A. Scheinkman
NBER Working Paper No. 20209
June 2014
JEL No. D84,G0,G12

                                              ABSTRACT

Asset prices contain information about the probability distribution of future states and the stochastic
discounting of these states. Without additional assumptions, probabilities and stochastic discounting
cannot be separately identified. Ross (2013) introduced a set of assumptions that restrict the dynamics
of the stochastic discount factor in a way that allows for the recovery of the underlying probabilities.
We use decomposition results for stochastic discount factors from Hansen and Scheinkman (2009)
to explain when this procedure leads to misspecified recovery. We also argue that the empirical evidence
on asset prices indicates that the recovered measure would differ substantially from the actual probability
distribution and that interpreting this measure as the true probability distribution may severely bias
our inference about risk premia, investors’ aversion to risk, and the welfare cost of economic fluctuations.


-DURVODY%RURYLþND                                   José A. Scheinkman
New York University                                  Department of Economics
Department of Economics                              Columbia University
19 W. 4th Street, 6th floor                          New York, NY, 10027
New York, NY 10012                                   and NBER
jaroslav.borovicka@nyu.edu                           joses@princeton.edu

Lars P. Hansen
Department of Economics
The University of Chicago
1126 East 59th Street
Chicago, IL 60637
and NBER
lhansen@uchicago.edu
1     Introduction
It has been known, at least since the path-breaking work of Arrow, that asset prices reflect
a combination of stochastic discounting and probability distributions. In a Markovian envi-
ronment, prices of assets that pay a single dividend next period reflect both how consumers
discount payoffs in the different states and the transition probabilities from the current state.
Data on asset prices alone are not sufficient to identify non-parametrically the stochastic
discount factor and transition probabilities without imposing additional restrictions. For
instance, one may use additional time series evidence on the evolution of the Markov state
which gives a separate way to identify the transition probabilities. The state-specific discount
factors can then be inferred from asset prices.
    Hansen and Scheinkman (2009) showed that if the transition probabilities satisfy an
ergodicity property, one may use Perron–Frobenius theory to identify a distorted probabil-
ity measure that reflects the long-term implications for risk pricing. They point out that
this measure is typically distinct from the physical probability measure. In contrast, Ross
(2013) uses Perron–Frobenius theory to claim a recovery result — a full identification of the
transition probabilities from asset prices.
   In this paper we connect the two results to make clear the special assumptions that
are needed to guarantee that the distorted transition probabilities recovered using Perron–
Frobenius theory equal the actual transition probabilities. In the general case, the ratio of
the distorted to the true probability measure will be manifested as a non-trivial martingale
component in the stochastic discount factor. Several of the structural models of asset pricing
used in macroeconomics imply a non-trivial martingale component and existing empirical
evidence suggests that this martingale component is quantitatively important.
   We start in Section 2 by illustrating the problem of identifying the correct probability
measure in a discrete-state space environment. In continuous-state spaces, additional tech-
nical challenges arise that may lead to multiple solutions of the Perron–Frobenius problem.
The potential for multiplicity leads us in Section 3 to introduce a stochastic stability con-
dition. As we show in Section 4, stochastic stability uniquely picks a particular candidate
solution. We demonstrate in Section 5 that a Perron–Frobenius approach leads naturally
to the construction of a martingale component to the stochastic discount factor process, a
component that must be identically equal to one for Ross (2013)’s analysis to apply. We also
show that this martingale component is not degenerate in several well known models of asset
pricing models. In Section 6, we unify and extend results from a literature that bounds the
magnitude of the martingale component that can be recovered from the asset pricing data.
Section 7 concludes.


                                               1


                 Electronic copy available at: http://ssrn.com/abstract=2441376
2       Illustrating the identification challenge
Hansen and Scheinkman (2014) gave a counting argument that illustrates the identification
challenge that is present even in the simple setting of a finite state Markov chain. We review
and expand on that discussion in what follows.
   Let X be a discrete time, n-state Markov chain with transition matrix P =  ˙ [pij ]. We may
identify state i with a coordinate vector ui with a single one in the i-th entry. Suppose the
analyst can infer the prices of one-period Arrow claims. We represent this input as a matrix
Q = [qij ] that maps a unit payoff tomorrow specified as a function of tomorrow’s state into
a price today. Since there are only a finite number of states, the payoff and price can both
be represented as vectors. In particular, qij is the price in state Xt = ui of a security that
pays one unit of consumption in state Xt+1 = uj .
   Notice that Q has n × n entries. P has n × (n − 1) entries because row sums have to
add up to one. The realized one-period stochastic discount factors are entries of a matrix
S=˙ [sij ] where sij discounts one unit of consumption in state uj tomorrow given that the
current state is ui . The discounting is state-dependent to adjust valuation to uncertainty
in the next-period payout. Risk adjustments are encoded by this state dependence because
each future state may be discounted differently. In general the stochastic discount factor
introduces n × n free parameters sij , i, j = 1, . . . , n. The Arrow prices are the products:1

                                             qij = sij pij .                                        (1)

   Additional data is needed to non-parametrically identify P = [pij ] and S = [sij ] from
asset prices Q = [qij ] without imposing additional restrictions. For instance, one may use
time series evidence on the evolution of the Markov state to infer the transition probabilities.
This gives a separate way to identify P, and then the state-specific discount factors S can
be inferred from the Arrow prices.
   What follows are two ways to construct probabilities from the Arrow prices without
appealing to time series data to identify the probabilities.
    1
    The simple counting requires some qualification when Q has zeros. For instance, when qij = 0, then
pij = 0 in order to prevent arbitrage opportunities. In this case the numerical value assigned to sij is
inconsequential.




                                                   2
2.1    Risk-neutral probabilities
The financial engineering literature extensively uses the concept of risk-neutral probabilities,
which are constructed as:
                                                       qij
                                              p∗ij =
                                                       q̄i
              Pn
where q̄i =    j   qij is the price of a one-period discount bond in state i. In order to satisfy
equation (1), we may define
                                              s∗ij = q̄i .

The risk-neutral probabilities p∗ij can always be constructed and used in conjunction with
discount factors [s∗ij ]. The discount factors are independent of state j, reflecting the absence
of risk adjustments conditioned on the current state. In contrast, one-period discount bond
prices can still be state-dependent. While [p∗ij ] is a probability matrix, there is no claim
that it represents actual transition probabilities, or that [s∗ij ] represents actual valuation of
consumption in states tomorrow by an investor.


2.2    Long-term pricing
We follow Backus et al. (1989) in studying long-term pricing of cash flows associated with
fixed income securities using Perron–Frobenius theory. When there exists a λ > 0 such that
            P
the matrix ∞       t t
              t=0 λ Q has all entries that are strictly positive, the largest eigenvalue exp(η)
of Q is unique and positive and the associated eigenvector e has strictly positive entries. We
denote the ith entry of e as ei . Typically, η < 0 to reflect time discounting of future payoffs.
   Recall that we may evaluate t-period claims by applying the matrix Q for t times in
succession. From the Perron–Frobenius theory for positive matrices:

                                   lim exp(−ηt)Qt f = (f · e∗ )e
                                   t→∞


where e∗ is the corresponding positive row eigenvector of Q and e∗ · e is normalized to be one.
The positive eigenvector e thus provides state-dependent valuations for payoffs maturing in
the distant future. The price in current state ui of an arbitrary payoff f maturing in t → ∞
periods is, up to a proportionality constant, equal to ei , and the average rate of discount of
this long-horizon cash flow is −η.
    The eigenvector e and the associated eigenvalue also provide a way to construct a prob-
ability transition matrix given Q. Form

                                                             ej
                                         peij = exp(−η)qij                                    (2)
                                                             ei


                                                   3
Notice that                  n                       n
                             X                   1X
                                  peij = exp(−η)        qij ej = 1.
                              j=1
                                                 ei j=1

     e = [e
Thus P    pij ] is a transition matrix. Moreover,

                                                     ei
                                      qij = exp(η)      peij .
                                                     ej

   Hansen and Scheinkman (2009) and Ross (2013) both use this approach to construct a
probability distribution, but they interpret it differently. Hansen and Scheinkman (2009)
study multi-period pricing by compounding stochastic discount factors. They use the prob-
ability ratios for peij given by (2) and consider the following decomposition:
                                                          
                                    ei peij                 ei
                       qij = exp(η)           pij = exp(η)     hij pij .
                                    ej pij                  ej
Hence,                                                     
                                                       ei
                                    sij = exp(η)                hij                       (3)
                                                       ej
where H = [hij ] and
                                         hij = peij /pij

provided that pij > 0. When pij = 0 the construction of hij is inconsequential.
    Hansen and Scheinkman (2009) interpret the three components of the one-period stochas-
tic discount factor displayed on the right-hand side of (3) and show how this representation
can be used to study long-term valuation. The third term, which is a ratio of probabilities,
is used as a change of probability measure in their analysis. In contrast, Ross (2013) uses
(2) to identify the transition probability used by investors by presuming that hij = 1 for all
                                                              e coincide. In the next sections
(i, j), which implies that the transition probabilities P and P
we address these issues under much more generality by allowing for continuous-state Markov
processes. As we will see, some additional complications emerge.
   To anticipate the counterpart to (3) for a more general probability model, consider the
stochastic discount factor process S = {St : t = 0, 1, 2, ...} that is obtained by compounding
the one-period stochastic discount factor. In general, St depends on the history of the state
from 0 to t since the increment between t and t + 1 is given by:

                                      St+1
                                           = Xt ′ SXt+1 .
                                       St




                                               4
Similarly, we define
                                     Ht+1
                                          = Xt ′ HXt+1 .
                                      Ht
Then                                                       
                             St+1            Ht+1     e · Xt
                                  = exp(η)
                              St              Ht     e · Xt+1
Compounding the three components in decomposition (3), we obtain:
                                                                    
                                                    Ht        e · X0
                                 St = exp(ηt)                                             (4)
                                                    H0        e · Xt

where we initialize S0 = 1 and
                                         Y  t
                                    Ht
                                       =    Xτ −1 ′ HXτ .
                                    H0 τ =1

Because hij is obtained as a ratio of probabilities, H is a positive martingale under P
for any positive specification of H0 as a function of X0 . Thus from (4), the eigenvalue
η contributes an exponential function of t and the eigenvector contributes a function of
the Markov state to the stochastic discount factor process. In addition there is martingale
component, whose logarithm has stationary increments. The assumption of Ross (2013) thus
amounts to requiring that Ht /H0 ≡ 1 or equivalently that S has no martingale component.


3      Setup
We start with a set of indices T (either the non-negative integers or the non-negative reals)
and X = {Xt }t∈T a stationary Markov process on a probability space {Ω, F , P }. Write
F=
 ˙ {Ft }t∈T for the (completed) filtration generated by the histories Xu , u ≤ t.


3.1    Constructing other processes
We use X to build other processes. Consider a process M specified in discrete time by

                              log Mt+1 − log Mt = g(Xt+1 , Xt )                           (5)

where log M0 = 0. When X is a continuous time diffusion in a space with a Brownian motion
W , suppose that
                             d log Mt = β(Xt )dt + α(Xt ) · dWt ,                         (6)

again with log M0 = 0. In particular, the log M process has stationary increments in both
cases.

                                                5
    These two specifications are sufficiently general for us to discuss identification and recov-
ery. The resulting constructions of M give rise to special cases of what are called positive
multiplicative functionals.2 In this paper a positive process is one that is strictly greater
than zero almost surely for all t in T .

Definition 3.1. A multiplicative functional is a process M that is adapted to F, M0 = 1,
and
                                     Mt (X) = Mτ (X)Mt−τ (θτ (X)),                                           (7)

where θτ is the shift operator that moves the time subscript of X by τ , that is,

                                              (θτ (X))s = Xτ +s .

       We will analyze alternative measures equivalent to P that we build using strictly positive
martingales. Given an F-martingale H that is strictly positive and has unit expectation for
all t, we may define a probability P H such that if A ∈ Fτ for some τ ≥ 0,

                                             P H (A) = E(1A Hτ ).                                            (8)

       The Law of Iterated Expectations guarantees that these definitions are consistent, that
is, if A ∈ Fτ and t > τ then

                                     P H (A) = E(1A Ht ) = E(1A Hτ ).


3.2       Stochastic stability
For general state spaces, our analysis requires that stability restrictions are imposed when
we change probability measures. We first specify our most general condition, and then we
construct two more easily interpretable sufficient conditions.

Condition 3.2. The process X is stochastically stable in averages under a probability
distribution P H if for any bounded (Borel measurable) function f ,
                                       "      N
                                                                #
                                           1 X
                             lim E H             f (Xt ) |X0 = x = E H f (X0 ).
                            N →∞           N t=1
   2
    There are two extensions of this setup that are also of substantive interest. In Hansen and Scheinkman
(2014), we have extended this analysis to allow for a richer specification of uncertainty by introducing explicit
additional shocks that do not directly influence the state dynamics, but at the same time have an impact
on valuation. Also, while the Brownian information specification (6) abstracts from jumps, these can be
included without changing the implications of the analysis, see Hansen and Scheinkman (2009).


                                                       6
when T is the set of nonnegative integers (discrete time), or, when T is the set of nonnegative
real numbers (continuous time),
                                                Z       N                    
                                     H       1
                        lim E                                f (Xt ) dt|X0 = x = E H f (X0 )
                        N →∞                 N       0


pointwise in x for almost all x.

   Condition 3.2 allows for periodic components to the Markov process. When such com-
ponents are absent, a simpler but stronger version of Condition 3.2 is given by:

Condition 3.3. The process X is stochastically stable under a probability distribution
P H if for any bounded (Borel measurable) function f ,

                                 lim E H [f (Xt ) |X0 = x] = E H f (X0 ).
                                 t→∞


pointwise in x for almost all x.

This condition was imposed by Hansen and Scheinkman (2009) and Hansen (2012) to select
among Perron–Frobenius eigenfunctions.
  Another sufficient condition uses the Law of Large Numbers (LLN) for Markov processes
conditioned on an initial state X0 = x. This version also allows for periodic components.

Condition 3.4. The process X obeys the LLN under a probability distribution P H if for
any bounded (Borel measurable) function f ,
                                     "      N
                                                                            #
                                         1 X
                       lim E H                 f (Xt ) − E H f (X0 ) |X0 = x = 0
                      N →∞               N t=1

when T is the set of nonnegative integers (discrete time), or, when T is the set of nonnegative
real numbers (continuous time),
                                        Z       N                                   
                             H       1                                 H
                     lim E                           f (Xt ) dt − E [f (X0 )] |X0 = x = 0
                    N →∞             N       0


pointwise in x for almost all x.

   To see that Condition 3.2 is implied by Condition 3.4, notice that
       "      N
                                              #      "    N
                                                                            #
           1 X                                         1 X
  EH             f (Xt ) − E H f (X0 ) |X0 = x ≥ E H         f (Xt ) |X0 = x − E H f (X0 )
           N t=1                                       N t=1


                                                                  7
If the left-hand side converges to zero, then so does the right-hand side. An entirely similar
argument applies for the continuous-time case.
    Since we condition on X0 in our statement of Conditions 3.2 and 3.3, the conditional
change of measure is represented by H/H0 :
                  "      N
                                           #    "      N
                                                                           #
                      1 X                          HN 1 X
             EH             f (Xt ) |X0 = x = E             f (Xt ) |X0 = x .
                      N t=1                        H0 N t=1

The random variable H0 that initializes H defines the limit points for the LLN and makes X
stationary under the probability P H implied by H. The random variable H0 = h(X0 ) must
satisfy the equation:
                                                         
                                           Ht
                           E f (Xt )                h(X0 ) = E [f (X0 )h(X0 )] .
                                           H0

for any bounded (Borel measurable) f .
    We have purposely stated these conditions for a probability measure P H associated with
H. We suppose that the stability Condition 3.2 is satisfied for the probability P . As
we change probability measures, stochastic stability will not necessarily be satisfied, but
checking for this stability under the probability P H will be used in our analysis.


4    Stochastic discount factor, probability measure and
     recovery
A stochastic discount factor process S is a positive multiplicative functional with finite first
moments (conditioned on X0 = x) such that the date zero price of any claim ψ(Xt ) payable
at t is
                           [Qt ψ] (x) =
                                      ˙ E[St ψ(Xt )|X0 = x].                          (9)

The multiplicative property of S allows us to price consistently at intermediate dates. In
discrete time we may build the t-period operator Qt by applying the one-period operator Q1
t times in succession. In continuous time, {Qt : t ∈ T } forms what is called a semigroup
of operators. The counterpart to a one-period operator is a generator of this semigroup
that governs instantaneous valuation and which acts as a time derivative of Qt at t = 0.
Thus in discrete time it suffices to study the one-period operator and in continuous time the
generator of the family of operators {Qt : t ∈ T }.
   We are typically interested in pricing a richer collection of cash flows including ones that


                                                        8
display stochastic growth and ones that are history-dependent. Given a probability measure
P , the pricing operator in (9) applied to all (bounded, measurable) functions ψ (x) for every
t ≥ 0 is sufficient to determine the stochastic discount factor process S, which can be used
to assign prices to these other cash flows.
    Notice that equation (9) involves simultaneously the probability P on F-measurable sets
and the process S. In other words, a stochastic discount factor process is only well-defined
for a given probability measure.

Definition 4.1. The pair (S, P ) explains asset prices if equation (9) gives the date zero price
of any claim ψ(Xt ) payable at any time t ∈ T .

        Consider now a strictly positive martingale H and the associated probability measure
    H
P       defined through (8). We define:

                                                    H0
                                           SH = S      .
                                                    H

The following proposition is immediate:
                                                                                  H
Proposition 4.2. Suppose that E (H0 ) = 1, H is a positive martingale, and        H0
                                                                                       is a mul-
tiplicative functional. If the pair (S, P ) explains asset prices then the pair (S , P H ) also
                                                                                   H

explains asset prices.

    This proposition captures the notion that stochastic discount factors are only well-defined
for a given probability distribution. When we change the probability distribution, we must
also change the stochastic discount factor in order to represent the same asset prices. An
analogous observation carries over to so-called risk prices that are assigned by the stochastic
discount factor to alternative risk exposures. In other words we have multiple ways to
represent Q:
                                                                            
                     [Qt ψ](x) = E [St ψ(Xt )|X0 = x] = E H StH ψ(Xt )|X0 = x              (10)

where E H is the expectation operator associated with P H .
    So far we have imposed one probability measure P and shown what happens when we
consider other probability measures. Suppose, however, that this probability distribution
is not known to an external analyst. Given that H can be any positive multiplicative
martingale, we are left with a fundamental identification problem. From the Arrow prices
alone we cannot distinguish (S, P ) from (S H , P H ). In particular, we cannot recover P from
the Arrow prices alone. To achieve identification, either we have to restrict the stochastic
discount factor process S or we have to restrict the probability distribution used to represent
the valuation operators Q.

                                                9
    There are multiple ways we might address this lack of identification. First, we might
impose rational expectations, observe time series data, and let the Law of Large Numbers
for stationary distributions determine the probabilities. Then observations for a complete
set of Arrow securities allows us to identify S. See Hansen and Richard (1987) for an initial
discussion of the stochastic discount factors and the Law of Large Numbers, and see Hansen
and Singleton (1982) for an econometric approach that imposes a parametric structure on
the stochastic discount factor and avoids assuming that the analyst has access to data on
the complete set of Arrow securities.
   Second, as in Ross (2013), we may impose a special structure on S by assuming:

Assumption 4.3. Let
                                                      m(Xt )
                                      St = exp(−δt)
                                                      m(X0 )
for some positive function m and some real number δ.

   The pair (S H , P H ) that explains asset prices and satisfies Assumption 4.3 is unique
provided that stochastic stability is preserved under the measure P H . Formally,

Proposition 4.4. Suppose (S, P ) explain asset prices and S satisfies Assumption 4.3. Let
H
H0
   be a positive multiplicative martingale such that (S H , P H ) also explain asset prices and
X is stochastically stable in averages (satisfies Condition 3.2) under P H . If S H also satisfies
Assumption 4.3, then H ≡ 1.

The proof of this theorem is similar to the proof of a related uniqueness result in Hansen
and Scheinkman (2009) and is detailed in Appendix A.
   Remarkably, Proposition 4.4 gives an identification result, which is a counterpart of the
recovery result in Ross (2013). Under the conditions of this proposition, we may infer both
the stochastic discount factor and a probability distribution associated with that stochastic
discount factor from the pricing operator Qt . In the next section we relax Assumption 4.3,
and we ask “what does this approach actually recover?”
   To illustrate the role the stability in selecting a single function that satisfies Assumption
4.3, and thus a single probability distribution, consider the following example.

Example 4.5. Suppose that X is a Feller square root process:
                                                           p
                                dXt = −κ(Xt − µ̄)dt + σ̄    Xt dWt

where κ > 0, µ̄ > 0 and κµ̄ ≥ 12 (σ̄)2 . With these restrictions, the process X is stochastically
stable and strictly positive.

                                               10
     Let m(x) = exp (ζx) so that the stochastic discount factor satisfies

                                    St = exp [−δt + ζ(Xt − X0 )] ,                    (11)

or, in differential form,
                                                                     p
                           d log St = [−δ − ζκ(Xt − µ̄)] dt + ζ σ̄       Xt dWt .

     We choose a multiplicative martingale of the form:
                                   Z t              Z           
                          Ht                        1 t       2
                             = exp −    ξ(Xs )dWs −     ξ(Xs ) ds .
                          H0         0              2 0

and thus
                                                         H0
                                              StH = St
                                                         Ht
must satisfy:
                                                       h p              i
                                           1        2
           d log StH   = −δ − ζκ(Xt − µ̄) + [ξ(Xt )] dt + ζ σ̄ Xt + ξ(Xt ) dWt .      (12)
                                           2

We will show that there is a choice of ξ such that
                                                                
                                                            e t
                                                       exp ζX
                                 St 6= StH          e
                                             = exp −δt          ,
                                                             e 0
                                                        exp ζX

or                                   h                   i           p
                          d log StH = −δe − ζκ(X
                                            e    t − µ̄)   dt + e
                                                                ζ σ̄  Xt dWt .

Equating coefficients:                               √
                                        ξ(x) = ζe − ζ σ̄ x,

and
                                             1 e    2
                                                                e
                                  −ζκx +        ζ − ζ σ̄ 2 x = −ζκx.
                                             2
Consequently, either ζe = ζ or,
                                                      2κ
                                              ζe = ζ − 2 .
                                                      σ̄
In this case,
                                                        2κ √
                                             ξ(x) = −        x.
                                                        σ̄
For this second solution, under the probability P H the Brownian motion W has a local drift

                                                   11
−ξ(Xt ) and hence the local mean for X is

                                −κ (x − µ̄) + 2κx = κx + κµ̄.

Thus the dynamics for X are
                                                         p
                               dXt = κ(Xt + µ̄)dt + σ̄            ft
                                                             Xt d W
                     R
where Wft = Wt + t ξ(Xs )ds is a Brownian motion under P H . Since κ > 0, X is not
                      0
stochastically stable when ζe = ζ − σ̄2κ2 .


5     What is recovered?
This section reviews results in Hansen and Scheinkman (2009), Hansen (2012) and Hansen
and Scheinkman (2014). These references and Ross (2013) use Perron–Frobenius theory in
their analyses. At this juncture, we adopt a more general starting point and do not impose
Assumption 4.3.
    Suppose there exists a function e(x) that solves the following Perron–Frobenius problem:

Problem 5.1 (Perron–Frobenius). Find a scalar η and a function e > 0 such that for every
t ∈ T,
                                    [Qt e](x) = exp(ηt)e(x).

    When the state space is finite as in Section 2, functions of x can be identified with vectors
                                                                                    P
in Rn , and the operator Q1 can be identified with a matrix Q. If the matrix ∞             t
                                                                                      t=0 λ Qt is
strictly positive for some positive λ, then the Perron–Frobenius Theorem states that there
exists a unique (up to scale) solution to Problem 5.1.
  Existence and uniqueness are more complicated in the case of general state spaces.
Hansen and Scheinkman (2009) present sufficient conditions for the existence of a solution,
but even in examples commonly used in applied work, multiple (scaled) positive solutions
are a possibility. See Hansen and Scheinkman (2009), Hansen (2012) and our subsequent
discussion for such examples. When we have a solution of the Perron–Frobenius problem,
                                                             e that satisfies:
we follow Hansen and Scheinkman (2009), and define a process H

                                   et
                                   H               e(Xt )
                                      = exp(−ηt)St        .                                 (13)
                                   e0
                                   H               e(X0 )




                                               12
            e is an F-martingale under the probability measure P . In fact,
The process H
        "     #                                     
       et
       H         exp(−ηt)              St e(Xt )        exp(−ητ )                    eτ
                                                                                     H
     E    | Fτ =          Sτ e(Xτ )E             | Fτ =           Sτ e(Xτ ) =           ,
       e0
       H           e(X0 )              Sτ e(Xτ )          e(X0 )                     e0
                                                                                     H

where in the second equality we used the property from equation (7) of the definition of a
multiplicative process.
   Note that H e inherits much of the mathematical structure of the original process S. For
instance, if S has the form given by equation (5) above, then in discrete time:

                   e t+1 − log H
               log H           e t = g(Xt+1 , Xt ) + log e(Xt+1 ) − log e(Xt ) − η
                                  =e
                                   g (Xt+1 , Xt )

In logarithms, this constructed process has stationary increments.
    As we noted, such a construction may not be unique. (For instance, see Example 4.5.) If,
however, we restrict He so that X under the implied probability distribution is stochastically
stable in averages (Condition 3.2), then there is at most one such H.  e The proof of this
uniqueness result is essentially the same as that of Proposition 4.4, and is a result reported
in Hansen and Scheinkman (2009). While this recovers a single probability, there is no claim
that this constructed probability is the one that generates the data.
                 e ≡ 1 then S necessarily satisfies Assumption 4.3. On the other hand, if S
    Note that if H
                                         1
satisfies Assumption 4.3, then e(x) =   m(x)
                                               solves the Perron–Frobenius Problem 5.1 and the
associated He ≡ 1. Thus we obtain:

Proposition 5.2. S satisfies Assumption 4.3 if and only if there exists a solution e > 0 to
the Perron–Frobenius problem and the associated η such that:

                                et
                                H               e(Xt )
                                   = exp(−ηt)St        ≡ 1.
                                e
                                H0              e(X0 )

   This proposition reveals the recovery result as a special case of the decomposition (13).
Recall that the primitive of our analysis is the pair (S, P ) where the probability measure
P satisfies the stochastic stability condition. If the Perron–Frobenius Problem 5.1 yields
a solution He ≡ 1, the uniqueness result implies that P is the single stochastically stable
measure that will be recovered. In the general case, the stochastic discount factor S contains
a martingale component H  e 6= 1 for which the associated measure Pe satisfies the stability
condition. In this case the recovery procedure will not identify the underlying probability



                                                 13
measure. Instead, it will recover the measure Pe implied by H.
                                                            e3


5.1     Long-term pricing
                                            e turns out to be useful in representing long-
The alternative probability associated with H
term values. Consider
                                                                    
                                                   e ψ(X t )
                           [Qt ψ] (x) = exp(ηt)e(x)E         | X0 = x
                                                     e(Xt )

for some positive ψ. We use the notation E   e to denote expectations computed with the
probability Pe implied by H.
                          e 4 For pricing pure discount bonds we can set ψ(x) ≡ 1. Taking
the negative logarithms and dividing by t gives the yield on the payoff ψ(Xt ):
                                                                        
                1                     1          1    e   ψ(Xt )
               − log [Qt ψ] (x) = −η − log e(x) − log E          | X0 = x .
                t                     t          t        e(Xt )

Taking the limit t → ∞ and using the stochastic stability Condition 3.3 under the probability
Pe shows that −η is the long term yield on an arbitrary cash flow ψ(x) maturing in the distant
future, provided                                     
                                           e   ψ(Xt )
                                           E            < ∞.
                                               e(Xt )
                                                                               τ
Under the same assumption, the long maturity limit of a holding period return Rt,t+1 between
period t and period t + 1 on bond with maturity τ is

                  ∞            τ                [Qτ −1 ψ](Xt+1 )           e(Xt+1 )
                 Rt,t+1 = lim Rt,t+1 = lim                       = exp(−η)          .
                           τ →∞            τ →∞   [Qτ ψ](Xt )               e(Xt )

Moreover, the “Euler-equation error” associated with the limit return is
                                                               e t+1
                                           St+1        ∞         H
                                                      Rt,t+1 =         ,                             (14)
                                            St                    et
                                                                  H

which reveals the martingale increment in the stochastic discount factor. We will use this
formula in Section 6 when we discuss empirical methods and evidence.
   3
     Example 3.1 in Hansen and Scheinkman (2014) points out this connection in a finite-state Markov chain
setting.
   4                         e instead of the more cumbersome P He and E He .
     Note that we use Pe and E,




                                                       14
5.2    Examples
In the previous discussion, we described two issues arising in the recovery procedure. First,
the positive candidate solution for e(x) may not be unique. Our stability criterion allows
us to pick the single solution that preserves stability. Second, and more importantly, even
this unique choice may not uncover the true probability distribution if there is a martingale
component in the stochastic discount factor. We illustrate these challenges using stylized
versions of widely used asset pricing models. The next example shows that in a simplified
version of a stochastic volatility model one always recovers an incorrect probability distribu-
tion that, for certain parameter values, actually coincides with the risk-neutral probability
measure.

Example 5.3. Consider a stochastic discount factor model with state-dependent risk prices.
Suppose that
                                       1             p
                      d log St = β̄dt − Xt (ᾱ)2 dt + Xt ᾱdWt
                                       2
where X has the square root dynamics given in Example 4.5 and β̄ < 0. Guess a solution:

                                         e(x) = exp(υx)

Since {exp(−ηt)St e(Xt ) : t ≥ 0} is a martingale, its local mean should be zero:

                               1                     1
                        β̄ −     (ᾱ)2 − υκx + υκµ̄ + x (υσ̄ + ᾱ)2 = 0.
                               2                     2

In particular, the coefficient on x should satisfy
                                                      
                                        1      2
                                 −υ −κ + υ (σ̄) + σ̄ ᾱ = 0.
                                        2

There are two solutions: υ = 0 and

                                              2κ − 2ᾱσ̄
                                         υ=                                               (15)
                                                (σ̄)2

   For this example, the risk neutral dynamics for X corresponds to the solution υ = 0 and
the instantaneous risk-free rate is constant and equal to −β̄. The resulting X process remains
a square root process, but with κ replaced by

                                          κn = κ − ᾱσ̄.

Although κ is positive, κn could be positive or negative. If κn > 0, then the Perron–Frobenius

                                                15
problem that we feature extracts the risk-neutral dynamics, but this is distinct form the actual
probability evolution for X. Suppose instead that κn < 0. This occurs when κ < σ̄ ᾱ. In this
case we choose υ according to (15), implying that κ is replaced by

                                 κpf = −κ + σ̄ ᾱ = −κn > 0.

The resulting dynamics are distinct from both the risk-neutral dynamics and the original
dynamics for the process X.

This example was designed to keep the algebra simple, but there are straightforward exten-
sions that are described in Hansen (2012). In this example there is a single shock that shifts
both the stochastic discount factor and the state variable X that governs volatility. The
                                                         √
so-called “local risk price” for this shock is given by − Xt σs . There is a straightforward
extension that extends the dimension of the Brownian increment and reproduces analogous
findings. In addition, a predictable component can be included in the local mean for the
log S. Hansen (2012) includes these generalizations using a model with affine dynamics of
the type featured by Duffie and Kan (1994).
    The continuous-time model of Campbell and Cochrane (1999) has some implications that
parallel those captured by Example 5.3.

Example 5.4. Suppose that

                               d log St = β̄dt + ᾱdWt + d log Zt

where Zt = k(Xt ) > 0 and X is a stationary Markov process that captures the contribution
of external or social habits to investor preferences. For the continuous-time Campbell and
Cochrane (1999) model, there are special functional forms for k and the evolution of X.
By design, their model has a constant instantaneous interest rate ρ. A candidate for a
Perron–Frobenius eigenvalue is η = −ρ and an associated positive eigenfunction is constant.
This eigenfunction induces unstable state dynamics in their specification. There is a second
eigenfunction log e(x) = − log k(x), and this one induces stable dynamics, but these are
different from the actual evolution of X unless ᾱ = 0. See Borovička et al. (2011) for more
discussion of these issues.

   Our next example illustrates that even when the macroeconomy is modeled as stationary,
the stochastic discount factor can still inherit a martingale component.

Example 5.5. Here we illustrate a point made by Alvarez and Jermann (2005) concerning
recursive utility of the type featured by Kreps and Porteus (1978) and Epstein and Zin (1989).

                                              16
For an infinite-horizon discrete-time economy, The recursive utility stochastic discount factor
in discrete time obeys:
                                                              −ρ                 ρ−γ
                               St+1                     Ct+1             Vt+1
                                    = exp(−δ)
                                St                       Ct            Rt (Vt+1 )

                     1
where ρ > 0 and      ρ
                         is the elasticity of intertemporal substitution, δ > 0 is a subjective rate of
discount and γ adjusts the for the riskiness in the continuation value Vt+1 in the formula:
                                                              1
                                  Rt (Vt+1 ) = E (Vt+1 )1−γ Ft 1−γ .

Suppose that C = k(X) > 0 implying a stationary consumption process, that γ > 1 and for
simplicity suppose that ρ = 1.5 Then
                                                  1−γ
                                        Vt+1                     (Vt+1 )1−γ
                                                          =                                       (16)
                                      Rt (Vt+1 )              E (Vt+1 )1−γ |Ft

which has conditional expectation equal to unity and is the increment to a positive martin-
gale. For this specification Vt+1 can be expressed as a time invariant function of the Markov
state Xt+1 and the risk adjustment term Rt (Vt+1 ) , a time invariant function of Xt . Thus
the ratio on the right-hand side of (16) is the increment to a positive multiplicative mar-
tingale. Even though C is stationary, the stochastic discount factor process has a positive
martingale component. While we have not shown that this martingale necessarily induces
stable dynamics, this may be checked in actual applications.
                                                                                                      Vt
       Often, log C is modeled as a process with stationary increments. In this case the ratio        Ct
is computed as a time-invariant function of the Markov state Xt . Both consumption growth
and the ratio of the continuation value to its risk-adjusted counterpart contribute to the
increment to a martingale component of S.


5.3       Additional insights about the factorization
One of the aims of Hansen and Scheinkman (2009) was to provide a formal justification for
the factorization of the stochastic discount factor process featured by Alvarez and Jermann
(2005):                                             !
                                St              He t  e(X0 ) 
                                   = exp(ηt)
                                S0              e0
                                                H      e(Xt )
   5
    See Proposition 9 of Alvarez and Jermann (2005) for a closely related example in which consumption is
independent and identically distributed and ρ 6= γ.


                                                          17
Sometimes this factorization may be difficult to compute. Nevertheless, there are circum-
stances in which we can still draw conclusions without a full characterization.

5.3.1    Permanent shocks

Alvarez and Jermann (2005) use the martingale component as evidence for the impact of
permanent shocks to the stochastic discount factor process. To understand this link more
fully consider an alternative martingale extraction that is familiar from time series analysis.
Recall that log Mt has stationary increments. Often it is most convenient to compute or
model log M as a precursor to the study of M. The martingale component of log M can be
computed from the decomposition

                                                    b t − g(Xt ) + g(X0 )
                                  log St = ρt + log H

and reveals a permanent shock log Hb t up to a scale normalization. When log S − log S0
has a non-degenerate martingale component with stationary increments, then S/S0 has a
multiplicative martingale component and vice versa. When M is globally log-normal, there
are simple links between these martingales; but outside the log-normal environment this link
may cease to be direct. In general, the difference η − ρ between the extracted drift terms is
linked to the average relative entropy of M, which reflects the magnitude of the martingale
component:
                                                                    
                            1            St                  St
                η − ρ ≡ lim     log E       | X0 = x − E log    | X0 = x
                        t→∞ t
                            "           #S0                  S0
                                  e t+1
                                  H
                      = −E log           .
                                   et
                                   H

Thus the difference between η and ρ from two different martingale constructions reveal the
average of the one-period log-likelihood ratio between the original probability measure and
the ˜· probability measure.6

5.3.2    A more general factorization

Bansal and Lehmann (1997) note that in many examples the stochastic discount factor can
be expressed as:                      ∗ ∗         
                               St      St   m (Xt )
                                  =                                                (17)
                               S0      S0∗  m∗ (X0 )
   6
    See Hansen (2012) for a further elaboration of this relationship, and see Backus et al. (2014) for discussion
of a term structure counterpart applicable to all investment horizons.



                                                       18
where S ∗ /S0∗ is a positive multiplicative process with a direct interpretation. Sometimes, it
will be easy to characterize the martingale component of S ∗ . The stochastic discount factor
process S will have the same martingale component as S ∗ with the same Perron–Frobenius
eigenvalue but with a different Perron–Frobenius eigenfunction. This formula gives us a way
to represent implications of a class of models. Suppose that two models share the same
same S ∗ but differ in m∗ . Both models will inherit the long-horizon pricing properties from
S ∗ although risk-return tradeoffs over short investment horizons could be quite different.
Consider two illustrations. The stochastic discount factor for the Campbell–Cochrane model
in Example 5.4 can be written as:
                                              Z t               
                                St                          k(Xt )
                                   = exp β̄t +     ᾱdWu             ,
                                S0              0           k(X0 )

and thus satisfies (17) with S ∗ being a geometric Brownian and m∗ = k. The contribution
of the geometric Brownian motion can be interpreted as a marginal utility process for a
corresponding preference specification that abstracts from the contribution of external habits.
   Hansen (2012) uses this approach to compare a model with power utility preferences
with risk-aversion coefficient γ to a more general recursive utility model from Example 5.5
with ρ 6= γ.7 Both preference specifications share the same martingale component holding
fixed the consumption process provided that the subjective rate of discount is pushed to an
appropriately defined limiting value.

5.3.3     Risk-return tradeoff and welfare consequences

Since the prices of all Arrow claims are taken as given, the recovery of an incorrect probability
does not affect the pricing of any derivative security. The recovery of an incorrect probability
measure does lead to incorrect inference about expected returns and as a consequence to a
misspecification of the risk-return tradeoff faced by investors. Incorrect inference about
expected cash flows affect the calculation of the welfare cost of economic fluctuations, since
Hansen et al. (1999) and Alvarez and Jermann (2004) showed a link between local measures
of welfare cost of uncertainty and prices and expectations of the appropriately constructed
cash flows.
  7
      See Theorem 9.1 of Hansen (2012).




                                                 19
6     Measuring the martingale component
We next consider methods for extracting evidence from asset market data that supports the
existence of a non-trivial martingale component in stochastic discount factors. We build
on the approach initiated by Hansen and Jagannathan (1991) aimed at non-parametric
characterizations of stochastic discount factors without using a full set of Arrow prices. In
such circumstances, full identification is not possible; but nevertheless the data from financial
markets can be informative. For this discussion we use pedagogically useful characterization
of Almeida and Garcia (2013) and Hansen (2014), but adapted to misspecified beliefs along
the lines suggested in Gosh et al. (2012) and Hansen (2014). In so doing we build on a key
insight of Alvarez and Jermann (2005).
    Consider strictly convex functions φθ defined on the positive real numbers such as:

                                              1    h           i
                                                        1+θ
                                 φθ (r) =           (r)     −1                              (18)
                                          θ(1 + θ)

for alternative choices of the parameter θ. By design φθ (1) = 0 and φ′′θ (1) = 1. The function
φθ remains well defined for θ = 0 and θ = −1 by taking pointwise limits in r as θ approaches
these two values. Thus φ0 (r) = r log r and φ−1 (r) = − log r. The functions φθ are used
to construct discrepancy measures between probability densities as in the work of Cressie
and Read (1984). We are interested in such measures as a way to quantify the martingale
component to stochastic discount factors. Recall that
                                        "             #
                                         e t+1
                                         H
                                       E       |Xt = x = 1
                                          et
                                          H

and that H e t+1 /H
                  e t defines a conditional density of the Pe distribution relative to the P dis-
tribution. This leads us to apply the discreprancy measures to H     e t+1 /H
                                                                            et.
    Since φθ is strictly convex and φθ (1) = 0, from Jensen’s inequality:
                                   "                !         #
                                            e t+1
                                            H
                                E φθ                    |Xt = x ≥ 0,
                                             et
                                             H

                        e t+1 /H
with equality only when H      e t is identically one. There are three special cases that receive
particular attention.
 i) θ = 1 in which case the implied measure of discrepancy is equal to one-half times the
                            e t+1 /H
    conditional variance of H      et;

 ii) θ = 0 in which case the implied measure of discrepancy is based on conditional relative

                                                    20
    entropy:                      h                                         i
                              E        e t+1 /H
                                       H      et         e t+1 − log H
                                                     log H           e t |Xt = x

    which is the expected log-likelihood under the Pe probability measure.

iii) θ = −1 in which case the discrepancy measure is:
                                          h                           i
                                               e t+1 − log H
                                        −E log H           e t |Xt = x


    which the negative of the expected log-likelihood under the original probability measure.

    We describe how to compute lower bounds for these discrepancy measures. We are led
to the study lower bounds because we prefer not to compel an econometrician to use a full
array of Arrow prices. Let Yt+1 be a vector of asset payoffs and Qt the corresponding vector
of prices. Recall the formula

                                          ∞                        e(Xt+1 )
                                         Rt,t+1 = exp(−η)                   .
                                                                    e(Xt )

and thus                                                        !             
                                        St+1          e t+1
                                                      H                  1
                                             =                                     .      (19)
                                         St            et
                                                       H              Rt,t+1
                                                                       ∞


As in Alvarez and Jermann (2005), suppose that the limiting holding-period return Rt,t+1
                                                                                   ∞
                                                                                         can
be well approximated. In this case, one could test directly for the absence of the martingale
component by assessing whether
                                                                
                                           1
                              E                      (Yt+1 )|Xt = x = (Qt )′ .
                                        Rt,t+1
                                         ∞



since in this case:                                                     
                                               St+1               1
                                                    =
                                                St              Rt,t+1
                                                                 ∞


prices assets correctly.
    More generally, we express the pricing restrictions as
                          "              !                                       #
                              e t+1
                              H                  1
                      E                                     (Yt+1 )′ |Xt = x = (Qt )′ ,
                               et
                               H               Rt,t+1
                                                ∞



where H̃ is now treated as unobservable to an econometrician. To bound a discrepancy




                                                            21
measure, let a random variable Jt+1 be a potential specification for the martingale increment:

                                                         e t+1
                                                         H
                                              Jt+1 =           .
                                                          et
                                                          H

Solve
                              λθ (x) = inf E [φθ (Jt+1 ) |Xt = x]
                                           Jt+1 >0

subject to the linear constraints:

                                                      E [Jt+1 |Xt = x] − 1 = 0
                                                              
                                       1
                        E Jt+1                    (Yt+1 ) |Xt = x − (Qt )′ = 0
                                                         ′
                                     Rt,t+1
                                      ∞



A strictly positive λθ (x) implies a nontrivial martingale component to the stochastic discount
factor.
   For the limiting continuous-time diffusion case, the choice of θ is irrelevant. Suppose that

                                 e t = − 1 |α̃(Xt )|2 dt + α
                           d log H                         e(Xt ) · dWt .
                                         2

As a consequence,
                                            et
                                           dH
                                               =α
                                                e(Xt ) · dWt
                                           Het
                       θ+1
                       e
Thus the local mean of H     is

                                     θ(θ + 1)  e θ+1
                                               Ht       α(Xt )|2
                                                       |e
                                         2

                                   α(Xt )|2 independent of θ. The discrepancies for all values of
and the discrepancy measure is 12 |e
                                                        e This equivalence of the discrepancy
θ are equal to one-half times the local variance of log H.
measures is special to the continuous-time diffusion model, however.
  To compute λθ in practice requires that we estimate conditional distributions. There is
an unconditional counterpart to these calculations obtained by solving:

                                       λ̄θ = inf Eφθ (Jt+1 )                                (20)
                                               Jt+1 >0




                                                     22
subject to:

                                                         E [Jt+1 ] − 1 = 0
                                                                   
                                          1                 ′       ′
                           E Jt+1                    (Yt+1 ) − (Qt ) = 0                 (21)
                                        Rt,t+1
                                         ∞



This bound, while more tractable, is weaker in the sense that λ̄θ ≤ Eλθ (Xt ). To guarantee
a solution to optimization problem (20) it is sometimes convenient to include random vari-
ables Jt+1 that are zero with positive probability. Since the aim is to produce bounds, this
augmentation can be justified for mathematical and computational convenience. Although
this problem optimizes over an infinite-dimensional family of random variables Jt+1 , the dual
problem that optimizes over the Lagrange multipliers associated with the pricing constraint
(21) is often quite tractable. See Hansen et al. (1995) and the literature on implementing
generalized empirical likelihood methods for further discussion.
   For the case in which θ = 1, Hansen and Jagannathan (1991) study a mathematically
equivalent problem by constructing volatility bounds for stochastic discount factors and
deduce quasi-analytical formulas for the solution obtained when ignoring the restriction that
stochastic discount factors should be nonnegative. Bakshi and Chabi-Yo (2012) apply the
latter methods to obtain θ = 1 bounds (volatility bounds) for the martingale component
to the stochastic discount factor process. Similarly, Bansal and Lehmann (1997) study
bounds on the stochastic discount factor process for the case in which θ = −1 and show
the connection with a maximum growth rate portfolio. Alvarez and Jermann (2005) apply
these methods to produce the corresponding bounds for the martingale component to the
stochastic discount factor process. Both Alvarez and Jermann (2005) and Bakshi and Chabi-
Yo (2012) exploit equation (19) and approximate the return Rt,t+1
                                                               ∞
                                                                   in order to target their
analysis to the martingale component. These papers provide empirical evidence in support
of a substantial martingale component to the stochastic discount factor process. Bakshi and
Chabi-Yo (2012) summarize results from both papers in their Table 1 and contrast differences
in the θ = 1 and θ = −1 discrepancy measures. To our knowledge, the θ = 0 discrepancy
measure has not been used to quantify the magnitude of the martingale component to the
stochastic discount factor processes.


7    Conclusion
Perron–Frobenius theory applies to an operator used to represent Arrow prices. Recent
research uses this insight in varied ways. As we have argued, when the state-space is contin-


                                                     23
uous, the positive eigenfunction of the pricing operator may not be unique (up to scale), and
further assumptions are needed to determine a unique decomposition. In our previous work,
Hansen and Scheinkman (2009), we were interested in long-run risk and for this reason we
emphasized a stochastic stability condition. In this paper we gave a generalization of that
stability condition to establish uniqueness by replacing the convergence of a sequence of
conditional expectations by the convergence of partial averages of that sequence. We show
that this more general condition is implied by an ergodicity assumption commonly used in
the study of rational expectations models of financial markets.
   Other researchers have taken different approaches to the uniqueness. In a continuous-
time Brownian information setup, alternative conditions on the boundary behavior of the
underlying Markov process also uniquely identify a probability measure. These conditions
often utilize linkages of the Perron–Frobenius theorem to the Sturm–Liouville problem in
the theory of second-order differential equations. Carr and Yu (2012) and Dubynskiy and
Goldstein (2013) impose conditions on reflecting boundaries, while Walden (2013) analyzes
natural boundaries. A recent working paper by Qin and Linetsky (2014) provides a more
comprehensive treatment of the continuous state space environment, connections to our own
previous results in Hansen and Scheinkman (2009) and Hansen and Scheinkman (2014), and
an extensive range of examples utilizing models in mathematical finance.
   While these technical conditions deliver uniqueness, we argue that there is a more fun-
damental identification problem. If the stochastic discount factor includes a martingale
component, then use of the Perron–Frobenius eigenvalue and function recovers a distorted
probability measure that provides insights into the pricing of long-term bonds and other cash
flows that do not grow stochastically over time. Many structural models of asset pricing
that are motivated by empirical evidence have martingale components in stochastic discount
factor processes. These martingales characterize what probability is actually recovered by
application of Perron-Frobenius theory.
   While fixed income security valuation is of interest in its own right, Hansen and Scheinkman
(2009) and Hansen (2012) use Perron–Frobenius methods to study more general valuation
problems in which cash flows can grow stochastically over time. These extensions are critical
for many macro-finance applications because, empirically, many macro time series display
stochastic growth. Long-term valuation is only a component to a more systematic study of
pricing implications over alternative investment horizons. Recent work by Borovička et al.
(2011) and Borovička et al. (2014) deduces methods that extend impulse response functions
to characterize the pricing of exposures to shocks to stochastically growing cash flows over
alternative investment horizons.



                                             24
Appendix
A      Perron–Frobenius theory
Proof of Proposition 4.4. Write
                                                          b
                                                       b m(X
                                            S H = exp −δt
                                                                t)
                                                                   ,
                                                            m(X
                                                            b 0)

for a positive function m.
                        b Thus

                                 h        i           m(Xt )
                         Ht                             b t)
                                                        m(X                     k(Xt )
                            = exp − δ − δb t            m(X0 )
                                                                  := exp (ηt)          ,
                         H0                                                     k(X0 )
                                                        b 0)
                                                        m(X


where η = δ − δb and k =   m
                           b.
                           m    In what follows we consider the discrete time case. The continuous
time case uses an identical approach, with the obvious changes.
                                                                    Ht
    Consider three cases. First suppose that η > 0. Since           H0   is a martingale,

                                  E [k(Xt )|X0 = x] = exp(−ηt)k(x)                            (22)

Form
                                 k̂(x) = min {1, k(x)} > 0, for all x.

Since η > 0, the right-hand side of (22) converges to zero for each x as t → ∞. Thus,

                                            1 X h               i   h       i
                  N                           N
                1 X
       0 = lim      E [k(Xt )|X0 = x] ≥ lim     E k̂(Xt )|X0 = x = E k̂(X0 ) > 0.
           N →∞ N                      N →∞ N
                   t=1                                      t=1

Thus we have established a contradiction.
    Next suppose that η < 0. Note that
                                                         
                                    H         1                       1
                                E                  |X0 = x = exp(ηt)      .                   (23)
                                            k(Xt )                   k(x)

Form                                              
                                e              1
                                k(x) = min 1,        > 0, for all x.
                                              k(x)
Since η < 0, the right-hand side of (23) converges to zero for each x as t → ∞. Thus,

                                    
                                            1 X H he             i     h       i
                N                              N
             1 X H       1
    0 = lim        E          |X0 = x ≥ lim       E k(Xt )|X0 = x = E H ek(X0 ) > 0.
        N →∞ N         k(Xt )          N →∞ N
               t=1                            t=1

We have again established a contradiction.



                                                       25
   Finally, suppose η = 0. Then
                                                             
                                        H         1               1
                                    E                  |X0 = x =
                                                k(Xt )           k(x)

for all x. Since X is stochastically stable in averages:

                                   N
                                1 X H n
                            lim       E [k (Xt )|X0 = x] = E H k n (X0 ).
                           N →∞ N
                                  t=1

for k n = min{1/k, n}. The
                        h same
                                                                                    n
                                i equality applies to the limit as n → ∞ whereby k is replaced by
                           1         1
1/k. Consequently, E H k(X   0)
                                 = k(x)  for almost all x. Thus k(x) is a constant, and Ht /H0 ≡ 1
with probability one.




                                                      26
References
Almeida, Caio and René Garcia. 2013. Robust Economic Implications of Nonlinear Pricing
  Kernels.

Alvarez, Fernando and Urban J. Jermann. 2004. Using Asset Prices to Measure the Cost of
  Business Cycles. Journal of Political Economy 112 (6):1223–1256.

———. 2005. Using Asset Prices to Measure the Persistence of the Marginal Utility of
  Wealth. Econometrica 73 (6):1977–2016.

Backus, David K., Allan W. Gregory, and Stanley E. Zin. 1989. Risk Premiums in the
  Term Structure : Evidence from Artificial Economies. Journal of Monetary Economics
  24 (3):371–399.

Backus, David K., Mikhail Chernov, and Stanley E. Zin. 2014. Sources of Entropy in Rep-
  resentative Agent Models. The Journal of Finance 59 (1):51–99.

Bakshi, Gurdip and Fousseni Chabi-Yo. 2012. Variance Bounds on the Permanent and
  Transitory Components of Stochastic Discount Factors. Journal of Financial Economics
  105 (1):191–208.

Bansal, Ravi and Bruce N. Lehmann. 1997. Growth-optimal Portfolio Restrictions on Asset
  Pricing Models. Macroeconomic Dynamics 1 (2):333–354.

Borovička, Jaroslav, Lars Peter Hansen, Mark Hendricks, and José A. Scheinkman. 2011.
  Risk Price Dynamics. Journal of Financial Econometrics 9:3–65.

Borovička, Jaroslav, Lars Peter Hansen, and José A. Scheinkman. 2014. Shock Elasticities
  and Impulse Responses. Mimeo.

Campbell, John Y. and John H. Cochrane. 1999. By Force of Habit. Journal of Political
  Economy 107 (2):205–251.

Carr, Peter and Jiming Yu. 2012. Risk, Return and Ross Recovery. The Journal of Deriva-
  tives 20 (1):38–59.

Cressie, Noel and Timothy R. C. Read. 1984. Multinomial Goodness-of-Fit Tests. Journal
  of the Royal Statistical Society. Series B (Methodological) 46 (3):440–464.

Dubynskiy, Sergey and Robert S. Goldstein. 2013. Recovering Drifts and Preference Param-
  eters from Financial Derivatives.

                                             27
Duffie, Darrell and Rui Kan. 1994. Multi-Factor Term Structure Models. Philosophical
 Transactions: Physical Sciences and Engineering 347 (1684):577–586.

Epstein, Larry G. and Stanley E. Zin. 1989. Substitution, Risk Aversion, and the Temporal
  Behavior of Consumption and Asset Returns: A Theoretical Framework. Econometrica
  57 (4):937–969.

Gosh, Anisha, Christian Julliard, and Alex Taylor. 2012. What is the Consumption-CAPM
 Missing? An Information-Theoretic Framework for the Analysis of Asset Pricing Models.
 Working paper, Tepper School of Business, Carnegie Mellon University.

Hansen, Lars Peter. 2012. Dynamic Valuation Decomposition within Stochastic Economies.
  Econometrica 80 (3):911–967. Fisher–Schultz Lecture at the European Meetings of the
  Econometric Society.

———. 2014. Uncertainty Outside and Inside Economic Models. Nobel Prize paper.

Hansen, Lars Peter and Ravi Jagannathan. 1991. Implications of Security Market Data for
  Models of Dynamic Economies. Journal of Political Economy 99 (2):225–262.

Hansen, Lars Peter and Scott F. Richard. 1987. The Role of Conditioning Information in
  Deducing Testable Restrictions Implied by Dynamic Asset Pricing Models. Econometrica
  55 (3):587–613.

Hansen, Lars Peter and José A. Scheinkman. 2009. Long Term Risk: An Operator Approach.
  Econometrica 77 (1):177–234.

———. 2014. Stochastic Compounding and Uncertain Valuation.

Hansen, Lars Peter and Kenneth J. Singleton. 1982. Generalized Instrumental Variables
  Estimation of Nonlinear Rational Expectations Models. Econometrica 50 (5):1269–1286.

Hansen, Lars Peter, John Heaton, and Erzo G. J. Luttmer. 1995. Econometric Evaluation
  of Asset Pricing Models. The Review of Financial Studies 8 (2):237–274.

Hansen, Lars Peter, Thomas J. Sargent, and Jr. Tallarini, Thomas D. 1999. Robust Perma-
  nent Income and Pricing. The Review of Economic Studies 66 (4):873–907.

Kreps, David M. and Evan L. Porteus. 1978. Temporal Resolution of Uncertainty and
  Dynamic Choice Theory. Econometrica 46 (1):185–200.

Qin, Likuan and Vadim Linetsky. 2014. Ross Recovery in Continuous Time. Mimeo, North-
  western University.

                                           28
Ross, Stephen A. 2013. The Recovery Theorem. Forthcoming in the Journal of Finance.

Walden, Johan. 2013. Recovery with Unbounded Diffusion Processes.




                                         29
