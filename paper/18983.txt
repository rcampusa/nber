                                NBER WORKING PAPER SERIES




       THE PRUNED STATE-SPACE SYSTEM FOR NON-LINEAR DSGE MODELS:
                   THEORY AND EMPIRICAL APPLICATIONS

                                        Martin M. Andreasen
                                     Jesús Fernández-Villaverde
                                        Juan Rubio-Ramírez

                                        Working Paper 18983
                                http://www.nber.org/papers/w18983


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      April 2013




We acknowledge access to computer facilities provided by the Danish Center for Scientific Computing
(DCSC). We appreciate the financial support of the Center for Research in Econometric Analysis of
Time Series (CREATES), funded by the Danish National Research Foundation and the National Science
Foundation (NSF). The views expressed herein are those of the authors and do not necessarily reflect
the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2013 by Martin M. Andreasen, Jesús Fernández-Villaverde, and Juan Rubio-Ramírez. All rights
reserved. Short sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including © notice, is given to the source.
The Pruned State-Space System for Non-Linear DSGE Models: Theory and Empirical Applications
Martin M. Andreasen, Jesús Fernández-Villaverde, and Juan Rubio-Ramírez
NBER Working Paper No. 18983
April 2013
JEL No. C15,C53,E30

                                             ABSTRACT

This paper studies the pruned state-space system for higher-order approximations to the solutions of
DSGE models. For second- and third-order approximations, we derive the statistical properties of this
system and provide closed-form expressions for first and second unconditional moments and impulse
response functions. Thus, our analysis introduces GMM estimation for DSGE models approximated
up to third-order and provides the foundation for indirect inference and SMM when simulation is required.
We illustrate the usefulness of our approach by estimating a New Keynesian model with habits and
Epstein-Zin preferences by GMM when using first and second unconditional moments of macroeconomic
and financial data and by SMM when using additional third and fourth unconditional moments and
non-Gaussian innovations.


Martin M. Andreasen                                 Juan Rubio-Ramírez
Aarhus University                                   Duke University
Fuglesangs Allé 4                                   P.O. Box 90097
8210 Aarhus V                                       Durham, NC 27708
Denmark                                             juan.rubio-ramirez@duke.edu
mandreasen@econ.au.dk

Jesús Fernández-Villaverde
University of Pennsylvania
160 McNeil Building
3718 Locust Walk
Philadelphia, PA 19104
and NBER
jesusfv@econ.upenn.edu




An online appendix is available at:
http://www.nber.org/data-appendix/w18983
1         Introduction

Perturbation methods allow researchers to build higher-order Taylor approximations to the solution

of dynamic stochastic general equilibrium (DSGE) models (see Judd and Guu (1997), Schmitt-

Grohé and Uribe (2004), Aruoba, Fernandez-Villaverde and Rubio-Ramirez (2006), among others).

Higher-order Taylor approximations are growing in popularity for two reasons. First, researchers

want to …nd approximated solutions that are more accurate than those obtained from a linear

approximation. Second, there is much interest in questions that are inherently non-linear, such

as the consequences of uncertainty shocks or macroeconomic determinants behind risk premia

that cannot be studied with linear methods (see Fernández-Villaverde, Guerrón-Quintana, Rubio-

Ramírez and Uribe (2011) or Binsbergen, Fernandez-Villaverde, Koijen and Rubio-Ramirez (2012)).

         Although higher-order approximations are intuitive and straightforward to compute, the sim-

ulated sample paths that they generate often explode. This is true even when the corresponding

linear approximation is stable. The presence of explosive behavior complicates any model evalu-

ation because no unconditional moments would exist based on this approximation. It also means

that any unconditional moment-matching estimation methods, such as the generalized method of

moments (GMM) or the simulated method of moments (SMM), are inapplicable in this context as

they rely on …nite moments from stationary and ergodic probability distributions. For a review of

GMM in the context of DSGE models, see Ruge-Murcia (2013).1

         For second-order approximations, Kim, Kim, Schaumburg and Sims (2008) have proposed to

address the problem of explosive sample paths by applying the pruning method. Pruning means

leaving out terms in the solution that have higher-order e¤ects than the approximation order. The

intuition is as follows. Suppose we have a solution for capital kt that depends on a quadratic

function of kt       1   (as we will typically have with a second-order approximation). If we substitute

kt   1    for its own quadratic function of kt     2,   then we obtain an expression for kt that depends on

kt   2,    kt2 2 , kt3 2 , and kt4 2 . Pruning omits terms related to kt3   2   and kt4   2   because they are third-

and fourth-order e¤ects, respectively. Kim, Kim, Schaumburg and Sims (2008) show that leaving

out these e¤ects ensures that the pruned approximation does not explode.

         The purpose of this paper is to extend pruning beyond second-order approximations and to
     1
    Non-explosive paths are also necessary to implement full likelihood methods, for instance, with a non-linear …lter
such as the particle …lter presented in Fernández-Villaverde and Rubio-Ramírez (2007).


                                                           2
explore its econometric implications. We proceed in two steps. First, we show how to apply prun-

ing to an approximation of any arbitrary order. We do so by exploiting what we refer to as the

pruned state-space system. We pay special attention to second and third-order approximations,

those most likely to be used by researchers. Second, we derive the statistical properties of the

pruned state-space system. Under very general technical conditions, we show that …rst and second

unconditional moments exist. Then, we provide closed-form expressions for …rst and second un-

conditional moments and impulse response functions (IRFs). Conditions for the existence of some

higher unconditional moments, such as skewness and kurtosis, are derived as well.

      The econometric implications of these closed-form expressions are signi…cant as most of the ex-

isting unconditional moment-based estimation methods for linearized DSGE models now carry over

to non-linear approximations in a simple way. For approximations up to third order, this includes

GMM estimation based on …rst and second unconditional moments and matching of model-implied

IRFs to their empirical counterpart, as in Christiano, Eichenbaum and Evans (2005) for a linearized

model. Both estimation methods can be implemented without the need for simulation and thereby

avoiding numerical simulation errors. Following Kim (2002), the unconditional moment conditions

in optimal GMM estimation can be used to build a so-called limited information likelihood func-

tion, from which Bayesian inference may be carried out. Hence, our closed-form expressions are

also useful to researchers interested in the Bayesian tradition. Finally, when simulations are needed

to calculate higher unconditional moments, our analysis provides the foundation for di¤erent types

of indirect inference as in Smith (1993) and SMM as in Du¢ e and Singleton (1993).

      The suggested GMM estimation approach, its Bayesian equivalent, and IRF matching seem

particular promising because we can compute …rst and second unconditional moments or any IRFs

in a trivial amount of time for medium-sized DSGE models approximated up to third-order. For

the model described in section 7 with seven state variables, it takes less than one second to …nd

all …rst and second unconditional moments and slightly more than one second to compute all the

IRFs using Matlab. Moreover, our moment approach would enable us to determine the stochastic

speci…cation of the innovations in a semi-parametric manner, although due to space limitations, we

do not pursue that route explicitly in this paper. To make our results easily assessable, our Matlab

codes are publicly available on the authors’home pages.2
  2
      Ongoing work deals with implementing our …ndings in Dynare.


                                                       3
    Our results are also relevant to researchers who do not rely on formal estimation but, instead,

prefer to calibrate their models. In the traditional calibration strategy with linear approximations,

structural parameters are determined by matching the steady-state values of the model to mean

values in the data (see Cooley and Prescott (1995) for a canonical exposition). However, when

higher-order approximations are considered, the …rst unconditional moments of variables in the

model will, in general, di¤er from their steady-state values as non-linear terms correct for uncer-

tainty. Thus, following the traditional calibration strategy when higher-order approximations are

considered might result in misleading structural parameter values. Instead, the closed-form solu-

tions for …rst unconditional moments provided in this paper can be used to select the correct values

for the structural parameters for models solved with higher-order approximations.3

    In an empirical application, we illustrate some of the econometric techniques that our paper

makes available for non-linear DSGE models. Our focus is on a rich New Keynesian model with

habits and Epstein-Zin preferences, which we estimate on key moments for the U.S. yield curve

and …ve macroeconomic variables. Using …rst and second unconditional moments, we estimate the

model by GMM when using second- and third-order approximations. When additional third and

fourth unconditional moments are included, we resort to simulation and estimate the model by

SMM. Thanks to our results, the estimation is e¢ ciently done and the results are transparent and

easy to interpret.

    To be concrete, in the case of the GMM estimation using …rst and second unconditional mo-

ments, we …nd sizable habits, a low Frisch elasticity of labor supply, a high relative risk aversion, a

low intertemporal elasticity of substitution for consumption, and a high degree of price stickiness.

With respect to the …t of the model, our economy matches all mean values extremely well, in

particular the short- and long-term interest rates of 5:6 percent and 6:9 percent, respectively, and

the mean in‡ation rate of 3:7 percent. The …t of the variability, correlations, and autocorrelations

in the data is still good, although less impressive than the …t of the …rst moments. Consequently,

a standard speci…cation J-test cannot reject the model. Interestingly, when we use the third-order

approximation, we …nd a nominal term premium with a sizable mean of 174 annualized basis points
   3
     Some papers in the literature have accounted for the di¤erence between the deterministic steady state and the
mean of the ergodic distribution by means of simulation; see, for instance, Fernández-Villaverde, Guerrón-Quintana,
Rubio-Ramírez and Uribe (2011). The formulas in this paper provide a much more e¢ cient way to carry out the
calibration approach in non-linear approximations.



                                                        4
and a quite realistic standard deviation of 20 annualized basis points. For the SMM estimation with

third and fourth unconditional moments, most parameters are unchanged and the speci…cation test

still cannot reject the model. Moreover, we …nd evidence of non-Gaussianity in technology shocks

but not in preference shocks.

    Based on our analysis, we view the pruning method as a most useful tool. It makes available

a large set of well-known and intuitive estimators when approximations up to third-order are con-

sidered. This is because any sample path is covariance stationary, implying that explosive sample

paths do not occur (almost surely).

    The rest of the paper is structured as follows. Section 2 introduces the problem. Section 3

presents the pruning method and derives what we call the pruned state-space system for DSGE

models whose solution has been approximated to any order. The statistical properties of the pruned

state-space system associated with second- and third-order approximations, including closed-form

expressions for …rst and second unconditional moments, are analyzed in section 4. Section 5 derives

closed-form expressions for IRFs. Section 6 presents a standard New Keynesian model with habits

and Epstein-Zin preferences that we use to examine the numerical accuracy of pruning. The

econometric implications of the pruned state-space system are discussed in section 7. There we also

estimate a New Keynesian DSGE model on post-war US data. Concluding comments are provided

in section 8. Detailed derivations and proofs are deferred to the appendix at the end of the paper.

In addition, a longer technical appendix is available on the authors’home pages or on request.



2    The State-Space System

We consider the following class of DSGE models. Let xt 2 Rnx be a vector of predetermined

state variables, yt 2 Rny a vector of non-predetermined control variables, and      0 an auxiliary

perturbation parameter. The exact solution to the DSGE model is given by a set of decision rules

for the control variables

                                           yt = g (xt ; ) ;                                      (1)

and for the state variables

                                      xt+1 = h (xt ; ) +      t+1 ;                              (2)



                                                  5
where      t+1   contains the n exogenous zero-mean innovations. Initially, we only assume that                 t+1   is

independent and identically distributed with …nite second moments, meaning that no distributional

assumption is imposed and the innovations may therefore be non-Gaussian. This is denoted by

 t+1      IID (0; I). Additional moment restrictions will be imposed in the following sections.4 The

perturbation parameter          scales the square root of the covariance matrix for the innovations                    ,

which has dimension nx n .5 Equation (1) is typically called the observation equation and equation

(2) the state equation. We will refer to (1)-(2) as the exact state-space system.

       DSGE models do not, in general, have closed-form solutions and the functions g (xt ; ) and

h (xt ; ) cannot be found explicitly. The perturbation method is a popular way to obtain Taylor-

series expansions to these functions around the deterministic steady state, that is, at xt = xt+1 =

xss and      = 0 (to simplify the notation, all variables are expressed in deviation from the steady state,

i.e., xss = 0.) Given these Taylor-series expansions, we can set up an approximated state-space

system and simulate the economy, compute conditional or unconditional moments, and evaluate

the likelihood function given some observed data.

       When the functions g (xt ; ) and h (xt ; ) are approximated up to …rst-order, the approximated

state-space system is simply obtained by replacing g (xt ; ) and h (xt ; ) with gx xt and hx xt in

(1) and (2), respectively. Here, gx is an ny          nx matrix with …rst-order derivatives of g (xt ; ) with

respect to xt and hx is an nx          nx matrix with …rst-order derivatives of h (xt ; ) with respect to

xt (by certainty equivalence, the …rst-order derivatives g and h of g (xt ; ) and h (xt ; ) with

respect to        are zero.) Given our assumptions about           t+1 ,   this system has …nite …rst and second

moments if all eigenvalues of hx have modulus less than one. Furthermore, the approximated state-

space system ‡uctuates around the deterministic steady state, which also corresponds to its mean

value. It is therefore straightforward to calibrate the parameters of the model based on …rst and

second moments or to estimate them using standard econometric tools such as Bayesian methods,

maximum likelihood estimation (MLE), GMM, SMM, etc. (see Ruge-Murcia (2007)).

       When the decision rules are approximated beyond …rst-order, we can, in principle, apply the
   4
     Throughout the rest of the paper, unless stated otherwise, the moment requirements refer to the unconditional
moments.
   5
     The assumption that innovations enter linearly in (2) may appear restrictive, but it is without loss of generality
because the state vector can be extended to deal with non-linearities between xt and t+1 . Appendix B provides the
details and an illustration based on the neoclassical growth model with heteroscedastic innovations in the process for
technology shocks.



                                                          6
same method to construct the approximated state-space system. That is, we can replace g (xt ; )

and h (xt ; ) in (1) and (2) with their higher-order Taylor-series expansions. However, the resulting

approximated state-space system cannot, in general, be shown to have any …nite moments and it

often displays explosive dynamics. This occurs, for instance, when we simulate simple versions of

the New Keynesian model with just a few endogenous state variables. Hence, it is di¢ cult to use

the approximated state-space system to calibrate or to estimate the parameters of the model.

    Thus, it is useful to construct an alternative approximated state-space system with well-de…ned

statistical properties to analyze DSGE models. Section 3 explains how this can be done with the

pruning method. Sections 4 and 5 derive the statistical properties of the resulting state-space

system and compute closed-form expressions for …rst and second moments and IRFs.



3     The Pruning Method

In the context of DSGE models whose solution has been approximated up to second-order, Kim,

Kim, Schaumburg and Sims (2008) suggest using a pruning method when constructing the alter-

native approximated state-space system. They show that this system is stable because it preserves

only …rst- and second-order e¤ects when the system is iterated forward in time. Any other e¤ects are

omitted because they do not in general correspond to higher-order terms in a more accurate Taylor-

series expansion. Applying the pruning method is thus di¤erent from simply replacing g (xt ; ) and

h (xt ; ) with their Taylor-series expansions in (1) and (2) because the latter procedure includes all

such higher-order e¤ects.

    In section 3.1, we review the pruning method and explain its logic for second-order approxi-

mations. Section 3.2 extends this method to third-order approximations. The general procedure

for constructing the pruned state-space system associated with any order of approximation is then

outlined in section 3.3. Finally, section 3.4 relates our approach to the existing literature.


3.1   Second-Order Approximation

The …rst step when constructing the pruned state-space system associated with the second-order

approximation is to decompose the state variables into …rst-order e¤ects xft and second-order e¤ects




                                                  7
xst . This can be done starting from the second-order Taylor-series expansion to the state equation


                         (2)       (2) 1    (2)                (2)    1       2
                        xt+1 = hx xt + Hxx xt                 xt     + h          +       t+1 ;                 (3)
                                       2                              2

                                (2)
where we use the notation xt          to represent the unpruned second-order approximation to the state

variable.6 Here, Hxx is an nx          n2x matrix with the derivatives of h (xt ; ) with respect to (xt ; xt )
                                                                                                                (2)
and h       is an nx   1 matrix containing derivatives taken with respect to ( ; ).7 Substituting xt

by xft + xst into the right-hand side of (3) gives

                               1                                              1
                 hx xft + xst + Hxx           xft + xst        xft + xst     + h      2
                                                                                          +       t+1 :         (4)
                               2                                              2

A law of motion for xft+1 is derived by preserving only …rst-order e¤ects in (4). We, therefore, keep

the …rst-order e¤ects from the previous period hx xft and the innovations                     t+1   to obtain


                                            xft+1 = hx xft +         t+1 :                                      (5)


Hence, the expression for xft+1 is the standard …rst-order approximation to the state equation.

Note also that xft+1 is a …rst-order polynomial of f s gt+1
                                                        s=1 . The …rst-order approximation to the

observation equation is also standard and given by


                                                  ytf = gx xft :                                                (6)


Accordingly, the pruned state-space system for a …rst-order approximation to the solution of the

model is given by (5) and (6), meaning that the pruned and unpruned state-space systems are

identical in this case.

       A law of motion for xst+1 is derived by preserving only second-order e¤ects in (4). Here, we

include the second-order e¤ects from the previous period hx xst , the squared …rst-order e¤ects in
   6
     Note that (3) adopts the standard assumption that the model has a unique stable …rst-order approximation,
which implies that all second- and higher-order terms are also unique (see Judd and Guu (1997)).
   7
     The matrix Hxx can be obtained in Matlab by using the reshape function, Hxx = reshape(hxx ; nx ; n2x ), where
hxx is an array of dimension nx nx nx . For instance, the i-th row of Hxx contains all the second-order terms for
the i-th state variable.




                                                          8
the previous period 12 Hxx xft           xft , and the correction 12 h         2.   Hence,

                                                 1                         1
                                 xst+1 = hx xst + Hxx xft             xft + h         2
                                                                                          :                                          (7)
                                                 2                         2

We do not include terms with xft             xst and xst       xst because they re‡ect third- and fourth-order

e¤ects, respectively. It is also worth mentioning that we are treating                                as a variable and not as

a constant when deriving (7), meaning that 21 h                 2   is a second-order e¤ect. Note that xst+1 is a

second-order polynomial in f s gts=1 .

    The …nal step in setting up the pruned state-space system is to derive the expression for the

observation equation. Using the same approach, we start from the second-order Taylor-series

expansion to the observation equation


                                 (2)         (2) 1    (2)               (2)    1          2
                               yt      = gx xt + Gxx xt               xt      + g             ;                                      (8)
                                                 2                             2

           (2)
where yt         denotes the unpruned second-order approximation to the control variable. Here, Gxx is

an ny      n2x matrix with the corresponding derivatives of g (xt ; ) with respect to (xt ; xt ) and g

is an ny         1 matrix containing derivatives with respect to ( ; ). We only want to preserve e¤ects

up to second-order, meaning that

                                                  1                             1
                              yts = gx xft + xst + Gxx xft                 xft + g                2
                                                                                                      :                              (9)
                                                  2                             2

Here, we leave out terms with xft            xst and xst       xst because they re‡ect third- and fourth-order

e¤ects, respectively.8

    Accordingly, the pruned state-space system for a second-order approximation is given by (5),
                                                                                                                    0
                                                                                              0
(7), and (9). The state vector in this system is thus extended to                   xft                   (xst )0       as we separately

need to track …rst- and second-order e¤ects. Another important observation is that all variables

in this system are second-order polynomials of the innovations. The pruning method applied to a

second-order approximation may, therefore, be interpreted as imposing the additional requirement

that all variables in the pruned state-space system are second-order polynomials in the innovations.
  8
    We are treating yts as the sum of the …rst- and second-order e¤ects, while xst is only the second-order e¤ects.
This allows us to simplify the notation.




                                                           9
The unpruned state-space system for a second-order approximation is given by (3) and (8).


3.2    Third-Order Approximation

We now construct the pruned state-space system for third-order approximations. Following the

steps outlined above, we start by decomposing the state variables into …rst-order e¤ects xft , second-
                                                                        f
order e¤ects xst , and third-order e¤ects xrd                                  s
                                           t . The laws of motions for xt and xt are the same as

in the previous section, and only the recursion for xrd
                                                     t remains to be derived. The third-order

Taylor-series expansion to the state equation is (see Andreasen (2012))


                   (3)       (3)   1     (3)     (3)                1      (3)                  (3)       (3)
                  xt+1 = hx xt + Hxx xt       xt                   + Hxxx xt                xt           xt
                                   2                                6
                           1     2   3       (3)               1
                         + h        + h x 2 xt +                 h          3
                                                                                +       t+1 :                                (10)
                           2         6                         6

         (3)
where xt       represents the unpruned third-order approximation to the state variable. Now, Hxxx

denotes an nx      n3x matrix containing derivatives of h (xt ; ) with respect to (xt ; xt ; xt ), h                     x   is an

nx    nx matrix with derivatives with respect to ( ; ; xt ), and h                      is an nx         1 matrix containing

derivatives related to ( ; ; ). We adopt the same procedure as in the previous subsection and

substitute xft + xst + xrd
                        t into the right-hand side of (10) to obtain


                                        1
                    hx xft + xst + xrd
                                    t  + Hxx xft + xst + xrd t                          xft + xst + xrd
                                                                                                     t
                                        2
                      1
                    + Hxxx xft + xst + xrdt     xft + xst + xrd
                                                             t                          xft + xst + xrd
                                                                                                     t
                      6
                      1          3                         1
                    + h     2
                              + h x 2 xft + xst + xrd
                                                    t    + h                        3
                                                                                        +        t+1 :                       (11)
                      2          6                         6

A law of motion for the third-order e¤ects is then derived by preserving only third-order e¤ects in

(11). Using the same line of reasoning as above, we get


                          f               1                                  3                         1
      xrd        rd
       t+1 = hx xt + Hxx xt          xst + Hxxx xft                xft   xf + h             x
                                                                                                2 f
                                                                                                 xt   + h        3
                                                                                                                     :       (12)
                                          6                                  6                         6

As in the derivation of the law of motion for xst in (7),                   is interpreted as a variable when con-

structing (12). This means that 36 h     x
                                             2 xs
                                                t   and 36 h   x
                                                                    2 xrd
                                                                       t    represent fourth- and …fth-order e¤ects,

respectively, and are therefore omitted. Haan and Wind (2010) adopt the opposite approach and



                                                         10
consider         as a constant when deriving the pruned state-space system, meaning that they also
           3          2 xrd
include    6h     x      t    in (12). We prefer to treat       as a variable because it is consistent with the

assumed functional forms for g (xt ; ) and h (xt ; ) and the way the perturbation approximation

is derived. As section 4 shows, interpreting             as a variable is essential for proving that the pruned

state-space system is, in general, stable and has well-de…ned statistical properties. Finally, note
                                              t
that xrd
      t+1 is a third-order polynomial in f s gs=1 .

       The …nal step is to set up the expression for the observation equation. Using results in Andreasen

(2012), the third-order Taylor-series expansion to the observation may be written as


                       (3)          (3)   1     (3)     (3)    1      (3)                 (3)          (3)
                      yt      = gx xt + Gxx xt       xt       + Gxxx xt                 xt            xt
                                          2                    6
                                  1     2   3       (3)     1
                                + g        + g x 2 xt + g        3
                                                                   ;                                                       (13)
                                  2         6               6

           (3)
where yt         represents the unpruned third-order approximation to the control variable. In (13),

Gxxx denotes an ny             n3x matrix containing derivatives of g (xt ; ) with respect to (xt ; xt ; xt ), g               x

is an ny         nx matrix with derivatives with respect to ( ; ; xt ), and g                         is an nx         1 matrix

containing derivatives related to ( ; ; ). Hence, preserving e¤ects up to third-order gives9

                                               1
                   ytrd = gx xft + xst + xrd
                                          t   + Gxx xft                   xft + 2 xft        xst
                                               2
                            1                      1                       3               1
                          + Gxxx xt xt xft + g
                                      f     f                         2
                                                                          + g   x
                                                                                    2 f
                                                                                     xt   + g                  3
                                                                                                                   :       (14)
                            6                      2                       6               6

Thus, the pruned state-space system associated with the third-order approximation is given by (5),
                                                                                                                               0
                                                                                                       0                   0
(7), (12), and (14). The state vector in this system is further extended to                     xft          (xst )0   xrd
                                                                                                                        t
                                                                                                                                   ;

as we need to separately track …rst-, second-, and third-order e¤ects. Also, all variables in this

system are third-order polynomials of the innovations. Hence, the pruning method applied to

a third-order approximation may be interpreted as imposing the requirement that all variables

in the pruned state-space system are third-order polynomials in the innovations. The unpruned

state-space system for a third-order approximation is given by (10) and (13).
   9
    To again simplify notation, we treat ytrd as the sum of the …rst-, second-, and third-order e¤ects, while xrd
                                                                                                               t is
only the third-order e¤ects.




                                                           11
3.3   Higher-Order Approximations

It is straightforward to apply the pruning method and obtain the pruned state-space system for the

kth-order approximation to the model’s solution. Based on the kth-order Taylor-series expansions

of g (xt ; ) and h (xt ; ), the three steps are:

   1. Decompose the state variables into …rst-, second-, ... , and kth-order e¤ects.

   2. Set up laws of motions for the state variables capturing only …rst-, second-, ... , and kth-order

      e¤ects.

   3. Construct the expression for control variables by preserving only e¤ects up to kth-order.

   In comparison, the unpruned state-space system for a kth-order approximation is given by the

kth-order Taylor-series expansions of g (xt ; ) and h (xt ; ).


3.4   Related Literature

Besides Kim, Kim, Schaumburg and Sims (2008), there are a few papers that analyze the pruning

method. Lombardo and Sutherland (2007) use a reasoning similar to ours to derive a second-order

accurate expression for all squared terms in a DSGE model. With this result and standard solution

routines for linearized models, they compute the second-order derivatives of the functions g (xt ; )

and h (xt ; ). Hence, at least up to second-order, Lombardo and Sutherland (2007) show that

pruning is fully consistent with the perturbation method.

   Lan and Meyer-Gohde (2011) employ perturbation to derive nonlinear approximations of g (xt ; )
                                                                                           2 3         t
and h (xt ; ) ; where these functions are expressed in terms of past innovations       s ; s ; s ; ::: s=1 ,

which delivers a stable approximation. As noted above, the pruned approximated state-space sys-

tem may also be expressed as an in…nite moving average in terms of past innovations and is in this

sense similar to the approximation in Lan and Meyer-Gohde (2011).

   Finally, Haan and Wind (2010) highlight two potential disadvantages of pruning. First, the state

vector is larger. Second, a pruned n-th order approximation cannot exactly …t the true solution if

it happens to be an n-th-order polynomial. We do not consider the extended state vector to be a

disadvantage because we …nd it informative to assess how important each of the higher-order e¤ects

is relative to the …rst-order e¤ects and current computing power makes memory considerations less

                                                   12
of a constraint. We view the second disadvantage to be minor because an exact …t can be obtained

by rasing the approximation beyond order n (this point is also noted in Haan and Wind (2010)).

As mentioned above, Haan and Wind (2010) consider                        as a constant when deriving the pruned
                                                                           3                 2 xrd
state-space system, meaning that they would also include                   6h        x          t    in (12). We treat         as a

state variable because it is consistent with the assumed functional forms for g (xt ; ) and h (xt ; )

and the way the perturbation approximation is derived. As we will show below, interpreting                                       as

a state variable is essential for showing that the pruned state-space system in general is stable and

has well-de…ned statistical properties.



4     Statistical Properties of the Pruned System

This section shows that the pruned state-space system has well-de…ned statistical properties and

that closed-form expressions for …rst and second moments can be easily computed. We proceed as

follows. Section 4.1 extends the analysis in Kim, Kim, Schaumburg and Sims (2008) for second-order

approximations. Section 4.2 conducts a similar analysis for third-order approximations. Applying

the steps below to higher-order approximations is conceptually straightforward.


4.1   Second-Order Approximation

It is convenient to consider a more compact representation of the pruned state-space system than

the one in section 3.1. To do so, we introduce the vector

                                                                                         0
                                (2)                0                             0
                               zt           xft          (xst )0   xft     xft               ;


                                                                                                              (2)
where the superscript denotes the approximation order. The …rst nx elements in zt                                   are the …rst-
                                                  (2)
order e¤ects, while the remaining part of zt            contains second-order e¤ects. The laws of motion for
                                                                                                                         (2)
xft and xst are stated above and the evolution for xft             xft is easily derived from (5). Given zt , the

laws of motion for the …rst- and second-order e¤ects in (5) and (7) can be rewritten as a linear law
              (2)
of motion in zt :


                                      (2)               (2)         (2)
                                    zt+1 = A(2) zt + B(2)           t+1   + c(2) ;                                             (15)



                                                              13
where                         2                                       3                2                                 3
                              6                   0                   7                6 hx 0    0                       7
                              6                                       7                6                                 7
                    c   (2)   6              1         2              7    A   (2)     6 0 h   1                         7;               (16)
                              6              2h                       7                6     x 2 Hxx                     7
                              4                                       5                4                                 5
                                  (               ) vec (Ine )                           0 0 hx hx

and
                                                                                             2                                     3
              2                                                            3                                      t+1
                              0               0                   0                          6                                     7
              6                                                            7                 6                                     7
              6                                                            7                 6                          vec (Ine ) 7
              6 0                                                          7         (2)     6    t+1           t+1                7
       B(2)   6               0               0                   0        7         t+1     6                                     7:     (17)
              4                                                            5                 6                           f         7
                                                                                             6                  t+1     xt         7
                0                                     hx hx                                  4                                     5
                                                                                                        xft           t+1


                                                                                                        (2)
Also, the law of motion in (9) can be written as a linear function of zt :


                                                                           (2)
                                                           yts = C(2) zt + d(2) ;                                                         (18)


where
                                                                                                 1
                                      C(2)            gx gx           1
                                                                      2 Gxx
                                                                                      d(2)         g    2
                                                                                                            :                             (19)
                                                                                                 2

Standard properties for the Kronecker product and block matrices imply that the system in (15)

is stable with all eigenvalues of A(2) having modulus less than one, provided the same holds for

hx . This result might also be directly inferred from (5) and (7) because xft is stable by assumption

and xst is constructed from a stable process and the autoregressive part of xst is stable. The system
                                                            (2)
has …nite …rst and second moments if                        t+1   has …nite second moments. The latter is equivalent to

 t+1   having …nite fourth moments. These results are summarized in the next proposition, with the

proof given in appendix C.

Proposition 1 If all eigenvalues of hx have modulus less than one and                                                   t+1   has …nite fourth

moments, the pruned state-space system de…ned by (5), (7), and (9) - or equivalently by (15) and

(18) - has …nite …rst and second moments.

   Proposition 1 implies that explosive sample paths do not appear in the pruned state-space

system (almost surely). Proposition 1 also holds for models with deterministic and stochastic

trends, provided trending variables are appropriately scaled (see King and Rebelo (1999)).

                                                                          14
   The representation in (15) and (18) makes it straightforward to derive additional statistical

properties for the system. Importantly, the pruned state-space system has …nite third and fourth
               (2)
moments if     t+1   has …nite third and fourth moments, respectively. The latter is equivalent to

 t+1   having …nite sixth and eighth moments, respectively. We highlight these results in the next

proposition, with the proof provided in appendix D.


Proposition 2 If all eigenvalues of hx have modulus less than one and                        t+1   has …nite sixth and

eighth moments, the pruned state-space system de…ned by (5), (7), and (9) - or equivalently by (15)

and (18) - has …nite third and fourth moments, respectively.


   The next step is to …nd the expressions for …rst and second moments of the pruned state-space
                                                    (2)
system in (15) and (18). The innovations t+1 are a function of xft ;                 t+1 ;   and   t+1    t+1 ,   and we
                    h     i
                      (2)                           (2)
directly have that E t+1 = 0. Hence, the mean of zt is

                                    h     i                             1
                                      (2)
                                   E zt     = I2nx +n2x         A(2)        c(2) :                                  (20)

                                               h     i
                                                 (2)
We explicitly compute some of the elements in E zt     to obtain intuition for the determinants of

the mean of the pruned state-space system. The mean of xft is easily seen to be zero from (5).

Equation (7) implies that the mean of xst is

                                                     1      h             i 1
                         E [xst ] = (I   hx )   1
                                                       Hxx E xft       xft + h         2
                                                                                             :                      (21)
                                                     2                      2

Adding the mean value for the …rst- and second-order e¤ects, we obtain

                                                 h i
                                                E xft + E [xst ] ;                                                  (22)


which is the mean value of the state variables in the pruned state-space system associated with

the second-order approximation. Equations (21) and (22) show that second-order e¤ects E [xst ]

correct the mean of the …rst-order e¤ects to adjust for risk. The adjustment comes from the second

derivative of the perturbation parameter h                and the mean of xft        xft . The latter term can be




                                                           15
computed from (5) and is given by

                                 h              i
                                E xft        xft = (I          hx          hx )       1
                                                                                          (           ) vec (Ine ) :

               h i
The fact that E xft = 0 and E [xst ] 6= 0 shows that the mean of a …rst-order approximation is the

steady state, while the mean of the pruned state-space system associated with the second-order

approximation is corrected by the second moment of the innovations. Hence, the mean of the

ergodic distribution implied by the pruned state-space system for any variable of interest will, in

most cases, di¤er from its value in the deterministic steady state. Thus, we cannot, in general, use

the steady state to calibrate and/or estimate the pruned system.

     Let us now consider second moments. Standard properties of a VAR(1) system imply that the
                                             (2)
variance-covariance matrix for zt                  is given by


                         (2)                                                                  1                   (2)              0
            vec V zt                  = I(2nx +n2 )2            A(2) A(2)                         vec B(2) V      t         B(2)         ;        (23)
                                                    x




or
                                      (2)                     (2)                 0                    (2)              0
                          V zt              = A(2) V zt                   A(2)        + B(2) V         t       B(2)                               (24)

            (2)         (2)
because zt        and   t+1    are uncorrelated as                  t+1   is independent across time. Appendix C explains
                              (2)                                                                                                  (2)
how to calculate V            t       , a rather direct yet tedious exercise. Once we know V                                       t         , we solve
          (2)
for V zt          by standard methods for discrete Lyapunov equations.
                                                        (2)
     Our procedure for computing V zt                          di¤ers slightly from the one in Kim, Kim, Schaumburg
                                                                                                                            (2)
and Sims (2008). They suggest using a second-order approximation to V                                                       t      by letting the
                               (2)
last n2x elements in           t      be zero. This eliminates all third- and fourth-order terms related to

 t+1   and seems inconsistent with the fact that A(2) A(2) contains third- and fourth-order terms.
                                                     (2)                                                                                           (2)
We therefore prefer to compute V                     t        without further approximations, implying that V zt

corresponds to the sample moment in a long simulation using the pruned state-space system. Thus,

combining …rst- and second-order e¤ects, we have that the variance of the state variables in the

pruned state space system related to the second-order approximation is


                                     V xft + V (xst ) + Cov xft ; xst + Cov xst ; xft :


                                                                          16
                                       (2)
   The auto-covariances for zt               are easily shown to be


                                      (2)      (2)                       l          (2)
                             Cov zt+l ; zt             = A(2)                V zt               for l = 1; 2; 3; :::


         (2)         (2)
because zt     and   t+l   are uncorrelated for l = 1; 2; 3; :::, given that                                  t+1   is independent across time.

   Finally, closed-form expressions for all corresponding moments related to yts follow directly from
                                                        (2)
the linear relationship between yts and zt                    in (18). That is,

                                                                 h     i
                                                                   (2)
                                                E [yts ] = C(2) E zt + d(2) ;

                                                                                                  0
                                                   V [yts ] = C(2) V [zt ] C(2)                       ;

and
                                                                   (2)        (2)                     0
                     Cov yts ; yt+l
                                s
                                    = C(2) Cov zt+l ; zt                                  C(2)            for l = 1; 2; 3; :::


4.2   Third-Order Approximation

As we did for the second-order approximation, we start by deriving a more compact representation

for the pruned state-space system than the one in section 3.2. This is done based on the vector

                                                                                                                                          0
             (3)              0                               0                0                          0                         0
          zt           xft        (xst )0      xft      xft             xrd
                                                                         t                xft     xst          xft      xft   xft             ;        (25)


                                             (2)
where the …rst part reproduces zt                   and the last three components denote third-order e¤ects. The
                                                                     f
law of motion for xrd
                   t was derived in section 3.2, and recursions for xt                                               xst and xft    xft           xft follow

from (5) and (7). Hence, the law of motion for xft , xst , and xrd
                                                                t in (5), (7), and (12), respectively,

can be represented by a VAR(1) system


                                              (3)                 (3)                 (3)
                                             zt+1 = A(3) zt + B(3)                    t+1       + c(3) :                                               (26)


                                                                                    (3)
We also have that the control variables are linear in zt :


                                                                             (3)
                                                      ytrd = C(3) zt + d(3) :                                                                          (27)




                                                                        17
                                              (3)
The expressions for A(3) , b(3) ,             t+1 ,   C(3) , and d(3) are provided in appendix E.

    Appendix F shows that the system in (26) is stable, with all eigenvalues of A(3) having modulus

less than one, provided the same holds for hx . Building on the intuition from the second-order

approximation, this result follows from the fact that the new component of the state vector xrd
                                                                                             t is

constructed from stable processes and its autoregressive component is also stable. The stability of

xrd
 t relies heavily on          being treated as a variable when setting up the pruned state-space system.
                                                                                                          3         2 xrd
If, instead, we had have followed Haan and Wind (2010) and included the term                              6h    x      t    in
                                                                                     3
the law of motion for xrd          rd
                       t+1 , then xt+1 would have had the autoregressive matrix hx + 6 h                                x
                                                                                                                            2


which may have eigenvalues with modulus greater than one even when hx is stable. Moreover, the
                                                                                  (3)
system in (26) and (27) has …nite …rst and second moments if                      t+1   has …nite second moments. The

latter is equivalent to       t+1   having …nite sixth moments. These results are summarized in the next

proposition, with the proof given in appendix F.


Proposition 3 If all eigenvalues of hx have modulus less than one and                          t+1   has …nite sixth mo-

ments, the pruned state-space system de…ned by (5), (7), (12), and (14) - or equivalently by (26)

and (27) - has …nite …rst and second moments.

                                                                                                                      (3)
    The representation in (26) and (27) of the pruned state-space system and the fact that                            t+1   is

a function of     t+1       t+1         t+1   make it straightforward to derive additional statistical properties

for the system, with the proof provided in appendix G.


Proposition 4 If all eigenvalues of hx have modulus less than one and                          t+1   has …nite ninth and

twelfth moments, the pruned state-space system de…ned by (5), (7), (12), and (14) - or equivalently

by (26) and (27) - has …nite third and fourth moments, respectively.


    The next step is to explicitly compute the …rst and second moments of the pruned state-space
                                                                                                       (3)
system de…ned by (26) and (27). According to appendix E, the innovations                               t+1   in (26) are a
                                                                                                         h        i
                                                                                                              (3)
function of xft , xst ,   t+1 ,   t+1         t+1 ,   and   t+1   t+1   t+1 .   Hence, we have that E         t+1 = 0 and


                                         h     i                                  1
                                           (3)
                                        E zt     = I3nx +2n2x +n3x       A(3)         c(3) :                           (28)


It is interesting to explore the value of E xrd
                                             t  as it may change the mean of the state variables.


                                                                  18
From (12), we immediately have

        h i                                   h             i 1      h                     i 1
       E xrd
          t  = (Inx           hx )   1
                                         Hxx E xft       xst + Hxxx E xft        xft    xft + h                3
                                                                                                                   ;           (29)
                                                              6                              6

and simple algebra gives

                       h         i                                         1      h                      i
                                                              1
                      E xft   xst = In2x       (hx    hx )            hx     Hxx E xft      xft    xft                         (30)
                                                                           2

and

       h                   i
                                                              1
      E xft     xft     xft = In3x       (hx    hx    hx )        (               )E[    t+1      t+1          t+1 ] :         (31)


Adding the mean value for the …rst-, second- and third-order e¤ects, we obtain

                                                h i                h i
                                               E xft + E [xst ] + E xrd
                                                                     t  ;                                                      (32)


which is the mean value of the state variables in the pruned state-space system associated with

the third-order approximation. If we next consider the standard case where all innovations have

symmetric probability distributions and hence zero third moments, then E [ t+1                           t+1           t+1 ]   = 0;
                       h              i           h       i
which in turn implies E xft xft xft = 0 and E xft xst = 0. Furthermore, h                                      and g            are

also zero based on the results in Andreasen (2012) when all innovations have symmetric probability

distributions. Thus E xrd
                       t  = 0: As a result, the mean of the state vector is not further corrected

by the third-order e¤ects when all innovations have zero third moments. A similar property holds
                                                                      f
for the control variables because they are a linear function of xrd
                                                                 t , xt                xst , and xft     xft       xft . On the

other hand, if one or several innovations have non-symmetric probability distributions, then h

and g         may be non-zero and E xrd
                                     t  6= 0, implying that the mean has an additional correction

for risk by the third-order e¤ects. These results are summarized in the next proposition.

Proposition 5 If all third moments of                t    are zero, the mean values in the pruned state-space

system de…ned by (5), (7), (12), and (14) - or equivalently by (26) and (27) - are identical to those

in the pruned state-space system de…ned by (5), (7), and (9) - or equivalently by (15) and (18).

   This proposition is useful when calibrating or estimating DSGE models with symmetric prob-

                                                             19
ability distributions because it shows that the third-order e¤ects do not a¤ect the mean of the

variables of interest.

       Let us now consider second moments. The expression for the variance-covariance matrix of the
 (3)                                                                        (2)                         (3)                                 (3)
zt     is slightly more complicated than the one for zt                           because zt                  is correlated with            t+1 .   This
                                                                                          (3)
correlation arises from terms of the form xft                   t+1         t+1    in     t+1       which are correlated with elements
       (3)
in zt . Hence,


                   (3)                       (3)                0                       (3)                    0
               V zt       = A(3) V zt                    A(3)       + B(3) V            t           B(3)
                                                   (3)    (3)                 0                               (3)    (3)            0
                                 A(3) Cov zt ;            t+1        B(3)         + B(3) Cov                  t+1 ; zt      A(3)        :           (33)


                                (3)                       (3)    (3)
The expressions for V           t     and Cov             t+1 ; zt         are provided in appendix F. Thus, combining

…rst-, second-, and third-order e¤ects, we have that the variance of the state variables in the pruned

state space system related to the third-order approximation is:


                      V xft + V (xst ) + V xrd
                                            t  + Cov xft ; xst + Cov xft ; xrd
                                                                            t

                      +Cov xst ; xft + Cov xst ; xrd
                                                  t  + Cov xrd   f        rd   s
                                                            t ; xt + Cov xt ; xt :


                                      (3)
       The auto-covariances for zt          are

                                              s    h     i P                              s 1 j
                    (3)   (3)                        (3)                                                                   (3)      (3)
             Cov zt+s ; zt       = A(3)           V zt + sj=01 A(3)                                     B(3) Cov           t+1+j ; zt


                                                          (3)    (3)
for s = 1; 2; 3; ::: The derivation of Cov                t+l ; zt         for l = 1; 2; 3; ::: is given in appendix F.

       Finally, closed-form expressions for all corresponding moments related to ytrd follow directly
                                                                    (3)
from the linear relationship between ytrd and zt                          in (27) and are given by

                                              h i           h     i
                                                              (3)
                                             E ytrd = C(3) E zt + d(3) ;

                                             h i           h     i                              0
                                                             (3)
                                            V ytrd = C(3) V zt     C(3)                             ;

and
                                                                    (3)     (3)                 0
                      Cov ytrd ; yt+l
                                  rd
                                      = C(3) Cov zt+l ; zt                          C(3)                for l = 1; 2; 3; ::



                                                                     20
5     Impulse Response Functions

Another fruitful way to study the properties of DSGE models is to look at their IRFs. For the

…rst-order approximation, these functions have simple expressions where the e¤ects of shocks are

scalable, symmetric, and independent of the state of the economy. For higher-order approxima-

tions, no simple expressions exist for these functions and simulation is typically required. This

section shows that the use of the pruning method allows us to derive closed-form solutions for these

functions and hence avoid the use of simulation.

    Throughout this section, we consider the generalized impulse response function (GIRF) pro-

posed by Koop, Pesaran and Potter (1996). The GIRF for any variable in the model var (either a

state or control variable) in period t + l to a shock of size                 in period t + 1 is de…ned as


                       GIRFvar (l; ; wt ) = E [vart+l jwt ;          t+1   = ]     E [vart+l jwt ] ;               (34)


where wt denotes the required state variables in period t. As we will see below, the content of wt

depends on the number of state variables in the model and the approximation order.


5.1    Second-Order Approximation

The derivation uses the pruned state-space system for a second-order approximation given by (5),

(7), and (9). We start by deriving the GIRF for the state variables. The GIRF for the …rst-order

e¤ects xft is just

                                     h                               i      h          i
                     GIRFxf (l; ) = E xft+l jxft ;         t+1   =         E xft+l jxft = hlx      1
                                                                                                          :        (35)


This GIRFxf is una¤ected by the state variable xft because it enters symmetrically in the two

conditional expectations in (35).

    For the second-order e¤ects xst , we have from (7) that

                                     lP1                                                     lP1
                                                 1 j1                           1
                 xst+l = hlx xst +         hxl          Hxx xft+j        xft+j + h       2
                                                                                                   hlx   1 j
                                                                                                               :   (36)
                                     j=1            2                           2            j=0




                                                             21
The GIRF for xft       xft is derived in appendix H, showing that


      GIRFxf    xf     l; ; xft          = hlx xft              hlx   1
                                                                                    + hlx    1
                                                                                                          hlx xft

                                                + hlx       1
                                                                      hlx   1
                                                                                     (                )     Et        t+1            t+1   :   (37)


Using this expression and (36), we then get

                                                          lP1
                                                                          1 j1
                     GIRFxs l; ; xft                 =           hlx                Hxx GIRFxf            xf    j; ; xft :                     (38)
                                                          j=1                   2

Expressions (37)-(38) reveal three interesting implications. First, the GIRF for the second-order

e¤ect is not scalable as GIRFxf                xf    l;           ; xft         6=           GIRFxf        xf    l; ; xft    for     2 R. Second,

the term (             ) implies that the IRF for xst is not symmetric in positive and negative shocks.

Third, xft enters in the expression for GIRFxs , meaning that it depends on the …rst-order e¤ects

of the state variable. Adding the GIRF for the …rst- and second-order e¤ects, we obtain


                                          GIRFxf (l; ) + GIRFxs l; ; xft ;                                                                     (39)


which is the pruned GIRF for the state variables implied by the pruned state-space system associ-

ated with the second-order approximation.

   Finally, the pruned GIRF for the control variables is easily derived from (8) and previous results


              GIRFys l; ; xft                   = gx GIRFxf l; ; xft + GIRFxs l; ; xft
                                                          1
                                                         + Gxx GIRFxf                    xf       l; ; xft :                                   (40)
                                                          2


5.2   Third-Order Approximation

To derive the GIRF’s at third order, we use the pruned state-space system in (5), (7), (12), and

(14). To obtain GIRF in this case we need the GIRF for xrd
                                                        t . Using (12), we …rst note that


                                   lP1                                                  1
       xrd     l rd
        t+l = hx xt +                    hlx   1 j
                                                         Hxx xft+j               xst+j + Hxxx xft+j                    xft+j       xft+j
                                   j=0                                                  6
                       lP1                 3                           1
                                                          2 f
                   +         hxl   1 j
                                             h       x     xt+j       + h                3
                                                                                              :                                                (41)
                       j=0                 6                           6


                                                                          22
Simple algebra then implies

                                            lP1
           GIRFxrd l; ; xft ; xst     =           hxl   1 j
                                                              Hxx GIRFxf         xs   j; ; xft ; xst
                                            j=1
                                                lP1
                                                            1 j1
                                            +         hlx          Hxxx GIRFxf         xf xf      j; ; xft
                                                j=1            6
                                                lP1
                                                            1 j3
                                            +         hlx          h   x
                                                                           2
                                                                               GIRFxf (j; ) :                       (42)
                                                j=1            6


All terms are known except for GIRFxf       xs     j; ; xft ; xst          and GIRFxf         xf xf     j; ; xft . The

derivations of these terms is deferred to appendix I because it is notationally demanding. As it was

the case for the second-order approximation, the GIRF for the third-order e¤ect is not scalable, not

symmetric, and depends on the …rst-order e¤ects of the state variable xft . Note that the GIRF for

the third-order e¤ects also depends on xst because it a¤ects GIRFxf                    xs   j; ; xft ; xst    . Adding

the GIRF for the …rst-, second-, and third-order e¤ects, we obtain


                 GIRFxf (l; ) + GIRFxs l; ; xft + GIRFxrd l; ; xft ; xst                            ;               (43)


which is the pruned GIRF for the state variables implied by the pruned state-space system associ-

ated with the third-order approximation..

   The pruned GIRF for the control variables in a third-order approximation is


GIRFyrd l; ; xft ; xst       = gx GIRFxf (l; ) + GIRFxs l; ; xft                        + gx GIRFxrd l; ; xft ; xst
                                 1
                                + Gxx GIRFxf xf l; ; xft + 2GIRFxf                           xs    l; ; xft ; xst
                                 2
                                 1
                                + Gxxx GIRFxf xf xf l; ; xft
                                 6
                                 3
                                + g x 2 GIRFxf (l; )                                                                   (44)
                                 6

where all terms are known.




                                                      23
6     Accuracy of Pruning

Kim, Kim, Schaumburg and Sims (2008) argue that pruning should improve accuracy because the

omitted terms do not in general correspond to higher-order terms in a more accurate Taylor-series

expansion. However, Kim, Kim, Schaumburg and Sims (2008) do not provide numerical evidence to

support this statement. To …ll this gap, this section examines the accuracy of the pruning method

in the case of a standard New Keynesian model, a basic workhorse of modern macroeconomics

and widely used for policy analysis. We proceed as follows. A brief presentation of the model is

provided in section 6.1, with additional details given in appendix J. Section 6.2 describes how Euler

equation errors are computed. Section 6.3 reports results from our numerical exercise, which show

that, in general, pruning improves accuracy.


6.1   A New Keynesian Model

The speci…c version of the considered New Keynesian model is chosen based on two requirements.

First, we want a model with sizable higher-order terms, as this allow us to see any potential di¤er-

ences between simulating the model using the pruned and unpruned state-space system. Second,

the model should not generate explosive sample paths when it is simulated using the unpruned

state-space system; otherwise any accuracy tests would trivially favor a pruned approximation.

To meet the …rst objective, we include habit formation and Epstein-Zin preferences, which also

help the New Keynesian model in matching various macro and …nancial moments (Christiano,

Eichenbaum and Evans (2005), Hordahl, Tristani and Vestin (2008), and Binsbergen, Fernandez-

Villaverde, Koijen and Rubio-Ramirez (2012)). The second requirement is met by modelling sticky

prices as in Rotemberg (1982). This speci…cation does not introduce an extra endogenous state

variable as with Calvo contracts. The absence of this state variable turns out to be essential for

generating non-explosive sample paths using the unpruned state-space system. Of course, it should

be emphasized that we cannot prove that the model without pruning is stable. Instead, we rely on

extensive simulation experiments and discard the (very few) explosive paths. This implies that the

results are biased in favor of the unpruned state-space system.




                                                 24
6.1.1       Households

We assume a representative household with Epstein-Zin preferences (Epstein and Zin (1989)). Using

the formulation in Rudebusch and Swanson (2012), the value function Vt is given by

                               8                         h       i 1
                               >
                               <                            1      1 3
                                            ut +       Et Vt+1 3                                if ut > 0 for all t
                       Vt                             h            i                   1                                                             (45)
                               >
                               : ut                 Et ( Vt+1 )1 3
                                                                     1                     3
                                                                                                if ut < 0 for all t


As Rudebusch and Swanson (2012), we let the periodic utility function display separability between

consumption ct and hours worked ht

                                                             1
                                            (ct      bct   1)
                                                                     2                              (1       ht )1      1
                             ut        dt            1
                                                                          + (zt )(1        2)
                                                                                                0                           :                        (46)
                                                           2                                             1          1


Here, b is the parameter governing the internal habit formation and dt is a preference shock where


                                                    log dt+1 =            d log dt   +     d;t+1



and   d;t   s IID 0;   2
                       d    . The variable (zt )(1                   2)   controls the deterministic trend in the economy and

will be further speci…ed below. Scaling the second term in (46) by (zt )(1                                                      2)   ensures the presence

of a balanced growth path and can be justi…ed based on home production (see Rudebusch and

Swanson (2012) for further details).

   The budget constraint at time t reads

                                            Z
                                  it                                                                          xt
                        ct +           +          Dt;t+1 xt+1 d! t;t+1 = wt ht + rtk kt +                            + divt :                        (47)
                                   t                                                                            t


Resources are spent on consumption, investment it ; and on a portfolio of state-contingent claims

Xt+1 for the next period, which pay one unit of cash given events ! t;t+1 . These claims are sold at

prices Dt;t+1 , meaning that their real costs are

                                       R                                        Z
                                           Dt;t+1 Xt+1 d! t;t+1
                                                                =                   Dt;t+1 xt+1 d! t;t+1
                                                   Pt

where xt+1       Xt+1 =Pt . The variable                       t   denotes a deterministic trend in the real relative price



                                                                           25
of investment, that is, log        t+1   = log     t   + log           ;ss .    Letting wt denote the real wage and rtk the

real price of capital kt , resources consist of i) real labor income wt ht , ii) real income from capital

services sold to …rms rtk kt , iii) real payo¤s from state-contingent claims purchased in the previous

period xt = t , and iv) dividends from …rms divt . Here,                            t   is gross in‡ation, i.e.              t   Pt =Pt   1.

      The law of motion for kt is given by

                                                                                                        2
                                                                                        ii
                                    kt+1 = (1          ) kt + it                                            kt ;                               (48)
                                                                               2        kt

where           0 introduces capital adjustment costs based on ii =kt as in Jermann (1998). The constant

  ensures that these adjustment costs are zero in the steady state.


6.1.2     Firms

A perfectly competitive representative …rm produces …nal output using a continuum of intermediate

goods yi;t and the production function

                                                       Z    1                           =(        1)
                                                                 ( 1)=
                                           yt =                 yi;t           di
                                                        0


                                                                                       Pi;t
with     > 1. This generates the demand function yi;t =                                Pt              yt , with aggregate price level:

                                                        Z       1                  1=(1       )
                                                                      1
                                            Pt =                    Pi;t di                       :
                                                            0


      The intermediate goods are produced by monopolistic competitors using the production function


                                                 yi;t = at ki;t (zt hi;t )1                   :                                                (49)


Here, zt is a deterministic trend that follows log zt+1 = log zt + log                                        z;ss ,   and


                                            log at+1 =               a log at      +      a;t+1



where           s IID 0;    2   . As in Altig, Christiano, Eichenbaum and Linde (2011), we de…ne zt
          a;t               a
  1
 t     zt , which denotes the degree of technological process in the economy.


                                                                     26
    The intermediate …rms maximize the net present value of real pro…t with respect to capital,

labor, and prices. Following Rotemberg (1982), …rms face quadratic price adjustment costs                                                 p        0

in relation to steady-state in‡ation                      ss .   Hence, the i-th …rm solves

                          1
                                              "                                                                                                #
                          X                       Pi;t+j                                                     p     Pi;t+j 1         2
      max            Et         Dt;t+j Pt+j              yi;t+j       rtk ki;t+j          wt+j hi;t+j                           1       yt+j
  hi;t ;ki;t ;Pi;t                                Pt+j                                                      2     Pi;t+j 1 ss
                          j=0


                                Pi;t
subject to yi;t =               Pt      yt and (49).


6.1.3       Monetary Authority

A monetary authority conducts monetary policy using a Taylor rule of the form


                                                                                              t                     yt
                                rt;1 = (1     r ) rss   +    r rt 1;1     +         log           +     y   log            ;                  (50)
                                                                                             ss                   zt Yss

where rt;1 is the continuously compounded one-period net nominal interest rate. The output gap

is here measured in terms of output in deviations from its deterministic trend, which is equal to zt

times the output in the normalized steady state Yss (see appendix J).


6.1.4       Solution

To use the perturbation method, all trending variables must be transformed into stationary vari-

ables. We generally adopt the convention of letting capital letters represent transformed variables.

For instance, Ct is the transformed consumption level. The only exception is the value function,

where the transformed variable is denoted by V~t . After appropriate transformations to remove

non-stationary variables, the model can be written in 18 equations where the control vector yt
                                                                h       i
                                                                    1
contains the following 13 variables: Ct , rt;1 , t , ht , t , Et V~t+1 3 , It , Yt , Qt , V~t , Wt , Rtk , and mct .

The variables              t,   Qt , and mct are Lagrange multipliers related to (47), (48), and (49), respectively.

The state vector xt has …ve elements: rt                          1;1 ,   Ct   1,   Kt , at , and dt . Finally, the innovation          t+1    has

two elements,             d;t+1   and   a;t+1 .




                                                                               27
6.2     Euler Equation Errors

As shown in appendix J, the equilibrium conditions for our model can be expressed by the vector-

function f ( )

                                            Et [f (xt ; xt+1 ; yt ; yt+1 )] = 0:                                       (51)

If we insert sample paths implied by any approximated decision rules in (51), then each of the

equations in (51) will not in general equal zero. This di¤erence is referred to as Euler equation

errors and can be used to evaluate the performance of a given approximation. In this section we

use the Euler equation errors to compare the accuracy of pruned and unpruned state-space systems

associated with di¤erent orders of approximation.

     In general the errors depend on the value of state variables. A standard strategy when eval-

uating these Euler equation errors is to plot the errors for di¤erent values of the state variables.

However, this procedure is not appropriate in our context because, in general, the pruned and

unpruned state-space system have di¤erent state variables. Instead, the following procedure is

adopted. We …rst …x a sequence of innovations f t gTt=1       =1;000
                                                                     and use it to simulate the pruned systems
n                                  oT =1;000                           n                                            o
                                                                           (1)    (2)    (3)     (1)     (2)     (3) T =1;000
 xft ; xst ; xrd
              t  ; yt
                     f
                       ; y s ; yrd
                           t    t            and the unpruned systems    x t   ; xt   ; xt   ; yt    ; y t   ; yt
                               t=1                                                                                  t=1
starting at the steady state after a burn-up. These time series are then substituted into (51) to

…nd the Euler equation errors in a given period, where any conditional expectations are evaluated

by simulating 5; 000 realizations using the pruned and unpruned state-space systems, respectively.

Note that we do not need to normalize the Euler equation errors into dollar terms because we only

want to compare the relative accuracy of the two approximated systems.


6.3     Accuracy Results

Table 1 reports the values of parameters used for our accuracy test. Although most values are

fairly standard, table 1 is not a formal calibration, as several parameters are chosen to get strong

non-linearities in the model as required to examine the accuracy of the pruning method. A proper

statistical evaluation of the model will be performed in the next section. In relation to the calibra-

tion, we highlight the following decisions. The price adjustment coe¢ cient                     p   is chosen to match a

Calvo parameter of 0:75 for a linearized model. To select the values for the preference parameters

 2   and   3,   we rely on the results in Swanson (2012a), who extends existing formulas for relative


                                                             28
risk aversion to account for a variable labor supply. Given our utility function, we have


                                                   2                              1        2
                       RRAc =             1                          +   31 b 1                                ;                        (52)
                                  1 b z           wss (1 hss )                        wss (1 hss ) 1
                                   1 b        +        css
                                                                 2           z
                                                                           1 b    +        css     1
                                                                                                           2
                                                                 1                                         1



when measuring household wealth by the present value of life time consumption.10 Given the values
              1 b z1
in table 1,    1 b     t 1 and wss (1         hss ) =css equals approximately 1.3, making                          2   and       3   the key

determinants behind risk aversion. We select a relatively low value for                            2   (       2   = 2) and instead

introduce strong non-linearities into the model by having                     3   =     100. This gives a high relative

risk aversion of RRAc = 60.


                                                  < Table 1 about here >


       The …rst block of rows in table 2 displays the root mean squared Euler equation errors (RMSEs)

for each of the nine model equilibrium conditions.11 At second-order, the RMSEs implied by the

pruned system are smaller than the ones implied by the unpruned ones in four of the nine equations.

This is emphasized in table 2 by bold …gures. When computing the mean RMSEs across all nine

equations, we …nd that pruning delivers better accuracy. The improved performance of pruning is

more visible at third-order where it outperforms the unpruned approximation in eight of the nine

equations. As a result, the mean RMSEs across all nine equations with pruning are clearly smaller.

Table 2 also shows that a third-order approximation delivers higher accuracy than a second-order

approximation and a second-order approximation delivers, on average, higher accuracy than a

…rst-order approximation. The remaining part of table 2 shows that these results are robust to

considering highly persistent shocks (              d   =   a    = 0:98) and large innovations (                   d   =     a   = 0:03).

Both deviations from the benchmark speci…cation take the sample path further away from the

approximation point (the steady state) and therefore constitute more challenging cases than our

benchmark speci…cation.


                                                  < Table 2 about here >
  10
     This de…nition of relative risk aversion is preferred to the one where wealth is measured by the present value of
consumption and leisure because Swanson (2012b) shows that the measure in (52) displays the highest correlation
with the equity premium in a similar model.
  11
     We leave out the following log-linear relations that, by construction, all have zero model errors: …rm’s …rst-order
condition for labor and capital, the Taylor rule, and the production function.



                                                                 29
    From this analysis, we conclude that pruning does improve accuracy. These results are, by

construction, model-speci…c and dependent on the chosen calibration. However, both the model

and the calibration are fairly standard and we therefore conjecture that our results are representative

of a large class of DSGE models of interest.



7    Econometric Implications of the Pruning Method: An Applica-

     tion to Asset Pricing

The econometric implications of our derivations in sections 4 and 5 are signi…cant because various

moment matching methods used in linearized DSGE models now carry over to non-linear approx-

imations. For approximations up to third-order, this includes GMM estimation (Hansen (1982))

based on …rst and second moments of the variables. The work by Kim (2002) shows how optimal

GMM estimation may be used to build a so-called limited information likelihood (LIL) function.

Equipped with priors, we may then carry out standard Bayesian analysis from the LIL function,

where the asymptotic distribution for the posterior equals the limiting distribution of GMM. Hence,

our closed-form expressions for …rst and second moments for approximations up to third-order may

also be relevant to a Bayesian researcher.

    Another possibility is to match model-implied IRFs to their empirical counterparts as is done

in Christiano, Eichenbaum and Evans (2005) for a linearized model. For the case of non-linear

approximations, the empirical IRFs should not be computed from an SVAR model because it

restricts these functions to be scalable, symmetric, and independent of the state of the economy.

None of these assumptions are imposed in the ‡exible projection method by Jorda (2005), which

therefore is promising when DSGE models are solved with non-linear terms.

    All these econometric methods are attractive because we can now easily compute …rst and second

moments or any IRFs in medium-sized DSGE models whose solution has been approximated to

third-order. If we want to use higher-order moments such as skewness and kurtosis in estimation,

then simulations are needed. While it is possible to compute closed-form expressions for skewness

and kurtosis in DSGE models when the pruning method is applied, the memory requirement for

such computations are extremely large and therefore only applicable to small models with a few

state variables. But even if we simulate to get around this memory limitations, our analysis provides


                                                  30
the foundation for SMM following Du¢ e and Singleton (1993) and indirect inference as considered

in Smith (1993), Dridi, Guay and Renault (2007), Creel and Kristensen (2011), among others.12

       Our results greatly simplify the computational burden required for the implementation of these

econometric methods while using higher-order approximations, but they also make a theoretical

contribution. This is because without adopting the pruning method, we do not know if any moments

exist and the asymptotic distributions for all the aforementioned estimators cannot, in general, be

adopted. To realize this, recall that the limiting distributions for GMM and SMM require stationary

processes, or processes that can be transformed to be stationary, but this property cannot be ensured

in non-linear approximations without the use of the pruning method.13

       To illustrate some of these points, we estimate the model in section 6.1 with GMM and SMM

using macroeconomic and …nancial data for the US economy from 1961Q3 to 2007Q4. To make

our model slightly more standard, we abandon the quadratic price adjustment costs and instead

consider staggered pricing as in Calvo (1983). That is, we now assume that a fraction                           2 [0; 1[

of randomly chosen …rms cannot set the optimal nominal price of the good they produce in each

period and instead let Pi;t =             t 1 Pi;t 1 .   The rest of the model is as described in section 6.1.

       Seven time series are used in the estimation of our quarterly model: i) consumption growth

  ct , ii) investment growth            it , iii) in‡ation    t,   iv) the 1-quarter nominal interest rate rt;1 , v) the

10-year nominal interest rate rt;40 , vi) the 10-year ex post excess holding period return xhrt;40

log (Pt;39 =Pt   1;40 )   rt   1;1 ,   and vii) log of hours log ht . To compute rt;40 and xhrt;40 ; we solve for

nominal zero-coupon bond prices Pt;k maturing in period t + k by using the e¢ cient perturbation

algorithm in Andreasen and Zabczyk (2010). The presence of a short- and long-term interest rate

jointly captures the slope of the yield curve, while the excess holding period return is included as

an observable proxy for the term premium. All seven time series are stored in datat . We describe

the empirical data series in appendix K.
  12
     See also Ruge-Murcia (2012) for a Monte Carlo study and application of SMM based on the neoclassical growth
model solved up to third-order.
  13
     See Peralta-Alva and Santos (2012) for a summary of the literature on the relation between estimation methods
and numerical errors in simulation.




                                                                   31
7.1      Estimation Results Using GMM

We start by exploring whether our model can match the mean, the variance, contemporaneous

covariances, and the persistency in the data. Hence, let
                                            2                                 3
                                            6       fdatai;t g7i=1            7
                                            6                                 7
                                       qt   6 vech data data0                 7;                            (53)
                                            6              t        t         7
                                            4                                 5
                                              fdatai;t datai;t 1 g7i=1


and denote the structural parameters by . The GMM estimator is then given by

                                                                 0
                                     1 PT                                 1 PT
                 GM M   = arg min          qt       E [qt ( )]       W          qt       E [qt ( )] :       (54)
                             2       T t=1                                T t=1

                                                            1    PT
Here, W is a positive de…nite weighting matrix,             T        t=1 qt   is a row-vector with the empirical

moments, and E [qt ( )] contains the model-implied moments that we compute in closed-form using

the above formulas. Following common practice, we apply a diagonal weighting matrix to obtain

preliminary consistent estimates that we use to compute the optimal weighting matrix - in our case

the Newey-West estimator with 10 lags (all results are robust to using either 5 or 15 lags instead.)

      All structural parameters in the model are estimated, except , , and ; which are harder to

identify and therefore assigned the values in table 1. Based on the considered moments in (53), we

can estimate the …rst four moments for the innovations when using a second-order approximation

and the …rst six moments when the model is solved up to third order. In practice, it will typically

be di¢ cult to separately identify all the relevant moments, and we therefore impose a distributional

speci…cation. Letting the innovations to preference and technology shocks be normally distributed,

we are then left with 18 parameters to be estimated based on 42 moments.

      We start by estimating the model based on a second-order approximation. Given the normally

distributed innovations, the mean values implied by the second- and third-order approximations

are identical and only the variances di¤er. The great advantage of starting with a second-order

approximation is that all considered moments for our model with seven state variables can be

computed in just 0.03 second when using Matlab.14

      The estimates are reported in the second column of table 3. We …nd sizable habits (b = 0:68),
 14
      The execution time is for a 64-bit version of Matlab 12b on an Intel(R) Core(TM) i5-3210 M CPU @ 2.50Ghz.


                                                       32
a low Frisch elasticity of labor supply (1=        1   = 0:16), and a moderate degree of curvature in the

periodic utility function with respect to consumption (             2   = 1:59). The Epstein-Zin parameter

is large (   3   =    196) and accounts for a high relative risk aversion of 99 which is similar to the

…nding in Rudebusch and Swanson (2012). Our estimates also imply a low intertemporal elastic-

ity of substitution for consumption of 0:2. As in Justiniano and Primiceri (2008), the degree of

price stickiness is high ( = 0:93), meaning that the in‡ation-indexed prices are being re-optimized

roughly every second year.15 The central bank displays preferences for smoothing changes in the

policy rate (    r   = 0:68) and assigns more weight to in‡ation than output when conducting monetary

policy (     = 3:99,      y   = 0:56).


                                           < Table 3 about here >


    Table 4 provides empirical and model-implied moments to evaluate the …t of the model. The

model matches all mean values extremely well, in particular, the short- and long-term interest rates

of 5:6 percent and 6:9 percent, respectively. Also, our model reproduces the mean in‡ation rate

of 3:7 percent, even though the corresponding steady-state level is much higher (4 log                 ss   = 15:97

percent). The di¤erence relates to a large correction due to the highly risk-averse households. The

model is also successful in matching the variability in the data, although the standard deviation

in consumption growth is below the empirical value (1:4 percent compared to 2:7 percent) and the

standard deviations for in‡ation, the short rate, and the log of hours are somewhat higher than

in the data. A satisfying performance is also seen with respect to the …rst-order autocorrelations,

where only consumption growth displays notably higher persistence than the empirical moment

(0:7 compared to 0:3).

    The …nal part of table 4 shows the contemporaneous correlations where our model in most

cases reproduces the correct sign. The main exception relates to hours, which contrary to empirical

evidence, is negatively correlated with consumption and investment growth and displays positive

comovement with in‡ation and the two interest rates.


                                           < Table 4 about here >
  15
     The prices in our model change every quarter: (roughly) seven out of eight quarters with a simple indexation
rule and every eighth quarter by a full re-optimization. Our model is, then, fully compatible with a high degree of
price variability in the micro data.



                                                         33
    We next use a third-order approximation and re-estimate the model on the same moments. The

optimization problem is still quite tractable, partly because estimates at second-order are good

starting values and partly because it only takes 0.8 second to compute the considered moments

in Matlab. The estimation results in table 3 (third column) show only minor di¤erences when

compared to a second-order approximation. We note a small increase in the size of habits (0:69 vs.

0:71), lower curvature in the periodic utility function with respect to consumption (1:57 vs. 1:53),

and lower capital adjustment costs (4:11 to 3:59). As a result, the relative risk aversion now falls

to 94. This is not a surprise, as higher-order terms allow the model to capture the dynamics of

the data with a lower risk aversion. The precision of most estimates as given by the asymptotic

distribution greatly improves when moving to a third-order approximation. This is similar to the

…ndings in An and Schorfheide (2007) and Andreasen (Forthcoming).

    Table 4 shows that the small changes in the estimated parameters result in broadly the same

…t as with a second-order approximation. Of course, a key di¤erence between the two cases is that

the third-order approximation allows for time variation in the nominal term premium, whereas it is

constant at second order. We use the measure of the term premium suggested by Rudebusch and

Swanson (2012) which is based on the risk-neutral bond price P~t;k where payments are discounted

by rt;1 , i.e.
                                                         h                 i
                                    P~t;k = e   rt;1
                                                       Et P~t+1;k      1       :

The corresponding yield-to-maturity on this bond is r~t;k =                1
                                                                           k       log P~t;k , and nominal term premium

at maturity k is then given by

                                        T Pt;k = rt;k        r~t;k :

At third-order, we …nd a nominal term premium with a sizable mean of 174 annualized basis points

and a quite realistic standard deviation of 20 annualized basis points.

    Given that we have more moments (n) than parameters (np ), it is possible to apply the J-test

and conduct an overall speci…cation test of our model. This is done in table 5 using T Q                          2
                                                                                                                  n np

where T refers to the number of observations and Q is the value of the objective function when using

the optimal weighting matrix. Table 5 shows that the P-value for this test is 0:84 at second-order

and 0:71 at third-order, meaning that our model is not rejected by the data, that is, the observed

di¤erences between empirical and model-implied moments in table 4 are not unusual given the

                                                       34
sample variation in the empirical moments. However, this …nding should be interpreted with some

caution because it is well-known that the J-test displays low power and may therefore fail to reject

a misspeci…ed model (Ruge-Murcia (2007)).

                                             <Table 5 about here>

       We end this section by reporting IRFs following positive one-standard-deviation shocks to tech-

nology and preferences (…gures 1 and 2). These functions are computed at …rst- and third-order

using the formulas derived in this paper. In the case of third-order approximation we set the value

of the relevant state variables at their unconditional means. With our implementation, it takes

only about 1.4 seconds to compute these functions in Matlab. All IRFs have the expected pattern

and we therefore direct our attention to the e¤ects of higher-order terms, that is, the di¤erence

between the marked and unmarked lines. For a technology shock, we see substantial non-linear

e¤ects in consumption and investment growth. For a preference shock, notable di¤erences appear

for the interest rates and in‡ation.

                                        < Figure 1 and 2 about here>


7.2      Estimation Results Using SMM

We next explore how well our model matches higher-order moments such as skewness and kurtosis in

the data using a third-order approximation. The set of considered moments are therefore extended

to16                                               2                   3
                                                         qt
                                                   6 n        o6       7
                                                   6                   7
                                            q
                                            ~t     6 data3             7:
                                                   6      i;t          7
                                                   4 n        oi=1
                                                               6       5
                                                          4
                                                      datai;t
                                                                 i=1

To give our model greater ‡exibility in matching these additional moments, we let innovations

to technology and preference shocks follow the normal-inverse Gaussian distribution. This is a

very ‡exible probability distribution with separate parameters controlling the asymmetry of the

distribution and its tail heaviness (see Barndor¤-Nielsen (1997) for further details). As before,

these innovations are assumed to be identical and independent across time.
  16
    Higher moments for log ht are not included because they are too tightly correlated with existing moments:
corr log ht ; (log ht )3 = 0:9995 and corr (log ht )2 ; (log ht )4 = 0:9995. If we were to include them, we could face
problems computing the optimal weighting matrix in a robust way because this matrix is unlikely to have full rank.


                                                         35
   The presence of third and fourth moments in q
                                               ~t implies that all moments cannot be computed

in closed-form. Therefore, we resort to simulation. Then, our SMM estimator for the structural

parameters is given by

                                                      0
                         1 PT         1 PT                    1 PT            1 PT
     SM M   = arg min          q
                               ~t            ~s ( )
                                         s=1 q            W         q
                                                                    ~t               ~s ( ) ;
                                                                                 s=1 q             (55)
                2        T t=1       T                        T t=1          T

                                                                 1   PT
where the model-implied moments are estimated by using          T         ~s (
                                                                      s=1 q      ) for   > 1. Since the

normal-inverse Gaussian distribution has …nite moments up to any order (given standard require-

ments), we know from proposition 4 that all model moments of q
                                                             ~t are …nite.

   The estimates are reported in the …nal column of table 3. Compared to the third-order GMM

estimation, most parameters are unchanged. Only the degree of habit formation has increased

(0:71 to 0:73) and so has the curvature in the periodic utility function with respect to consumption

(1:53 to 1:59). For technology shocks, the skewness parameter is estimated to be 0:23 while the

tail heaviness parameter is 1:25. Using standard formulas for skewness and kurtosis in the normal-

inverse Gaussian distribution, we …nd that technology innovations display a positive skewness of 0:45

and a kurtosis of 5:31. For preference shocks, the skewness and tail parameters are estimated very

inaccurately. A standard t-test shows that the skewness parameter could be zero and computing

kurtosis using the tail heaviness parameter plus one standard deviation gives a kurtosis of 3:14.

Hence, we …nd evidence of non-Gaussianity in technology shocks but not in preference shocks. These

results are broadly in line with those of Justiniano and Primiceri (2008), who …nd time-varying

volatility in technology shocks but not in preference shocks.

   The …nal column of table 4 shows our model’s ability to match …rst and second moments with

normal-inverse Gaussian shocks is broadly similar to the case with normally distributed shocks

(i.e., GMM3rd ). We therefore focus on the higher-order moments in table 6. The model correctly

generates negative skewness in investment growth and positive skewness in excess holding period

returns but is unable to match skewness for any of the other variables. The model is slightly more

successful in matching values of kurtosis in consumption growth, investment growth, and excess

holding period returns. Although the model is unable to perfectly match all moments, the model

speci…cation test in table 5 shows that we cannot reject the model based on our data.




                                                 36
8    Conclusion

This paper shows how to extend the pruning method by Kim, Kim, Schaumburg and Sims (2008)

to third- and higher-order approximations. Special attention is devoted to models solved up to

third order. Conditions for the existence of …rst and second moments are derived, and their values

are provided in closed-form. The existence of higher-order moments in the form of skewness and

kurtosis is also established. We also analyze impulse response functions and provide simple closed-

form expressions for these functions.

    The econometric implications of our …ndings are signi…cant as most of the existing moment-

based estimation methods for linearized DSGE models now carry over to non-linear approximations.

For approximations up to third-order, this includes GMM estimation based on …rst and second

moments and matching model-implied IRFs to their empirical counterparts. When simulations are

needed, our analysis also provides the foundation for di¤erent types of indirect inference and SMM.

These results are not only relevant for classical inference, as the moment conditions in optimal GMM

estimation may be used to build a limited information likelihood function, from which Bayesian

inference may be carried out. We therefore hope that the tools developed in this paper will be

picked by other researchers who estimate DSGE models where non-linearities play a key role.




                                                37
A     Appendix
In this appendix, we provide further details and derivations for the paper. In particular, we will
show how our state-space framework can handle a rich set of non-linearities between xt and t+1 ,
we will present the proofs of di¤erent results in the main text, discuss the New Keynesian model
that we use as an empirical application in depth, and describe the data for our estimation.


B    Non-linearities Between State Variables and Innovations
To illustrate how non-linearities between xt and t+1 can be addressed in our framework, let vt
             0
 x0t 1 0t      be an expanded state vector where the innovations now appear as state variables.
The new state equation is then given by

                                                 h (vt ; )                         0nx
                                 vt+1 =                              +                        ;
                                                    0                              ut+1

where ut+1 s IID (0; I) is of dimension n , and the new observation equation is

                                                  yt = g (vt ; ) :

Thus, any model with non-linearities between state variables and innovations may be rewritten into
our notation with only linear innovations.
   As an illustration, consider a neoclassical growth model with stochastic volatility. The equilib-
rium conditions (where we follow standard notation) are given by:
                                          h                        i
                               ct = Et ct+1 at+1 kt+11 + 1
                                      ct + kt+1 = at kt + (1                           ) kt
                                    log at+1 = log at +                    a;t+1 a;t+1

                                       a;t+1                                 a;t
                              log                      =      log                       +     ;t+1
                                        a;ss                               a;ss

We then re–write these conditions as:
                 2      0     (                                           a;t
                                                                                                      )               13
                                                               log                 +   ;t+1
                                    log at +           exp               a;ss
                   6      B                     a;ss                                          a;t+1
                                                                                                                      C7
         ct   = Et 4 ct+1 @exp                                                                            kt+11 + 1   A5

                                      ct + kt+1 = at kt + (1                           ) kt
                                       log at = log at               1   +      a;t a;t

                                          a;t                              a;t 1
                               log                     =      log                        +     ;t
                                         a;ss                                a;ss

                                                  a;t+1       = ua;t+1
                                                       ;t+1   = u        ;t+1

where the extended state vector is vt       kt at 1    a;t 1 a;t  ;t and is the perturbation
parameter scaling the innovations ua;t+1 and u ;t+1 .
   If, instead, the volatility process is speci…ed as a GARCH(1,1) model, then the equilibrium


                                                              38
conditions can be expressed as:
                              h                                                                      i
                    ct = Et ct+1 expf               log at +      a;t+1 a;t+1 g
                                                                                      kt+11 + 1
                                        ct + kt+1 = at kt + (1                    ) kt
                                        log at = log at            1   +    a;t a;t
                                2            2                            2         2 2
                                a;t+1   =    a;ss (1         1)   +     1 a;t + 2 a;t a;t

                                                   a;t+1     = ut+1

where the extended state vector is vt     kt    a;t at 1   a;t  and is the perturbation parameter
scaling ut+1 . As in Andreasen (2012), the constant term in the GARCH process is scaled by (1 1 )
to ensure that a;t = a;ss in the deterministic steady state where 2a;t = 0.


C     Proof of Proposition 1
First, note that all eigenvalues of A(2) are strictly less than one. To see this, we work with

                     p( ) =       A         I2nx +n2x
                                  2                                                                3
                                   hx    Inx                 0nx       nx             0nx n2x
                            =     4 0nx nx               hx    Inx                     1           5
                                                                                       2 Hxx
                                    0n2x nx               0n2x nx                hx    hx     In2x
                                B11 B12
                            =
                                B21 B22
                            = jB11 j jB22 j

where we let
                                                  hx   Inx                0nx nx
                                B11                                                         ;
                                                   0nx nx                hx   Inx
                                                  0nx n2x
                                B12                1
                                                   2 Hxx
                                B21               0n2x   nx       0n2x      nx    ;

and
                                            B22         hx        hx        In2x :
and we use the fact that
                                                 U C
                                                              = jUj jYj
                                                 0 Y
where U is an m     m matrix and Y is an n               n matrix. Hence,

           hx   Inx      0nx nx
p( ) =                                      hx     hx         In2x = jhx                 Inx j jhx   Inx j hx   hx   In2x :
            0nx nx      hx   Inx

    The eigenvalues are clearly determined from jhx              Inx j = 0 or hx hx      In2x = 0. The
absolute value of all eigenvalues to the …rst problem are strictly less than one by assumption. That
is j i j < 1 i = 1; 2; :::; nx . This is also the case for the second problem because the eigenvalues to


                                                             39
hx    hx are      i j   for i = 1; 2; :::; nx and j = 1; 2; :::; nx .
                                                                h     i
                                                                  (2)                                                                                                         1 (2)
   Given that the system is stable, the mean value is given by E zt     = I2nx +n2x                                                                                 A(2)       c ,
         h     i
           (2)
because E t+1 = 0. For the variance, we have

                                     (2)                               (2)                        0                         (2)                       0
                              V zt+1 = A(2) V zt                                   A(2)               + B(2) V              t+1           B(2)

as
                                             2
                                                             xft    0
                                                                    t+1                                   xft (   t+1           t+1         vec (Ine ))0
                                 0        6
            E zt
                  (2)     (2)
                                       = E4                  xst    0
                                                                    t+1                                   xst ( t+1   t+1                   vec (Ine ))0
                          t+1
                                                       xft         xft 0t+1                   xft              f
                                                                                                              xt ( t+1    t+1                       vec (Ine ))0
                                                                                        0                                                         0      3
                                                       xft         t+1           xft                                xft xft               t+1
                                                                                                                                                              7
                                                                                        0                                                         0           7
                                                       xst         t+1           xft                                xst     xft           t+1                 7=0
                                                                                                      0                                                   0
                                                                                                                                                              5
                                                 xft         xft             t+1        xft                   xft         xft       xft          t+1


                                                                   (2)
     Now, we only need to compute V                                t+1       :
                                  22                                                                  32                                               30 3
                                                                    t+1                                                             t+1
                                  66                                         vec (Ine ) 7 6                                                 vec (Ine ) 7  7
                  (2)             6              t+1             t+1                                              t+1           t+1                       7
            V                 = E 66                                          f
                                                                                        76                                                             7
                                                                                                                                                       57
                  t+1
                                  44                          t+1            xt         54                                      t+1         xft           5
                                                             xft         t+1                                                xft           t+1
                                 2                                                                                                                                  0
                                                         Ine                                                                    E      t+1 ( t+1               t+1 )
                                6 E (                                  0
                                                                 t+1 ) t+1                  E (                                     vec (Ine )) (                             vec (Ine ))0
                              = 6
                                4
                                                 t+1                                                      t+1         t+1                                 t+1           t+1
                                                             0                                                                                0
                                                             0                                                                                0
                                                                                                                                                                         3
                                                                   0                                                                        0
                                                                   0                                                                        0                            7
                                                                                                                                                                         7
                                                                                                      0                                                             0    7
                                      E                      xft                            xft               E                       xft        xft                     7
                                             t+1                             t+1                                          t+1                                 t+1        7
                                                                                                                                                                         7
                                                                                                      0                                                             0    5
                                      E     xft              t+1             t+1            xft               E       xft           t+1          xft          t+1


   We note that this variance is …nite when t+1 has …nite fourth moment. All elements in this
matrix can be computed element-by-element. As an illustration, consider
                        0        0                                                                0
        E       t+1     t+1      t+1         = E                 t+1 ( t+1                   t+1 )
                                                                                                          n                                                   one        0
                                                                                     ne                                                             ne
                                             = E f                 t+1 (         1 )g 1 =1                    t+1 (       2) f      t+1 (       3 )g 3 =1
                                                                                                                                                                2 =1


Quasi-MATLAB codes for E                               0            0              therefore read:
                                           t+1         t+1          t+1


     E_eps_eps2 = zeros(ne,ne2 )
     for phi1 = 1:ne
         index2 = 0


                                                                                       40
          for phi2 = 1:ne
              for phi3 = 1:ne
                  index2 = index2+1
                  if (phi1 = phi2 = phi3)
                      E_eps_eps2(phi1,index2)=m3 (              t+1 (phi1))
                  end
              end
          end
    end

  Here, m3 denotes the third moment of t+1 . For further details on computing elements in
   (2)
V t+1 , see the technical appendix to the paper.


D     Proof of Proposition 2
We consider the system xt+1 = a+Axt +vt+1 where A is stable and vt+1 are mean-zero innovations.
Thus, the pruned state-space representation of DSGE models belong to this class. For notational
convenience, the system is expressed in deviation from its mean as a = (I A) E [x]. Therefore

                                 xt+1 = (I      A) E [x] + Axt + vt+1 )
                                 xt+1   E [x] = A (xt       E [x]) + vt+1 )
                                           zt+1 = Azt + vt+1

    We then have

              zt+1      zt+1 = (Azt + vt+1 )         (Azt + vt+1 )
                             = Azt      Azt + Azt          vt+1 + vt+1     Azt + vt+1        vt+1 ;


                 zt+1     zt+1   zt+1 = Azt          Azt       Azt + Azt      Azt     vt+1
                                             +Azt      vt+1     Azt + Azt      vt+1       vt+1
                                             +vt+1      Azt     Azt + vt+1      Azt       vt+1
                                             +vt+1      vt+1      Azt + vt+1     vt+1      vt+1

and


      zt+1   zt+1    zt+1    zt+1 = Azt         Azt      Azt       Azt + Azt     Azt       Azt      vt+1
                                        +Azt      Azt      vt+1     Azt + Azt       Azt      vt+1       vt+1
                                        +Azt      vt+1      Azt     Azt + Azt       vt+1     Azt        vt+1
                                        +Azt      vt+1      vt+1     Azt + Azt      vt+1     vt+1       vt+1
                                        +vt+1     Azt       Azt     Azt + vt+1      Azt      Azt        vt+1
                                        +vt+1     Azt       vt+1     Azt + vt+1     Azt      vt+1       vt+1
                                        +vt+1     vt+1      Azt      Azt + vt+1     vt+1      Azt       vt+1
                                        +vt+1     vt+1      vt+1     Azt + vt+1       vt+1       vt+1      vt+1


                                                      41
   Thus, to solve for E [zt+1 zt+1 zt+1 ] ; the innovations need to have a …nite third moment.
At the second order, vt+1 depends on t+1       t+1 , meaning that t+1 must have a …nite sixth
moment. Similarly, to solve for E [zt+1 zt+1 zt+1 zt+1 ] ; the innovations need to have …nite
fourth moments. At second order, vt+1 depends on t+1        t+1 , meaning that t+1 must have a
…nite eight moment.


E      Coe¢ cients for the Pruned State-Space System at Third-Order
         2                                                                                            3
                     hx             0    0   0   0        0
         6           0              hx 1                                                              7
         6                             2 Hxx 0   0        0                                           7
         6           0              0 hx hx 0    0        0                                           7
A(3)     6                                                                                            7
         6   3             2                           1                                              7
         6   6h x                   0    0   hx Hxx    6 Hxxx                                         7
         4 hx 1 h              2    0    0   0 hx hx hx 21 Hxx                                        5
               2
               0                    0    0   0   0   hx hx hx
             2
                                                       0                       0                      0
             6             0                           0                       0                      0
             6
             6             0                                                       hx            hx
    B(3)     6
             6             0                           0                       0                      0
             6
             4             1         2
                           2h                          0                       0                      0
                           0                           0                       0                      0
                             0                             0                    0                      0
                             0                             0                    0                      0
                             0                             0                    0                      0
                             0                             0                    0                      0
                                                            1
                                   hx                       2 Hxx               0                      0
                            0                              hx hx         hx    hx               hx             hx
                                                                                                           3
                           0                          0                    0                     0
                           0                          0                    0                     0         7
                                                                                                           7
                           0                          0                    0                     0         7
                                                                                                           7
                           0                          0                    0                     0         7
                                                                                                           7
                           0                          0                    0                     0         5
                 hx                                   hx                           hx
             2                                                                              3
                                                      t+1
             6                          t+1       t+1       vec (Ine )                      7
             6                                                                              7
             6                                              xft                             7
             6                                   t+1                                        7
             6                                  xft                                         7
             6                                      t+1                                     7
             6                                                                              7
             6                                    t+1xst                                    7
             6                                                                              7
       (3)   6
             6                             t+1
                                                   f
                                                 xt xft                                     7
                                                                                            7
       t+1   6                            xft xft                                           7
             6                                          t+1                                 7
             6                            xft            xft                                7
             6                                  t+1                                         7
             6                            f                                                 7
             6                           xt    t+1       t+1                                7
             6                                   f                                          7
             6                            t+1   xt       t+1                                7
             6                                                                              7
             4                            t+1    t+1      xft                               5
                 (   t+1       t+1            t+1 )     E [(   t+1       t+1       t+1 )]



                                                                         42
             2                                                              3
                                         0nx 1
             6                          1      2                            7
             6                          2h                                  7
             6               (              ) vec (Ine )                    7
    c(3)     6                                                              7
             6                         1
                                         h      3                           7
             6                         6                                    7
             4                           0n2x 1                             5
                 (                   ) E [( t+1     t+1            t+1 )]


    C(3)         gx + 36 g       x
                                     2       gx       1
                                                      2 Gxx    gx Gxx       1
                                                                            6 Gxxx


             1
    d(3)     2g
                     2   + 16 g          3:



F     Proof of Proposition 3
To prove stability:
   p ( ) = A(3) I
           2                                                                                                                       3
                   hx I                           0   0                          0             0                0
           6         0                       hx I   1
                                                      H                          0             0                0                  7
           6                                        2 xx                                                                           7
           6         0                         0  hx hx                I         0             0                0                  7
        = 66      3       2                                                                                  1
                                                                                                                                   7
                                                                                                                                   7
           6      6h x                         0      0                     hx       I        Hxx            6 Hxxx                7
           4 hx 1 h           2                0      0                          0       hx    hx      I   hx 12 Hxx               5
                     2
                     0                         0      0                          0             0         hx hx hx              I
             B11 B12
        =
             B21 B22
   where 2                                            3      2                               3
             hx I          0                      0            0                         0 0
          4     0      hx                I      1     5      4                           0 0 5
   B11                                          2 Hxx   B12    0
                0          0                  hx hx I          0                         0 0
          2     3       2
                                                3     2                                            1
                                                                                                                           3
                6h x                     0    0         hx I                             Hxx       6 Hxxx
   B21 4 hx 21 h            2            0    0 5 B22 4   0    hx                         hx I   hx 12 Hxx                 5
                    0                    0    0           0                               0    hx hx hx                I

           = jB11 j jB22 j

           = jhx     Ij jhx    Ij jhx hx      Ij jB22 j
           (using the result from the proof of proposition 1)

           = jhx     Ij jhx    Ij jhx hx     Ij jhx   Ij jhx hx Ij jhx                                  hx   hx   Ij
           (using the rule on block determinants repeatedly on B22 ):

    The eigenvalue           solves p ( ) = 0, which implies

                      jhx         Ij = 0 or jhx               hx   Ij = 0 or j(hx         hx    hx )     Ij = 0
The absolute value of all eigenvalues to the …rst problem is strictly less than one by assumption.
That is j i j < 1; i = 1; 2; :::; nx . This is also the case for the second problem, because the eigenvalues
to hx hx are i j for i = 1; 2; :::; nx and j = 1; 2; :::; nx . The same argument ensures that the
absolute values of all eigenvalues to the third problem are also less than one. This shows that all
eigenvalues of A(3) have modulus less than one.

                                                                      43
                                                                h     i                                                                                            1 (3)
                                                                  (3)
   Given that the system is stable, the mean value is given by E zt     = I3nx +2n2x +n3x                                                                A(3)       c
          h     i
            (3)
because E t+1 = 0. For the variance, we have
              h     i       h     i        0       h     i                                                           0
                (3)           (3)                    (3)
             V zt+1 = A(3) V zt      A(3) + B(3) V t+1 B(3)
                                 h           i    0        h                                                                      i                  0
                                    (3) (3)                                                                          (3)    (3)
                      +A(3) Cov zt ; t+1 B(3) + B(3) Cov                                                             t+1 ; zt             A(3)
                                                h            i
                                                  (3)    (3)
Contrary to a second-order approximation, Cov t+1 ; zt         6= 0. This is seen as follows:
                        22                   3
                                   xft
                        66         xst       7
                        66                   7
                        66                   7
       (3)   (3) 0      66     xft xft       7
   E zt      t+1   = E 66           rd       7
                        66        xt         7
                        66       f     s
                                             7
                        44     xt xt         5
                             f       f    f
                            xt xt xt
           h                                               0                 0                                                                                                    0
              0
              t+1 ( t+1    t+1    vec (Ine ))0 t+1    xft        xft   t+1      ( t+1 xst )0                                                                    t+1   xft   xft
                                     0                                      0                                    0                                          0
            xft    xft         t+1             xft         t+1       xft             xft       t+1       t+1              t+1             xft         t+1
                                           0                                                                                               i
             t+1         t+1     xft           ((    t+1         t+1            t+1 )      E [(   t+1          t+1       t+1 )])
                                                                                                                                0
            2
                0nx ne 0nx           n2e 0nx ne nx                0nx      nx ne        0nx    nx ne    0nx     ne n2x    0nx     n2x ne         0nx      n2x ne
         6      0nx ne 0nx           n2e 0nx ne nx                0nx      nx ne        0nx    nx ne    0nx     ne n2x    0nx     n2x ne         0nx      n2x ne
         6
         6      0n2x ne 0n2x         n2e 0n2x ne nx               0n2x                  0n2x            0n2x    ne n2x    0n2x    n2x ne         0n2x     n2x ne
        =6
         6
                                                                           nx ne               nx ne
         6      0nx ne 0nx           n2e 0nx ne nx                0nx      nx ne        0nx    nx ne    0nx     ne n2x    0nx     n2x ne         0nx      n2x ne
         4      0n2x ne 0n2x         n2e 0n2x ne nx               0n2x     nx ne        0n2x   nx ne    0n2x    ne n2x    0n2x    n2x ne         0n2x     n2x ne
                0n3x ne 0n3x         n2e 0n3x ne nx               0n3      nx ne        0n3x   nx ne    0n3x    ne n2x    0n3x    n2x ne         0n3x     n2x ne
                                                                 3 x
                 R1;1 R1;2           R1;3 0nx n3e
                 R2;1 R2;2           R2;3 0nx n3e                7
                                                                 7
                 R3;1 R3;2           R3;3 0n2x n3e               7
                                                                 7
                 R4;1 R4;2           R4;3 0nx n3e                7
                                                                 7
                 R5;1 R5;2           R5;3 0n2x n3e               5
                 R6;1 R6;2           R6;3 0n3x n3e
        =       0 R 0
                                                                                                                                      h          i
                                                                                                                                           (3)
   The R matrix can easily be computed element by element. To compute V                                                                    t+1       ; we consider




                                                                                44
                                          22                                                                                             3
                                                                                                   t+1
                                   66                                          t+1            t+1        vec (Ine )                      7
                                   66                                                                                                    7
                                   66                                                                    xft                             7
                                   66                                                     t+1                                            7
                                   66                                                    xft                                             7
                                   66                                                           t+1                                      7
                                   66                                                                                                    7
                                   66                                                    t+1     xst                                     7
                                   66                                                                                                    7
        (3)       (3) 0            66                                                 t+1    xt xft
                                                                                               f
                                                                                                                                         7
   E                            = E66
                                   66
                                                                                                                                         7
                                                                                                                                         7
        t+1       t+1
                                   66                                               xft xft         t+1                                  7
                                   66                                               xft              xft                                 7
                                   66                                                       t+1                                          7
                                   66                                                                                                    7
                                   66                                              xft     t+1       t+1                                 7
                                   66                                                        f                                           7
                                   66                                               t+1     xt       t+1                                 7
                                   66                                                                                                    7
                                   44                                               t+1      t+1      xft                                5
                                                       (   t+1         t+1           t+1 )          E [(       t+1      t+1       t+1 )]
            h                                                                                                    0                  0                                                  0
                  0
                  t+1       (   t+1               t+1            vec (Ine ))   0
                                                                                             t+1         xft            f
                                                                                                                       xt      t+1       ( t+1        xst )0         t+1   xft   xft
                                              0                                          0                                      0                                0
            xft       xft           t+1                    xft         t+1      xft                xft          t+1        t+1         t+1    xft          t+1
                                                   0                                                                                              i
                t+1           t+1         xft              ((    t+1         t+1             t+1 )        E [(       t+1      t+1    t+1 )])
                                                                                                                                              0
                      h             i
                            (3)
   Note that V           contains ( t+1
                            t+1             t+1   t+1 ) squared, meaning that t+1 must have a …nite
                           i    h                                   h     i
                                        (3)                           (3)
sixth moment for V           to be …nite. Again, all elements in V t+1 can be computed element
                                        t+1
by element.
       h      iFor further details, we refer to the paper’s technical appendix, which also discusses
          (3)
how V t+1 can be computed in a more memory-e¢ cient manner.
    For the auto-covariance, we have
            (3)  (3)                      (3)       (3)   (3)
    Cov zt+1 ; zt     = Cov c(3) +A(3) zt + B(3) t+1 ; zt
                                    (3)       (3)                                  (3)    (3)
        = A(3) Cov zt ; zt                                 + B(3) Cov              t+1 ; zt

            (3)       (3)                           (3)    (3)           (3)
   Cov zt+2 ; zt                = Cov c(3) +A(3) zt+1 + B(3)
                                                    t+2 ; zt
                                       (3)        (3)            (3)  (3)
        =   Cov c(3) +A(3) c(3) +A(3) zt + B(3) t+1 + B(3) t+2 ; zt
                                       2 (3)               (3)        (3)   (3)
        =   Cov c(3) +A(3) c(3) + A(3) zt + A(3) B(3) t+1 + B(3) t+2 ; zt
                       2 (3) (3)                      (3)    (3)                                                                         (3)    (3)
        =   Cov A(3) zt ; zt       + Cov A(3) B(3) t+1 ; zt      + Cov B(3)                                                              t+2 ; zt
                 2       (3) (3)                      (3)    (3)                                                                         (3)    (3)
        =    A(3) Cov zt ; zt      + A(3) B(3) Cov t+1 ; zt      + B(3) Cov                                                              t+2 ; zt


   So, for s = 1; 2; 3:::
                                                                   s    h     i P                                     s 1 j
                        (3)         (3)                                   (3)                                                                (3)      (3)
         Cov zt+s ; zt                        = A(3)                   V zt + sj=01 A(3)                                      B(3) Cov       t+1+j ; zt

                                                                                         (3)      (3)
and we therefore only need to compute Cov                                                t+1+j ; zt              :
                          22                                                         3
                                    xft
                          66        xst                                              7
                          66                                                         7
                          66                                                         7
       (3)  (3)    0      66     xft xft                                             7
   E zt               = E 66                                                         7
            t+1+j         66        xrd
                                     t                                               7
                          66                                                         7
                          44     xft xst                                             5
                              xft xft xft

                                                                                             45
                h                                                                                                                 0
                      0
                      t+1+j        (t+1+j             t+1+j             vec (Ine ))0                 t+1+j          xft+j
                                       0                                          0                                                   0
                xft+j           t+1+j
                                   t+1+j                            xst+j                    t+1+j       xft+j              xft+j
                                     0                                                                    0
                  f    f
                xt+j xt+j     t+1+j                              xft+j                t+1+j      xft+j
                                       0                                                                            0
                xft+j  t+1+j    t+1+j                                   t+1+j            xft+j          t+1+j
                                        0                                                                                                                                     i
                 t+1+j   t+1+j   xft+j                            ((     t+1+j               t+1+j        t+1+j )              E [(       t+1         t+1       t+1 )])
                                                                                                                                                                         0


                2
                    0nx     ne         0nx    n2e    0nx        ne nx     0nx          nx ne     0nx    nx ne       0nx        ne n2x         0nx    n2x ne   0nx    n2x ne
             6      0nx     ne         0nx    n2e    0nx        ne nx     0nx          nx ne     0nx    nx ne       0nx        ne n2x         0nx    n2x ne   0nx    n2x ne
             6
             6      0n2x               0n2x   n2e    0n2x                 0n2x                   0n2x               0n2x       ne n2x         0n2x   n2x ne   0n2x   n2x ne
            =6
             6
                            ne                                  ne nx                  nx ne            nx ne
             6      0nx     ne         0nx    n2e    0nx        ne nx     0nx          nx ne     0nx    nx ne       0nx        ne n2x         0nx    n2x ne   0nx    n2x ne
             4      0n2x               0n2x          0n2x                 0n2x                   0n2x               0n2x                      0n2x            0n2x
                            ne                n2e               ne nx                  nx ne            nx ne                  ne n2x                n2x ne          n2x ne
                    0n3x    ne         0n3x   n2e    0n3x       ne nx     0n3x         nx ne     0n3x   nx ne       0n3x       ne n2x         0n3x   n2x ne   0n3x   n2x ne

                       j           j           j
                                                                         3
                      R1;1        R1;2        R1;3     0nx        n3e
                       j           j           j                         7
                      R2;1        R2;2        R2;3     0nx        n3e    7
                       j           j           j                         7
                      R3;1        R3;2        R3;3     0n2x       n3e
                                                                         7
                                                                         7
                       j
                      R4;1         j
                                  R4;2         j
                                              R4;3     0nx               7
                                                                  n3e    7
                       j           j           j                         7
                      R5;1        R5;2        R5;3     0n2x       n3e    5
                       j           j           j
                      R6;1        R6;2        R6;3     0n3x       n3e


        = 0 Rj 0
    The matrix Rj can then be computed element by element. For further details, see the paper’s
technical appendix.


G      Proof of Proposition 4
The proof proceeds as for proposition 2. At third order, the only di¤erence is that vt+1 also depends
on t+1    t+1   t+1 . Hence, unconditional third moments exists if t+1 has a …nite ninth moment,
and the unconditional fourth moment exists if t+1 has a …nite twelfth moment.


H      IRFs: Second-Order
We …rst note that                                                             !                                                           !
                                                P
                                                l                                                       P
                                                                                                        l
    xft+l       xft+l =          hlx xft +           hlx    j
                                                                        t+j               hlx xft +           hlx       j
                                                                                                                                  t+j
                                               j=1                                                      j=1
                                                            P
                                                            l
            = hlx xft           hlx xft + hlx xft                  hlx    j
                                                                                       t+j
                                                            j=1
                P
                l                                             P
                                                              l                                   P
                                                                                                  l
            +         hlx   j
                                       t+j      hlx xft +               hlx   j
                                                                                         t+j            hlx   j
                                                                                                                            t+j
                j=1                                             j=1                               j=1

    Next, let


                                                                                         46
                                                                                     P
                                                                                     l
      ~ft+l
      x           ~ft+l = hlx xft
                  x                             hlx xft + hlx xft                          hlx    j
                                                                                                              t+j
                                                                                     j=1
                  P
                  l                                                   P
                                                                      l                                         P
                                                                                                                l
              +         hxl   j
                                        t+j        hlx xft +                    hlx   j
                                                                                                 t+j                    hlx      j
                                                                                                                                           t+j
                  j=1                                                 j=1                                       j=1
   where we de…ne t+j such that t+j = for j = 1 and t+j = t+j for for j 6= 1. This means
that:                           h                      i  h                 i
   GIRFxf xf l; ; xft = E xft+l xft+l jxft ; t+1 = 1     E xft+l xft+l jxft
           h                  i    h                 i
       =E x  ~ft+l x
                   ~ft+l jxft     E xft+l xft+l jxft
              = E[hlx xft             hxl   1
                                                    t+1      + hlx          1
                                                                                          t+1         hlx xft
                Pl                                  P
                                                    l
              +    hlx j                t+j                 hxl   j
                                                                                t+j
                  j=1                              j=1
                  Pl                               Pl
                        hlx   j
                                       t+j                  hlx   j                   f
                                                                                t+j jxt ]
                  j=1                              j=1
              = E[hlx xft             hxl   1
                                                      t+1    + hlx !
                                                                   1
                                                                                          t+1         hlx xft                                          !
                                            P
                                            l                                                                         P
                                                                                                                      l
              + hxl       1           +           hlx   j
                                                                      t+j                  hlx   1              +               hlx   j
                                                                                                                                                 t+j
                                            j=2                                                                     j=2
                                                                                 !                                                                                !
                                                 P
                                                 l                                                                                   P
                                                                                                                                     l
                    hlx   1
                                     t+1    +           hlx j           t+j                      hlx      1
                                                                                                                   t+1          +          hlx j            t+j       jxft ]
                                                j=2                                                                                j=2
              =   E[hlx xft hlx 1                +hlx 1                         hlx xft +hlx 1                                   l
                                                                                                                                hx 1                 hlx 1            t+1      hlx   1                f
                                                                                                                                                                                                t+1 jxt ]
              =   hlx xft hxl 1                 +hlx 1                      hlx xft + hlx 1                     hlx     1        (                      ) E                    t+1               t+1     :


I      IRFs: Third-Order
I.1      Deriving GIRFxf                           xf xf              j; ; xft
We …rst note that
  xft+l xft+l xft+l
                                                                                      P
                                                                                      l
              = hlx xft           hlx xft        hlx xft + hlx xft                          hlx       j
                                                                                                                  t+j           hlx xft
                                                                                      j=1
                  P
                  l                                                                     P
                                                                                        l                                            P
                                                                                                                                     l
              +         hlx   j
                                       t+j         hlx xft            hlx xft +                 hlx       j
                                                                                                                   t+j                     hlx   j
                                                                                                                                                           t+j        hlx xft
                  j=1                                                                     j=1                                        j=1
                                                P
                                                l                                                             P
                                                                                                              l                                      P
                                                                                                                                                     l
              +hlx xft            hlx xft             hlx    j
                                                                        t+j       + hlx xft                       hlx       j
                                                                                                                                      t+j                  hlx   j
                                                                                                                                                                         t+j
                                                j=1                                                       j=1                                        j=1
                  P
                  l                                               P
                                                                  l                                       P
                                                                                                          l                                      P
                                                                                                                                                 l                              P
                                                                                                                                                                                l
              +         hlx   j
                                       t+j        hlx xft               hlx      j
                                                                                            t+j +               hlx     j
                                                                                                                                     t+j              hlx   j
                                                                                                                                                                      t+j             hlx   j
                                                                                                                                                                                                       t+j
                  j=1                                             j=1                                     j=1                                j=1                                j=1
      Using the de…nition of                       t+j      from appendix H, we have
                                                                                       P
                                                                                       l
      ~ft+l
      x           ~ft+l
                  x           ~ft+l = hlx xft
                              x                              hlx xft hlx xft + hlx xft   hlx                                          j
                                                                                                                                                 t+j         hlx xft
                                                                                                                      j=1
                  P
                  l
              +         hlx   j
                                        t+j        hlx xft            hlx xft
                  j=1
                  Pl                                P
                                                    l
              +         hlx   j
                                        t+j                 hxl   j
                                                                                t+j         hlx xft
                  j=1                              j=1



                                                                                                 47
                                                     P
                                                     l
              +hlx xft              hlx xft                hlx     j
                                                                                 t+j
                                                     j=1
                                    P
                                    l                                       P
                                                                            l
              +hlx xft                     hlx   j
                                                             t+j                     hlx   j
                                                                                                               t+j
                                    j=1                                     j=1
                  P
                  l                                                          Pl
              +         hlx     j
                                            t+j         hlx xft                      hlx       j
                                                                                                               t+j
                  j=1                                                       j=1
                  Pl                                    P
                                                        l                                              P
                                                                                                       l
              +         hxl     j
                                            t+j                  hlx    j
                                                                                      t+j                          hlx    j
                                                                                                                                       t+j
                  j=1                                   j=1                                            j=1
      Simple algebra then gives h                                                                                                     i        h                                      i
      GIRFxf xf xf j; ; xft = Et x~ft+l                                                        ~ft+l
                                                                                               x                    ~ft+l jxft
                                                                                                                    x                        Et xft+l          xft+l     xft+l jxft
              = hlx xft hxl 1       hlx xft
              +hlx 1        hlx xft hlx xft
              +hlx xt hlx xft hxl 1
                     f

              + hxl 1 hlx 1 (                                                    )       E                         t+1                    t+1        hlx xft
              +hlx xft  hlx 1 hlx 1 (                                                     h )                      E              t+1                t+1                 i
              +hlx 1                       hlx xft         hlx 1                         E hlx                 1
                                                                                                                         t+1              hlx xft     hlx 1        t+1
              +hxl 1                       hlx 1                   hlx       1

               P l
              +         hxl     1                    hxl     j
                                                                       hlx   j
                                                                                     E                     t+1                        t+1
                  j=2
                  Pl
              +         E              t+1                   t+1            hlx      j
                                                                                               hlx         j
                                                                                                                         hlx      1
                  j=2
                  Pl     h                                                                                                    i
              +         E hlx          j
                                                  t+1            hlx   1                   hlx         j
                                                                                                                       t+1
                  j=2
              +E hlx        1
                                           t+1        hlx    1
                                                                           t+1           hlx       1
                                                                                                                    t+1


I.2      Deriving GIRFxf                               xs         j; ; xft ; xst

Using the law of motion for xft                                        xst , we …rst note that
                                                                                 lP1
      xft+l       xst+l = (hx                 hx )l xft                  xst +       (hx hx )l                                        1 i
                                                                                                                                                hx    1
                                                                                                                                                      2 Hxx        xft+i      xft+i       xft+i
                                                                                           i=0
                  lP1
              +         (hx           hx )l       1 i
                                                             hx            1
                                                                           2h
                                                                                           2       xft+i
                  i=0
                  lP1
              +         (hx           hx )l       1 i                       1
                                                                            2h
                                                                                           2
                                                                                                       t+1+i
                  i=0
                  lP1
              +         (hx           hx )l       1 i
                                                         (                 hx )          t+1+i                     xst+i
                  i=0
                  lP1
              +         (hx           hx )l       1 i                       1
                                                                            2 Hxx                   t+1+i                 xft+i             xft+i
                  i=0
      Using the de…nition of                            t+j     from appendix H, we obtain
                                                                         lP1
      ~ft+l
      x           ~st+l = (hx
                  x                           hx )l          xft xst +       (hx hx )l 1 i hx                                                         1
                                                                                                                                                      2 Hxx        ~ft+i
                                                                                                                                                                   x          ~ft+i
                                                                                                                                                                              x           ~ft+i
                                                                                                                                                                                          x
                                                                                           i=0
                  lP1
              +         (hx           hx )    l 1 i
                                                             hx            1
                                                                           2h
                                                                                           2       ~ft+i
                                                                                                   x
                  i=0


                                                                                                               48
                 lP1
             +         (hx         hx )l       1 i                 1
                                                                   2h
                                                                                 2
                                                                                      t+1+i
                 i=0
                 lP1
             +         (hx         hx )l       1 i
                                                        (         hx )           t+1+i            ~st+i
                                                                                                  x
                 i=0
                 lP1
             +         (hx         hx )l       1 i                 1
                                                                   2 Hxx              t+1+i             ~ft+i
                                                                                                        x            ~ft+i
                                                                                                                     x
                 i=0
         Simple algebra then implies
                                                                  lP1
         GIRFxf        xs       j; ; xft ; xst                =         (hx          hx )l        1 i
                                                                                                          hx         1
                                                                                                                     2 Hxx         GIRFxf               xf xf   i; ; xft
                                                                  i=1
                        lP1
                   +             (hx       hx )l            1 i
                                                                  hx         1
                                                                             2h
                                                                                          2   GIRFxf (i; )
                        i=1
                   + (hx               hx )l       1
                                                                        hx xst + 21 Hxx xft                         xft + 12 h              2



J         The New Keynesian Model
J.1        Household
The problem of the household is:

                                                   dt                                                                    (1        ht )1        1            h       i          1
                                                                                                                                                                1
                                                                               1
                                                                                          + (zt )(1            2)
                                                                                                                                                                            1       3
             max                   Vt =        1
                                                            (ct    bct       1)
                                                                                      2
                                                                                                                     0                              +      Et Vt+1 3
 ct ;xt+1 ;ht ;kt+1; it 8t 0                            2                                                                     1         1
                                                                                                                                    2
                                                                                                             it
                                                   s.t. kt+1 = (1                    ) kt + it                         kt
                                                                                                         2 kt
                                   Z
                                                                                                  1      xt
                                         Dt;t+1 xt+1 d! t;t+1 + ct +                          t     it =    + ht wt + rtk kt + divt
                                                                                                               t

plus a standard no-Ponzi-game condition.
   We follow Rudebusch and Swanson (2012) and consider a …nite number of states in each period.17
As in Rudebusch and Swanson (2012), the optimization problem is formulated as a Lagrange
problem maximizing
                   1
                            "                                                        #
                  X           dt+l                1 2        (1 2 )   (1 ht+l )1 1
                       l
Vt : L = Vt + Et         t+l 1 2 (ct+l   bct+l 1 )    + zt+l        0
                                                                          1    1
                                  l=0
                  1
                  X                                     h          i         1
                            l                       1                    1       3
            +Et                  t+l           Et Vt+l+13                             Vt+l
                  l=0
                  X1                                                                                                Z
                            l            xt+l                                 k                                                                                                           1
            +Et                  t+l [             + ht+l wt+l +             rt+l kt+l        + divt+l                   Dt+l;t+l+1 xt+l+1 d! t+l;t+1+l                    ct+l         t+l it+l ]
                                          t+l
                  l=0
                  1
                                               "                                                                                                    #
                  X                                                                                it+l                 2
                            l
            +Et                 qt+l     t+l       (1         ) kt+l + it+l                                                 kt+l        kt+1+l
                                                                                          2        kt+l
                  l=0
    17
    This assumption is without loss of generality as shown by Epstein and Zin (1989). Moveover, this section covers
the case where the value function is positive. The derivations for a negative value function are almost identical and
therefore not included.




                                                                                              49
   The …rst-order conditions for an interior solution are given by:
                     @L
                         =          t dt (ct          bct   1)
                                                                         2           b Et             t+1 dt+1 (ct+1                          bct )         2
                                                                                                                                                                   t   =0
                     @ct

                              @L                                                                                  1
                                                = probt (s)                          t+1 (s)                                     Dt;t+1 (s)                  t   =0
                         @xt+1 (s)                                                                            t+1 (s)

Then
                                                                                                  t+1 (s)                  1
                                                       Dt;t+1 (s) =
                                                                                                              t          t+1 (s)

                                        @L                         (1                2)
                                            =               t (zt )                           0 (1                ht )       1   +           t wt   =0
                                        @ht
                                                                                                                                              2
 @L                                        k                                                                          it+1                                        it+1          ii+1
      =     t qt (   1)+Et           t+1 [rt+1 +qt+1 (1                              ) qt+1                                                       +qt+1                          2 kt+1 ] = 0
@kt+1                                                                                                     2           kt+1                                        kt+1          kt+1
                                     @L                              1                                                     it
                                         =             (    t)               t   + qt         t           1                                           =0
                                     @it                                                                                   kt
                                                                                                                                                                       !
   @L                           1                 h                  i           1        1           3
                                                   1             3        1          3    1           3
            =   t (s)                         Et Vt+1                                                     (1             3 ) Vt+1 (s)
                                                                                                                                                        3   probt (s)        t+1 (s) probt (s)   =0
@Vt+1 (s)                 1             3

and
                                                               h       i                                  3
                                                                  1                               1           3
                          t+1 (s)           =    t (s)       Et Vt+1 3                                            Vt+1 (s)               3    for all states.



   The price of a one-period bond is given by

                                                                                                                        t+1
                                                             t   =            exp frt;1 g Et                                         :
                                                                                                                        t+1


J.1.1   Final Good Producers
The …nal good producer chooses yi;t for i 2 [0; 1] to solve:
                                                                                              Z           1
                                                                 maxPt yt                                     Pi;t yi;t di
                                                                 yt;i                                 0
                                                                                          Z       1               1              1
                                                            s.t. yt =                                 yi;t di
                                                                                              0

The …rst-order condition of the problem is given by

                                                                                              Pi;t
                                                                         yi;t =                                       yt
                                                                                              Pt

To …nd the expression for the aggregate price level we use the zero-pro…t condition
                                Z       1                        Z       1                                                                        Z     1
                                                                                          Pi;t
                     Pt y t =               Pi;t yi;t di =                   Pi;t                                     yt di = yt Pt                         (Pi;t )1    di
                                    0                                0                    Pt                                                        0




                                                                                              50
and then:
                                                           Z       1                               1
                                                                                                       1
                                                                                  1
                                               Pt =                    (Pi;t )            di
                                                               0


J.1.2   Intermediate Good Producer
The problem of the intermediate good producer is
                 1
                               "                                                                                                                                                              #
                 X               Pi;t+j Pi;t+j                                                                                                p        Pi;t+j 1                    2
                                                                                                                       k
    max Et         Dt;t+j Pt+j                 yt+j                                   wt+j hi;t+j                     rt+j ki;t+j                                          1           yt+j
ki;t ;hi;t ;Pi;t                 Pt+j   Pt+j                                                                                                  2       Pi;t+j 1 ss
                j=0

                                                                                              Pi;t
                                       s.t. at ki;t (zt hi;t )1                   =                              yt
                                                                                              Pt

plus a no-Ponzi-game condition.
   The Lagrange function for this problem reads:
           1
                          "                                                                                                                                                    #
          X                 Pi;t+j 1                                                                                           p         Pi;t+j 1                   2
                                                                                                    k
L = Et        Dt;t+j Pt+j               yt+j wt+j hi;t+j                                           rt+j ki;t+j                                                  1       yt+j
                            Pt+j                                                                                            2           Pi;t+j 1 ss
          j=0
             1
                                  "                                                                                                     #
            X                                                                                              Pi;t+j
        +Et    Dt;t+j Pt+j mci;t+j at+j ki;t+j (zt hi;t+j )1                                                                yt+j
                                                                                                           Pt+j
                j=0

   The …rst-order conditions for an interior solution are:
                                @L
                                     = Pt mci;t at ki;t 1 (zt hi;t )1                                        rtk = 0
                               @ki;t

                              @L
                                   = Pt         wt + mci;t (1                         ) zt1            at ki;t hi;t        =0
                             @hi;t


                 @L                                 Pi;t               1                            Pi;t 1                               1        1
                        = Pt Et f(1        )                              yt              p                                1                           yt
                @Pi;t                               Pt                 Pt                          Pi;t 1 ss                           Pi;t   1   ss
                                                                                                                          !
                                       Pt+1           Pi;t+1 1                                         Pi;t+1 1
                              Dt;t+1            p                                     1                  2                     yt+1
                                        Pt             Pi;t ss                                         Pi;t   ss
                                                           1
                                         Pi;t                  yt
                             +mci;t                               g=0
                                         Pt                    Pt
   or

                  Pi;t 1                yt                                            Pi;t                  yt
            p                  1                      = (1                    )
                 Pi;t 1 ss              P
                                      ss i;t    1                                     Pt                    Pt
                                                                          "                                                                                 #
                                                                    real                                   Pi;t+1 1                      Pi;t+1 yt+1
                                                               +Et Dt;t+1                      p                                   1         2
                                                                                                            Pi;t ss                       Pi;t    ss
                                                                                                             1
                                                                                          Pi;t                    yt
                                                               +mci;t
                                                                                          Pt                      Pt



                                                                         51
                          real
as Pt > 0 and Dt;t+1 = Dt;t+1   1      real Pt and D real =
                                   = Dt;t+1                     t+1
                                                                    .
                               t+1          Pt+1      t;t+1      t
    Since all …rms face the same problem, the three conditions simplify to

                                                   mct at kt              1
                                                                              (zt ht )1                = rtk
                                               wt = mct (1                         ) zt1       at kt ht
                      (       1)                   t+1       p        t+1                          t+1 yt+1                  p           t                  t
            mct =                     Et                                             1                            +                                 1
                                                       t                  ss                            ss yt                            ss                 ss


J.2   Aggregation and Market Clearing Conditions
The resource constraint is:
                                                                                               1
                                                              yt = ct + it                 t

The labor market clears when
                  Z                   Z                           !       1                                      !       1
                                                                                                                             Z
                      1                   1                           1                                              1               1
                                                  yi;t                                                  yt                                   Pi;t       1
           ht =           hi;t di =             1
                                                                               di =                                                                         di
                  0                   0        zt at kt                                        zt1       at kt                   0           Pt

or                                            "Z                                #     (1           )
                                                   1
                                                           Pi;t   1
                                   yt =                                       di                       at kt (zt ht )1
                                               0           Pt
The term in square brackets is the index of price dispersion across …rms. Under the assumption of
Rotemberg costs, …rms charge the same price and therefore this index is equal to one. Hence,

                                                            yt = at kt (zt ht )1

The …nal goods market clears when
                                                                                               1
                                                            yt = ct + (               t)           it

J.3   Equilibrium Conditions
For convenience, we enumerate the equilibrium conditions of the model,




                                                                              52
            Household
                                                                                                                                                                   h       i              1
                                                          1                                                          (1 ht )1               1                         1
                                                                                + (zt )(1                     2)
                         dt                                                                                                                                                           1       3
      1.    Vt =     1        2
                                      (ct        bct    1)
                                                                        2
                                                                                                                   0    1 1                     +                Et Vt+1 3
      2.     t   =       t dt (ct                bct    1)
                                                                    2            b Et               t+1 dt+1 (ct+1                         bct )            2

                                                                                                                                                        2
      3.    qt   t   = Et                       k
                                          t+1 [rt+1         + qt+1 (1                               ) qt+1 2 kit+1
                                                                                                                 t+1
                                                                                                                                                            + qt+1             it+1
                                                                                                                                                                               kt+1
                                                                                                                                                                                                  it+1
                                                                                                                                                                                                  kt+1 ]
                    1
      4.     t (zt )
                                  2
                                            0 (1       ht )             1   =           t wt
                                                      ii
      5.    1 = qt           t        1               kt h              i
                                                                t+1
      6.     t   =       exp frt;1 g Et                         t+1
            Firms
                                                   z t ht
      7.    mct at zt (1                     )      kt                  = wt
                                             1
                          zt ht
      8.    at mct                                    = rk
                           kt                         h t                                                                          i
                         ( 1)                                t+1            p           t+1                        t+1 yt+1                     p
      9.    mct =                                Et             t                       ss
                                                                                                         1             ss yt
                                                                                                                                       +                     t
                                                                                                                                                            ss
                                                                                                                                                                      1        t
                                                                                                                                                                              ss
            Central Bank
                                                                                                                                                      yt
      10.   rt;1 = (1                     r ) rss      +     r rt 1;1               +               log             t
                                                                                                                   ss
                                                                                                                          +            y   ln       zt Yss
            Other Relations
      11.   at kt (zt ht )1 = yt
      12.   yt = ct + ( t ) 1 it
                                                                                                        2
                                                                                 ii
      13.   kt+1 = (1                       ) kt + it               2            kt                           kt
                          1                                                      =(1            )
      14.   zt           t            zt and           z ;t                       ;t                    z;t
                                                            h                       i           3
                                                                    1           3           1       3
      15.    t+1 (s)          =           t (s)        Et Vt+1                                           Vt+1 (s)              3   for all states
            Exogenous Shocks
      16.   ln z;t = ln z;ss and zt+1                                                           zt        z;t+1
      17.   ln     ;t = ln   ;ss and  t+1                                                           t           ;t+1
      18.   ln at+1 = a ln at + a;t+1
      19.   ln dt+1 = d ln dt + d;t+1

J.4    A Transformation of the DSGE Model
As mentioned in the main text, we need to transform the model into a stationary one to e¢ ciently
                                                                                  ct     k       k
compute its solution by the perturbation method. To do so, we de…ne: Ct           zt , R t    t rt ,

Qt    t qt , It
                 it
                 tz
                    , Wt   wt
                           z , Yt
                                    yt
                                    z , Kt+1
                                                  kt+1
                                                    1  = kt+1
                                                          tz
                                                              , Vet    Vt
                                                                        1  2
                                                                             , and t        t
                                                                                                 2
                                                                                                   .
                                  t                     t                           t                                 1                             t                 (zt )                                t (zt   )
                                                                                                                      t    zt
It is useful to note that
                                                                                                                                                        2
                                                                                    t+1                         t+1 t+1         zt+1
                                                      ;t+1                                      =
                                                                                                                   t t (zt )
                                                                                        t                                                   2

                                                                                                                        h       i                           3
                                                                                      t+1                   2              1                            1       3
                                                                    =                               z ;t+1            Et Vt+1 3                                     Vt+13
                                                                                        t

The value of         that ensures that the capital adjustment costs do not a¤ect the steady state is given
by
                                                                                                        Iss
                                                                                                                       ;ss z ;ss
                                                                                                        Kss

                                                                                                                 53
    The new equilibrium conditions are then given by:
          Household
                                                                               1                                                                               h1
                                                                                                                                                                                  i       1
                                                                                       2              (1 ht )1             1             (1 2 )                                       1
           Vet =        dt
                                                   bCt 1 z 1;t                                                                                          Et Vg
                                                                                                                                                                              3               3
     1.             1        2
                                    Ct                                                     +        0    1 1                     +       z ;ss              t+1
                                                                                             20                                                      1 33
                                                                                                h h     1
                                                                                                            ii                               1
                                                                                                               1
                                                                                             6@ Et Vg
                                                                                                          3                                      3
     2.     t   = dt Ct                  bCt                1
                                                        1 z ;t
                                                                           2
                                                                                       b Et f4
                                                                                                    t+1
                                                                                                                                                     A 75
                                                                                                     Vg (s)                    t+1


                                                           1                   2
                                                                                                           2
            dt+1 Ct+1                        bCt         z ;t+1                         z ;t+1                 g
                                                                                                                                                                                                  2
                                  ;t+1     k                                                                           It+1                                        Iss
     3.    Qt = Et                       [Rt+1 + Qt+1 (1                                   )        Qt+1 2             Kt+1            ;t+1 z ;t+1                 Kss       ;ss z ;ss
                                  ;t+1
                             It+1                                                  Iss                                 It+1
           +Qt+1             Kt+1                 ;t+1 z ;t+1                      Kss           ;ss z ;ss             Kt+1            ;t+1 z ;t+1 ]
     4.     0 (1        ht )        1    =       t Wt
                                              It                                Iss
     5.    1 = Qt 1                           Kt    ;t z ;t                     Kss             ;ss z ;ss
                  h                                     i
                                             expfrt;1 g
     6.    1 = Et                  t+1              t+1
           Firms
                                          1
     7.    mct (1             ) at            ;t    Kt            z;t ht               = Wt
                                             1                    1
     8.    mct at            ;t Kt                      z;t ht             = Rtk                h                                                                            i
                     (        1)              p                                                                    p             t+1                 t+1 Yt+1
     9.    mct =                    +                     t
                                                         ss
                                                                   1            t
                                                                               ss
                                                                                           Et              ;t+1                  ss
                                                                                                                                         1             ss Yt        z ;t+1
           Central Bank
                                                                                                                                       Yt
     10.   rt;1 = (1               r ) rss         +         r rt 1;1      +               log         t
                                                                                                      ss
                                                                                                               +           y   log     Yss
           Other Relations
                             1
                                      1
     11.   at Kt         1
                             ;t     z;t             h1t           = Yt
     12.   Yt = Ct + It
                                                                                   1                                                                                     2                            1
                                                                                                            Ii                               Iss
     13.   Kt+1 = (1                     ) Kt                 ;t z ;t                  + It          2      Kt             ;t z ;t           Kss        ;ss z ;ss            Kt           ;t z ;t
                             =(1         )
     14.    z ;t              ;t                  z;t
                                                                          h        i                               3
                                     t+1 (s)                  2                1 3                             1       3
     15.        ;t+1 (s)     =                t          z    ;t+1 (s) Et   V t+1                                          Vt+1 (s)              3   for all states
           Exogenous Shocks
     16.   ln z;t = ln z;ss and zt+1                                                   zt      z;t+1
     17.   ln     ;t = ln   ;ss and  t+1                                                   t     ;t+1
     18.   ln at+1 = a ln at + a;t+1
     19.   ln dt+1 = d ln dt + d;t+1
    From these equilibrium conditions, it is straightforward to derive a closed-form solution for the
steady state of the model and, therefore, we skip the details.


K     Data for the Application
We use data from the Federal Reserve Bank of St. Louis covering the period 1961Q3 - 2007Q4.
The annualized growth rate in consumption is calculated from real consumption expenditures
(PCECC96). The series for real private …xed investment (FPIC96) is used to calculate the growth
rate in investment. Both growth rates are expressed in per capita terms based on the total popu-
lation in the US. The annual in‡ation rate is for consumer prices. The 3-month nominal interest

                                                                                                    54
rate is measured by the rate in the secondary market (TB3MS), and the 10-year nominal rate is
from Gürkaynak, Sack and Wright (2007). As in Rudebusch and Swanson (2012), observations for
the 10-year interest rate from 1961 Q3 to 1971 Q3 are calculated by extrapolation of the estimated
curves in Gürkaynak, Sack and Wright (2007). All moments related to interest rates are expressed
in annualized terms. Finally, we use average weekly hours of production and non-supervisory em-
ployees in manufacturing (AWHMAN) as provided by the Bureau of Labor Statistics. The series
is normalized by dividing it by …ve times 24 hours, giving a mean level of 0.34.




                                               55
References
Altig, D., Christiano, L. J., Eichenbaum, M. and Linde, J. (2011), ‘Firm-speci…c capital, nominal rigidities
     and the business cycle’, Review of Economic Dynamics 14, 225–247.
An, S. and Schorfheide, F. (2007), ‘Bayesian analysis of DSGE models’, Econometric Review 26(2-4), 113–
    172.
Andreasen, M. M. (2012), ‘On the e¤ects of rare disasters and uncertainty shocks for risk premia in non-linear
    DSGE models’, Review of Economic Dynamics 15, 295–316.
Andreasen, M. M. (Forthcoming), ‘Non-linear DSGE models and the central di¤erence kalman …lter’, Journal
    of Applied Econometrics .
Andreasen, M. M. and Zabczyk, P. (2010), ‘An e¢ cient method of computing higher order bond price
    perturbation approximations’, Working Paper .
Aruoba, S. B., Fernandez-Villaverde, J. and Rubio-Ramirez, J. F. (2006), ‘Comparing solution methods for
    dynamic equilibrium economies’, Journal of Economic Dynamics and Control 30, 2477–2508.
Barndor¤-Nielsen, O. E. (1997), ‘Normal inverse gaussian distributions and stochastic volatility modelling’,
    Scandinavian Journal of Statistics 24, 1–13.
Binsbergen, J. H. V., Fernandez-Villaverde, J., Koijen, R. S. and Rubio-Ramirez, J. (2012), ‘The term
    structure of interest rates in a DSGE model with recursive preferences’, Journal of Monetary Economics
    59, 634–648.
Calvo, G. A. (1983), ‘Staggered prices in a utility-maximizing framework’, Journal of Monetary Economics
    12, 383–398.
Christiano, L. J., Eichenbaum, M. and Evans, C. L. (2005), ‘Nominal rigidities and the dynamic e¤ects of a
     shock to monetary policy’, Journal of Political Economy 113, 1–45.
Cooley, T. F. and Prescott, E. (1995), Economic Growth and Business Cycles, Chapter 1 in Frontiers of
    Business Cycle Research, Ed. T. F. Cooley, Princeton University Press.
Creel, M. and Kristensen, D. (2011), ‘Indirect likelihood inference’, Barcelona GSE Working Paper Series .
Dridi, R., Guay, A. and Renault, E. (2007), ‘Indirect inference and calibration of dynamic stochastic general
     equilibrium models’, Journal of Econometrics 136, 397–430.
Du¢ e, D. and Singleton, K. J. (1993), ‘Simulated moments estimation of markov models of asset prices’,
    Econometrica 61(4), 929–952.
Epstein, L. G. and Zin, S. E. (1989), ‘Substitution, risk aversion, and the temporal behavior of consumption
    and asset returns: A theoretical framework’, Econometrica 57(4), 937–969.
Fernández-Villaverde, J., Guerrón-Quintana, P., Rubio-Ramírez, J. F. and Uribe, M. (2011), ‘Risk matters:
    The real e¤ects of volatility shocks’, American Economic Review 101, 2530–2561.
Fernández-Villaverde, J. and Rubio-Ramírez, J. F. (2007), ‘Estimating macroeconomic models: A likelihood
    approach’, Review of Economic Studies 74, 1–46.
Gürkaynak, R., Sack, B. and Wright, J. (2007), ‘The u.s. treasury yield curve: 1961 to the present’, Journal
    of Monetary Economics 54, 2291–2304.
Haan, W. J. D. and Wind, J. D. (2010), ‘Nonlinear and stable perturbation-based approximations’, Working
    Paper .
Hansen, L. P. (1982), ‘Large sample properties of generalized method of moments estimators’, Econometrica
    50(4), 1029–1054.
Hordahl, P., Tristani, O. and Vestin, D. (2008), ‘The yield curve and macroeconomic dynamics’, The Eco-
    nomic Journal 118, 1937–1970.


                                                     56
Jermann, U. J. (1998), ‘Asset pricing in production economics’, Journal of Monetary Economics 41, 257–275.
Jorda, O. (2005), ‘Estimation and inference of impulse rresponse by local projections’, American Economic
    Review 95(1), 161–182.
Judd, K. L. and Guu, S.-M. (1997), ‘Asymptotic methods for aggregate growth models’, Journal of Economic
    Dynamics and Control 21, 1025–1042.
Justiniano, A. and Primiceri, G. E. (2008), ‘The time-varying volatility of macroeconomic ‡uctuations’,
     American Economic Review 98(3), 604–641.
Kim, J., Kim, S., Schaumburg, E. and Sims, C. A. (2008), ‘Calculating and using second-order accurate
    solutions of discrete time dynamic equilibrium models’, Journal of Economic Dynamics and Control
    32, 3397–3414.
Kim, J.-Y. (2002), ‘Limited information likelihood and bayesian analysis’, Journal of Econometrics 107, 175–
    193.
King, R. G. and Rebelo, S. T. (1999), ‘Resuscitating real business cycles’, Handbook of Macroeconomics
    1, 927–1007.
Koop, G., Pesaran, M. H. and Potter, S. M. (1996), ‘Impulse response analysis in nonlinear multivariate
    models’, Journal of Econometrics 74, 119–147.
Lan, H. and Meyer-Gohde, A. (2011), ‘Solving dsge models with a nonlinear moving average’, SFB Discussion
     Paper .
Lombardo, G. and Sutherland, A. (2007), ‘Computing second-order accurate solutions for rational expecta-
   tion models using linear solution methods’, Journal of Economic Dynamics and Control 31, 515–530.
Peralta-Alva, A. and Santos, M. S. (2012), ‘Analysis of numerical errors’, Federal Reserve Bank of St. Louis,
     Working Paper Series .
Rotemberg, J. J. (1982), ‘Monopolistic price adjustment and aggregate output’, Review of Economic Studies
    49, 517–531.
Rudebusch, G. D. and Swanson, E. T. (2012), ‘The bond premium in a DSGE model with long-run real and
    nominal risks’, American Economic Journal: Macroeconomics 4(1), 1–43.
Ruge-Murcia, F. (2012), ‘Estimating nonlinear dsge models by the simulated method of moments: With an
    application to business cycles’, Journal of Economic Dynamic and Control 35, 914–938.
Ruge-Murcia, F. (2013), Generalized Method of Moments Estimation of DSGE models, In Handbook of
    Research Methods and Applications in Empirical Macroeconomics, N. Hashimzade and M. Thorton
    (Eds.), Edward Elgar Publishing: Cambley, United Kingdom.
Ruge-Murcia, F. J. (2007), ‘Methods to estimate dynamic stochastic general equilibrium models’, Journal
    of Economic Dynamics and Control 31, 2599–2636.
Schmitt-Grohé, S. and Uribe, M. (2004), ‘Solving dynamic general equilibrium models using a second-order
    approximation to the policy function’, Journal of Economic Dynamics and Control 28, 755–775.
Smith, J. A. A. (1993), ‘Estimating nonlinear time-series models using simulated vector autoregressions’,
    Journal of Applied Econometrics 8, Supplement: Special Issue on Econometric Inference Using
    Simulation Techniques, S63–S84.
Swanson, E. (2012a), ‘Risk aversion and the labor margin in dynamic equilibrium models’, American Eco-
    nomic Review 102(4), 1663–1691.
Swanson, E. T. (2012b), ‘Risk aversion, risk premia, and the labor margin with generalized recursive prefer-
    ences’, Working Paper .




                                                     57
          Figure 1: Impulse Response Functions: A Positive Technology Shock
The shock (one standard deviation) hits the economy in period one. All responses are displayed in
deviation from the steady state.
                                                 Approximation order = 1           Approximation order = 3
                                     -3   ct                                it                           -3     πt
                                 x 10                                                                x 10
                                                                                                0
                             6                         0.03

                             4                                                                  -1
                                                       0.02

                             2                         0.01
                                                                                                -2
                             0                            0
                                 0        10      20           0            10          20           0          10      20

                                     -3   rt,1                     -3      rt,40                              xhrt,40
                                 x 10                          x 10
                             0                            0                                   0.06

                                                        -0.5                                  0.04
                            -1

                                                          -1                                  0.02
                            -2
                                                        -1.5                                    0
                                 0        10      20           0            10          20           0          10      20

                                     -4   ht                       -5       st                                  at
                                 x 10                          x 10
                             0                            0
                                                                                             0.015
                            -1
                                                          -1                                  0.01

                            -2                                                               0.005

                                                          -2                                    0
                                 0        10      20           0            10          20           0          10      20




          Figure 2: Impulse Response Functions: A Positive Preference Shock
The shock (one standard deviation) hits the economy in period one. All responses are displayed in
deviation from the steady state.
                                                 Approximation order = 1           Approximation order = 3
                                     -3   ct                       -4       it                           -4     πt
                                 x 10                          x 10                                  x 10
                                                                                                0
                             2
                                                          0                                     -1

                             1                          -10
                                                                                                -2
                                                        -20
                             0                                                                  -3
                                 0        10      20           0            10          20           0          10      20

                                     -4   rt,1                     -4      rt,40                         -3   xhrt,40
                                 x 10                          x 10                                  x 10
                             0                            0
                                                                                                6
                            -1
                                                          -1                                    4
                            -2                                                                  2

                                                          -2                                    0
                                 0        10      20           0            10          20           0          10      20

                                     -5   ht                       -5       st                                  dt
                                 x 10                          x 10
                                                          0

                             2                            -2
                                                                                              0.01
                                                          -4
                             1
                                                                                             0.005
                                                          -6
                             0
                                                          -8                                    0
                                 0        10      20           0            10          20           0          10      20




                                                                        58
Table 1: Structural Parameter Values

           0.9925        r          0.85
     hss    0.33                     1.5
     b      0.65         y          0.25
      1       3              ;ss   1.0017
      2       2          z;ss      1.0052
      3     -100         ss         1.01
             2.2         a          0.95
           0.025         d          0.95
              6          a         0.015
      p      60          d         0.015




                    59
                                                                 Table 2: Euler-Equation Errors
The root mean squared errors using pruning (RMSEP ) and no pruning (RMSE) for a simulated time series
of length 1,000. Expected values in the model are computed by simulation using 5,000 draws from the
pruned and unpruned state-space system. Bold …gures indicate the smallest RMSEs among pruning and no
pruning. All …gures in the table are in pct. Unless stated otherwise, all values are as in table 1.
                                                                              First-order     Second-order        Third-order
                                                                                RMSE        RMSEP      RMSE     RMSEP     RMSE
 Benchmark
 H o u se h o ld ’s va lu e fu n c tio n                                       1.0767       0.9382    0.5998    0.4801    0.3269
 H o u se h o ld ’s F O C fo r c o n su m p tio n                              49.8994      1.8884    1.8069    0.7840    1.1971
 H o u se h o ld ’s F O C fo r c a p ita l                                     5.5079       0.2006    0.1976    0.0907    0.1473
 H o u se h o ld ’s F O C fo r la b o r                                        0.4605       0.1769    0.5305    0.0406    0.1831
 H o u se h o ld ’s F O C fo r inve stm e nt                                   0.0570       0.0092    0.1023    0.0023    0.0553
 E u le r-e q . fo r o n e -p e rio d inte re st ra te                         4.9705       0.1930    0.1922    0.0770    0.1320
 F irm ’s F O C fo r p ric e s                                                 3.8978       0.2026    0.1709    0.0903    0.0845
 In c o m e id e ntity                                                         0.1028       0.1004    0.1840    0.0405    0.1333
 L aw o f m o tio n fo r c a p ita l                                           0.1295       0.0239    0.2499    0.0056    0.1327
 Average error                                                                 7.3447       0.4148    0.4482    0.1790    0.2658

 High persistence:                              a   =        d   = 0:98
 H o u se h o ld ’s va lu e fu n c tio n                                        1.8825      6.6221    3.0231    5.6384    2.2791
 H o u se h o ld ’s F O C fo r c o n su m p tio n                              181.8721     9.1865    8.3405    8.9145    15.4374
 H o u se h o ld ’s F O C fo r c a p ita l                                     19.9495      0.9429    1.0339    1.0243    1.8109
 H o u se h o ld ’s F O C fo r la b o r                                         0.7648      0.4696    1.3413    0.1498    0.4961
 H o u se h o ld ’s F O C fo r inve stm e nt                                    0.0663      0.0282    0.2665    0.0150    0.1821
 E u le r-e q . fo r o n e -p e rio d inte re st ra te                         18.7110      0.9156    1.0238    0.8911    1.7093
 F irm ’s F O C fo r p ric e s                                                  9.4727      0.7172    0.4347    0.4474    0.5480
 In c o m e id e ntity                                                          0.1110      0.3803    0.4586    0.2607    0.5144
 L aw o f m o tio n fo r c a p ita l                                            0.1512      0.0692    0.7438    0.0354    0.4929
 Average error                                                                 25.8868      2.1480    1.8518    1.9307    2.6078

 Large innovations:                                 a    =       d   = 0:03
 H o u se h o ld ’s va lu e fu n c tio n                                        4.4465      10.1303   7.3526    8.1361    5.5356
 H o u se h o ld ’s F O C fo r c o n su m p tio n                              218.0656     15.8641   22.9393   6.8636    15.1922
 H o u se h o ld ’s F O C fo r c a p ita l                                     23.9441      1.5927    2.8050    0.8592    1.9245
 H o u se h o ld ’s F O C fo r la b o r                                         1.9394      1.3750    6.4531    0.6253    3.0742
 H o u se h o ld ’s F O C fo r inve stm e nt                                    0.2342      0.0900    1.2748    0.0388    0.9580
 E u le r-e q . fo r o n e -p e rio d inte re st ra te                         21.4173      1.5066    2.7476    0.5999    1.6973
 F irm ’s F O C fo r p ric e s                                                 20.1843      1.7089    1.8530    1.4076    1.3676
 In c o m e id e ntity                                                          0.4258      1.1276    1.7264    0.7266    2.9088
 L aw o f m o tio n fo r c a p ita l                                            0.5276      0.2533    4.0972    0.1029    2.8683
 Average error                                                                 32.3539      3.7387    5.6943    2.1511    3.9474




                                                                                     60
                                       Table 3: Estimation Results
The objective function is computed using the optimal weighting matrix with 10 lags in the Newey-West
estimator. The objective function for SMM is computed using 200.000 simulated observations.
                                            GMM2nd       GMM3rd         SMM3rd
                                             0:9925       0:9926         0:9926
                                             (0:0021)        (0:0002)   (0:0023)
                              b              0:6889          0:7137     0:7332
                                             (0:0194)        (0:0004)   (0:0085)
                              hss            0:3402          0:3401     0:3409
                                             (0:0010)        (0:0004)   (0:0065)
                                  1          6:1405          6:1252     6:1169
                                             (1:2583)        (0:0002)   (0:0040)
                                  2          1:5730          1:5339     1:5940
                                             (0:1400)        (0:0008)   (0:0009)
                                  3           196:31          197:36     194:22
                                             (51:90)          (0:01)     (0:01)
                                             4:1088          3:5910     3:5629
                                             (0:7213)        (0:0160)   (0:1085)
                                             0:9269          0:9189     0:9195
                                             (0:0044)        (0:0026)   (0:0024)
                                  r          0:6769          0:6759     0:6635
                                             (0:6086)        (0:0723)   (0:1464)
                                             3:9856          3:6974     3:6216
                                             (8:2779)        (0:7892)   (1:8555)
                                  y          0:5553      0:50691        0:5027
                                             (1:5452)        (0:1465)   (0:3685)
                                      ;ss    1:0018          1:0017     1:0016
                                             (0:0012)        (0:0007)   (0:0006)
                                  z;ss       1:0050          1:0051     1:0052
                                             (0:0005)        (0:0004)   (0:0003)
                                  a          0:9192          0:9165     0:9139
                                             (0:0081)        (0:0030)   (0:0036)
                                  d          0:9915          0:9914     0:9911
                                             (0:0023)        (0:0005)   (0:0019)
                                  ss         1:0407          1:0419     1:0432
                                             (0:0134)        (0:0022)   (0:0057)
                                             0:0171          0:0183     0:0183
                                             (0:0006)        (0:0005)   (0:0003)
                                  d          0:0144          0:0144     0:0143
                                             (0:0017)        (0:0005)   (0:0018)
                              skewa                                     0:2296
                                                                        (0:0298)
                              taila                                     1:2526
                                                                        (0:0437)
                              skewd                                     0:0693
                                                                        (0:4530)
                              taild                                     1:1329
                                                                        (3:4724)




                                                        61
                                             Table 4: Model Fit
Except for the log of hours, all variables are expressed in annualized terms.
                                                   Data    GMM2nd       GMM3rd     SMM3rd
               Means
                  ct 100                           2.439     2.399        2.429     2.435
                  it 100                           3.105     3.111        3.099     3.088
                 t   100                           3.757     3.681        3.724     3.738
               rt;1 100                            5.605     5.565        5.548     5.582
               rt;40 100                           6.993     6.925        6.955     6.977
               xhrt;40 100                         1.724     1.689        1.730     1.717
               log ht                             -1.084     -1.083       -1.083   -1.083

               Standard deviations (in pct)
                 ct                               2.685      1.362        1.191    1.127
                 it                               8.914      8.888        8.878    8.944
                t                                 2.481      3.744        3.918    3.897
               rt;1                               2.701      4.020        4.061    4.060
               rt;40                              2.401      2.325        2.326    2.308
               xhrt;40                            22.978     22.646       22.883   22.949
               log ht                             1.676      3.659        3.740    3.721

               Auto-correlations: 1 lag
               corr ( ct ; ct 1 )                  0.254      0.702       0.726    0.7407
               corr ( it ; it 1 )                  0.506      0.493       0.480    0.4817
               corr ( t ; t 1 )                    0.859      0.988       0.986    0.9861
               corr (rt;1 ; rt 1;1 )               0.942      0.989       0.987     0.987
               corr (rt;40 ; rt 1;40 )             0.963      0.969       0.969     0.968
               corr (xhrt;40 ; xhrt 1;40 )        -0.024      0.000       -0.003   -0.003
               corr (log ht ; log ht 1 )           0.792      0.726       0.678    0.6706




                                                     62
                                         Table 4: Model Fit (continued)

                                                 Data    GMM2nd         GMM3rd      SMM3rd
                   corr (   ct ; it )            0.594      0.590         0.579       0.582
                   corr (   ct ; t )            -0.362     -0.238        -0.296      -0.310
                   corr (   ct ; rt;1 )         -0.278     -0.210        -0.274      -0.290
                   corr (   ct ; rt;40 )        -0.178    -0.3337        -0.355      -0.366
                   corr (   ct ; xhrt;40 )       0.271      0.691         0.655       0.641
                   corr (   ct ; log ht )        0.065     -0.677        -0.670      -0.674

                   corr (   it ; t )            -0.242        -0.075     -0.098     -0.098
                   corr (   it ; rt;1 )         -0.265        -0.058     -0.084     -0.088
                   corr (   it ; rt;40 )        -0.153        -0.130     -0.133     -0.135
                   corr (   it ; xhrt;40 )       0.021         0.015      0.024      0.027
                   corr (   it ; log ht )        0.232        -0.398     -0.406     -0.418

                   corr (   t ; rt;1 )           0.628         0.994      0.997      0.997
                   corr (   t ; rt;40 )          0.479         0.990      0.988      0.987
                   corr (   t ; xhrt;40 )       -0.249        -0.130     -0.142     -0.141
                   corr (   t ; log ht )        -0.467         0.132      0.128     0.154

                   corr (rt;1 ; rt;40 )          0.861         0.986      0.991      0.991
                   corr (rt;1 ; xhrt;40 )       -0.233        -0.122     -0.137     -0.138
                   corr (rt;1 ; log ht )        -0.369         0.177      0.153     0.180

                   corr (rt;40 ; xhrt;40 )      -0.121        -0.247     -0.248     -0.249
                   corr (rt;40 ; log ht )       -0.409         0.229      0.238     0.268

                   corr (xhrt;40 ; log ht )     -0.132        -0.644     -0.680     -0.690




                                   Table 5: Model Speci…cation Test
The objective function is computed using the optimal weighting matrix with 10 lags in the Newey-West
estimator. We have 186 observations. The objective function for SMM is computed using 200.000
simulated observations.
                                                     GMM2nd            GMM3rd     SMM3rd
                      Objective function: Q          0.0920            0.1055     0.0958
                      Number of moments              42                42         54
                      Number of parameters           18                18         22
                      P-value                        0.8437            0.7183     0.9797




                                                         63
          Table 6: Higher-Order Moments

              Data    GMM2nd    GMM3rd   SMM3rd
Skewness
  ct         -0.679     0.024    0.034   0.193
  it         -0.762    -0.191   -0.254   -0.122
 t            1.213     0.013    0.014   -0.054
rt            1.053     0.012    0.011   -0.051
rt;40         0.967     0.014    0.017   -0.043
xhrt;40       0.364    -0.026   -0.028    0.368

Kurtosis
 ct           5.766    3.011     3.015    3.547
 it           5.223    3.157     3.279    4.425
 t            4.232    2.987     2.985    3.040
rt            4.594    2.968     2.975    3.033
rt;40         3.602    2.987     2.979    3.028
xhrt;40       5.121    3.003     3.006    5.167




                         64
