                              NBER WORKING PAPER SERIES




                RANDOM-COEFFICIENTS LOGIT DEMAND ESTIMATION
                     WITH ZERO-VALUED MARKET SHARES

                                      Jean-Pierre H. Dubé
                                         Ali Hortaçsu
                                          Joonhwi Joo

                                      Working Paper 26795
                              http://www.nber.org/papers/w26795


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                    February 2020




We thank Giovanni Compiani, Jonas Lieber, Olivia Natan, and seminar participants at Erasmus
University for valuable comments and suggestions. Andrew Wooders provided excellent research
assistance. Hortaçsu gratefully acknowledges financial support from the National Science
Foundation (SES 1426823) and Dubé acknowledges the Kilts Center for Marketing at the
University of Chicago Booth School of Business and the Charles E. Merrill faculty research fund
for financial support. All errors are our own. The views expressed herein are those of the authors
and do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2020 by Jean-Pierre H. Dubé, Ali Hortaçsu, and Joonhwi Joo. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including © notice, is given to the source.
Random-Coefficients Logit Demand Estimation with Zero-Valued Market Shares
Jean-Pierre H. Dubé, Ali Hortaçsu, and Joonhwi Joo
NBER Working Paper No. 26795
February 2020
JEL No. D12,L00,L66,L81,M3

                                         ABSTRACT

Although typically overlooked, many purchase datasets exhibit a high incidence of products with
zero sales. We propose a new estimator for the Random-Coefficients Logit demand system for
purchase datasets with zero-valued market shares. The identification of the demand parameters is
based on a pairwise-differencing approach that constructs moment conditions based on
differences in demand between pairs of products. The corresponding estimator corrects non-
parametrically for the potential selection of the incidence of zeros on unobserved aspects of
demand. The estimator also corrects for the potential endogeneity of marketing variables both in
demand and in the selection propensities. Monte Carlo simulations show that our proposed
estimator provides reliable small-sample inference both with and without selection-on-
unobservables. In an empirical case study, the proposed estimator not only generates different
demand estimates than approaches that ignore selection in the incidence of zero shares, it also
generates better out-of-sample fit of observed retail contribution margins.

Jean-Pierre H. Dubé                                   Joonhwi Joo
University of Chicago                                 800 W. Campbell Rd.
Booth School of Business                              JSOM 13-326
5807 South Woodlawn Avenue                            Richardson, TX 75080
Chicago, IL 60637                                     USA
and NBER                                              joonhwi.joo@utdallas.edu
jdube@chicagobooth.edu

Ali Hortaçsu
Kenneth C. Griffin Department of Economics
University of Chicago
1126 East 59th Street
Chicago, IL 60637
and NBER
hortacsu@uchicago.edu
1 Introduction
The seminal work by Berry (1994) and Berry et al. (1995) has generated a surge in empirical case

studies that estimate discrete choice demand in the presence of endogenous marketing variables.
                                                                                                               1 To

obtain a viable aggregate demand prediction, the underlying model assumes that a market comprises

a mass of consumers making discrete choices with non-zero choice probabilities for each of the

available products. The combination of a continuum of consumers and non-zero choice probabilities

is central to the estimation methodology. In turn, it also implies that each available product has a

strictly positive market share.

      In practice, many markets have products that fail to generate sales and exhibit zero market

shares, even in the presence of a very large underlying consumer population.                    Conceptually, the

observation of any products with a zero-valued market share rejects Berry et al. (1995)'s underlying

model of demand.          In practice researchers impose ad hoc modications of the data themselves

to force-t them to exhibit strictly positive shares through product aggregation, time aggregation

and/or selective trimming of the data sample to eliminate problematic observations. These ad hoc

procedures are quite prevalent, often unbeknownst to the researcher. For instance, retail scanner

data from IRI and Nielsen typically only report sales and marketing data for products that sold

at least one unit in a given market. Force-tting the model to these manipulated data potentially

biases demand estimation, with adverse eects on estimated preferences and policy simulations

based on the demand estimates. Of particular concern is the potential selection bias associated with

a systematic modication or truncation of observations with zero shares.

      To resolve the zero-market-share problem, we propose a new model of discrete choice demand

that addresses the potential selection process determining whether a product generates a zero versus

a positive market share. Our model includes a regime-switching process through which products are

included or excluded from the choice set. This switching propensity serves as a selection correction

procedure that allows each available product's predicted demand to switch between a zero share and

the strictly positive predicted share from the usual discrete choice model. While the paper focuses

primarily on discrete-choice demand, we show that it is straightforward to apply the identication

and estimation below to the CES demand model that is popular in the trade literature (e.g., Adao

et al., 2017; Helpman et al., 2008).

      The identication of our model primitives  the distribution of consumer preferences  relies on a

novel modication of the moment conditions proposed in Berry et al. (1995). In addition to the usual

concerns about the potential endogeneity of prices in consumers' choices, we also account for the

selection of market shares on unobserved shocks and we allow endogenous variables such as prices to

enter into the selection equation. We rely on two sets of instruments. The rst set comprises the usual

instruments to correct for price endogeneity: instruments for prices that are excluded from both the

consideration and purchase decisions. The second set contains new consideration instruments that

  1
      See for instance the survey by Nevo (2011), in economics, and Chintagunta et al. (2006), in marketing.




                                                           2
aect which products are eectively considered by consumers when they make their choices; but are

excluded from the consumption utilities. These instruments could reect consumer attention and

the in-store search process, on the demand side, or availability and stock-outs, on the supply side.

Following the literature on pairwise-dierence estimation (e.g., Ahn and Powell, 1993; Blundell and

Powell, 2004; Powell, 2001; Honoré and Powell, 2005; Aradillas-Lopez et al., 2007; Aradillas-Lopez,

2012), we then construct pairwise-dierence moments that resolve the selection of product market

shares on unobserved aspects of demand. To the best of our knowledge, this is the rst application

of pairwise-dierence estimation in the context of demand estimation.

       We then propose a three-step estimation procedure that allows for a fully non-parametric se-

lection stage. In the rst step, we estimate the reduced-form of prices, which we use to construct

a control function (Blundell and Powell, 2004).             Unlike Petrin and Train (2010), we only use the

control function to address price endogeneity in the selection-stage, not in the consumers' discrete

choice stage. In the second stage, we nonparametrically estimate the product selection process using

the control function to account for potential price endogeneity. Our nonparametric selection stage

allows us to be agnostic about the exact mechanism determining which of the available products

enter consumers' choice sets and generate positive shares. In our third stage, we estimate the de-

mand primitives of interest using a pairwise-dierenced, weighted GMM estimator (PDWGMM)

with nonparametric selection propensities as weights to resolve the selection problem.
             
       The      n-consistency   of our PDWGMM estimator follows from Aradillas-Lopez et al. (2007). We

propose a bootstrap algorithm to conduct inference on the PDWGMM estimates. A series of Monte

Carlo experiments verify the nite-sample performance of our estimator and the biases that arise

from usual ad hoc data xes to implement Berry et al. (1995)'s GMM estimator when it is subject

to selection concerns. Conventional estimators that ignore selection exhibit biases that would lead

to incorrect inferences about demand and preferences. They also conrm that PDWGMM produces

consistent estimates comparable to conventional approaches when the data generating process does

not exhibit selection on unobservables or when the data generating process does not produce zero

market shares at all.

       We apply our PDWGMM estimator to an empirical case study of the ice cream category using 18

months of daily, store-level point-of-sale data from a midwestern supermarket chain. A distinctive

feature of these data is that we observe daily prices, unit costs, and feature advertising information

even when a product does not sell.
                                           2 A typical store carries around 400-500 unique ice cream UPCs

on a given day; but over 60% of these products fail to sell at least one unit that day. Collapsing the

time dimension to the monthly or quarterly level does not eliminate the zeros and could introduce an

unintended aggregation bias due to time-varying marketing conditions (e.g., Gupta et al., 1996) In

sum, weekly or even monthly frequency data do not resolve the zeros problem. Combining products

into items by aggregating across pack sizes and avors for a given brand would also eliminate some

   2
       Most point-of-sale databases from providers like IRI and Nielsen have missing observations for products that do
not sell in a given market and are typically aggregated to the weekly level.




                                                           3
of the zero-share issues. However, such aggregation would be impractical for the analysis of optimal

product variety and consumer value creation.

   We estimate the Random-Coecients Logit demand for ice cream using our PDWGMM esti-

mator. We compare these results to those obtained from the conventional GMM estimator of the

Random-Coecients Logit demand model t to data that either drop observations with zero mar-

ket share or impute a numerically small value.    We nd that PDWGMM generates considerably

more price elastic estimates of demand than alternative, ad hoc solutions to the zero-market-share

problem.

   Finally, we exploit product margin data to construct a specication test of our PDWGMM

estimator that accounts for the potential selection bias associated with products generating a zero-

valued market share. Our test consists of predicting the retailer's product-specic margins using our

demand and elasticity estimates under various assumptions about pricing conduct. For each of the

conduct assumptions, we nd that PDWGMM generates a much better t of the observed margins

than ad hoc approaches.

   The model and estimation procedure contribute to the vast extant literature on aggregate

discrete-choice demand estimation by accommodating zero shares. In related work, Gandhi et al.

(2019) propose a dierent modeling solution that treats the average purchase probabilities as a miss-

ing data problem and market shares as an imperfect proxy. In their model, zero market shares arise

from sampling error due to a small consumer population.     They formulate a moment inequalities

estimator that generates bounds for the preference parameters of interest. However, zero shares are

often observed even in very large markets with tens of thousands of underlying consumers, such as

large chain-store supermarkets and mass merchandisers. We propose an approach that allows for

zero-valued market shares even with a very large underlying consumer population. We also use the

product margin data to construct a model specication test.

   An advantage of our nonparametric selection stage is that we remain agnostic about the mech-

anism causing some products to generate zero share of sales.     This mechanism could be limited

consideration by consumers, or stock-outs/unavailability of the product on the shelf. Our consider-

ation instruments connect our approach to the literature on consumer consideration sets whereby

consumers often consider only a small portion of the available products when making purchase de-

cisions (e.g., Hauser, 1978; Ratchford, 1980; Shugan, 1980; Hauser and Wernerfelt, 1990; Moorthy

et al., 1997; Kim et al., 2010; Honka, 2014; Bronnenberg et al., forthcoming). Integrating the addi-

tional structure through which consumers search for products and form consideration sets typically

requires individual-level data on consumers' heterogeneous consideration sets (e.g., Honka, 2014) or

at least additional moments on the search ranks in addition to market shares conditional on search

Kim et al. (2017).   In addition to data, these approaches require additional conduct assumptions

about consumer search and attention. A recent exception is Abaluck and Adams (2018) which ex-

ploits the Slutsky symmetry property of full-information discrete choice demand models to identify

a test for limited consideration. However, their approach cannot account for the zero market shares



                                                 4
encountered in aggregate data sets and their estimator would not accommodate endogenous regres-

sors. Since our selection process is agnostic, our work also relates to demand estimation with data

that aggregates market shares across stores and time periods with dierent choice sets due, for

instance, to diering promotional conditions or product availabilities (e.g., Tenn, 2006; Bruno and

Vilcassim, 2008) and stock-outs (e.g., Conlon and Mortimer, 2013).

    Our work is also related to Helpman et al. (2008)'s CES demand estimation framework for bilat-

eral trades when zero trade shares are observed, albeit with a fully parametric selection stage that

does not allow for endogenous covariates during the selection stage and without random coecients.

We add to this work by developing a nonparametric selection stage that potentially exhibits price

endogeneity, and by allowing for random coecients in the demand model.

    The remainder of this paper is organized as follows.                       Section 2 derives the model of demand,

consideration and pricing. Sections 3 and 4 present the identication and estimation of the model,

respectively. Section 5 presents the results from a Monte Carlo study. Empirical results are presented

in section 6. Section 7 shows the extension of our framework to the CES demand system.




2 Model
2.1     The Random-Coecients Logit Demand System
We briey discuss the derivation of the Random-Coecients Logit demand system used extensively

in the aggregate demand estimation literature. Consumers make purchases from the set of available

substitute products         J = {1, ..., J + 1}     with corresponding prices            p = (p1 , ..., pJ +1 )   and where the

J +1     product is a no purchase or outside option with price                            pJ +1 = 0.      Consumer     h   spends

her budget       y   to maximize a utility function        U       q, y ;  h    dened over her consumption choices,

q = (q1 , ..., qJ +1 ) ,   and expenditure on an essential numeraire good,                 q0 :

                                                          J +1
                                        U q, y ;  h =              h        h
                                                                   j qj exp  q0
                                                          j =1


where   h
        j    is household      h's   perceived quality of product         j    and   h   is the preference for the essential

numeraire good. Assume perceived quality consists of a deterministic and a stochastic component:

h          h
j = exp xj  + j +
                                h
                                j     and   h
                                            J +1 = exp
                                                           h
                                                           J +1 , where
                                                                                h
                                                                                j       i.i.d. EV(0, 1)   j , xj   is a vector of

                           j is a scalar vertical characteristic that is unobserved by the researcher
exogenous product attributes,
    h
and  are taste parameters for the characteristics. When consumption is discrete, qj  {0, 1} j ,

consumer     h   faces the following choice-specic indirect utilities (in logs):


                                         uh
                                          j    = h (y - pj ) + xj  h + j +                 h
                                                                                           j
                                                .
                                                .                                                                           (2.1)
                                                .

                                        uh      h
                                         J +1 =  y +
                                                             h .
                                                             J +1


                                                               5
                                                                 h
We assume household            h's   preferences    h :=                  follows a distribution    F  h ;          parameterized
                                                                 h
by   .
     The household-specic mean utility of alternative                       j   becomes:



                                     ¯h
                                     u  ¯h
                                      j u
                                           h
                                         j  ,
                                              h
                                                = h (y - pj ) + xj  h + j .                                                 (2.2)



The predicted market share for product                j    is then


                          j (p, x,  ; ) =                                       dF        h    dF  h ; 
                                                      {h ,      h |uh uh ,k =j
                                                                j   j  k       }
                                                                 exp(h pj +xj  h +j )                                       (2.3)
                                                 =              J
                                                                                              dF  h ;  .
                                                           1+       exp(h pk +xk  h +k )
                                                             k=1


An important feature of this model is that the predicted market shares must be strictly positive:

j (p, x,  ; ) > 0, j .

2.2      Product Selection
We assume that the no purchase option                     J +1       always enters consumers' choice sets. However, for

each of the    j = 1, ..., J   products, we let      dj  {0, 1} indicate whether product j                 enters the choice sets

or not. Let     C = {j  J |dj = 1          or   j = J + 1}          denote those products that enter consumers' choice

sets. To model the selection process through which products enter consumers' choice sets, let



                                         dj = 1 ( (wj ) + j > 0) , j = 1, ..., J                                            (2.4)



where    wj   is a vector of observed (to the researcher) selection-generating factors and                        j  G (·)      is a

random selection shock with continuous and strictly increasing distribution                           G (·).    In principle,   wj
could include product attributes and prices for product                         j   as well as its competitors.

     We focus on the case where the regime-switching process selects a product out of the choice set,

dj = 0:
                                                          exp(h pj +xj  h +j )
                                                
                                                     1+     exp(h pk +xk  h +k )
                                                                                       dF  h ;  , dj = 1
                   j (p, x,  ; ) =                    kC                                                        .           (2.5)
                                                0,                                                     dj = 0

As we discuss in section 3 below, product selection complicates the estimation of the demand system

(2.3), especially when demand shocks are correlated with selection shocks:                            cov (j , j ) = 0.

2.3      Pricing
A long extant literature on demand estimation has analyzed the role of rms that strategically

condition their prices on aspects of demand that are unobserved to the researcher (e.g.,                                   Berry,



                                                                      6
1994; Berry et al., 1995; Besanko et al., 1998). Suppose that the reduced-form of equilibrium prices

in the market can be written as:

                                                    pj =  (rj ; ) + j                                                  (2.6)


where    rj = (~    ~j )
               xj , z      and   ~j
                                 z    are supply-shifting factors that inuence rms' marginal costs and are

excluded from the choice-specic utilities (2.1), and                 j  F (·)    is a random supply shock. As we

discuss in section 3.1 below, strategic pricing can also complicate the estimation of the demand

system (2.3) when      cov (j , j ) = 0,     or   cov (j , j ) = 0,   or both.




3 Identication
3.1     BLP's Moment Conditions and Zero Shares
We now discuss the estimation of the demand system (2.3) from section (2.1). At least since Berry

(1994) and Berry et al. (1995), the extant literature has focused on demand estimation in the presence

of endogenous prices:       cov (pj , j ) = 0.
   From the model section, we can construct moment conditions:



                                                        E [j |zj ] = 0                                                 (3.1)



where as before                ~j )
                    zj = (xj , z       are the price instruments. We can then construct the empirical analog

of these moment conditions. Let            s = (s1 , ..., sJ +1 )   be the vector of observed market shares. Using

the demand model (2.3), we can dene the following mapping between the demand shocks                                      and

the observed market shares:



                                                   sj = j (p, x,  ; ) .                                                (3.2)



Berry (1994) proves that the market share equations in (3.2) are invertible in the demand shocks:

 () =  -1 (x, s; ).          Berry et al. (1995) propose a GMM estimator using the empirical moments:



                                                   E [j () |zj ] = 0.                                                  (3.3)



   If   sj = 0 even for only one product, we reject the demand model in section (2.1) and the inversion
procedure used to construct empirical moments is no longer valid. In practice, many micro datasets

contain observations with zero market shares even when a product was available for sale, leading to

the alternative formulation of demand in (2.5). The incidence of zero shares is not a new problem.

As discussed in Cooper and Nakanishi (1988), most researchers manually alter the observed data ad

hoc to force all the shares to be strictly positive. Two ad hoc data modications are typically used

in practice: (i) impute an arbitrarily small value whenever                 dj = 0   (e.g.,   sj = 1.e-12   if   dj = 0);   or




                                                               7
(ii) drop all observations with            dj = 0    (i.e., assume   j/ J ).3   We expect approach (i) to suer from

a bias that is sensitive to the specic small number used for the imputation.

        Recently, Gandhi et al. (2019) proposed a modied version of the imputation procedure. They

start with the assumption that zero-valued market shares arise from small markets with too few con-

sumers for the market shares,             sj ,   to provide a reliable approximation of the expected unconditional

choice probabilities,         j ,   from the discrete choice model. They derive lower and upper bounds for

j   using     sj .    These bounds can accommodate observations where                sj = 0   by introducing a Laplace

correction factor that forces             sj  (0, 1).    Standard bounds estimation techniques are then applied

to construct an estimator (e.g., Manski and Tamer, 2002; Imbens and Manski, 2004; Chernozhukov

et al., 2007; Ciliberto and Tamer, 2009).

        We are more concerned with approach (ii), which is much more commonly used in practice.
                                                                                                                     4

Using the selection model in section 2.2, approach (ii) consists of using the following moment con-

dition:

                                                      E [j |zj , dj = 1] = 0.                                    (3.4)


Moment condition (3.4) may hold if there is no selection on unobservable product characteristics,

cov (j , j ) = 0,         implying that the dropped observations with               dj = 0    are missing at random.

However, if          cov (j , j ) = 0,   we are concerned with the potential for selection bias associated with

dropping observations with zero shares:                 E [j |zj , dj = 1] = 0.   In this case, GMM estimation using

(3.4) will not produce consistent estimates of               .

3.2        Accommodating Zero-Valued Shares
We now derive a new set of moment conditions that can be used to obtain consistent GMM esti-

mates of             with zero market shares and          cov (j , j ) = 0.     The estimator also accommodates the

endogeneity bias that arises when prices are correlated with both demand shocks and selection

shocks:      cov (pj , j ) = 0      and   cov (pj , j ) = 0.    Our solution consists of using moment conditions

based on dierences, as in the pairwise-dierence estimation literature (e.g., Ahn and Powell, 1993;

Blundell and Powell, 2004; Powell, 2001; Honoré and Powell, 2005; Aradillas-Lopez et al., 2007;

Aradillas-Lopez, 2012).

    3
        Researchers frequently use yet another approach whereby each of the products is aggregated up to the brand
level, often combining dozens of dierent products (e.g., dierent pack sizes, avors etc) into a composite brand
alternative (e.g., Nevo, 2001).
    4
        Most CPG datasets only report market shares for products in a given market that had a positive quantity sold.
For instance, data suppliers like Nielsen and IRI Marketing receive quantity and revenue data from retail partners and,
therefore, cannot determine the average price for a product that did not have any sales. Consequently, researchers
using such scanner data implicitly use assumption (ii).




                                                                 8
3.2.1 Pairwise-Dierence Moment Condition
Let   µj   denote the propensity score for alternative                   j   not being selected into the choice set. We assume

that   µj    is continuously distributed and that there exists an unknown, smooth, strictly increasing

function       (·)   such that we can re-write the demand shocks as follows:



                                                                  j =  ( µj ) + j ,                                         (3.5)



with   E [j |µj , zj ] = 0.       Even if   E [j |zj , dj = 1] = 0, we can construct an alternative moment condition
based on dierences between the demand shocks of two goods                                i   and   j:

                                            E [i - j |zi , zj , µi = µj , di = dj = 1] = 0.                                 (3.6)



The use of a moment based on dierences follows from the pairwise-dierence estimation literature

(e.g., Ahn and Powell, 1993; Blundell and Powell, 2004; Powell, 2001; Honoré and Powell, 2005;

Aradillas-Lopez et al., 2007; Aradillas-Lopez, 2012).

      To illustrate, consider the Homogeneous Logit model of demand which has a degenerate distri-

bution of random coecients. Using (3.5), we can invert the demand model as follows:


                                                         sj
                                               ln              = pj + xj  +  (µj ) + j .
                                                         s0

Now consider a pair of products                     i   and   j   with the same non-selection propensities,     µi = µj ,    and

hence       ( µi ) =  ( µj ) :

                                                         si
                                               ln              = pi + xi  +  (µi ) + i
                                                         s0
                                                         sj
                                               ln              = pj + xj  +  (µj ) + j .
                                                         s0

Taking dierences yields:


                                    si                  sj
                             ln          - ln                 =  (pi - pj ) + (xi - xj )  + (i - j ) .
                                    s0                  s0

We can then construct the following conditional moment for estimation purposes:



                                            0 = E [i - j |zi , zj , µi = µj , di = dj = 1]
                                              = E [i - j |zi , zj , µi = µj , di = dj = 1] .                                (3.7)



      An obvious limitation of the pairwise-dierence formulation is that the intercept term of the

indirect utility function is not identied. Since the intercept term is typically a nuisance term in

most applications, this will not prevent the researcher from predicting market shares and conducting



                                                                         9
policy experiments with the estimated model. In sum, the levels of                          ^j
                                                                                                 contain both the absorbed

intercept term and the factors driving selection on unobservables. It is not possible to disentangle

these two components separately.

    In the next section, we discuss instruments that vary the propensities,                          µi   and     µj ,   independently

of preferences.



3.2.2 Non-Selection Propensities
The identication of the propensities             µj   relies on consideration instruments that are excluded from

the choice-specic utilities (2.1) but are allowed to be correlated with the demand shocks                                   j   through

cov (j , j ).    We dene the propensity score              µj   as the expectation of the selection variable                      1 - dj
conditional on the observed prices           pj , product attributes and price instruments zj , and consideration
instruments      ~ j:
                 w
                                                µj = 1 - E [dj |pj , zj , w
                                                                          ~ j] .                                                   (3.8)


The consideration instruments,             ~ j , could include promotions such as feature advertising and in-store
                                           w
displays which are known to aect demand, but are unlikely to generate                                 consumption value            (e.g.,

Mehta et al., 2003).

    A concern that has not previously been considered in the extant demand estimation literature

(i.e.,   C = J)     is the potential for price endogeneity during the selection process if                           cov (j , j ) = 0
causing    pj   to correlate with    j .   Our solution consists of constructing a control variable                        j    from the

pricing equation such that the moment condition (3.6) is valid with                                    ~ j ), µj = µ (wj )
                                                                                             wj = (j , w
where    µ (wj )    is dened by:



                µ (wj ) := 1 - E [dj |wj ] = 1 - E [1 ( (wj ) + j > 0) |wj ] = 1 - G (- (wj ))                                     (3.9)



where     µ (wj )   is the (reduced-form) conditional probability of product                     j   not being included in the

subset of alternatives being selected and                (·)    is an unknown function.              We can then construct a

control function using the assumption                 E [j |zj ] = 0    where   ~j
                                                                                z    is excluded from the non-selection

propensity.

    Finally, for nonparametric identication of the non-selection propensity                               µj ,   we assume the fol-

lowing distributional exclusion restriction on the conditional distribution of                             j     (e.g., Blundell and

Powell, 2004)



                    Pr (j <  |pj , zj , w
                                        ~ j ) = Pr (j <  |j , w
                                                              ~ j )  G (- (wj ))                            R.                    (3.10)



The assumption requires any dependence of                  j    on prices   pj ,   exogenous product attributes and/or

price instruments       zj   to be characterized by the control function             j   that comes from the pricing equa-

tion (2.6) in section 2.3. Using this distributional exclusion restriction assumption with moderate

regularity conditions, we can identify           G (·)    and    (·),   and thus, the non-selection propensity                    µ (wj )

                                                                10
nonparametrically (see Matzkin (1992) for a proof ). A conceptual advantage of our nonparametric

approach is that we allow                G (·)       and     (·)   to be very exible as they do not need to depend on

a nite-dimensional parameter vector, such as                              in    (wj ) = wj  ,    if one adopts a parametric or

semiparametric specication of the selection equation.                             Thus, our approach is agnostic about the

exact mechanism through which the subset of alternatives being selected is formed.                                          In the next

section, we propose a three-step estimator of the Random-Coecients Logit model that is robust to

zero shares (selection) and endogenous prices.




4 A Three-Step Estimator with a Nonparametric Selection Stage
We now propose a three-step estimator using the pairwise-dierence moment conditions in equation

(3.6). The rst step estimates the reduced form of prices. We use the reduced form to construct

a control function that is then used in a second step to obtain a nonparametric estimate of our

binary selection process.               Finally, the third step estimates the structural parameters of interest,

,       using a constrained optimization procedure that ts our dierences moments subject to the

selection process.           The approach is related to pairwise-dierencing estimation of selection models

with a nonparametric rst-stage (see for instance Ahn and Powell, 1993,                                   who use a linear second

stage). Aradillas-Lopez et al. (2007); Aradillas-Lopez (2012) extend Ahn and Powell (1993); Honoré

and Powell (2005)'s setup to allow for a non-parametric rst-stage propensity score and a non-linear

second stage.



4.1        Stage 1: Pricing Equation
Assume that the pricing equation has the following structure:



                                                              pj =  (rj ; ) + j ,                                                   (4.1)


                                                                                                                         
where the functional form of                     (rj ; )     is known to the researcher.         Suppose      ^   is a      n-consistent
estimator of           ^.   The residual, which will be used as the control variable in the second stage of

estimation, is dened as follows:

                                                              ^j = pj -  (rj ; ^) .
                                                                                                                                    (4.2)

5

        As in section 3.2.2, we construct an instrument matrix                        W   with   j th   row   wj := ^j         ~j
                                                                                                                               w    . As

explained above in section 2.2, the selection process could be inuenced by prices and product

characteristics. However, under our distributional exclusion restriction assumption (3.10), we do not

include      pj   or   xj   in   wj   because     G ( |pj , xj , j , w
                                                                     ~ j ) = G ( |j , w
                                                                                      ~ j ),   R.             Blundell and Powell

    5
        In theory, one could estimate            ( rj ; )   nonparametrically.   However, a nonparametric estimator will typically
                                        
converge at a slower rate than             n.   The slower rate of convergence could, in turn, aect the asymptotic properties of
the second and third stage estimators which might adversely aect our bootstrap procedure for inference.




                                                                       11
(2004) show that, under this distributional exclusion restriction, the residual                        ^j  pj -  (rj ; ^)
                                                                                                                            can

be used as a control variable in estimating (2.4). Recall that the control function is used only to

allow for potential price endogeneity in the estimation of the consideration selection probabilities.
                                                                                                                              6

When we estimate the market share functions, we will use instrumental variables to correct for the

endogeneity of prices.



4.2       Stage 2: Selection Stage  Nonparametric Estimation of the Control Func-
          tion
Recall that our selection model for product               j   is given by:



                                       µ (wj ) = 1 - E [1 ( (wj ) + j > 0) |wj ] .                                       (4.3)



In practice, researchers using aggregate market share data observe very little about the selection

process other than the incidence of zero shares. Consequently, the functional form of                          (·) is unknown.
If we assume that         j   has an everywhere-increasing continuous distribution, we can estimate                         µj
nonparametrically for each observation              j   using the Nadaraya-Watson kernel regression estimator:


                                                                                  wk -wj
                                                                      k   dj H      bn
                                         ^j  µ
                                         µ   ^ (wj ) = 1 -                                  ,                            (4.4)
                                                                                 wk -wj
                                                                          kH       bn


where     H (·)   is a multivariate kernel function, and             bn   is a bandwidth sequence for a sample of size

n.7 In principle, one could impose more structure on (4.3) if more data was available about the
specic selection mechanism, such as moments regarding consumers' consideration sets or moments

regarding stock-outs and changes in availability.



4.3       Stage 3: Random-Coecients Estimator with Nonparametric Selection Cor-
          rection
The third stage of the estimator adapts the pairwise-dierencing estimation procedure with nonpara-

metric selection correction by Ahn and Powell (1993); Aradillas-Lopez et al. (2007); Aradillas-Lopez

(2012) to random-coecient demand estimation. We refer the interested reader to Ahn and Powell

(1993); Aradillas-Lopez et al. (2007); Aradillas-Lopez (2012) for a detailed discussion of alterna-

tive estimation procedures (using bias-reducing higher-order kernel, trimming sequences or jackknife
                                                
procedures) and for the proof of the               n-consistency      and asymptotic normality of the estimator.

   6
       Our application of a control function is dierent from Petrin and Train (2010). A crucial dierence is that Petrin
and Train (2010) include the control function from the pricing equation directly into the choice-specic utility. In
contrast, the control function   j    in our framework enters only the selection stage to correct for the endogeneity in the
selection stage, not the choice-specic utility directly. In addition, unlike Petrin and Train (2010), we do not specify
the parametric functional form of the unobservables.
   7
       This bandwidth sequence   bn   can dier for each element of        wj   if one chooses to use a product kernel.




                                                                12
       We rst dene a dierencing operator                     .    If    is applied to a pair of indexed vectors or scalars, it
denotes the dierence of two (column) vectors/scalars. For example,                                zi,j := zi - zj .        If    is applied
to a (column) vector or matrix without an index, it is a (column) vector/matrix of a collection of

                                                                                                                                        n
pairwise-dierenced rows. For example, suppose                            Z   is an   n×p      matrix. Then,      Z        is the             ×p
                                                                                                                                        2
matrix where the rst row of             Z      is   z1,2 ,    second row is          z1,3 ,   and so on.

       Our proposed pairwise-dierencing estimator uses the sample analogue of the following moment

condition:

                                         E [zi,j i,j |µi = µj , di = dj = 1] = 0                                                            (4.5)


which is implied by (3.6).
                                  8 This moment condition resolves the selection problem, as illustrated for

the case of Homogeneous Logit demand in equation (3.7) of section 3.2.2.

       Unfortunately, as is common in the pairwise-dierencing estimators, the empirical analog of

the population moment condition (4.5) is complicated by the fact that                                  µi   exactly equals           µj      with

probability 0 because        µi   is assumed to be continuously distributed. In addition, we only observe                                       µ
                                                                                                                                                ^i ,
the consistent estimate of         µi   from the previous stage. Therefore, we replace                          µi   with its prediction

µ
^i ,   and use kernel weights that assign more weight to pairs of observations                              i   and   j   when     ^i
                                                                                                                                   µ      and   ^j
                                                                                                                                                µ
are close. Dene the kernel weights                  ^ i,j   by:


                                                                   1         ^i - µ
                                                                             µ    ^j
                                                      ^ i,j =                           ,                                                   (4.6)
                                                                  hnd          hnd

where      (·)     is a kernel function and           hnd    is a bandwidth sequence for a sample of size                          nd ,     where

hnd  0        as   nd   .      The estimator corresponding to the moment condition (4.5) is a weighted

GMM estimator with weights               ^ i,j .
       Our third-stage estimator is similar to the usual GMM estimator for the usual Random-Coecients

Logit demand model. Let                 be a GMM weighting matrix constructed from the pairwise-dierenced

instrument matrix         Z.      Also let         gi,j () = zi,j i,j ()                be the sample analog of our moment

conditions (4.5). Then, with a slight modication of Ahn and Powell (1993), the pairwise-dierence

weighted GMM estimator is dened as the solution to the following constrained optimization prob-

   8
       A sucient condition for
                                         E [(zi - zj ) (i - j ) |µi = µj , di = dj = 1] = 0
is that   E [zi i - zi j |µi = µj , di = dj = 1] = 0 and E [zj j - zj i |µi = µj , di = dj = 1] = 0.             Recalling (3.6), we can
integrate over    zi to obtain
                                            E [i - j |zi , zj , µi = µj , di = dj = 1] = 0
which yields
                                              E [i - j |zj , µi = µj , di = dj = 1] = 0,
and, in turn, implies
                                             E [(i - j ) zj |µi = µj , di = dj = 1] = 0.
Showing    E [(i - j ) zi |, µi = µj , di = dj = 1] = 0      is similar.




                                                                        13
lem:

                                                           n-1     n
                                                   2
                        P DW GM M =arg min                                ^ i,j gi,j () gi,j ()               (4.7)
                                           (,) n (n - 1)
                                                             i=1 j =i+1



                                    s.t.    s =  (p, x,  ; )                                                  (4.8)



where    ^ i,j   are the weights, pre-computed from the second stage according to (4.6). (4.8) is the market

share equations for the observations with        sj > 0,   as in equation (2.3). In addition to the standard

instruments, we also include the Gandhi and Houde (2019)'s                   product dierentiation   instruments.

Gandhi and Houde (2019) show that the inclusion of these additional instruments improves both

the precision and numerical stability of the variance terms for the random coecients. Appendix

A provides specic details on the MPEC formulation (Dubé et al., 2012) of the estimation problem

dened by (4.7)-(4.8).          The appendix also describes the exact instrument matrix,            Z,   and GMM

weighting matrix,        ,   used during estimation.

    The following proposition, which we adapt from Aradillas-Lopez et al. (2007), establishes the

   n-consistency       and asymptotic normality of the estimator proposed in (4.7)-(4.8).               In addition

to the usual regularity conditions for a nonparametric estimator such as on the kernel choice or

bandwidth sequence stated in Aradillas-Lopez et al. (2007), the proposition imposes the following

assumptions that were explained above: (i) continuity of at least on element of the exogenous product
                                                                                           
characteristics, (ii) the distributional exclusion restriction (3.10), and (iii) the          n-consistency of the
pricing equation parameter estimates.


Proposition. Consider the following assumptions:
(i) xj contains at least one continuous element.
(ii) G (|pj , xj , j , w                ~ j ),   R.
                       ~ j ) = G ( |j , w
(iii) The functional form of the pricing equation  (rj ; ) in (2.6) is known to the researcher, and
                             
the estimator ^ for is n-consistent.
     If assumptions (i)-(iii) hold along with several regularity conditions (Assumptions 1-17 of Aradillas-
                                                                                      
Lopez et al. (2007)), then, the estimator P DW GM M dened in (4.7)-(4.8) is n-consistent and
asymptotically normal.
Proof.    See Aradillas-Lopez et al. (2007).


    Appendix A.2 provides specic details on our implementation of the MPEC estimation problem.

Using the MPEC estimator in (4.7) for inference is complicated because it conditions on predictions

from Stages 1 and 2. Appendix A.3 describes a bootstrap procedure for conducting inference using

P DW GM M .         Since bootstrapped Random-Coecients Logit demand estimation is new in the lit-

erature, the appendix also derives a bootstrap approach for the case when all the observed market




                                                        14
shares are strictly positive. This scenario could be of interest if, for example, some of the observed

product characteristics or instruments are predictions from a pre-estimation stage.




5 A Monte Carlo Study
5.1      Data Generating Process
We now study the nite-sample performance of our PDWGMM estimator both in sampling exper-

iments with selection bias on zero shares and without.                   In each of our Monte Carlo experiments,

we compare PDWGMM to the commonly-used Drop-Zero estimator, and Impute-Zero estimator.

We consider three dierent data-generating processes: (a) the incidence of zero shares is selected

on unobserved aspects of demand, (b) the incidence of zero shares is not selected on unobserved

aspects of demand, and (c) strictly positive market shares.                    Scenarios (a) and (b) mimic typical,

real-world consumer goods datasets where we observe many products that fail to sell any units. Of

interest is whether our PDWGMM estimator provides reliable estimates regardless of whether the

incidence of zero shares is selected on unobserved aspects of demand. Scenario (c) represents the

data-generating process implied by the model in Berry et al. (1995) with a continuum of consumers

generating strictly positive market shares.                In this scenario, the PDWGMM estimator should be

consistent and we anticipate it to provide comparable estimates to the Drop-Zero estimator (i.e.,

Berry et al. (1995)'s GMM estimator).

       Each of our Monte Carlo experiments consists of               T = 100   markets, each with    J = 100   available

products. We assume a linear choice-specic utility for each product:


                                                                3
                                   uh
                                    jt   =    h
                                              0        h
                                                  +  pjt +                h
                                                                     xjkt k + jt +     h
                                                                                       jt
                                                               k=1


where     xjkt    i.i.d. U[0, 1] and
                                         h        i.i.d. EV(0, 1). For the taste parameters, we assume            h 
                                         jt
            h  N (2, 0.25),  h  N (1, 1),  h  N (2, 4),
N (-2, 1) , 0                                                               and
                                                                                    h  N (2, 4).
                                                                                    3              As explained above,
                            1             2
              h
the intercept 0 is not separately identied for our pairwise-dierencing estimator from the levels of

jt .
       We also assume a linear selection equation:



                                         djt = 1 (18 + wjt - 5pjt + jt > 0)

where     wjt  i.i.d.   U[0, 1]. Similarly, we assume linear prices:


                                                                                    jt
                                 pjt = 0 +            xjlt l + (~
                                                                zj 1t + z
                                                                        ~j 2t ) +      + jt
                                                                                    2
                                                  l


where      = 1, 1
                2 , 1, 1    ,   ~jkt 
                                z       i.i.d. U[0, 1] for    k  {1, 2},     and    jt  N (0, 0.41).    Note that this



                                                              15
design always includes price endogeneity in demand due to the dependence of a product                                    js   price

on its unobserved demand shock,               jt .
      We use Monte Carlo simulation to generate the market shares:


                                      R                  r + r p +               3        r
                                  1              djt exp 0      jt               k=1 xjkt k    + jt
                            sjt =                 J
                                  R                            r + r p +               3        r
                                      r=1   1+         dit exp 0      it               k=1 xikt k   + it
                                                 i=1

where    R = 50, 000.   We conduct          100 replications of the sampling experiment.              Each simulated dataset

has   10, 000   product-market combinations.

      In scenario (a), we introduce selection-on-unobservables into the demand process by assuming:

  jt                    0          4.56      3
            N                 ,                        .    The typical dataset has approximately               5, 800   non-zero
  jt                    0           3   4.56
market shares (             djt    5800) and,         hence, 42% of the observations involve a zero-valued market
                    j   t
share.

      In scenario (b), we allow for zero market shares but eliminate the selection-on-unobservables

by assuming:      djt  i.i.d. Bernoulli (0.58).              That is, we randomly select around            58   products out of

J = 100     to match the number of non-zero market share products in scenario (a).                                In this data-

generating process,         djt   does not depend on either            jt   or   jt   and hence zero shares are missing at

random.

      In scenario (c), we use the standard data-generating process assumed in the literature where                            djt =
1, j, t.   Since all products have strictly positive shares, it mechanically provides more information

than scenarios (a) and (b). We therefore reduce the number of products in each market to                                  J = 58
to replicate the    5, 800    non-zero shares we observe in scenarios (a) and (b).



5.2      Results
We now summarize the results across the                    100 replications of the data-generating processes described
in section 5.1. For each replication we estimate 6 versions of the model, two of them are Random-

Coecients Logit and the rest are Homogeneous Logit models (i.e., with no random coecients).

We report two dierent Random-Coecients Logit estimators here: (1) PDWGMM, and (2) Drop-

Zero. We use      Nh = 2, 000       random draws to compute the expected shares for each of these random

coecients estimators.

      Table 1 reports the average coecient estimates across the                        100   replications for our two random

coecients estimators. In scenario (a) of Table 1, the PDWGMM estimator recovers the mean pa-

rameters quite accurately while, as expected, the Drop-Zero estimator exhibits considerable selection

bias. PDWGMM also recovers the standard deviation parameters quite accurately except for the

standard deviation on the price coecient, which is estimated imprecisely. In contrast, each of the

standard deviation parameters is estimated imprecisely under Drop-Zero. Most striking, the Drop-



                                                                  16
Zero estimator overestimates the price coecient by around 150%.                      However, our results conrm

that the Drop-Zero estimator fails to recover the true coecient values when the incidence of zero

shares is selected on observed aspects of demand. The reason we only nd bias in the price coe-

cient is likely due to the fact that prices are uncorrelated with observed product attributes in the

data-generating process. As we will see in the empirical case study in section 6 below, the Drop-Zero

estimator can lead to substantively dierent (biased) estimates for all the model parameters.


                               Table 1: Monte Carlo Data Estimation Results



   DGP       (a) With Selection-on-Unobservables     (b) Without Selection-on-Unobservables     (c) No Zero Shares

                                                    Random-Coecients Logit

             PDWGMM               Drop 0             PDWGMM                Drop 0              PDWGMM       Drop 0

   ¯ [2]
                2.045              5.019               2.098               2.116                 1.989      2.053
               (0.112)            (0.810)              (0.350)             (0.363)               (0.325)    (0.306)
   ¯1 [1]
                0.941              1.085               0.959                0.992                0.961       1.024
               (0.093)            (0.340)              (0.114)             (0.139)               (0.127)    (0.159)
   ¯2 [2]
                1.957              2.332               1.991                2.085                1.968       2.126
               (0.124)            (0.498)              (0.169)             (0.199)               (0.200)    (0.287)
   ¯3 [2]
                1.944              2.357               1.984                2.065                1.943       2.094
               (0.125)            (0.495)              (0.166)             (0.231)               (0.175)    (0.285)
    [1]         0.335              3.803               1.081                1.188                0.810       1.004
               (0.613)            (5.693)              (0.854)             (0.994)               (0.796)    (0.910)
   1 [1]        0.941              0.945               0.868                0.822                0.840       0.839
               (0.215)            (0.820)              (0.489)             (0.534)               (0.553)    (0.568)
   2 [2]        1.859              1.366               1.886                1.829                1.891       1.797
               (0.132)            (0.888)              (0.344)             (0.447)               (0.365)    (0.483)
   3 [2]        1.926              1.408               1.977                1.886                2.036       1.966
               (0.112)            (0.848)              (0.335)             (0.509)               (0.445)    (0.504)

 No. Conv.       99                 97                   97                  97                    99         97

Notes. Column names indicate how the zero shares are handled during the estimation. True parameter values are
reported in square brackets.   The reported estimates are the means of each parameter across the converged trials
of 100 replications of the data generating process. Standard deviations across converged trials are reported in the
parentheses. No. Conv. row is the number of converged estimates out of 100 Monte Carlo replications.



    In scenario (b), Table 1 reports the estimation results when the observed zero market shares are

missing at random. As expected, both estimators generate accurate and comparable estimates of

the true model parameters. Importantly, PDWGMM does not appear to lose precision or accuracy

relative to Drop-Zero (i.e., the standard Random-Coecients Logit GMM estimator) when there is

no selection on unobservables.

    In scenario (c), Table 1 reports the estimation results when there are no observed zero market

shares in the data. In this scenario, the PDWGMM estimator does not require the rst two stages




                                                        17
since         ^ i,j = 1   in stage 3 for all the observation pairs. The estimates in scenario (c) are very similar

to those of scenario (b), with comparable results for both PDWGMM and Drop-Zero.

          Appendix C reports the results from the Homogeneous Logit models which are computationally

easier to implement. There too we nd that the PDWGMM estimator provides relatively accurate

and precise estimates of the mean taste parameters                          ¯, ¯   , while the conventional methods return

biased results in the presence of selection on unobservables in the incidence of zero market shares.

For this particular data-generating process, we nd that the Homogeneous and Random-Coecients

versions of the Drop-Zero estimator exhibit the same direction and comparable magnitudes of bias

in the price coecient estimates. We explore the direction of bias in more detail below, in section

5.3.
          9


Figure 5.1: Scatterplot of True             j   and   ^j
                                                           from Our PDWGMM Estimator and Drop-Zero Estimator,
Monte Carlo Data

(a)           DGP         With    Selection-on-(b)    DGP       Without      Selection-on-
Unobservables                                   Unobservables                                (c) DGP Without Zero Shares




          We next investigate the pattern of the relationship between the true                  j   and estimated   ^j
                                                                                                                         for our

PDWGMM estimator and Drop-Zero estimator, respectively. In our Monte Carlo exercises, we can

net out the true value of the intercept term                  h 0 from      the composite residual    ^j
                                                                                                           to obtain the pure

unobserved vertical product attribute term                    ^j -  0
                                                                            for our PDWGMM estimator.
                                                                                                              10 Figures 5.1a
                                                                        h
to 5.1c each overlay two scatterplots using one of our Monte Carlo datasets for the observations with

strictly positive shares, respectively for scenarios (a) to (c). The horizontal axes report the true                          j
      9
          For the Homogeneous Logit model with an imputed share value, we also examined the sensitivity of the price
coecient estimates to the imputation value. Regardless of whether the incidence of zero market shares is selected on
unobservables or not, the estimated price coecient is very sensitive to the choice of imputation. For instance, in the
                                                                                  -5                           -300
presence of selection, the price coecient estimates range from 3.605 (impute 10      ) to 695.990 (impute 10        ), and
                                                                                                  -5
without the presence of selection, the price coecient estimates range from 0.934 (impute 10          ) to +1.926 (impute
10-300 ). See Appendix B for our full sensitivity analysis. We also explore this sensitivity in our empirical case study
in section 6.2.
  10
          As explained in section 3.2.1, it would be infeasible to net out the intercept term from the composite residuals
when implementing our PDWGMM estimator using real-world data.




                                                                   18
values and the vertical axes report the estimated vertical product attribute values from dierent

estimators.

     The value of       ^j -  0
                                      from our PDWGMM estimator appears to estimate the true                j   very
                             h
accurately and precisely.          In Figure 5.1a, when selection on unobservables matters, the true              j
value and       ^j -  0
                              from our PDWGMM estimation lie almost exactly on the              45°   line through
                     h
the origin. In contrast,        ^DZ
                                      from the Drop-Zero estimator is much more dispersed, with the slope
                                 j
quite dierent from one. Second, the distribution of the true              j     for the observations with   sj > 0
is centered around the mean of 1.048 due to the selection on unobservables, and the distribution

of    ^P DW GM M -  0
                              from our PDWGMM estimator is centered around the mean of 1.119, which
       j           h
is very close to the true value. In contrast, the distribution of          ^j
                                                                                from the Drop-Zero estimator is

mechanically centered around zero because of one of the sample moment condition being imposed

during estimation, ignoring the selection on unobservables. In Figures 5.1b and 5.1c when selection

on unobservables does not matter, both               ^P DW GM M -  0
                                                                         from our PDWGMM estimator and
                                                      j           h
^DZ
       from the Drop-Zero estimator lie alomst exactly on the             45°   line passing through the origin.
 j
As we demonstrate below, the direction of the bias in the Drop-Zero estimator depends in part on

the strength of price endogeneity, and not just on selection. For other data-generating processes,

E ^j -  0 > 0        and the Drop-Zero estimator can over-estimate the parameters.
       h


5.3      Additional Monte Carlo Analysis on the Direction of Bias in Price-Coecient
         Estimates
For the data-generating process explored in the previous section, selection-on-unobservables gener-

ated the same direction of bias and comparable magnitude of bias in the mean price coecient for

our Drop-Zero estimators. We now conduct additional sampling experiments to explore the direction

of bias.

     In practice, it is not possible to determine the direction of bias for the Drop-Zero estimator due to

the simulataneous roles of price endogeneity and selection on unobservables. Under price endogeneity

and selection, the sign of the bias in the price coecient estimate for the Drop-Zero estimator depends

on   E [jt |zjt , djt = 1].   If the non-selection propensity is decreasing in the unobserved demand shock,

jt , then E [jt |zjt , djt = 1] > 0.     However, if the non-selection propensity is increasing in prices, then

E [jt |zjt , djt = 1] < 0,     exacerbating the negative bias already induced when prices are positively

correlated with unobserved demand shocks. The fact that there is no systematic direction of bias

is important for applied work since it means that the popular Drop-Zero estimators are not only

biased, they do not provide a systematic bound on the parameters of interest.

     To explore this concern about an ambiguous direction of bias, we conduct two additional Monte

Carlo experiments with selection on unobservables: (d)          E [jt |zjt , djt = 1] < 0 and (e) E [jt |zjt , djt = 1] >
0.   We focus on the Homogeneous Logit case to simplify the computational burden.

     The data-generating process for scenario (d) is identical to the scenario (a) of section 5.1, except



                                                          19
that we set all the standard deviations of the random coecients to zero:                                     h = -2   ,
                                                                                                                          h = 2,
                                                                                                                          0
h = 1,
1          and
                 h = 2 h.
                 2                   Scenario (d) generates around 56% of nonzero share observations with

E [jt |zjt , djt = 1] = -1.1,    which is negative.

    The data generating processes for scenario (e) makes the following three modication on scenario

(a) of section 5.1.    First,    h = -2 ,0
                                         h = 2,  h = 1,
                                                1                            and
                                                                                   h = 2 h,
                                                                                   2               as in scenaro (d).     Second,

we increase the variance in the non-selection outcomes as well as the covariance with the demand
            jt                  0           2      6
shock:            N                    ,                   . Third, we weaken the dependence of consideration on
            jt                 0    6 26
                           pjt
prices:   djt = 1 wjt -     5 + jt > 0 . Consequently,                   scenario (e) generates around 42% of nonzero

share observations with        E [jt |zjt , djt = 1] = 2.9,        which is positive.

    We estimate Homogeneous Logit PDWGMM and Homogeneous Logit Drop-Zero estimators for

scenarios (d) and (e), respectively. The results are reported in Table 2. The price coecient estimate

of the Drop-Zero estimator is biased upward (towards more negative) in scenario (d), whereas it is

biased downward (towards more positive) in scenario (e).                           In contrast, our PDWGMM estimator

recovers the target parameter accurately in both scenarios (d) and (e). In sum, the price coecient

estimates of the Drop-Zero estimator cannot be taken as either a lower or upper bound of the true

parameter.


   Table 2: Monte Carlo Data Estimation Results on the Direction of Bias of Price Coecients



                          DGP              (d)   E [jt |zjt , djt = 1] < 0     (e)   E [jt |zjt , djt = 1] > 0

                                                                 Homogeneous Logit


                       Parameters          PDWGMM              Drop 0          PDWGMM              Drop 0


                         ¯   [2]                2.045           4.635              1.962            1.628

                                             (0.059)           (0.334)             (0.144)         (0.110)
                          ¯1
                               [1]               0.980          0.979                0.983          0.956

                                             (0.091)           (0.172)             (0.205)         (0.208)
                          ¯2
                               [2]               1.974          1.978                1.997          1.953

                                             (0.106)           (0.221)             (0.238)         (0.218)
                          ¯3
                               [2]               1.972          1.961                1.989          1.956

                                             (0.104)           (0.197)             (0.242)         (0.236)


Notes. Column names indicate how the zero shares are handled during the estimation. True parameter values are
reported in square brackets. The reported estimates are the means of each parameter across the 100 replications of
the data generating process. Standard deviations across 100 trials are reported in the parentheses.




                                                                   20
6 Application: Scanner Data with Many Zeros
6.1       Data and Evidence of Selection on Zero-Valued Market Shares
We conduct an empirical case study of the ice cream category.                       The data were provided by a

midwestern chain that tracks daily prices and sales of each of the UPCs sold by store. A distinctive

feature of these data is that they record shelf prices, unit costs, and feature advertisement information

even when a UPC is not sold in a given store-day. The advantage of daily data is that we observe the

exact price charged for each product, in contrast with most weekly-frequency datasets that report

the average price for each product across each of the days in that week. We observe 25 stores during

an 18-month period, generating 2.7 million UPC-store-day observations.

       For our empirical case study, we focus on the non-premium segment of ice cream brands. We

include Breyers, Deans, Edy's and the Store Brand, which collectively account for 26.3% of the total

category sales. Since 98.5% of sales for these brands come from the 48oz pack size, we only use 48oz

packs. For estimation, we use 2 stores in the chain, retaining only the Thursdays since we observe

very little within-week variation in prices.           We use all the available data for each store between

our sample range, January 2013 to June 2014.
                                                          11 Our estimation sample therefore includes 14,907

product-store observations, spanning 130 unique products and 131 unique markets (i.e., store-days).

       To construct the potential market size, we start with each Thursday's total unique customer

count.      Since it is unlikely that every store visit results in a trip to the non-premium section of

the ice cream aisle, we scale the customer count by 1/7 of all trips.
                                                                                       12 Accordingly, we dene each
                                                                    total packs of j sold
product's market share on a store-day as:            sj =   total potential ice cream purchases . We dene the outside
good share,      s0 ,   as the share of the potential trips during which no non-premium ice cream packs

were sold.

       Zero shares are quite common in these retail data: only 30.7% of the store-day-product observa-

tions (e.g., 4,571 out of 14,907) generate at least one unit sale. The incidence of zero market shares

appears to be more than random sampling error.
                                                                 13   Even if we collapse a given store's product

sales to a lower time frequency (e.g., weekly or monthly), we still observe many products with zero

shares. Table 3 reports the incidence of zero shares when a store's data are collapsed to the daily,

weekly, monthly and tri-monthly frequencies, respectively. When we collapse the data to 90-day in-

tervals, a typical store exhibits around 148,000 unique customer visits (i.e., 21,142 unique potential

non-premium ice cream purchases)
                                           14 each making discrete choices from approximately 130 unique

  11
       One store opened before January 2013, the other store opened in June 2013.
  12
       We use Nielsen Homescan data to estimate this scaling using the 271,016 unique household trips to this chain.
Only 6,634 trips resulted in the purchase of a non-premium ice cream. We then set the potential market at 5-6 times
this proportion of trips to account for consumers who considered by buying but ultimately did not, possibly due to
prices or availability in other stores, generating a potential market size of 1/7 of the customer store visits to the chain
in question.
  13
       With a nite and discrete number of consumers each making a discrete choice decision, zero market shares could
arise by pure chance.
  14
       As in many retail databases, we observe each store's total customer trac counts.




                                                            21
non-premium ice cream products.
                                                   15 Even, with this large consumer population, we still observe zero

shares for 6.6% of the available non-premium ice cream products in the store-period. With this many

underlying discrete choices, it is almost impossible for random utility alone to explain the incidence

of zeros. Furthermore, we nd that for 18.9% of the non-premium ice cream products exhibiting a

zero share in at least one store-period, the minimum non-zero quantity sold is larger than 5 units.

This type of discrete jump from zero to a large positive quantity also seems inconsistent with pure

random utility explaining the zero shares. In sum, these patterns indicate systematic non-selection

for certain products on the shelves.


                          Table 3: Average Number of Zero Shares of Ice Cream Per Store



                 Data             Total Number       Total Unique Number             Number of        Average Number

               Frequency          of packs sold        of Customer Visits           Observations        of Products

                                                           per Store               with Zero Sales   Available Per Store


                 1 day                 74                       1,664                     78                 120

                 7 days               513                       11,615                    26                 120

                30 days               2,159                     49,594                    14                 121

                90 days               6,203                 147,923                       8                  122




       In addition to the brand name, we also observe an extensive set of product attribute dummy

variables:     Vanilla, Chocolate, Yogurt, Caramel, Mint, Gelato, and Fruit.                              For each product, we

manually collected total calories per cup as a continuously-valued nutrient-related attribute.
                                                                                                                           1617

       To address the potential endogeneity of shelf prices, we use the unit cost variable and its square as

price instruments,         ~j .
                           z      As in Chintagunta et al. (2003), we assume the wholesale prices and temporary

discounts of each UPC are independent of a given store's demand shocks.
                                                                                                      18 As in the Monte Carlo

simulations, we use a linear price specication. To address the potential selection on consideration,

we use UPC and brand-level feature advertisement variables as the consideration instruments                                   ~ j.
                                                                                                                              w
Following Mehta et al. (2004), we assume these instruments aect consideration, but not demand.

Intuitively, consumers do not derive consumption benets from viewing a feature ad. However, the

ad impression triggers their attention to the specic featured products and brands. Of course, these

excluded promotional variables would also be valid if they aect stock-out propensities, another

cause of non-consideration. In our daily data, it is possible that a promoted item stocks-out midway

through the promotional period (typically several days), thereby generating zero sales on a given

  15
       This large number of available product variants is approximately average for a CPG product category.                  Dubé
(2019) nds that the average CPG category has about 400 available products, spanning 64 brands.
  16
       To ensure all the continuous attributes are on a comparable scale for estimation, we use normalize the calories
per cup information in the nutrition label by 1/1000.
  17
       We   collected   the   nutrient      data   from   the    following    websites:   www.walmart.com,    www.calorieking.com,
www.picknsave.com,                www.breyers.com,         www.target.com,           www.edys.com,      www.homemadebrand.com,
www.kemps.com.
  18
       Manufacturers do not target wholesale prices dierentially across stores in a single chain.




                                                                         22
day. Once again, an advantage of our non-parametric control for the consideration propensity is the

robustness of our approach to dierent mechanisms.

       Table 4 presents the key summary statistics of our estimation data. Further details about the

data being used in this study can be found in section 2 of Bronnenberg et al. (Forthcoming).


                           Table 4: Summary Statistics of the Estimation Data



                                                     Mean     Std. Dev      Min    Max


                                    Price            3.835      0.461      1.895   4.990

                                    Share            0.002      0.004        0         0

                                      s0             0.736      0.091      0.433   0.894

                                  Cost/pack          4.164      0.508      0.000   4.530

                                Featured UPC         0.132      0.338        0         1

                               Featured Brand        0.190      0.392        0         1

                             Temporary Discount      0.036      0.186        0         1

                            Cal./(1000×cup)          0.265      0.043      0.18    0.38

                                    Vanilla          0.198      0.398        0         1

                                  Chocolate          0.195      0.396        0         1

                                Frozen Yogurt        0.132      0.338        0         1

                                     Mint            0.084      0.278        0         1

                                     Fruit           0.919      0.272        0         1

                                   Breyers           0.205      0.403        0         1

                                    Deans            0.228      0.420        0         1

                                     Edys            0.532      0.499        0         1

                                 Store Brand         0.035      0.184        0         1


                            Non-zero Observations                   4571

                                 Sample Size                       14907


Notes. This table presents the summary statistics of the estimation data being used.




6.2       Estimation and Results
Table 5 presents the ice cream demand estimation results.                We compare 6 alternative estimators

and implementations.       The rst two columns labeled          Random Coecient Logit           are the Random-

Coecients Logit model estimates with our PDWGMM selection correction and Drop-Zero esti-

mators, respectively.
                        19 The next four columns labeled        Homogeneous Logit          are Homogeneous Logit

model estimates of our selection-correction (PDWGMM), classical Heckman correction, Drop-Zero,

and Impute-Zero estimators, respectively. Each estimator uses the same set of instruments for a fair

comparison.

  19
       The Random-Coecient Logit models are estimated using   Nh = 2, 000   simulation draws, and we did not include
the taste heterogeneity parameters in the brand coecients. Our PDWGMM estimator used the bandwidth following
Silverman's rule throughout the estimation. See Appendix A.5 for details on the choice of bandwidth.




                                                        23
                                  Table 5: Model Parameter Estimation Results



                          Random-Coecients Logit                                              Homogeneous Logit

                      PDWGMM                    Drop 0               PDWGMM        Heckman       Drop 0     Impute 10-12      Drop 0 OLS
                                                        
                      ¯                     ¯
                                                                          ¯            ¯
                                                                                                   ¯
                                                                                                                    ¯
                                                                                                                                  ¯

   Mean Elast.            2.512                 1.489                 2.648         1.939        1.394            17.625        1.290

      Price         0.689          0      0.411         0.002         0.716         0.524        0.377            4.767         0.349
                    (0.123)    (0.002)    (0.069)   (0.001)           (0.147)       (0.057)      (0.061)          (0.702)       (0.022)
 Cal./(1000×cup)    0.166          0      0.024         0.001         0.235         0.116        0.141            0.953         0.131
                    (0.224)    (0.157)    (0.253)   (0.012)           (0.191)       (0.214)      (0.205)          (2.312)       (0.204)
      Vanilla       0.173         0.002   0.175          0            0.156          0.159       0.146            2.651          0.145
                    (0.027)    (0.012)    (0.028)   (0.002)           (0.020)       (0.020)      (0.020)          (0.248)       (0.020)
    Chocolate       1.088         1.760   3.128         3.337         0.044          0.054       0.044            0.741          0.044
                    (1.098)    (1.156)    (1.874)   (1.688)           (0.019)       (0.020)      (0.020)          (0.234)       (0.020)
      Yogurt        0.140         0.101   0.129          0            0.122         0.132        0.129            2.476         0.128
                    (1.408)    (0.999)    (0.104)   (0.187)           (0.025)       (0.028)      (0.028)          (0.243)       (0.028)
       Mint         2.829         2.849   1.664         2.174         0.018          0.008       0.007            0.806          0.007
                    (2.275)    (1.664)    (1.269)   (1.239)           (0.029)       (0.027)      (0.027)          (0.356)       (0.027)
       Fruit        0.121          0      0.085          0            0.106         0.071        0.067            0.124         0.066
                    (0.034)    (0.004)    (0.033)   (0.001)           (0.032)       (0.031)      (0.03)           (0.320)       (0.030)

     Breyers        0.237          0      0.158          0            0.167          0.264       0.159            1.720          0.138
                    (0.136)    (0.014)    (0.068)   (0.052)           (0.159)       (0.062)      (0.063)          (0.796)       (0.046)
      Deans         0.230         0.159   0.082         0.007         0.234          0.301       0.100            4.772          0.074
                    (0.234)    (0.398)    (0.109)   (0.222)           (0.165)       (0.064)      (0.069)          (1.002)       (0.045)
       Edys         0.243          0      0.105          0            0.172          0.249       0.078            3.991          0.055
                    (0.144)    (0.099)    (0.070)   (0.003)           (0.158)       (0.059)      (0.063)          (0.884)       (0.043)

    No. Conv.               482                   500                  500            500         500              500           500
                                                                       
Notes. The sub-columns    ¯
                              are the mean parameter estimates,               are the standard-deviation parameter estimates.
Bootstrap standard errors are in parentheses based on           B = 500   draws. Mean Elast. row indicates the mean price
elasticities across all the products available in our sample, using the usual formula.            No.     Conv.    row indicates the
number of converged bootstrap trials out of 500 bootstrap iterations.




                                                                24
          As in the Monte Carlo analysis in section 5, the imputed share correction is found to be highly

unstable and results vary dramatically with the choice of imputation value. For the Homogeneous

Logit, Appendix B indicates that the price coecient estimates vary from 0.917 to 143.362 as we

vary the imputed share value from             10-4   to   10-300 .   The lack of robustness of this estimator suggests

it does not provide a reliable estimate of demand and we do not discuss it further in this section.

          The PDWGMM estimator generates a much smaller mean price coecient than the Drop-Zero

estimator, in this case a dierence of            0.278.    We can test the signicance of this dierence formally

using a two-sample bootstrap t-test of the null hypothesis that the price coecients are the same:
                                                                                                                          2021


                                                        ^ P W DGM M - 
                                                                      ^ drop0
                     TB =                                                                                  .
                                      P W DGM M ) + V ar (^
                                V ar (^                   drop0 ) - 2Cov (^
                                                                          P W DGM M , ^ drop0 )

We compute           TB = 2.26     (p-value of   0.023),    thereby rejecting the hypothesis of equal mean price

coecients at the 5% signicance level.                   At the   5%     signicance level, we can rule out dierences

smaller than        0.038.
          Our two estimators also generate very dierent own-price elasticities, with a mean price elasticity

of    -1.489     for the Drop-Zero estimator and a mean price elasticity of              -2.512   for PDWGMM. We

reject the hypothesis of equal mean elasticities at the 5% signicance level, with                  TB = 2.34        (p-value

of 0.019).

          We nd similar results for the computationally lighter Homogeneous Logit model of demand in

the nal four columns. Interestingly, we generally nd similar estimates of mean tastes with and

without random-coecients.               However, as before, the price coecient estimate of PDWGMM is

smaller (more negative) than that of the Drop-Zero estimator. As before, we reject the hypothesis

of equal mean price coecients for the PDWGMM and Drop-Zero estimators at the 5% signicance

level, with       TB = 2.54     (p-value of   0.011).     Even the classical Heckman two-step estimator fails to

resolve the selection bias, generating a similar price coecient estimates as the Drop-Zero estimator.

          In sum, our PDWGMM estimator generates signicantly dierent price coecients and price

elasticities than the usual Drop-Zero estimator.                     These dierences are consistent with our Monte

Carlo evidence in in section 5. In the next section, we use the observed retail margins in our data

to construct a formal test between the PDWGMM and Drop-Zero estimators.



6.3          Assessing Predictive Model Fit Using Retail Markups
We now use the retail cost information in our data to construct a test between the PDWGMM

estimator and the Drop-Zero estimator based on implied mark-ups under various retail pricing

     20
          The covariance term Cov  ^ P DW GM M , ^ drop0 requires pre-determining the bootstrap resample   order   nb   and the
                                      h
household-specic taste       shocks  to ensure the two estimators use the same bootstrap samples.
     21
          We set the max iteration count to 200. For PDWGMM, 482 of the 500 bootstrap trials converged and all 500
bootstrap trials of the Drop-Zero estimator converged. For the test, we dropped the 18 bootstrap trials for which our
PDWGMM estimator failed to converge within 200 iterations.




                                                                25
conduct assumptions.     We assume the retailer sets prices to maximize its static prots in the ice

cream category, where    (p; ) = (p - c) Q (p; ) denotes the total category prots and Q (p; ) =
      ~ , ; 
M  p, X             denotes the predicted vector of quantities sold for each UPC. Let            m   denote the

vector of observed margins, with element      mj = pj - cj    for product         j.   The rst-order necessary

conditions for optimal pricing are:



                                (p ; ) + [p  (p ; )  ] (p - c) = 0,                                       (6.1)



where    p  (p; )   is the gradient of the demand system with    (i, j )   element:

                                
                                        h (p) 1 -  h (p) dF ,
                                 ( +  ) j                                    if   i=j
                                                           
                                                  j
                        j       
                           =
                        pi   
                             - ( +  )  h (p)  h (p) dF
                             
                                                                             if   i=j
                                      i      j        


and      is a matrix of zeros and ones reecting various forms of retail conduct. The optimal contri-

bution margin can then be written as:



                               µ () = - [p  (p ; )  ]-1  (p ; ) .                                         (6.2)



   Since the retailer's contribution margins are observed, we can construct a minimum distance

estimator of the margins based on the criterion:



                                 q (µ) = m - µM odel      m - µM odel .                                   (6.3)



Of particular interest are the margin estimates      µ P DW GM M           and    µ Drop 0      using equation

(6.2). We can then test the relative t of the dierent demand estimators based on their ability to

t the observed contribution margins:      q P DW GM M      and   q Drop 0         . We select the model with

a smaller criterion value.

   For robustness, we conduct three separate model selection tests, each under a dierent assumed

form of retail pricing conduct:

   (a) Joint Monopoly    whereby the retailer sets all the prices jointly to maximize total prots (

is a matrix of ones for the same market);

   (b) Brand-level Pricing    whereby the retailer maximizes the joint prots of products sold under

a common brand (the entries of         is 1 if products share a common brand name within the same

market, and 0 otherwise); and

   (c) UPC-level Pricing     whereby the retailer optimizes each of the products' prices in the category

independently of one-another ( is an identity matrix).

   Table 6 presents the model-t comparison measures for the random-coecients specications of

PDWGMM and Drop-Zero under each of the three conduct assumptions. The PDWGMM estimator



                                                   26
of the demand parameter generates a considerably better t of the retail contribution margins under

all three forms of conduct. For each conduct assumption, the PDWGMM margins are closer to

the true margins than the values from the Drop-Zero estimator. Figure 6.1 illustrates the dierence

between predicted margins and observed margins, respectively under the three retail pricing conduct

assumption. The vertical line at 0 indicates that the dierence between the predicted margin and

the observed margin is zero, implying that the model predicts the observed margin perfectly. As a

histogram is more concentrated around the vertical line at 0, the model has a better t. Although

both our PDWGMM and Drop-Zero estimators overestimates the margins, it turns out that our

PDWGMM estimator performs better than the Drop-Zero estimator under all three conduct as-

sumptions. The gures also indicate that the UPC-level pricing conduct assumption explains the

observed margin the best among the three conduct assumptions we examined.


                      Table 6: A Comparison of Predictive Model Fit on Markups



                                                               q P DW GM M     q Drop 0

                          (a) Joint Monopoly                     36,018        92,021
                                                                  (297)         (824)
                          (b) Brand-level Pricing                29,210        69,404
                                                                  (257)         (625)
                          (c) UPC-level Competitive Pricing      20,383        43,049
                                                                  (172)         (301)
                          Sample Size                                  4,571
Notes. This table compares the measure of demand model prediction on markups (6.3) for three dierent conducts.
Bootstrapped standard errors are reported in parentheses.




                                                       27
   Figure 6.1: Histogram of the Dierences Between Predicted Margins and Observed Margins

                        (a) Margin Dierence Under Joint Monopoly Conduct As-
                        sumption




                        (b) Margin Dierence Under Brand-Level Pricing Conduct
                        Assumption




                        (c) Margin Dierence Under UPC-Level Competitive Pricing
                        Conduct Assumption




7 Extension: Share-Equation Equivalence of a CES Demand Sys-
  tem and a Random-Coecients Logit Demand System
In this section, we show that our proposed approach extends to the case of the CES model of demand

which has been used extensively in the trade literature (e.g., Spence 1976; Dixit and Stiglitz 1977;

Krugman 1980; Feenstra 1994; Handbury 2013; Handbury and Weinstein 2014; Bronnenberg 2015).




                                                  28
We show the equivalence between the Random-Coecients Logit demand system derived in section

2.1 and the representative consumer demand system under CES preferences. It then follows that

our PDWGMM estimator can be applied to the CES demand model to accommodate observations

of zero aggregate sales for a product.

      We modify the demand model derived in section 2.1. We relax the discrete-choice assumption

and allow    qj  R + .     We also assume that consumers make purchase decisions to maximize the

following CES preferences utility function

                                                                                                       
                                                                                                       -1
                                                                                        1    -1
                                     ~ j , j }j J
                            u { qj , x                  :=            { (~
                                                                         xj , j )} qj                                       (7.1)
                                                                j J


where     xj , j )  0
         (~             is a quality kernel,      ~j
                                                  x     is the vector of exogenous product characteristics that is

observable to the econometrician, and             j    is a vertical product characteristics that is unobserved to

the researcher as before.

      The representative consumer's budget-constrained utility maximization problem is:

                                                                       
                                                                       -1
                                                        1    -1
                       max                { (~
                                             xj , j )}  qj                       s.t.                 pj qj = y.
                      {qj }j J
                                    j J                                                      j J


The corresponding Marshallian demand system is:


                                                     xj , j ) p-
                                                    (~         j
                                                                 
                                 qj = y                             1-                  j  J ,                              (7.2)
                                                 kJ      (~
                                                          xk , k ) pk

which can be re-written in the following market share format:


                                                  qj                    xj , j ) p-
                                                                       (~         j
                                                                                    
                                      j                     =                                .                              (7.3)
                                                 kJ    qk          kJ         xk , k ) p-
                                                                             (~         k
                                                                                          



Let   h = 1, ..., H   index households, each with potentially heterogeneous quality kernel                             h (·)   and
                           h
elasticity of substitution  . The individual quantity share expressions of the CES demand system

(7.3) become:



                                     h           h (~
                                                    xj , j ) exp - h ln pj
                                     j =        J   h x ,  ) exp (- h ln p )
                                                k=0  (~ k k               k

                                                                 ~ j  h + j
                                                 exp - h ln pj + x
                                          =     J
                                                                                                  ,                         (7.4)
                                                k=0 exp                 ~ k  h + k
                                                            - h ln pk + x

where the second equality follows by specifying                   h (~              ~ j  h + j
                                                                     xj , j ) = exp x                         . The predicted ag-




                                                                29
gregate market share equation is obtained by aggregating the individual predicted quantity share

equations over the households    h.
   The CES market share is almost identical to the Random-Coecients Logit demand except for

some subtle dierences.     First, prices enter the demand system in logarithmic form.        Second, the

budget-constraint    j J   p j qj = y   must be imposed to infer the vector of quantities demanded,    q.
In contrast, for the discrete choice demand model, the xed market size constraint            j J   qj = M
is used to infer the vector of quantities demanded,       q.   Finally, the near mathematical equivalence

only holds for the stylized case of Type I extreme value random utility errors in the discrete choice

formulation.




8 Conclusion
We proposed a new method to handle dierentiated products demand estimation in the presence of

products capturing zero market share. We incorporate the role of selection on unobservables into

the model to correct for the potential bias when observations with zero market shares are dropped

from the demand estimation. We also propose a new, PDWGMM estimator that accommodates this

selection under a fully non-parametric specication during the selection stage. An empirical case

study shows that the PDWGMM estimator generates more price-elastic estimates of demand and a

better t of retail contribution margins.

   In practice, many consumer sales datasets exhibit a high incidence of zero-valued shares. Our

ndings suggest that typical, ad hoc xes will generate inconsistent demand estimates which would

likely have adverse implications for policy experiments using the estimated demand system. In sum,

we document a dierent form of endogeneity bias, selection on unobservables in product considera-

tion, that can bias demand estimates in addition to the biases from endogenous marketing variables

described in the extant literature.

   One potential extension of the proposed framework would be to study the potentially self-selected

manner in which assortments are set across markets, such as cities or even stores.          Determining

appropriate exlusion restrictions to determine prot instruments for the selection stage would be

an interesting direction for future research pooling demand estimation across markets with dierent

assortments.

   Numerous mechanisms could explain the selection on unobservables associated with zero-valued

shares, including consumer consideration, stock-outs and promotional conditions.           An interesting

direction for future research would consist of supplementing the point-of-sale data with additional

moments on factors such as inventory and/or consumer search and consideration to allow for a

richer model of how products ultimately enter consumers's choice sets. Moreover, data from these

alternative mechanisms could provide additional information to help with the identication of the

deep, consumer preference parameters.




                                                     30
References
Abaluck, J. and A. Adams (2018): What do consumers consider before they choose? Identi-

  cation from asymmetric demand responses,     Working Paper.
Adao, R., A. Costinot, and D. Donaldson (2017): Nonparametric Counterfactual Predictions

  in Neoclassical Models of International Trade,     American Economic Review, 107, 633689.
Ahn, H. and J. L. Powell (1993): Semiparametric estimation of censored selection models with

  a nonparametric selection mechanism,    Journal of Econometrics, 58, 329.
Aradillas-Lopez, A. (2012): Pairwise-dierence estimation of incomplete information games,

  Journal of Econometrics, 168, 1.
Aradillas-Lopez, A., B. E. Honoré, and J. L. Powell (2007): Pairwise dierence estimation

  with nonparametric control variables,   International Economic Review, 48, 11191158.
Berry, S. (1994): Estimating discrete-choice models of product dierentiation,      RAND Journal
  of Economics, 25, 242262.
Berry, S., J. Levinsohn, and A. Pakes (1995):            Automobile prices in market equilibrium,

  Econometrica, 63, 841890.
Besanko, D., S. Gupta, and D. Jain (1998):             Logit demand estimation under competitive

  pricing behavior: An equilibrium framework,    Management Science, 44, 15331547.
Blundell, R. W. and J. L. Powell (2004): Endogeneity in semiparametric binary response

  models,   Review of Economic Studies, 71, 655679.
Bronnenberg, B. J. (2015): The provision of convenience and variety by the market,        RAND
  Journal of Economics, 46, 480498.
Bronnenberg, B. J., J.-P. Dubé, and R. E. Sanders (Forthcoming): Consumer misinforma-

  tion and the brand premium: A private lavel blind taste test,   Marketing Science.
Bronnenberg, B. J., J. B. Kim, and C. F. Mela (forthcoming): Zooming in on Choice: How

  Do Consumers Search for Cameras Online?       Marketing Science.
Bruno, H. A. and N. J. Vilcassim (2008): Structural demand estimation with varying product

  availability,   Marketing Science, 27, 11261131.
Chernozhukov, V., H. Hong, and E. Tamer (2007): Estimation and condence regions for

  parameter sets in econometric models,    Econometrica, 75, 12431284.



                                                31
Chintagunta, P., J.-P. Dubé, and V. Singh (2003): Balancing Protability and Consumer

  Welfare in a Supermarket Chain,   Quantitative Marketing and Economics, 1, 111147.
Chintagunta, P., T. Erdem, and P. E. R. abd Michel Wedel (2006): Structural Modeling

  in Marketing: Review and Assessment,    Marketing Science, 25, 604616.
Ciliberto, F. and E. Tamer (2009): Market Structure and Multiple Equilibria in Airline Mar-

  kets,   Econometrica, 77, 17911828.
Conlon, C. T. and J. H. Mortimer (2013): Demand Estimation under Incomplete Product

  Availability,   AMERICAN ECONOMIC JOURNAL: MICROECONOMICS, 5, 130.
Cooper, L. G. and M. Nakanishi (1988):        Market Share Analysis, Kluwer Academic Publishers.
Dixit, A. K. and J. E. Stiglitz (1977): Monopolistic competition and optimum product diver-

  sity,   American Economic Review, 67, 297308.
Dubé, J.-P. (2019):    The Handbook of the Economics of Marketing,   Noth Holland, chap. Microe-

  conometric Models of Demand, 168.


Dubé, J.-P., J. T. Fox, and C.-L. Su (2012): Improving the Numerical Performance of Static and

  Dynamic Aggregate Discrete Choice Random Coecients Demand Estimation,        Econometrica, 80,
  22312267.


Feenstra, R. C. (1994): New product varieties and the measurement of international prices,

  American Economic Review, 84, 157177.
Gandhi, A. and J.-F. Houde (2019): Measuring substitution patterns in dierentiated products

  industries,   Working Paper.
Gandhi, A., Z. Lu, and X. Shi (2019): Estimating Demand for Dierentiated Products with

  Zeroes in Market Share Data, Working Paper.


Gupta, S., P. Chintagunta, A. Kaul, and D. R. Wittink (1996): Do Household Scanner

  Data Provide Representative Inferences from Brand Choices: A Comparison with Store Data,

  Journal of Marketing Research, 33, 383398.
Handbury, J. (2013): Are poor cities cheap for everyone?: Non-homotheticity and the cost of

  living across U.S. cities, Working Paper.


Handbury, J. and D. E. Weinstein (2014): Goods prices and availability in cities,      Review of
  Economic Studies, 82, 258296.
Hauser, J. R. (1978): Testing the Accuracy, Usefulness, and Signicance of Probabilistic Choice

  Models: AnInformation-Theoretic Approach,     Operations Research, 26, 406421.

                                                32
Hauser, J. R. and B. Wernerfelt (1990): An Evaluation Cost Model of Consideration Sets,

  Journal of Consumer Research, 16, 393408.
Helpman, E., M. Melitz, and Y. Rubinstein (2008): Estimating trade ows: Trading partners

  and trading volumes,   Quarterly Journal of Eonomics, 123, 441487.
Honka, E. (2014): Quantifying Search and Switching Costs in the U.S. Auto Insurance Industry,

  Rand Journal of Economics, 45, 847884.
Honoré, B. E. and J. L. Powell (2005):          Pairwise dierence estimators for nonlinear mod-
  els, Cambridge University Press, chap. 22, 520553, Identication and Inference for Econometric
  Models.


Imbens, G. W. and C. F. Manski (2004): Condence intervals for partially identied parame-

  ters,   Econometrica, 72, 18451857.
Joo, M., D. K. Gauri, and K. C. Wilbur (Forthcoming): Temporal distance and price respon-

  siveness: Empirical investigation of the cruise industry,   Management Science.
Kim, J. B., P. Albuquerque, and B. J. Bronnenberg (2010): Online Demand Under Limited

  Consumer Search,    Marketing Science, 29, 10011023.
 (2017): The Probit Choice Model under Sequential Search with an Application to Online

  Retailing,   Management Science, 63, 39113929.
Krugman, P. (1980): Scale economies, product dierentiation, and the pattern of trade,    American
  Economic Review, 70, 950959.
Li, Q. and J. S. Racine (2008): Nonparametric estimation of conditional cdf and quantile func-

  tions with mixed categorical and continuous data,    Journal of Business and Economic Statistics,
  26, 423434.


Manski, C. F. and E. Tamer (2002): Inference on regressions with interval data on a regressor

  or outcome,   Econometrica, 70, 519546.
Matzkin, R. L. (1992): Nonparametric and Distribution-Free Estimation of the Binary Threshold

  Crossing and the Binary Choice Models,     Econometrica, 60, 239270.
Mehta, N., S. Rajiv, and K. Srinivasan (2003): Price uncertainty and consumer search: A

  structural model of consideration set formation,    Marketing Science, 22, 5884.
 (2004): Role of Forgetting in Memory-Based Choice Decisions: A Structural Model,           Quan-
  titative Marketing and Economics, 2, 107140.


                                                 33
Moorthy, S., B. T. Ratchford, and D. Talukdar (1997):              Consumer Information Search

  Revisited: Theory and Empirical Analysis,     Journal of Consumer Research, 23, 263277.
Nevo, A. (2001): Measuring market power in the ready-to-eat cereal industry,    Econometrica, 69,
  307342.


 (2011): Empirical models of consumer behavior,           Annual Review of Economics, 3, 5175.
Petrin, A. and K. E. Train (2010): A Control Function Approach to Endogeneity in Consumer

  Choice Models,   Journal of Marketing Research, 47, 313.
Powell, J. L. (2001):    Semiparametric estimation of censored selection models, Cambridge:   Cam-

  bridge University Press, chap. 6, 165196.


Ratchford, B. T. (1980): The value of information for selected appliances,   Journal of Consumer
  Researach, 17, 1425.
Shugan, S. (1980): The cost of thinking,      Journal of Consumer Research, 17, 99111.
Spence, M. (1976):    Product selection, xed costs, and monopolistic competition,        Review of
  Economic Studies, 43, 217235.
Tenn, S. (2006): Avoiding aggregation bias in demand estimation: A multivariate promotional

  disaggregation approach,   Quantitative Marketing and Economics, 383405.




                                                 34
Appendix
A Implementation Details
A.1      Construction of Instruments
For the GMM problem, we use the unit cost and temporary discount ag and squared unit cost,
~,
Z    to instrument for prices. In addition, we use Gandhi and Houde (2019)'s                            product dierentiation
instruments to construct auxiliary moments based on functions of the product attributes,                              ~
                                                                                                                      X   and

^,
p    where   ^
             p   is the vector of predicted prices from the pricing equation (4.2), for the identication

of the standard deviations of the random coecients,                              (see also Joo et al., Forthcoming, for an

application). For continuous product attributes and predicted prices, two products are regarded as

neighbors    when they are within 1 standard deviation of the corresponding attribute variable. For

binary product attributes, two products are regarded as                         neighbors    when they have the same value.

For each SKU-level alternative, the dierentiation variable corresponding to an attribute is dened

by counting the number of within-market neighbors. The instrument matrix used for our PDWGMM

estimator is then constructed as follows:                 ~Z
                                                     Z := X ~p
                                                             ^ di Xdi                 , where the subscript di denotes the

product dierentiation instrument. We then take pairwise-dierences to form                               Z.   Finally, we dene
                                                          -1
the GMM weight matrix,           := (Z) (Z)                    .

     For the drop-zero (BLP) estimator, we use the standard instrument matrix (i.e., undierenced):
     ~Z
Z := X ~p
        ^ di Xdi            . We then dene the corresponding GMM weight matrix:                           := (Z Z)-1 .

A.2      MPEC Formulation for the Random-Coecients Logit PDWGMM Esti-
         mator
We modify the MPEC formulation given in Dubé et al. (2012) to our selection-correction PDWGMM

                                                         ^i -µ
                                                         µ   ^j                               n
                  := ¯,                 ^ i,j :=    1
                                                                                                   ×p
estimator of                    . Let
                                                   hn      hn           . Let           be              matrix such that each
                                                                                              2
                             
column is        ^.
                        Q :=
                      Let       (Z) where  denotes the Hadamard product. We can then write
                        
Q ( ) = (Z)              ^  ( ) . We can now write the MPEC estimator (4.7) in matrix form:
                         


                                                          min g g
                                                         (,,g)



                                                   s.t. 0 =  ( ; ) - s


                                                         0 = Q ( ) - g,                                                  (A.1)



where    (·)     is the system of predicted market shares and                       is the   p×p   GMM weighting matrix.



                                                                   35
   The Lagrangian is:



                   L (,  , g, s , g ) = g g + s ( ( ;  ) - s) + g (Z)                              ^ -g .


The gradient of the objective function is:



                                              g g = 0                0   2g          .

The constraint Jacobian is:
                                                             
                                                                          O
                                                            Q ()                .
                                                      O                  -I
      
  and   part are identical to what is described in the Appendix of Dubé et al. (2012).
             Q ()                 Q ()                    
  To derive
                  , rst let  =
                                            . Recall Q :=     (Z) and the structure of                          :

                                                                             
                                                                1 - 2
                                                                1 - 3 
                                                                      
                                                         
                                                                  .
                                                                      
                                                                  .
                                                                  .
                                                                      
                                                                      
                                                                      
                                                         
                                                                1 - n 
                                                                2 - 3 
                                                                      
                                                         
                                                      :=              .
                                                         
                                                                2 - 4 
                                                                  .
                                                                  .
                                                                      
                                                         
                                                                  .   
                                                                      
                                                                2 - n 
                                                                      
                                                         
                                                                  .
                                                                      
                                                                  .   
                                                                  .   
                                                              n-1 - n

It can be shown that the          k th   row of      is given by:


                                                      n                  n
                                          k = zk           ^ k,l     -              ^ k,l zl ,
                                                     l=1                 l=1

where   zk   is   k th   row of the instrument matrix      Z.

A.3     Bootstrap Algorithm for the Random-Coecients Logit PDWGMM Esti-
        mator
Suppose, rst, that we are estimating the original BLP without selection-correction. Bootstrapping

would require rst inverting the whole vector                  out from the original set of market share constraints



                                                      0 =  ( ; ) - s


                                                                36
and then resample        j   with the corresponding row of              Z   with replacement. This would also require

the weighting matrix              to change with the bootstrap resample scheme. Keeping this intuition in

mind, we describe the bootstrapping scheme below step-by-step:


  1. Randomly draw            n   integers out of    (1, 2, ..., n).    Denote this vector of resample index integers

     by   nb .   Throughout, the subscript            b   denotes the resampled matrix/vector according to this

     resample scheme          nb .

  2. Take   (Zb , pb )   from     (Z, p)   to estimate    ^b   in (4.1) of section 4.1.


  3. Take   ^b as the residual from the regression, to form the Wb matrix corresponding to the matrix
            
     W    in section 4.1.


  4. Find the vector         ^b
                             µ    in (4.4) where each element of            ^b
                                                                            µ    is   ^b,j .
                                                                                      µ

  5. Form     Zb   matrix by pairwise dierencing                 Zb .
                                            -1
  6. Form    b := (Zb ) (Zb )                    .

                         
  7. Form    Qb :=           b  (Zb ).

  8. Solve the following constrained optimization problem. Note that the rst set of constraints,

     0 =  ( ; ) - s,          are intact from the original problem.



                                                                min g b g
                                                               (,,g)

                                                     s.t. 0 =  ( ; ) - s
                                                               0 = Qb (b ) - g,                                (A.2)



     The constraint Jacobian is:
                                                                  
                                                                                 O
                                                                 Qb (b )                .
                                                          O                   -I




                                                                 37
The main change of (A.2) from point estimation problem (A.1) is the second part of the constraint
                                                                     
and its Jacobian component. Recall                     Qb :=            b  (Zb )                 and the structure of              b :
                                                                                                
                                                                              b1 - b2
                                                                              b1 - b3 
                                                                                      
                                                               
                                                                                 .
                                                                                      
                                                                                 .
                                                                                 .
                                                                                      
                                                                                      
                                                                                      
                                                               
                                                                              b1 - bn 
                                                                              b2 - b3 
                                                                                      
                                                               
                                                          b :=                        .
                                                               
                                                                              b2 - b4 
                                                                                 .
                                                                                 .
                                                                                      
                                                               
                                                                                 .    
                                                                                      
                                                                              b2 - bn 
                                                                                      
                                                               
                                                                                 .
                                                                                      
                                                                                 .    
                                                                                 .    
                                                                          bn-1 - bn

The dierence from point estimation is that the pairwise dierencing is taken in the order with

respect to the bootstrap shue indicator                          b1 , b2 , ..., bn .   However,         b    should be lled with the deriva-

tives of   Qb (b ) with respect to the original order of (1 , 2 , ..., n ).                                  Furthermore, there can be some

rows of    b    such that it is a zero vector due to the resampling scheme.

    The reshuing scheme described above makes the calculation of                                                 b      slightly more complicated
                                                                                                       Qb (b )
than the calculation of             .       Consider      b,j , j 'th     row of       b =                          . If    b    does not contain           j ,
b,j = 0.       Now suppose            b     contains only one           j .      Then, there is going to be one                        bk   such that      bk th
element of     nb    is    j.   Now, for such      j, k   pair,    b,j       becomes


                                                             n                            n
                                          b,j = zbk                   ^ bk ,bl        -               ^ bk ,bl zbl ,
                                                            l=1                           l=1

where   zb k   is   k th   row of    Zb .   If there are more than one                    bk    such that       bk th   element of          nb   is   j,

                                                                                  n                         n
                     b,j =                                            zb k                 ^ bk ,bl
                                                                                                       -                ^ bk ,bl zbl        .
                                 {bk :bk th element of nb is j }                 l=1                       l=1




                                                                             38
A.4    Bootstrap Algorithm for Random-Coecients Logit Demand Estimation
       When All the Observed Shares are Positive
When all the observed shares are positive, we have the usual MPEC formulation of the problem:



                                                       min g g
                                                     (  , ,g )

                                                s.t. 0 =  ( ; ) - s                                             (A.3)

                                                    0 = Z  - g.                                                 (A.4)



For each bootstrap trial,            should be replaced with         b    and   0 = Z-g      should be replaced with

0 = Zb b - g,      where   (b , Zb , b )    denotes the bootstrap-reshued matrices/vectors of               (, Z,  ).
However, the market-share equation (A.3) should be left intact.

   The gradient of the objective function is:



                                            g b g = 0            0       2g b .

The constraint Jacobian of the problem is


                                                          
                                                                     O
                                                                          ,
                                                   O      Zb     -I

and the Hessian of the Lagrangian is identical with the the original problem, except for the second

derivative of the objective function which is        2b .

A.5    Choice of Kernels and Bandwidth
For the kernel   H (·)   in (4.4), we use the product kernel with the marginal kernel for the continuous

elements of   wj   the Gaussian kernel. For the discrete elements of               wj ,   we use the kernel described

in pages 136-137 of Li and Racine (2008). Silverman's rule is used for the bandwidth of Gaussian

marginal kernel, and vector of ones are used for the bandwidth of discrete marginal kernel. The nal

results are robust to the choice of the bandwidth of Stage 2. For the kernel                  (·)   and bandwidth   hnd
in (4.7), we use the Gaussian kernel again with Silverman's rule-of-thumb bandwidth.




B Sensitivity of Estimates on the Imputed Magnitude of Zero Shares
In this section, we present the sensitivity analysis of the model parameter estimates with respect to

the magnitude of the small number being imputed in place of zero shares, estimation results both

for our Monte Carlo datasets and our real-world dataset.                      We estimated the Homogeneous Logit

model of demand with instrumenting for the prices, and varying the magnitudes of the number

being imputed from       10-5   to   10-300 .

                                                          39
   The datasets being used here are identical to the datasets used in sections 5 and 6, respectively.

Notice that the estimates of Impute   10-12   in Table 9 are identical to those of Impute   10-12   of Table

7. Analogously, the estimates of Impute 10
                                          -12 in Table 8 are identical to those of Impute           10-12   in

Table 5.




                                                    40
                 Table 7: Sensitivity of the Estimates to the Magnitude of the Small Number Being Imputed: Monte Carlo Datasets



      DGP                                                             (a) With Selection-on-Unobservables


                  Impute   Impute     Impute   Impute   Impute      Impute     Impute   Impute     Impute   Impute     Impute    Impute    Impute          Impute

                   10-5     10-6       10-7     10-8     10-9       10-10      10-12    10-15       10-20    10-30      10-50    10-100        10-200      10-300

      ¯ [2]       3.605    4.474      5.344    6.213    7.083       7.953      9.692    12.301     16.649   25.346     42.738    86.220    173.184        260.148

      ¯1 [1]      0.591    0.591      0.591    0.591    0.591        0.591     0.590    0.590       0.590    0.589      0.587     0.582        0.573        0.563

      ¯2   [2]    1.225    1.222      1.220    1.217    1.214        1.211     1.205    1.197       1.183    1.154      1.097     0.955        0.670        0.385

      ¯3   [2]    1.236    1.238      1.239    1.241    1.242        1.244     1.247    1.251       1.259    1.274      1.303     1.378        1.527        1.676




41
      DGP                                                          (b) Without Selection-on-Unobservables


                  Impute   Impute     Impute   Impute   Impute      Impute     Impute   Impute     Impute   Impute     Impute   Impute    Impute        Impute
                    -5           -6     -7       -8           -9         -10     -12         -15     -20         -30     -50      -100         -200
                   10       10         10       10       10         10         10       10         10       10         10       10        10            10-300

      ¯ [2]       0.934    0.924      0.915    0.905    0.895       0.886      0.866    0.837      0.789    0.692      0.498    0.013     0.956         1.926

      ¯1 [1]      0.562    0.556      0.550    0.543    0.537        0.530     0.518    0.498      0.467    0.403      0.275    0.044     0.682         1.320

      ¯2   [2]    1.160    1.150      1.141    1.132    1.122        1.113     1.094    1.067      1.020    0.927      0.741    0.275     0.656         1.588

      ¯3   [2]    1.163    1.154      1.146    1.137    1.128        1.119     1.101    1.075      1.031    0.942      0.766    0.324     0.560         1.444


     Notes. Column names indicate the imputed share value used to handle zeros during the estimation. True parameter values are reported in square brackets.
     The reported estimates are the means of each parameter across the 100 replications of the data generating process. Standard deviations across converged
     trials are reported in the parentheses.
          Table 8: Sensitivity of the Estimates to the Magnitude of the Small Number Being Imputed: Real-world Ice Cream Data



                        Impute    Impute    Impute    Impute    Impute    Impute    Impute    Impute    Impute    Impute    Impute    Impute     Impute     Impute     Impute
                        10-4      10-5      10-6      10-7      10-8      10-9      10-10     10-12     10-15     10-20     10-30     10-50      10-100     10-200     10-300


         Mean Elast.    3.392     5.171     6.950     8.729     10.509    12.288    14.067    17.625    22.963    31.858    49.650    85.233     174.19     352.105    530.02

            Price       0.917     1.399     1.880     2.361     2.842     3.324     3.805     4.767     6.211     8.617     13.430    23.054     47.116     95.239     143.362
                        (0.134)   (0.205)   (0.276)   (0.347)   (0.418)   (0.489)   (0.560)   (0.702)   (0.915)   (1.270)   (1.981)   (3.402)    (6.954)    (14.060)   (21.165)
        1000 Cal/pack   0.145     0.246     0.347     0.448     0.549     0.650     0.751     0.953     1.256     1.762     2.773     4.794      9.848      19.956     30.064
                        (0.432)   (0.666)   (0.900)   (1.136)   (1.371)   (1.606)   (1.842)   (2.312)   (3.019)   (4.196)   (6.552)   (11.263)   (23.040)   (46.595)   (70.151)
           Vanilla      0.536     0.801     1.065     1.329     1.594     1.858     2.122     2.651     3.444     4.766     7.409     12.695     25.912     52.345     78.778
                        (0.048)   (0.073)   (0.098)   (0.123)   (0.148)   (0.173)   (0.198)   (0.248)   (0.324)   (0.450)   (0.701)   (1.205)    (2.463)    (4.980)    (7.496)
          Chocolate     0.153     0.227     0.300     0.374     0.447     0.521     0.594     0.741     0.962     1.329     2.064      3.535      7.211     14.562     21.914
                        (0.044)   (0.067)   (0.091)   (0.115)   (0.139)   (0.162)   (0.186)   (0.234)   (0.305)   (0.424)   (0.663)   (1.139)     (2.33)    (4.713)    (7.095)




42
           Yogurt       0.470     0.721     0.972     1.222     1.473     1.724     1.974     2.476     3.227     4.481     6.987     12.000     24.532     49.597     74.662
                        (0.045)   (0.069)   (0.094)   (0.119)   (0.144)   (0.169)   (0.193)   (0.243)   (0.317)   (0.442)   (0.69)    (1.186)    (2.427)    (4.908)    (7.390)
            Mint        0.146     0.229     0.311     0.393     0.476     0.558     0.641     0.806     1.053     1.465     2.289      3.938      8.059     16.301     24.543
                        (0.067)   (0.103)   (0.139)   (0.175)   (0.211)   (0.248)   (0.284)   (0.356)   (0.465)   (0.647)   (1.010)   (1.735)    (3.550)    (7.179)    (10.808)
            Fruit       0.034     0.045     0.056     0.068     0.079     0.090     0.101     0.124     0.157     0.214     0.326     0.550      1.112      2.234      3.357
                        (0.059)   (0.092)   (0.124)   (0.157)   (0.190)   (0.222)   (0.255)   (0.320)   (0.418)   (0.582)   (0.908)   (1.562)    (3.195)    (6.462)    (9.729)

           Breyers      0.318     0.493     0.669     0.844     1.019     1.194     1.370     1.720     2.246     3.122     4.875     8.381      17.144     34.671     52.198
                        (0.152)   (0.232)   (0.313)   (0.393)   (0.474)   (0.555)   (0.635)   (0.796)   (1.038)   (1.442)   (2.249)   (3.862)    (7.897)    (15.966)   (24.034)
            Deans       0.912     1.395     1.877     2.360     2.842     3.325     3.807     4.772     6.220     8.632     13.458    23.108     47.233     95.483     143.733
                        (0.192)   (0.293)   (0.394)   (0.495)   (0.597)   (0.698)   (0.799)   (1.002)   (1.307)   (1.815)   (2.830)   (4.861)    (9.939)    (20.094)   (30.250)
            Edys        0.770     1.172     1.575     1.978     2.381     2.783     3.186     3.991     5.199     7.213     11.240    19.293     39.428     79.697     119.966
                        (0.168)   (0.257)   (0.347)   (0.436)   (0.526)   (0.615)   (0.705)   (0.884)   (1.153)   (1.601)   (2.498)   (4.291)    (8.774)    (17.74)    (26.707)

     Notes. Column names indicate the imputed share value used to handle zeros during the estimation. Bootstrap standard errors for each coecient estimate
     are reported in parentheses. Mean Elast. row indicates the mean own-price elasticities across all the observations.
C Homogeneous Logit Demand Model Estimates on Monte Carlo
  Datasets
Table 9 presents the estimation results for the Homogeneous Logit models using the same 100 Monte

Carlo datasets generated and used in section 5. It turns out that not accounting for the random-

coecients during the estimation biases the coecient estimates slightly.   Even without random-

coecients, our PDWGMM estimator performs very well compared to the conventional methods to

handle zeros when selection-on-unobservables aect the prevalence of zero market shares.




                                               43
                                           Table 9: Homogeneous Logit Monte Carlo Data Estimation Results



               DGP               (a) With Selection-on-Unobservables               (b) Without Selection-on-Unobservables           (c) No Zero Shares

                                                                               Homogeneous Logit

            Parameters    PDWGMM        Heckman     Drop 0   Impute 10-12     PDWGMM        Heckman    Drop 0    Impute 10-12      PDWGMM        Drop 0




44
               ¯ [2]         2.225        1.797     4.429        9.692           1.756       1.679     1.668        0.866            1.752       1.673
               ¯1 [1]        1.146        1.030      0.999       0.590           1.047        1.005     1.002        0.518            1.036      0.997
               ¯2 [2]        2.417        2.139      2.077       1.205           2.139        2.061     2.051        1.094            2.145      2.066
               ¯3 [2]        2.415        2.139      2.085       1.247           2.148        2.065     2.055        1.101            2.143      2.064

     Notes. Column names indicate how the zero shares are handled during the estimation. True parameter values are reported in square brackets. The reported
     estimates are the means of each parameter across the 100 replications of the data generating process. Heckman is the classical Heckman selection estimator
     with inverse Mills ratio as an additional regressor.
