                                   NBER WORKING PAPER SERIES




                                        IMPOSSIBLE FRONTIERS

                                             Thomas J. Brennan
                                               Andrew W. Lo

                                           Working Paper 14525
                                   http://www.nber.org/papers/w14525


                        NATIONAL BUREAU OF ECONOMIC RESEARCH
                                 1050 Massachusetts Avenue
                                   Cambridge, MA 02138
                                      December 2008




The views and opinions expressed in this article are those of the authors only, and do not necessarily
represent the views and opinions of AlphaSimplex Group, MIT, Northwestern University, any of their
affiliates and employees, or the National Bureau of Economic Research. The authors make no representations
or warranty, either expressed or implied, as to the accuracy or completeness of the information contained
in this article, nor are they recommending that this article serve as the basis for any investment decision---this
article is for information purposes only. Research support from AlphaSimplex Group and the MIT
Laboratory for Financial Engineering is gratefully acknowledged. We thank Henry Cohn, Sanjiv Das,
Arnout Eikeboom, Leonid Kogan, Tri-Dung Nguyen, and participants of the JOIM Fall 2008 Conference
and the MIT Finance Lunch for helpful comments and discussions.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2008 by Thomas J. Brennan and Andrew W. Lo. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
Impossible Frontiers
Thomas J. Brennan and Andrew W. Lo
NBER Working Paper No. 14525
December 2008
JEL No. G1,G11,G12,G14,G23,G32

                                                ABSTRACT

A key result of the Capital Asset Pricing Model (CAPM) is that the market portfolio---the portfolio
of all assets in which each asset's weight is proportional to its total market capitalization---lies on the
mean-variance efficient frontier, the set of portfolios having mean-variance characteristics that cannot
be improved upon. Therefore, the CAPM cannot be consistent with efficient frontiers for which every
frontier portfolio has at least one negative weight or short position. We call such efficient frontiers
"impossible", and derive conditions on asset-return means, variances, and covariances that yield impossible
frontiers. With the exception of the two-asset case, we show that impossible frontiers are difficult
to avoid. Moreover, as the number of assets n grows, we prove that the probability that a generically
chosen frontier is impossible tends to one at a geometric rate. In fact, for one natural class of distributions,
nearly one-eighth of all assets on a frontier is expected to have negative weights for *every* portfolio
on the frontier. We also show that the expected minimum amount of shortselling across frontier portfolios
grows linearly with n, and even when shortsales are constrained to some finite level, an impossible
frontier remains impossible. Using daily and monthly U.S. stock returns, we document the impossibility
of efficient frontiers in the data.


Thomas J. Brennan
School of Law, Northwestern University
East Chicago Avenue
Chicago, IL 60611
t-brennan@law.northwestern.com

Andrew W. Lo
Sloan School of Management
MIT
50 Memorial Drive
Cambridge, MA 02142-1347
and NBER
alo@mit.edu
Contents
1 Introduction                                                                                                                                              1

2 Literature Review                                                                                                                                         2

3 Some Examples of Impossible Frontiers                                                                                                                     4
  3.1 The Two-Asset Case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                                                                      5
  3.2 The Three-Asset Case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                                                                      6

4 The   General Case                                                                                                                                         9
  4.1   Haar Measure and Covariance Matrices . . . . . . . . . . . . . . . . . . . . .                                                                      10
  4.2   Linear-Factor Models and Impossibility . . . . . . . . . . . . . . . . . . . . .                                                                    13
  4.3   Additional Impossibility Results . . . . . . . . . . . . . . . . . . . . . . . . .                                                                  16

5 The   One-Factor Model                                                                                                                                    18
  5.1   Characterizing Impossible Tangency Portfolios . . . . . . . . . . . . . . . . .                                                                     19
  5.2   The Probability of Impossible Tangency Portfolios . . . . . . . . . . . . . . .                                                                     20
  5.3   A Non-Impossible Covariance Matrix . . . . . . . . . . . . . . . . . . . . . .                                                                      22

6 Empirical Analysis                                                                                                                                        23
  6.1 The Data . . . . . . . . . . . . . . . . .                            .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   24
  6.2 A 100-Stock Empirical Efficient Frontier                              .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   24
  6.3 More Impossible Frontiers . . . . . . . .                             .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   25
  6.4 Estimation Error . . . . . . . . . . . . .                            .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   25

7 Conclusion                                                                                                                                                27

A Appendix                                                                                                                                                  29
  A.1 Proof of    Proposition 1     .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   29
  A.2 Proof of    Proposition 2     .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   29
  A.3 Proof of    Corollary 1 . .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   30
  A.4 Proof of    Lemma 1 . . .     .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   30
  A.5 Proof of    Corollary 3 . .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   31
  A.6 Proof of    Theorem 1 . .     .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   31
  A.7 Proof of    Theorem 2 . .     .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   32
  A.8 Proof of    Theorem 3 . .     .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   33
  A.9 Proof of    Theorem 4 . .     .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   33
  A.10 Proof of   Theorem 5 . .     .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   34
  A.11 Proof of   Theorem 6 . .     .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   35

References                                                                                                                                                  36
1     Introduction
A cornerstone of modern portfolio management is the “efficient frontier” of mean-variance
analysis: the set of portfolios for which the lowest variance possible is attained for given
levels of expected return, or the highest possible expected return is attained for a given
level of variance. The main thrust of the Capital Asset Pricing Model (CAPM) is that
the market portfolio—the portfolio of all assets where each asset’s weight is proportional
to its total market capitalization—must lie somewhere on the efficient frontier. Since, by
definition, every component of the market portfolio has a positive weight (because its market
capitalization must be positive), we would expect at least one portfolio on the efficient frontier
to have this property. If, for a given a set of asset-return parameters (means, variances, and
covariances), the corresponding efficient frontier does not have any such portfolio, we call
this an “impossible frontier” for obvious reasons.
    In this paper, we show that, as the number of assets grows large, nearly all efficient
frontiers are impossible.
   Specifically, for any arbitrary set of expected returns, and for a randomly chosen covari-
ance matrix, we show that the probability that the resulting frontier is impossible approaches
one as the number of assets increases without bound. This result depends, of course, on the
specific distribution from which we draw the covariance matrix, and we consider two classes:
the uniform distribution (Haar measure), and distributions centered around linear-factor
models such as the CAPM and Ross’s (1976) Arbitrage Pricing Theory (APT). For both
classes of distributions, mean-variance efficient frontiers are almost surely impossible.
   This remarkable result is not an artifact of pathological parameters, except in the two-
asset case, but is apparently a generic property of mean-variance efficient portfolios. For
typical parameter values, every portfolio on the efficient frontier will contain at least one
short position, i.e., a negative weight. This implies that such an efficient frontier cannot be
consistent with a CAPM equilibrium in which every investor holds the tangency portfolio, for
such an equilibrium requires all weights to be positive for that portfolio. Alternatively, our
impossibility result implies that the set of expected return vectors and covariance matrices
(µ, Σ) that is consistent with a CAPM equilibrium is extremely small—in fact, measure-zero
in the limit—hence we should not expect typical empirical estimates of (µ, Σ) to yield plau-
sible portfolios from the CAPM perspective unless the CAPM is literally true and estimation
error is negligible.
   Our results provide one explanation for the skepticism that most long-only portfolio man-
agers have for standard mean-variance optimization—from their perspective, an impossible
frontier is truly impossible for them to implement. Moreover, it is well known that the output


                                                1
of standard portfolio optimizers yield weights that must be constrained, but until now, the
non-negativity restriction that has become second nature to practitioners was thought to be
a consequence of estimation error. The results in our paper show that even in the ideal case
where the means and covariance matrix of asset returns are known with perfect certainty,
the efficient frontier will almost always contain negative weights. To the extent that esti-
mation error generates means and covariances that deviate from the CAPM, such sampling
variation will only exacerbate the problem, making it more likely that the sample efficient
frontier is impossible. Our impossibility results may also provide a partial explanation for
the recent popularity of so-called “active extension” strategies such as 130/30 portfolios in
which a limited amount of shortselling is permitted.
   We begin in Section 2 with a brief review of the literature, and in Section 3 we derive
analytical results for the two- and three-asset cases to build intuition and motivate our
more general results. The main results of the paper are contained in Section 4, where
we propose two classes of probability measures for covariance matrices and show that under
both these classes of measures, impossible frontiers become the rule, not the exception, as the
number of assets increases without bound. We also show that the expected minimum amount
of shortselling across frontier portfolios grows linearly with n, and even when shortsales
are constrained to some finite level, an impossible frontier remains impossible. Given the
importance of the CAPM, in Section 5 we examine the linear one-factor return-generating
model in more detail, and show how to construct a covariance matrix that does not yield
an impossible tangency portfolio. In Section 6, we provide an empirical illustration of our
theoretical findings using daily and monthly returns for a subset of S&P 500 stocks, and
show that the usual sample estimators of (µ, Σ) do yield impossible frontiers. We conclude
in Section 7 with a discussion of the theoretical and practical significance of our results.


2    Literature Review
Any review of the mean-variance portfolio selection literature must begin with Markowitz
(1952) who first introduced this powerful framework to the economics literature. Building on
the Markowitz mean-variance framework, Tobin (1958), Sharpe (1964), and Lintner (1965)
derived the equilibrium implications under the assumption that all investors held mean-
variance-optimal or “efficient” portfolios, culminating in the “Capital Market Line”, the line
in mean-standard deviation space connecting the riskfree rate on the expected-return axis
with the tangency portfolio on the efficient frontier in mean-standard deviation space.
   The role of shortsales in mean-variance analysis has also been considered by several


                                               2
authors. In fact, Markowitz (1959, p. 132) recognized the importance of implementing
constraints on portfolio weights, one of which was a non-negativity or shortsales constraint.
However, Lintner (1965) was perhaps the first to study the impact of shortsales on capital
market equilibrium, deriving alternative equilibria under shortsales prohibitions as well as
shortsales constraints. Lintner concluded that investors would not engage in shortsales in
equilibrium because of the Tobin separation theorem, i.e., all investors are indifferent between
holding portfolios of all assets versus portfolios of just two funds—the riskless asset and the
tangency portfolio. None of these authors studied the prevalence of short positions in the
tangency portfolio, essentially ruling out such “impossible frontiers” in equilibrium.
   A number of papers have been written about the impact of shortsales constraints on asset
prices in various settings, including Pogue (1970), Brito (1978), Jarrow (1980), Diamond
and Verrecchia (1987), Heaton and Lucas (1996), Detemple and Shashidhar (1997), Duffie,
Garleanu, and Pedersen (2002), and Sun and Wang (2006). However, these studies are
focused on the equilibrium effects of credit constraints, not on quantifying the frequency or
amount of shorting in the generic mean-variance-efficient portfolio, which we propose to do
in this paper.
    More recently, Markowitz (2005) has argued that empirical deviations from the CAPM
are not surprising in light of the counterfactual assumptions on which the CAPM is based.
In particular, he observes that “When one clearly unrealistic assumption of the capital asset
pricing model is replaced by a real-world version, some of the dramatic CAPM conclusions
no longer follow”. An example is the fact that unlimited borrowing and lending at identical
yields is not possible in practice, and this limitation implies that the market portfolio need
not be mean-variance-efficient in equilibrium.
    Markowitz’s (2005) caveats are well taken, but the results of our paper are considerably
stronger. We argue that even if all the assumptions of the CAPM are true, the market port-
folio need not be mean-variance efficient. Specifically, Markowitz (2005) states the following
assumptions:

(A1) Transaction costs and other illiquidities can be ignored.

(A2) All investors hold mean-variance efficient portfolios.

(A3) All investors hold the same (correct) beliefs about means, variances, and covariances
     of securities.

(A4) Every investor can lend all she or he has or can borrow all she or he wants at the
     risk-free rate.


                                               3
and argues that Conclusion 1 follows:

(C1) The market portfolio is a mean-variance efficient portfolio.

The results of Sections 3–5 below show that there exist certain combinations of means,
variances, and covariances for which every mean-variance efficient portfolio contains short
positions, implying that none can be the market portfolio. And as the number of assets
grows without bound, the likelihood of coming across a set of parameter values with this
characteristic is almost certain.


3       Some Examples of Impossible Frontiers
We begin with some notation. Let µ be the vector of expected returns for n assets, and let
Σ be the covariance matrix of those returns.1 For a given level of expected return µo , the
corresponding portfolio on the efficient frontier is the vector ω which minimizes the value of


                            ω t Σω    subject to ω t ι = 1 , ω t µ = µo .                               (1)


where ι is a column vector of ones of the appropriate length. The set of optimal ω can be
found using the method of Lagrange multipliers (see, for example, Merton, 1972):

                                                                                  
                                  BC             B                                 B
             F    =        ω : ω=           µo −     (ω µ − ω g ) + ω g , for µo ≥                      (2)
                                  D              C                                 C

where


            A ≡ µt Σ−1 µ , B ≡ µt Σ−1 ι , C ≡ ιt Σ−1 ι , D ≡ AC − B 2                                   (3)


and


                               ω g ≡ Σ−1 ι/C , ω µ ≡ Σ−1 µ/B .                                          (4)
    1
    Throughout this paper, we maintain the following notational conventions: (1) all vectors are column
vectors unless otherwise indicated; (2) matrix transposes are indicated by t superscripts, hence ω t is the
transpose of ω; and (3) vectors and matrices are always typeset in boldface, i.e., X and µ are scalars and X
and µ are vectors or matrices.




                                                     4
Note that ω g is the global minimum-variance portfolio, and ω µ is the vector that maxi-
mizes the Sharpe ratio relative to the risk-free rate of zero, i.e., ω µ maximizes the function
     √
µt ω/ ω t Σω.
   The frontier starts at the expected return level µo = B/C. In fact, we can compute
minimum-variance portfolios for values of µo less than B/C, but these portfolios would lie
on the “inefficient” branch of the portfolio frontier, i.e., the portion of the frontier for which
return is not maximized for a given level of risk.
   We call a frontier “impossible” with respect to the i-th component if the weight of the
i-th component at each point on the frontier is negative. Clearly, a sufficient condition for a
frontier to be impossible is that it be impossible for the i-th asset, 1 ≤ i ≤ n. From (2), we
see that every point on an efficient frontier can be written in the form

                                                   
                                        C         B
                               ω =           µo −     ωP + ωg                                 (5)
                                        D         C

where ω P ≡ Bω µ − Bω g . The values of C and D are non-negative by the Cauchy-Schwartz
inequality, so a frontier will be impossible with respect to the i-th asset exactly when ω g
and ω P both have negative i-th components.
   Our technique for proving that an efficient frontier is impossible is to show that the i-th
elements of both ω g and ω P are negative for some i. Using this method, we can calculate
a lower bound for the probability that a generically chosen efficient frontier is impossible,
as well as lower bounds for the expected number of coordinates on a frontier with respect
to which the frontier is impossible, and also lower bounds on the expected amount of total
shortsales at each point on the frontier.
   In Section 3.1, we investigate the special case of n = 2 and find that certain frontiers
are impossible, but only under some rather unnatural conditions. However, in Section 3.2,
we show that when n = 3, a variety of frontiers become impossible without any unnatural
conditions.


3.1    The Two-Asset Case
For the case of n = 2 assets, we can characterize all situations in which a frontier will be
impossible (proofs are included in the Appendix):

Proposition 1 For n = 2, let the assets be ordered so that µ1 < µ2 , let σi denote the risk of
the i-th asset, and let ρ denote the correlation between the assets. The efficient frontier is



                                                5
impossible if and only if

                                          σ2
                                                   < ρ.
                                          σ1

Because ρ ≤ 1, the proposition implies that a necessary condition for a frontier with two
assets to be impossible is that σ2 < σ1 . Also, since the volatilities are both non-negative,
it is also necessary that ρ > 0. Thus, for a frontier to be impossible, the asset with higher
expected return must also have lower risk, and the two assets must be positively correlated.
In such a circumstance, it will be optimal to have a short position in the low-return/high-risk
asset at every point on the efficient frontier.
    This condition is unnatural because the lower expected-return asset is strictly domi-
nated by the higher expected-return asset given that the latter is less risky than the former.
Therefore, on purely economic grounds, it is possible to rule out impossible frontiers in the
two-asset case. However, we show in the next section that with just one more asset, there is
no natural way to avoid impossible frontiers.


3.2    The Three-Asset Case
For n = 3 assets, we provide a characterization of 3 × 3 covariance matrices that gives rise
to a minimum-variance portfolio with negative weights when the volatilities of all assets are
equal. This result will allow us to specify a class of covariance matrices that imply arbitrarily
large amounts of shortselling in the minimum-variance portfolio in the equal-volatilities case.
Finally, we use our results to illustrate an example of a situation in which three assets can
give rise to an impossible frontier without any unnatural restrictions on the risks and returns
of the assets.
    For the moment, we assume that the volatilities of all three assets are the same, which
we normalize to 1 without loss of generality, hence the covariance matrix has the form:

                                                          
                                                   1 a c
                                               
                                    Σ =  a 1 b  .                                          (6)
                                          c b 1


The range of possible values for a, b, and c for which Σ is positive definite is given by the




                                                   6
following subset of R3 :

             n                         √       √                            o
                 (a, b, c) : c = ab + e      2     2
                                      c 1 − a 1 − b , with a, b, e
                                                                 c ∈ (−1, 1) .              (7)


We can then completely characterize the values of a, b, and c that yield negative weights in
the minimum-variance portfolio:

Proposition 2 If Σ is of the form (6), the first component of ω g has a negative value when


                                    c > 1 − a + b.


The second component has a negative value when


                                    c < a + b − 1.


The third component has a negative value when


                                    c > a − b + 1.


These three conditions are all mutually exclusive since a, b, c < 1, so at most one component
of ω g may be negative.

Corollary 1 Let Σ be of the form (6). If we let d = 1 − ε, for ε → 0+ , and we set a = d,
                        √        √
b = d, and c = ab − d 1 − a2 1 − b2 , then Σ is a non-degenerate covariance matrix and
the short position required in the minimum-variance portfolio ω g is

                                               1
                                  ωm2    = −      + O(1) .
                                               2ε

    Corollary 1 implies that, by allowing ε to tend toward zero, arbitrarily large short posi-
tions in the minimum-variance portfolio can be generated. The proof of Proposition 2 follows
directly from the calculation of a formula for the value of ω g in the three-asset case, and the
proof of the corollary follows from that same explicit formula and an additional calculation
(see the Appendix for further details).
   Armed with these results, we can now construct a non-trivial three-asset example with

                                               7
impossible frontiers. We begin with a correlation matrix C of the same form as the covariance
matrix in Corollary 1, with ε = 0.35:

                                                                 
                                         1.0000 0.6500 0.0471
                                                       
                             C =  0.6500 1.0000 0.6500                                     (8)
                                   0.0471 0.6500 1.0000


Let the expected returns for the three assets be 10%, 14%, and 18%, respectively, and let
their volatilities be 15%, 20%, and 25%, respectively, hence (µ, Σ) are:

                                                                 
                      0.10                     0.0225 0.0195 0.0018
                                                                 
                µ =  0.14          ,   Σ =  0.0195 0.0400 0.0325  .                      (9)
                      0.18                     0.0018 0.0325 0.0625


Note that unlike the condition in Proposition 1, these parameters do not imply any type
of dominance relation among the three assets—higher expected-return assets have higher
volatilities. These parameters yield the following values for ω P and ω g :

                                                                                
                                             −1.4046                      1.0888
                                                                            
           ωP    = B(ω µ − ω g ) =           0.7212      ,   ω g =  −0.5859  .          (10)
                                              0.6834                    0.4971


Given the expression (5) for the efficient frontier, it is apparent that every frontier portfolio
close to ω g has a short position in asset 2, and every frontier portfolio close to a multiple of
ω P has a short position in asset 1. A calculation shows that in fact there is a short position
in asset 2 for each frontier portfolio with an expected return less than 18.42%. At this point,
there is also a short position of −5.23% in asset 1, and the short position in asset 1 increases
for in portfolios with higher expected returns. Thus, all portfolios on the efficient frontier
have an aggregate short position of at least −5.23%.
   In fact, the efficient frontier (10) will continue to be impossible if the values of µ and Σ
are allowed to vary within a small neighborhood of (9). Many other three-asset examples
of impossible frontiers can be constructed, and with empirically plausible parameters. By
increasing the number of assets from two to three, the set of impossible frontiers seems to
have grown significantly. In Section 4, we show that this is no coincidence, and that as n
increases without bound, an arbitrarily chosen frontier is almost surely impossible.

                                                8
4         The General Case
In this section, we consider the general case of an arbitrary number of n assets. Unfortu-
nately, simple analytical results like those for the two- and three-asset cases of Section 3
are not available for an arbitrary number of assets. However, we propose to conduct the
following thought experiment: for a given vector µ of expected returns, and a randomly
selected covariance matrix Σ, what is the likelihood that the resulting frontier is impossible?
To compute such a probability, we must, of course, propose a probability distribution for a
covariance matrix, which is not a straightforward exercise. Although distributions of covari-
ance matrices have been developed in the statistics literature, e.g., the Wishart distribution,
they are sampling distributions of covariance-matrix estimators applied to independently
and identically distributed multivariate normal data (see Anderson, 1984, chapter 7). Such
distributions are highly parametric—if multivariate normality does not hold, then neither
does the Wishart—and also do not necessarily capture the randomness that we seek, i.e., the
random drawing of an arbitrary population covariance matrix from the space of all possible
covariance matrices. In particular, Wishart distributions are typically “centered” at the esti-
mated sample covariance matrix with multivariate tails that decline exponentially fast. This
may be a reasonable model of the randomness associated with sampling error, but seems less
compelling as a mechanism for drawing an arbitrary covariance matrix at random.
   Instead, we seek a more general distribution, such as a uniform distribution over the
space of all possible covariance matrices, i.e., the space of all (n × n) symmetric positive-
definite matrices with real elements. However, because this space is not compact, a uniform
distribution over this space will have infinite mass. Nevertheless, in the same way that an
“improper prior” can be specified in Bayesian inference,2 we can construct an “uninforma-
tive” distribution as a proxy for the uniform. We provide such a distribution for covariance
matrices in Section 4.1 using the concept of Haar measure, which will allow us to gauge the
probability that a randomly selected covariance matrix gives rise to an impossible frontier,
yielding the conclusion that impossible frontiers are almost certain to arise as the number of
assets increases without bound.
    However, it may be argued that an uninformative distribution of covariance matrices
will not yield economically relevant draws because the resulting covariance matrices lack
the factor structure hypothesized in the most popular asset-pricing models. To address
this concern, in Section 4.2 we introduce another class of probability distributions centered
around the covariance matrices generated by linear factor-pricing models such as the CAPM
and APT, and derive lower bounds on the probability that a frontier is impossible if it is
    2
        See, for example, Jeffreys (1961, pp. 180–181) and Box and Tiao (1973, p. 426).


                                                        9
chosen randomly with respect to one of the distributions in this class. We show that this
lower bound also approaches unity as n grows without bound.
   In Section 4.3, we calculate lower bounds on the expected number of assets with respect
to which a frontier will be impossible, as well as estimates for the expected minimum size of
short positions across frontier portfolios. We also find that an impossible frontier will remain
impossible even if constraints are placed on the total amount of shortselling allowed in any
portfolio.


4.1    Haar Measure and Covariance Matrices
Haar measure is the unique measure (up to a constant) that is invariant under the natural
action of the group GLn of invertible linear transformations on Rn on the space of covariance
matrices. For G ∈ GLn , this action is defined by Σ 7→ GΣGt for Σ ∈ Pn where Pn is the
symmetric space of all positive-definite matrices on Rn , and any covariance matrix Σ can
be mapped to any other covariance matrix under some such action. Thus, any such action
takes a neighborhood around a specified covariance matrix to a corresponding neighborhood
around any other covariance matrix, and Haar measure assigns the same volume to every such
image of the original neighborhood. In this sense, Haar measure behaves uniformly on all of
Pn and represents an “uninformative” prior distribution over all possible (n×n) covariance
matrices. The following definition summarizes Haar measure on GLn (see Jorgenson and
Lang, 2005 for further discussion).

Definition 1 Haar measure on Pn is the measure, νn , that is invariant under transforma-
tions of the form Σ 7→ GΣGt , for G ∈ GLn . Thus, for any region S ⊆ Pn , Haar measure
has the property that

                                                            
                                   νn (S) = νn GSGt                                        (11)


for all G ∈ GLn . This measure is unique up to multiplication by a positive constant, and in
terms of the elements of the matrix Σ = [Σi,j ], we have

                                                   1        Y
                            dνn (Σ) =                             dΣi,j                    (12)
                                          (det(Σ))(n+1)/2   i≤j



where dΣi,j is the element of Euclidean measure.



                                              10
   Under Haar measure, the entire space Pn has infinite volume so we cannot scale by a
constant to transform Haar measure into a proper probability density. Instead, we calculate
the probability that a selected frontier is impossible on cross sections of Pn using the prob-
ability density induced by Haar measure on those cross sections. We need first to introduce
a useful system of coordinates on Pn with respect to which we can easily define our cross
sections.

Definition 2 Each matrix M ∈ Pn can be uniquely expressed in terms of (partial) Iwasawa
coordinates as (X, W, V), where W ∈ P2 , V ∈ Pn−2 , and X ≡ [x1 , x2 ], with x1 , x2 ∈ Rn−2 .
The relationship between M and (X, W, V) is defined by the formula

                               !             !              !                                 !
                      I2 Xt         W 0           I2 0                   W + Xt VX Xt V
            M =                                                  =                                .   (13)
                      0 In−2        0 V           X In−2                   VX       V


Moreover, each matrix W can be uniquely expressed in terms of Iwasawa coordinates as
(y, u, v), where u, v ∈ R+ and y ∈ R, according to the relationship

                                      !          !      !                             !
                                1 y       u 0        1 0               u + y 2v yv
                   W =                                    =                               .           (14)
                                0 1       0 v        y 1                 yv     v


Finally, we can also express each matrix X in terms of polar coordinates (r1 , . . . , rn−2 , θ1 , . . . ,
θn−2 ), where ri ∈ R+ and θi ∈ S 1 , using the relationships x1,i = ri cos θi and x2,i = ri sin θi .
Therefore, each M ∈ Pn can be written in terms of coordinates


                           M = (r1 , . . . , rn−2 , θ1 , . . . , θn−2 , y, u, v, V)                   (15)


so that the space Pn can be viewed as the product

                                                  n−2
                     Pn    = (R+ )n−2 × S 1               × R × R+ × R+ × Pn−2 .                      (16)


   Using the coordinate system of Definition 2, we consider cross sections of Pn that have
fixed values of all coordinates except the θi . We write Z = Z (r1 , . . . , rn−2, y, u, v, V) for
such a cross section with specified fixed values of the coordinates r1 , . . . , rn−2, y, u, v and
V. This cross section is thus a product of (n−2) copies of S 1 , and the measure on this cross


                                                     11
section induced by Haar measure on Pn is

                                                1
                                  dνZ   =            dθ1 · · · dθn−2 .                             (17)
                                             (2π)n−2

The measure νZ is therefore a proper probability distribution on the cross-sectional space Z;
although probabilities cannot be computed with respect to Haar measure on all of Pn , they
can be computed with respect to νZ on each cross section Z of Pn .
   To calculate the probability that a covariance matrix, Σ, gives rise to an impossible
frontier, it is convenient first to change variables from Σ to M using the correspondence


                                            Σ = AMAt                                               (18)


where A = A (c1 , . . . , cn ) is the unique matrix in GLn with columns defined by


          Ae1 = c1 ι , Ae2 = c2 µ , and Aej                         = cj ej        for 3 ≤ j ≤ n   (19)


for specified values of ci > 0. Haar measure is invariant under this change of variables, and
so we can replace Σ with M and use Haar measure on M as the basis for our probability
calculations. We calculate the probability that a matrix Σ = AMAt gives rise to an impos-
sible frontier for a matrix M in a cross section Z, where the probability is calculated with
respect to the distribution νZ . In Theorem 1, we obtain a lower bound for the probability
of impossibility, but first we need a lemma specifying a useful test for impossibility.

Lemma 1 For a frontier to be impossible with respect to the i-th coordinate, it is necessary
and sufficient that

                                                                        
                                                              µt Σ−1 ι
               eti Σ−1 ι   < 0 and        eti Σ−1 µ   −                      eti Σ−1 ι < 0 .       (20)
                                                              ιt Σ−1 ι

If Σ = AMAt and i > 2, the conditions in (20) are equivalent to


                           cos θi−2   > y sin θi−2     and      sin θi−2       > 0                 (21)


where M has coordinates as in Definition 2.

                                                  12
Theorem 1 Let M ∈ Z = Z (r1 , . . . , rn−2 , y, u, v, V) be chosen randomly with respect to the
distribution νZ . The probability, pZ , that the covariance matrix Σ = AMAt gives rise to an
impossible frontier is bounded below as

                                     n−2                                                   n−2
                    1                                                            1
      pZ   ≥ 1− 1−    cot−1 y                      ≥ 1 − 1−                                          .   (22)
                   2π                                                    2π (1 + max(0, y))

This theorem shows that, for any fixed value of y, the probability, pZ , that a covariance
matrix in a cross section Z gives rise to an impossible frontier tends to 1 geometrically as n
grows. Moreover, if y is bounded above by y+ , the probability for any cross section Z with
a such a y coordinate tends to 1 at least as quickly as

                                                                             n−2
                                                             1
                       pZ   ≥ 1 − 1−                                                  .
                                                    2π (1 + max(0, y+ ))

    The following corollary extends the previous results to yield a lower bound on the prob-
ability of impossibility for probability densities on the entire space Pn .

Corollary 2 Let ϕ be any probability density on Pn which factors into a product of densities

                              n−2
                                           !       n−2
                                                                !
                              Y                    Y
                    ϕ =             ϕr i       ×         ϕ θi       × ϕy × ϕu × ϕv × ϕV                  (23)
                              i=1                  i=1



where the ϕθi are uniform probability densities on S 1 and the other distributions are aribtrary
distributions on the respective spaces ri ∈ R, y ∈ R, u ∈ R+ , v ∈ R+ , and V ∈ Pn−2 . Let
Σ = AMAt be an arbitrary covariance matrix, with A as defined in (19), and with M
chosen randomly in accordance with the distribution ϕ. The probability, p, that Σ gives rise
to a frontier which is impossible is bounded below by

                            Z                                              n−2
                                                           1
                    p ≥ 1 −    1−                                                  ϕy (y) .              (24)
                                     R             2π (1 + max(0, y))


4.2    Linear-Factor Models and Impossibility
Although the generality of Haar measure in representing the selection of an arbitrary covari-
ance matrix is compelling, some may consider it too general because it does not differentiate
among outcomes according to their economic plausibility. In particular, Haar measure places

                                                      13
the same probabilistic weight on covariance matrices arising from quantum mechanics as it
does on covariance matrices from economic models—there is nothing intrinsic to Haar mea-
sure in which economic structure is incorporated. Accordingly, one could argue that Haar
measure places too much weight on financially irrelevant covariance matrices. This argument
is debatable, not in the least because we do not usually develop economic theories to yield
specific implications for covariance matrices, hence it is not clear what “financially relevant”
covariance matrices look like.
   However, there does exist an important class of financial models that places restrictions
on asset-return covariance matrices, and that is the set of linear factor models such as the
CAPM and APT. If a linear factor-pricing model holds, then a typical covariance matrix
drawn randomly from this economy will have a different distribution than Haar measure.
   In this section, we introduce a class of probability distributions based upon the covariance
matrix implied by linear factor models such as the CAPM and APT, and we calculate
probabilities of impossibility with respect to distributions in the class. The construction
of this class uses many of the techniques and notations developed in connection with our
analysis of Haar measure in Section 4.1, so our exposition will be less detailed.
    We start with T0 = T0 (µ, µm , σm , rf ), the covariance matrix implied by a linear one-
factor model for a chosen value of the expected return vector µ and for arbitrarily specified
values of the expected return on the market, µm , the market volatility, σm , and the riskfree
rate, rf , assuming for the moment that there are no idiosyncratic components to asset
returns. The matrix T0 can be written

                                              2
                                        T0 = σm ββ t


where β is the vector of “beta” values, β = (µ − ιrf )/(µm − rf ) (recall that we have assumed
no idiosyncratic shocks for the moment).
   To incorporate independent idiosyncratic risks, non-negative amounts can be added to
diagonal elements of T0 , and the elements of the matrix may be additionally adjusted to
reflect deviations from the CAPM. We define a family of such matrices,

                                          
          T   = T (µ, µm , σm , rf ) =          2
                                           T = σm ββ t + δIn + ειιt : ε ≥ 0, δi ≥ 0


and we define the subfamily T2 to be those matrices in T with δ1 = 0, δ2 = 0, and δi > 0 for
3 ≤ i ≤ n.
   For any T ∈ T2 , we can write T = AAt , where A = A(c1 , . . . , cn ) is defined in (19), with

                                               14
                                        1/2
c1 = ε1/2 , c2 = σm /µm , and ci = δi , for 3 ≤ i ≤ n. We write covariance matrices Σ in the
form Σ = AMAt for some M ∈ Pn , and we consider probability distributions on Σ defined
in terms of probability distributions on M. Since every Σ corresponds to a unique M under
this relationship, every probability distribution for Σ can be realized in this way. Also, when
M = In , we have Σ = T, and so distributions for Σ are “centered” on the CAPM-based
matrix T to the same extent the distributions for M are centered on In . We can now define
a broad class of probability distributions for Σ and “centered” on CAPM-based matrices
T ∈ T2 .

Definition 3 For c > 0, a distribution ϕ on Σ ∈ Pn is in the class D(T2 ; c) if the corre-
sponding distribution ϕM on M ∈ Pn can be factored into a product of distributions

                                n−2
                                             !       n−2
                                                                  !
                                Y                    Y
                     ϕ =              ϕr i       ×         ϕ θi       × ϕy × ϕu × ϕv × ϕV         (25)
                                i=1                  i=1


                                                                                                 2
where the ϕθi are uniform probability densities on S 1 , where ϕy is bounded above by c e−y for
y ≥ 0, and where the other distributions are arbitrary distributions on the respective spaces
ri ∈ R+ , u ∈ R+ , v ∈ R+ , and V ∈ Pn−2 . Here we use the notation of Definition 2 for the
coordinates for M, and we use the correspondence Σ = AMAt for the relationship between
Σ and M.

   We now turn to the central result of this section: a lower bound for the probability of
impossibility which is uniform across all distributions in the class D(T2 ; c).

Theorem 2 For any given expected-return vector µ, expected return on the market µm ,
market volatility σm , and riskfree rate rf , let ϕ be a probability distribution in D(T2 ; c) =
D (T2 (µ, µm , σm , rf ); c), for a specified c > 0. With respect to this distribution, the probability
that a random choice of Σ gives rise to an efficient frontier that is impossible is bounded
below by:

                                 n−2                 2/3 !
                                 6                  n−2
                     PI   ≥ 1 −        − 4c exp −              .                                  (26)
                                 7                   3π


This lower bound holds uniformly across all ϕ ∈ D(T2 ; c), as well as across all choices of
µ, µm , σm , and rf . As n increases without bound, the probability that a generically chosen
frontier is impossible tends to unity.

                                                       15
The remarkable generality of Theorem 2 raises the question of how tight the lower bound
can be, especially given the fact that we have placed no restrictions on the expected-return
vector µ. Table 1 shows that even for the 50-asset case—a relatively small number of assets
for most financial applications—the likelihood of an impossible frontier is nearly certain.

                                         n     Lower Bound

                                         25       0.9059
                                         50       0.9787
                                         75       0.9920
                                        100       0.9966


Table 1: Lower bound for the probability that a randomly chosen n-asset covariance matrix
yields an impossible frontier under any measure ϕ ∈ D(T2 ; 0.1) over the space of all n×n
symmetric positive-definite covariance matrices with real elements.

   It should come as no surprise that Theorem 2 can easily be extended to the case where
returns satisfy any linear k-factor model, k ≪ n. In this case, the factor (n−2) in (26) is
replaced by (n−k −2) and some of the constants are slightly different, but the asymptotic
implications of the bound are identical. As n increases without bound, the probability of an
impossible frontier approaches unity.


4.3    Additional Impossibility Results
In this section we derive several additional results about impossible frontiers. We determine
the expected number of assets with respect to which a generic frontier will be impossible,
and derive a lower bound for the expected sizes of short positions across a generic frontier.
We also generalize Theorem 2 to the case in which a constraint is placed on the total size of
short positions at each point on the frontier.

Theorem 3 For any given expected-return vector µ, expected return on the market µm ,
market volatility σm , and riskfree rate rf , let ϕ be an arbitrary probability distribution in
D(T2 ; c) = D (T2 (µ, µm , σm , rf ); c). With respect to this probability distribution, the expected
number of assets with respect to which the frontier corresponding to a random choice of Σ
gives rise to an efficient frontier that is impossible is bounded below by:


                                       En     ≥ c′ (n − 2) ,                                    (27)


                                                 16
for a positive constant c′ defined as

                                           Z                         
                                  ′                        1
                              c       ≡                                 ϕy (y)                 (28)
                                           R       2π (1 + max(0, y))

which depends only on the factor ϕy of the probability distribution ϕ. If ϕy is a normal
distribution with unit variance, a numerical lower bound for En is (n−2)/8.

This result follows from an estimate of the integral defining the expected value (see the
Appendix), and shows that the number of assets requiring short positions on a typical frontier
grows linearly with the number of assets.
     We can also determine lower bounds for the aggregate size of the short positions among
efficient-frontier portfolios. The following definition makes this notion precise:

Definition 4 For 1 ≤ i ≤ n, let Si denote the infimum of the short position in the i-th asset,
measured as a fraction of the portfolio’s net asset value, where the infimum is taken over all
points on a given efficient frontier. Let S denote the infimum of the aggregate amount of
shortselling, where the infimum is also taken over all portfolios on a given efficient frontier.

With this definition, we are able to derive a lower bound on the magnitude of shorting among
efficient-frontier portfolios:

Theorem 4 For any given expected-return vector µ, expected return on the market µm ,
market volatility σm , and riskfree rate rf , let ϕ be an arbitrary probability distribution in
D(T2 ; c) = D (T2 (µ, µm , σm , rf ) ; c). With respect to ϕ, for 3 ≤ i ≤ n, the expected value of
Si satisfies


                                                   E[Si ] ≥ ci                                 (29)


where

                                           Z      ∞                 Z   0               
                                       1
                         ci      ≡                     ri−2 ϕri−2              (1 − y)ϕy       (30)
                                      2π       0                       −∞



and ϕri−2 and ϕy are as in Definition 3. Note that if all the functions ϕri−2 are identical, so
that all the ci have a common value c∗ , then the expected value of S has the following lower



                                                           17
bound:


                                    E[S] ≥ c∗ (n − 2) .                                   (31)


   Finally, we consider the effect of imposing shortsales constraints by first defining the
concept of a constrained efficient frontier:

Definition 5 For b ≥ 0, a constrained efficient frontier Fb is the set of portfolio weight
vectors that provide maximum returns for given levels of volatility, subject to the condition
that the total size of the short positions in such weight vectors be no more than a fraction b
of the portfolio’s net asset value. Such a constrained frontier Fb is an impossible frontier if
every point on Fb has a negative weight for at least one asset.

Remarkably, imposing shortsales constraints does not decrease the probability that a frontier
is impossible, as the next result shows:

Theorem 5 Let F be an unconstrained efficient frontier and let Fb be the corresponding
constrained efficient frontier for some b > 0. If F is an impossible frontier, then Fb is an
impossible frontier as well. Thus, the probability that a constrained efficient frontier, with
b > 0, is impossible is at least as large as the probability that an unconstrained efficient
frontier is impossible.


5    The One-Factor Model
Given the overwhelming importance of the CAPM to financial theory and practice, we con-
sider the special case of the linear one-factor model that underlies the CAPM. In particular,
let the (n×1)-vector of returns of n assets be given by the following linear one-factor model:


                               r = ι rf + β(rm − rf ) + ǫ                                 (32)


where rm is the stochastic market return, β is an (n×1) constant vector, and ǫ is an (n×1)
stochastic vector of idiosyncratic shocks. We assume that the expected value of ǫ is zero,
and we write Ω for its covariance matrix.
   Let µm and σm denote the expected return and standard deviation of rm , respectively.
According to the CAPM relation (32), the mean vector and covariance matrix for asset



                                              18
returns, µ and Σ, can be written in terms of µm , σm , β, rf , and Ω as


                   µ = ι rf + β(µm − rf ) and Σ = ββ t σm
                                                        2
                                                          + Ω.                                     (33)


The tangency portfolio implied by the CAPM is ω µ, defined in (4) as ω µ ≡ Σ−1 µ/B. And
under the assumption that Ω is diagonal and µ contains all positive elements, it can be shown
that the tangency portfolio is, in fact, not impossible, i.e., it contains no negative weights
and may, therefore, be consistent with capital market equilibrium in which the weights are
proportional to the market capitalizations of the securities. In this section, we explore the
impossibility of the tangency portfolio for more general residual covariance matrices Ω and
with no constraints on µ, and find that as before, impossibility is the rule, not the exception
as n increases without bound.
   In Section 5.1, we introduce the techniques needed to characterize impossible tangency
portfolios, and in Section 5.2 we derive a lower bound on the probability that a randomly
selected tangency portfolio is impossible. In Section 5.3, we show how to construct the unique
covariance matrix that is consistent with a given vector of means µ, the riskfree rate rf , a
set of market-capitalization weights ω m , and CAPM equilibrium (i.e., where those market
weights correspond to those of the tangency portfolio), and which is as “close” as possible
to a given covariance matrix Σ. In other words, we derive the covariance matrix that is as
close as possible to Σ but which is consistent with the CAPM.


5.1     Characterizing Impossible Tangency Portfolios
As in Section 4, the key to characterizing impossible tangency portfolios is the choice of
coordinates in which to express the covariance matrix, which will allow us to focus on the
portion of the matrix that is relevant for impossibility. Any covariance matrix Σ can be
written in the form Σ = AMAt , where M is a positive-definite symmetric matrix, and
where A is the unique matrix that takes e1 to µ and ei to ei for 2 ≤ i ≤ n.3 Also, as we
showed in Section 4.1, M can be expressed in terms of partial Iwasawa coordinates as

                                     !"             !#                            !
                              w 0          1  0                 w + xt Vx xt V
                  M =                                     =                                        (34)
                              0 V          x In−1                  Vx      V
  3
   Note that the definitions of A and M are slightly different here than in Section 4.1, but we keep the
same notation because these matrices play the same role as before.




                                                  19
where w ∈ R+ , x ∈ Rn−1, and V is a covariance matrix of dimension (n−1)×(n−1). Here
we have used the notation G[H] for Ht GH.
   In these coordinates, the portfolio ω µ can be expressed simply as

                            
                            (1 + µ x + · · · + µ x )/d for i = 1,
                                   2 1           n n−1
                  ω µ,i   =                                                               (35)
                            −µ x /d                    for 2 ≤ i ≤ n.
                                1 i−1


                      d ≡ 1 + (µ2 − µ1 )x1 + · · · + (µn − µ1 )xn−1 .


Therefore, ω µ is completely determined by x and µ. This allows us to characterize the
impossibility of the tangency portfolio via the following proposition:

Proposition 3 The tangency portfolio, ω µ, implied by the CAPM is impossible if and only
if any one of the following three conditions holds: (i) two elements of x have different signs;
(ii) all elements of x have the same sign as µ1 /d; or (iii) the quantity (1 + µ2 x1 + · · · +
µn xn−1 )/d is negative, where d ≡ 1 + (µ2 − µ1 )x1 + · · · + (µn − µ1 )xn−1 .

We will make the most use out of the first condition for impossibility in Proposition 3, since
it describes the bulk of the cases in which the tangency portfolio is impossible.


5.2    The Probability of Impossible Tangency Portfolios
To determine the probability that the CAPM tangency portfolio is impossible, we need to
choose a probability distribution on the underlying variables β, µm , σm , rf , and Ω. Once
these variables are determined, µ and Σ are determined as well, and Proposition 3 will allow
us to assess the impossibility of the corresponding tangency portfolio.
    For our probability distribution, we allow β, µm , σm , and rf to be specified arbitrarily—
our results will hold uniformly across any choice of these variables. With respect to Ω, we
decompose the matrix into components and allow all but one of those components to be
specified arbitrarily. Specifically, we write Ω as

                                   !"        !#                    !
                             Ω11 0    1 γt      Ω11     Ω11 γ t
                   Ω =                                                                    (36)
                              0 Ωe    0 In−1          e + Ω11 γγ t
                                                Ω11 γ Ω


                 e is an (n−1)×(n−1) positive-definite matrix, and Ω11 > 0. The values of Ω
where γ ∈ Rn−1 , Ω                                                                        e
and Ω11 can be specified arbitrarily. With respect to γ, we impose a probability distribution

                                                20
ϕγ (γ) on Rn−1 , and in our probability calculations we consider several possible choices of
ϕγ . Thus, for our probability distribution on the underlying variables, we allow completely
arbitrary specification of all terms except γ, and with respect to γ we focus on a number of
different choices of probability distributions on Rn−1 .
    The characterization of impossibility in Proposition 3 relies on an expression of Σ =
AMAt in terms of coordinates x, w and V for M. Our probability distribution, however,
                                                                           e σm , and β.
is expressed in terms of another set of coordinates for Σ, namely γ, Ω11 , Ω,
Thus, we need to calculate the relationship between these choices of coordinates to apply
the characterization of impossibility to draws from our distribution. The relationship of
primary importance will be the expression of x in terms of the coordinates for the probability
distribution, so we now turn to this calculation.
    Multiplying on the right by (At )−1 and on the left by A−1 in the expression for Σ in
(33), and using the definition of A, we see that

                                                                                  !
                                                        Ω11 /µ21   (Ω11 /µ1 )zt
                    M = e1 et1 (σm /µm )2 +
                                                                   e + Ω11 zzt
                                                       (Ω11 /µ1 )z Ω
                                                                        !
                               Ω11 /µ21 + (σm /µm )2     (Ω11 /µ1 )zt
                         =                                                                      (37)
                                     (Ω11 /µ1)z          e + Ω11 zzt
                                                         Ω


                           e = (µ2 , . . . , µn )t . In light of the expression for M in (34), we see
              e /µ1 , with µ
where z = γ − µ
that

                                                            −1
                       x = V−1(Vx) = (Ω11 /µ1 ) Ωe + Ω11 zzt     z.                             (38)


Since µ = ιrf +β(µm −rf ), and since z is determined by µ and γ, we see that (38) expresses x
in terms of the coordinates for our probability distribution, as desired. After some algebraic
manipulation, we can also write this expression for x as

                                                                  
                                              Ω11 /µ1              e −1
                              x =                            2Ω           .                   (39)
                                                  e −1/2 z
                                          1 + Ω11 Ω


This is a more useful formula for x since we are primarily interested in the signs of the
elements of x and this expression shows these are the same as the signs of the elements of


                                                  21
e −1 z/µ1 , since the remaining multiplicative factor is always positive.
Ω

Theorem 6 Let p be the probability that the tangency portfolio implied by the CAPM is
impossible when the probability distribution on the term γ underlying the covariance matrix
Ω has a distribution given by ϕγ . A lower bound for p is

                                Z                                
                                e
                        p ≥ det Ω                          e   e
                                                  F (γ)ϕγ Ωγ + µ/µ1                      (40)
                                           Rn−1


where F is equal to 1 whenever γ has two elements with different signs and equal to 0
otherwise.

We now make the result more concrete by applying the theorem to a specific choices for the
distribution ϕγ .

Corollary 3 If ϕγ has an (n−1)-dimensional multivariate normal distribution with mean
                             e 2 , for some s > 0, then the probability that ω µ is impossible
e /µ1 and covariance matrix sΩ
µ
satisfies


                                      p ≥ 1 − 22−n                                       (41)


and this result is independent of the choice of s.

Note that choices of ϕγ not centered at µ  e /µ1 will generally have a lower probability of
impossibility. However, for choices of ϕγ that are close to the uniform distribution, choices
with large variance, for example, the probability of impossibility will have a lower bound
similar to that in the corollary.


5.3    A Non-Impossible Covariance Matrix
Given the simple structure of the linear one-factor model (32), it should be possible to find
some covariance matrix Σe “close” to Σ in some sense that yields a non-impossible tangency
portfolio, i.e., a tangency portfolio that has strictly positive market-capitalization weights
ω m , and is consistent with µ, β, and rf . Using the techniques developed in Section 5.1,
we construct such a “non-impossible” covariance matrix in this section and show how it is
related to Black and Litterman’s (1992) approach to asset allocation with prior information.
   Suppose that a mean return vector, µ, and a market-capitalization weight vector, ω m
are given, and consider a covariance matrix, Σ, that is derived either empirically or from

                                               22
prior information, but which is not necessarily compatible with µ and Σ in the sense that
ω m 6= Σ−1 µ, as required by the CAPM. The matrix most compatible with the observed Σ
but still conforming to the known values of µ and ω m can be determined in the following
manner. Write Σ = AMAt and write M in terms of w, x, and V, as in (34). Replace x by
e, where x
x        e is defined by

                                              −ω m,i+1
                     x̃i =                                                              (42)
                             µ1 + (µ2 − µ1 )ω m,2 + · · · + (µn − µ1 )ω m,n

for 1 ≤ i ≤ n−1. The formula in (42) inverts the relationship between ω m and x from (35),
                e is the unique value compatible with the market weight vector ω m and the
so the value of x
expected return vector µ.
   The change from x to x  e described in the last paragraph corresponds to a change in the
overall covariance matrix. Replace Σ by Σ e where

                                                                       !
                     e ≡ AMA
                          f t , M
                                f ≡                    et Ve
                                                     w+x     et V
                                                           x x
                     Σ                                                     .            (43)
                                                        Ve
                                                         x         V


This new covariance matrix, Σ,e is then compatible with ω m and µ in that ω m is the tangency
portfolio resulting from this mean and covariance. In addition, Σe is the covariance matrix
most compatible with the specified values of µ and ω m and the observed value of Σ in that it
requires precisely the amount of alteration to Σ needed to make the three sets of parameters
compatible.
   Therefore, for those who have strong conviction that the CAPM must hold and that µ
and ω m are, in fact, the correct expected returns and market weights, and Σ is their best
estimate of the covariance matrix, the covariance matrix they should adopt is Σe given in
(43).


6    Empirical Analysis
To gauge the empirical relevance of our impossibility results, we use daily and monthly
returns for stocks in the S&P 500 index to estimate portfolio parameters (µ, Σ) and show
that the realizations of impossible frontiers in the historical record are nontrivial.




                                              23
6.1                      The Data
The monthly data consists of returns for stocks listed on the S&P 500 in December of 1995 for
which monthly return data was available for the period from January 1980 through December
2005. The daily data consists of returns for stocks listed on the S&P 500 in December of
1995 for which daily return data was available for the period from January 1, 1995 through
December 31, 2005. There are a total of 271 stocks in the monthly data set and 326 stocks
in the daily data set.


6.2                      A 100-Stock Empirical Efficient Frontier
For concreteness, we construct the efficient frontier for the first 100 assets for both daily
and monthly returns using standard estimators for the means and covariance matrices. The
two frontiers are plotted in Figure 1, and we find that both are impossible. The blue lines
indicate the unconstrained frontiers, and the red lines indicate the frontiers constrained to
allow only 50% shortselling. Figure 2 shows the amount of shortselling for points on both of
these frontiers. Clearly the shortsales constraints do not eliminate the problem of impossible
frontiers, and have a significant impact on the characteristics of the constrained optimal
portfolio.

                                                   100 Asset Frontier                                                                                      100 Asset Frontier
                          0.25                                                                                                         4


                           0.2
                                                                                                                                       3
                                                            Unconstrained Frontier                                                                                Unconstrained Frontier
                          0.15
                                                            Frontier with At Most 50% Short Selling                                                               Frontier with At Most 50% Short Selling
                           0.1                                                                                                         2
                                                                                                                 Monthly Return (%)
      Daily Return (%)




                          0.05
                                                                                                                                       1
                            0


                         −0.05                                                                                                         0


                          −0.1
                                                                                                                                      −1
                         −0.15


                          −0.2                                                                                                        −2
                             0.5   1   1.5     2   2.5       3      3.5      4       4.5      5       5.5                                  2   4   6   8   10     12       14      16       18       20     22
                                                      Daily Risk (%)                                                                                        Monthly Risk (%)




                                             (a) Daily Returns                                                                                     (b) Monthly Returns

Figure 1: Unconstrained efficient frontier for 100 stocks in the S&P 500 index, as well as
the frontier constrained to allow no more than 50% shortselling, based on (a) daily returns
from January 1, 1996 to December 31, 2005; and (b) monthly returns from January 1980 to
December 2005.




                                                                                                            24
                                              Short Sales on 100 Asset Frontier                                                               Short Sales on 100 Asset Frontier
                       400                                                                                                     600
                                                                                                                                                       Unconstrained Frontier
                                                          Unconstrained Frontier
                       350                                                                                                                             Frontier with At Most 50% Short Selling
                                                          Frontier with At Most 50% Short Selling                              500

                       300

                                                                                                                               400
                       250
   Short Selling (%)




                                                                                                           Short Selling (%)
                       200                                                                                                     300


                       150
                                                                                                                               200

                       100

                                                                                                                               100
                        50


                         0                                                                                                      0
                        −0.2   −0.15   −0.1   −0.05     0        0.05     0.1      0.15      0.2    0.25                        −2   −1        0            1              2             3       4
                                                      Daily Return (%)                                                                              Monthly Return (%)




                                         (a) Daily Returns                                                                                (b) Monthly Returns

Figure 2: Magnitude of short positions for points on the unconstrained efficient frontier for
100 stocks in the S&P 500 index, as well as the frontier constrained to allow no more than
50% shortselling, based on (a) daily returns from January 1, 1996 to December 31, 2005;
and (b) monthly returns from January 1980 to December 2005.

6.3                            More Impossible Frontiers
Applying the usual sample mean and covariance-matrix estimators to daily and monthly
                                   b and construct efficient frontiers for each of 2 through
returns, we compute estimates (µ̂, Σ)
326 assets for daily returns, and 2 through 271 assets for monthly returns. Figure 3 shows the
fraction of assets with respect to which each frontier is impossible. Figure 4 shows the size of
the short positions in the portfolios ω g and ω µ for each of these frontiers. These results show
that negative holdings are the rule rather than the exception for empirical efficient frontiers,
and non-negativity constraints are likely to have a major impact on the characteristics of
mean-variance-optimized portfolios.


6.4                            Estimation Error
One possible critique of our empirical analysis is that estimation error is likely to yield
sample means and covariances that are inconsistent with the CAPM, so it is not surprising
that we find impossible frontiers in the data. But this observation only underscores the
ubiquity of impossible frontiers in practice. Since the population means and covariance
matrix must always be estimated in financial applications, estimation error is an unavoidable
aspect of practical portfolio management. While a number of authors have explored the
impact of estimation error on portfolio optimization,4 and alternatives such as Bayesian
  4
    See, for example, Brown (1976), Bawa, Brown, and Klein (1979), Frost and Savarino (1986), Jorion
(1986), Tu and Zhou (2004, 2007, 2008), Wang (2005), DeMiguel, Garlappi, and Uppal (2007), Garlappi,


                                                                                                           25
                                                                                 25                                                                                                                                                         40
                       Fraction of Assets for which Frontier Is Impossible (%)




                                                                                                                                                                                  Fraction of Assets for which Frontier Is Impossible (%)
                                                                                                                                                                                                                                            35

                                                                                 20
                                                                                                                                                                                                                                            30


                                                                                                                                                                                                                                            25
                                                                                 15

                                                                                                                                                                                                                                            20


                                                                                 10
                                                                                                                                                                                                                                            15


                                                                                                                                                                                                                                            10
                                                                                  5

                                                                                                                                                                                                                                             5


                                                                                  0                                                                                                                                                          0
                                                                                      0   50        100    150        200    250   300   350                                                                                                     0   50             100        150           200   250   300
                                                                                                          Number of Assets                                                                                                                                                Number of Assets




                                                                                                   (a) Daily Returns                                                                                                                                      (b) Monthly Returns

Figure 3: The fraction of assets with respect to which the empirical frontiers are impossible,
as a function of the number of assets underlying the frontiers, based on a subset of S&P 500
stocks using (a) daily returns from January 1, 1996 to December 31, 2005, with the number
of stocks n ranging from 2 to 326; and (b) monthly returns from January 1980 to December
2005, with the number of stocks n ranging from 2 to 271.




                                                                         450                                                                                                                       1200

                                                                                                                                                                                                                                                     ω Portfolio
                                                                         400              ωm Portfolio                                                                                                                                                m

                                                                                                                                                                                                                                                     ωµ Portfolio
                                                                                          ω Portfolio                                                                                              1000
                                                                                               µ
                                                                         350
       Amount of Short Selling (%)




                                                                                                                                                    Amount of Short Selling (%)




                                                                         300                                                                                                                                                        800


                                                                         250
                                                                                                                                                                                                                                    600
                                                                         200


                                                                         150                                                                                                                                                        400


                                                                         100
                                                                                                                                                                                                                                    200
                                                                                 50


                                                                                  0                                                                                                                                                          0
                                                                                      0   50        100    150        200    250   300   350                                                                                                     0   50             100        150           200   250   300
                                                                                                          Number of Assets                                                                                                                                                Number of Assets




                                                                                                   (a) Daily Returns                                                                                                                                      (b) Monthly Returns

Figure 4: Magnitude of short positions in the portfolios ω g and ω µ for the empirical frontiers,
based on a subset of S&P 500 stocks using (a) daily returns from January 1, 1996 to December
31, 2005, with the number of stocks n ranging from 2 to 326; and (b) monthly returns from
January 1980 to December 2005, with the number of stocks n ranging from 2 to 271.




                                                                                                                                               26
inference (Brown, 1976), robust portfolio optimization (Fabozzi et al., 2007), and resampling
(Michaud, 1998) have been developed in response, none of these methods addresses the
impossibility of the population mean-variance efficient frontier.
   In particular, Theorems 1 and 2 show that impossible frontiers are almost certain to occur
even in the absence of estimation error. To the extent that estimation error can be viewed
as random perturbations of population parameters (as opposed to perturbations that yield
parameters closer to those satisfying a CAPM/APT relation), it is even more likely that
estimated means and covariances will yield impossible frontiers. In other words, if a frontier
is impossible for a set of population parameters, adding random noise to those parameters
is unlikely to yield frontiers that are consistent with the CAPM.


7     Conclusion
In this paper, we have shown that mean-variance efficient frontiers almost always contain
short positions, implying a fundamental inconsistency between efficiency and economic equi-
librium as described by the CAPM. This result is distinct from earlier concerns in the
literature regarding the mean-variance efficiency of the market portfolio. Those concerns
involved the observability of the total market portfolio, the existence of non-traded assets
such as human capital, estimation errors in the sample means and covariance matrix, non-
stationarities, asymmetric information, and other capital-market imperfections. Even in a
frictionless world where all parameters are fixed and known, and where all of the other
perfect-markets assumptions of the CAPM hold, mean-variance efficient frontiers are almost
always impossible.
    This surprisingly general result provides a potential explanation for the near universal
disdain with which long-only portfolio managers regard standard mean-variance optimiza-
tion techniques. These investment professionals—who comprise the majority of end-users of
commercial portfolio construction software such as the BARRA Optimizer and the North-
field Portfolio Optimizer—have railed against mindless optimization for years, arguing that
portfolio weights obtained in this manner are ill-behaved and must be constrained or other-
wise post-processed. However, the typical rationale for these complaints is that the weights
of frontier portfolios are too unstable and too sensitive to estimation error to be of practical
value. We have identified a distinctly different rationale, which is the ubiquity of short po-
sitions in frontier portfolios even in the absence of estimation error. An impossible frontier
is, in fact, literally impossible for the long-only portfolio manager. The surging popular-
Uppal, and Wang (2007), and Kan and Zhou (2007).



                                               27
ity of 130/30 strategies among such managers and their investors may well be a practical
manifestation and an unintended consequence of the impossibility of mean-variance-optimal
portfolios.
   The virtual certainty of impossible frontiers also has implications for the interpretation of
economic equilibrium. The converse of our impossibility theorem is that the set of parameters
(µ, Σ) that are “possible”, i.e., that are consistent with the mean-variance efficiency of the
market portfolio—is a vanishingly small set as the number of assets grows without bound.
In particular, in a CAPM equilibrium, covariances are also endogenously determined via
supply and demand, despite the fact that most asset-pricing models focus exclusively on the
properties of expected returns in equilibrium. Is it any wonder that the set of n means and
n(n+1)/2 covariances that is consistent with capital-market equilibrium is apparently quite
sparse?
   To the disciples of general equilibrium theory, this may be heretical, but from a broader
and more practical perspective, it should not be too surprising that the likelihood of si-
multaneous equality of supply and demand across a large number of markets is small, and
increasingly less likely as the number of assets grows. With the techniques developed in this
paper, we hope to be able to deduce other generic properties of financial market equilibria
and their practical implications.




                                              28
A     Appendix
In this Appendix, we provide proofs for the main results of the paper.


A.1     Proof of Proposition 1
When there are only n = 2 assets, we may write the set of points on the frontier simply as

                                 h                        it                  
                                                                           B
                       F = ω : ω = µµ2o −µ
                                        −µ1       µ2 −µo
                                                  µ2 −µ1
                                                                , for µo ≥         .
                                          1                                C

Thus, for all expected returns µo with µ1 < µo < µ2 , points on the frontier have positive
weight in both components, but for all values of µo outside this range, every point on the
frontier has exactly one negative component. If the minimum value of µo , namely µo = B/C,
is less than µ2 , then at least some point on the frontier has all positive weights, but if this
value of µo is greater than µ2 , then all points on the frontier have at least one negative
weight.
    The condition that B/C < µ2 is the same as the condition that


                               µ1 (et1 Σ−1 ι) + µ2 (et2 Σ−1 ι)
                                                               < µ2 .
                                  (et1 Σ−1 ι) + (et2 Σ−1 ι)

The denominator on the left-hand side is non-negative, according to the Cauchy-Schwarz
inequality, and so we may cross-multiply and collect terms to see that the inequality holds
exactly when et1 Σ−1 ι > 0. This, in turn, is the same as the inequality ρ < σ2 /σ1 , and so we
see that a frontier will be impossible just when σ2 /σ1 < ρ ≤ 1 and µ1 < µ2 , which is the
assertion of Proposition 1.


A.2     Proof of Proposition 2
We calculate Σ−1 and reorganize terms to yield:

                                                                    
                                          (1 − a + b − c)(1 − b)
                            Σ−1 ι                           t −1
                    ωg =    t −1 =  (1 − a − b + c)(1 − c)  /(ι Σ ι) .                  (A.1)
                           ιΣ ι
                                    (1 + a − b − c)(1 − a)


Since the denominator is non-negative, by the Cauchy-Schwarz inequality, the proposition
follows.




                                                 29
A.3     Proof of Corollary 1
The proof of the corollary is obtained by using the formula for ω g in (A.1) and simply
plugging in the stated values of a, b, and c. This calculation shows that the shortsale
amount in the second asset is

                             et2 Σ−1 ι   −2ε + 4ε2 − ε3    1
                                  −1   =      2    3
                                                        = − + O(1) .
                               t
                             ιΣ ι          4ε − ε          2ε


A.4     Proof of Lemma 1
The first inequality in (20) states that the i-th component of ω g is negative, and the second
inequality states that the i-th component of ω P = Bω µ − Bω g is also negative. Together,
these inequalities imply that the i-th component of each portfolio on the entire efficient
frontier has a negative weight, since C and D are always positive, by the Cauchy-Schwartz
inequality, and since frontier portfolios have the form described in (5). This demonstrates
the sufficiency of the condition for impossibility in the i-th asset. The necessity also follows
readily, since a negative i-th component of each portfolio is only possible if there is a negative
i-th component in the minimum risk portfolio, ω g , as well as in the high risk portfolios which
tend toward a positive multiple of ω µ − ω g .
    To deduce the equivalence between the conditions in (20) and (21), we note that

                                              t
                                     Σ−1 = A−1 M−1 A−1 .

As in Definition 2, we can express M in terms of coordinates as (X, W, V), and we have

                         !                !                !                                !
               I2 0            W−1 0              I2 −Xt            W−1    −W−1 Xt
 M−1 =                                                         =                                .
              −X In−2           0  V−1            0 In−2           −XW−1 V−1 + XW−1Xt


From the definition of A = A(c1 , . . . , cn ) in (19), we see that


           A−1ι = e1 /c1 ,     A−1 µ = e2 /c2 ,    and A−1 ej = ej /cj , for 3 ≤ j ≤ n .

We write W = [wij ] so that

                                                                    !
                                           1             w22 −w12
                                W−1   =                                 .
                                        det(W)          −w12 w11




                                                   30
After some algebraic rearrangements, we see that the conditions in (20) are equivalent to

                       x1,(i−2) w22 − x2,(i−2) w12 > 0 and x(i−2),2 > 0                    (A.2)

where we have used the facts that det(W) > 0 and w22 > 0, since W is positive definite.
   With the notation from Definition 2, we write w22 = v, w12 = yv, x1,i−2 = ri−2 cos θi−2
and x2,i−2 = ri−2 sin θi−2 . Equation (A.2) can be rewritten in terms of these new coordinates
as

                         cos θi−2 − y sin θi−2 > 0 and          sin θi−2 > 0


since both ri−2 > 0 and v > 0, and this is the condition in (21).


A.5     Proof of Corollary 3
Substitution of the specified choice of ϕγ for into the result of Theorem 6 shows us that

                                        Z                              
                              1                          1
                      p≥                      F (γ) exp − γ t γ             dγ .
                         (2πs)(n−1)/2    Rn−1            2s


This integral is simply an expression for the fraction of the unit sphere in Rn−1 that does not
have either all negative or all positive coordinates, and this fraction is 1 − 22−n , as desired.


A.6     Proof of Theorem 1
From equation (21) of Lemma 1 we see that the probability, pi , that a frontier is impossible
with respect to the i-th coordinate, for i > 2, is just the probability that the conditions of
(21) are fulfilled when θi−2 is chosen from the uniform distribution on S 1 = [0, 2π]. The
conditions are satisfied exactly when θ ∈ (0, π) and y < cot θi−2 , and this corresponds to a
probability of impossibility

                                                1
                                        pi =      cot−1 y
                                               2π

where cot−1 denotes the branch of the inverse cotangent with values between 0 and π.
    Equation (21) of Lemma 1 also shows that, for a fixed value of y, impossibility in the
i-th coordinate is independent of impossibility in the j-th coordinate, for i, j > 2. Thus, the




                                                31
probability of impossibility in at least one of the coordinates i > 2 is bounded below as

                                                                          n−2
                                            1
                                 p ≥ 1− 1−    cot−1 y
                                           2π

and this implies the first inequality of the theorem. The second inequality follows directly,
                                    1
since the inequality cot−1 y ≥ 1+max(0,y) holds for all y.


A.7     Proof of Theorem 2
From Corollary 2, we see that the probability in the theorem is bounded below as

                  Z                         n−2
                                  1
        PI   ≥ 1−     1−                          ϕy (y)
                   R      2π (1 + max(0, y))
                  Z 0        n−2             Z ∞                n−2
                            1                                1             2
             ≥ 1−       1−          ϕy (y) − c     1−                   e−y dy .
                   −∞      2π                   0        2π(1 + y)


The first integral in the last line is bounded above by (1 − 1/(2π))n−2 . The second integral
is bounded above by the sum

                  Z 2      n−2          Z ∞       n−2
                          1       −y 2            1          2
                c     1−         e dy + c     1−          e−y dy .
                   0     6π                2     3πy


The first integral in this sum is bounded above by c(1 − 1/(6π))n−2, and the second integral
                             n−2 2/3
                                                                                      n−2
is bounded above by 2ce−( 3π ) . This last bound follows from the fact that 1 − 1                   3πy
                          n−2 2/3                               
is bounded above by e−(    3π)      for 0 ≤ y ≤              n−2 1/3
                                                              3π
                                                                       , as well as the fact that

                                 Z      ∞
                                                                        n−2 2/3
                                                      e−y dy < e−(         )
                                                         2

                                                  1/3
                                                                         3π       .
                                    (   n−2
                                         3π   )

Combining these results, we see that the probability is bounded below by

                          n−2     n−2                 2/3 !
                          6         19                 n−2
               PI   ≥ 1−        −c        − 2c exp −
                          7         20                  3π




                                                             32
where we have made use of the fact that 6/7 > 1−1/(2π) and the fact that 19/20 > 1−1/(6π).
Finally, numerical calculations show that

                            (19/20)n−2 ≤ 2 exp(−((n − 2)/(3π))2/3 )

for small n, and this relationship continues to hold asymptotically. Thus, we can bound PI
below as

                                  n−2                 2/3 !
                                  6                  n−2
                       PI   ≥ 1−        − 4c exp −
                                  7                   3π


A.8     Proof of Theorem 3
The expected number of assets with respect to which an efficient frontier is impossible satisfies

                                 Z    n
                                                                 !
                                      X             1
                         En ≥                                        ϕy (y) .
                                  R   i=3
                                            2π (1 + max(0, y))


This follows from the proof of Theorem 1, which shows that the i-th summand in the inte-
grand is a lower bound for the probability that a covariance matrix gives rise to an impossible
frontier for a fixed value of y. We thus see that

                                        Z                       
                                                      1
                        En ≥ (n − 2)                               ϕy (y)
                                         R    2π (1 + max(0, y))

and this last integral is the constant c′ from the statement of the theorem. Also, in the
case in which ϕy (y) is a normal distribution with unit variance, we see from a numerical
computation that

                                                  n−2
                                         En ≥
                                                   8

and this is the final claim of the theorem.


A.9     Proof of Theorem 4
If a frontier meets the necessary and sufficient conditions of Lemma 1 for the i-th coordinate,
for 3 ≤ i ≤ n, then it is an impossible frontier with respect to the i-th asset. In this case,
the i-th components of both ω g and ω P are negative, and so the total amount of shortselling
in the i-th asset throughout the frontier is bounded below by the amount of shortselling in

                                                33
the i-th asset for the minimum-variance portfolio. Thus we see that

                                                      eti Σ−1 ι
              Si (Σ) ≥ −eti ω g = −                             = − (−ri−2 cos θi−2 + yri−2 sin θi−2 )
                                                      ιt Σ−1 ι

where we have used the change of coordinates Σ = AMAt and the coordinates for M
from Definition 2 to establish the final equality. We thus see that, the expected amount of
shortselling with respect to the i-th asset satisfies

                  Z       ∞   Z   π   Z   cot θi−2                                                       
                                                                                           dθi−2
       E[Si ] ≥                                       (ri−2 cos θi−2 − yri−2 sin θi−2 ) ϕy                    ϕri−2       (A.3)
                      0        0           −∞                                               2π

where we have used the result from Lemma 1 that a frontier is impossible with respect to
the i-th asset exactly when θi−2 ∈ (0, π) and y < cot θi−2 . We have also used the notation
ϕy and ϕri−2 from Definition 3.
   Since the integrand in (A.3) is positive throughout the region of integration, we can find
a smaller lower bound by restricting the size of the region of integration. We calculate

                          Z                           Z              Z                                              !
                                   ∞                             π/2       0
                                                                                                              dθi−2
           E[Si ] ≥                    ri−2 ϕri−2                               (cos θi−2 − y sin θi−2 ) ϕy
                               0                             0             −∞                                  2π
                               Z          ∞                 Z       0               
                         1
                      =                        ri−2 ϕri−2                  (1 − y)ϕy       .
                        2π             0                           −∞



This is the lower bound in the theorem for E[Si ]. The lower bound for E[S] follows immei-
dately if the ϕri−2 are identical for 3 ≤ i ≤ n.


A.10     Proof of Theorem 5
Let F0 be the frontier constrained to allow no shortselling that corresponds to F and Fb . Let
σ0 be the risk of the minimum risk portfolio on F0 , and let µ0 be the expected return of the
maximum expected return portfolio on F0 . Each portfolio on Fb with a lower risk than σ0
must involve shortselling, since σ0 is the minimum possible risk without shortselling. Simi-
larly, each portfolio on Fb with a higher expected return than µ0 must involve shortselling,
since µ0 is the maximum possible expected return without shortselling. Thus, we need only
show that each portfolio on Fb with a risk greater than or equal to σ0 and an expected return
less than or equal to µ0 must involve shortselling.
    Let ω b be a portfolio on Fb with risk and expected return, σb and µb , respectively, such
that σb ≥ σ0 and µb ≤ µ0 . There are weight vectors ω 0 and ω U on F0 and F , respectively,
with the same expected return as ω. For 0 ≤ λ ≤ 1, write

                                                      ω λ = (1 − λ)ω 0 + λω U

                                                                       34
so that each ω λ also has the same expected return µb . Let σλ denote the risk of ω λ . Note
that σλ is a decreasing function of λ, for 0 ≤ λ ≤ 1, since σλ2 is a quadratic function of λ,
and since λ = 1 corresponds to the minimum risk portfolio for the level of expected return
µo . We assume here that F is impossible so that ω U involves shortselling and is therefore
distinct from ω 0 . We thus see that each ω λ with λ > 0 has lower risk than ω 0 but the same
level of return µb . Also, the amount of shortselling in ω λ is positive for all λ > 0 but goes
to zero as λ → 0. As a result, there is some λ∗ > 0 such that the amount of shortselling on
ω λ∗ is no more than b. The existence of this ω λ∗ implies that σb must be no greater than
ω λ∗ , and hence strictly less than the risk of ω 0 . Since the risk of ω b must be strictly less
than the risk of ω 0 , it follows that ω b must involve shortselling, as desired.


A.11      Proof of Theorem 6
From the condition for impossibility in Proposition 3 and from the expression for x in (39),
we see that the probability is bounded below by

                                                                                   
               Z                       Z
                                                               Ω11 /µ1          e −1 
          p≥           F (x)ϕγ (γ) =             F                           2  Ω z ϕγ (γ)
                Rn−1                   Rn−1                         e −1/2 z
                                                            1 + Ω11 Ω


              e /µ1 . Because F depends only on the signs of the elements of its argument,
where z = γ − µ
we have
                                           Z            −1 
                                  p≥                    e z ϕγ (γ)
                                                      F Ω
                                               Rn−1


and after a change of varialbes, we see that

                                   Z                                   
                                   e
                           p ≥ det Ω                            e   e /µ1
                                                       F (γ)ϕγ Ωγ + µ
                                                Rn−1


as desired.




                                                       35
                                    References

Anderson, T., 1984, An Introduction to Multivariate Statistical Analysis, 2nd Edition. New
   York: John Wiley & Sons.
Bawa, V., Brown, S. and R. Klein, 1979, Estimation Risk and Optimal Portfolio Choice.
   Amsterdam: North-Holland.
Best, M. and R. Grauer, 1990, “The Efficient Set Mathematics When Mean-Variance Prob-
    lems Are Subject to General Linear Constraints”, Journal of Economics and Business
    42, 105–120.
Black, F. and R. Litterman, 1992, “Global Portfolio Optimization”, Financial Analysts
    Journal 47, 28–43.
Brito, N., 1978, “Portfolio Selection in an Economy with Marketability and Short Sales
    Restrictions”, Journal of Finance 33, 589–601.
Brown, S., 1976, Optimal Portfolio Choice Under Uncertainty: A Bayesian Approach.
    Ph.D. dissertation, University of Chicago.
Box, G. and G. Tiao,, 1973, Bayesian Inference in Statistical Analysis. Reading, MA:
    Addison-Wesley.
DeMiguel, V., Garlappi, L. and R. Uppal, 2007, “Optimal Versus Naive Diversification: How
   Inefficient is the 1/N Portfolio Strategy?”, to appear in Review of Financial Studies.
Detemple, J. and M. Shashidhar, 1997, “Equilibrium Asset Prices and No-Arbitrage with
    Portfolio Constraints”, Review of Financial Studies 10, 1133–1174.
Diamond, D. and R. Verrecchia, 1987, “Constraints on Short-Selling and Asset Price Ad-
    justment to Private Information”, Journal of Financial Economics 18, 277–311.
Duffie, D., Garleanu, N., and L. Pedersen, 2002, “Securities Lending, Shorting, and Pric-
    ing”, Journal of Financial Economics 66, 307–339.
Dybvig, P., 1984, “Short Sales Restrictions and Kinks on the Mean Variance Frontier”,
   Journal of Finance 39, 239–244.
Fabozzi, F., Kolm, P., Pachamanova, D. and S. Focardi, 2007, Robust Portfolio Optimization
    and Management. New York: Wiley Finance.
Frost, P. and J. Savarino, 1986, “An Empirical Bayes Approach to Efficient Portfolio Se-
    lection”, Journal of Financial and Quantitative Analysis 21, 293–305.
Garlappi, L., Uppal, R. and T. Wang, 2007, “Portfolio Selection with Parameter and Model
    Uncertainty: A Multi-Prior Approach”, Review of Financial Studies 20, 41–81.
Halmos, P., 1974, Measure Theory. Heidelberg: Springer-Verlag.
Heaton, J. and D. Lucas, 1996, “Evaluating the Effects of Incomplete Markets on Risk
    Sharing and Asset Pricing”, Journal of Political Economy 104, 443–487.
Huang, C. and R. Litzenberger, 1988, Foundations for Financial Economics. New York:
   North-Holland.

                                           36
Jarrow, R., 1980, “Heterogeneous Expectations, Restrictions on Short Sales, and Equilib-
    rium Asset Prices”, Journal of Finance 35, 1105–1113.
Jeffreys, H., 1961, Theory of Probability, 3rd ed. Oxford, UK: Oxford University Press.
Jorgenson, J. and S. Lang, 2005, Posn (R) and Eisenstein Series. Berlin: Springer-Verlag.
Jorion, P., 1986, “Bayes-Stein Estimation For Portfolio Analysis”, Journal of Financial and
     Quantitative Analysis 21, 279–292.
Kan, R. and G. Zhou, 2007, “Optimal Portfolio Choice with Parameter Uncertainty”,
    Journal of Financial and Quantitative Analysis 42, 621–656.
Lintner, J., 1965, “The Valuation of Risk Assets and the Selection of Risky Investments in
    Stock Portfolios and Capital Budgets”, Review of Economics and Statistics 47, 13–37.
Markowitz, H., 1952, “Portfolio Selection”, Journal of Finance 7, 77–91.
Markowitz, H., 1959, Portfolio Selection. New Haven, CT: Cowles Foundation, Yale Uni-
   versity.
Markowitz, H., 1987, Mean-Variance Analysis in Portfolio Choice and Capital Markets.
   Oxford, UK: Basil Blackwell, Ltd.
Markowitz, H., 2005, “Market Efficiency: A Theoretical Distinction and So What?”, Fi-
   nancial Analysts Journal 60, 17–30.
Merton, R., 1972, “An Analytic Derivation of the Efficient Portfolio Frontier”, Journal of
    Financial and Quantitative Analysis 7, 1851–1872.
Michaud, R., 1998, Efficient Asset Management: A Practical Guide to Stock Portfolio
    Optimization and Asset Allocation. Boston, MA: Harvard Business School Press.
Pogue, G., 1970, “An Extension of the Markowitz Portfolio Selection Model to Include
    Variable Transactions’ Costs, Short Sales, Leverage Policies and Taxes”, Journal of
    Finance 25, 1005–1027.
Ross, S., 1976, “The Arbitrage Theory of Capital Asset Pricing”, Journal of Economic
    Theory 13, 341–360.
Sharpe, W., 1964, “Capital Asset Prices: A Theory of Market Equilibrium Under Condi-
    tions of Risk”, Journal of Finance 19, 425–442.
Sun, Wa. and C. Wang, 2006, “The Mean-Variance Investment Problem in a Constrained
    Financial Market”, Journal of Mathematical Economics42, 885–895.
Tobin, J., 1958, “Liquidity Preference As Behavior Towards Risk”, Review of Economic
    Studies 67, 65–86.
Tu, J. and G. Zhou, 2004, “Data-generating Process Uncertainty: What Difference Does It
    Make in Portfolio Decisions?”, Journal of Financial Economics 72, 385–421.
Tu, J. and G. Zhou, 2007, “Incorporating Economic Objectives into Bayesian Priors: Port-
    folio Choice Under Parameter Uncertainty”, unpublished working paper, Olin School
    of Business, Washington University.



                                           37
Tu, J. and G. Zhou, 2008, “Being Naive about Naive Diversification: Can Investment
    Theory Beat the 1/N Strategy?”, unpublished working paper, Olin School of Business,
    Washington University.
Wang, Z., 2005, “A Shrinkage Approach to Model Uncertainty and Asset Allocation”,
   Review of Financial Studies 18, 673–705.




                                         38
