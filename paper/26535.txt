                             NBER WORKING PAPER SERIES




                  RETHINKING PRODUCTION UNDER UNCERTAINTY

                                      John H. Cochrane

                                     Working Paper 26535
                             http://www.nber.org/papers/w26535


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                          December 2019, Revised April 2020




I thank the editors, John Campbell, Wayne Ferson, and especially Frederico Belo for helpful and
detailed comments. The views expressed herein are those of the author and do not necessarily
reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2019 by John H. Cochrane. All rights reserved. Short sections of text, not to exceed two
paragraphs, may be quoted without explicit permission provided that full credit, including ©
notice, is given to the source.
Rethinking Production Under Uncertainty
John H. Cochrane
NBER Working Paper No. 26535
December 2019, Revised April 2020
JEL No. G12

                                          ABSTRACT

Conventional models of production under uncertainty specify that output is produced in fixed
proportions across states of nature. I investigate a representation of technology that allows firms
to transform output from one state to another. I allow the firm to choose the distribution of its
random productivity from a convex set of such distributions, described by a limit on a moment of
productivity scaled by a natural productivity shock. The model produces a simple discount factor
linked to productivity, which can be used to price a wide variety of assets, without regard to
preferences.


John H. Cochrane
Hoover Institution
434 Galvez Mall
Stanford University
Stanford, CA 94305-6010
and NBER
john.cochrane@stanford.edu




Link to my webpage, with updated paper and any supporting materials is available at
https://faculty.chicagobooth.edu/john.cochrane/
         2


1. Introduction

Production possibilities in uncertain environments are usually modeled by augmenting stan-
dard production functions to include shocks. For example, we may write


                                          y (s) = (s)f (k )                                        (1)


where y (s) is output in state s, k is capital, and (s) is random productivity. The firm chooses
capital k , then nature chooses the state s, i.e. productivity (s), giving random output y (s).




Figure 1: Standard production possibility set in a two-state two-date world. The technology is
y (s) = (s)f (k ) for s = h, l, and y (0) = W - k .



       Figure 1 illustrates the production set implied by this technology for a two-period two-
state world. A farmer has seeds W at time 0. The farmer may plant them as k , or sell them as
y (0) = W - k . At time 1, the field generates wheat y (s) = (s)f (k ) according to the state s, which
can take on two values s = h or s = l. The implied production set smoothly transforms wheat
in spring to a bundle of contingent wheat in fall, but it has a kink across the states of nature. No
matter how high the contingent claim price of wheat in the low state relative to the high state,
there is nothing the farmer can do to alter production in its favor.
       This paper explores a representation for technology under uncertainty in which the firm
                                                                                           3




Figure 2: Smooth production possibility set. The firm can change the distribution of output
across states of nature ­ the pattern of y (h) vs. y (l).




has a smooth choice over the state-contingent pattern of its output. Figure 2 illustrates the idea.
Now, the farmer can also take actions which shift output from one state s = h to another state
s = l. If the relative contingent claim price of state l rises, for example, the farmer can produce
more in state l and less in state h, leaving sales at time 0, y (0) = W - k , unchanged.
       I explore smooth production sets generated by adding a choice of the productivity distri-
bution (s) to the conventional description of technology (1), constraining the random variable 
to lie in a convex set with a smooth boundary. Most of this paper explores a parametric example,
that random productivity  is constrained by

                                                                 1+
                                       1+                  (s)
                              E             =        (s)              1                         (2)
                                                s
                                                           (s)

where  are a set of weights, and   0 is a curvature parameter. We can think of the weights
 as natural or underlying random productivity. The firm may obtain higher productivity than
natural in some states, by accepting lower than natural productivity in other states. I consider
below whether we need the  weights and how to measure and identify them.
       Let m denote a stochastic discount factor, equivalent to contingent claim prices p scaled
           4


by probabilities  , m(s) = p(s)/ (s). If a firm maximizes contingent claim value


                                          max E [mf (k )]


subject to (2), the first-order condition for choice of  ­ choosing (s) in every state of nature s ­
leads to
                                                   
                                           m=           ,                                        (3)
                                                   1+
where  is a constant that includes the Lagrange multiplier on the constraint (2). In a dynamic
extension of the model, we link the stochastic discount factor to productivity growth,

                                                             -(1+)
                                             t+1      t+1
                                mt+1 = t                                                         (4)
                                             t        t

where t is a similar constant known at time t. The firm chooses to produce more in states of
nature with high contingent claim prices or stochastic discount factors ­ higher marginal utility
in general equilibrium ­ and in states in which natural productivity  is larger.


1.1   Production-based asset pricing

Why is this representation of technology useful or interesting? My direct interest is the con-
struction of production-based asset pricing models. These are models that link asset prices
and returns to real economic variables through producer first-order conditions. Rather than
focus on understanding firm behavior, the determinants of random productivity , given asset
prices as summarized by a discount factor m, I am interested in turning the first-order condi-
tions around to measure the stochastic discount factor from observed quantity choices. For
example, once we infer the stochastic discount factor from productivity data via (4), we can
relate risk premiums E (Re ) to the covariance of excess returns Re with the discount factor,
E (Re ) = -cov (Re , m)/E (m), and we can understand the prices p of payoffs x from p = E (mx).
When we generalize production technologies, variables beyond productivity including output,
investment, hours, and disaggregated production data enter the discount factor and contribute
to this understanding.
      This production-based approach ties the discount factor to marginal rates of transforma-
tion, ignoring and thus holding for any set of preferences. While a full understanding of the
economy requires general equilibrium ­ understanding preferences, investors' probability as-
sessments, and the consumer-facing market structure ­ one can at least tie asset prices to the
production side of the economy, and study production technology and behavior in isolation.
                                                                                        5


One can see if the cyclical relations between asset prices or returns and firm data makes eco-
nomic sense, while others work on preferences and market structure.
       As the name implies, this approach to production-based asset pricing is deliberately par-
allel to the standard consumption-based asset pricing approach. The consumer first order con-
ditions are
                                                  u (ct+1 )
                                        mt+1 =              .
                                                   u (ct )

With the usual power utility, and including the possibility of a preference shock , u(c) = (c/)1- ,
we have
                                                  -             -(1- )
                                           ct+1        t+1
                               mt+1 =                                    .                      (5)
                                            ct         t
In consumption-based asset pricing, we infer the stochastic discount factor from consumption
data, or its proxies, via (5). We then understand risk premiums and asset prices by the covariance
of payoffs with this discount factor.
       This consumption-based approach infers the stochastic discount factor from marginal
rates of substitution, ignoring and thus holding for any technology. While a full understanding
of the economy requires general equilibrium ­ understanding production technology and its
shocks, where cashflows come from ­ one can at least tie asset prices to the consumer-investor
side of the economy, and study preferences, expectations, and consumer-facing market struc-
ture in isolation. One can see if the cyclical relations between asset prices or returns and con-
sumer data makes economic sense, while others work on production technology, and assem-
bling production and consumption together in general equilibrium models.
       While the approaches are parallel, production-based asset pricing is additionally attrac-
tive because business cycles are essentially phenomena of production ­ declines in investment,
durable goods output, and employment ­ and much less visible in consumption. Indeed, for-
mula (4) and its generalizations below have the form of many ad-hoc macro-asset pricing mod-
els that tie asset returns to a discount factor created from productivity growth, investment growth,
output, hours, and other production data, surveyed below. Thus, this production-based theory
can provide foundations for many existing models in this class and the empirical success they
already document.
       Figure 1 makes clear why this direct approach to production-based asset pricing model is
not possible using standard representations of technology extending (1). Since there is a kink in
the production set across states of nature, many different contingent claims prices are consistent
with any production point the firm might choose. There is no marginal rate of transformation.
       Much production-based asset pricing nonetheless uses standard technologies of the form
         6


(1). Firm first-order conditions in this case still contain useful information for asset pricing. The
firm invests optimally, producing a fixed-coefficients bundle of contingent claims. The first-
order condition for that investment says that the physical return on investment should be cor-
rectly priced by the stochastic discount factor m, 1 = E mRI (k ) , with RI (k ) = fk (k ) in a
simple two-period example. We can therefore price asset payoffs that are perfectly spanned by
investment returns, and we can check for arbitrage between asset and investment returns. This
literature, surveyed below, has had considerable empirical success. But in this framework, we
cannot infer anything about other returns, and we cannot back out a general discount factor,
without making additional preference assumptions.
       Since I add the choice of productivity  to these representations of technology, all their
predictions remain intact. This paper is a generalization of investment-return models, not an
alternative to them.
       The approach in this paper and its relatives, surveyed below, is thus distinctive in that by
allowing and modeling a marginal rate of transformation across states, we can read the stochas-
tic discount factor that prices a wide class of returns from production data directly, without pref-
erence assumptions, in exact analogy to the standard consumption-based model.
       The word "production-based" is also sometimes used to describe any model that links
its discount factor or pricing factors to production data, though the economic logic may in-
volve consumer optimization or general equilibrium. I use it here to describe models that use of
marginal rates of transformation alone.
       I delay a discussion of the literature until after the main body of the paper. It will be much
easier to understand how this paper relates to other papers in the production-based enterprise
after the reader has a better idea of what is in this paper.
       Though production-based asset pricing is my motivation and the focus of this paper, this
representation of technology should also be useful in many other applications. Study of firms'
choices of risk exposure, and how those choices respond to asset prices, including commodity
futures and derivatives, is an attractive idea.


1.2   Shocks

The presence of random natural productivity  raises some practical difficulties ­ just as prefer-
ence shocks  would do if we allowed them. If we allow free shocks, we can explain anything, so
allowing shocks means we need to think about their identification and measurement.
       We need shocks somewhere, however. If neither preferences nor technology had shocks,
asset prices would be constant.
                                                                                          7


       Basic correlations in the data argue that we need underlying technology shocks  as well,
perhaps, as preference shocks. If there were no such shocks, then firms would produce more
(higher ) in high discount-factor states. We usually associate high discount factors ­ high mar-
ginal utility ­ with low consumption, low stock prices, and recessions. But output is low in re-
cessions, not the other way around. Thus, the fact that stock prices, output, and consumption
all comove positively suggests that the bulk of such fluctuations must come from underlying
technology shocks, not preference or equivalent irrational-probability shocks.
       This conclusion is not ironclad. Productivity may rise in recessions, when output and
stock markets fall, or when other risk-factors fall. Not all macroeconomic variables and as-
set returns move in lockstep: we live in a multifactor world. But the logic is strong enough
that we should keep natural productivity shocks in the model for now and think quantitatively
about their need and how to identify them. Natural productivity shocks also act as a change-of-
measure variable allowing us to treat probabilities flexibly.


1.3   Are smooth production sets reasonable?

Why is a smooth representation of production possibilities such as (2) reasonable? First, produc-
ers do seem to have some ability to control the pattern of their output across states of nature, i.e.
the distribution of the productivity shocks they face. A farmer may plant wheat in fields that do
better in rainy or dry weather, choose seeds that prosper in different weather conditions, and so
forth. Electric utilities may invest in equipment that produces electricity most efficiently given
today's prices and regulatory treatment of coal, oil, gas, nuclear, solar, etc., or it may choose
to invest in a variety of equipment, or more costly and flexible-fuel equipment that can adapt
to different circumstances. Firms generically face questions of efficiency vs. resilience. Choose
one, cheapest supplier or spread orders around multiple suppliers in different countries. Keep
extra inventories around, or order them just in time. "Real options" in management studies ex-
actly this sort of production decision. Given that bankruptcy, adjustment and reorganization
costs are real, financial decisions such as hedging input prices and equity vs. debt financing af-
fect state-contingent outputs. In spring 2020, decisions not to keep an inventory of face masks
and ventilators around, and decisions to take on a lot of debt rather than equity finance are lead-
ing to much regretted state-dependence in output. The ability to produce during the pandemic
state of nature is suddenly receiving great attention in industry and government, and hopefully
better choices of  will emerge before the next one hits.
       This ability to transform output across states of nature is not unlimited. Technology will
naturally have kinks across states of nature completely unrelated to the production process. But
         8


technology will naturally not have kinks across many other states of nature that are related to
the production process.
      Second, smooth production sets can occur when one aggregates standard production
functions. Below, I explore a model in which a firm has access to several different technolo-
gies or processes, each of which has a different, but fixed, distribution of shocks. By varying its
input across the different processes, the firm can change the distribution of the shock in the ag-
gregate production function that relates the firm's total output to its total input. This approach
is analogous to the classic result that an aggregate of production functions that demand fixed
combinations of inputs can be smooth (Houthakker (1955)). I apply the same logic to multiple
outputs across states of nature.
      Likewise, as one can span a full set of contingent claims by varying investment over time
in two securities, as in Black-Scholes option pricing, so one could span contingent claims by
time-varying physical investment in multiple fixed-coefficient technologies.
      Since each firm, industry, or economy is an aggregate of an immense number of micro-
scopic production activities, this aggregation view suggests a rich set of possibilities for trans-
forming output across states. But aggregation is useful when we have detailed micro data that
we wish to add up. The philosophy in this paper is to specify aggregated, and therefore smooth,
firm, industry, sector, or economy production functions directly, corresponding to our data
sources. This philosophy mirrors the specification of representative consumer preferences with-
out spending a lot of time on aggregation in consumption-based asset pricing.
      Third, one may simply view that the lack of kinks is the most natural production set, and
ask what empirical evidence there is for such kinks. That is how we approach the choice of in-
puts and in studying non-stochastic multiple-output production functions. If we wish to model
a farmer's choice to produce wheat vs. corn, or to produce more today and less tomorrow, we
start with a smooth production set. So if we wish to study wheat in rainy weather vs. wheat in
sunny weather, why would we start by assuming their proportions are immutably fixed? A reader
of Debreu (1959), say, encountering the idea of contingent claims, would surely start by writing
down a smooth production set, mirroring smooth preferences across goods and states, and mir-
roring smooth technologies across inputs, outputs, and over time. Static production theory in
textbooks beautifully mirrors static preference theory. Why not production under uncertainty?
      Historically, it seems that aggregate production functions with kinks across states of na-
ture are not the result of such consideration and evidence. Instead, shocks were simply tacked
on to deterministic intertemporal functions familiar from growth theory. Real business cycle
models such as Kydland and Prescott (1982) and King, Plosser, and Rebelo (1988) use technolo-
                                                                                        9


gies of the form (1). None considers the possibility of a smooth production set across states
of nature. That choice is entirely understandable. A smooth production set adds complica-
tions. And these authors didn't need to generalize. Tacking productivity shocks on to standard
intertemporal technologies was good enough for their uses. But that historical accident does
not carve the decision in stone, or argue for kinks and against smoothness. Here too, adding
productivity choice generalizes rather than contradicts these models. One can always pick the
underlying shock process  so that the firm's equilibrium choice  is the same as specified in
these models.



2. Production functions and discount factors

Our goal is to write plausible and tractable aggregate production functions that allow transfor-
mation across states. There are many ways to write general concave functions that are differ-
entiable across states of nature. However, it seems productive instead to incorporate standard
production theory, and forms that have proved useful in the past, as far as possible.
      For that reason, I specify a production function that describes the firm's ability to trans-
form goods over time in a conventional way, but adds to it the ability to transform output across
states. Additionally, I focus on and explore a particular constant elasticity of substitution (CES)
functional form for this choice: output y is given by a standard production function combining
capital k and labor n,


                                           y = f (k, n)                                         (6)

                                       y (s) = (s)f [k, n(s)]


where  satisfies.
                                                     1+
                                           E               1                                    (7)
                                                  
                                                           1+
                                                     (s)
                                            (s)                  1.                             (8)
                                       s
                                                     (s)

The second equation in each group expresses random variables as functions of finite states
s = 1, 2...S . The finite state examples are easier to keep track of, but the analysis is valid for
continuously distributed random variables.
      The firm can choose its productivity  from the convex set of random variables described
by (7). Nature hands the firm an underlying or natural productivity , and the firm may choose
 = . But the firm can choose a higher value (s) in some states s, if it accepts a lower value
          10


(s ) in some other state s . The parameter  controls the firm's ability to transform across sates
of nature. As   , productivity necessarily converges to the natural shock . As  decreases,
it is easier for the firm to transform output from one state to another. (Previous drafts of this
paper used  in place of 1 + . I change notation here to more clearly mirror the risk aversion
coefficient of power utility.)
       An alternative way to think of (7) is that we generalize a certainty production function
y  f (k, n) to a CES aggregate of output across states on the left hand side,

                                                    1
                                          y   1+   1+
                                     E                   f (k, n).
                                          

Defining  = y/f (k, n), this is the same formulation as (7). This expression is perhaps more the-
oretically satisfying, as it describes a convex and smooth set of inputs and outputs. However, I
find the idea of "picking productivity" maintains better the connection to well-studied produc-
tion theory, so I use the former expression. The  allows for free disposal, but with positive state
prices the firm will always choose equality.
       Figure 3 plots the production set (8) in a two-state example, s = {h, l} with (h) = 2,
(l) = 1 and  (h) = 0.5. For  = 1, you see how (8) induces a convex set of possible {(h), (l)}
possibilities, and with them a convex set of y (s) = (s)f (k ) possibilities, as graphed in Figure 2.
As we raise , the curve is more convex, and as we lower , the curve is flatter. Thus, higher 
means that in response to a given contingent-claim price vector, the firm will deviate less from
the initial , while for lower  it will deviate more. The parameter  plays a similar role to the risk
aversion coefficient of utility theory. The natural shock  biases the production set towards state
h in this case.
       Probabilities do not naturally enter production technologies. A farmer's ability to produce
more in a rainy state and less in a dry state, by moving planting to a field that does better in rainy
weather, does not have any natural connection to the probability that the rainy state occurs. Yet
it is very convenient to sum across states of nature by some probability measure, and essentially
mandatory to do so with continuously distributed random variables. Thus, the probabilities in
(7) and (8) are arbitrary. They are not necessarily (say) the firm manager's subjective probabil-
ities, as the probabilities in the consumer first-order condition are the consumer's subjective
(rational or not) probabilities.
       This arbitrariness of probabilities is one reason to include the shock . One might wish for
the simplicity of a model without natural productivity shocks, but then the probabilities them-
selves become the weights. Those probabilities might differ arbitrarily from true or empirical
                                                                                                       11


                         1.6



                         1.4
                                                        = 0.5
                                   =1
                         1.2              =2

                          1
                   (l)

                         0.8



                         0.6



                         0.4



                         0.2



                          0
                               0    0.5            1            1.5          2         2.5   3   3.5
                                                                       (h)


Figure 3: Shock choice sets. Each line gives the set of {(h), (l)} that the firm can choose from,
satisfying E [(/)1+ ]  1. The base case is  = 1,  = (2, 1), and  (h) = 0.5. The dashed lines
vary  to  = 0.5 and  = 2.




probabilities used in analysis. Thus, the weights 1+ can serve as transformation between the
probability weights, unrelated to actual probabilities, that define technological opportunities,
and whatever probabilities we wish to use in analysis. The parameters  and  are not separately
identified, so any change in one can be made up by the other. In that sense the probabilities
really do not enter the production set.
       This seeming arbitrariness is a virtue. We do not have to worry about rational or irrational,
conditional vs. unconditional, true vs. sample, real vs. risk-neutral probabilities, agents who see
more than we do, and so forth.
       To make these observations a bit more concrete, we could start by generalizing a technol-
ogy y = f (k ) to a CES aggregate over states

                                                                              1
                                                                             1+
                                                                      1+
                                                       (s)y (s)                   = f (k )
                                               s


where (s) are a set of weights unrelated to probabilities. This expression describes a concave
production set of outputs. Divide by f (k ), and we have a constraint on productivity  = y/f (k ).
         12


Given any convenient set of set of probabilities  , define

                                             1       (s)
                                               1+ 
                                                   =      ,
                                           (s)        (s)

and we recover the original specification (2).




3. The simplest model



Now let us place this constraint in a model of the firm. Fix f (k, n) = 1 to focus on the random
variable choice, and consider a firm that maximizes the value of output, now just . The firm's
problem is
                                                             1+
                                   max E (m) s.t. E                1.                           (9)
                                                          
To be clear, with finite states s, the latter expression means

                                                                        1+
                                                                  (s)
                        max         (s)m(s)(s) s.t.        (s)                1.
                       {(s)}
                               s                      s
                                                                  (s)

The variable m is the stochastic discount factor, or contingent claim price divided by probability,
m(s) = p(s)/ (s), so the objective is the same as maximizing contingent claim value. The firm
chooses the random variable (s) in each state of nature s. Thus, a first-order condition operates
state-by-state inside the expectation.
       Introducing a Lagrange multiplier  on the productivity-choice constraint, the first-order
condition is
                                                          (s)
                                       m(s) =  (1 + )                                         (10)
                                                          (s)1+
in each state of nature s. This first-order condition directs the firm to rearrange output towards
states of nature with high discount factors or contingent claim prices, and towards states where
it is easier to produce with high .
       In standard theory of the firm, we solve for choices given prices, for  given m. We do that
                                                                                        13


by imposing the constraint in (9) to eliminate the Lagrange multiplier , which yields1

                                                           m
                                           =                                 .                  (11)
                                                             1+       1+
                                                    E (m)     




This condition expresses even more clearly the idea that the firm should produce more in states
with high contingent claim prices m and high natural productivity . (The point of this equation
is to determine  given the other variables, so one might re-express it with just  on the left hand
side to emphasize that point. I find the given expression prettier, as it describes how  is distorted
away from .)
           However, our objective is a production-based asset pricing model: We want to infer what
contingent claims prices m must have been in order to produce observed choices . Equation
(10) already gives us a discount factor that can price all zero-cost portfolios or excess returns.
For that goal, we need an m such that 0 = E (m Re ) for any excess return Re . The level or scale
of m is irrelevant. If 0 = E (m Re ) then 0 = E [(2m )Re ]. Thus, the discount factor

                                                            
                                                   m =                                          (12)
                                                          1+

immediately prices all zero-cost portfolios. The analogy to the consumption-based m = c- /1-
with utility u(c) = (c/)1- is attractive. (For symmetry, I include a preference shock  here, dis-
cussed below.)
           When using discount factors for zero-cost portfolios, it is often useful to normalize the
discount factor so the mean discount factor and implied risk-free rate E (m) = 1/Rf are reason-
able. This normalization leads to

                                                                      
                                        m =       1+
                                                     / Rf E                      .              (13)
                                                                  1+

           This problem does not lead to a full characterization of the discount factor, because we
have not given the firm any ability to transform output over time. Equation (11) gives the same
choice  for a discount factor 2m as it does for a discount factor m, so we cannot invert (11) to
learn the level of the discount factor from . We add time next.
   1
       Algebra: From (10),
                                                                 
                                                m =  (1 + )
                                                                 
                                              1+                 1+      1+
                                        (m)        = [ (1 + )]    
                                                                      
                                                   1+                   1+
                                          E (m)         = [ (1 + )]          .
Substitute out  (1 + ) in the top equation and rearrange to get (11).
           14


         Expressions (10)-(13) relate random variables. They hold ex-post state by state. The (s)
notation in (10) emphasizes this fact. It is often convenient to give a name and number to states
of nature. For example, s could denote inches of rainfall. Then (10) relates functions. The ex-
pression m(s) is the function relating inches of rainfall to the discount factor, and (10) describes
how that function is composed of the functions (s) and (s), or it describes the firm's optimal
choice function (s) in terms of the functions m(s) and (s). Thinking this way is particularly
convenient when one wants to construct a model, not just infer a discount factor from data.
One typically specifies that s is a vector that follows a stationary Markov process, fully capturing
all information.



4. A two-period model

Next, we add the conventional f (k ) part of production theory, which allows the firm to transform
output over time as well as across states. In this formulation the intertemporal and risk aspects
of the problem separate so equations like (12) and (13) continue to describe risk premiums.
The intertemporal problem adds a single investment return which establishes the level of the
discount factor m and the level of returns.
         Add capital and the possibility to invest at time 0. The firm maximizes contingent claim
value,
                                                              1+
                             max E [m f (k )] - k s.t. E            1.                         (14)
                             {k,}                          
The firm chooses capital k before the shock is realized. It chooses the value of productivity  in
each state of nature, e.g. (s) for each s.
         Again introducing a Lagrange multiplier  on the productivity-choice constraint of (14),
the first-order conditions are

                                    
                                      : 1 = E [m fk (k )]                                      (15)
                                    k
                                                           
                                      : mf (k ) = (1 + ) 1+ .                                  (16)
                                                          

         Equation (15) is the familiar condition that the discounted value of the production ac-
cruing to an additional unit of investment should equal its marginal cost. Equivalently, the
firm should invest until the physical investment return is correctly priced. We can write (15)
1 = E (mRI ) with RI  fk (k ) denoting the (random) investment return. This first-order con-
dition is the same as it is in the standard case that the firm has no  choice. By observing  and
k , we can learn one return RI , and we can learn any returns that can be priced by arbitrage with
                                                                                           15


RI . But we cannot learn about other returns or payoffs.
       Equation (16) is the same as the productivity choice first-order condition of the simplest
model without capital (10). A little more (s) in state of nature s would raise the firm's objective
by  (s)m(s)f (k ), at the cost of lowering output in some other states. From (16), discount factor
(12), m =  /1+ , and its scaled version (13) that describe zero-price portfolios are unchanged
with the addition of f (k ) to the production technology. Thus, this two-period model only adds
the level of the discount factor to the previous description.
       Now, let us incorporate (15) and fully solve for the discount factor. The level of the dis-
count factor is determined in this model by the condition (15) that the discount factor prices the
investment return.

                                           (1 + )                         fk (k )
                  1 = E [mfk (k )] = E              1+ 
                                                        fk (k ) =  (1 + )         .
                                            f (k )                        f (k )

Equation (16) then becomes

                               1                  1          1+       1          1+
                        m=                   =                    =                   .            (17)
                              fk (k )            fk (k )              RI      

I can't decide which form on the right hand side is prettier. Take your pick.
       Since any asset or claim to a payoff x is a bundle of contingent claims, we can write asset
prices as price = E (mx), for example

                                                   1         1+
                                   price = E                      x .
                                                  fk (k ) 

       The discount factor (17) is not the inverse of the investment return, m = 1/RI = 1/ [fk (k )] .
The discount factor (17) adjusts that investment return as the firm has chosen to distort its pro-
ductivity  from the underlying shock . The investment return RI = fk (k ) is not riskfree. The
model determines the riskfree rate indirectly, through the investment return together with the
productivity  first-order condition that determines risk premiums. From (17), the riskfree rate
is
                          1                1               1                     1+
                           f
                             = E ( m ) =         E  1+ 
                                                        =E                            .
                         R               fk (k )           RI              
       This model separates the economics of intertemporal transformation and risk premiums.
The first-order condition (15) governs the allocation of output over time, the tradeoff at the mar-
gin of an initial k for a risky bundle f (k ), and it determines the overall level of returns, the level
of the discount factor. First-order condition (16) governs the allocation of output across states
of nature and thus risk premiums. As we generalize the production technology f (k ), this sim-
          16


ple calculation (12) for characterizing risk premiums turns out to remain essentially unchanged,
while the investment returns and therefore the characterization of the overall level of returns
gets more complex.


4.1   Production theory vs. asset pricing

In the theory of the firm, we solve such first-order conditions to give the producer's choices
{k, } in terms of prices, i.e. the discount factor m. To this end, we solve the pair of first-order
conditions to give one equation describing k and another describing , each in terms of m and
. The resulting expression for optimal capital k is2
                                                               
                                                       1+     1+
                                       1 = E (m)                   fk (k )                                 (18)


while the optimal productivity  is given by

                                                         m
                                          =                             .                                  (19)
                                                            1+     1+
                                                 E (m)       




Equation (19) expresses the same intuition as the first-order condition (16), produce more in
high discount factor and high  states, in purer form. It is the same expression as in the one-
period model, (11).
       Looking at (19), the choice  =  emerges if m  1/. In this case, we do have that m =
1/[fk (k )] = 1/RI , i.e. the discount factor or contingent claim price vector equals the inverse of
the firm's investment return. The  =  case does not emerge under risk neutrality or state prices
proportional to probabilities, m =  = constant.
       Though my motivating application is production-based asset pricing, a theory of the
firm with choice of productivity shocks would be interesting as well. However, the genius of
consumption-based asset pricing is that we can infer discount factors from consumer first-order
conditions without even solving the full consumer partial-equilibrium problem ­ without writ-
ing the budget constraint, income stream, and finding consumption in terms of prices and in-
comes, as for example rational-expectations permanent income models do ­ and certainly with-
out solving the whole general equilibrium. Here, production-based asset pricing follows the
same path. We can infer the discount factor, or at least a discount factor for zero-cost portfo-
lios, directly from firm first-order conditions without solving for the constraint as in (19), and
without solving the full partial-equilibrium output, labor, and capital plan as in (18), let alone
  2
    From the first form of (17) write mfk (k) =  / . Using the constraint E [(/)1+ ] = 1, we have (18). Use (18)
to substitute for fk (k) in the first form of (17) to obtain (19).
                                                                                        17


general equilibrium.



5. Labor

Adding labor changes the calculations in interesting ways. Adding other variable inputs, effort,
prices (such as a relative price of investment and output goods), and other refinements and
extensions of the period production function, have similar effects.
      First, a disappointment: One might think that a firm which can adjust inputs after ob-
serving a shock can produce more or less output in response to that shock and thus achieve a
marginal rate of transformation. That intuition is false. Producing more in one state does not
make it harder to produce in another. The ability to produce more or less after a shock is ob-
served does not allow the firm to transform output across states of nature. (Belo (2010), footnote
4 makes this point.)
      To see this point, write the production function as


                                            y (s) = (s)f [k, n(s)]


where n(s) is labor input or effort in state s. Without productivity choice, the firm's problem is


                        max             (s)m(s) {(s)f [k, n(s)] - w(s)n(s)} - k
                       {k,n(s)}
                                  s


where w can represent the wage, or the cost of providing effort. The first-order conditions are


                                      m(s) [(s)fn [k, n(s)] - w(s)] = 0                        (20)

                                                m(s)(s)fk [k, n(s)] = 1.                       (21)
                                            s


      Condition (20) does not help us to identify the discount factor m(s), as m(s) cancels from
that equation. The firm sets (s)fn [k, n(s)] = w(s) separately in each state. This observation
gives us no information linking states.
      The contingent claim price is not the output price. The contingent claim price applies
equally to output and wages. The wage is w(s) relative to output in each state. Written in terms of
contingent claims prices p(s) = m(s)/ (s), the first-order condition is not p(s)fn [k, n(s)] = w(s)
­ that's a different p(s), an output price not a contingent-claim price. Intuitively, the action of
hiring more labor in one state does not change the firm's options in another state, so this margin
does not identify contingent claim prices.
         18


      Variable labor does however act like an additional productivity shock , so it gives us a
measurable source of such shocks and will be important in quantitative exercises. To see these
effects in the simplest model, return to the one-period model of Section 3. Now let the firm
maximize
                            max E {m [f (n) - wn]} s.t. E (/)1+  1.                            (22)
                            {,n}

The labor decision and the wage are both stochastic, i.e. w(s) and n(s) are random variables,
and the labor decision takes place after the firm observes the state of the world s. The first-order
conditions are now the pair


                                    fn (n) = w

                                    mf (n) = (1 + ) /1+ .


With a standard power functional form f (n) = n the first-order conditions become


                                   n-1 = w                                                     (23)

                                      mn =  (1 + )  /1+ .                                      (24)


      We can construct a discount factor for zero-cost portfolios from (24):

                                                  
                                          m =         .                                        (25)
                                                 1+ n

Comparing this result to (12), we add labor n . Labor n appears in the discount factor formula
just like another shock .
      Alternatively, we may substitute from the first-order condition (23) to express the labor
choice n as a function of wage w. From (23), the labor choice is
                                                       
                                                      1-
                                         n =               .                                   (26)
                                             w

Substituting for n in (24), and solving for m,
                                                           
                                       (1 + ) - 1- 1-
                                                    
                                   m=             w                                            (27)
                                        1-    1+

Thus, we have a discount factor for zero-cost portfolios
                                                   
                                           - 1-   
                                        m = 1+ w 1- .                                          (28)
                                            
                                                                                                             19


          Expression (28) using wages is a little more elegant than (25) using labor input, as now
the discount factor is expressed as a function of the single choice variable  and external cir-
cumstances w and . High  will induce the firm to hire more labor, so  and n are really not
two separate influences in (25). In (28) labor changes the effective coefficient on productiv-
ity . A measurement of the coefficient on  with constant wages is not the pure coefficient of
transformation across states. However, the labor end of macroeconomics discourages the use
of measured spot wages as equal to marginal products of labor, so the formulation using actual
labor inputs may be more successful empirically.
          The discount factors (25) and (28) have important lessons going forward. The production-
based discount factor is not necessarily just productivity raised to a power. Here, wages or labor
inputs appear as additional pricing factors in a discount factor formula. Additional material
inputs or adjustment costs can appear similarly.
          Solving (27) for , and using the constraint to find the Lagrange multiplier , we can ex-
press the productivity choice as3

                                                                                        1+
                                                                       1                   
                                                                m 1- w- 1-
                                                                                        - 1- 
                                     1+
                                                  =                                      1+          .            (30)
                                     1+                                 1          
                                                                                - 1-        
                                                                                         - 1-
                                                         E         m   1-   w                 




The firm chooses larger productivity in states with higher discount factors, higher natural pro-
ductivity shocks, and lower wages. Wages act like the natural productivity shocks.



6. Intertemporal production

Next we generalize the idea to a standard intertemporal context. The firm's objective is

                                                                   
                                                  max E               t-1 t (yt - it ),
                                                                t=1

   3
       From (27), we have                                                                    
                                                  1                         (1 + ) - 1-
                                          m 1- w- 1- =                                           .
                                                                             1-         - 1-
                                                                                          1+
                                                             1+
                                          1                  -               (1 + )       -          1+
                                  m 1- w- 1-
                                                                                           1-
                                                              1-       =                                .         (29)
                                                                                 1-                  1+
Taking the expectation and using the productivity choice constraint gives
                                                                                                1+
                                                                   1+
                                                                                     (1 + )     - 
                                              1                    - 
                                     m 1- w- 1-
                                                                                                 1-
                                 E                                  1-       =                           .
                                                                                        1-


Substituting back in (29) we have (30).
         20


where t-1 t is the stochastic discount factor, with mt+1 = t+1 /t , 0 = 1, y is output and i is
investment. I start with y = f (k ), and then generalize to add labor y = f (k, n) and adjustment
costs to investment. It is more convenient in this dynamic setting to write the problem in terms
of the level of the discount factor , rather than the cumulated growth rate m.
      Now, how do we extend the productivity choice constraint? There are several ways to
approach this question.



6.1   A sum constraint

A natural way to extend the idea to a dynamic model is to write the constraint

                                                               1+
                                                       t+1
                                E (1 - )          t                      1.                      (31)
                                                       t+1
                                            t=0


This formulation parallels the extension of power utility from a one-period setting E c1- to
                                  t      1-
an intertemporal setting E    t=1  (ct )    .   As in that case, however, this formulation allows the
firm to substitute productivity over time, trading t for t+1 , as well as across states of nature. I
turn below to ideas that separate time vs. risk.
      Using a simple production technology y = f (k ), the firm's time-zero contingent claim
problem is now

                                                  
                                       max E          t-1 t [t f (kt ) - it ]
                                                t=1

                              s.t. kt+1 = (1 -  )kt + it , k0 ,                                  (32)


and (31). I scale the discount factor by the same time constant  as appears in the constraint
(31). This is just a convenience to produce stationary solutions, as we often scale  t t so we can
write u (ct ) = t . Otherwise, we obtain growth in either the discount factor or in productivity,
which is fine but adds extra terms in powers of . Growing  can also make up any difference in
growth rates.
      The first-order conditions, varying investment and then productivity, are


                                  t = Et {t+1 [t+1 fk (kt+1 ) - (1 -  )]}                        (33)
                                                             a
                                                             t+1
                        t+1 f (kt+1 ) = (1 + )(1 - )         1+     .                            (34)
                                                             t +1


where  is the Lagrange multiplier on the productivity-choice constraint (31).
                                                                                                                        21


           Condition (33) is the familiar intertemporal condition. It says to invest so that the one-
                                        I
period return from physical investment Rt +1  t+1 fk (kt+1 ) - (1 -  ) is correctly priced by the

discount factor. In this equation and below, keep in mind that capital kt+1 is known at time t.
           Equation (34) ties the discount factor to productivity, just as the consumption-based dis-
count factor is tied to consumption, t = u (ct ). It says to raise productivity in states with high
contingent claim prices, in states in which it is easier to do so, and in states with higher output,
since productivity multiplies output.
           Dividing adjacent periods, equation (34) leads to a discount factor for one-period returns
composed of productivity growth and capital or productivity growth and output,

                                                                                    -(1+)
                                              t+1                 t+1         t+1             f (kt )
                             mt+1 =               =                                                                          (35)
                                              t                   t           t              f (kt+1 )
                                                               1+           -1          -(1+)
                                                     t+1            yt+1          t+1
                                          =                                                          .                       (36)
                                                     t               yt           t

This expression is nicely analogous to the consumption-based discount factor proportional to
consumption growth t+1 /t = (ct+1 /ct )- . It leads to a multi-factor macro-asset pricing model.
           We can eliminate the multiplier  to express productivity choice as before4 ,

                              a
                              t                                     t t f (kt )
                               =                                                                          .                  (37)
                              t                                                             1+       1+
                                             E        t=0 (1   - )t [t+1 t+1 f (kt+1 )]      




           This problem also allows a recursive statement, which is an easier basis for numerical
solution of more complex models. Write the constraint (31) recursively as

                                                                    1+                                   1+
                                                     j -1   t+j                             t+1
                Wt1+    Et (1 - )                                        = Et (1 - )                          + Wt1+
                                                                                                                  +1
                                                                                                                     
                                                                                                                             (38)
                                                            t+j                             t+1
                                           j =1


with W0 = 1. At time t, the firm picks for each state at t + 1 values for t+1 and Wt+1 , subject to




   4
       Algebra: From (34),
                                                                                            1+
                                                         1+                       1+    t
                                         [t t f (kt )]         = [(1 + )(1 - )]                  .
                                                                                        t
Imposing the constraint,
                                   
                                                                         1+                          1+
                             E           (1 - )t [t+1 t+1 f (kt+1 )]          = [(1 + )(1 - )]            .
                                   t=0

Substituting in (34) gives (37).
         22


the constraint (38). The recursive problem is then

                                                                                       t+1
  V (kt , Wt , t ) =         max            {t f (kt ) - [kt+1 - (1 -  )kt ]} + Et         V (kt+1 , Wt+1 , t+1 )
                       {kt+1 ,t+1 ,Wt+1 }                                              t

subject to (38), k0 , and W0 = 1. The first-order and envelope conditions of this recursive state-
ment give the same results (33) and (34). See the Appendix for algebra.
      This recursive statement also allows us to think about the problem starting from time
t, and its conditional information set. The problem is the same, with the constraint equal to
Wt1+ rather than one, as reopening a consumer problem at time t is the same, with conditional
expectations and time-t wealth in the constraint.
      An arbitrage argument offers insight. Since the constraint links date and time, we can
synthesize any return, by producing a little more dyt+1 in the states of nature described by that
return, at the cost of producing a little less dyt , as described by the constraint. Differentiating
the constraint (31) with respect to t and all t+1 following the date and state t ,

                                            t                     t+1
                                            1+ dt = Et            1+      dt+1 .
                                            t                     t +1


The production process gives extra output according to dyt = f (kt )dt , so the extra output dyt+1
and its cost dyt obey
                                   t                             t+1         1
                                1+         dyt = Et              1+                dyt+1 .
                                t  f (kt )                       t +1
                                                                         f (kt+1 )

Defining Rt+1 = dyt+1 /dyt , the firm can thus synthesize any return Rt+1

                                                   1+             -1           -(1+)
                                             t+1          yt+1           t+1
                           1 = Et                                                      Rt+1 .                       (39)
                                             t             yt            t

We recognize the standard asset pricing equation with the discount factor (36).
      In this way, we can view this production-based asset pricing model as an extension of the
arbitrage argument of investment-based asset pricing. Investment-based asset pricing notices
                                       I
that the firm can synthesize a return Rt +1 by varying investment at time t and t + 1. Therefore
                                            I
any security with state-contingent payoffs Rt +1 must have price one. This argument tells us how

similarly to price any set of random payoffs, by synthesizing them via the productivity choice
constraint.
                                                                                             23


6.2   Separating time and state by recursive production and CES

If we wish to separate the economics of time and state in production-based asset pricing, treated
symmetrically in the sum constraint (31), we can naturally follow the approaches that sepa-
rate time and state in utility theory. Unlike the case in utility theory, where the axioms of ex-
pected utility lead to state-separability, there is nothing (yet) but convenience indicating that
production technology should be separable across sates. So non-state-separable and non-time-
separable production are useful possibilities to consider.
       First, we can follow the Epstein and Zin (1989) recursive utility path. To get there, write
the recursive statement of the sum constraint (38) as
                                                                            1
                                                      1+                   1+
                                              t+1
                           Rt+1 = (1 - )                       + Wt1+
                                                                   +1
                                                                      
                                              t+1
                                                  1
                                      1+         1+
                             Wt = Et Rt +1            .


Here, I just introduce the notation Rt+1 for the inside term of (38). Now we can generalize this
constraint by changing the parameter of the first equation to  = :

                                                                            1
                                                          1+               1+
                                              t+1
                            Rt+1 = (1 - )                      +   Wt1+
                                                                     +1
                                                                        
                                              t+1
                                                  1
                                      1+         1+
                             Wt = Et Rt +1            .


The parameter  describes the firm's ability to transform productivity from one date to another.
The parameter  describes its ability to transform productivity from one state to another.
       The one-period discount factor becomes
                                                 -
                                                                     1+          1+          -1
               t+1   1+     Rt+1                               t+1         t+1        yt+1
      mt+1   =     =                         1
                                                                                                  .   (40)
               t     1+      1+
                         Et Rt              1+                 t           t           yt
                               +1


The Appendix presents the algebra. As in recursive utility, a state variable, Rt+1 , that combines
current t+1 and future productivities now enters the discount factor, and it defines risk expo-
sures. Identifying that state variable takes a lot of effort on the consumption side, and would
likely require effort on the production side as well. But it also opens the door to an interest-
ing menagerie of pricing factors. And, we can observe the firm's stock price where we cannot
observe the consumer's utility, which may help.
       Second, we can simply describe productivities as a CES aggregate, with distinct elasticities
         24


across time  and states ,

                                                            1+
                                                                  1
                                  
                                                 t+1   1+   1+    1+
                                        t E                             1.                           (41)
                                                 t+1             
                                  t=0


The one-period discount factor becomes

                                                   -
                                            1+
                                                  1+
                                    t+1
                           E
                                                 
                                    t+1
                                                                 1+          -(1+)          -1
                  t+1                                    t+1           t+1           yt+1
         mt+1   =     =                     1+
                                                                                                 .   (42)
                  t                     t                t             t              yt
                         E
                        
                                        t
                                                 


The first term alters our description of the firm's ability to transform across time, and now con-
trols the riskfree rate or other level of returns. Zero cost portfolios can be priced by the same
discount factor as before, ignoring the first term. Productivity , still raised to 1 + , carries risk
pricing. In the recursive formulation (40) the direct  productivity term is raised to the 1+ power
and describes intertemporal substitution. The Rt+1 term (which also contains t+1 ) carries all
the risk aversion, but one must calculate or measure that state variable somehow to measure
risk premiums. So this CES aggregate is simpler and easier to operationalize, though it opens
fewer doors to additional pricing factors.


6.3   A constraint each period

One can also allow productivity choice in a dynamic model by writing a separate constraint for
each time period,
                                                       1+
                                                 t+1
                                            E               1                                        (43)
                                                 t+1

in place of the single constraint (31). This formulation does not allow the firm a marginal rate of
transformation between time periods by productivity choice. All intertemporal transformation
has to go through the investment return.
       The firm maximizes the contingent claim value of output,

                                   
                          max E         t-1 t {t f (kt ) - [kt+1 - (1 -  )kt ]}
                                  t=1


but now subject to the constraints (43) rather than (31). The first-order conditions are

                                                 t+1
                         ,     : 1 = Et              [t+1 fk (kt+1 ) + (1 -  )]                      (44)
                       it it+1                   t
                                                                                      25


                                                            t+1
                               : t+1 f (kt+1 ) = t+1 (1 + ) 1+ ,                             (45)
                           t+1                             t+1

where t t+1 is the Lagrange multiplier on the constraint (43). It varies over time, but not across
states of nature.
       Equation (44) again says that the investment return should be correctly priced. Equation
(45) again says to produce more in high contingent claim price states, high natural productivity
 states, and high output states.
       The difference between a separate constraint for each period (43) and the previous con-
straint on the sum (31) is that we have time-varying Lagrange multipliers t+1 in (45) rather than
a constant . The multiplier t+1 measures the shadow value of transforming intertemporally, of
trading some t for the ability to increase all of the following t+1 .
       We can quickly construct a discount factor that prices zero-cost portfolios. Such a dis-
count factor m at time t satisfies
                                         0 = Et (m     e
                                                  t+1 Rt+1 ).


It can be scaled by any time t random variable; bt mt+1 also prices zero cost portfolios. A conve-

nient zero-cost portfolio discount factor is thus

                                                                -(1+)
                                            t+1        t+1
                                mt+1 =                                  .                    (46)
                                            t          t

This discount factor is the same as the zero cost portfolio discount factor deriving from the sum
constraint, (35), differing only by time t random variables.
       One could use the same discount factor for zero cost portfolios as in the one-period
model,
                                                       -(1+)
                                       m         
                                        t+1 = bt t+1 t+1        ,                            (47)

for any bt . However, productivity t , like consumption, is typically very persistent and grows
over time, and t should have similar properties. So, while (47) with bt = 1, say, prices zero-
                                                                             f
cost portfolios, its conditional mean Et (m                                             
                                           t+1 ) and implied risk free rate Rt = 1/Et (mt+1 ) vary

strongly over time, and it is potentially non-stationary violating the assumptions of all time-
series empirical work. Choosing growth rates as at least an initial scaling, as in (46), is wise
for typical time-series applications. Analogously, we typically use mt+1 =  (ct+1 /ct )- , though
        -
mt+1 = ct+1 also prices zero cost portfolios.

       One can scale further by any convenient time-t random variable. For example, one can
         26


                                                   f
produce a given shadow or measured risk-free rate Rt with

                                                                           -(1+)
                                                    t+1             t+1
                                          1         t               t
                              mt+1 =       f                                -(1+)
                                                                                        ,         (48)
                                          Rt Et      t+1             t+1
                                                     t               t


with or without t and t in the denominators. Scaling a discount factor to have a reasonable
implied riskfree rate has proven wise in empirical work.
       We can also scale the discount factor to price the investment return, and thereby display
a full production-based discount factor that prices all returns,

                                                                          -(1+)
                                                  t+1            t+1
                                                  t              t
                             mt+1 =                                    -(1+)
                                                                                            .     (49)
                                              t+1             t+1                I
                                      Et      t               t                 Rt +1   .


The expectation in the denominator is a time-t random variable, so it fits in to the rubric of (47).
                             I
This discount factor prices Rt                                  e
                               +1 and all zero cost portfolios Rt+1 so it prices all returns Rt+1 .

       However, the point of this model is to separate the economics of time and risk. Therefore,
it may be clearer to examine its implications for risk premiums via (46) or (48) and separately to
examine its investment returns, rather than to cloud the latter economics by constructing the
grand discount factor of (49).
       The expectation in (43) is unconditional, as in the sum constraint (31). The Appendix
considers whether the expectation in (43) should be conditional, Et (·), unconditional, E (·) or
somewhere in between E (·), 0 <  < t. The distinction matters for the dynamic properties
of the chosen t given a discount rate process, but it makes no difference to the discount rate
formulas here. In the Appendix, I conclude that an unconditional or  << t formulation is more
reasonable. Absent serially correlated natural productivity , a conditional constraint leads to a
productivity level proportional to discount factor growth, and thus to a productivity level that
is poorly serially correlated. An unconditional constraint or  << t more naturally produces
serially correlated productivity and a one period discount factor mt+1 related to productivity
growth. The unconditional constraint also generalizes more easily to continuous time.
       We can write the constraint E (t+1 /t+1 )1+  1 recursively as

                                                                     1
                                                        1+          1+
                                              t+1
                          zt,t+1 =   Et                                                           (50)
                                              t+1
                                                                            1

                        zt-j,t+1 = Et-j (zt-j +1,t+1 )1+
                                                                           1+
                                                                                ; j = 1, 2, ...   (51)
                                                                                        27


                         z,t+1 = 1.                                                             (52)


A specification  < t thus amounts to applying the productivity-choice idea to the constraint
itself. The firm can take actions at t - 1 to loosen the time-t constraint on t+1 in one time-t
state, though tightening that constraint in another time-t state. The firm may begin the process
of adjusting the time-t+1 productivity anytime after  , as captured by evolution of state variables
zs,t+1 as s proceeds forward.
       The firm's actions to transform across states of nature involve time. The farmer plants
seeds in different fields in the spring, but after that there is little he or she can do to transform
fall output across weather states. The electric utility buys flexible or fuel-optimized equipment,
but after that there is little it can do to transform output across states indexed by fuel costs.
It makes sense to allow the firm more flexibility across states of nature if it has more time to
rearrange things, and less flexibility as the time of a shock approaches. The  < t specification
allows that idea. Ideally, we would like to capture the changing difficulty of making choices as
the data approaches, by adding  shocks to the z choice in (51), or by varying the value of  over
horizon.



6.4   More detailed production processes

More complex and realistic models of intertemporal production make the formula for the invest-
ment return RI more complicated. They also change the discount factor for zero-cost portfolios
to the extent that variable inputs such as labor show up in the production function.
       For example, add adjustment costs and variable labor supply to the intertemporal pro-
duction function. The firm's problem is now

                                          
                                 max E         t-1 t (yt - it - wt nt )
                                         t=1


subject to


                                      yt = t f (kt , nt ) -  (it , kt )

                                   kt+1 = (1 -  )kt + it


and either
                                                               1+
                                                         t+1
                                 E (1 - )            t               1                          (53)
                                                         t+1
                                               t=0
         28


or
                                                            1+
                                                     t+1
                                         1 = E                     .                                 (54)
                                                     t+1

       The intertemporal first-order condition becomes

                         t+1 fk (kt+1 , nt+1 ) - k (it+1 , kt+1 ) + (1 -  ) [1 + i (it+1 , kt+1 )]
           1 = Et mt+1                                                                               (55)
                                                     1 + i (it , kt )

which we can write as usual
                                                        I
                                           1 = Et mt+1 Rt +1 .


We now have a labor first-order condition,


                                       t+1 fn (kt+1 , nt+1 ) = wt+1 ,


and productivity choice, either

                                                                         t+1
                              t+1 f (kt+1 , nt+1 ) =  (1 + ) (1 + )      1+                          (56)
                                                                         t +1


with the single sum constraint (53) or

                                                                        t+1
                                t+1 f (kt+1 , nt+1 ) = t+1 (1 + )       1+                           (57)
                                                                        t +1


with the period by period constraint (54).
       Relative to the cases with no labor and adjustment costs, (34) and (45), the productivity
choice conditions (56) and (57) differ by the generalization f (kt+1 , nt+1 ) in place of f (kt+1 ). This
substitution adds employment or wage to the discount factor formula, just as in the one-period
model with labor. Adjustment costs would also enter the discount factor formula if we wrote
productivity to multiply them, i.e. yt = t [f (kt , nt ) -  (it , kt )]. From (56), the sum-constraint
model's discount factor is similar to the forms (35),

                                                                        -1           -(1+)
                             t+1          t+1        f (kt+1 , nt+1 )          t+1
                   mt+1 =        =
                             t            t             f (kt , nt )           t
                                      1+            -1           -(1+)
                               t+1           yt+1         t+1
                         =                                               .                           (58)
                               t              yt          t

Using a Cobb-Douglas production function

                                                       1- 
                                           f (k, n) = kt +1 nt+1
                                                                                                              29


we can write the first expression of the sum-constraint model's discount factor as

                                                      -(1- )              -                   -(1+)
                                t+1          kt+1                nt+1               t+1
                   mt+1 =                                                                             .            (59)
                                t             kt                  nt                t

Using the first-order condition for labor input,

                                             1-  -1
                                        t+1 kt +1 nt+1 = wt+1 ,


we can write the same discount factor in terms of wages,
                                                                            
                                       - 1-               -1                                  -(1+)
                              t+1                kt+1            wt+1      1-       t+1
                  mt+1 =                                                                                  .        (60)
                              t                   kt              wt                t

       From the separate-constraint first order condition (57) we can write similar zero-cost
portfolio discount factors. The one-period formulas (25) and (28) remain valid, just add time
t + 1 subscripts. Growth rate formulas are likely to be more useful, e.g.

                                                                 -              -(1+)
                                        t+1            nt+1            t+1
                         mt+1   = bt                                                      ,                        (61)
                                        t               nt             t
                                                1+               -1                 -(1+)
                                        t+1              yt+1             t+1
                         mt+1 = bt                                                            ,                    (62)
                                        t                 yt              t

or                                                                    
                                               - 1-                                  -(1+)
                                       t+1                wt+1       1-    t+1
                       mt+1   = bt                                                                .                (63)
                                       t                   wt              t
where bt can be set as convenient.
       (Equation (63) seems to offer the possibility of a discount factor negatively correlated with
productivity. However,  > / (1 -  ) is the condition for a convex problem. Otherwise, the firm
chooses all of its production in one state. I have left implicit the restriction   0.)
       Measuring productivity is hard. Belo (2006) investigates a CES production function
                                                                                 
                                                 -1                        -1    -1
                              yt = t (kt )            + [(1 -  ) nt ]                 .


Using this definition and the first-order condition for labor, one can impute productivity from
the labor share and labor/output ratio, without needing capital data,
                                                                  
                                            1           wt n t    -1      yt
                                     t =                                        ,
                                         (1 -  )         yt               nt
          30


or in growth rates,
                                                                
                              t+1       wt+1 nt+1 /yt+1         -1   yt+1 /nt+1
                                  =                                                  .                         (64)
                              t            wt nt /yt                   yt /nt
Substituting these expressions into (58) or (62), we obtain a discount factor with output growth,
labor share growth, and labor/output ratio growth as factors, and no explicit productivity, e.g.

                                           (1+)                      1+
                                                                                     -1            -(1+)
                    wt+1 nt+1 /yt+1         -1         yt+1 /nt+1             yt+1        t+1
           mt+1   =                                                                                        .   (65)
                       wt nt /yt                         yt /nt                yt         t

       An important bottom line: as we make the production function more detailed and realis-
tic, a wide variety of production variables, not just productivity , enter the discount factor. Now,
as in the case of labor input, these variables are also chosen given the discount factor and pro-
ductivity shock, so in principle they do not offer additional information and a multifactor model
is not needed. But wages here induce independent movement in labor input. The situation is
much like that of multiple nonseparable goods u(ca , cb , ...) in consumption theory, where their
relative quantities or relative prices enter the discount factor.




6.5   Constraints on net output

We might also go back to first principles. To extend the production-based asset pricing idea to
multiple dates, why not proceed exactly in analogy to consumption-based asset pricing? Rather
than apply analogues to consumption-based asset pricing to the choice of productivity, as I have
done so far, why not apply those analogues to the firm's final output net of investment directly?
Microeconomics textbooks treat production and consumption with beautiful symmetry. Why
not us?
       We can write the firm's two-period problem as

                                                                                          1
                                                        1+                    1+         1+
                                                  c0                     c1
                   max c0 + E (mc1 ) s.t.                    + E                               K,              (66)
                                                  0                      1

where c denotes the firm's final output sold to consumers, i.e. c = y - i, and K is a constant. This
production set is concave and smooth across time and across states of nature.
       Explicitly, in the finite-state case, the firm's problem is

                                                                                                    1
                                                          1+                                  1+   1+
                                                   c0                            c1 (s)
          max c0 +         (s)m(s)c1 (s) s.t.                  +          (s)                            1.
                      s
                                                   0                 s
                                                                                 1 (s)
                                                                                                                 31


The first-order conditions to this problem lead to

                                                                              -(1+)
                                                            c1          1
                                            m1 =                                          .                           (67)
                                                            c0          0

The parallel to power utility is immediate.
         We can generalize this approach to multiperiod problems and continuous time transpar-
ently,
                                                                                                    1+
                                      t-1                                                     ct
                     max E                  t ct s.t. E (1 - )                      t-1                   1,          (68)
                                                                                              t
                             t=1                                             t=1

and
                                                                                              1+
                                                                    1                 ct
                       max E             t t ct dt s.t. E                         t                 dt  1.
                                   t=0                                      t=0       t

We are used to Dixit-Stiglitz aggregators across goods. This formulation applies the same idea
over time. The resulting discount factor is simply

                                                                                                     -(1+)
                                ct                          t+1              ct+1             t+1
                      t =       1+ ; mt+1 =                     =                                            .        (69)
                               t                            t                 ct              t

We have an output-based macro-factor model, not one based on productivity. That productivity
loomed so large in the previous analysis was entirely a modeling choice.
         Writing analogues to nonseparable utility that distinguish transformation over time from
transformation across states of nature is straightforward as well. We can quickly write an Epstein
and Zin (1989) style recursive non-state-separable constraint on final net output,

                                                                                                    1
                                                                        1+                         1+
                                                             ct+1
                               Rt+1 = (1 - )                                    +   Wt1+
                                                                                      +1
                                                                                         
                                                                                                                      (70)
                                                             t+1
                                                                  1
                                            1+
                                   Wt = Et Rt +1
                                                                 1+
                                                                        .                                             (71)


Again, the discount factor will include the state variable Rt+1 as in (40).
         We can write a CES constraint that separates time and risk by simply aggregating over
time and states with different coefficients,
                                                                                         1+
                                                                             1+          1+
                                                      t-1             ct
                               (1 - )                        E                                  1.                    (72)
                                                                      t
                                             t=1
          32


Then we obtain                                                                -
                                                                   1+        1+
                                                              ct                   ct
                           t = (1 - ) (1 +  ) E                                   1+
                                                              t                   t

and                                                       -
                                                  1+
                                                         1+
                                         ct+1
                                 E
                                                        
                                         t+1
                                                                                    -(1+)
                                                               ct+1          t+1
                      mt+1 =                    1+
                                                                                            .            (73)
                                          ct                    ct           t
                                  E
                                 
                                          t
                                                        

Zero-cost portfolios can still be priced using (69). But E (m) = 1/Rf is now distorted by the first
term in brackets of (73). Intertemporal transformation and risk-transformation are separated.
       Incidentally, similar CES preferences seem like a useful alternative to recursive prefer-
ences for consumption-based asset pricing. Write the consumer's objective

                                                                   1-
                                                              -
                                                       t E c1
                                                                   1-
                                        max                 t
                                                t=0


The consumer's first-order conditions lead to

                                                            -
                                                       -
                                               
                                                  E c1
                                                           1-
                                                                             -
                                                     t+1              ct+1
                                  mt+1 =                   
                                                  E c1 -               ct
                                                     t


The first term distorts intertemporal substitution relative to risk aversion, a main goal of recur-
sive utility. Consumption to a power still describes risk aversion, so zero-cost portfolios do not
require (or allow) computation of the utility index that makes recursive utility complex and fun.
       Why not describe production sets in terms of net output, following this more elegant ap-
proach to production-based asset pricing? One answer is that we then lose the connection to
standard production theory. A standard intertemporal production function, say


                                          yt = t f (kt )                                                 (74)

                                       kt+1 = (1 -  )kt + (yt - ct )                                     (75)


does not have a pretty representation in terms of final output c = y - i. Derivatives dct+1 /dct =
t+1 fk (kt+1 ) + (1 -  ) are well defined, and dc2      2
                                                 t+1 /dct < 0. But the resulting production set

is not expressible as a CES aggregator of final output {ct }, or any other pretty functional form
g (c0 , c1 , ...) = 0 that invites generalization to include states ct (s) in parallel with time ­ or at least
I have not been able to express it in such a way and find that generalization.
       So, we can follow elegance, and the beautiful symmetry of static utility and production
                                                                                          33


theory exactly. But in so doing we throw out the contact with classic production theory, and in
particular with the successes of investment-return based asset pricing and all existing general
equilibrium macroeconomics and asset pricing. Alternatively, we can add productivity choice
to standard production theory as I have so far, and express production-based asset pricing as a
constraint on productivity rather than final output. That choice leads to a less elegant but pos-
sibly more productive result. But perhaps better ways can be found to write smooth production
sets integrating time and risk, and to connect them to the lessons of classic production theory
without throwing the latter out and starting over.
      However, there may also be good reason to abandon the symmetry between time and
state. The underlying economic stories are quite different. We think of transformation over time
with a story captured by the usual symbols ­ some output is put aside or invested to become
capital that later produces more output. We think of transformation across states by stories
such as planting in fields with different state-sensitivities, investing in machines with different
sensitivities, and so on. Perhaps keeping time and risk separate is wise, if inelegant.


6.6   Durability-like dynamics

These extensions to dynamic problems are not as pretty as I would like them to be. Funda-
                                                       1+
mentally, the constraints E (1 - )         t
                                       t=0  (t+1 /t+1 )        1 or E (t+1 /t+1 )1+  1 allow
completely different random variables t at each date t. One would suppose that the distribution
of productivity at time t cannot not be that different from the distribution of productivity at time
t +. In the farming and electric utility examples, the choice of fields and machines do not allow
one exposure to shocks at one instant, and a different exposure 10 minutes later.
                                                                      t
      The situation is similar in utility theory. Preferences E   t=0  u(ct ) or E   et u(ct )dt allow
the consumer to rank consumption processes with completely different distributions at each
point in time, a particularly frightful prospect in continuous time.
      In both cases, this is not typically a practical worry. If circumstances ­ the discount factor
t , natural productivity t ­ evolve continuously over time, so will the choice t . If we invert to
find discount factors as a function of choices that vary continuously over time, and whose esti-
mated distributions vary continuously over time, we will find discount factors that vary continu-
ously over time. So the model will not generally produce crazy predictions. Still, the description
of production sets is inelegant.
      The resolution of this sort of puzzle for consumption is to recognize that all consumption
goods are durable at short enough horizon. Even a pizza is durable for 10 minutes (Hindy and
Huang (1992).) This modification tends not to be used however, because the first-order condi-
           34


tions for durable goods are more complex. While solving models with durable goods is a simple
exercise, doing so violates the philosophy of consumption-based pricing, to read discount fac-
tors from first order conditions without solving models.
         A similar situation applies to production sets. We would like a productivity-choice set in
which productivity at nearby dates must have similar distributions. The distributions can then
more easily diverge from each other as the time between production events increases. Doing
so, however, complicates the first-order conditions. Changing productivity t at time t now in-
fluences the set from which future productivity t+s is chosen. Future discount factors as well
as current ones enter the choice of t , and inverting to find discount factors from productivity
choices involves unwinding that intertemporal choice ­ just as it does for durable consumption
goods.
         To explore this idea in a simple environment, suppose we write the choice set as a con-
straint on the growth of productivity:

                                                           1+
                                               t+ t
                                     E           /                1.                            (76)
                                               t+ t

Analogously, with no depreciation, a durable purchase changes the flow of consumption ser-
vices. This specification is equivalent to writing a natural shock t+ that includes the previous
actual productivity t , as part of the natural starting point. If one buys machines with a given
state-contingent output, then the natural starting point for next period is just to use those ma-
chines. Specification (76) also leads to a natural continuous-time expression,

                                                           1+
                                               d (t /t )
                                     E                           = 0.                           (77)
                                                 t /t

Specifications (76) or (77) result in productivity t that wanders further away from its initial value
0 , and from the underlying shock t , for a longer time horizon.
         So far so good, but the first-order conditions become more complicated, because chang-
ing t changes the choice set for all subsequent t+s . The resulting first-order conditions are
harder to unwind to a discount factor. With a constraint on the growth of productivity (76), the
firm's problem is
                                         
                                 max E         t-1 t [t f (kt ) - it ] s.t.
                                         t=1

                                         kt+1 = (1 -  )kt + it
                                                                                                35


                                                            1+
                                                t+1 t
                                         E         /               1.
                                                t+1 t

Now the first-order condition with respect to t+1 is

                                              t+1 t
                                                    1+                           1+
                                                                                 t+2
                                                                                    
                                                                                              2+
                                                                                              t+1
                                                                                                 
           t-1 t+1 f (kt+1 ) = t (1 + )       1+  / 1+        - t+1 (1 + )Et+1   1+       /   1+     .   (78)
                                              t +1 t                             t +2         t +1


We can use (78) recursively to write the productivity-choice first-order condition as

                                                                                 1+
                                                                         t+1 t
                            Et+1 j -1 t+j t+j f (kt+j ) = t (1 + )          /         .
                                                                         t+1 t
                     j =1


In this form you can see more clearly that increasing t+1 at time t + 1 makes the constraints
easier for all future times, and thus has a present discounted benefit.
         In these first-order conditions, you see effects similar to those of internal habit or durable
goods models. For writing simulation or general equilibrium models, or even for estimation,
they are not hard to implement. But inferring the discount factor from productivity is not as
pretty as in the time-separable cases. A state variable, parallel to the stock of durable goods,
would help.
         Putting these thoughts together, a useful way to describe the choice of technology may be
to let the firm change its technology shock distribution, but at a cost. For example, let technology
follow
                                                yt = et f (kt )
                                               dkt
                                                   = -kt + it .
                                               dt
Let there be a vector of shocks dzt = [dz1t dz2t ...dzN t ] , and productivity responds by


                                             dt = µt dt + t dzt .                                        (79)


The discount factor responds to the same shocks,


                                          dt = µt dt + t dzt .


The firm maximizes the contingent claim value of output,

                                                
                                     max E           t t (yt - it - t ) dt
                                               t=0
         36


where t are the costs of adjusting the technology shock distribution. If the firm does nothing,
technology will evolve as usual as described by (79). However, the firm can adjust the distribu-
tion of technology, at a cost,

                                                 1+       N                  1+
                                          dµt                     dtj
                                 dt =                 +               /j
                                           dt                      dt
                                                          j =1


We can even let the vector of cost weights move over time,


                                           dt = µt dt + t dzt .


       This direction may give an interesting dynamic model of productivity choice. It generates
a marginal rate of transformation for discrete time intervals, as the firm can get to any  . But
it does not seem to lead to an analogue to consumption-based asset pricing, so I do not follow
this lead here.




7. General equilibrium, identification and calibration


The discount factors we have studied focus on powers of productivity growth, for example,

                                                                       -(1+)
                                                 t+1             t+1
                                   mt+1   = bt
                                                 t               t

and
                                                 1+               -1           -(1+)
                                          t+1           yt+1           t+1
                          mt+1 =                                                             (80)
                                          t              yt            t
as well as other production-related macroeconomic variables including labor, capital, wages,
and investment. Will these or similar specifications of such a production-based model be em-
pirically successful? This section takes up this question, as well as the troublesome question of
whether and what kinds of natural productivity shocks  we need, and how to identify them.
       We know from Hansen and Jagannathan (1991) and its many extensions such as Cochrane
and Hansen (1992) several properties that a successful discount factor must have. The basic as-
set pricing formula for excess returns 0 = E (mRe ) implies that the expected return is propor-
tional to the covariance of returns with the discount factor,

                                                        cov (m, Re )
                                          E (Re ) = -                .                       (81)
                                                          E (m)
                                                                                        37


This relation implies
                                    E (Re )     (m)
                                            =-       (m, Re ).                                  (82)
                                     (Re )     E (m)
To generate the market Sharpe ratio of about 0.5, the discount factor must be volatile, with  (m)
on the order of 0.50 or more. That requirement has posed a challenge for consumption-based
asset pricing, as consumption itself has a much lower than 50% volatility, and very high risk
aversions  are hard to swallow. It is hard to generate  [(ct+1 /ct )- ] on the order of 50%.
       Output, productivity and employment are more volatile than consumption, however, and
we have little a-priori feeling about the production curvature coefficient . This paper is devoted
to lowering  from its previously standard value,  = . So it is likely that achieving a high  ( )
will not be difficult, and the classic equity premium puzzle does not cause an obvious problem
for production-based asset pricing. More deeply, since marginal rates of transformation don't
have any natural relationship to probabilities, the natural force towards risk neutrality is missing.
Easy simulation models tend to produce equity premiums that are too high.
       The discount factor should have a low and fairly stable conditional mean, to generate a
                                                         f
low and relatively stable real riskfree rate Et (m) = 1/Rt . In all these models, the level of re-
turns and riskfree rate are governed by conventional investment-return economics, separate
from risk premiums, so the model really has nothing new to say about the level of the riskfree
rate. The sum-constraint discount factor (80) does predict a risk free rate. But in the model, the
firm chooses productivity  so that investment returns are correctly priced so again the model
as a whole has nothing new to offer. The data may violate that restriction. However, the growth
rates in (80) are stationary and not severely serially correlated, so there is not an immediate
problem of risk free rate variability. Since productivity is more volatile than consumption, an
equity premium is not likely to require an enormous value of  and hence an enormous E (m)
via E (t+1 /t )1+a . And the framework, with additional right hand variables and especially the
free parameter  and growth in the  process beckoning, seems flexible enough to quickly adapt
to any problems with E (m).
       Relation (82) also holds conditionally, with time t subscripts. Risk premiums vary over
time. It is generally felt that time-varying conditional variance, t (mt+1 ) should vary over time,
                            e ) operates on a different time scale and in response to different
as conditional variance t (Rt +1
                                                    e ) are a headache. A time-varying variance
variables, and time-varying correlations t (mt+1 , Rt +1

of productivity  may be plausible, time-varying opportunity sets t may be plausible, and one
can imagine mechanisms parallel to habits in preferences that generate variation in t endoge-
nously.
       The most obvious obstacle, however, is the sign of the covariance term in (81). To gen-
           38


                                  e ), the discount factor m
erate a positive risk premium E (Rt +1                       t+1 must covary negatively with
                           e . In consumption-based asset pricing, m                   -
the ex-post excess return Rt +1                                      t+1 =  (ct+1 /ct ) , the

positive correlation of consumption growth with asset returns is consistent with this negative
correlation of the discount factor with asset returns and a positive risk premium. That model's
failure is one of magnitude, not of sign. In production-based asset pricing we have mt+1 =

(t+1 /t ) (t+1 /t )-(1+) , however, with  > 0. If there are no natural productivity shocks ,
productivity growth t+1 /t is positively correlated with the discount factor. A positive correla-
tion of productivity growth with asset returns Re predicts counterfactual negative risk premium
E (Re ).
       Intuitively, the discount factor, contingent claims price, or marginal utility is high in "bad
times," when consumption is low, the stock market is low, and people would really value a
marginal dollar. A firm without a , without a bias to one state or another, will rearrange its
output to produce more in such high-price "bad times" states.
       Now, there are many possibilities to avoid this conundrum. It presumes a one-factor
model in which consumption, productivity, and asset returns all move together. Maybe pro-
ductivity is higher in bad times. Whether productivity is procyclical or countercyclical is de-
bated in macroeconomics. (Measuring productivity is a headache too.) Yes, real business cycle
models generate recessions by procyclical productivity shocks, but the rest of macroeconomics
in the new-Keynesian DSGE tradition is essentially devoted to disbelief of that proposition. In
recessions, firms produce less, but they also shed workers and machines ­ and especially unpro-
ductive workers and machines (Grigsby (2020)). Varying composition, factor utilization, effort,
and labor hoarding cloud the productivity picture.
       Already, output enters discount factors (58) and (59)) with the "right" negative sign, as do
labor input and capital growth. Maybe even if productivity growth is positively correlated with
asset returns a rich enough model's discount factor will be negatively correlated with returns,
without underlying  shocks. Perhaps in a dynamic model, shocks  that vary across time but
not states of nature are sufficient to produce the observed moments.
       Moreover, asset returns, productivity and consumption are not perfectly correlated. Maybe
large components of asset returns are not related to the business cycle, so asset returns can be
negatively correlated with productivity. Asset returns contain multiple orthogonal priced fac-
tors past the market, including value, size, momentum, term spread, default spread, and others.
Maybe productivity is correlated negatively with these additional factors, generating their pre-
miums at least, if not the market premium.
       Furthermore, the production-based discount factor formula applies to each firm, as the
                                                                                        39


consumption-based discount factor applies to each individual. But, unlike the consumption
case, we have detailed data on individual firms, industries, and sectors. The philosophy of
production-based asset pricing already says to take these detailed data seriously, and construct
many investment returns at a disaggregated level. Who knows where disaggregated information
about production-based discount factors using firm-level productivity will lead.
      Still, it is unpleasant that the basic model seems to produce the wrong sign. The simplest
answer is to include natural productivity shocks . A model driven, at least predominantly, by
natural productivity shocks  and not preference shocks will produce the "right" sign ­ at the
cost that now we must face the problem of how to identify natural productivity shocks .
      If there is a high productivity shock , other things constant, firms will choose higher pro-
ductivity  in that state. Consumers will consume more in that state, driving down the discount
factor or contingent claim price of that state. This lower price causes firms to back off ­ to raise
productivity  somewhat less in the high-, low-price state, and to lower productivity somewhat
less in low-, high-price states. But the product m = (t+1 /t ) (t+1 /t )-(1+) still moves nega-
tively with , so the discount factor moves negatively with productivity, consumption, and asset
returns, despite the positive coefficient .
      By analogy, strawberry prices are higher in the winter, yet farmers produce fewer of them.
Well, winter is a bad time for producing strawberries. Producers do what they can, building
hothouses or growing strawberries in Chile. So they move production towards the high price
state. But we still observe higher prices in times of lower output. We also can observe that the
price of strawberries is equal to the marginal cost of producing them, and write a production-
based strawberry pricing model. But in doing so, we must recognize that the strawberry market
is dominated by natural productivity shocks, not preference or sentiment shocks.




7.1   A simple general equilibrium economy

To validate and flesh out this story, focusing on the novel and risk premium parts of these prob-
lems, I consider a general equilibrium of the simplest one-period model, with a preference shock
 as well as a natural productivity shock . I present the model in this subsection, and analyze
the central equilibrium conditions in the next subsection.
      Add consumers with utility


                                     Eu(c) =         (s)u [c(s)]
                                                s
           40


where
                                                 (c/)1- - 1
                                        u(c) =              .
                                                    1-
Marginal utility is
                                                c-   c(s)-
                                      u (c) =      =       .
                                                1-   (s)1-
The variable  is a preference shock. For each c(s), higher (s) lowers utility. For  > 1, higher 
raises marginal utility. Thus a higher  is a negative preference shock.
         Consumers own the firms, and thus have a contingent claim that pays a random amount
e. The consumers' budget constraint is


                                          E (me) = E (mc).


The consumers' first-order conditions are


                                     m = c u (c) = c c- /1-                                 (83)


so consumption is
                                                  1       -1       1
                                                 -             
                                          c=m                  c .

Evaluating c via the budget constraint, the full solution to the consumer's problem is

                                                          1         -1
                                                         -
                                                      m             
                                      c = E (me)                    -1   .                  (84)
                                                   E (m)            




         Producers have a stock of capital with f (k ) = 1. They maximize

                                                          1+
                                   E [mf (k )] s.t. E                     1.
                                                          1+

Producers' first-order conditions are
                                                         
                                             m=                .                            (85)
                                                      1+
Using the constraint to eliminate the Lagrange multiplier , the solution to the producer's prob-
lem is
                                                      m
                                      =                                      .
                                                          1+           1+
                                             E (m)         



         In equilibrium, consumers own the firm so their endowment equals the firm profit, e = ,
and consumption equals output, c = . This equality is an important limitation of this static
                                                                                              41


analysis. In a dynamic model, equilibrium requires ct = yt - it .
           We can find the equilibrium from the planning problem

                                                  1-
                                              c                        c   1+
                                 max E                     s.t. E                      1.
                                                                       

The first-order condition is
                                                  c-     c
                                                     = p 1+ .                                      (86)
                                                  1-    
Imposing the productivity choice constraint to eliminate the Lagrange multiplier p , the full so-
lution of the planning problem is5
                                                                  
                                                    (1+)(1- )
                              1                                    + 1 +  log  +  - 1 log .
                                                       +
                                                                  
                   log c = -    log E                                                              (87)
                             1+                                    +             +


The constant is not interesting for us, however, so I suppress it below.
           Using either discount factor formula (83) or (85), the equilibrium discount factor is

                                                      1+         -1
                              log m = const. -           log  +     log .                          (88)
                                                      +          +

           A claim to consumption, or the output of the firm, has price p = E (mc) = E (m) and thus
excess return
                                                       c     1
                                             Re =         -      .
                                                    E (mc) E (m)
In this model the return is perfectly positively correlated with consumption. Scaling by the risk




   5
       Algebra: From (86),
                                                                       1
                                                  - 1         1+       +
                                             c=   p +
                                                              1-
and
                                                                    (1- )(1+)
                                                      1+
                                         c   1+      - +               +
                                                  = p                             .
                                                                 
Imposing the constraint.                                                      
                                                                  (1+)(1- )
                                             - 1+                    +
                                       1=    p +     E                        .
                                                       

Substituing out p ,
                                                              -    1
                                                  (1+)(1- )       1+              1
                                                     +                 1+         +
                                  c=E                                                  .
                                                                       1-
         42


free rate to obtain a quantity independent of the level of the discount factor m,

                                     E (Re )   E (m)E (c)
                                        f
                                             =            - 1.
                                      R          E (mc)

Assuming normal distributions, the risk premium of the consumption claim is

   E (Re )      1+           -1                 1+       -1
           =  2    log  -  2    log  + ( - )cov    log ,    log  .                             (89)
    Rf          +            +                  +        +


7.2   Identification and measurement

In sum, consumer and producer first-order conditions are (83) and (85),


                               log m = const. -  log c + ( - 1) log                            (90)

                               log m = const. +  log  - (1 + ) log .                           (91)


To clarify the formulas, let

                                     1+         ( - 1)
                                        log ;          log .
                                     +           +

The equilibrium is then given by (87) and (88),


                                 log c = log  = const. +  +                                    (92)

                                       log m = const. -  +  .                                  (93)


Equation (89) gives the equilibrium risk premium,

                          E (Re )
                                  =  2 ( ) -  2 ( ) + ( - ) ( ,  ).
                           Rf

If we run a regression log m =  log  + u , the coefficient is

                 (log m, log )       2 ( )      2 ( )            ( ,  )
           =                   = - 2       
                                            + 2       
                                                       + ( -  ) 2       .
                    2
                    (log )         ( +  )     ( +  )            ( +  )

       Now, what do we see? Suppose there are no preference shocks , and only by natural pro-
ductivity shocks . Consumption and productivity rise with the shock, and the discount factor
declines. The equity premium is positive. The data trace out log m = const. -  log  with no
error. The coefficient of the regression of log m on log  is - . Data trace out the marginal rate of
substitution curve and identify risk aversion  , for any .
                                                                                        43


      How did we lose the production-based discount factor and ? The production-based dis-
count factor formula (91) is still there. However,  and  are perfectly correlated in equilibrium.
To use the production-based discount factor in this economy, we would have to account for the
movement in  correlated with productivity .
      That insight offers an important parable for what we may see in the data. Several papers,
discussed in the literature review below, use ad-hoc discount factors based on productivity, and
find such that variables such as productivity growth form useful discount factors, but with neg-
ative coefficients, not  > 0. If underlying productivity shocks dominate, then although the
discount factor has a positive and structural coefficient on productivity, in (91), an approximate
discount factor that uses productivity but does not (somehow) control for the shock , will see a
negative coefficient.
      Likewise, if there truly were no preference shocks, then  and  would be perfectly corre-
lated, and our formulas ignoring  would perfectly measure the discount factor. The only trouble
is that the estimated coefficient would have the wrong sign, relative to the prior that  should be
positive. Or, for any , we could use  to measure .
      Suppose instead there are preference shocks  and no underlying technology shocks .
For the realistic  > 1 case, equilibrium consumption in rises with the preference shock, but the
discount factor also rises with the preference shock, so the discount factor is high when con-
sumption is high. The equity premium is negative. On the bright side, the production-based
formula correctly measures the discount factor, with no correction at all for the underlying pref-
erence shock. Data trace out the marginal rate of transformation curve and identify production
curvature , for any value of risk aversion  . The coefficient in the regression of log m on log c or
log  is . But the positive equity premium, as well as common sense, suggests there are at least
some underlying productivity shocks.
      In reality, then, we likely see a mixture of preference and productivity shocks. The regres-
sion coefficient is a mongrel combination of ,  , and shock variances and covariances.
      To identify , we need to find preference shocks that are orthogonal to the natural pro-
ductivity shock, or we need to restrict or measure the natural productivity shocks. To construct
a production-based discount factor we have somehow to control for or measure the natural pro-
ductivity shock. Below, I review a clever restriction by Belo (2010) that measures , and I discuss
identification and other ways to avoid  problems.
      This shock and parameter identification issue is not special to production-based asset
pricing. It has important lessons for investor-based asset pricing as well, where in that term I
include behavioral and institutional finance.
          44


        Traditional consumption-based models just assume away preference shocks. The empir-
ical difficulties of the consumption-based model, and the imprecision, instability, and counter-
intuitive values of risk aversion  it reports suggest that preference shocks may indeed be part of
the story.
        Preference shocks are increasingly popular in both finance and macroeconomics. Many
new-Keynesian models now include preference shocks, at least as a stand-in for financial in-
termediation shocks. For example, typical models of the 2008 financial crisis start with a shock
to the representative consumer's discount subjective discount factor  . Changing risk aversion
is sometimes modeled as a preference shock. And behavioral finance is all about preference
shocks. "Sentiment" or irrationally assessed probabilities are equivalent to preference shocks
such as .
        All these observations give us some comfort that there are some preference shocks, which
can be used to identify productivity choice, and allow us to see productivity choice respond to
preference shocks.
        But models with preference shocks will suffer exactly the same identification problem as
a production-based model with dominant technology shocks. The shocks and the endogenous
variables will be correlated. To identify  here, we need to find a productivity shock that is or-
thogonal to preference shocks.
        Moreover, the positive equity premium argues that productivity (and whatever complex-
ities of the production process that stands for) rather than preferences (and whatever complexi-
ties the latter stand for, including intermediation and time-varying irrational probability assess-
ments) must be the dominant shock driving the joint behavior of asset returns and macroeco-
nomic fluctuations. Estimates of  and coefficients of discount factors related to production
variables may be unstable mongrels, but they are negative mongrels. This trouble ought to
be particularly salient for behavioral finance and intermediary asset pricing, which explicitly
posits that preference shocks are a central driving mechanism. As a concrete example, see Al-
buquerque et al. (2016) for preference shocks in a detailed macro-finance model, and Kruger
(2019) for critique that it misses important moments.
        This discussion also reminds us that while production and consumption based asset pric-
ing each exploit the wonderful GMM philosophy of examining one side of the market in isola-
tion, identification requires us to think about general equilibrium and what causes variables to
move.
                                                                                        45


7.3   An endowment-economy analogy for production-based asset pricing

This sort of general equilibrium excursion helps us to understand the problems we will face
when confronting data, and what kind of measurement or identifying assumptions for shocks
 and  might be useful. However, the guiding philosophy of a production-based asset pricing
model is to avoid computing a general equilibrium. Figure 4 illustrates the idea.

                     2.5




                      2



                                                    Fixed-coefficient preferences
                     1.5
               (l)




                      1



                                Endowment
                     0.5

                                                                       m

                      0
                           0   0.5   1      1.5    2       2.5     3       3.5      4
                                                   (h)


Figure 4: General equilibrium. The outward-bowed curve is a shock-choice set E (/)1+  1
with  = 1,  = [2, 1]. The inward-bowed curve is an indifference curve for a power utility
consumer with u = (c/)1- ,  = [5, 1],  = 2. The dashed lines give equivalent endowment
economies, i.e. fixed shocks  or fixed-coefficient preferences that deliver the same equilibrium
quantities and prices.m denotes the stochastic discount factor or contingent-claim price rato.



       One can approach data with a full general equilibrium economy, incorporating a pro-
duction function, productivity choice  and a utility function. Then one finds contingent claim
prices or the discount factor from the tangency point of marginal rate of transformation or sub-
stitution, represented by the straight line.
       Consumption-based asset pricing simplifies the computation. If one correctly models
the equilibrium consumption process as if it were an endowment, then one can still read asset
prices off marginal rates of substitution alone. Specifically, start with a general equilibrium with
natural productivity , a curvature parameter  and a chosen productivity . Construct a new
economy consisting of a fixed-proportions production function calibrated to the observed ,
         46


 =  = , and  = , but keeping preferences and the preference shock  =  unchanged.
This new economy has the same asset pricing implications as the old one, read off marginal rates
of substitution alone. In Figure 4 one can model the production side as the Northeast pointing
box outlined by the dashed lines, keep the indifference curve, and asset prices are unchanged.
       One can create an analogous production-based asset pricing model. Again, measure or
model the consumption or productivity process  = . Leave the production set alone, keeping
the same productivity shocks  =  and curvature  = . Marry this production process to
fixed-coefficient preferences. In place of the smooth utility function and preference shocks, let

                                                         c(h) c(l)
                                  u [c(h), c(l)] = min       ,     .                            (94)
                                                         (h) (l)

Then, measure contingent claim prices or the discount factor from the marginal rate of transfor-
mation alone. This new economy has the same asset prices and quantity implications as the full
general equilibrium ­ but spares the researcher having to model and measure the entire con-
sumption and intermediation side of the economy.
       Fixed-coefficient preferences (94) act like endowments. They generate a simplified gen-
eral equilibrium economy with the same asset pricing and quantity implications as the full equi-
librium ­ if one models the equilibrium consumption and productivity processes correctly. In
this way we can mirror the brilliant simplification that Lucas (1978) brought to consumption-
based asset pricing, or construct insightful simulation economies in the Mehra and Prescott
(1985) style.




8. A simple aggregation model


The main philosophy in this paper is to model the aggregated (smooth) production possibility
set directly, rather than to derive the structures of such sets from primitive traditional specifica-
tions. The primitives are typically unobservable, and, again, there was no particular reason for
specifying fixed patterns across states in the first place. However, it is useful as motivation, and
to help think about what a smooth production set might look like, to sketch a model in which a
smooth aggregated production set is derived from underlying traditional technologies.
       Consider a two-state world in which the firm has two technologies. For example, a farmer
can plant in two fields. One field does well in wet weather, the other in dry weather. The farmer
can then shape the risk-exposure of total output to weather by varying the amount planted in
                                                                                        47


each of the two fields. Let the technologies of field i be

                                               
                                yi (s) = i (s)ki ; s = h or l, i = 1 or 2.


Total output is then
                                   y (s) = y1 (s) + y2 (s); s = {h, l}

and total inputs are constrained by initial capital less initial sales,


                                                k = k1 + k2 .


       We want to know what this structure implies for the aggregates k and y (s). (Or, if we wish
to characterize the production set by outputs alone, y (0) = W - k and y (s).) Figure 5 plots the
answer. To produce the figure, I vary k1 from 0 to k = 1, I let k2 = k - k1 . Then, I calculate
                        
y (s) = 1 (s)k1 + 2 (s)k2 with 1 (h) = 2, 1 (l) = 1 and 2 (h) = 1, 2 (l) = 2. The far lower right
point on the curve, for example, puts all initial capital into technology 1 that does well in the
h state. The far upper left point puts all initial capital into technology 2 that does well in the
l state. The aggregate production possibility set is smooth. Free disposal allows the aggregate
production set to fill out the area indicated by dashed lines.
       For this construction to work ­ for the marginal rate of transformation y (h)/y (l) to exist,
so we can equate it to contingent claims price ratios y (h)/y (l) = p(h)/p(l) =  (h)m(h)/[ (l)m(l)]
for any such ratio ­ we need a spanning or invertibility condition, in this case that the matrix
                                                                
                                                1 (h) 2 (h)
                                                                
                                                1 (l)   2 (l)

is non-singular. If there are more than two technologies, we need the rank of a larger shock ma-
trix to be at least two, the number of states. We also need sufficient concavity of the underlying
production function f (k ). If not, the curve of Figure 5 is a straight line, and production ends up
at one of the corners for all but one contingent-claim price.
       For continuous-state economies, we subdivide technology into finer units of analysis.
Each square foot of land may have slightly different sensitivity to weather. Thus, consider tech-
nologies indexed by z , and states of nature indexed by  . Aggregate output is


                                      y ( ) =      dz(, z )f [k (z )]
           48


                       2.5




                        2




                       1.5
                y(l)




                        1




                       0.5




                        0
                             0   0.5          1            1.5          2            2.5
                                                    y(h)


Figure 5: Aggregate production set {y (h), y (l)} induced by two technologies, y (s) = y1 (s) + y2 (s);
              0.5 ; i = 1, 2; s = h, l; k + k = 1.
yi (s)  i (s)ki                          1   2




         Alternatively, and perhaps more elegantly, we can derive smooth production sets by al-
lowing the firm to vary its investment in a few technologies continuously over time, extend-
ing the classic Black-Scholes option pricing approach to multiple risky and concave investment
strategies.
         I do not belabor aggregation theory or spanning conditions, as the major point of this pa-
per is to write down smooth technologies directly, just as we write down aggregate technologies
y = f (k, n, ...) that are smooth across inputs rather than derive them from deeper fundamentals.
You can see from this discussion where such an aggregation theory would go.
         With this basic idea, you can see many potential microfoundations for active trade-offs
across states. The firm could invest in capital or R&D to shift its output across states ­ buying
solar cells, or multifuel engines, for example, change the distribution of profits across states
indexed by energy price shocks. And thinking about such aggregation stories may be a useful
way to improve on the description of shock choices in an intertemporal context, as outlined
above.
         The aggregation story emphasizes two points, however: First, technologies generated in
this way will vary only across states of nature that are related somehow to the production pro-
cess. The firm cannot transform output across states of nature that depend on a pure preference
                                                                                        49


shock, or other exogenous random variables such as who wins the Super Bowl. Second, since
probabilities do not enter the technology, probabilities do not enter the marginal rates of trans-
formation. There is no counterpart to the risk neutral benchmark in which marginal rates of
substitution are proportional to probabilities.




9. Literature


The idea of linking asset prices to quantities via producer first-order conditions, and thereby
studying the production side of the economy without having to specify preferences, goes back a
long way. My first effort was Cochrane (1988). This effort swiftly ran in to the problem outlined
in the introduction: standard production technologies do not give a marginal rate of transfor-
mation across states.
       This paper is a revision of the first part of Cochrane (1993). That paper introduced the
idea of choosing productivity form a set E (/)1+ . It sat a long time, as I hoped to complete
an empirical counterpart, compute general equilibrium examples, and cleanly solve the  shock
identification and measurement question among other needed improvements. This paper in-
cludes a much-improved dynamic extension, but does not achieve those other goals. Bringing
these sorts of models to data, or constructing simulation models that may be compared to data,
remains an important project, with numerous measurement, specification and identification
issues to face.
       Belo (2010) is the first to use this production technology with productivity choice empiri-
cally. Belo proposed a clever approach to the identification problem, which could (and should)
be generalized to larger and more disaggregated groups of investment returns. Discount factor
formulas such as m =  (i,t+1 /i,t ) (i,t+1 /i,t )-(1+) hold separately for each firm or industry,
just as mt+1 =  (ci,t+1 /ci,t )- holds separately for each individual i. Taking logs,

                                              i,t+1                          i,t+1
                        log mt+1 =  log               - (1 + ) log
                                              i,t                            i,t

separately for each technology i. (Belo uses  where I use 1+ .) Belo then assumes that multiple
technologies have a factor structure,

                                                           J
                                              i,t+1
                                 (1 + ) log           =          ij Fj,t .
                                              i,t
                                                          j =1
         50


With a single factor F , and two technologies 1 and 2, then,

                                                   1,t+1
                               log mt+1 =  log             - 1 Ft+1                          (95)
                                                   1,t
                                                   2,t+1
                               log mt+1 =  log             - 2 Ft+1 .                        (96)
                                                   2,t

Now, we can eliminate the latent factor F , to express the discount factor.

                                                   2,t+1                1,t+1
                    log mt+1 =          1 log              - 2 log              .            (97)
                                  1 - 2            2,t                  1,t

We observe log(i ) = log(yi ) - log f (ki ). Normalizing 1 = 1, we can estimate 2 .
       The model is identified, though we do not directly observe the natural productivity shock
. Intuitively, since the firms have different loadings on a common , they will choose produc-
tivity shocks  that are perfectly correlated, but one moves more than the other. Then the dif-
ference between the observed productivity shocks reveals the natural productivity shock. Or,
solving (95) and (96) for the shocks , those shocks move by the same amount in response to m,
but one moves more than the other in response to F . Thus, watching the differences between
the shocks, we can disentangle the two sources of  movement, m and F .
       The assumption is more compelling with more technologies. Across J technologies with
productivity j , there are J sources of unobserved movement j and one additional source of
movement m. Reducing the dimensionality of the j by only one via a factor structure assump-
tion, we can identify m. To generalize, we need a J - 1 factor structure of J technology shocks,
not a single factor structure. (Belo's online Appendix C pursues a J = 3 factor model.) The
essence of business cycles is common movement, and stock market returns display a strong fac-
tor structure, so the idea that multiple firm's productivities or other variables follow a reduced
factor structure is natural.
       Since Belo assumes yt = t f (kt ) with kt predetermined, he uses yt in place of t in (97).
The bottom line is a two-factor macro-pricing model, using output growth,


                                  log(m              1       2
                                       t ) = a - b1 yt - b2 yt .


This bottom-line result is the same form as the Cochrane (1996) investment-based model, and
many related ad-hoc macro-finance pricing models that use discount factors tied to macroeco-
nomic variables to explain cross-sectional variation in expected returns. But Belo derives that
otherwise ad-hoc model from the pure production-based pricing idea with the clever factor
structure assumption to identify natural productivity shocks. That it is similar to existing suc-
                                                                                          51


cessful ad-hoc models says it is robust. Belo also adds a relative price of output and investment
goods, which adds a second set of factors, and prices an up-to-date set of asset returns.
       Jermann (2013) uses the idea that with two investment returns, one can span two states
of nature, by pure arbitrage with no reference to preferences. In essence, he implements the
model of Section 8. He creates a two-state simulation model, which captures salient features of
the term structure. The trouble is, this approach is limited to simulation economies as reality
seems to have more states of nature than investment returns.


9.1   Investment returns

Standard technologies do not allow a general marginal rate of transformation. Firm first-order
conditions do, however, give rise to investment returns. Production-based asset pricing has to
date largely linked macroeconomics to asset pricing via investment returns.
       As outlined in Section 6, producer first-order conditions give rise to a physical return RI ,
measurable from investment, capital, output, and labor decisions (55). Any asset returns that
can be determined by arbitrage with the investment returns should be so priced. Equivalently,
the investment return should be priced by any discount factor, 1 = E (mRI ). When marginal Q
equals average Q, the firm's stock (or stock and bond) return should equal the investment return,
ex-post as well as ex-ante, a particularly clear instance of this arbitrage pricing result.
       With adjustment costs, the investment return is dominated by investment, and thus is ap-
proximately proportional to investment growth. As a result, models based on investment returns
are often called "investment-based asset pricing," and a cross-sectional extension (discussed
below) an "investment CAPM." As I have emphasized, this paper generalizes investment-based
asset pricing, keeping its central prediction 1 = E (mRI ).
       This effort was successful, at least compared to the widespread view that Q theory doesn't
work at all. Cochrane (1991) shows that an investment return based on aggregate investment
data is well correlated with stock returns at business-cycle frequencies, and that variation in
expected stock returns as forecasted by the dividend yield, term spread, investment to capital
ratio and other variables matches well variation in expected investment returns. Lamont (2000)
shows that measures of investment plans offer even better correlations. When stock prices rise
it takes time to put investment into motion, but investment plans move quickly. One could
also specify a time-to-build technology, but investment plans show the correlation quickly and
transparently. Unlike many theories, the investment-return approach works better for big move-
ments than small ones: the 1990s stock boom corresponded to an investment boom; the 2008
stock price plummet coincided with an investment collapse. (See Cochrane (2017) Figure 4.)
          52


       This branch of production-based asset pricing is the same as a simple version of Q theory.
Yet it seems to work much better. This experience reflects an important lesson: how theories are
implemented empirically matters a lot. Traditional Q theory focuses on detailed treatment of
corporate taxes and measures of book values; it focuses on interest rates as the central driver
of cost of capital; it relates the level of investment to the level of Q; it includes more complex
production technologies (with marginal not equal to average Q, for example); it often uses cash-
flow forecasts and other detailed measurements beyond investment and stock prices. It focuses
on failure: The theory predicts a 100% R2 ­ investment should be proportional to Q, exactly, with
no error. Any error is a formal rejection of the theory. That research focuses on the correlation
of Q theory errors with cashflow. Much of the research has a goal of using Q theory only as a
control to show what it can not explain, in order to advance a cashflow-constraint agenda.
       By contrast, investment-return work focuses on equity premiums as the central driver of
cost of capital, and we now know that equity premiums vary over time far more than riskfree
rates, and in the opposite direction. Equity premiums are high in recessions with low stock
prices, and low investment; interest rates are low in recessions. Investment-return work relates
business-cycle frequency measures of investment growth to stock returns, ignoring the obvious
high frequency failure (5 minute stock returns do not correlate with 5 minute investment growth)
and ignoring low frequencies and the cross-section of levels where measurement issues allow
prices to diverge persistently from book values. And, admitting that anything less than 100% R2
is a formal rejection, it looks for the part of the glass that is half full. And finds it.
       This lesson will be important in using the more general production-based asset pricing
described in this paper. There are hundreds of implementation decisions. Formal rejections
of specific implementations will be easy. Figuring out where the theory is most useful will be
harder.
       Relating variation in the market return over time to investment growth is interesting, but
the variation in average returns across assets and (especially) across portfolios sorted on various
characteristics is the heart of the asset pricing empirical challenge. Extending production-based
asset pricing to describe the cross-section of returns is the crucial next step.
       The investment-return based literature took that step, constructing multiple investment
returns to extend asset pricing predictions to a larger cross-section. We have a wealth of data on
industry, portfolio, and firm-level production that can construct similarly detailed investment
returns. Though we still can only price by arbitrage from this set of returns, the more cross-
sectional information the better.
       The literature that Zhang (2017) calls the "investment CAPM" made a great deal of progress
                                                                                      53


by this approach. Each firm's investment return should equal that firm's asset return. Firms with
higher investment growth have higher investment returns and higher stock returns, both ac-
tual and expected. The same prediction holds of portfolios of firms. Create a portfolio of value
firms, and their investment returns should be higher than those of a portfolio of growth firms,
matching the average stock returns of those portfolios of firms. Zhang (2017) shows that cross-
sectional variation in expected investment returns line up well with many of the "anomalous"
cross-sectional patterns in expected stock returns in this way. (The iceberg of which this sur-
vey is a tip includes Lyandres, Sun, and Zhang (2008) Li, Livdan, and Zhang (2009), Liu, Whited,
and Zhang (2009), Wu, Zhang, and Zhang (2010), Li and Zhang (2010), Lin and Zhang (2013),
Liu and Zhang (2014) and Goncalves, Xue, and Zhang (2019). There are lots of anomalies and
measurement issues to work out!)
      Whether one can say this approach "explains" the anomalies and if so "rationally" is a con-
tentious question. This literature documents that firms adjust properly in response to expected
returns, so investment decisions and expected returns are connected as economics says they
should be. There is no arbitrage between investment returns and stock returns. But both invest-
ment and stock returns are endogenous variables. Both could be driven by fads and irrationali-
ties on the parts of consumers. Still, if expected returns lined up with market, consumption, or
factor betas, one could make the same objection to the word "explain," as returns, consumption
and its betas are also endogenous variables which might be driven by irrational behavior on the
part of producers. So, one can say that the investment CAPM "explains" risk premiums as well as
a standard CAPM and consumption CAPM would do, if those models were successful in lining
average returns up against covariances with the market return or consumption growth.
      I also think the word "investment CAPM" is a bit misleading. The word "CAPM" suggests
that expected returns line up with covariances of returns with some variable, and promises a
theory that in principle can explain any asset return as the CAPM does. That is not the case.
The "investment CAPM" theory remains arbitrage between each return and each investment
return in isolation. It just compares a wide range of investment returns to the corresponding
wide range of asset returns, in anomaly-sorted portfolios. By contrast, the production-based ap-
proach in this paper does offer a "CAPM" representation. But he or she who does the work gets to
baptize the results, so just understand how the fundamental structure of an "investment CAPM"
remains different from that of a market portfolio CAPM, consumption CAPM, or production-
based model such as this one.
      We still desire a general purpose model then, one that could in principle price a larger set
of returns. Cochrane (1996) investigates one way to extend a cross-section of investment returns
         54


to price lots of assets. It uses a discount factor formed from two investment returns,

                                                I,r         I,nr
                                    m = a + br Rt +1 + bnr Rt+1                                (98)


where r denotes residential investment and nr denotes nonresidential investment, in order to
price a cross-section of stocks. (It is also where I first thought about conditional vs. uncon-
ditional factor models, scaling factors in GMM, and the somewhat dangerous plots of average
returns vs. predicted average returns.) Obviously, one can extend this approach with a larger set
of investment returns on the right hand side. Li, Vassalou, and Xing (2006) take an important
step, considering investment by households, corporate, noncorporate and financial businesses,
and they price the Fama French 25 size and book to market portfolios as well as the Fama and
French factor models do.
      Why are we allowed to extend observation of two returns to price other returns, which are
not connected by pure arbitrage? Arbitrage pricing theory, a limit on Sharpe ratios of strategies
that profit from the difference between asset returns and investment returns, leads to an approx-
imate discount factor of the form (98) for asset returns highly correlated with combinations of
the two investment returns. (See Cochrane (2005), Chapter 9.4.) Or, Cochrane (1996) speculates,
if the investment returns span the investment opportunity set then consumption and marginal
utility must be driven by the two investment returns. On p. 577,

         Why should investment returns be factors for asset returns? Factor pricing models
     are derived by arbitrage assumptions or by preference assumptions. We can assume
     that the firms on the . . . NYSE are claims to different combinations of N production
     technologies, plus idiosyncratic components that have small prices. Alternatively, we
     can invoke preference assumptions under which the returns on the N active produc-
     tion precesses, which are the only nondiversifiable payoffs in the economy and add
     up to aggregate wealth, drive marginal utility growth and hence price assets. . .

                                                  ¨
      Zhang (2005), and, citing Zhang, Jones and Tuzel (2013), Imrohoro         ¨
                                                                       glu and Tuzel (2014),
Belo and Lin (2012) and Belo and Yu (2013) follow a similar approach. Using this logic, they
estimate or simulate "production-based" models with discount factors


                                   log mt+1 = constant - t t+1                                 (99)


where t+1 is the shock to aggregate productivity and t is a coefficient. Belo, Lin, and Bazdresch
(2014) add a cost-shock second factor. However, as presented, it is a bit of a stretch to call these
                                                                                       55


models "production based," at least by the definition given here of pricing assets from producer
first-order conditions, leaving out preferences. These models really follow in the mode of the
second suggestion in Cochrane (1996), loosely suggesting that consumption should be a func-
tion of the aggregate productivity shock. They really use consumption-based asset pricing to
extend the discount factor from a single investment return to multiple returns. For example,
Zhang (p. 71) writes


         "Suppose there is a fictitious consumer side of the economy featuring one rep-
     resentative agent with power utility and a relative risk averse coefficient, A. The log
     pricing kernel is then log Mt+1 = log  + A(ct - ct+1 ), where ct denotes log aggregate
     consumption. Since I do not solve the consumer's problem that would be necessary
     in a general equilibrium, I can link ct to the aggregate state variable in a reduced-form
     way by letting ct = a + bxt [t in my notation] with b > 0."


      By contrast, the approach in this paper can give a truly production-based view of where
ad-hoc macro-factor or investment-return models such as (99) and its generalizations come
from, and requires no assumptions on preferences, not even a Shape ratio limit, other than the
existence of a discount factor or a set of contingent claims prices.
      Likewise, we have seen here production-based discount factors with output growth, wages,
labor input, labor share growth, and growth in the labor/output ratio along with productivity as
pricing factors. These results can provide an alternative theoretical foundation for a wide va-
riety of asset pricing models that include such variables as risk factors. Among many others,
Campbell (1996) Jagannathan and Wang (1996) find that a labor income growth factor helps to
price the cross section of returns. Lettau, Ludvigson, and Ma (2019) find that the change in cap-
ital share, which is one minus the labor share in the discount factor formula (65), prices a cross
section of returns.
      However, theory does not just exist to justify existing ad-hoc models. This paper explores
a fundamentally different approach to understanding marginal rates of transformation across
states of nature, than elaborating on investment returns and trying to extend pricing from in-
vestment returns to other payoffs by preferences, arbitrage, or approximate arbitrage. New the-
ory ought to inspire new empirical specifications or at least to restrict and refine them.
      The word "production-based" also is sometimes used to mean "general equilibrium mod-
els that include production." An important literature writes models with (interesting and elabo-
rate) preferences, along with detailed (interesting and elaborate) production technologies, and
sometimes market frictions as well, calibrated to match asset pricing facts. This literature gets
         56


at questions such as, what features of production technology create "growth" an "value" firms in
the first place? Where do betas come from? (Croce (2014) is an example that uses the "production-
based" label.) As with ad-hoc models linking discount factors to production data, or models that
infer consumption from production data, this is a different meaning than my sense of the word
"production-based," that uses only producer first-order conditions.


10. Concluding comments

This paper is clearly an exploratory step. There is lots to do to create production-based asset
pricing models that can unite asset pricing and macroeconomic facts.
       I explored one particular functional form. Other functional forms, and a more general
theoretical treatment, beckon. We have already seen that once labor is included, the discount
factor includes either labor or wages, and not just productivity and its underlying shock. More
detailed production functions may well change that form. A better handling of dynamics and
how firms can slowly change their shock exposures beckons.
       I focused on the discount factor question, paralleling consumption-based asset pricing.
General equilibrium models, in which one fully solves the productivity choice given external
variables, beckon. Such models will likely find it useful to exploit stationarity assumptions, the
fact that the same shocks are in some sense repeated. For example, one often starts a general
equilibrium model by positing that all uncertainty evolves as a vector-valued Markov process,
and looks for solutions as a function of that state variable.
       Bringing this production-based approach to data requires many choices. The first is iden-
tifying or measuring the underlying productivity shocks , or finding a specification that does
not need them. Initially, this task looks daunting. If  is completely unobserved, and likely to be
correlated with , then how can we implement m =  /1+ ? One can find a  at any date to
generate any discount factor one wishes.
       It is possible that this problem is ameliorated with a more detailed production process,
and careful measurement of productivity, along with recognition of multiple factors in asset re-
turns and macroeconomic variables, as sketched above. Moreover, discount factors from realis-
tic production functions, including labor, adjustment costs, and other inputs, feature a range of
variables that all respond to the same underlying natural productivity  shocks, and should help
to identify them. Simply assuming that the natural productivity shock  is perfectly correlated
with actual productivity, excusing negative estimated , may be enough.
       But really this identification problem is no different or worse than the similar identifica-
tion issues that haunt all of macroeconomics and finance. The example of perfectly correlated
                                                                                        57


natural and chosen productivity is exactly the same, with only a change in Greek letters, as the
example in Cochrane (2011), in which the interest-rate rule of New-Keynesian models has a right
hand variable (inflation) perfectly correlated with its (monetary policy) shock, so yields exactly
the wrong coefficient. VARs are plagued by the question whether interest rates cause inflation
or expected inflation causes interest rates. Yet new-Keynesian models and VARs are a thriving
industry, solved and compared to data. How? By thinking hard and making identification as-
sumptions, finding something orthogonal or exogenous somewhere.
      All economic models include shocks somewhere, and usually must do so if they want to
avoid 100% R2 predictions, equations that link variables with no error. Yet a shock in any equa-
tion usually means that equation cannot be directly estimated ­ we need a shock somewhere
else to do that, and an exclusion restriction. Shocks have to be somewhere, and, if we are honest,
most likely everywhere. Medium-scale empirical macro models contain shocks in every equa-
tion. Increasingly popular preference shocks (risk aversion, discount factor, financial frictions)
or their observational equivalents (taste, sentiment, probability) raise exactly the same identifi-
cation problem for conventional asset pricing. The Belo (2010) factor model approach is a great
example of how light and plausible (and clever!) identification assumptions can go a long way.
      The other approach to identification is to construct simulation economies. One may not
be able to measure natural productivity , but one can specify a  process, simulate data, and
see what it takes for the simulated moments to match actual moments. That process includes
lots of unstated identification assumptions, or in fact isn't identified at all ­ there may be other
assumptions that produce the same moments. But it is how we construct models. Getting a
model that can match the data is hard enough, and valuable, even if one cannot prove that some
other model or parameterization might fit the data as well.
      We have really just begun to properly explore the cross-sectional richness of production
data. Zhang (2017) makes great progress, computing the investment returns of sorted portfo-
lios by computing the investment returns of their component firms, and comparing the cross-
section of investment returns to the cross-section of asset returns. Belo (2010) online Appendix
C also encapsulates a wide cross section of sector and industry output data.
      In the project of extending asset pricing from investment returns to asset returns, we want
to use as many investment returns as possible. In the investment return approach such as Zhang
(2017), each firm's investment return is a primitive, however. Surely one looks for something
more integrative than 3000 separate investment returns to explain 3000 stock returns. They likely
share a statistical factor structure, but that only ties them together as an empirical observation.
      The productivity choice approach here is fundamentally different from investment re-
         58


                                                      I
turns in this respect. Each firms' investment return Ri,t +1 is a separate object, giving us a sep-
arate measurement and prediction for one part of the payoff space. A discount factor using
                                                           I
investment returns should load on all of them, m = a + b1 R1            I                 I
                                                             ,t+1 + b2 R2,t+1 + ... + bi Ri,t+1 .

Only a second empirical observation, that investment returns obey a factor structure, results
in the APT philosophy of a smaller number of pricing factors. However, each firms' productivity
                                    1+j
choice m = i  i 1+i
             i /i   = j j j /j            should equal the common m. This proposition mirrors
the proposition that each individual consumer should set marginal utility growth to equal the
common discount factor, m = c-  1-
                             i /i  . Thus, while APT logic and investment returns lead
us to a discount factor m loading on many objects, productivity-choice logic leads us to many
measurements of a single discount factor. Disaggregated data should be useful for constructing
that discount factor.
      Individual firm data may have measurement error, of course, and as Belo (2010) shows
us, disaggregated data can help us to surmount the shock identification issue. Moreover, as
Constantinides and Duffie (1996) show us for consumers, the common discount factor can look
very different from aggregate productivity raised to a power.
      But investment returns and productivity choice are complements as they are parts of the
same model, not competitors. One should ideally integrate the investment-return and productivity-
choice approaches, using both the cross-sectional information of many investment returns, and
the many sources of cross-sectional information on the common discount factor. The aggrega-
tion model of Section 8 already points to interesting productivity choice in the aggregate pro-
duction function that may not exist in firm-level production. Extend that idea to multiple tech-
nologies that also have productivity choices should lead to additional insights.
      Clearly, the investigation has just begun.
                                                                                    59


References

Albuquerque, Rui, Martin Eichenbaum, Victor Xi Luo, and Sergio Rebelo. 2016. "Valuation Risk
  and Asset Pricing." The Journal of Finance 71 (6):2861­2904. URL https://onlinelibrary.wiley.
  com/doi/abs/10.1111/jofi.12437.

Belo, Frederico. 2006. "A Pure Production-Based Asset Pricing Model." Ph.D. Dissertation, Uni-
  versity of Chicago Booth School of Business.

------. 2010.   "Production-based measures of risk for asset pricing."       Journal of Mone-
  tary Economics 57 (2):146 ­ 163.    URL http://www.sciencedirect.com/science/article/pii/
  S0304393209001822.

Belo, Frederico and Xiaoji Lin. 2012. "The Inventory Growth Spread." The Review of Financial
  Studies 25 (1):278­313. URL https://doi.org/10.1093/rfs/hhr069.

Belo, Frederico, Xiaoji Lin, and Santiago Bazdresch. 2014. "Labor Hiring, Investment, and Stock
  Return Predictability in the Cross Section." Journal of Political Economy 122 (1):129­177. URL
  http://www.jstor.org/stable/10.1086/674549.

Belo, Frederico and Jianfeng Yu. 2013. "Government investment and the stock market." Journal
  of Monetary Economics 60 (3):325 ­ 339. URL http://www.sciencedirect.com/science/article/
  pii/S0304393213000056.

Campbell, John Y. 1996. "Understanding risk and return." Journal of Political Economy 104:298­
  34.

Cochrane, John H. 1988. "Production-Based Asset Pricing." Working Paper 2776, NBER. URL
  https://www.nber.org/papers/w2776.pdf.

------. 1991. "Production-Based Asset Pricing and the Link Between Stock Returns and Eco-
  nomic Fluctuations." The Journal of Finance 46 (1):209­237. URL https://onlinelibrary.wiley.
  com/doi/abs/10.1111/j.1540-6261.1991.tb03750.x.

------. 1993. "Rethinking production under uncertainty." URL https://faculty.chicagobooth.
  edu/john.cochrane/research/papers/Cochrane%20Rethinking%20Production%20Under%
  20Uncertainty.pdf. Manuscript.

------. 1996. "A Cross-Sectional Test of an Investment-Based Asset Pricing Model." Journal of
  Political Economy 104:572­621.
         60


------. 2005. Asset Pricing, Revised Edition. Princeton, N.J.: Princeton University Press.

------. 2011. "Determinacy and Identification with Taylor Rules." Journal of Political Economy
  119:565­615.

------. 2017. "Macro-Finance." Review of Finance 21:945­985. URL https://doi.org/10.1093/
  rof/rfx010.

Cochrane, John H. and Lars Peter Hansen. 1992.          "Asset Pricing Explorations for Macroe-
  conomics."     NBER Macroeconomics Annual 7:115­165.         URL http://www.jstor.org/stable/
  3585001.

Constantinides, George M. and Darrell Duffie. 1996. "Asset Pricing with Heterogeneous Con-
  sumers." Journal of Political Economy 104 (2):219­240. URL http://www.jstor.org/stable/
  2138925.

Croce, Mariano Massimiliano. 2014. "Long-run productivity risk: A new hope for production-
  based asset pricing?"      Journal of Monetary Economics 66:13 ­ 31.          URL http://www.
  sciencedirect.com/science/article/pii/S0304393214000506.

         erard. 1959. The theory of value: an axiomatic analysis of economic equilibrium. New
Debreu, G´
  York, N.Y.: WIley.

Epstein, Larry G. and Stanley E. Zin. 1989. "Substitution, Risk Aversion, and the Temporal Behav-
  ior of Consumption and Asset Returns: A Theoretical Framework." Econometrica :937­969.

Goncalves, Andrei S., Chen Xue, and Lu Zhang. 2019.           "Aggregation, capital heterogene-
  ity, and the investment CAPM."       Review of Financial Studies Forthcoming.       URL http://
  theinvestmentcapm.com/uploads/1/2/2/6/122679606/vitae luzhang2019december.pdf.

Grigsby, John. 2020. "Skill Heterogeneity and Aggregate Labor Market Dynamics." Manuscript
  URL http://home.uchicago.edu/jgrigsby/files/Research/JGrigsby JMP.pdf.

Hansen, Lars Peter and Ravi Jagannathan. 1991. "Implications of Security Market Data for
  Models of Dynamic Economies." Journal of Political Economy 99 (2):225­262. URL http:
  //www.jstor.org/stable/2937680.

Hindy, Ayman and Chi-fu Huang. 1992. "Intertemporal Preferences for Uncertain Consump-
  tion: A Continuous Time Approach." Econometrica 60 (4):781­801. URL http://www.jstor.
  org/stable/2951566.
                                                                                     61


Houthakker, H. S. 1955. " The Pareto Distribution and the Cobb-Douglas Production Function
  in Activity Analysis 1." The Review of Economic Studies 23 (1):27­31. URL https://doi.org/10.
  2307/2296148.

Imrohoroglu, Ays
               ¸e and S        ¨
                      ¸ elale Tuzel. 2014. "firm-level productivity, risk, and return." Manage-
  ment Science :2073­2090.

Jagannathan, Ravi and Zhenyu Wang. 1996. "The Conditional CAPM and the Cross-Section of
  Expected Returns." The Journal of Finance 51 (1):3­53. URL https://onlinelibrary.wiley.com/
  doi/abs/10.1111/j.1540-6261.1996.tb05201.x.

Jermann, Urban J. 2013. "A production-based model for the term structure." Journal of Fi-
  nancial Economics 109 (2):293 ­ 306. URL http://www.sciencedirect.com/science/article/pii/
  S0304405X13000767.

Jones, Christopher S. and S        ¨
                          ¸ elale Tuzel. 2013. "Inventory investment and the cost of capital."
  journal of financial economics 107:557­579.

King, Robert G., Charles I. Plosser, and Sergio T. Rebelo. 1988. "Production, growth and business
  cycles: I. The basic neoclassical model." Journal of Monetary Economics 21 (2):195 ­ 232. URL
  http://www.sciencedirect.com/science/article/pii/030439328890030X.

Kruger, Samuel. 2019. "Assessing Valuation Risk: Theory and Empirical Evidence." Manuscript
  URL https://ssrn.com/abstract=3205749.

Kydland, Finn E. and Edward C. Prescott. 1982. "Time to Build and Aggregate Fluctuations."
  Econometrica 50 (6):1345­1370. URL http://www.jstor.org/stable/1913386.

Lamont, Owen A. 2000.        "Investment Plans and Stock Returns."      The Journal of Finance
  55 (6):2719­2745. URL https://onlinelibrary.wiley.com/doi/abs/10.1111/0022-1082.00304.

Lettau, Martin, Sydney Ludvigson, and Sai Ma. 2019. "Capital Share Risk in U.S. Asset Pric-
  ing." The Journal of Finance 74 (4):1753­1792. URL https://onlinelibrary.wiley.com/doi/abs/
  10.1111/jofi.12772.

Li, Dongmei and Lu Zhang. 2010. "Does q-theory with investment frictions explain anomalies
  in the cross-section of returns?" Journal of Financial Economics 98:297­314.

Li, Erica X. N., Dmitry Livdan, and Lu Zhang. 2009. "Anomalies." Review of Financial Studies
  22:4301­4334.
        62


Li, Qing, Maria Vassalou, and Yuhang Xing. 2006. "Sector Investment Growth Rates and the Cross
  Section of Equity Returns." The Journal of Business 79 (3):1637­1665. URL http://www.jstor.
  org/stable/10.1086/500687.

Lin, Xiaoji and Lu Zhang. 2013. "The investment manifesto." Journal of Monetary Economics
  60:351­366.

Liu, Laura Xiaolei, Toni M. Whited, and Lu Zhang. 2009. "Investment-based expected stock re-
  turns." Journal of Political Economy 117:1105­1139.

Liu, Laura Xiaolei and Lu Zhang. 2014. "A neoclassical interpretation of momentum." Journal of
  Monetary Economics 67:109­128.

Lucas, Robert E. 1978. "Asset Prices in an Exchange Economy." Econometrica 46 (6):1429­1445.
  URL http://www.jstor.org/stable/1913837.

Lyandres, Evgeny, Le Sun, and Lu Zhang. 2008. "The new issues puzzle: Testing the investment-
  based explanation." Review of Financial Studies 21:2825­2855.

Mehra, Rajnish and Edward C. Prescott. 1985. "The equity premium: A puzzle." Journal of
  Monetary Economics 15 (2):145 ­ 161. URL http://www.sciencedirect.com/science/article/
  pii/0304393285900613.

Wu, Jin (Ginger), Lu Zhang, and X. Frank Zhang. 2010. "The q-theory approach to understanding
  the accrual anomaly." Journal of Accounting Research 48:177­223.

Zhang, Lu. 2005. "The value premium." Journal of Finance 60:67­103.

------. 2017. "The investment CAPM." European Financial Management 23:545­ 603.
                                                                                                        63


       Online Appendix to "Rethinking Production Under Uncertainty"


1. Recursive statements

The recursive dynamic problem with a sum constraint is

                                                                                      t+1
   V (kt , Wt , t ) =         max            {t f (kt ) - [kt+1 - (1 -  )kt ]} + Et       V (kt+1 , Wt+1 , t+1 )
                        {kt+1 ,t+1 ,Wt+1 }                                            t

                                                                  1+
                                                          t+1
                         s.t. Wt1+ = Et (1 - )                         + Wt1+
                                                                           +1
                                                                              
                                                                               , W0 = 1, k0 .
                                                          t+1

Production starts in period 1. (It is not necessary to raise W to the 1 +  power in this case, but
it provides a consistent notation for the next case.)
       Introducing a Lagrange multiplier t on the constraint, the first-order and envelope con-
ditions with respect to kt are

                                                           t+1
                                                 1 = Et        Vk (kt+1 , Wt+1 , t+1 )
                                                           t
                                 Vk (kt , Wt , t ) = t fk (kt ) + (1 -  ).


The first order condition with respect to t+1 and the envelope condition with respect to t are

                               t+1                                         t+1
                                   V (kt+1 , Wt+1 , t+1 ) = t (1 - )(1 + ) 1+ 
                               t                                          t+1
                                                 V (kt , Wt , t ) = f (kt ).


The envelope condition with respect to Wt and first-order condition with respect to Wt+1 are


                                                   VW (kt , Wt , t ) = t (1 + )Wt-
                                  t+1
                                      VW (kt+1 , Wt+1 , t+1 ) = t (1 + )Wt- 
                                                                          +1 .
                                  t

Substituting out the envelope conditions,

                                                  t+1
                                               1 = Et  [t+1 fk (kt+1 ) + (1 -  )]
                                                   t
                             t+1                              t+1
                                 f (kt+1 ) = t (1 - )(1 + ) 1+                                                (100)
                             t                              t+1
                                   t+1 t+1 = t t .
         64


The condition (100) condition becomes

                                                                                  t+1
                                     t+1 f (kt+1 ) = 0 0 (1 - )(1 + )             1+
                                                                                  t +1


so again the discount factor varies with productivity. Dividing, the one-period discount factor is

                                              -(1+)                               1+            -(1+)           -1
       t+1              t+1          t+1               f (kt )          t+1             t+1              yt+1
           =                                                    =
       t                t            t                f (kt+1 )         t               t                 yt

as before.
      With the generalization to the non-state-separable recursive formulation, we have

                                                                                         t+1
  V (kt , Wt , t ) =         max            {t f (kt ) - [kt+1 - (1 -  )kt ]} + Et           V (kt+1 , Wt+1 , t+1 )
                       {kt+1 ,t+1 ,Wt+1 }                                                t


                                                               1
                                               1+
                                 s.t. Wt = Et Rt +1
                                                              1+
                                                                   ,                                                 (101)
                                                                                        1
                                                                   1+                  1+
                                                           t+1
                                   Rt+1 = (1 - )                        + Wt1+
                                                                            +1
                                                                               
                                                                                            ,
                                                           t+1

                                     W0 = 1, k0 .


The first-order and envelope conditions with respect to kt are unchanged. With respect to t we
now have

                            t+1                                             t+1
                                V (kt+1 , Wt+1 , t+1 ) = t Wt- Rt
                                                                -
                                                                  +1 (1 - ) 1+
                            t                                              t+1
                                              V (kt , Wt , t ) = f (kt ).


Therefore, we start the road to a one-period discount factor with

                         t+1 f (kt+1 )    t t Wt- Rt -
                                                     +1                     t+1   
                                                                                       t+1      1+
                                       =                                                             .               (102)
                          t f (kt )      t-1 t-1 Wt-  -
                                                     R
                                                   -1 t                     t          t

      With respect to Wt , we now have


                                       VW (kt , Wt , t ) = t
                       t+1                              1
                           VW (kt+1 , Wt+1 , t+1 ) = t    W - Rt
                                                               -            
                                                                 +1 (1 +  )Wt+1 .
                       t                               1+ t
                                                                                             65


Eliminating VW ,

                                                  1 +  - - 
                              t+1 t+1 = t t Wt-       R   W    W
                                                  1 +  t+1 t+1 t+1
                                                  1 +  - -
                         t+1 t+1 Wt-
                                   +1
                                     
                                        = t t Wt-     R   W
                                                  1 +  t+1 t+1

and moving back a time period,

                                                     1 +  - -
                           t t Wt- = t-1 t-1 Wt-
                                               -1
                                                 
                                                         R Wt .
                                                     1+ t

      Substituting this result into the one-period discount factor (102),

               t+1 f (kt+1 )   [t-1 t-1 Wt-  1+ -
                                          -1 1+ Rt  Wt- ]Rt
                                                          -
                                                            +1      t+1     
                                                                                 t+1    1+
                             =
                t f (kt )             t-1 t-1 Wt-   -
                                                   R
                                                 -1 t               t            t

                                                                            1+
                      t+1 f (kt+1 )   1 +  - -           t+1        t+1
                                    =     W Rt+1                                 .
                       t f (kt )      1+ t               t          t
Using (101),

                                                  -
                                                                          1+
                 t+1   1+     Rt+1                      t+1        t+1          f (kt )
                     =                       1
                                                  
                 t     1+      1+
                           Et Rt            1+          t          t           f (kt+1 )
                                 +1

or                                             -
                                                           1+             1+            -1
               t+1   1+     Rt+1                     t+1           t+1           yt+1
                   =                       1
                                                                                             .
               t     1+      1+
                         Et Rt            1+         t             t              yt
                               +1




2. Dynamic productivity choice

In this section, I consider the choice of productivity  given discount factors and natural pro-
ductivity  in the model with a separate constraint for each time period E (t /t )1+  1. The
text focuses on the construction of a discount factor given the productivity choice. That sort of
calculation is useful for empirical production-based asset pricing, in which we take productiv-
ity, output, etc. data as they are. However, we also want to construct full models and simulation
models. Such models require a fully-solved productivity choice. Even for the empirical project,
we want some assurance that the productivity choice described by this model is sensible. This
section also analyzes the effect of the time  at which expectations are taken. The major result
is that it is wise to take  << t.  = 0 is a good choice, mirroring the specification in the sum
constraint. A  = t - k for k >> 1 is also a good choice, and may be useful when one wants to
             66


use recursive methods or model a stationary environment.
           Macroeconomic models usually feature serially correlated productivity, say


                                             log t+1 =  log t + vt+1 ,


often including a random walk  = 1 or a unit root component, such as a random walk plus
AR(1). The central issue is to produce such a persistent productivity.
           To express the productivity choice  in terms of the discount factor in this intertemporal
setting, we can impose the constraint and find 6
                                         
                                 t+1                       t+1 t+1 f (kt+1 )
                                             =                                                 .       (104)
                                 t+1                                             1+      1+
                                                  E (t+1 t+1 f (kt+1 ))           




           Let us simplify with f (kt ) = 1, as in general this will not be a major source of dynamics
especially at high frequency. Start also with  = 1, so we can see how productivity responds to
discount factors alone. The productivity choice (104) becomes
                                                                                          
                                                                              1+         1+
                               log t+1 = log t+1 - log E                  t+1  
                                                                                                   .   (105)


If  = t, then indeed we will have an i.i.d. productivity level t . If  happens earlier though,
productivity t follows a moving average, accumulating shocks between  + 1 and t + 1. And
fixing  = 0, log t+1 is as persistent as the level of the discount factor t+1 . This is a practical
argument for specifying  = 0 and generalizing the two period model to a dynamic model by
using an unconditional expectation in (31) rather than conditional.
           To see these statements explicitly, suppose that the discount factor follows a log random
walk,
                             log t+1 - log t = -µ -  vt+1 , vt+1  N (0, 1).                            (106)



   6
       Algebra: From (45),
                                                 t+1 t+1 f (kt+1 )  
                                                                   = t
                                                                     
                                                                       +1
                                                                          .                            (103)
                                                  t+1 (1 + )        t  +1
                                                                 1+
                                             t+1 t+1 f (kt+1 )            1+
                                                                          t+1
                                                                             
                                                                      =   1+
                                              t+1 (1 + )                  t +1

Taking time 0 expectations, imposing the constraint, and raising the result to the /(1 + ) power,
                                                                                    
                                      1                          1+                1+
                                            E [t+1 t+1 f (kt+1 )]                       = 1.
                                 t+1 (1 + )
Substituting back in (103), we have (104).
                                                                                        67


Now, working out the conditional expectation on its right hand side, (105) gives

                                                               11+ 2
                    log t+1 = log t+1 - log  + µ -                 (t + 1 -  )                (107)
                                                               2 

or, using (106),
                                           t- +1
                                                             11+ 2
                          log t+1 = -               v +j -       (t + 1 -  ).
                                                             2 
                                             j =1

If  = t, and the constraint is purely conditional Et (1+ 
                                                      t+1 ) = 1, then indeed the level of technology
t+1 is i.i.d. and it is proportional to the one-period stochastic discount factor mt+1 = t+1 /t .
This behavior is unlike consumption-based models in which consumption growth is i.i.d. and
proportional to the one-period discount factor, log mt+1 = log  -  log ct+1 , or log t+1 =
(t + 1) log  -  log ct+1 .
       However, if  comes earlier, then productivity follows a longer and longer moving average.
And if  = 0, then productivity follows a random walk with drift, and productivity growth rates
rather than levels are proportional to the one-period discount factor mt+1 as is the case with
consumption.
       We also obtain a persistent productivity process if we specify a persistent natural or un-
derlying technology shock t . Equation (104) then implies that t+1 will inherit the persistence
of t+1 , modified in the direction of the discount factor. Now even if the constraint is conditional
 = t, productivity will include the persistence of the  component.
       To see these points explicitly, suppose the natural productivity shock follows


                             log t+1 =  log t + µ +  wt+1 , wt+1  N (0, 1),


and keep  = 1 in mind as an important case. Keep f (kt ) = 1, the random-walk discount factor
process (106) and consider the  = t conditional case in which  = 1 produces i.i.d. productivity
t . We then have

                     1+                                                 1   1+   2   2
    log Et (t+1 t+1 )                = log t + (µ - µ +  log t ) +                 +   - 2 ,
 1+                                                                     2    

so writing (104) in logs, productivity follows

                                                               1   1+       2   2
             log t+1 =  log t+1 + ( wt+1 -  vt+1 ) -                          +   - 2         (108)
                                                               2    

Log productivity t is composed of a persistent component, log t+1 , which can be a random walk
if  = 1, plus an i.i.d. component from the discount factor. To the extent that the firm distorts
         68


t+1 away from t+1 for a period in order to chase a higher contingent claim price, by raising the
sensitivity  , it must pay by accepting a lower mean of t+1 , represented in the final term.
       Why is the time  when we take expectations that define the productivity-choice con-
straint important? Figure 6 illustrates a simple example. Let there be two periods, and two states
in each period with probability 1/2 and a final outcome x2 = A, B, C, D. If we impose a con-
straint conditioned at time 1, E1 (x2 ) = 1 that specification implies two constraints,

                                      A+B      B+C
                                          = 1;     = 1.                                        (109)
                                       2        2

If we impose a constraint conditioned at time 0, E0 (x2 ) = 1 it is

                                        A+B+C +D
                                                 = 1.                                          (110)
                                           4

Now, the conditional constraint (109) implies the unconditional constraint (110). But the condi-
tional constraint is more stringent. The unconditional constraint (110) allows the firm to switch
output from (A, B ) to (C, D). For example, it allows

                                    A+B        B+C
                                        = 1.5;     = 0.5.
                                     2          2

The pure conditional constraint does not allow the latter substitution.




                                    Figure 6: Information tree.



       The unconditional constraint is equivalent to a set of conditional constraints,


                                     E1 (x2 ) = z1 ; E0 (z1 ) = 1.                             (111)
                                                                                        69


In our case, limiting the 1 +  moment, the unconditional constraint is similarly recursive. The
constraint
                                                         1
                                         E0 (x1+
                                              2
                                                 
                                                  )     1+
                                                             =1

is equivalent to the sequence of constraints

                                                              1
                                       z1 = E1 (x1+
                                                 2
                                                    
                                                     )       1+

                                                              1
                                                1+           1+
                                        1 = E0 z1                 .


Generalizing to multiple time periods leads to the recursive statement (50)-(52) of the productivity-
choice constraint.
      When does the firm make the choice of the productivity distribution? It's a natural ques-
tion, but not really well posed. In a contingent claim framework, firms make a plan at time zero
for all contingencies. Some decisions are made subject to information restrictions ­ you can't
plan to sell stock based on tomorrow's information ­ and in that sense we can think of them as
being made at the last moment before information is revealed. But the logic of contingent claims
is clearest if we regard the decisions as made out of time, subject to information restrictions.
      What is the more reasonable assumption for the conditional expectation? (Besides a de-
sire to reverse-engineer the "right" answer.) This dynamic model brings up the issue of time.
      With  < t, and most easily  = 0, the dynamic problem generalizes to continuous time.
The firm's problem is
                                          
                                max E          t [t f (kt ) - it ] dt s.t.
                                         t=0



                                       dkt = -kt + it dt
                                                           1+
                                                      t
                                         1=E                      .                           (112)
                                                      t

There is a different constraint (112) for each time t. The productivity choice first-order condition
is
                                                                t
                                    t f (kt ) = t (1 + )      1+ .
                                                              t
Given  and , this condition identifies the discount factor t up to differentiable functions of
           70


time f (kt )and t . Explicitly, we can evaluate the constraint as before, yielding

                                  t             t t f (kt )
                                   =
                                  t                        1+
                                                                           .
                                                                      1+
                                         E [t t f (kt )]    




The denominator varies as a differentiable function of time. Thus, in the basic asset pricing
relation
                                            f                         dt
                                  Et dRt - rt dt = -Et dRt
                                                                       t
with
                                         f            dt
                                        rt dt = -Et               ,
                                                       t
we know the diffusion component, i.e.

                                  dt     f            t               t
                                     = -rt dt + d             /            .
                                  t                   t               t

                f
We can use any rt to describe excess returns. Defining

                                           e     i     j
                                         dRt = dRt - dRt


then
                          e           e    dt            e                 t       t
                                                                                   
                    Et (dRt ) = -Et dRt          = -Et dRt d                   /       .
                                           t                               t       t
The intertemporal first order condition and definition of investment return is standard given the
choice of productivity.
