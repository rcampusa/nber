                               NBER WORKING PAPER SERIES




    PARAMETRIC INFERENCE AND DYNAMIC STATE RECOVERY FROM OPTION
                              PANELS

                                       Torben G. Andersen
                                          Nicola Fusari
                                         Viktor Todorov

                                       Working Paper 18046
                               http://www.nber.org/papers/w18046


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     May 2012




Andersen gratefully acknowledges support from CREATES funded by the Danish National Research
Foundation. Todorov's work was partially supported by NSF Grant SES-0957330. We are also grateful
for support from the Zell Center for Risk at the Kellogg School. The views expressed herein are those
of the authors and do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2012 by Torben G. Andersen, Nicola Fusari, and Viktor Todorov. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
Parametric Inference and Dynamic State Recovery from Option Panels
Torben G. Andersen, Nicola Fusari, and Viktor Todorov
NBER Working Paper No. 18046
May 2012
JEL No. C51,C52,C58,G12,G13

                                             ABSTRACT

We develop a new parametric estimation procedure for option panels observed with error which relies on
asymptotic approximations assuming an ever increasing set of observed option prices in the moneyness-
maturity (cross-sectional) dimension, but with a fixed time span. We develop consistent estimators
of the parameter vector and the dynamic realization of the state vector that governs the option price
dynamics. The estimators converge stably to a mixed-Gaussian law and we develop feasible estimators
for the limiting variance. We provide semiparametric tests for the option price dynamics based on
the distance between the spot volatility extracted from the options and the one obtained nonparametrically
from high-frequency data on the underlying asset. We further construct new formal tests of the model
fit for specific regions of the volatility surface and for the stability of the risk-neutral dynamics over
a given period of time. A large-scale Monte Carlo study indicates the inference procedures work well
for empirically realistic specifications and sample sizes. In an empirical application to S&P 500 index
options we extend the popular double-jump stochastic volatility model to allow for time-varying jump
risk premia and a flexible relation between risk premia and the level of risk. Both extensions lead to
an improved characterization of observed option prices.


Torben G. Andersen                                  Viktor Todorov
Kellogg School of Management                        Department of Finance
Northwestern University                             Kellogg School of Management
2001 Sheridan Road                                  Northwestern University
Evanston, IL 60208                                  2001 Sheridan Road
and NBER                                            Evanston, IL
t-andersen@kellogg.northwestern.edu                 v-todorov@kellogg.northwestern.edu

Nicola Fusari
Department of Finance
Kellogg School, Northwestern University
Evanston, IL 60208
n-fusari@northwestern.edu
1        Introduction

A voluminous literature spanning several decades has, unambiguously, established that time-varying
volatility and jumps are intrinsic features of financial asset price processes. More recently, there
has been substantial interest in linking financial risk premiums to the compensation for such fac-
tors. Indeed, the evidence indicates that the pricing of volatility and jump risks is critical for
understanding the magnitude and variation in both equity and variance risk premiums, see, e.g.,
Bates (2000), Pan (2002), Broadie et al. (2009) and Bollerslev and Todorov (2011). In parallel, the
trading of derivative contracts has grown explosively, in part reflecting a desire among investors
to actively manage volatility and jump risk exposures. As a result, ever more comprehensive price
data for, in particular, exchange-traded options have become available over time.1 These options
span a variety of expiration dates (tenors) and strike prices (moneyness), effectively providing an
option or “implied volatility” surface for each trading day, indexed by moneyness and tenor. For
the horizons spanned by the surface, we may extract risk-neutral density estimates for the equity
index and price any payoff expressed as a smooth function of future index values. Moreover, we may
infer the value of various path-dependent payoffs, including the future realized return variation. In
other words, a sequence of equity-index option surfaces – which we label an option panel – contains
valuable information about the dynamic pricing of future economy-wide contingencies.
        In this paper, we develop rigorous estimation and inference tools for extracting information from
option panels under minimal auxiliary conditions. That is, we develop formal inference techniques
for the implied (latent) state vector and the risk-neutral, or pricing, distribution, while avoiding
parametric assumptions about the actual measure governing the state vector dynamics. In fact,
the latter may be non-stationary. This is feasible as we develop asymptotic distributional approx-
imations assuming only that the number of options underlying each volatility surface is large, so
we may treat the time dimension as fixed. We also allow for the option prices to be observed
with errors exhibiting limited dependence in the spatial (across strikes and tenors) and time series
dimension. We accommodate the case where the strike range and tenor of the option surface, as
well as the total number of option quotes, change across time – as in the data – and there is no
requirement of stationarity in the pattern of maturity and moneyness. Similarly, we allow for the
observation error to have a non-ergodic and time-varying distribution.
        Our estimation method is penalized nonlinear least squares (NLS). The objective function has
two parts. The primary component is the mean-squared-error in fitting the observed option prices
    1
    For example, on average, over 230 active bid-ask quotes with positive bid prices for out-of-the-money options are
reported daily, at the end-of-trading, for our sample of options on the S&P 500 index at the Chicago Board Options
Exchange (CBOE) during 1996 − 2010, and this number is significantly higher in the second part of the sample.


                                                         1
over the estimation period using the parametric option pricing model. The second piece of the
objective function penalizes estimates depending on how much the option-implied volatility state
deviates from a local nonparametric estimate of spot volatility constructed from high-frequency
data on the underlying asset. This constraint stems from the no-arbitrage condition that the cur-
rent (aggregate) diffusion coefficient must be identical under the actual and risk-neutral measures.
Assuming the option price errors “average out” sufficiently when pooled in the objective func-
tion, we can consistently estimate both the parameters of the risk-neutral density and the realized
trajectory of the state vector governing the option price dynamics.
   We further establish the asymptotic properties of our estimator. The convergence is stable, i.e.,
it holds jointly with any (bounded) random variable defined on the probability space. The limiting
distribution is mixed Gaussian with an asymptotic variance that can depend on any random vari-
able adapted to the filtration. The limiting law reflects the flexibility of the estimation approach:
we can accommodate option errors that depend in unknown ways on the volatility state as well as
option characteristics such as moneyness and tenor. We also provide consistent estimators for the
asymptotic variance, thus enabling feasible inference. In analogy to standard NLS our estimator
is efficient if the option errors are homoskedastic, and it may be rendered efficient otherwise by
weighting the option fit appropriately for the differing degrees of moneyness and tenor. Conse-
quently, in contrast to much earlier work on option pricing allowing for observation error, e.g.,
Bates (2000), Jones (2006), and Eraker (2004), we do not impose any parametric assumption on
the pricing errors, and we allow them to display significant heteroskedasticity.
   The recovery of the volatility state from the option surface has important features in common
with the “realized volatility” estimation of stochastic volatility (or time-integrals thereof) based
on high-frequency asset returns, see, e.g., Andersen and Bollerslev (1998), Andersen et al. (2003),
and Barndorff-Nielsen and Shephard (2002, 2006). In either case, the volatility realization may be
recovered pathwise. Moreover, both estimators converge stably with an asymptotic variance that
depends on the observed trajectories of asset prices, but do not require stationarity or ergodicity of
the volatility process. While the high-frequency (jump-robust) estimator of volatility is based on
“averaging out” the noise in the high-frequency return data, the option-based volatility estimator
“averages out” the observation errors across the option surface. The major difference is that the
option-based estimator exploits a parametric pricing model while the estimator based on high-
frequency returns is fully nonparametric. If the option pricing model is valid, the two volatility
estimates should not differ in a statistical sense. We formalize and operationalize this observation.
Under correct model specification, we establish a joint stable convergence law for the two estima-



                                                  2
tors, enabling us to devise a formal model specification test based on the distance between the
two volatility measures. Intuitively, this is feasible as, even though different volatility states (or
jump intensities) are not directly observed, the (total) diffusive volatility may be filtered from the
underlying asset data,2 and this value should coincide with that priced in the observed options.
      We propose additional new diagnostic tests for the option price dynamics. The first explores
the stability of the risk-neutral parameter estimates over distinct time periods. If the model is
misspecified, the period-by-period estimates will, in general, converge to a pseudo-true value, see,
e.g., White (1982) and Gourieroux et al. (1984). However, the latter changes over time as the
trajectory of the state vector varies across estimation intervals and, for incorrect model specification,
this cannot be accommodated by an invariant parameter vector. Hence, we develop a test based
on the discrepancy between the parameter estimates over subsequent time periods.
      Yet another diagnostic focuses on model performance over specific parts of the implied volatility
surface. The empirical option pricing literature typically gauges performance based on the time-
averaged fit for a limited set of options. In contrast, we may test for adequacy of the model implied
option pricing day-by-day. This diagnostic exploits our feasible limit theory by quantifying the
statistical error over the relevant portion of the surface, and then tests if it differs significantly from
zero. In essence, the approach allows us to disentangle the impact of observation errors (noise) in
the option prices from the systematic errors stemming from a misspecified model.
      We explore the finite sample properties of the estimators through an extensive Monte Carlo
study using the double-jump stochastic volatility model of Duffie et al. (2000), commonly used
in the option pricing literature. We find the inference technique to perform admirably within
realistically calibrated settings. Furthermore, in an empirical application using an extensive option
panel for the S&P 500 index, we estimate the model along with some new extensions. The expanded
system affords compensation for rare events through a time-varying jump intensity as well as a
two-factor volatility structure that adds flexibility to the link between the level of risk and the
associated compensation. The extension provides improvements in explaining the option price
dynamics, especially for the longer maturities, and it brings the extracted volatility state closer to
a nonparametric estimate constructed from high-frequency S&P 500 index returns. Nevertheless,
even our most general representation fails our full battery of specification tests. In particular, it
cannot suitably capture the rate of decay in option prices as we move deeper into the out-of-the-
money region. Our diagnostics suggest that alternative specifications for the jump distribution,
involving a more gradual decay in the Lévy density, are critical for alleviating such shortcomings.
  2
      See, e.g., Foster and Nelson (1996) for early work on this subject.




                                                            3
        The rest of the paper is organized as follows. Section 2 positions our contribution relative to the
dominant paradigms in the literature. Section 3 introduces our formal setup. Section 4 develops
our estimators and derives the feasible limit theory. In Section 5, we develop diagnostic tests for
the option price dynamics. Section 6 contains a Monte Carlo study of the proposed estimators. In
Section 7, we apply our estimation methods to analyze the option price dynamics of the S&P 500
index. Section 8 concludes. All proofs are deferred to the appendix.


2        Relation to Existing Option Pricing Paradigms
Two separate empirical approaches are dominant, reflecting different objectives in extracting in-
formation from options. One set of studies focuses on point-in-time nonparametric approximation
of the pricing functional for basic derivative securities, for example by smoothing the individually
observed Black-Scholes implied volatilities into a coherent surface covering all strikes and tenors
of interest. Closely related procedures generate nonparametric estimates of the risk-neutral den-
sity for the underlying asset at a given maturity using option prices across all available strikes,
exploiting ideas of Ross (1976) and Breeden and Litzenberger (1978). Again, by interpolation and
extrapolation, this procedure can generate risk-neutral density estimates for a broad range of ma-
turities as long as reliable option prices or quotes are available. However, a defining characteristic
of this approach is that option surfaces at different points in time are treated separately. There
is no attempt at enforcing coherence across the estimates of the risk-neutral measure, henceforth
denoted Q, across trading periods. In other words, the procedure does not seek to infer the dynamic
evolution of the risk-neutral probability measure. Instead, the objective of such “calibration” ex-
ercises is to provide a basis for coherent valuation of derivative securities at a point in time using
the contemporaneous pricing structure extracted from the universe of actively traded options.
        In contrast, a separate branch of the literature focuses on the dynamics of option pricing.
Here, the primary object of interest is extraction of the state vector dynamics, under the actual
probability measure, P, along with coherent modeling of the risk-neutral measure over time. These
studies are almost invariably parametric and exploit only a limited set of observations from the
option panel along with time series data for the underlying security to simultaneously estimate
the return generating process under P and Q. The approach relies, almost exclusively, on the
time series of underlying asset returns for estimation of the P dynamics, exploiting standard long
span asymptotics, while it infers the Q parameters from the options.3 Specifically, imposing tight
restrictions between the P and Q measures, the option prices identify a few auxiliary (Q) risk
    3
    Pan (2002) and Pastorello et al. (2003) use also limited number of options (determined by the dimension of the
latent state vector) in the inference of the P dynamics.


                                                        4
premium parameters.4 In such a setting, specification testing relies critically on the joint hypothesis
that the parametric models for the risk-neutral and the statistical distribution are well specified.
Thus, even if this approach is theoretically more consistent than the point-in-time calibration of
the Q density, it is subject to a number of pitfalls. There is no compelling reason that the two
distributions should be identical except for a few shifts in parameter values. It is possible – perhaps
even likely – that there are state variables characterizing the broader economic landscape which
exert an important impact on the risk premiums, and thus the Q parameters, but have a negligible
impact on the P dynamics. The existence of such state variables is hard to ascertain via procedures
that rely primarily on the asset returns for identification of the system dynamics.5 Failure to
account for the full state vector typically manifests itself through instability in the Q parameters as
the neglected state variables shift over time. Such instability may materialize only gradually if the
macroeconomic conditions change slowly, but the environment may also undergo a sudden regime
shift, with an immediate and dramatic effect on risk premiums.6
       Related problems arise from the limited, and inefficient, use of option panels. Relying on only
a few options, often representing just one or two separate maturities and a narrow strike range,
complicates the identification of critical features of the Q dynamics. Hence, even when using
the correct set of state variables, the power to detect model misspecification is hampered by the
systematic exclusion of informative data points. Finally, the presence of transaction costs, such as
bid-ask spreads, renders individual option prices noisy indicators of underlying valuations. Using
a larger set of options facilitates improved noise filtering and thus more precise inference.7
       The current work is motivated by a desire to overcome a number of the issues noted above. We
seek to conduct parametric inference regarding the Q parameters and the realized values of the
state vector, while exploiting the information in the option panel efficiently. In order to accommo-
date potential instability of the Q measure, relative to the identifiable state variables, we develop
inference techniques that require only a limited time span. Moreover, we accommodate general
types of option pricing errors. Finally, we stress the importance of developing powerful diagnostics
   4
      There are a few empirical papers which rely solely on a long option panel with a fixed cross-section (i.e., without
explicitly modeling the P law) but the formal treatment of the option error in this case is not clear.
    5
      A corresponding argument applies to models for the term structure of interest rates. In this context, Joslin
et al. (2010) document important links between (unspanned components of) the macroeconomic environment and
the pricing of risk.
    6
      For example, one cannot rationalize the permanent shift in the implied volatility skew for equity-index options
following October 1987 via state variables estimated solely from stock returns. One way to accommodate this change
is by a shift in an underlying state variable impacting only the risk-neutral dynamics. This illustrates the need for
flexibility in modeling risk premiums. Similar, albeit more gradually evolving, problems may plague empirical studies
based on option panels and return series covering long time spans.
    7
      See, e.g., Bates (2003) for a discussion of these issues.




                                                           5
for adequate fit to the option panel. In order for this approach to be widely applicable, it should
be valid regardless of the nature of the P dynamics. We ensure robustness in this dimension by
avoiding specific assumptions regarding the objective probability measure.8
    In summary, we adopt an expansive view of the informativeness of option data. Our premise
is that the option panel – in-and-of-itself – suffices for identifying both the risk-neutral distribu-
tion and the realized trajectory of the underlying state vector. As a result, we deviate from the
traditional approaches along critical dimensions. First, we avoid specifying a parametric model
for the underlying asset price process, and we do not rely on long-span asymptotics. This allows
us to estimate the Q distribution consistently in a flexible manner over short intervals of time,
independently of the P dynamics. Moreover, we can test for parameter stability and we may ex-
plicitly accommodate shifts in this distribution.9 Second, we develop formal diagnostics that allow
for direct testing of whether the current diffusive volatility state under the P and Q measures are
identical. In addition, we provide diagnostics that focus on the fit to limited regions of the volatility
surface and over short time intervals, thus enhancing the power of these specification tests. Third,
prior work conducting inference from options either excludes observation errors or assumes they are
Gaussian. By contrast, exploiting the large option price surface, we can be nonparametric about
the observation error and allow for their presence in our feasible limit theory. Fourth, while the
“calibration” approach uses a flexible functional form to fit the implied volatility surface, typically
exploiting an independent calibration at each point in time, we impose temporal stability of the
risk-neutral parameters over (limited periods of) time, enabling formal inference.


3     The Basic Modeling Framework
3.1    Setup and Notation

We first establish some notation. The underlying univariate asset price process is denoted Xt and
                                                                    
                                            (0)   (0)   (0)      (0)
is defined on a filtered probability space Ω , F , (Ft )t≥0 , P        . It is assumed to have the
following very general dynamics (under P(0) )

                               dXt          p         Z
                                   = αt dt + Vt dWt +       xµ
                                                             e(dt, dx) ,                                           (1)
                               Xt−                     x>−1
   8
     Nonetheless, since our approach produces a time series of estimates for the realization of the state vector, it
should facilitate the development of inference tools for the P dynamics as well.
   9
     Gagliardini et al. (2011) also specify only the risk-neutral distribution, while drawing inference regarding the
option pricing dynamics, exploiting the extended method of moments. Here, the major difference is that Gagliardini
et al. (2011) develop the asymptotic distribution results along an entirely different dimension, as they rely on a long
span of data, but only a small – and fixed – cross-section of option prices, assumed to be observed without error.




                                                          6
where αt and Vt are càdlàg; Wt is a P(0) -Brownian motion; µ is an integer-valued random measure
counting the jumps in X, with compensator νe P (dt, dx) = at dt ⊗ ν P (dx) for some process at and
Lévy measure ν P (dx), and the associated martingale measure is µ
                                                                 e = µ − νe P . Furthermore, we
denote the expectations operator under P(0) by E[·]. We assume X satisfies the following condition.

Assumption A0. The process X in equation (1), defined over the fixed interval [0, T ], satisfies:
   (i) For any s, t ≥ 0, there exists a constant K > 0 such that E |Vt − Vs |2 ∧ K ≤ K|t − s|.
                                                                  

   (ii) x>−1 (|x|β ∧ 1) ν P (dx) < ∞, for some β ∈ [0, 2).
        R

   (iii) inf t∈[0,T ] Vt > 0 and the processes αt , Vt and at are locally bounded.

Assumption A0 is quite weak. A0(i) is satisfied when the evolution of Vt is given by a (multivariate)
stochastic differential equation which is a common modeling approach for jump-diffusive asset re-
turns displaying stochastic volatility. Assumption A0(ii) restricts the so-called Blumenthal-Getoor
index of the jumps to be below β and some of our results, such as Theorem 3 below, depend on
the value of this coefficient. Finally, assumption A0(iii) implies that, at each point in time on
[0, T ], the price process has a non-vanishing continuous martingale component. This assumption
                                       RT
may be relaxed to require only that 0 Vt dt > 0, but it is nevertheless very weak and satisfied
for the models typically used in asset pricing. We note that assumption A0 does not involve any
integrability or stationarity conditions for the model.
   The risk-neutral probability measure, Q, is guaranteed to exist by standard no-arbitrage re-
strictions on the price process, see, e.g., Duffie (2001), and is locally equivalent to P. It transforms
discounted asset prices into (local) martingales. In particular, for X under Q, we have,

                       dXt                     p            Z
                             = (rt − δt ) dt + Vt dWt +            xµe(dt, dx) ,                        (2)
                       Xt−                                   x>−1

where rt is the instantaneous risk-free interest rate and δt is the instantaneous dividend yield.
Moreover, with slight abuse of notation, Wt now denotes a Q-Brownian motion and the jump
martingale measure is defined with respect to the risk-neutral compensator νeQ (dt, dx).
   We further assume that the diffusive volatility and the jump process are governed by a (latent)
state vector, so that Vt = ξ1 (St ) and νeQ (dt, dx) = ξ2 (St )⊗ν Q (dx), where ν Q (dx) is a Lévy measure;
ξ1 and ξ2 are functions in C 2 , and St denotes the p × 1 state vector. Moreover, we assume that
rt and δt are smooth functions of the state vector St , and that the latter follows a jump-diffusive
Markov process under Q. This specification nests most of the continuous-time models used in
empirical work, including, e.g., the affine jump-diffusion class of Duffie et al. (2000).
   We denote European-style out-of-the-money option prices for the asset X at time t by Ot,k,τ .



                                                     7
Assuming frictionless trading in the options market, the option prices are given as,
                               h R                           i
                         EQ e− tt+τ (rs −δs ) ds (Xt+τ − K)+ , if K > Ft,t+τ ,
                              t
             Ot,k,τ =           h R                           i                                                      (3)
                         EQ e− tt+τ (rs −δs ) ds (K − X )+ , if K ≤ F
                              t                          t+τ                  t,t+τ ,

where τ is the time-to-maturity, K is the strike price, Ft,t+τ is the price of the futures contract on
the underlying asset at time t expiring at time t + τ , and k = ln(K/Ft,t+τ ) is the log-moneyness.
                                                                                ert,t+τ Ot,k,τ
The Markovian assumption on the state vector, St , implies that                     Ft,t+τ         is a function only of
time-to-maturity, the state vector, and the moneyness (as well as t, if St is not stationary under Q),
where rt,t+τ is the risk-free interest rate for the period [t, t+τ ]. We denote the Black-Scholes implied
volatility corresponding to the option price Ot,k,τ by κt,k,τ . This merely represents an alternative,
and convenient, pricing convention for the options, as the Black-Scholes implied volatility is a
                                                                              ert,t+τ Ot,k,τ
deterministic and strictly monotone transformation of the ratio                   Ft,t+τ       .

3.2    The Parametric Option Pricing Framework

Henceforth, we assume a parametric model for the risk-neutral distribution, characterized by the
q × 1 parameter vector θ, with θ0 signifying the true value. The option panel has a fixed time span,
but contains a large cross-section spanning a significant range of k and τ values. This is a natural
assumption for active and liquid derivatives markets. Moreover, this section focuses on the ideal
case of no errors in the observed option prices. The critical extension to the case involving such
errors is provided in Section 4.2. The theoretical value of the Black-Scholes implied volatility under
the risk-neutral model is denoted κ(k, τ, St , θ).10 For each trading day t, we have a cross-section
of option prices {Ot,kj ,τj }j=1,...,Nt for some integer Nt , where the index j runs across the full set
of strike and time-to-maturity combinations available on day t. The number of options for the
maturity τ is denoted by Ntτ with Nt = τ Ntτ . We invoke the following condition to formally
                                         P

capture the notion of a large, yet potentially heterogeneous, cross-section of options.

Assumption A1. Fix T > 0. For each t = 1, ..., T and each moneyness τ , the number of options
Ntτ ↑ ∞ with Ntτ /Nt → πtτ and Nt / Tt=1 Nt → ςt , for some positive numbers πtτ and ςt . Further, for
                                   P

each pair (t, τ ), k(t, τ ) and k(t, τ ) denote the minimum and maximum log-moneyness, respectively,
on day t with maturity τ and the grid of moneyness of the options is given by k(t, τ ) = kt,τ (0) <
kt,τ (1)... < kt,τ (Ntτ ) = k(t, τ ). We assume that the sequence of moneyness grids is nested, and
further if we denote ∆t,τ (i) = kt,τ (i) − kt,τ (i − 1), then Nt ∆t,τ (i) → ψt,τ (k) uniformly on the
interval (k(t, τ ), k(t, τ )), where ψt,τ (·) takes on finite and strictly positive values.
  10
    Recall that St is a Markov process. If the dynamics of St is non-stationary under Q, then κ should also have a
subscript t. For notational simplicity, we impose stationarity, but the analysis readily accommodates non-stationarity.


                                                          8
    Assumption A1 allows for a great deal of intertemporal heterogeneity in the observation scheme.
For example, the times-to-maturity need not be identical across days and the assumption of a fixed
number of maturities at each point in time is imposed only to simplify the exposition. Importantly,
we allow for a different number of options in the panel across days, maturities and moneyness.
    We supplement the large cross-section of options with an identification requirement:

Assumption A2. For every  > 0 and T > 0 finite, we have
                                                  T XZ
                                                  X          k(t,τ )
                        inf                                            (κ(k, τ, St , θ0 ) − κ(k, τ, Zt , θ))2 dk > 0 a.s.,
      t=1,...,T : ∪ ||Zt −St ||> ∪ ||θ−θ0 ||>             k(t,τ )
                                                  t=1   τ

with θ ∈ Θ for some compact set Θ.

    We emphasize that this identification condition varies across distinct realizations of the state
vector. Assumption A1 and A2 imply that, given correct model specification, we can recover the
parameter vector as well as the state vector realization without error at any point in time. While
the state variables change from period to period, the parameter vector should remain invariant.
Similarly, the fit to the option prices provided by the model should be perfect. These restrictions
may serve as the basis for specification tests. Moreover, the parametric model has implications for
the pathwise behavior of X across all equivalent probability measures. Most notably, the diffusion
coefficient of X, ξ1 (St ), should be identical for Q and P. This property is also testable: the diffusion
coefficient may be recovered nonparametrically from a continuous record of X and contrasted with
the model-implied ξ1 (St ). We develop formal tests for such pathwise restrictions of the risk-neutral
model in Section 5, covering the empirically relevant case of noisy option price observations.


4      Inference for Option Panels with a Fixed Time Span
4.1      Insights from Error-Free Option Panels

In a frictionless market with continuous trading, no arbitrage opportunities and, consequently, no
pricing errors, the observed option prices should perfectly match those generated by a correctly
specified parametric model. This immediately suggests calibrating the risk-neutral parameters by
matching the actual option prices to the model-implied prices, given as a function of the unknown
parameter and state vectors, and then “inverting” the system to solve for the unknown parameters
and state variables. In fact, since there are q unknown Q parameters and the state vector is p-
dimensional, we need – subject to suitable regularity conditions – only p + q different option prices
to infer the unknown parameters and states. The only issue is whether the inverse mapping from a



                                                                  9
given value of model prices, expressed in Black-Scholes implied volatilities, κ(k, τ, St , θ), back into
the parameter and state vector, θ and St , is one-to-one.
       In the error-free case, it is therefore, in principle, straightforward to identify the risk-neutral
distribution and the state vector realization at any point in time. However, anticipating the empiri-
cally relevant case with observation error, it is clear that the quality of the inference will depend on
the specific set of options used in the analysis. In particular, prices for options with similar strikes
and maturities are highly correlated, so it is beneficial for identification to exploit options spanning
a wide range of moneyness and tenors. Intuitively, options with diverse characteristics load very
differently on the volatility and jump risks. Specifically, close-to-maturity, deep out-of-the-money
(OTM) puts and calls load, respectively, mostly on the negative and positive jumps. Similarly,
short and long term options load differently on volatility state variables which differ in their degree
of persistence. Thus, the information content is also enhanced if the panel covers periods with a
wide variation in the realization of the state vector.11
       In summary, if we exploit a broad cross-section of options and manage to limit the impact
of observation error on the inference, the qualitative insights from the ideal frictionless modeling
framework regarding the informativeness of the option panel should carry over to the noisy setting.
We conclude this section with a few remarks regarding our setup.

Remark 1. In a setting where the time span T of the option panel increases, one may exploit the
time series of the recovered state vector, St to estimate, parametrically or nonparametrically, the
associated P law. Hence, an option panel with increasing time span (and wide enough cross-section)
suffices for estimation of both the Q and P measures, and thus also the risk premiums associated
with dynamics of the state vector. There is, in principle, no need for direct observations on the
underlying asset.

Remark 2. Our emphasis on the superior information content of option panels is related to the
intuition behind the Recovery Theorem of Ross (2011). Under certain conditions regarding the asset
price dynamics, he shows that the projection of the pricing kernel on the space of returns of the
underlying asset can be recovered from observing the derivatives prices alone. In our setting, we
are interested in the pricing kernel (respectively risk-neutral probability) on a wider filtration that
incorporates multiple, possibly latent, state variables, but we “reduce the dimension of the kernel”
by parameterizing it. In this setting, we also find that the derivatives prices encapsulate critical
information for the pricing of the risks associated with the dynamics of the state variables.
  11
    Of course, this hinges on the stability of the risk-neutral distribution over time, but this assumption may be
explicitly tested, as we demonstrate in Section 5.



                                                       10
Remark 3. There are marked differences in the information content of the option panel (with a
fixed time grid) versus the price path of the underlying asset. A continuous record of the X process
lets us estimate the aggregate diffusive volatility, without error, from a local neighborhood of the
current time in nonparametric and model-free fashion, and we can identify the timing and exact
size of any price jumps. In contrast, the option data enable us to directly observe the state vector,
St . If the state vector consists of a single (diffusive) volatility factor, Vt , as is commonly assumed,
the two approaches provide equivalent, and perfect, inference about the state of the system. If the
model allows for price jumps, the option panel allows us to infer the possibly time-varying risk-
neutral jump intensities along with the associated jump distributions, but they do not reveal actual
jump realizations. On the contrary, the price path for X identifies the actual jumps, but it does not
identify the jump distribution. Finally, if the model is generalized to a multi-factor volatility setting,
as implied by an extensive body of empirical research, then the options data become even more
valuable for inference. For example, suppose there are two volatility factors, so that Vt = V1,t + V2,t .
The high-frequency data for X directly informs us about the aggregate value of Vt only, while the
option data enable us to separately identify the two components, V1,t and V2,t .

4.2      Estimation based on Noisy Option Panels
We continue next with the empirically relevant case of noisy observations. Figure 1 depicts a non-
parametric kernel regression estimate of the relative bid-ask spread in the quotes for S&P 500 index
options, in units of Black-Scholes implied volatility, as a function of the moneyness, normalized by
volatility. The spread is non-trivial and increases quite sharply for deep OTM calls. However, even
if the noise in any individual option price is significant, the impact may be mitigated by exploiting
an extensive cross-section of option prices.12
       In the remainder of this section, we develop inference procedures for the parameter vector, θ,
governing the risk-neutral distribution and the realized trajectory of the state vector {St }t=1,...,T
based on an option panel, observed with error. We first introduce our assumptions regarding option
errors, then define our estimator and, in turn, establish consistency and asymptotic normality.

4.2.1      The Option Error Process

We stipulate that option prices, quoted in terms of Black-Scholes implied volatility, are observed
with error, i.e., we observe κ
                             bt,k,τ ,
                                             κ
                                             bt,k,τ = κt,k,τ + t,k,τ ,
  12
    A similar perspective underlies the CBOE computation of the volatility VIX index. It includes all relevant short
maturity S&P 500 index options within the prescribed strike range, with the implicit premise that the observation
errors largely “wash out” in the integration.


                                                        11
                                                      IV error kernel regression
                           0.13


                           0.12


                           0.11


                            0.1
          (I Va +IVb )/2




                           0.09
             I Va −I Vb




                           0.08


                           0.07


                           0.06


                           0.05


                           0.04
                              −4   −3         −2                 −1                    0            1             2
                                                                        log(K/F )
                                                     Log Moneyness:         √
                                                                           σ τ




Figure 1: Kernel regression estimate of the bid-ask spread of option implied volatility as a function
of moneyness. The estimates are based on the best bid and ask quotes for the S&P 500 options on
the CBOE at the end-of-trading for each Wednesday during January 1, 1996 – July 21, 2010. We
use all available options with maturities up to a year. F and σ denote, respectively, the futures
price and the Black-Scholes at-the-money implied volatility at the end of the trading day.



where the errors, t,k,τ , are defined on a space Ω(1) =                                   At,k,τ for At,k,τ = R, with Γ
                                                                             t∈N,k∈R,τ ∈Γ
denoting the set of all possible tenors. Ω(1) is equipped with the product Borel σ-field F (1) , with
transition probability P(1) (ω (0) , dω (1) ) from the original probability space Ω(0) – on which X is
                                                                              (1)
defined – to Ω(1) . We define the filtration on Ω(1) via Ft                         = σ (s,k,τ : s ≤ t). Then the filtered
probability space (Ω, F, (Ft )t≥0 , P) is given as follows,

Ω = Ω(0) ×Ω(1) , F = F (0) ×F (1) , Ft = ∩s>t Fs(0) ×Fs(1) , P(dω (0) , dω (1) ) = P(0) (dω (0) )P(1) (ω (0) , dω (1) ).

Processes defined on Ω(0) or Ω(1) may trivially be viewed as processes on Ω as well, e.g., Wt continues
to be a Brownian motion on Ω. We henceforth adopt this perspective without further mention.
    Given the presence of observation error in the option prices, we cannot identify the parameters
and state vector simply by inverting the option pricing formula, as discussed in Section 4.1. We must
explicitly accommodate the impact of noise on the inference. In particular, if a limited set of options
is included in the analysis, then inference is only feasible under strict parametric assumptions
regarding the error distribution. This is problematic as we have little evidence pertaining to the
nature of these price errors. In contrast, a large cross-section allows us to “average out” the errors
and remain fully nonparametric regarding their distribution. However, this error “diversification”
only works if we can ensure that the effect of the option price errors vanishes in a suitable manner.

                                                          12
The following condition will suffice for establishing consistency of our estimator.

Assumption A3. For every  > 0 and T > 0 finite, we have
                                               PT   1 PNt
                                                t=1 Nt   j=1 [κ(kj , τj , St , θ0 ) − κ(kj , τj , Zt , θ)] t,k,τ    P
                     sup                        PT 1 PNt                                                     2
                                                                                                                    −→ 0 ,
   t=1,...,T : ∪ ||Zt −St ||> ∪ ||θ−θ0 ||>      t=1 Nt   j=1 [κ(kj , τj , St , θ0 ) − κ(kj , τj , Zt , θ)]

when mint=1,...,T Nt → ∞ for all θ ∈ Θ.

If the state vector St has bounded support, assumption A3 follows from a uniform Law of Large
Numbers on compact sets for which primitive conditions are well known, see, e.g., Newey (1991) and
the references therein. Of course, for typical models of the asset price dynamics, the (stochastic)
volatility process, and thus St , has unbounded support. In this scenario one may establish the
validity of Assumption 3 in one of two ways. First, one may apply a nonparametric estimator for
Vt based on high-frequency data on the underlying asset. For the vast majority of applications,
the entire St vector determines Vt , and this will constrain St to reside within a compact set with
probability approaching 1. Alternatively, whenever the state vector St increases sharply (towards
infinity), the option price will, for all empirically relevant models, diverge as well, and this will
drive the ratio in assumption A3 toward zero. Therefore, the asymptotic negligibility result in
assumption A3 may be derived as a consequence of uniform convergence on a space of functions
vanishing at infinity; see, e.g., Theorem 21 in Ibragimov and Has’minskii (1981).
   We need additional regularity conditions to characterize the limiting distribution for the state
and parameter vector estimates. We state those in the following.

Assumption A4. For the error process, t,k,τ , we have,
   (i) E t,k,τ |F (0) = 0 ,
                       
                       
   (ii) E 2t,k,τ |F (0) = φt,k,τ , for φt,k,τ being a continuous function in its second argument,
   (iii) t,k,τ and t0 ,k0 ,τ 0 are independent conditional on F (0) , whenever (t, k, τ ) 6= (t0 , k 0 , τ 0 ),
                            
   (iv) E |t,k,τ |4 |F (0) < ∞, almost surely.

Assumption A4 implies that the observation errors, conditional on the filtration F (0) , are inde-
pendent. Nonetheless, the error process may display a stochastically evolving volatility which
can depend on option moneyness and tenor as well as any other process defined on the original
probability space such as the entire history of Xt and St . Hence, it is considerably weaker than
unconditional independence. Relative to the earlier literature, we avoid parametric modeling of the
error and allow for significant flexibility for its conditional distribution, including the variance and
higher order moments. Assumption A4 does, however, rule out correlated option errors, although
this requirement may also be weakened.

                                                               13
Remark 4. Assumption A4 is analogous to the conditions imposed on the microstructure noise
process for asset prices observed at high frequencies in Jacod et al. (2009) and subsequent papers.
We stress that part (i) is critical for the subsequent results, although it may be weakened by allowing
for a bias which vanishes asymptotically. Part (iii) excludes correlation in the error across strikes,
but we can accommodate week (spatial) dependence in the errors, at the cost of more complicated
notation (and proof ). On the other hand, if the option errors contain a common component across
all strikes, then this error, obviously, cannot be “averaged out” by spatial integration in the money-
ness dimension, as we do below in our estimation. For example, Bates (2000) assumes that option
prices on a given day, for moneyness within prespecified ranges, may contain such a common error
component. He interprets this as a model specification error while, in our setting, such features
should be included in the theoretical value κ(k, τ, St , θ0 ) rather than being treated as errors.

Remark 5. If one deems the unbiasedness property of the error to be more appropriate for the
option price level instead of the Black-Scholes implied volatility – which constitutes a nonlinear
transformation of the price – then one should instead minimize the distance between observed and
model-implied option prices. For our empirical application, we find the implied volatilities to be
approximately linear in prices across the range of moneyness we exploit, so the distinction between
unbiasedness of the implied volatilities or the prices is not a practical concern; see, e.g., Christof-
fersen and Jacobs (2004) for a discussion of the impact of the error specification.

4.2.2        Consistency

In order to more formally define our inference procedure, we first introduce an arbitrary consis-
tent nonparametric estimator for the spot variance, Vt , obtained from high-frequency data on the
underlying asset. We denote this estimator Vb n , where n signifies the number of high-frequency
                                                                         t
observations of X that are available within a unit interval of time (an explicit example of Vbtn is
provided in Section 5). Our estimates for the state vector and the risk-neutral parameters based
on the option panel (and the high-frequency data) are then obtained as follows,
                                                                                                                               
                                                              T       Nt                                                    2 
  
       b n }t=1,...,T , θbn
                                                            X     1 X                                  2
                                                                                                             
      {S t                        =        argmin                          κt,k,τ − κ(kj , τj , Zt , θ)) + λn Vbtn − ξ1 (Zt )
                                                                          (b                                                      , (4)
                                      {Zt }t=1,...,T , θ∈Θ        Nt                                                           
                                                             t=1      j=1


for a deterministic sequence of nonnegative numbers {λn }. The estimation is based on minimizing
the mean squared error in fitting the panel of observed option implied volatilities, with a penaliza-
tion term that reflects how much the implied spot volatility deviates from a model-free volatility
estimate. The presence of Vbtn in the objective function serves as a regularization device that helps
identify the parameter vector by penalizing values that imply “unreasonable” volatility levels.


                                                                             14
Remark 6. The presence of the penalization term in (4) is reminiscent of the inclusion of infor-
mation regarding the P dynamics of the state variables in the option-based estimation, e.g., Bates
(2000) and Pan (2002). There is, however, a fundamental difference in our approach. We do
not model the P dynamics and the penalization in (4) concerns the pathwise behavior of the option
surface, not its P law. This is therefore, a more robust (we do not parameterize the P law) and
stronger (it is pathwise) restriction on the option dynamics.


The procedure in (4) is akin to nonlinear least squares (NLS) estimation but, unlike the usual case
in econometrics, the conditional mean equation changes across the option observations indexed by
                                                   
the triple (t, k, τ ). The consistency of Sb n , θbn follows from the next theorem.
                                          t   t


Theorem 1 Suppose assumptions A1-A3 hold for some T ∈ N fixed and that {Vbtn }t=1,...,T is con-
sistent for {Vt }t=1,...,T as n → ∞. Then, if mint=1,...,T Nt → ∞ and λn → λ for some finite λ ≥ 0
                                     
                                 n  n
as n → ∞, we have that St , θt exists with probability approaching 1 and further that,
                               b   b

                         b n − St || −→ 0, ||θbn − θ0 || −→ 0,
                       ||S
                                     P                    P
                                                                  t = 1, ..., T.                  (5)
                           t


Thus, in the presence of observation errors satisfying assumption A3, we can still recover the state
vector as well as the risk-neutral parameters consistently from the option panel. The key difference
between the parameters and the state vector is that the latter changes from day to day, while
the former must remain invariant across the sample. The longer the time span covered by the
sample, the more restrictive is this invariance condition for the risk-neutral measure. Another
major distinction stems from the penalization term constructed from high-frequency data as this
term involves only the state vector and not directly the risk-neutral parameters.

4.2.3   The Limiting Distribution of the Estimator

In analogy to the high-frequency based realized volatility estimators, which also rely on in-fill
                                                                                                  L−s
asymptotics, our limiting distribution results involve stable convergence. We use the symbol −→
to indicate this form of convergence. It is an extension of the standard notion of convergence in
law to the case where the limiting sequence converges jointly with any bounded variable defined on
the original probability space. It is particularly useful when the limiting distribution depends on
FT , as is the case in our setting. For formal analysis of this concept, see, e.g., Jacod and Shiryaev
(2003) and the references therein. The stable convergence result in the following theorem is critical
for enabling our feasible inference as well as the development of our diagnostic tests in Section 5.



                                                  15
Theorem 2 Assume A1-A4 are satisfied for T ∈ N fixed and κ(t, τ, Z, θ) is twice continuously-
differentiable in its arguments. Then, if mint=1,...,T Nt → ∞ and λ2n mint=1,...,T Nt → 0, for n → ∞,
we have:

                              √                                                  
                                       b n − S1 )
                                   N1 (S                                 E1
                                         1
                                        ..                              .. 
                                                                          
                                                    
                                         .            L−s              . 
                                                      −→ H−1 (ΩT )1/2 
                         
                                                                             ,                                   (6)
                               √
                         
                                                           T
                                         n
                                                                          
                         
                                NT (ST − ST )
                                       b             
                                                     
                                                                        ET 
                                                                            
                             q
                               N1 +...+NT bn                               0
                                    T      (θ − θ0 )                     E


where E1 ,...,ET are p × 1 vectors and E0 is q × 1 vector, all defined on an extension of the original
probability space being i.i.d. with standard normal distribution, and we define

                                                                              
                             Φ1,1           ...         0p×p         Φ1,T   +1
                            T                                         T
                            ..             ..            ..             ..
                                                                               
                                               .
                                                                               
                            .                             .              .    
                         Φ=                                                   ,   Φ = H, Ω,                     (7)
                                                        ΦT,T           T,T +1 
                           
                            0p×p
                                           ...          T           ΦT        
                                                                               
                            ΦTT +1,1        . . . ΦTT +1,T           T +1,T +1
                                                                    ΦT


with the blocks of H and Ω for t = 1, ..., T given by
                        R k(t,τ )
           Ht,t = τ πtτ k(t,τ ) ψt,τ1(k) ∇S κ(k, τ, St , θ0 ) ∇S κ(k, τ, St , θ0 )0 dk,
                  P
        
        
            T
                                       R k(t,τ )
           HTT +1,T +1 = Tt=1 τ πtτ k(t,τ ) ψt,τ1(k) ∇θ κ(k, τ, St , θ0 ) ∇θ κ(k, τ, St , θ0 )0 dk,
                        P P

         Ht,T +1 = HT +1,t 0 = P π τ R k(t,τ ) 1 ∇ κ(k, τ, S , θ ) ∇ κ(k, τ, S , θ )0 dk,
        
                             
        
             T          T              τ t k(t,τ ) ψt,τ (k)    S          t 0        θ        t 0

                 R k(t,τ )
    Ωt,t = τ πtτ k(t,τ ) ψt,τ1(k) φt,k,τ ∇S κ(k, τ, St , θ0 ) ∇S κ(k, τ, St , θ0 )0 dk,
           P
  
  
     T
                                    R k(t,τ )
    ΩTT +1,T +1 = Tt=1 T1ςt τ πtτ k(t,τ ) ψt,τ1(k) φt,k,τ ∇θ κ(k, τ, St , θ0 ) ∇θ κ(k, τ, St , θ0 )0 dk,
                 P          P

   Ωt,T +1 = ΩT +1,t 0 = √ 1 P π τ R k(t,τ ) 1 φ
  
                      
                                                                                                           0
                                       τ t k(t,τ ) ψt,τ (k) t,k,τ ∇S κ(k, τ, St , θ0 ) ∇θ κ(k, τ, St , θ0 ) dk.
  
      T          T             Tς       t


Consistent estimates for HT and ΩT are given by H
                                                b T and Ω
                                                        b T , where for the same partition of the
matrixes as in (7), we set
             
                 b t,t    1 PNt                                  b b0
              HT = Nt j=1 ∇S κ(kj , τj , St , θ) ∇S κ(kj , τj , St , θ) ,
             
                                             b b
             
                Hb T +1,T +1 = PT 1 PNt ∇θ κ(kj , τj , S
                                                       b t , θ)
                                                             b ∇θ κ(kj , τj , S     b 0,
                                                                              b t , θ)                            (8)
                   T              t=1 Nt  j=1
                                        0
             
                                    
             
              H b t,T +1 = H b T +1,t = 1 PNt ∇S κ(kj , τj , Sb t , θ)
                                                                     b ∇θ κ(kj , τj , S     b 0,
                                                                                      b t , θ)
                     T              T              Nt     j=1




                                                               16
                                                   2
   b t,t = 1 PNt κ
    Ω                      j − κ(kj , τ j , b t , θ)
                                            S     b     ∇S κ(kj , τj , S
                                                                       b t , θ)
                                                                             b ∇S κ(kj , τj , S     b 0,
                                                                                              b t , θ)
  
     T      Nt    j=1   b
                                                                                     2
  
                    PT                                                           
    b T +1,T +1 = ( t=1 Nt ) PT          1
                                             PNt                                                                                   b 0,
                                                  j=1 κ  bj − κ(kj , τj , S
    Ω                                                                     b t , θ)
                                                                                b      ∇θ κ(kj , τj , S
                                                                                                      b t , θ)
                                                                                                            b ∇θ κ(kj , τj , S
                                                                                                                             b t , θ)
      T                 T        t=1 Nt2
  
                        0   r  PT                                                  2
  
    b t,T +1 = Ω  b T +1,t =          t=1 Nt
                                                 PNt                                                                                 b 0.
                                                    j=1 κ bj − κ(kj , τj , S
   Ω
                                                                            b t , θ)
                                                                                   b     ∇S κ(kj , τj , Sb t , θ)
                                                                                                               b ∇θ κ(kj , τj , S
                                                                                                                                b t , θ)
      T             T                T N3     t

                                                                                                                                             (9)


Several comments are in order. First, we reiterate that the limit result in (6) holds stably conditional
on the filtration of the original probability space. The limit is mixed-Gaussian, with a mixing
variable, H−1
           T (ΩT )
                   1/2
                       , that is adapted to FT .13 The random asymptotic variance of the estimator
implies that the precision in recovering the state vector and the risk-neutral parameters varies from
period to period, depending on the level of the state variables and underlying asset prices as well as
the number and characteristics of the options used for estimation (maturity and moneyness). This
provides important flexibility as the features of the option data do change from day to day. It also
allows us to formally compare estimates across different time periods and we make frequent use of
this fact in the next section. We also stress that Theorem 2 does not require any form of stationarity
or ergodicity of the state vector, respectively volatility, under the statistical distribution. As noted
previously, many of the results established above mimic features of the limiting distributional theory
for volatility estimators based on high-frequency data, see, e.g., Barndorff-Nielsen et al. (2006).
  It is straightforward to implement feasible inference using the estimates in equations (8)-(9).
                                                                                                     
We may obtain the requisite consistent estimate of the asymptotic variance for {Sb n }t=1,...,T , θbn
                                                                                                                          t
from a consistent estimator of the option error, t,k,τ . Moreover, based on equations (8) and (9),
pivotal tests such as t-tests for the parameters are readily constructed. This is a by-product of the
stable convergence in equation (6), which ensures that the result holds jointly with the convergence
in probability of H
                  b T and Ω
                          b T to their (random) asymptotic limits.
    We also note that Theorem 2 allows for conditional heteroscedasticity in the option price error.
In analogy with the standard NLS, when the observation errors are conditionally homoscedastic,
i.e., E(2t,j,k |F (0) ) = φ, for φ non-random and constant, then ΩT = φHT (recall ΩT and HT are
  (0)
FT -adapted random variables) and the estimator is asymptotically efficient. More generally, when
conditional homoskedasticity is violated, we may restore efficiency by weighting the option squared
errors in (4) appropriately over the space (t, k, τ ). The weights depend on a consistent estimate
for the dependence of the conditional variance of t,k,τ on k (parametric or nonparametric), for
each pair (t, τ ), in a manner similar to the standard weighted least squares estimators, see, e.g.,
  13
     More formally, the matrices should be denoted HT (ω (0) ) and ΩT (ω (0) ) to highlight the fact that they depend on
the particular realization on the original probability space.



                                                                     17
Robinson (1987) and Newey and McFadden (1994).

Remark 7. Our setup may be contrasted to the cross-sectional regressions with common shocks
analyzed by Andrews (2005); see also Kuersteiner and Prucha (2011) for extensions. Andrews
(2005) analyzes cross-sectional least squares estimators where both the errors and regressors are
i.i.d., but conditional only on an F0 -adapted random variable. Within that setting, stronger result
may be derived compared to our stable convergence. In our setting, the role of the regressors is taken
on by the state vector, St , but it is not directly observable and, critically, it exhibits strong temporal
dependence. Most importantly, the stable convergence results of Theorem 2 are obtained for a much
wider σ-field than (a subfield of ) F0 – as in Andrews (2005) – enabling feasible inference from the
observed options. Further, in Theorem 3 of the next section, we show that the stable convergence
of Theorem 2 holds jointly with that of a high-frequency estimator for spot volatility. The general
stable convergence result in Theorem 2 is crucial for establishing this property.

Remark 8. The assumption, λ2n mint=1,...,T Nt → 0, in Theorem 2 ensures that the penalty term
in (4) has no first-order asymptotic effect in the estimation. We can readily extend the analysis to
cover scenarios in which the penalty term is reflected in the limiting distribution. The requirement
is that the joint limiting distribution of the nonparametric estimator Vb n and the empirical processes
                                                                           t
arising from the option pricing error – determining the limit in (6) – is known. This is satisfied for
the nonparametric jump-robust realized volatility estimators we invoke in the following section.


5    Pathwise Risk-Neutral Model Tests

As noted in Section 2, the model for the risk-neutral dynamics has numerous testable implications.
The previous section provides the necessary limit theory to develop formal tests for these restric-
tions. We propose a battery of diagnostics, grouped into three separate categories: the first gauges
the quality of the model fit to the option surface, the second checks for stability of the risk-neutral
parameters over time, and the third assesses the equality between the option-implied volatility and
a nonparametric volatility estimate based on high-frequency data. These tests are all pathwise in
nature as they involve restrictions on the observed paths of the option surface and the underlying
asset prices. Importantly, they do not require any assumptions regarding the statistical law of the
process X, beyond what is implied by the risk-neutral law. As such, they do not rely on a joint
hypothesis of correctly specified models under both the P and Q measures.




                                                    18
5.1     Option Price Fit

We first develop a test based on the fit afforded by the parametric model. The previous section
supplies us with tools to formally separate the observation error in option prices from the model
misspecification error in fitting option prices. The corollary below provides a t-test that captures
the quality of the model fit to the option surface at a specific point in time for a given maturity.

Corollary 1 Let K ⊂ k(t, τ ∗ ) k(t, τ ∗ ) be a set with positive Lebesgue measure and denote by NtK
                                         

the number of options on day t with time to maturity τ ∗ and log-moneyness belonging to the set K.
Then, under the assumptions of Theorem 2, we have,

                                                                                                                                                        
                    bt,kj ,τ ∗ − κ(kj , τ ∗ , S
                                              b n , θbn )
  P
      j:kj ∈K       κ                           t          L−s
                                                                                                            b −1 Ω
                                                                                                            H         b −1 )0 H
                                                                                                                 b T (H       b −1 Υ
                                                                                                                                   b 1,T
                                                                                                              T         T       T
                       q                                   −→ N (0, 1),                        Ξ
                                                                                               bT =                                                        , (10)
                           Π
                           b Ξ0 bT Π                                                                            b 0 (H
                                                                                                                Υ     b −1 )0                Υ
                                                                                                                                             b 2,T
                                                                                                                  1,T
                                   bT                                                                                   T
                            T
                                                                                                                                                      
                                                                                   0(t−1)p×1
                                                                                                        2                                           
                                        1
                                   √                              bt,kj ,τ ∗ − κ(kj , τ ∗ , S
                                                                                            b n , θbn )        ∇S κ(kj , τ ∗ , S
                                                                                                                               b n , θbn )
                                                P
                                                                  κ
                                                                                                                                                      
                      
                                       Nt NtK       j:kj ∈K                                   t                                  t                     
           Υ         =                                                                                                                                ,
           b 1,T                                                                                                                                      
                      
                                                                                0(T −t+1)p×1                                                          
                                                                                                                                                       
                                        q PT                                                                      2                                 
                                 1                  Nt
                            √                                               bt,kj ,τ ∗ − κ(kj , τ ∗ , S
                                                                                                      b n , θbn )        ∇θ κ(kj , τ ∗ , S
                                                                                                                                         b n , θbn )
                                                         P
                                            t=1
                                                T         j:kj ∈K           κ                           t                                  t
                                NtK Nt
                                                                                                2
                                          b 2,T = 1
                                                      X 
                                          Υ        K
                                                           bt,kj ,τ ∗ − κ(kj , τ ∗ , S
                                                           κ                         b n , θbn ) ,
                                                                                       t
                                                 Nt j:k ∈K
                                                                    j

                                                                                                  s                                                             
                          −1 X                                                                             T             X                                  q
Π
b T = 01×(t−1)p          √           ∇S κ(kj , τ ∗ , S
                                                      bn  bn 0 01×(T −t+1)p
                                                       t ,θ )                                  −       PT                      ∇θ κ(kj , τ ∗ , S
                                                                                                                                               bn  bn 0
                                                                                                                                                t ,θ )       NtK  .
                            Nt j:k ∈K                                                                     t=1   Nt   j:kj ∈K
                                   j



The logic behind the test in Corollary 1 is straightforward. By aggregating the model-implied
option fit spatially, we “average out,” and thus alleviate, the effect due to the observation error in
the options but we retain the error due to inadequate model fit. Hence, for the result in equation
(10) to apply, it is necessary that K has positive Lebesgue measure and that κ(k, τ, Z, θ) is a smooth
function of log-moneyness. The t-statistics implied by the asymptotic limit result in equation (10)
resemble the conditional moment tests proposed by Newey (1985) and Tauchen (1985).
                                                                                              
                                                                                    ∗ bn, θbn ) , is estimated
                                                 P
    The asymptotic variance of the option fit      j:kj ∈K   κ
                                                             b t,k j ,τ ∗ − κ(kj , τ , S
                                                                                         t
                                                                                              
            b 0
feasibly by ΠT ΞT ΠT . It accounts for the effect of the estimation error of Snt , θbn . It is critical
                b b                                                                     b
for the derivation of Corollary 1 that the convergence in equation (6) holds stably so that the
standardization of the model fit in equation (10) yields a variable with a limiting standard normal
distribution. The test in equation (10) can, of course, be extended to pool together the estimated
errors across options with different tenors as well as for options observed on different days.


                                                                                  19
       The test will be powerful against alternatives for which the errors in fitting the options in
the region K tend to be highly correlated, as this “blows up” the numerator without affecting
the denominator of the ratio in (10). This will typically be the case, as standard models imply
smoothness in option prices as a function of moneyness. That is, if the fit is poor for a given strike,
due to model misspecification, the model-implied option prices will tend to deviate in the same
direction for nearby strikes. Furthermore, the test of Corollary 1 allows us to check the model fit
over shorter periods of time. This is more informative about potential sources of model failure than
assessing the time-averaged option price fit, as is common practice. For example, we may be able
to associate specific types of model failure with broader economic developments that point towards
omitted state variables in the model or a fundamental lack of stability in the risk-neutral measure.

5.2      Time-Variation in Parameter Estimates

Our second test is based on the variation of the risk-neutral parameters over time. Under standard
regularity conditions, model misspecification will imply that the estimator converges to a pseudo-
true parameter vector, see, e.g., White (1982) and Gourieroux et al. (1984). However, in our setting
the state variables change from period to period. This should induce a corresponding movement
in the pseudo-true parameter vector for the misspecified model. That is, under misspecification,
the time-variation in the option prices cannot be “rationalized” by shifts in the state variables, so
we should expect “spill-over” in terms of intertemporal variation in the (pseudo-true) risk-neutral
parameter estimates over distinct time periods.
       Designing a test for parameter variation is straightforward using Theorem 2, as the estimates
obtained from option panels spanning disjoint time periods should be asymptotically independent
when conditioned on the filtration of the original probability space.14

Corollary 2 In the setting of Theorem 2, denote the risk-neutral parameter estimates from two
option panels covering disjoint time periods by θbn and θbn . If the risk-neutral model is valid for both
                                                        1       2
of these distinct time periods, we have,
                                 0                      −1             
                                                                              L−s
                      θb1n − θb2n      [ θb1n ) + Avar(
                                       Avar(      [ θb2n )       θb1n − θb2n −→ χ2 (q),                        (11)

       [ θb1n ) and Avar(
 where Avar(        [ θb2n ) denote consistent estimates of the asymptotic variances of θb1n and

θb2n based on equations (8)-(9) in Theorem 2, and q denotes the dimension of the parameter vector.
The analogous result applies for a subset of the parameter vector of dimension r < q, but with r
replacing q in equation (11).
  14
    Of course, this can be generalized to the case of overlapping estimation periods by appropriately accounting for
the conditional covariance of the two parameter estimates.


                                                        20
5.3     Distance between Model-Free and Option-Implied Volatility

Our final diagnostic tests whether the spot volatility estimated nonparametrically from high-
frequency data on the underlying asset is equal to the spot volatility, Vt , implied by the option data
given the model for the risk-neutral distribution of X. This restriction follows from the fact that
the diffusion coefficient of X should be invariant under an equivalent measure change (recall P and
Q are locally equivalent). Hence, if the option price dynamics is successfully captured by the state
vector St , the two estimates should not be statistically distinct. This is, of course, the identical
constraint that we exploit in our penalization term during estimation. Nonetheless, the condition
may be formally tested if we account suitably for the specification of the objective function in (4).
   To render the test feasible, we need an estimate of Vt . We exploit two high-frequency based
nonparametric jump-robust estimators, defined as follows,

            n X                                                                                      
   Vbt±,n =       (∆t,n X)2
                            1   |∆ t,n
                                       X| ≤ αn−$
                                                   ,               ∆t,n X = log   X   i   − log   X   i−1   ,      (12)
            kn ±,n i               i                                i              t+     n
                                                                                                   t+     n
                   i∈I

where α > 0, $ ∈ (0, 1/2), kn denotes a deterministic sequence with kn /n → 0 and,

                                  I −,n = {−kn + 1, ..., 0}     and    I +,n = {1, ..., kn } .

Vt−,n and Vt+,n are estimators for the variance from the left and right, respectively. If we denote the
set of jump times for the variance process by J = {s : ∆Vs > 0}, then, under regularity conditions
weaker than those in Assumption A0, we can show that both Vt+,n and Vt−,n are consistent for Vt ,
provided t ∈
           / J. We only need to estimate the spot volatility on a finite set of times. Since the
jump compensator controlling the jumps in Vt is absolutely continuous in time, the probability of
having jumps at any of these discrete times is zero, as, almost surely, t ∈
                                                                          / J.
                                                                  ±,n                      bn.
   The theorem below provides the joint limit distribution of Vtb     and the option-based St
                                                                                                 √
                                                                                               kn
Theorem 3 Under assumption A0, provided kn → ∞ with                            (2−β)$ [( 1 ∧1)−1/2+(1−β)$∨0] 1/4
                                                                                     V                      V      → 0,
                                                                              n          β
and with β defined as in A0(iii), we have for T ∈ N,
                                                            √                      
                                  Vb1+,n − V1                    2V1   ...      0    E
                                                                                     e1
                           p           ..                     ..                 .. 
                                                                                ..
                                                                                    
                            kn 
                                               L−s                    ..
                                               −→                        .       . ,                           (13)
                               
                                         .                     .                .
                                                                           √
                                                                                   
                                 VbT+,n − VT                     0     ...   2VT    EeT

                          0
where       E
            e1 , ..., E
                      eT        is T × 1 vector of independent standard normals independent of the original
filtration F and defined on an extension of the original probability space. If the conditions of


                                                              21
                                                         0
Theorem 2 are satisfied, then the vector E  e1 , ..., EeT is independent from the vector (E1 , ..., ET , E0 )0
                                                      0
determining the limit distribution of S  b n , ..., S
                                                    b n in equation (6).
                                                       1            T
       If further (1, ..., T ) ∩ J = ∅, then the above results continue to hold when Vbt+,n is replaced by
Vbt−,n for t = 1, ..., T .

The asymptotic distribution of Vbt±,n on the random set of jump times in X is derived in Jacod and
Todorov (2010). It is optimal to choose $ close to 1/2 and, next, let kn be close to n1/2 , provided
the jumps are not too active, i.e., their activity index satisfies β < 4/3 (recall assumption A0(ii)).
This is a relatively mild restriction.15 The theorem reveals that the convergence of Vb ±,n holds          t
                     b n and they are asymptotically independent when conditioned on the filtration
jointly with that of S t
of the original probability space. This allows us to derive the asymptotic behavior of the difference
Vb ±,n − ξ1 (S
 t
             b n ). We state this important result as a corollary to Theorem 3.
               t


Corollary 3 Under the same conditions as in Theorem 3, we have for kn → ∞, mint=1,...,T Nt →
∞ and λ2n mint=1,...,T Nt → 0,
                                                                                                      
                                                                                                 Ĕ1
                                            b n ) − Vb +,n
                                        ξ1 ( S                                   
                                                                                             L−s  . 
                                                                                                      
                                               t       t
                           q                                                                 −→  ..  ,       (14)
                                      b n )0 χ
                               ∇S ξ1 (S                bn )
                                             bt ∇S ξ1 (S           2(Vbt+,n )2
                                        t               t
                                                               +
                                                                                                    
                                           Nt                          kn        t=1,...,T         ĔT

where χ                 b −1 Ω
      bt is the part of H         b −1 )0 corresponding to the variance-covariance of S
                             b T (H                                                   b n and where
                          T         T                                                   t
(Ĕ1 , ..., ĔT )0 is a vector of standard normals independent of each other and of F.

Yet again, we stress that we do not need a parametric model for Vt under the statistical measure, P,
to test the equality of the spot volatility implied by the underlying asset dynamics and the model-
dependent option-implied dynamics. However, the test does hinge critically on the characterization
of the joint stable asymptotic law in Theorem 3. Consequently, this pathwise restriction on the spot
volatility cannot be formally tested under the usual approach to option-based parametric inference
which precludes the application of this type of limit theory.
   Unfortunately, we cannot design a similar test regarding the distance between the option-
                                         b n ) and a nonparametric one derived from high-frequency
based estimate of the jump intensity ξ2 (S                 t
data. First, while high-frequency data for X allows us to estimate the “realized” jumps on a
given path, it does not produce an estimate of their intensity. The jump intensity depends on
the probability measure, and reliable estimation will require applying large time span asymptotics
  15
    The relative speed condition between kn and n in Theorem 3 can be slightly weakened in the case β ≥ 1 at the
cost of more lengthy derivations. The improvement is relatively small, so we abstain from this generalization here.


                                                                        22
under the P measure. Secondly, since the jump intensity is tied to the probability distribution, the
jump intensity under the risk-neutral and statistical distribution are generally different. In fact,
there is strong parametric and nonparametric evidence indicating that they differ significantly.16
         Finally, we emphasize that, to increase the power to detect model misspecification, the three
tests in Corollary 1-3 should be applied in parallel. For example, a misspecified model might
generate implied spot volatility estimates that are close to the model-free ones, but in doing so
it will provide a poor fit to the observed option prices or induce parameter instability. On the
other hand, a faulty model may occasionally provide a good fit for the option panel – the vector
{St }t=1,...,T provides flexibility in fitting option prices – but this will typically be at the expense of
implausible volatility estimates.


6         Numerical Experiments
6.1        Model Specification and Parameter Identification

This section provides evidence on the finite sample performance of our inference procedures in the
context of a model widely exploited in empirical work, namely the so-called “double-jump” model
of Duffie et al. (2000). The model under the risk-neutral distribution is specified as,

                   dXt  p                                                          p
                       = Vt dWt + dLx,t ,            dVt = κd (v − Vt )dt + σd         Vt dBt + dLv,t ,            (15)
                   Xt−

where (Wt , Bt ) is a two-dimensional Brownian motion with correlation corr (Bt , Wt ) = ρd · t;
(Lx,t , Lv,t ) is a compound Poisson jumps process with intensity λj and the distribution of the
jump size (Zx , Zv ) is governed by the marginal distribution of Zv , which is exponential with mean
µv , while, conditional on Zv , log(Zx + 1) is Gaussian with mean µx + ρj Zv and standard deviation
σx , and, finally, Lx,t is a jump martingale. The model also involves the cross-parameter restriction,
      √
σd ≤ 2κd v. Finally, for simplicity, we have fixed the risk-free rate and the dividend yield to be
zero. The vector of risk-neutral parameters is thus given by θ = (ρd , v, κd , σd , λj , µx , σx , µv , ρj ).
         To ensure that our numerical experiments reflect empirically relevant features of the asset and
option price dynamics, we fix the parameters to the consensus values from the literature provided
by Broadie et al. (2009). Although our inference procedure only requires a full characterization of
the data generating process under the risk-neutral measure, in the simulation experiment we still
need to generate the dynamics of the state variables from the actual probability measure. Hence, we
    16
    The aspects of the risk-neutral model for jumps in X we can test from the underlying asset data are those that
hold Q-almost surely. This includes the so-called jump activity index, which should be identical under P and Q.
However, to uncover the latter nonparametrically from high-frequency data, we must sample X very finely and this
renders the inference highly sensitive to market microstructure effects. Hence, we abstain from testing this restriction.


                                                           23
adopt the standard approach of the empirical option pricing literature, see, e.g., Singleton (2006),
and assume that X follows the same general model under both the P and Q measures, but with
differing values for some key parameters, reflecting the presence of risk premiums. The full set of
parameter values, adapted from Broadie et al. (2009), is reported in Table 1. We also follow them
in fixing ρj = 0, thus leaving eight parameters to be estimated for each Monte Carlo sample.

                    Table 1: Parameter Setting for the Numerical Experiments

                     Under P                                             Under Q
   Parameter       Value Parameter          Value        Parameter     Value Parameter        Value
      ρd         −0.4600     λj            1.0080           ρd       −0.4600     λj          1.0080
       v          0.0144     µx           −0.0284            v        0.0144     µx         −0.0501
      κd          4.0320     σx            0.0490           κd        4.0320     σx          0.0751
      σd          0.2000     µv            0.0315           σd        0.2000     µv          0.0930


   Figure 2 depicts the sensitivity of the option surface with respect to the parameters of the
double-jump model across different values of the state variable, i.e., alternative levels of (stochastic)
volatility. The figure reveals that the parameters have qualitative different effects on the option
surface. This should ensure that the parameters can be identified in practice as long as the option
cross-section is sufficiently wide and the option panel spans a time period with a significant degree
of variation in the realization of the (volatility) state vector. For example, the long-run mean of the
volatility parameter, v, primarily impacts the longer term options as the short maturity options
are determined largely by the current volatility state. The same logic applies to the identification
of the mean reversion parameter, κd . Not surprisingly, the sensitivity of options with respect to κd
increases when the (stochastic) volatility state is far from its long-run mean as this enhances the
strength of the mean-reversion. Likewise, turning to the jump parameters, it is evident that each
of them has a unique effect on the option surface. For example, µx has the largest impact on OTM,
short-maturity put options and its effect decreases for longer maturities. On the other hand, the
volatility of jumps parameter, σx , has a more symmetric impact on the short maturity puts and
calls with a diminishing effect for the longer maturities. Overall, Figure 2 reveals that there are
large benefits from using options with a wide range of strikes and levels of moneyness as well as
from pooling observations across different days in the estimation.




                                                    24
                    ρd                                        v̄                                     κd

      2                                                                             0
                                         200
      1
                                                                                 −0.5
      0                                  100
  −1                                                                               −1

                                            0
      −3 01 −3 01 −3 01 −3 01                −3 01 −3 01 −3 01 −3 01                  −3 01 −3 01 −3 01 −3 01
                    σd                                        λj                                    µx

      5                                                                            20
                                            6
                                                                                    0
                                                                                  −20
      0                                     4
                                                                                  −40
                                                                                  −60
                                            2
  −5                                                                              −80
      −3 01 −3 01 −3 01 −3 01                −3 01 −3 01 −3 01 −3 01                 −3 01 −3 01 −3 01 −3 01
                    σx                                        µv                                     ρj

 100                                                                                5
  80                                       40
                                                                                    0
  60
                                           20
  40                                                                               −5
  20
                                            0
      −3 01 −3 01 −3 01 −3 01                −3 01 −3 01 −3 01 −3 01                  −3 01 −3 01 −3 01 −3 01
             Moneyness                              Moneyness                                Moneyness


Figure 2: Option Sensitivity to Parameters in Double-Jump Model. The figure plots the first
derivatives of options (in terms of implied volatility) with respect to the parameters of the double-
jump model. The parameters are set at the    √ values reported in Table 1. Moneyness is reported in
terms of volatility units, i.e., log(K/F )/(σ T ) with notation as in Figure 1. Each of the segments
in the plots corresponds to maturities τ = 10, τ = 45, τ = 120 and τ = 252 days (starting from
left to right). The solid, dashed and dotted lines correspond to estimates at the 5th, 50th and 95th
quantile of volatility respectively.



6.2       Monte Carlo Experiments

We now present the findings from an extensive simulation study based on the double-jump model
with parameters fixed at the values given in Table 1. We apply our inference procedures on a total
of 1, 000 Monte Carlo replications.17
    The Monte Carlo setting is aimed at broadly mimicking the features of the models that have
been estimated in prior work as well as the data used in the subsequent empirical application.
  17
     The computational burden associated with this study is highly non-trivial, but a variety of improvements over
the traditional approach to the computation of the option prices within this framework has rendered the exercise
feasible. To the best of our knowledge, this constitutes the first comprehensive Monte Carlo study of the efficacy of
inference procedures for the double-jump model at this level of relative complexity. An account of our computational
approach may be found in a supplementary web-appendix.




                                                         25
To this end, the option panel is constructed as follows. We simulate the underlying asset for a
year and sample the options every fifth day, corresponding to weekly observations, as is common
in empirical work (time is measured in business days).18 For each such day, we calculate option
prices for four maturities: τ = 10, τ = 45, τ = 120 and τ = 252 days, which resemble the available
maturities in the actual data. Finally, for each maturity we compute 50 out-of-the-money option
                                                                           √
prices for an equispaced log-moneyness grid, covering the range [−4, 1] · σ τ , where σ is the at-the-
money Black-Scholes implied volatility on the given day. This corresponds to using a time-varying
coverage of moneyness depending on the level of volatility, again roughly mimicking the available
strike ranges in the actual data. For the option error we assume t,k,τ = σt,k,τ Zt,k,τ , where Zt,k,τ
are standard normal variables, independent across time, moneyness and time-to-maturity, and
σt,k,τ = 0.5ψk /Q0.995 for ψk denoting the relative bid-ask estimate from the kernel regression on
the actual data, plotted on Figure 1, and Q0.995 denoting the 0.995-quantile of the standard normal
distribution. This noise structure allows for significant time-variation of the (conditional) noise
variance depending both on the current level of volatility and the moneyness. Finally, we set
λn = 0 in (4) and, for the computation of the nonparametric volatility estimator, we use Vb −,n                 t
with n = 400 – equivalent to sampling every 1-minute over a 6.5 hour trading day – and kn = 120,
corresponding to a window of 2 hours. α and $ were calculated as in Bollerslev and Todorov (2011)
and we refer to that source for further details.
       In Table 2, we report the results from the Monte Carlo for the parameter vector. The parameter
estimates display no significant biases and most are estimated with good precision. The more
challenging parameters to estimate, based on the relative size of the inter-quantile range, are ρd
and σd . Given the relatively short one-year samples and the close relation between the option
sensitivities for these two parameters, displayed in the first two panels of column one in Figure 2,
this finding is not surprising. Of course, longer samples and different underlying parameter values
may render it easier to separately identify the two parameters.
       Turning next to the diagnostic tests, Table 3 reports on the size of the various tests developed
in Section 5. Generally, the small sample behavior is quite satisfactory. The tests for the fit to the
option panel is near perfectly sized, while there is a mild degree of under-rejection for the volatility
test as well as the omnibus test for parameter stability. The test in Panel C of Table 3 (recall
λn = 0 in the estimation) indicates that, even in the presence of observation error, the option panel
alone recovers the path of stochastic volatility with good precision.
  18
    More precise inference would be garnered from using a longer sample, but the one-year horizon provides a sensible
compromise, in practice, between the joint objectives of accuracy in estimation and minimization of the time period
over which we assume invariance of the risk-neutral measure.



                                                         26
            Table 2: Monte Carlo Results: Estimation of the Risk-Neutral Parameters

    Parameter    True Value     Median      IQR      Parameter    True Value    Median       IQR
       ρd          −0.4600      −0.4564    0.3911       λj            1.0080     1.0080     0.1798
        v            0.0144      0.0144    0.0035       µx          −0.0501     −0.0501     0.0134
       κd            4.0320      4.0321    0.1939       σx            0.0751     0.0751     0.0057
       σd            0.2000      0.2022    0.1240       µv            0.0935     0.0935     0.0055



                          Table 3: Monte Carlo Results: Diagnostic Tests

                                  Test                 Nominal size of test
                                                        1%    5%      10%
                           Panel A: Fit to Option Panel
                Out-of-the-money, short-maturity puts 0.88% 4.80% 10.03%
                Out-of-the-money, short-maturity calls 0.89% 4.95% 10.00%
                Out-of-the-money, long-maturity puts 1.00% 4.93% 9.96%
                Out-of-the-money, long-maturity calls 0.93% 5.15% 10.47%
                              Panel B: Parameter Stability
                                                       1.48% 6.33% 10.55%
                  Panel C: Distance implied-nonparametric volatility
                                                       1.68% 4.10% 6.45%

       Note: Panel A reports rejection frequencies across the full sample for the option fit
       to specific portions of the option surface on a given Wednesday. This test is based
       on the result in Corollary 1, using the first two maturities for the first two tests and
       the last two maturities for the remainder of the tests in this panel. The test in Panel
       B is given in Corollary 2, and the test in Panel C is provided in Corollary 3.



   Corollary 2 can also be used to test for stability of the individual parameters. This is likely a
less powerful test, as it fails to exploit the information about the joint fit across the full parameter
vector and it does not to account for the correlation among the estimates. It is evident from Table 4
that the tests for those parameters, which are estimated relatively imprecisely, e.g., ρd and σd , tend
to be particularly undersized in small samples. In comparison, the omnibus test in Table 3 performs
considerably better. We conclude that, overall, the developed method of inference appears to be
reasonably sized, even for small samples, given parameters calibrated to commonly observed values.




                                                    27
                  Table 4: Monte Carlo Results: Tests for Stability of Individual Parameters

              Parameter             Nominal Size                Parameter             Nominal Size
                                   1%    5%     10%                                  1%    5%     10%
                    ρd          0.00% 0.42%    1.90%                  λj          1.90% 6.96% 10.97%
                    v           1.48% 6.96% 10.97%                    µx          0.63% 6.33% 11.39%
                    κd          1.48% 6.96% 12.66%                    σx          0.84% 5.06%    8.65%
                    σd          0.63% 4.43%    8.86%                  µv          0.63% 5.70%    9.49%

             Note: The parameter stability test is given in equation (11).



7         Empirical Application

We apply our inference procedure to data on the European style S&P 500 equity-index (SPX)
options traded at the CBOE. We use the closing bid and ask prices reported by OptionMetrics.19
We apply standard filters and discard all in-the-money options, options with time-to-maturity of
less than 7 days, as well as options with zero bid prices. We then compute the mid bid-ask Black-
Scholes implied volatilities. The data spans the period January 1, 1996, till July 21, 2010. Following
earlier empirical work, e.g., Bates (2000) and Broadie et al. (2009), we sample every Wednesday.
The full sample includes 760 days, and we use an average of 234 bid-ask quotes per day in the
estimation. The nonparametric estimate of volatility needed for the penalization in the objective
function and for the diagnostic tests is constructed from one-minute high-frequency data on the
S&P 500 futures covering the time-span of the options data. The construction of the high-frequency
estimate follows the exact steps outlined in describing the Monte Carlo study. In the estimation
we set λn = 0.2.
         We estimate the double-jump model in (15) as well as an extension that allows for the jumps to
have time-varying intensity and the stochastic volatility to contain two independent factors. The
extended model (under the risk-neutral measure) is given by,

         dXt                     p             p
               = (rt − δt )dt + V1,t dW1,t + V2,t dW2,t + dLx,t ,
         Xt−                                                                                                         (16)
                                            p                                                        p
         dV1,t = κd,1 (v 1 − V1,t )dt + σd,1 V1,t dB1,t + dLv,t , dV2,t = κd,2 (v 2 − V2,t )dt + σd,2 V2,t dB2,t ,

where (W1,t , W2,t , B1,t , B2,t ) is a four-dimensional Brownian motion with W1,t ⊥ W2,t , W1,t ⊥ B2,t
and corr (W1,t , B1,t ) = ρd,1 · t as well as W2,t ⊥ B1,t and corr (W2,t , B2,t ) = ρd,2 · t. Moreover,
(Lx,t , Lv,t ) is a bivariate jump process with intensity λj,0 + λj,1 V1,t and a joint jump (size) distribu-
    19
         The two shortest maturities, beyond seven calendar days, are also used by the CBOE for the VIX computation.


                                                              28
tion (Z1 , Z2 ), where the marginal distribution of Z2 is exponential with mean µv and, conditional
on Z2 , log(Z1 + 1) is normal with mean µx + ρj Z2 , and variance σx2 . For simplicity, we assume
that rt and δt are deterministic, where the LIBOR rate for the corresponding maturity represents
the interest rate while the dividend yield is obtained from OptionMetrics.
   From model (16) we obtain the original one-factor double-jump model if we impose λj,1 = 0 as
well as σd,2 = v 2 = 0. We first present results based on this simpler benchmark model. It is a mildly
generalized version of the Broadie et al. (2009) setting used for our numerical experiments, as we
allow ρj 6= 0. The parameter estimates and associated standard errors are reported in Table 5.

                     Table 5: Parameter Estimates for the One-Factor Model

        Parameter    Estimate    Standard Error    Parameter     Estimate    Standard Error
           ρd         −0.9586        0.0059           λj           0.0150        0.0006
            v          0.0356        0.0004           µx           0.5833        0.0417
           κd          1.4350        0.0198           σx           0.3220        0.0430
           σd          0.2965        0.0032           µv           1.6162        0.1912
                                                       ρj         −0.8579        0.1572

       Note: Parameter estimates of the one-factor model (15) for S&P 500 equity-index
       option data sampled every Wednesday over the period January 1996-July 2010.


   A few comments are in order. Focusing first on the broader features, the risk-neutral mean of
volatility implied by the point estimates in Table 5 equals 24.3% (quoted in annualized volatility),
while the sample mean of volatility under the statistical distribution, obtained by cumulating the
intraday five-minute and overnight S&P 500 futures returns, is 21.35%. This is consistent with the
presence of a (negative) volatility risk premium, as also established in much prior work. Moreover,
the contribution of jumps to the overall (risk-neutral) volatility is non-trivial. Second, the point
estimates deviate markedly from those commonly reported in the literature, as exemplified by
Table 1. For example, the (negative) correlation between the Gaussian shocks in volatility and price
is close to −1, while the implied mean price jump is huge, around −80%, and with high volatility,
but occurring with a frequency of only 1.5% per year. Similarly, the mean of the volatility jump is
extremely large, at an imposing 162%. In summary, our parameters are at odds with studies that
estimates the risk-neutral parameters from time series observations on the underlying asset returns
along with a limited number of options. This is likely due to the relatively large weight assigned to
the asset returns in the estimation as well as the tight link imposed on the P − Q relation. Indeed,
our findings are consistent with studies that calibrate models exclusively to the option surface; see,
e.g., Christoffersen et al. (2009). In essence, the large negative jumps accommodate the strong

                                                  29
negative skew over short maturities, while the strong negative correlation between diffusive return
and volatility shocks help rationalize the negative skew for long maturity options. Finally, the
negative association between return and volatility jumps further accentuate the skewness.
       Figure 3 depicts the weekly series of Z-scores from Corollary 1. The model faces difficulties in
several dimensions. First, not surprisingly, it struggles to fit options over the crisis period, 2008-
2010. Second, the fit to deep OTM short-maturity options is relatively good with the exception of
the crisis and the tranquil period of 2003-2007. Third, the fit to short-maturity OTM calls is poor
throughout, as they undergo episodes of persistent over- or under-valuation. Fourth, long maturity
options are fit poorly with alternating periods of over- and undervaluation. These problems are
also evident from Table 7 which reports the rejection rates from the diagnostic tests.

                             Z−score: short maturity DOTM Put options                                                  Z−score: long maturity DOTM Put options
  10                                                                                          10



   0                                                                                           0



 −10                                                                                         −10
         97   98   99   00      01     02    03     04     05    06     07   08   09   10          97   98   99   00      01    02     03    04     05     06    07   08   09   10

                             Z−score: short maturity OTM Put options                                                   Z−score: long maturity OTM Put options
  10                                                                                          10



   0                                                                                           0



 −10                                                                                         −10
         97   98   99   00      01     02    03     04     05    06     07   08   09   10          97   98   99   00      01    02     03    04     05     06    07   08   09   10

                             Z−score: short maturity OTM Call options                                                  Z−score: long maturity OTM Call options
  10                                                                                          10



   0                                                                                           0



 −10                                                                                         −10
         97   98   99   00      01     02    03 04         05    06     07   08   09   10          97   98   99   00      01    02     03 04        05     06    07   08   09   10
                                              Year                                                                                      Year


Figure 3: Option Panel Fit for the One-factor Model. The short-maturity options are those with
the two shortest time-to-maturity available on a given day and the long-maturity options are all
remaining options with time-to-maturity less than one year. DOTM signifies deep out-of-the-money
                                                                                  √
and OTM is out-of-the-money. DOTM puts are those with moneyness [−4, −2] × σ τ , OTM puts
                                    √                                                        √
are those with moneyness [−2, 0] × σ τ , and OTM calls are those with moneyness [0, 1] × σ τ ,
where σ is the at-the-money Black-Scholes implied volatility on the given day.


       Figure 3 and Table 7 suggest that the one-factor model has several shortcomings. First, the


                                                                                        30
constant jump intensity prevents a steepening of the smirk (the slope of implied volatility as a
function of moneyness) in response to high volatility. Second, the one-factor volatility structure
generates too much dependence between short and long term options. Third, the shifts in over- and
undervaluation of OTM calls is indicative of a misspecified jump distribution, likely reflecting the
dearth of smaller (positive) jumps. This conjecture is consistent with the nonparametric evidence
in Bollerslev and Todorov (2011). Inspired by these observations, we now estimate the two-factor
model in (16). It contains features that should help mitigate the first two deficiencies of the
original model. Note also that jumps now impact V1,t directly, implying that the time-varying
jump intensity, λj,1 > 0, induces self-affectation: a jump today increases the probability of future
jumps. Estimation results for the extended model are reported in Table 6.

                       Table 6: Parameter Estimates of Two-Factor Model

       Parameter     Estimate   Standard Error     Parameter    Estimate    Standard Error
          ρd,1        −0.9800       0.0253            λj,0        0.0217        0.0027
           v1          0.0331       0.0019            λj,1        6.0683        0.8749
          κd,1         1.2327       0.0638            µx         −0.0145        0.0136
          σd,1         0.2640       0.0113            σx          0.0877        0.0082
          ρd,2        −0.1824       0.0388            µv          0.1501        0.0124
           v2          0.0066       0.0001             ρj        −0.7756        0.0718
          κd,2        29.8797       0.5951
          σd,2         0.2341       0.0569

       Note: Parameter estimates for the two-factor model in (16), obtained using S&P 500
       equity-index options sampled every Wednesday over the period January 1996-July
       2010.


   The parameter estimates for the diffusive part of the first volatility factor are similar to those
for the one-factor model in Table 5. The second volatility factor has a much lower mean and much
shorter half-life. Interestingly, once we free up the λj,1 = 0 constraint, the main determinant of
the jump intensity is the time-varying component. This is important, as λj,1 > 0 allows for time-
varying jump risk premia, which have been identified by Bates (2000), Pan (2002) and Bollerslev
and Todorov (2011). Moreover, the mean jump intensity is now 28.4%, i.e., a jump occurs about
every 3-4 years, and the mean jump size is approximately −13%. Likewise, the mean volatility jump
is a more palatable 15%. These jump estimates are now roughly in line with those from studies
exploiting both asset returns and options, see, e.g, Singleton (2006), chapter 15, for a review. As
before, the correlation between price and volatility jumps is strongly negative. This is consistent
with the nonparametric evidence in Todorov and Tauchen (2011) and Andersen et al. (2011). The

                                                 31
fact that λj,1 and ρj both are positive imply intricate interactions between future volatility and
jumps: high volatility today increases the likelihood of future jumps while the occurrence of jumps
increase the future level of volatility. Finally, the estimated mean volatility is now 22.8%, which
remains consistent with a negative volatility risk premium.
   Figure 4 depicts the weekly Z-scores for the fit to the volatility surface afforded by the two-factor
model. There are still nontrivial rejections of the model over the sample period. In particular, the
out-of-the-money call options continue to be mispriced, but there appears to be less persistent shifts
in the Z-scores for the short-maturity out-of-the-money calls. The period 2008-2010 continues to be
a significant challenge and we find systematic overpricing of the out-of-the-money short-maturity
puts over the tranquil period prior to the Fall of 2007. Similarly, the persistence of the mispricing
appears to be somewhat lower for the long-maturity options than was the case for the one-factor
model. Nonetheless, it is hard to formally gauge the relative quality of fit by ocular inspection,
so we turn to the diagnostic tests provided in Table 7. Panel A suggests that the extension to
a two-factor model allows for increased flexibility in fitting the long term put options and the
short term call options, but only by doing somewhat worse on the short term put and long term
call options. Likely factors in the improved fit are the more persistent first volatility factor, the
increased probability of smaller negative jumps and an even more negative correlation between
returns and volatility for the first factor. All these features enhance the (risk-neutral) probability
of a large negative move over long horizons. At the same time, the ability to fit the long term
call options deteriorates, and the lack of extremely large negative jumps render the short term put
options harder to price. The presence of the second much less persistent and less volatile factor also
helps with the shorter term calls, but it cannot offset the long term return-volatility asymmetry
that renders the long term calls hard to price. Overall, the two-factor model improves the average
fit, measured in terms of the root-mean-squared-error, by close to 25%.
   The more intuitive and reasonable parameter values and the better average fit to the option
prices noted in Figure 4 as well as Panels A and B of Table 7 suggest that the two-factor model
provides a non-trivial improvement. However, especially the worsening fit for the longer maturity
out-of-the-money calls indicates that there is scope for significant improvement in future work,
mainly via the specification of a more flexible jump distribution that allows for more frequent
small, positive as well as negative, jumps and a more gradual decay of the jump tails.
   It is natural to associate some of the problems for the one-factor model with an inability to
flexibly accommodate shifts in the term structure of volatility, see e.g., Bates (2000) and Christof-
fersen et al. (2009). Figure 5 displays the fit for at-the-money implied volatilities over short and



                                                  32
                             Z−score: short maturity DOTM Put options                                                  Z−score: long maturity DOTM Put options
  10                                                                                          10



   0                                                                                           0



 −10                                                                                         −10
         97   98   99   00      01     02    03     04     05    06     07   08   09   10          97   98   99   00      01    02     03    04     05     06    07   08   09   10

                             Z−score: short maturity OTM Put options                                                   Z−score: long maturity OTM Put options
  10                                                                                          10



   0                                                                                           0



 −10                                                                                         −10
         97   98   99   00      01     02    03     04     05    06     07   08   09   10          97   98   99   00      01    02     03    04     05     06    07   08   09   10

                             Z−score: short maturity OTM Call options                                                  Z−score: long maturity OTM Call options
  10                                                                                          10



   0                                                                                           0



 −10                                                                                         −10
         97   98   99   00      01     02    03 04         05    06     07   08   09   10          97   98   99   00      01    02     03 04        05     06    07   08   09   10
                                              Year                                                                                      Year


              Figure 4: Option Price Fit for the Two-factor Model. Notation as for Figure 3.



long maturities. Since we do not average across moneyness, the series are inevitably somewhat
noisy, but the plots are nevertheless indicative of systematic mispricing. First, it is apparent that
the two-factor model tracks the term structure of implied volatility much better. In particular,
unlike the two-factor model, the one-factor model performs poorly from the end of 1998 till the
end of 2000 and from the beginning of 2009 till the end of 2010. Both periods feature quickly
mean-reverting volatility and a term structure of volatility that turns negative. The one-factor
model cannot generate this behavior due to a one-to-one mapping between the term structure and
the level of volatility. Introducing a second factor breaks this link and allows for some independent
variation in the term structure at a given volatility level. This evidence also suggests that risk
premia may have a more complicated relation with the level of volatility than typically assumed in
equilibrium-based asset pricing models.
       Table 8 reports rejection rates for tests of individual parameter stability across consecutive one-
year samples. The table reveals significant variation in the parameter estimates, but also a dramatic
improvement in the temporal stability for some parameters as we move from the one-factor to the
two-factor model. This is indicative of improved model specification. Nevertheless, some parameters


                                                                                        33
                        Table 7: Diagnostic Tests for S&P 500 Option Data


                                      One-factor Model Two-factor Model
                     Test               Nominal Size       Nominal Size
                                        1%         5%     1%         5%
                       Panel A: Fit to the Option Panel
            DOTM, short-maturity puts 18.16%     39.74% 21.84%     45.53%
            OTM, short-maturity puts 24.87%      53.03% 27.89%     50.39%
            OTM, short-maturity calls 20.53%     55.00% 16.58%     48.55%
            DOTM, long-maturity puts 41.45%      62.11% 27.50%     41.97%
             OTM, long-maturity puts  72.63%     80.79% 52.89%     60.53%
             OTM, long-maturity calls 53.16%     65.53% 79.47%     86.45%
               Panel B: Root-Mean Squared Error of IV Option Fit
                                             3.09%             2.32%
             Panel C: Equality of Implied and Nonparametric Volatility
                                      54.08%     65.66% 49.74%     61.58%


       Note: Panel A reports rejection frequencies across the full sample for the option fit to
       specific portions of the option surface at the end of trading on Wednesdays. This test
       is based on Corollary 1, using the first two maturities for the three initial tests and all
       remaining options with maturity less than one year for the last three tests. DOTM
       puts, OTM puts and calls, and short- versus long-maturity options are defined in
       Figure 3. Panel B provides the root-mean-squared-error of the model-implied Black-
       Scholes volatilities relative to the market mid-quote implied Black-Scholes volatilities
       across all options used for estimation over the full sample. The test in Panel C is
       defined in Table 3.


in the two-factor model are quite unstable, most notably the persistence parameters κd,1 and κd,2 .
Again, it is evident that neither model is correctly specified. In fact, for both models the joint test
for stability of the full parameter vector across any two consecutive years has a 100% rejection rate.
   Finally, Figure 7 depicts the nonparametric and two alternative option extracted volatility series.
It is evident that they all are highly correlated. Nonetheless, the formal test for equality between
the option-implied and the nonparametric diffusive volatility estimates rejects the null hypothesis
for a nontrivial number of days in both models, as may be confirmed from Panel C of Table 7. The
rejection rates for the two-factor model are somewhat lower than those for the one-factor model,
once more suggesting it captures the option dynamics better. This is corroborated by the serial
correlation in the discrepancy between the option implied and nonparametric volatility estimates


                                                   34
                                      ATM IV short maturity                                                                      ATM IV short maturity

    0.6                                                                                        0.6

    0.4                                                                                        0.4

    0.2                                                                                        0.2

      96   97   98   99   00   01    02     03    04     05    06     07   08   09   10   11     96   97   98   99   00   01    02     03    04     05    06     07   08   09   10   11

                                      ATM IV long maturity                                                                       ATM IV long maturity

    0.4                                                                                        0.4

    0.3                                                                                        0.3

    0.2                                                                                        0.2

      96   97   98   99   00   01    02     03    04     05    06     07   08   09   10   11     96   97   98   99   00   01    02     03    04     05    06     07   08   09   10   11

                           ATM IV short maturity − ATM IV long maturity                                               ATM IV short maturity − ATM IV long maturity
    0.3                                                                                        0.3
    0.2                                                                                        0.2
    0.1                                                                                        0.1
     0                                                                                          0
 −0.1                                                                                        −0.1
     96    97   98   99   00   01    02     03 04        05    06     07   08   09   10   11     96   97   98   99   00   01    02     03 04        05    06     07   08   09   10   11
                                              Year                                                                                       Year


Figure 5: Fit of the Term Structure of Implied Volatility. The left side corresponds to the one-factor
model and the right-hand side to the two-factor one. On each plot, the grey line represents the
at-the-money implied volatility for the option with moneyness closest to 1, while the dashed line
indicates the model implied volatility.



plotted in the bottom panels of Figure 7. Under correct model specification these series should not
display significant autocorrelation. However, very strong temporal dependence is evident for the
one-factor model, while it drops substantially for the two-factor model.


8          Conclusion

In this paper we consider the problem of estimating the parameters of the risk-neutral distribution
and the latent state variables from a panel of options, observed with error, with fixed time span
and increasing cross-sectional dimension. We prove consistency of the estimators and show that
they converge stably to mixed Gaussian laws. We further propose and implement feasible inference
based on the developed limit theory. We design novel tests for the observed option trajectories by
evaluating the option price fit and the parameter stability over time as well as the pathwise dis-
tance between the volatility implied by the option-based estimation and a nonparametric estimate


                                                                                          35
                     Table 8: Parameter Stability Tests on S&P 500 options data

          Parameter       Nominal size of test Parameter          Nominal size of test
                            1%        5%                           1%         5%
                          Panel A: One-Factor Model
               ρd         62.86%    70.48%         λj             56.19%       67.62%
               v          71.43%    73.33%         µx             20.00%       25.71%
               κ          91.43%    93.33%         σx             49.52%       61.91%
               σd         77.14%    80.95%         µv             31.43%       36.19%
                                                   ρj             13.33%       17.14%
                          Panel B: Two-Factor Model
              ρd,1        8.57%       16.19%           λj,0       37.14%       49.52%
               v1         7.62%       12.38%           λj,1       21.91%       33.33%
              κd,1        72.38%      70.05%           µx         0.00%        4.76%
              σd,1        42.86%      53.33%           σx         9.52%        17.14%
              ρd,2        7.62%       16.19%           µv         23.81%       34.29%
               v2         76.19%      80.95%            ρj        1.91%        2.86%
              κd,2        69.52%      77.14%
              σd,2        0.95%        0.95%

       Note: Tests based on parameter estimates of the models over consecutive calendar
       years in the sample. The test is based on Corollary 2.



constructed from high-frequency data for the underlying asset.
    An extensive Monte Carlo study confirms that the inference techniques work well over relatively
short time spans for realistically calibrated parameter settings. In an empirical application to S&P
500 equity-index options, we extend the double-jump model of Duffie et al. (2000) to allow for
time-varying compensation for jumps and a more flexible relation between risk compensation and
(stochastic) volatility. We find nontrivial improvements for the extension of the model relative to
the standard one-factor representation. Nonetheless, the model is rejected when confronted with
our full battery of specification tests. This demonstrates the power of the developed tools for model
diagnostics. Our findings point towards the use of a more flexible jump distribution as the most
promising avenue for improving the fit to the option panel.


9    Appendix
We first establish some preliminary results and then provide proofs of the theorems and corollaries.




                                                 36
                                      Nonparametric volatility estimate                                                                                   Nonparametric volatility estimate
 1.2                                                                                                                 1.2
   1                                                                                                                   1
 0.8                                                                                                                 0.8
 0.6                                                                                                                 0.6
 0.4                                                                                                                 0.4
 0.2                                                                                                                 0.2

                                          Option recovered volatility                                                                                         Option recovered volatility
 1.2                                                                                                                 1.2
   1                                                                                                                   1
 0.8                                                                                                                 0.8
 0.6                                                                                                                 0.6
 0.4                                                                                                                 0.4
 0.2                                                                                                                 0.2

                                Z−score: recovered − nonparametric volatility                                                                       Z−score: recovered − nonparametric volatility

  10                                                                                                                  10

   0                                                                                                                   0

 −10                                                                                                                 −10
            1998         2000              2002          2004                2006          2008          2010                   1998         2000              2002          2004                2006          2008          2010
               ACF: in level                         Year                           ACF: in log                                    ACF: in level                         Year                           ACF: in log
   1                                                       1                                                           1                                                       1

 0.5                                                      0.5                                                        0.5                                                      0.5

   0                                                        0                                                          0                                                        0
       10       20         30        40        50                       10          20         30   40          50         10       20         30        40        50                       10          20         30   40          50
                     Lag                                                                 Lag                                             Lag                                                                 Lag


Figure 6: Volatility Estimates. The left side corresponds to the one-factor model and the right-hand
side to the two-factor one. The bottom plots of the figure are the autocorrelations in ξ1 (Sb n ) − Vb n
                                                                                              t       t
              n           n
and log(ξ1 (St )) − log(Vt ).
            b           b



9.1    Preliminary results
Lemma 1 Under the conditions of Theorem 2, we have
           1 PN                                                    
              √       1
                     j=1 ∇ S κ(k  j , τ j , S 1 , θ 0 ) 1,k j ,τ j
                                                                                   
                                                                                                                                                                           E1
                                                                                                                                                                                
           N1                   ..                                 
                                 .                                                                                                                                       .. 
          
           1 PNT
                                                                                                                                                                           . 
             √           ∇S κ(kj , τj , ST , θ0 )T,kj ,τj  L−s
                                                                                                                                                                              
                                                                             1/2                                                                                        ET 
                T Pj=1
           N
                                                                     −→ ΩT
                                                                           e                                                                                                    ,                                      (17)
                                                                                                                                                                           E01 
                    N1
                                                                                  
           √1           ∇   κ(k    , τ   , S   , θ  )                            
           N1 j=1         θ      j    j      1    0    1,k j j,τ                                                                                                             
                               ..                                                                                                                                         .. 
          
                                 .
                                                                                                                                                                            . 
                                                                                                                                                                           E0T
                                                                   
             √1
                  P  NT
               N     j=1 ∇θ κ(kj , τj , ST , θ0 )T,kj ,τj
                                           T




                                                                                                           37
where {Et }t≥1 are defined in Theorem 2, {E0t }t≥1 are vectors of standard normal variables, each of
size q × 1, independent of each other and of the filtration F as well as the vector {Et }t≥1 and
                                              e 1,1                                    e 1,T +1                     
                                                ΩT               ...     0p×p           Ω  T           ...    0p×q
                                              .                 ..          ..               ..       ..        .. 
                                              ..                   .         .                .          .       . 
                                                                                                                    
                                             
                                                0p×p             ...    Ωe T,T            0p×q         ...      T,2T 
                                                                                                              ΩT 
                                                                                                              e
                                                                           T
                                          Ω
                                          e =
                                              e T +1,1                                e T +1,T +1                   .
                                              ΩT                ...     0q×p          Ω T             ...    0q×q 
                                              ..                           ..               ..                   .. 
                                                                                                                    
                                                                 ..                                    ..
                                              .                    .        .                .           .        . 
                                                0q×p             ...    e 2T,2T
                                                                        Ω                 0q×q         ...    ΩT
                                                                                                              e 2T,T
                                                                          T


The block components of Ω
                        e T are defined as follows:

                                                                            k(t,τ )
                                                                                         1
                                                                        Z
 e t,t = Ωt,t , Ω
                e t,T +t = (Ω
                            e T +t,t )0 =
                                                           X
 Ω T      T       T           T                                   πtτ                          φt,k,τ ∇S κ(k, τ, St , θ0 )∇θ κ(k, τ, St , θ0 )0 dk,
                                                             τ          k(t,τ )       ψt,τ (k)
                                       k(t,τ )
                                                    1
                                   Z
 e T +t,T +t =
                        X
 Ω T                         πtτ                          φt,k,τ ∇θ κ(k, τ, St , θ0 )∇θ κ(k, τ, St , θ0 )0 dk,                t = 1, ..., T.
                        τ          k(t,τ )       ψt,τ (k)

Proof of Lemma 1. We denote
                                                             
                    (t)    ∇S κ(kj , τj , St , θ0 )t,kj ,τj
                   χj =                                         ,                                         t = 1, ..., T,                       (18)
                            ∇θ κ(kj , τj , St , θ0 )t,kj ,τj

                                                                                                              (0)
which is a (p + q) × 1 vector. We further denote the filtration Fej = σ ({t,ki ,τi }t=1,...,T,i=1,...,j ) ∪ FT
for j = 0, 1, ... (recall from A1 that the sequence of observation grids on the moneyness dimension
is nested). With this notation we will show
                                                              Nt
                                                         1 X       (t) L−s
                                                 ΥN
                                                  t
                                                    t
                                                      = √        χ     −→ Υt ,                       t = 1, ..., T,                            (19)
                                                          Nt j=1 j

                            (0)                                                                                (0)
where Υt is a FT -conditionally centered Gaussian process with FT -conditional variance of
                                                           !
                                        e t,t
                                        Ω        e t,T +t
                                                 Ω
                                           T        T
                                                e T +t,T +t .
                                       e T +t,t Ω
                                       Ω T        T

                                  PNt       (t)
We have that             √1
                          Nt
                                is adapted to FeNt , for Nt ∈ N. Moreover, we have that the nesting
                                       j=1 χj
                                                                           W
property of the filtration, FeN ⊂ FeN +1 for N ∈ N, and furthermore FT = j Fej . Therefore, we can
apply Theorem VIII.5.42 of Jacod and Shiryaev (2003). To establish (19) above it now suffices to
prove,
                                 Nt                                                                                        Nt
                                                                                                               !
    
         (t)
                            1 X     
                                       (t) (t)0
                                                                                      e t,t
                                                                                       Ω          e t,T +t
                                                                                                  Ω                     1 X       (t)
                                                                                                                              E||χj |Fej−1 ||4 −→ 0.
                                                    P                                     T          T                                          P
E       χj |Fej−1       = 0,        E χj χj |Fej−1 −→                                 e T +t,t   e T +t,T +t       ,     2
                             Nt j=1                                                   Ω T        Ω T                   Nt j=1
                                                                                                                                                (20)
 The first and the third result of (20) follow immediately upon making use of A4(i) and A4(iv). To
prove the second claim we apply assumption A4(ii) and A4(iii) as well as assumption A1, concerning
the mesh of the grid in the log-moneyness dimension of the options, the smoothness of the φt,k,τ


                                                                                 38
function in A4(iii), and the smoothness of κ(k, τ, Z, θ) in its first argument. In fact, we even have
the convergence holding almost surely.
   Now we will prove that the convergence in (19) holds jointly for t = 1, ..., T with the limits
        (0)
being FT -conditionally independent. That is, we will show
                              T                          T
                                          !                                  !
                              Y                       Y
                                     Nt
                        E Y     ft Υt       −→ E Y          E (f1 (Υ1 ) |FT ) ,                  (21)
                               t=1                             t=1

for ft (·) being Lipschitz functions on Rp+q , Y denoting a bounded random variable on FT , and Υt
indicating the limits in (19).
                                                        (0)
    We look first at the case when Y is adapted to FT . In this case, using A4(iii), we have
                               T                      T
                                             !                               !
                                                                      
                                                                       (0)
                              Y                      Y
                                        Nt                      Nt
                        E Y       ft Υt        =E Y       E ft Υt |FT          .
                              t=1                        t=1

Next, using Theorem VIII.5.25 of Jacod and Shiryaev (2003), we have
                                                 b N −→
                                                 Q
                                                      P
                                                        Q,                                            (22)
where Q b N (ω (0) , ·) is the conditional distribution of the process ΥNt , which is a transitional proba-
                                                                        t
bility kernel from (Ω(0) , F (0) ) into (Rp+q , B(Rp+q )) and Q is the conditional probability associated
with the limiting process Υt (conditional on the event ω (0) ∈ Ω(0) ). This convergence is in the space
of probability measures equipped with the weak topology, therefore we have
                                                                         
                                                 (0)                    (0)
                                   E ft (ΥN
                                                        P
                                           t ) FT      −→ E ft (Υt ) FT .                              (23)
                                            t



From here, since the functions ft (·) and the variable Y are bounded, we have
                       T                                   T
                                                !                               !
                                                                         
                                          (0)                             (0)
                      Y                                    Y
                                    Nt
                E Y      E ft Υt |FT              −→ E Y      E ft (Υt )|FT       ,                   (24)
                        t=1                                          t=1
                                       (0)
and therefore (21) holds when Y is    FT -adapted.
                                                          (1)                                    (1)
     We are left with the case when Y is adapted to FT . Due to separability of the σ-field FT , we
can proceed exactly as in step 4 of the proof of Theorem IX.7.28 in Jacod and Shiryaev (2003) and
look only at the case when Y = h({m }m∈M ) where M is a finite set of triplets (t, k, τ ). Now, we let
e Nt denote a variable constructed from ΥNt by excluding the options corresponding to the triplets
Υ t                                           t
                                                                e Nt − ΥNt are obviously negligible. So,
(t, k, τ ) ∈ M . Since this is a finite number, the differences Υ t       t
we only need to verify (21) for the case where Υ  e t is replaced by ΥNt . However, due to assumption
                                                    N
                                                    t                   t
A4(iii), we have that Υ  e Nt and Y are independent conditional on F (0) . From here, we can proceed
                           t                                              T
                                                                 (0)
exactly as in the proof for the case when Y is adapted to FT .                                        
Lemma 2 Under the conditions of Theorem 3, we have
                                 2      
         V    n P
                            ∆ 1,n
                                  W     − 1         √
        1 kn i∈I +,n
                                                                                             
                              i                       2V1                 ...   0         E
                                                                                           e1
                                             
   p                    .
                         ..                     L−s  .                    ..     ..      ..  ,
    kn                                        −→  ..                                               (25)
                                              
                                                                              .
                                                                                √.           . 
                                                                                     
                                           
                                      2                0                   ...   2VT       E
                                   
         VT knn i∈I +,n ∆T,n
               P                                                                         eT
                              i W       −1


                                                    39
where {E
       et }t≥1 are defined in Theorem 3.

Proof of Lemma 2. Since kn /n → 0, it is no limitation to assume kn /n < 1, and we do so
henceforth. In particular, this implies that the sets {t + ni }i∈I ±,n for t = 1, ..., T are disjoint. The
validity of the Lemma now follows if we can show,
p   P                                                                                               √ 
                        2                                               2                                                   
                   1,n                                                                       L−s
     n                                          n
                                                                   ∆T,n
                                                     P
 kn  kn i∈I +,n  ∆ i   W    − 1  ...            kn   i∈I +,n        i W           −1         −→        2 Ee1             ...   E
                                                                                                                               eT       .

                                                                                                                             2           
                                                                                                 n
                                                                                                                        ∆t,n
                                                                                                      P
The convergence in law follows from a standard central limit theorem, as                         kn       i∈I +,n        i W        −1
                                                                                                            o   n
are independent of each other for different values of t, and further each of them equals k1n ki=1 (Zi )2 − 1
                                                                                            P n

in probability, where Zi are i.i.d. standard normal variables. Thus we only need show that the
convergence holds stably, and for this it suffices to consider at bounded variables adopted to the
filtration generated by the Brownian motion Wt . We are now in position to directly apply Steps 3
and 4 of the proof of Proposition 8.2 of Jacod and Todorov (2010) to establish the result.           

Lemma 3 If the conditions of Theorem 2 and Theorem 3 hold, then the convergence in Lemma 1
and Lemma 2 holds jointly and further the vectors (E1 , ..., ET , E01 , ..., E0T )0 and (E         eT )0 in
                                                                                         e1 , ..., E
Lemma 1 and Lemma 2 are independent.

Proof of Lemma 3. Exploiting the same notation as in the proof of Lemmas 1 and 2, we further
denote,
                              0
       X1N = ΥN
              1
                1
                  . . . ΥNT
                            T
                                 ,
            p                         2                                                  2    0
         n              n
                          P          1,n                                     n
                                                                                  P         T,n
        X2 = kn V1 kn i∈I +,n ∆i W − 1        ...                   VT       kn    i∈I +,n ∆i W    −1     ,

where N = mint=1,...,T Nt . In this notation, we must prove

                  E Y f (X1N )g(X2n ) −→ E (Y E (f (X1 )|FT ) E (g(X2 )|FT )) ,
                                       
                                                                                                                                (26)

for f (·) and g(·) being Lipschitz functions on RT (p+q) and RT , respectively, Y denoting a bounded
random variable on FT , and X1 and X2 representing the limits in (17) and (25), respectively.
                                                            (0)
    First we consider at the case where Y is adapted to FT . Exactly as in the proof of Lemma 1,
we can show                                                          
                                            (0)                     (0)
                               E f (X1N ) FT
                                                   P
                                                  −→ E f (X1 ) FT .                              (27)

From here, for every sufficiently small  > 0, there exists N > 0 such that for N > N , we have
                      n                                             o
                                                (0)                (0)
                    E Y g(X2n ) E f (X1N ) FT         − E f (X1 ) FT      ≤ K,                (28)

for some positive constant K (that does not depend on  and N), where we also exploited the
                                                                              (0)     (0)
boundedness of Y , f (X1N ) and g(X2n ). Next, using the fact that E f (X1 ) FT Y is FT -adapted,
the definition of stable convergence, and the result of Lemma 2, we obtain the limit result in (26)
                           (0)
for the case where Y is FT -adapted.
                                                          (1)
    We are left with the case where Y is adapted to FT . The proof is identical to the analogous
case for the proof of Lemma 1. Hence, the proof is omitted.                                      

                                                         40
Lemma 4 Under the conditions of Theorem 3 we have
                      T
                 n X X         t,n
                                     
                                        t,n
                                                    
                                   2             −$
                                                      − Vt (∆t,n  2                       P
                √            (∆i X) 1 |∆i X| ≤ αn            i W)                         −→ 0.                  (29)
                  kn t=1 +,n
                          i∈I

Proof of Lemma 4. First, via a localization argument similar to that in, e.g., Lemma 4.6 of
Jacod (2008), it suffices to consider the case where the processes αt , Vt and at , as well as the jumps
of the process X, are bounded. Thus, we impose this condition for the remainder of this proof.
    Applying Itô lemma, we have
                        
                     1          p           Z                   Z
 d log(Xt ) = αt − Vt dt + Vt dWt +                xe
                                                    µ(dt, dx) +        (log(1 + x) − x) µ(dt, dx), (30)
                     2                        x>−1               x>−1

note that log(1 + x) − x ∼ x2 for x → 0 and therefore the last integral above is well defined in the
usual Riemann-Stieltjes sense. We further denote
     Z t                Z tp              Z tZ                Z tZ
             1
At =     αs − Vs ds, Zt =     Vs dWs , Yt =          xe
                                                      µ(ds, dx)+         (log(1 + x) − x) µ(ds, dx).
      0      2             0                 0  x>−1             0  x>−1

In this notation, we obtain the following decomposition for any i ∈ I +,n and t = 1, ..., T ,
                                        2
  (∆t,n    2                        t,n
     i X) 1{|∆t,n X|≤αn−$ } − Vt ∆i W
                  i

     =   (∆t,n 2
           i X) 1{|∆t,n     −$ }    − (∆t,n 2                         t,n    t,n 2
                                        i X) 1{|∆t,n Y |≤ α n−$ } + |∆i X − ∆i Z| 1{|∆t,n Y |≤ α n−$ }
                    i X|≤αn                             i           2                             i       2

         + 2(∆t,n     t,n    t,n
               i X − ∆i Z)∆i Z1{|∆t,n
                                                        t,n
                                            α −$ − (∆i Z) 1
                                                              2
                                                                {|∆t,n    α −$
                                     i Y |≤ 2 n  }                 i Y |> 2 n  }
                                   2                          2
         + (∆t,n  2
             i Z) − Vt+ i−1 ∆i W
                                t,n
                                       + (Vt+ i−1 − Vt ) ∆t,n
                                                            i W      .
                            n                       n
                                                                                                                 (31)

We now derive bounds for moments of each of the terms of the decomposition. These bounds will,
in combination, prove convergence of their (scaled) sums either in the L1 or L2 norms. Henceforth,
in the proof of the lemma, K denotes a positive constant which is independent of n and typically
will take on different values across the different equations. First, we have,

   |(∆t,n 2                      t,n 2                           t,n 2
      i X) 1{|∆t,n X|≤αn−$ } − (∆i X) 1{|∆t,n Y |≤ α n−$ } | ≤ (∆i X) 1{|∆t,n X−∆t,n Y |≥ α n−$ } ,              (32)
                      i                         i           2                         i    i          2


and then using Hölder inequality, the boundedness of αt and Vt , and the Burkholder-Davis-Gundy
inequality, we get

             E (∆t,n 2                      t,n 2                         −ζ
                 i X) 1{|∆t,n X|≤αn−$ } − (∆i X) 1{|∆t,n Y |≤ α n−$ } ≤ Kn , ∀ζ > 0.                             (33)
                                i                                       i       2

                                                                                                                      p
                                                                                                          P
Next,   by applying the Burkholder-Davis-Gundy inequality and/or the algebraic inequality |                   i |ai ||    ≤
         p
P
  i |ai | for any p ∈ (0, 1], we obtain

                                     E|∆t,n  ζ    −1
                                        i Y | ≤ Kn ,                        ∀ζ ≥ β.                              (34)

Exploiting the above inequality, we deduce
                       n                                  o
                     E |∆t,n        t,n 2
                          i X − ∆i Z| 1{|∆t,n Y |≤ α n−$ } ≤ Kn
                                                                −1−(2−β)$
                                                                          .                                      (35)
                                                    i           2



                                                        41
                                                                                       RtR
Next, we decompose Yt depending on the value of β in Assumption A0. Yt = 0 x>−1 log(1 +
               Rt      R
x)e
  µ(ds, dx) + 0 as ds x>−1 (log(1 + x) − x)ν P (dx) when β in assumption A0 cannot be chosen less
                  RtR                          Rt      R
than 1 and Yt = 0 x>−1 log(1+x)µ(ds, dx)− 0 as ds x>−1 xν P (dx) otherwise. Then, upon making
use of the elementary inequality 1(|a + b| < c) ≤ 1(|a| > c) + 1(|b| < 2c) for any a, b ∈ R and c > 0,
we get
                                                                   −1/2− β1 ∧1−(1−β)$∨0
                E (∆t,n       t,n     t,n
                      i X − ∆i Z)∆i Z1{|∆t,n Y |≤ α n−$ } ≤ Kn                          .         (36)
                                                             i          2

Moreover, applying the Hölder inequality and the inequality (34) yields,
                           n                            o
                        E (∆t,n i Z) 2
                                       1    t,n  α
                                         {|∆ Y |> n −$ } ≤ Kn
                                                              −1−(1−β$)
                                                                        .                                                          (37)
                                                        i          2


Finally, using the boundedness of Vt from both below and above, along with Aassumption A0(i),
and the Itô isometry, we obtain,
                                                   v
                                      2           uZ t+ i
                                                         n
                                                  u
               t,n                t,n         −1/2 t
                   2
         E (∆i Z) − Vt+ i−1 ∆i W         ≤ Kn              E(Vs − Vt+ i−1 )2 ds ≤ Kn−3/2 . (38)
                                   n
                                                                                 t+ i−1
                                                                                     n
                                                                                                         n


                                      n                           o         √
                                  E        Vt+ i−1 − Vt (∆t,n
                                                          i   W ) 2
                                                                      ≤ Kn−3/2 i − 1.                                              (39)
                                               n

    Combining these findings, we validate the convergence result in (29).                                                            

9.2    Proof of Theorem 1
We fix an arbitrarily small  > 0. We make use of the following decomposition, for t = 1, ..., T and
j = 1, ..., Nt :
                                                2
                 bt,kj ,τj − κ(kj , τj , Zt , θ) =2t,kj ,τj + (κ(kj , τj , St , θ0 ) − κ(kj , τj , Zt , θ))2
                 κ
                                                                                                                   (40)
                                                      + 2t,kj ,τj (κ(kj , τj , St , θ0 ) − κ(kj , τj , Zt , θ)) .

Assumption A2 implies that
                                                            T XZ
                                                            X                k(t,τ )
        δ =                       inf                                                  (κ(k, τ, St , θ0 ) − κ(k, τ, Zt , θ))2 dk
              t=1,...,T : ∪ ||Zt −St ||> ∪ ||θ−θ0 ||>                     k(t,τ )
                                                            t=1    τ

is almost surely positive (δ depends on the realization ω). The fact that δ > 0 implies there is at
least one time and maturity pairing for which there is a range of moneyness within the interval
(k(t, τ ), k(t, τ )) with positive Lebesgue measure (this range can be different for different ω in the
probability space) over which the difference (κ(k, τ, St , θ0 ) − κ(k, τ, Zt , θ))2 is strictly positive. But
then, since the mesh of the moneyness for each t = 1, ..., T and each time-to-maturity is of size
O(1/Nt ), we have that the number of pairs (kj , τj ) within this range of log-moneyness and time-to-
maturity is of order O(Nt ) (note that ψt,τ (k) of assumption A1 is strictly positive). Next, because κ
is continuously differentiable in its log-moneyness argument, there exists an N 1 > 0, almost surely
(N 1 depends on ω, of course), such that for mint=1,...,T Nt > N 1 :
                                                      T    Nt
                                                      X 1 X                                                 δ
                            inf                               (κ(kj , τj , St , θ0 ) − κ(kj , τj , Z, θ))2 > .                     (41)
          t=1,...,T : ∪ ||Zt −St ||> ∪ ||θ−θ0 ||>     Nt                                                  2
                                                      t=1         j=1


                                                                   42
Now, assumption A3 implies that, for every infinite subsequence of mint=1,...,T Nt , there exists a
further subsequence, denoted N 0 , along which we have,
                                          PT 1 PNt
                                           t=1 Nt    j=1 (κ(kj , τj , St , θ0 ) − κ(kj , τj , Z, θ)) t,kj ,τj
                   sup                     PT 1 PNt                                                     2
                                                                                                               −→ 0, a.s,
t=1,...,T : ∪ ||Zt −St ||> ∪ ||θ−θ0 ||>     t=1 Nt    j=1 (κ(kj , τj , St , θ0 ) − κ(kj , τj , Z, θ))

where mint=1,...,T Nt in the above almost sure convergence is an element of the subsequence N 0 .
Therefore, for some ι ∈ (0, 1), there exists N 2 , such that for mint=1,...,T Nt > max{N 1 , N 2 }, along
the subsequence N 0 , we have on ω
                                                   T       Nt                                    T       Nt
                                                  X   1 X                                    2 X   1 X 2               δ(1 − ι)
                        sup                                   bt,kj ,τj − κ(kj , τj , Zt , θ) >
                                                              κ                                             t,kj ,τj +          ,   (42)
      t=1,...,T : ∪ ||Zt −St ||> ∪   ||θ−θ0 ||> t=1 N t
                                                          j=1                                   t=1
                                                                                                    N t
                                                                                                        j=1
                                                                                                                           2

 where, again, mint=1,...,T Nt is an element of the subsequence N 0 and we also exploited (41). Next,
since {Vbtn }t=1,...,T is consistent for {Vt }t=1,...,T , we have, for every infinite subsequence of n, a further
subsequence, denoted n0 , along which we have almost sure convergence, i.e.,
                                                          0
                                                      Vbtn → Vt ,       t = 1, ..., T, a.s.

Then, since λn converges to a finite λ, there exists n > 0 such that, for n > n along the subsequence
n0 and on the same ω for which (42) is true, we have,
                                                                    0              δ(1 − ι)
                                                     λn sup |Vbtn − Vt |2 ≤                 .                                        (43)
                                                       t=1,...,T                      4

Combining (42) and (43) implies that, along the subsequences N 0 and n0 , we have for mint=1,...,T Nt
and n sufficiently high,
                                               b n − St || <  and ||θbn − θ0 || < ,
                                         sup ||S                                                     a.s.                            (44)
                                                 t
                                       t=1,...,T

Therefore, since convergence in probability is equivalent to almost sure convergence on a subse-
quence to any infinite subsequence of the original series, see, e.g., Lemma 3.2 of Kallenberg (1997),
we have from (44),
                                                                      !
                       P          b n − St || >  ∪ ||θbn − θ0 || > 
                            sup ||S                                     −→ 0.
                                    t
                                         t=1,...,T

Since, the choice of  was arbitrary, the above proves the consistency result of the theorem.                                          

9.3      Proof of Theorem 2
Exploiting that the implied volatility function is differentiable with respect to the state variables
and the parameters of the risk-neutral distribution along with the consistency result in Theorem 1,
              b n }t=1,...,T and θbn , with probability approaching 1, solve
we have that {S t
              PN1                                       
            1                                    n bn                      b n , θbn ) − λn ∇S ξ1 (S
                                                                                                   b n )(Vb n − ξ1 (S
                                                                                                                    b n )) = 0,
       
       
         N1     j=1   κ
                       b 1,kj ,τj − κ(k ,
                                       j jτ ,  S
                                               b
                                                 1 , θ  )   ∇S κ(kj , τj , S 1                       1     1          1
        ..
       
       
       
          .                                               
        1 PNT κ                                b n , θbn ) ∇S κ(kj , τj , S
                        bT,kj ,τj − κ(kj , τj , S                           b n , θbn ) − λn ∇S ξ1 (S
                                                                                                    b n )(Vb n − ξ1 (S
                                                                                                                     b n )) = 0,
       
       
         N  T    j=1                             T                           T                        T     T          T
                                                              
        PT 1 PNt κ
       
                                                          n bn                        n bn
                        j=1 bt,kj ,τj − κ(kj , τj , St , θ ) ∇θ κ(kj , τj , St , θ ) = 0.
                                                       b                           b
              t=1 Nt


                                                                        43
Using a first-order Taylor expansion we obtain,
           bn                         1
                                             PN1                                        
            S1 − S1                            j=1 1,kj ,τj ∇S κ(kj , τj , S1 , θ0 )
                          
                                        N1
                ..                                       ..
                                                                                                                    !
                                                                                     
                                                                                                        1
       H
       eT       .         
                          =                             .                             
                                                                                         + op                          ,
                                            NT
                                                                                                p
            b n − ST                   1                                                          mint=1,...,T Nt
                                          P
                                            j=1 T,kj ,τj S κ(kj , τj , ST , θ0 )
                                                       ∇
           S                                                                         
              T
                                     PN
                                       T
                                                                                        
                                      T      PNt
            θbn − θ0                      1
                                      t=1 Nt   j=1 t,kj ,τj ∇θ κ(kj , τj , St , θ0 )

where H e T denotes the analogue of H     b T in which {S b n }t=1,...,T is replaced by {S
                                                                                         e t }t=1,...,T and θbn with
                                                            t
θe for {S                             b n }t=1,...,T and {St }t=1,...,T and θe residing in the interval between
        e t }t=1,...,T lying between {S
                                        t
θbn and θ0 . The op term in the expansion   stems     from the presence of terms depending on Vt in the
                                                                                                          bn
first-order conditions, the fact that S      b n , θbn is consistent (and hence asymptotically bounded in
                                                    t   t

probability), the fact that      {Vbtn }t=1,...,T
                                           is asymptotically bounded in probability, and the assumed
           2
relation λn mint=1,...,T Nt → 0 in the theorem.
    Since the mesh of the grid on the log-moneyness of the options decreases with Nt ∆t,τ (i) →
ψt,τ (k) uniformly on the interval (k(t, τ ), k(t, τ )), we trivially have, pathwise,
            Nt                                            Z k(t,τ )
        1 X                                            0               1
               ∇S κ(kj , τj , Z, θ)∇S κ(kj , τj , Z, θ) →                    ∇S κ(k, τ, Z, θ), ∇S κ(k, τ, Z, θ)0 dk,
        Nt j=1                                             k(t,τ )  ψt,τ (k)

for any finite Z and θ. Moreover, since ∇S κ(k, τ, Z, θ) is continuous in the arguments Z and θ,
                                                                                                             P
the above convergence also holds locally uniformly in Z and θ. Therefore, since θe −→ θ0 and
e t −→P                                                 P
S         St for t = 1, ..., T , we have H    e T −→         HT . Combining this result with the limit result in
Lemma 1, we establish the asymptotic distribution result in (6).
    The remaining part of the proof is now the consistency of Ω                       b T for ΩT and of H
                                                                                                        b T for HT . We
                                                   t,t
only show the consistency of the block Ω        b , as the proofs for the other blocks of Ω
                                                   T
                                                                                                    b T and Hb T proceed
in an identical fashion. Moreover, it suffices to prove consistency for each of the elements of Ω                   b t,t .
                                                                                                                      T
First, using Assumptions A4(ii), A4(iii) and A4(iv), we have,
                                                                                    2       
                 1 X    Nt                                                                  
              E                2t,kj ,τj − φt,kj ,τj A(ι1 ,ι2 ) (kj , τj , St , θ0 ) F (0)
                 Nt                                                                           
                        j=1
                                                                                                                    (45)
                        Nt
                    1 X                                              2
                = 2          %t,kj ,τj A(ι1 ,ι2 ) (kj , τj , St , θ0 ) −→ 0, a.s., ι1 , ι2 = 1, ..., p,
                   Nt j=1

where A(ι1 ,ι2 ) (k, τ,Z, θ) denotes the (ι1 ,ι2 ) element of the matrix ∇S κ(k, τ, Z, θ)∇S κ(k, τ, Z, θ)0 , and
where %t,k,τ = E (2t,k,τ − φt,k,τ )2 |F (0) , which by Assumption A4(iv) is finite. The almost sure
convergence in (45) follows because of the pathwise boundedness of the functions A(ι1 ,ι2 ) (k, τ, Z, θ)
and %t,k,τ on the range of moneness (k ( t, τ ), k ( t, τ )). The convergence in (45) implies,
                                                                               2        
              1 X    Nt                                                               ^ 
          E E              2t,kj ,τj − φt,kj ,τj A(ι1 ,ι2 ) (kj , τj , St , θ0 ) F (0)   1  −→ 0. (46)
              Nt                                                                          
                           j=1

Using Jensen’s inequality and (46), as well as law of iterated expectations, we further have,
                                                                                 2    
                  1 X  Nt                                                          ^ 
              E             2t,kj ,τj − φt,kj ,τj A(ι1 ,ι2 ) (kj , τj , St , θ0 )   1   −→ 0,                            (47)
                  Nt                                                                    
                              j=1


                                                               44
which is equivalent to
                    Nt 
                 1 X                           
                         2t,kj ,τj − φt,kj ,τj ∇S κ(kj , τj , St , θ0 )∇S κ(kj , τj , St , θ0 )0 −→ 0.
                                                                                                   P
                                                                                                                        (48)
                 Nt
                     j=1

Finally, using the fact that κ(k, τ, Z, θ) is twice continuously differentiable in all its arguments, we
have for some  > 0, S = {S1 , ..., ST }, k = mint=1,...,T minτ k(t, τ ) and k = maxt=1,...,T maxτ k(t, τ ),

        sup       sup               sup      { ||∇S κ(k, τ, Z, θ)|| + ||∇SS κ(k, τ, Z, θ)|| } < ∞ , a.s.                (49)
      k∈(k,k) Z∈(S−,S+) θ∈(θ0 −,θ0 +)

                                                        b n sufficiently close to St and θbn sufficiently
Therefore, since for Nt sufficiently high, we will have S t
close to θ0 , so that we have,
                           Nt
                    t,t 1 X
                              2t,kj ,τj ∇S κ(kj , τj , St , θ0 ) ∇S κ(kj , τj , St , θ0 )0 −→ 0.
                                                                                             P
                  ΩT −
                  b                                                                                                     (50)
                        Nt
                                   j=1

Combining (48) and (50) with the the smoothness of φt,k,τ in its second argument and the smooth-
                                                             b t,t −→
ness of ∇S κ(k, τ, Z, θ) in the first argument, we conclude, Ω
                                                                    P
                                                                      Ωt,t
                                                               T       T .                    

9.4     Proof of Corollary 1
The proof follows from a trivial extension of Lemma 1, the smoothness of the function κ(k, τ, Z, θ)
in its arguments, the consistency of {S         b n }t=1,...,T and θbn , as well as the properties of the stable
                                                  t
convergence. First, a Taylor expansion yields
                                                                                                    
       X                                          X                    X                                       
            bt,kj ,τ ∗ − κ(kj , τ ∗ , S
            κ                         b n , θ)
                                        t
                                            b =           t,kj ,τ ∗ −      ∇S κ(kj , τ ∗ , S
                                                                                             e t , θ)
                                                                                                   e S  b n − St
                                                                                                           t
      j:kj ∈K                                      j:kj ∈K                j:kj ∈K
                                                                                     
                                                         X                                         
                                                  −              ∇θ κ(kj , τ ∗ , S     e  θbn − θ0 ,
                                                                                  e t , θ)
                                                        j:kj ∈K


where {Se t }t=1,...,T is between {S   b n }t=1,...,T and {St }t=1,...,T and θe lies between θbn and θ0 . Therefore,
                                         t
using the consistency of {S      b n }t=1,...,T and θ,    b as well as the smoothness of κ(k, τ, Z, θ) (and its
                                    t
derivatives with respect to Z and θ) in the log-moneyness, we obtain,
                                                                            √
                                                                                      b n − S1 )
                                                                                                     
                                                                                N1 (S   1
                                                                                      ..            
                                                                                       .            
               1                                                         √                        
                                                                                      b n − ST )
                      X
                             bt,kj ,τ ∗ − κ(kj , τ ∗ , S
                             κ                         b n , θ)
                                                             b = ΠT           N    (S                + op ,  (51)
                                                                                                    
            p                                            t                        T     T
                 K
              Nt j:kj ∈K
                                                                          q
                                                                            N1 +...+NT bn
                                                                                                    
                                                                       
                                                                                 T        (θ − θ0 ) 
                                                                                                     
                                                                            1
                                                                          √ K j:k ∈K t,kj ,τ ∗
                                                                                 P
                                                                              Nt         j


where
                                                                                                                           
                                  1                                                            1
                 Z                                                                    Z
                                        ∇S κ(k, τ, St , θ)0 dk 01×(T −t+1)p − T ςt
                                                                             p
                                                                                                                       0
ΠT = 01×(t−1)p −                                                                                     ∇θ κ(k, τ, St , θ) dk 1 .
                           K   ψt,τ (k)                                                 K   ψt,τ (k)

                                                             45
                                                                 b n }t=1,...,T and θbn , we get,
Next, using the Taylor expansion in (45) and the consistency of {S t
                                                                                                                                                !
                                                                                H−1                                     ζ{Nt }t=1,...,T
                                                                                                          
       1      X                               ∗     n b
                                                          
                                                                                 T              0pT +q×1
                       κ
                       bt,kj   ,τ ∗   − κ(kj , τ , St , θ) = ΠT                                                   √1 K
                                                                                                                         P                          + op ,   (52)
                                                                                                                           j:kj ∈K t,kj ,τ
                                                   b
                                                                                                                                            ∗
                                                                              01×pT +q              1
   p
       NtK   j:kj ∈K                                                                                               Nt


where we denote
                                                                          PN1
                                                                    √1
                                                                               j=1 1,kj ,τj ∇S κ(kj , τj , S1 , θ0 )
                                                                                                                                    
                                                                     N1
                                                                                           ..                                       
                                                                                            .                                       
                              ζ{Nt }t=1,...,T =                                                                                     .
                                                                         PNT                                                        
                                                               √1             j=1 T,kj ,τj ∇S κ(kj , τj , ST , θ0 )                
                                                 qP                NT                                                               
                                                              T     Nt   PT             PNt
                                                                                  1
                                                                                            j=1 t,kj ,τj ∇θ κ(kj , τj , St , θ0 )
                                                              t=1
                                                               T              t=1 Nt

Then, upon following exactly the same steps as in the proof of Lemma 1, we obtain,
                                                       !
                                    ζ{Nt }t=1,...,T      L−s
                                √1 K j:k ∈K t,kj ,τ ∗
                                     P                   −→ ZT ,                                                                                             (53)
                                           j              Nt

                                                                                                                            (0)                              (0)
where ZT , defined on an extension of the original probability space, is FT -Gaussian with a FT -
conditional covariance matrix given by
                                                                                                    0(t−1)p×1
                                                                                                                                               
                                                                               1                    1
                                                                                            R
                                                                                             K   ψt,τ (k) φt,k,τ ∇S κ(k, τ, St , θ0 )dk
                                                                 qR                                                                          
                                                                              1
                  ΩT           Υ1,T                                     K ψt,τ (k)
                                                                                    dk                                                          
                                             , Υ1,T    =                                                                                       ,
                  Υ01,T        Υ2,T                     
                                                                                                 R 0(T −t+1)p×1
                                                                                                                                                
                                                               √ 1 qR              1                    1
                                                                                                                                               
                                                                T ςt               1
                                                                                                            φ     ∇ κ(k, τ, St , θ0 )dk
                                                                                                  K ψt,τ (k) t,k,τ θ
                                                                              K ψt,τ (k)
                                                                                         dk

                                                                         1                     1
                                                                                       Z
                                                   Υ2,T = R               1                          φt,k,τ dk.
                                                                K ψt,τ (k)
                                                                           dk           K   ψt,τ (k)
Then, using the same techniques as in the proof for consistency of Ω
                                                                   b T (see (45)-(50) above), we can
              b0 Ξ
show that, 1K Π      b T −→ Π0 ΞT ΠT , where ΞT is defined exactly as Ξ
                  bT Π    P                                                b T , but with each matrix
                  Nt      T                           T
replaced by its analogue matrix without the hat. Now, using the definition of stable convergence,
we obtain the requisite limit result in (10).                                                  

9.5        Proof of Corollary 2
The proof follows from an extension of Lemma 1 and Theorem 2 for two panels with disjoint time
intervals.                                                                                   

9.6        Proof of Theorem 3
The results follows directly from combining Lemmas 2-4.                                                                                                        

9.7        Proof of Corollary 3
                                                          √
By Lemma 3, we have that { √1N S     b n − St }t=1,...,T and kn {Vb +,n −Vt }t=1,...,T are, conditionally on
                                 t
                                       t                           t
FT , asymptotically independent and normally distributed. Since the limit results of Lemma 3 hold
stably with respect to FT , and from Theorem 2, the corresponding part of the matrix         b −1 b b −1 0
                                                                                         HT ΩT (HT )
provides a consistent estimator for the asymptotic variance of { √1 S         b n − S1 }t=1,...,T , then by
                                                                                                                   Nt       1
applying the Delta method (recall that ξ1 is continuously differentiable), we obtain the limit result
of the Corollary.                                                                                  

                                                                                   46
References
Andersen, T. G. and T. Bollerslev (1998). Answering the Skeptics: Yes, Standard Volatility Models do
  Provide Accurate Forecasts. International Economic Review 39, 885–905.

Andersen, T. G., T. Bollerslev, F. X. Diebold, and P. Labys (2003). Modeling and Forecasting Realized
  Volatility. Econometrica 71, 579–625.

Andersen, T. G., O. Bondarenko, and M. T. Gonzalez-Perez (2011). Coherent Model-Free Implied Volatility:
  A Corridor Fix for High-Frequency VIX. Working paper, Northwestern University.

Andrews, D. (2005). Cross-Section Regression with Common Shocks. Econometrica 71, 1551–1585.

Barndorff-Nielsen, O. and N. Shephard (2002). Econometric Analysis of Realized Volatility and its Use in
  Estimating Stochastic Volatility Models. Journal of the Royal Statistical Society Series B, 64, 253–280.

Barndorff-Nielsen, O. E., S. E. Graversen, J. Jacod, and N. Shephard (2006). Limit Theorems for Realised
  Bipower Variation in Econometrics. Econometric Theory 22, 677–719.

Barndorff-Nielsen, O. E. and N. Shephard (2006). Econometrics of Testing for Jumps in Financial Economics
  using Bipower Variation. Journal of Financial Econometrics 4, 1–30.

Bates, D. S. (2000). Post-’87 Crash Fears in S&P 500 Future Options. Journal of Econometrics 94, 181–238.

Bates, D. S. (2003). Empirical Option Pricing: A Retrospection. Journal of Econometrics 116, 387–404.

Bollerslev, T. and V. Todorov (2011). Tails, Fears and Risk Premia. Journal of Finance 66, 2165–2211.

Breeden, D. and R. Litzenberger (1978). Prices of State Contingent Claims Implicit in Option Prices. Journal
  of Business 51, 621–652.

Broadie, M., M. Chernov, and M. Johannes (2009). Specification and Risk Premiums: The Information in
  S&P 500 Futures Options. Journal of Finance 62, 1453–1490.

Christoffersen, P., S. Heston, and K. Jacobs (2009). The Shape and Term Structure of the Index Option
  Smirk: Why Multifactor Stochastic Volatility Models Work so Well? Management Science 55, 1914–1932.

Christoffersen, P. and K. Jacobs (2004). The Importance of the Loss Function in Option Valuation. Journal
  of Financial Economics 72, 291–318.

Duffie, D. (2001). Dynamic Asset Pricing Theory (3rd ed.). Princeton University Press.

Duffie, D., J. Pan, and K. Singleton (2000). Transform Analysis and Asset Pricing for Affine Jump-Diffusions.
  Econometrica 68, 1343–1376.

Eraker, B. (2004). Do Stock Prices and Volatility Jump? Reconciling Evidence from Spot and Option Prices.
  Journal of Finance 59, 1367–1403.

Foster, D. and D. Nelson (1996). Continuous Record Asymptotics for Rolling Sample Variance Estimators.
  Econometrica 64, 139–174.

Gagliardini, P., C. Gourieroux, and E. Reanult (2011). Efficient Derivative Pricing by the Extended Method
  of Moments. Econometrica 79, 1181–1232.

Gourieroux, C., A. Monfort, and A. Trognon (1984). Pseudo Maximum Likelihood Methods: Theory.
  Econometrica 59, 681–700.


                                                     47
Ibragimov, I. and R. Has’minskii (1981). Statistical Estimation: Asymptotic Theory. Berlin: Springer.

Jacod, J. (2008). Asymptotic Properties of Power Variations and Associated Functionals of Semimartingales.
  Stochastic Processes and their Applications 118, 517–559.

Jacod, J., Y. Li, P. Mykland, M. Podolskij, and M. Vettter (2009). Microstructure Noise in the Continuous
  Case: The Pre-Averaging Approach. Stochastic Processes and their Applications 119, 2249–2276.

Jacod, J. and A. N. Shiryaev (2003). Limit Theorems For Stochastic Processes (2nd ed.). Berlin: Springer-
  Verlag.

Jacod, J. and V. Todorov (2010). Do Price and Volatility Jump Together? Annals of Applied Probability 20,
  1425–1469.

Jones, C. (2006). Analysis of Index Option Returns. Journal of Finance LXI, 2325–2363.

Joslin, S., M. Priebsch, and K. Singleton (2010). Risk Premiums in Dynamic Term Structure Models with
  Unspanned Macro Risks. Working paper, Stanford University.

Kallenberg, O. (1997). Foundations of Modern Probability. New York: Springer-Verlag.

Kuersteiner, G. and I. Prucha (2011). Limit Theory for Panel Data Models with Cross Sectional Dependence
  and Sequential Exogenuity. Working paper, Georgetown University and University of Maryland.

Newey, W. (1985). Maximum Likelihood Specification Testing and Conditional Moment Tests. Economet-
  rica 53, 1047–1070.

Newey, W. (1991). Uniform Convergence in Probability and Stochastic Equicontinuity. Econometrica 59,
  1161–1167.

Newey, W. and D. McFadden (1994). Large Sample Estimation and Hypothesis Testing. In R. Engle and
  D. McFadden (Eds.), Handbook of Econometrics, Volume 4, pp. 2113–2241. Amsterdam: North-Holland.

Pan, J. (2002). The Jump-Risk Premia Implicit in Options: Evidence from an Integrated Time-Series Study.
  Journal of Financial Economics 63, 3–50.

Pastorello, S., V. Patilea, and E. Renault (2003). Iterative and Recursive Estimation in Structural Non-
  adaptive Models. Journal of Business and Economic Statistics 21, 449–482.

Robinson, P. (1987). Asymptotically Efficient Estimation in the Presence of Heteroskedasticity of Unkwown
  Form. Econometrica 55, 875–891.

Ross, S. (1976). Options and efficiency. Quarterly Journal of Economics 90, 75–89.

Ross, S. (2011). The Recovery Theorem. Working paper, MIT.

Singleton, K. (2006). Empirical Dynamic Asset Pricing. Princeton University Press.

Tauchen, G. (1985). Diagnostic Testing and Evaluation of Maximum Likelihood Models. Journal of Eco-
  noemtrics 30, 415–443.

Todorov, V. and G. Tauchen (2011). Volatility Jumps. Journal of Business and Economic Statistics 29,
  356–371.

White, H. (1982). Maximum Likelihood Estimation of Misspecified Models. Econometrica 50, 1–25.




                                                   48
