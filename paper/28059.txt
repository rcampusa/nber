                              NBER WORKING PAPER SERIES




         PERSISTENCE AND PATH DEPENDENCE IN THE SPATIAL ECONOMY

                                          Treb Allen
                                        Dave Donaldson

                                      Working Paper 28059
                              http://www.nber.org/papers/w28059


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                   November 2020




We are grateful to our discussants, Klaus Desmet, Jonathan Eaton, David Nagy, and David
Weinstein, as well as to Rodrigo Adão, Kristian Behrens, Arnaud Costinot, Don Davis, Jonathan
Dingel, Gilles Duranton, Cecile Gaubert, Rick Hornbeck, Jeffrey Lin, Vincent Lohmann, Robert
Margo, Nathan Nunn, James Rauch, Steve Redding, Stuart Rosenthal, John Sturm, Ivan Werning
and many seminar participants for comments that improved this paper. Richard Dionne and
Yunus Tuncbilek provided excellent research assistance. This material is based upon work
supported by the National Science Foundation under grant SES-1658838. The views expressed
herein are those of the authors and do not necessarily reflect the views of the National Bureau of
Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2020 by Treb Allen and Dave Donaldson. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Persistence and Path Dependence in the Spatial Economy
Treb Allen and Dave Donaldson
NBER Working Paper No. 28059
November 2020
JEL No. C33,C62,F1,R11,R13,R23

                                         ABSTRACT

How much of the spatial distribution of economic activity today is determined by history rather
than by geographic fundamentals? And if history matters for the distribution, does it also affect
overall efficiency? This paper develops a tractable theoretical and empirical framework that aims
to provide answers to these questions. We derive conditions on the strength of agglomeration
externalities, valid for any geography, under which temporary historical shocks can have
extremely persistent effects and even permanent consequences (path dependence). We also obtain
new analytical expressions, functions of the particular geography in question, that bound the
aggregate welfare level that can be sustained in any steady-state, thereby bounding the potential
impact of history. Our simulations--based on parameters estimated from spatial variation across
U.S. counties from 1800-2000--imply that small variations in historical conditions have
substantial consequences for both the spatial distribution and the efficiency of U.S. economic
activity, both today and in the long-run.


Treb Allen
Department of Economics
Dartmouth College
6106 Rockefeller Hall
Hanover, NH 03755
and NBER
treb@dartmouth.edu

Dave Donaldson
Department of Economics, E52-554
MIT
50 Memorial Drive
Cambridge, MA 02142
and NBER
ddonald@mit.edu
1    Introduction
Economic activity in modern economies is staggeringly concentrated. For example, more
than 1/6th of value-added in the United States is currently produced in just three cities
that occupy less than 1/160th of its land area. But perhaps even more remarkable are the
historical accidents that may have determined the location of these three cities--one was a
Dutch fur trading post, one a pueblo for 22 adult and 22 children settlers designated by a
Spanish governor to honor the angels, and one a river mouth known to Algonquin residents
for its wild garlic (or, chicago-ua ).
     There is no shortage of examples in which the quirks of history appear to influence the
current location of economic activity through either persistence --the long-lived dependence
of current outcomes on temporary events--or path dependence --where temporary events
fully govern long-run outcomes. See Nunn (2014) for a review. But how widespread should
we expect these phenomena to be in the spatial economies around us? Going further, "does
history matter only when it matters little?"--in Rauch's (1993) memorable phrase--because
it merely reshuffles the current location of economic activity without much affecting aggregate
efficiency?
     In this paper we develop a new framework designed to shed light on these questions and
then apply it to data from the United States between 1800 and 2000. We extend a rich vein of
theoretical modeling (as synthesized in, for example, Fujita, Krugman, and Venables, 1999),
in which agglomeration externalities can give rise to a potential multiplicity of equilibria,
by adding overlapping generation dynamics and an arbitrary number of locations featuring
general paths of geographic fundamentals and frictions. We derive conditions under which
such an environment can feature substantial persistence and even path dependence. And our
simulations, based on estimated parameter values, display exactly such phenomena for the
U.S. spatial economy: even relatively minor historical shocks exhibit centuries-long depen-
dence, and these shocks often lead to large and permanent differences in long-run aggregate
welfare.
     To arrive at this conclusion, we begin in Section 2 by stating four new theoretical re-
sults about this dynamic economic geography model. The first characterizes a condition for
dynamic equilibria--that is, the transition paths that would take this economy from any
starting point to any steady-state--to be unique, regardless of the underlying path of geo-
graphic fundamentals, as is important for the quantitative questions that we pose here. The
second highlights how temporary shocks may be particularly persistent--that is, feature a
very slow rate of convergence to a steady-state--when an economy gets close to the parame-
ter threshold at which uniqueness is not guaranteed. Our third result characterizes necessary


                                              1
(and "globally" sufficient) conditions for the economy to feature multiple stable steady-states,
which then creates the potential for path-dependent impacts of a temporary shock that could
push an economy onto a permanently different path towards a distinct steady-state. Finally,
our fourth result derives bounds on the aggregate welfare that is attainable across all possible
steady-states, which is useful (given the numerical infeasibility of finding all steady-states in
high-dimensional settings like ours) for distinguishing environments where path dependence
has potentially large efficiency consequences.
    The conditions in these four results all hinge on the strength of agglomeration forces
(spillovers in production and amenities) relative to dispersion forces (agents' preferences for
geographical diversity in trade and migration). Crucially, however, it is contemporaneous
agglomeration spillovers that govern equilibrium uniqueness and the duration of persistence,
whereas it is the sum of contemporaneous and historical spillovers that matters for the
existence of multiple steady-states. This means that there exists a parameter range that
features both well-behaved, unique transition paths as well as rich dynamic phenomena such
as persistence and path dependence.
    We therefore set out in Section 3 to estimate these parameters for the long-run spatial
history of the United States from 1800-2000. Our estimating equations take the familiar
form of a cross-location labor supply and demand system--as in the canonical Rosen-Roback
tradition (Rosen, 1979; Roback, 1982; Glaeser, 2008) but augmented to allow for historical
spillovers and interactions across locations due to costly trade and migration.
    Despite this added empirical flexibility, parameter identification--even with an underly-
ing potential for multiplicity--is still assured via familiar exclusion restrictions of the sort
discussed by Roback (1982), albeit time-varying versions of these restrictions in our case. For
the locational labor supply equation, which is identified from demand-side variation, we use
shifters of agricultural productivity coming from the changing importance of certain crops
over time and the advent of higher intensity cultivation methods. And for the locational
labor demand equation we use shifters of the relevance of temperature extremes over time,
which plausibly have changed the amenity value of certain locations, and hence labor supply,
due to the development of technologies such as heating and air conditioning. Our estimates
imply modest productivity spillovers, but an important role for positive historical spillovers
on amenities--which are, as we show, consistent with models that feature durable locational
investments, for example in housing.
    Based on these parameter estimates we turn in Section 4 to a simulation exercise that
is designed to shed light on the role that history plays in the modern-day U.S. spatial econ-
omy. Amidst the so-called "Technological Revolution" at the dawn of the 20th Century (c.f.
Landes, 2003) it seems plausible that innovations such as electrification and the automobile


                                               2
had differential impacts across space for reasons that could be partially attributed to luck.
For example, Henry Ford was born on a farm near Detroit, and Thomas Edison chose the
1901 Pan-American Exposition to demonstrate mass illumination via his new AC power,
earning the host city of Buffalo its nickname, the "City of Light". Inspired by such anecdotes
of happenstance, our counterfactual exercise asks what would have happened to the trajec-
tories of two similar cities if their 1900 productivity fundamentals were randomly swapped,
while holding all other conditions constant both before and after 1900. In practice, we pair
locations on the basis of their 1900 population--for example, Buffalo (with a population of
436,000 in 1900) is paired with Cincinnati (412,000). In order to derive general lessons from
such counterfactual swaps, we conduct one hundred simulations in which every location has
an equal chance of either drawing its factual 1900 productivity or its counterfactual swap
partner's 1900 productivity.
    Even these relatively modest counterfactual swap histories turn out to have dramatic
consequences. For example, across our simulations the median location has an elasticity
of 0.89 between its population in 2000 and its population in 1900--so that a 10% drop in
population due to an unfavorable but one-off productivity shock leaves the location about
9% smaller even a century later. And while trade and migration opportunities mean that
the welfare of a location's residents is less affected by historical shocks, we find that the
elasticity of realized welfare of adults residing in a location to historical shocks is still 0.21
for the median location. Simulating the economies forward into the future--undoubtedly
a heroic exercise, but one that illustrates the workings of a model like ours--we find that
the long arm of history reaches far into the future, with median population and welfare
elasticities of 0.45 and 0.11, respectively, 500 years out.
    Perhaps even more surprisingly, we find that these temporary historical shocks often
have permanent effects on the spatial distribution and efficiency of the aggregate economy.
That is, not only do our theoretical results imply that path dependence is possible, but
our simulations find that even modest perturbations of history can knock the economy onto
vastly different tracks. We find that the different counterfactual histories converge--though
by no means uniformly--to (at least) three different steady-states, each with a distinct
spatial distribution of economic activity. Moreover, the welfare gap between the steady-
states is substantial: equivalent to a difference in growth rates of 0.25% per year for about
500 years. Simulating the evolution of the factual economy forward, we find that it ends up
closer to the best counterfactual simulated steady-state than to the worst, although this still
implies that long-run welfare in the factual economy could be more than 50% higher if the
arrangement of spatial productivity within matched location pairs in 1900 had been slightly
different. Finally, our analytical upper bound confirms that the steady-states probed by our


                                                3
swap-counterfactuals are close to the most efficient that any history could achieve, but the
lower bound cannot rule out alternative historical conditions that may have been much much
worse.
    These findings shed new light on a number of strands of related work. First, we are
inspired by an empirical literature that documents examples of spatial persistence and path
dependence, or lack thereof, in the aftermath of historical events in a vast array of settings.
Seminal work by Davis and Weinstein (2002, 2008) and Bleakley and Lin (2012, 2015) is
emblematic of such lessons since Bleakley and Lin (2012, 2015) demonstrate long-lived (multi-
century) persistence from long-obsolescent shipping technologies in the U.S. whereas Davis
and Weinstein (2002, 2008) find that World War II bombing left only a relatively transitory
(multi-decade) spatial trace in Japan. Wider examples from the U.S. alone include enduring
impacts of slavery (Nunn, 2008), political boundaries (Dippel, 2014), flooding (Hornbeck
and Naidu, 2014), mining activity (Glaeser, Kerr, and Kerr, 2015), fire damage (Hornbeck
and Keniston, 2017), war destruction (Feigenbaum, Lee, and Mezzanotti, 2018), frontier
exposure (Bazzi, Fiszbein, and Gebresilasse, 2020), and immigration (Sequeira, Nunn, and
Qian, 2020)--among many other factors (see, e.g., Kim and Margo, 2014).1
    Our findings clarify the conditions under which one could expect spatial persistence and
path dependence to arise, which may rationalize the heterogenous effects seen in prior work.
It can also provide a benchmark for the interpretation of studies that find persistent impacts
of a given historical event and then aim to distinguish--a challenge for such work, as Nunn
(2014) discusses--the hypothesis of a change to dynamics of fundamentals from the alterna-
tive that any temporary shock to fundamentals would have left a persistent geographic trace
due to the logic of agglomeration and endogenous spatial lock-in.
    Second, on the theory side, we draw on the insights of a literature that pioneered the
understanding of path-dependent geographic settings. Krugman (1991), Matsuyama (1991),
and Rauch (1993), for example, developed models with two locations and infinitely-lived
agents. As fully elucidated in Herrendorf, Valentinyi, and Waldmann (2000) and Ottaviano
(2001), the dynamics of equilibrium paths in such settings are dauntingly complex even
in small-scale models, let alone in the high-dimensional empirical settings with realistic
   1
     Further afield, just to cover a few examples, Dell (2010) documents persistent negative effects of forced
labor institutions in Peru, Redding, Sturm, and Wolf (2011) uncover evidence for persistence in the location
of airline hubs amidst the division and reunification of Germany, Jedwab and Moradi (2016) find persistent
impacts of colonial railroads throughout most of Africa, Hanlon (2017) illustrates a long-lived spatial imprint
resulting from the interruption of supplies to Britain's cotton textile industry cities during the U.S. Civil
War, Henderson, Squires, Storeygard, and Weil (2018) describe how the differing extent to which physical
geography attributes matter today for early and late developing countries is consistent with long persistence,
Michaels and Rauch (2018) highlight the differing extents of persistence of Roman towns in England and
France, and Dell and Olken (2020) document the enduring industrial development around sites of colonial
investment in Indonesia.


                                                      4
geographies that are necessary for quantitative work. We have therefore endeavored to
extract core lessons from these setups and adapt them to a framework that is amenable to
the type of empirically-grounded quantification that is our goal. The new theoretical results
that we derive regarding speed of convergence, uniqueness of dynamic paths, multiplicity
of steady-states, and bounds on aggregate welfare across steady-states all work towards
that objective. The main cost of this tractability is that we shut down multiplicity arising
from forward-looking behavior, though with the relatively long time periods in our empirical
analysis this restriction may not be especially limiting in practice.
    Finally, we build on a recent body of work on quantitative economic geography mod-
els such as the static environments of Roback (1982), Glaeser (2008), Allen and Arkolakis
(2014), Ahlfeldt, Redding, Sturm, and Wolf (2015)--summarized and synthesized in Redding
and Rossi-Hansberg (2017)--as well as the pioneering dynamic models in Desmet, Nagy, and
Rossi-Hansberg (2018), Caliendo, Dvorkin, and Parro (2019), and Nagy (2020). Our contri-
bution is to extend these tools in order to facilitate the explicit study of geographic persis-
tence and path dependence, to estimate, in the case of 200 years of U.S. economic geography,
elasticities that our extended framework highlights as essential for such a theme, and then
to apply the resulting estimates to counterfactual simulations about the consequentiality of
historical shocks for the location and aggregate efficiency of economic activity in the U.S.
today.


2     A dynamic economic geography framework
In this section we develop a dynamic economic geography framework that is amenable to the
empirical study of geographic path dependence throughout U.S. history. A large set of regions
possess arbitrary, time-varying fundamentals in terms of productivity and amenities. They
interact via costly trade in goods and costly migration. Crucially, production and locational
amenities both potentially involve contemporary and historical non-pecuniary spillovers--the
forces behind both long persistence and path dependence.


2.1    Setup
There are i  {1, ..., N } locations and time is discrete and indexed by t  {0, 1, ....}. Each
individual lives for two periods. In the first period ("childhood"), a given individual is born
where her parent lives and consumes what her parent consumes. At the beginning of the
second period ("adulthood"), she realizes her own preferences and chooses where to live; then,
in her chosen location, she supplies a unit of labor inelastically to produce, she consumes,


                                              5
and she gives birth to a child. Let Lit denote the number of workers (adults) residing in
location i at time t, where the total number of workers N          ¯
                                                         i=1 Lit = L, is normalized to a
constant in each period t.2

2.1.1    Production

Each location i is capable of producing a unique good--the Armington (1969) assumption.
A continuum of firms (indexed by  ) in location i produce this homogeneous good un-
der perfectly competitive conditions with the constant returns-to-scale production function
                                                                                  ´
qit ( ) = Ait lit ( ), where labor lit ( ) is the only production input, and hence lit ( )d = Lit .
The productivity level for the location is given by

                                                 ¯it L1 L2 ,
                                           Ait = A                                                       (1)
                                                      it it-1


where A ¯it is the exogenous (but unrestricted) component of this location's productivity in
year t. Importantly, the two additional components of a location's productivity in equation
(1) depend on the number of workers in that location both in the current period, Lit , and
in the previous period, Lit-1 . We assume that firms take these aggregate labor quantities as
given. Hence the parameter 1 governs the strength of any potential (positive or negative)
contemporaneous agglomeration externalities working through the size of local production.
This is a simple way of capturing Marshallian externalities, external economies of scale,
knowledge transfers, thick market effects in output or input markets, and the like. The
presence of the term L   it is standard in many approaches to modeling spatial economies,
                           1                                                                 3

albeit typically in static models that would combine the effects of Lit and Lit-1 .
     The parameter 2 , on the other hand, governs the strength of potential historical agglom-
eration externalities. This allows for the possibility that two cities with equal fundamentals
A¯it and sizes Lit today might feature different productivity levels Ait today because they
had differing sizes Lit-1 in the past. There are many potential reasons that one might ex-
pect 2 > 0, and we describe two such sets of microfoundations briefly here (with complete
derivations in Appendix B.1).
     Consider first the potential persistence of local knowledge. In particular, we present a
model based on Deneckere and Judd (1992), where firms can incur a fixed cost to develop a
new variety, for which they earn monopolistic profits for a single period. In the subsequent
period, the blueprint for the product becomes common knowledge so that the variety is
produced under perfect competition, and we assume the product becomes obsolete (with
   2
     Our model economy exhibits a form of scale-invariance that means that, for the purposes of our analysis
here, the total number of workers in any time period is irrelevant for the distribution of economic activity.
   3
     For example, see Redding and Rossi-Hansberg (2017).

                                                     6
zero demand for it) two periods after its creation. As in Krugman (1980), the equilibrium
number of new varieties will be proportional to the contemporaneous local population. Given
consumers' love of variety, new varieties act isomorphically to an increase in the productivity
                                                                                               
of the single Armington product, resulting in the precise form of equation (1) with 1  -        1
            -
and 2  1   -1
               , where   is the expenditure share on all new varieties and  > 1 is the elasticity
of substitution across individual varieties.
    Second, consider the potential for durable investments in local productivity. In particular,
we present a model based on Desmet and Rossi-Hansberg (2014), in which firms hire workers
both to produce and to innovate, and where innovation increases each firm's own productivity
contemporaneously and increases all firms' productivity levels in the subsequent period. If
firms earn zero profits in equilibrium due to competitive bidding over a fixed factor (e.g.
land), then, as in Desmet and Rossi-Hansberg (2014), the dynamic problem of the firm
simplifies to a sequence of static profit-maximizing problems. With Cobb-Douglas production
functions, equilibrium productivity can be written as equation (1) with 1  1 -(1 - µ), and
2   1 , where 1 governs the decreasing returns of innovation in productivity,  governs
the decreasing returns of labor in innovation,  is the depreciation of investment, and µ is
the share of labor in the production function.
    Of course, there are surely many sets of microfoundations that could generate the pro-
ductivity spillover features assumed in equation (1). In what follows, we characterize the
properties of the model and estimate the strength of the spillovers without taking a stand
on the particular source of these externalities.

2.1.2   Consumption

An adult and her child consume with the same preferences, with a constant (but irrelevant)
fraction allocated to the child. They have constant elasticity of substitution (CES) prefer-
ences, with elasticity  > 1, across the differentiated goods that each location can produce.
Letting wit denote the equilibrium nominal wage, and letting Pit be the price index (solved
for below), the deterministic component of welfare--that is, welfare up to an idiosyncratic
shock that we introduce below--of any adult residing in location i at time t is given by

                                                    wit
                                         Wit  uit       ,                                    (2)
                                                    Pit

where the component uit refers to a location-specific amenity shifter that is given by

                                             ¯it L
                                       uit = u      1 2
                                                  it Lit-1 .                                 (3)



                                                7
The term u  ¯it allows for flexible exogenous amenity offerings in any location and time pe-
riod. Endogenous amenities work analogously to the production externality terms introduced
above, with the parameters 1 and 2 here capturing the potential for the presence of other
adults in a location to directly affect (either positively or negatively, depending on the sign
of 1 and 2 ) the utility of any given resident. We assume that consumers take these terms
as given, just as they take factor and goods prices as given, when making decisions.
    As is well understood, a natural source of a negative value for 1 in a model such as
this one is the possibility of local congestion forces that are not directly modeled here; for
example, if non-tradable goods (such as housing and land) are in fixed supply locally and
are demanded with fixed expenditure shares then -1 would equal the share of expenditure
spent on such goods. Such effects would work contemporaneously, so they would govern 1 .
    As with 2 , the parameter 2 stands in for phenomena through which the historical pop-
ulation Lit-1 affects the utility of residents in year t directly (that is, other than through
productivity, wages, prices, or current population levels). Again it seems potentially impor-
tant to allow for such effects given the likelihood that previous generations of residents may
leave a durable impact, positive or negative, on their former locations of residence. Positive
impacts could include the construction of infrastructure (e.g. parks, sewers, or housing), and
negative impacts could include environmental damage or resource depletion.
    It is straightforward to construct a model that generates exactly the specification of
equation (3) for amenities. We sketch such a microfoundation here, and again present the
complete set of derivations in Appendix B.2. We consider a model where agents consume
both a tradable good and local housing, and each unit of land is owned by a real estate de-
veloper who bids for the rights to develop the land and then chooses the amount of housing
to construct. To build housing, the developer combines local labor and the (depreciated)
housing stock from the previous period. We assume the bidding process ensures developers
earn zero profits, so as in Desmet and Rossi-Hansberg (2014) the dynamic problem of how
much housing to construct simplifies into a series of static profit maximizing decisions. In
equilibrium, the higher the contemporaneous population, the lower the utility of local res-
idents (as the residents each consume less housing), whereas the higher the population in
the previous period, the higher the utility of local residents (as more workers in the previous
period results in a greater housing stock today). In particular, if production and utility func-
tions are Cobb-Douglas (with µ the share of old housing in production and 1 -  the share of
housing in expenditure) this model will be isomorphic to equation (3), with 1 = -µ 1-    
                                                                                          
                                                                                             <0
              1-
and 2 = µ  > 0, where  is the depreciation rate of the housing stock.
    As with the productivity spillovers, we emphasize that there may be other theoretical
rationales for the amenity spillovers assumed in equation (3). In terms of what follows, there


                                               8
is no need to emphasize any one particular microfoundation.

2.1.3   Trade

Bilateral trade from location i to location j incurs an exogenous iceberg trade cost, ijt  1
(where ijt = 1 corresponds to frictionless trade). Given this, bilateral trade flow expendi-
tures Xijt take on the well-known gravity form given by

                                                        1-
                                     1-        wit              -1
                              Xijt = ijt                      Pjt  wjt Ljt ,                (4)
                                               Ait

where                                                                 1
                                         N                     1-    1-
                                                        wkt
                                Pit                ki                                       (5)
                                         k=1
                                                        Akt

is the CES price index referred to above.
    For the empirical analysis below, it is convenient to write equation (4) as:

                                       -       Yit /Y W   Yjt
                              Xijt =   ijt   ×     1-   × 1- ,                              (6)
                                                Pit      Pjt

where                                                                1
                                                   -1
                                             wit          Yit       1-
                                 Pit                                     ,                  (7)
                                             Ait          YW
Yit  wit Lit , and Y W is total world income (which we normalize to one in what follows). In
the terminology of the gravity trade literature (see e.g. Anderson and Van Wincoop, 2003),
(the inverse of) Pit captures the outward trade market access of location i and (the inverse
of) Pjt captures the inward trade market access of location j .

2.1.4   Migration

Recall from the discussion of timing above that Lit-1 adults reside in location i at time t - 1,
and they have one child each. Those children choose at the beginning of period t--as they
pass into adulthood­­where they want to live as adults in order to maximize their welfare
as adults.
    As described above, adults who reside in a location j enjoy a deterministic component
of utility given by Wjt in equilibrium, which we will refer to as ex-post welfare. Similarly
to the trade costs introduced above, migrating from i to j costs µijt  1 units of utility
(so that frictionless migration is denoted by µijt = 1). This means that the deterministic
                                                                            Wjt
utility enjoyed by a migrant who moves from location i to location j is µijt    . However, we

                                                   9
also allow for idiosyncratic unobserved heterogeneity in how each child will value living in
each location j in adulthood. Letting the vector of such idiosyncratic taste differences (one
for each location) be denoted by , the actual period payoff of a child who receives the draw
 while living in location i at time t - 1 who chooses to move to location j as an adult is:

                                                     Wjt
                                        Wijt ()           j ,                              (8)
                                                     µijt

so the particular shock for location j , denoted by j , simply scales up or down the determin-
                            Wjt
istic component of utility, µijt . Hence, any new adult chooses her location as follows:

                                                           Wjt
                                 max Wijt () = max              j .
                                   j                   j   µijt

    We further assume that  is drawn independently from a Frechet distribution with shape
parameter  (and a set of location parameters that we normalize to one without loss). The
number of children in location i at time t - 1 who choose to move to location j at time t,
Lijt , is then given by:
                                  Lijt = µ-  -          
                                          ijt it Lit-1 Wjt ,                           (9)
                                   1
                    N                
where it            k=1 (Wkt /µikt )   summarizes the appeal of the migration options from
location i. Equation (9) says that there will be greater migration toward destination locations
j with high ex-post welfare Wjt and low bilateral migration costs µijt , and coming from origin
locations i that either have a lot of residents Lit-1 or poor outside options it .
    Finally, for the empirical analysis below, it is convenient to write equation (9) as:

                                                            ¯
                                                 Lit-1 Ljt /L
                                Lijt = µ- 
                                        ijt ×       
                                                      × - ,                               (10)
                                                  it    jt

where                                                       1
                                                           -
                                                     Lit
                                       it  Wit        ¯         .                         (11)
                                                     L
As in the flow of goods above, it captures the outward migration market access from i and
the (inverse of) jt captures the inward migration market access to j . It turns out that both
the outward and inward migration market access terms are closely related to the welfare of
agents, a point we turn to next.




                                                10
2.1.5    Welfare

Following a standard derivation, the expected adulthood period payoff of a child residing in
location i at time t - 1, prior to realizing her idiosyncratic shocks , is equal to the outward
migration access it :
                                         E max Wijt () = it .                                              (12)
                                               j

Similarly, given an appropriate weighting of children whose parents came from different
origins, we can express the period payoff of childhood for the average child residing in location
i at period t - 1 as equal to (the inverse of) the inward migration access:4
                                                                                    1
                                                                                    
                         Ljit-1
                                   E Wjit-1 () |i = arg max Wjit-1 ()                   = it-1 .           (13)
                    j
                         Lit-1                                 j



Assuming agents aggregate payoffs in childhood and adulthood equally in a Cobb-Douglas
fashion, the expected utility of an agent born in location i in period t - 1, i,t , is then simply
the geometric mean of the outward and (inverse) inward migration accesses:

                                           it =       it-1 × it .                                          (14)

As it combines both the realized payoffs of childhood and the expected payoffs of adulthood,
in what follows we refer to it as ex-ante welfare.


2.2     Dynamic Equilibrium
An equilibrium in this dynamic economy is a sequence of values of (finite) prices and
(strictly positive) allocations such that goods and factor markets clear in all periods.5
More formally, for any strictly positive initial population vector {Li0 } and geography vector
  ¯it , u
  A     ¯it , ijt , µijt , an equilibrium is a vector of endogenous variables {Lit , wit , Wit , it } such
that, for all locations i and time periods t, we have:
    4
      To account for the fact that children in i whose parents came from different origins inherit different
expected idiosyncratic preferences, we consider a generalized weighted mean across parents of all possible
origins, where the weights are their population shares in the destination and the generalized mean has the
same power as the distribution of idiosyncratic preferences (so that the aggregation function for the welfare
of agents across origins is the same as the aggregation function used by agents across destinations). We note
that an alternative microfoundation, in which a "stork" allocates children to expectant parents based on the
children's idiosyncratic preferences, would deliver an identical expression.
    5
      Throughout, we confine attention to equilibria where all locations are inhabited, as (1) these are the
empirically relevant types of equilibria at our geographic scale of analysis; and (2) in the presence of produc-
tivity and/or amenity spillovers, from equations (1) and (3), an uninhabited location will (trivially) remain
uninhabited forever.


                                                      11
   1. Total sales are equal to payments to labor: That is, a location's income is equal to the
      value of all locations' purchases from it, or wit Lit = j Xijt . Using equation (4) this
      can be written as

                                        1-( -1)                              ( -1)    1- 
                                 wit Lit              =        Kijt Ljt              Wjt wjt Ljt ,    (15)
                                                          j

                                              1-
                              ijt
       with Kijt       ¯it L2 u       2            defined as a collection of terms that are either exoge-
                       A    it-1 ¯jt Ljt-1
       nous, or predetermined from the perspective of period t.

   2. Trade is balanced: That is, a location's income is fully spent on goods from all locations,
      or wit Lit = j Xjit . Using equation (4) this can be written as

                                  1-          (1- )      -1                           ( -1)    1-
                                 wit Lit1             Wit   =               Kjit Ljt1         wjt .   (16)
                                                                        j


   3. A location's population is equal to the population arriving in that location: That is,
      Lit = j Ljit . From equation (9) this implies

                                                    -
                                              Lit Wit =                µ-  -
                                                                        jit jt Ljt-1 .                (17)
                                                               j


   4. A location's population in the previous period is equal to the number of people exiting
      that location: That is, Lit-1 = j Lijt . From equation (9) this can be written as

                                             Lit-1 =           µ-  -          
                                                                ijt it Lit-1 Wjt ,
                                                          j


       which can then be written more compactly as

                                                    it                 µ-    
                                                                        ijt Wjt .                     (18)
                                                                   j


Summarizing, the dynamic equilibrium can be represented as the system of 4 × N × T
equations (in equations 15-18) in 4 × N × T unknowns, {Lit , wit , Wit , it }.6
   This system of equations (15)-(18) comprises a high-dimensional nonlinear dynamic sys-
   6
    When trade costs are symmetric (as will be assumed below) outward and inward goods market access
Pit and Pit are equal up to scale, allowing equations (15) and (16) to be combined into a single non-linear
equation, reducing the dimensionality of the system to 3 × N × T equations and 3 × N × T unknowns; see
Anderson and Van Wincoop (2003) and Allen and Arkolakis (2014).



                                                              12
tem whose analysis can prove challenging. But this task is facilitated by the fact that the
system is a collection of additive power equations, where each of the endogenous variables
{Lit , wit , Wit , it } appears, on either the left-hand or right-hand side, to a particular fixed
power, with weights in the system given by an exogenous kernel term that comprises vari-
ables that are either exogenous or pre-determined from the perspective of period t (Kijt in
equations 15 and 16, and µ-       
                                ijt in equations 17 and 18). This means that the solution of each
cross-sectional system for t, given values of Kijt and hence solutions from the previous period
t - 1, can be solved using the methods in Allen, Arkolakis, and Li (2020). In this manner, a
dynamic path can be characterized by understanding a sequence of linked dynamic problems.
    Towards this goal, we define the matrix
                                                                           
                                  (1+ + ( -1))-( -1)         ( -1)(+1)
                                    +(1+(1- )- )           +(1+(1- )- )
                  A (,  )                / ~               (1-( -1)- )
                                                                           ,                 (19)
                                    +(1+(1- )- )           +(1+(1- )- )

              -1
where   ~  2  -1
                 . This notation stresses the dependence of A (,  ) on  and  for reasons
that will be made clear below. Given this definition, the following result characterizes a
sufficient condition for existence and uniqueness for environments with symmetric trade
costs (and unrestricted migration costs) and arbitrary positive geographic fundamentals.

Proposition 1. For any initial population {Li0 } and geography {A      ¯it > 0, u
                                                                                ¯it > 0, ijt =
jit , µijt > 0}, there exists an equilibrium. The equilibrium is unique if  (A (1 , 1 ))  1,
where (·) denotes the spectral radius (i.e. the largest eigenvalue in absolute value) operator.

Proof. See Section A.1.

    This sufficient condition for uniqueness will be satisfied whenever 1 and 1 are sufficiently
small. Panel (a) of Figure 1 illustrates this condition for the values of  and  that we use in
our empirical calculations below. At these values, the sufficient condition of  (A (1 , 1 )) 
1 is well approximated by the simple relation of 1 + 1  0--that is, contemporaneous
agglomeration forces must simply be non-positive on net. Finally, we note that this result
concerning uniqueness of the dynamic equilibrium does not depend on the values of 2 and
2 , since the current generation takes Lit-1 as given.
    To provide some intuition for the dynamic system, algebraic manipulations of equations
(15)-(18) when trade costs are symmetric imply that the equilibrium distribution of popula-
tion in any location and time can be written as

                                   ¯it - (2 - 1) ln Pit -  ln it + (2 ( - 1) + 2  ) ln Li,t-1 ,
                   ¯it + ( - 1) ln A
 ln Lit = Ct +  ln u
                                                                                         (20)


                                               13
where   1 +        
                     - (1 ( - 1) + 1  ) and Ct is a constant that ensures the aggregate labor
market clearing condition holds.
     Equation (20) has three implications: first, as long as  > 0 (which corresponds to the
case of our empirical estimates below), a greater density of residents can be found in any
location with high productivity A   ¯it , high amenities u
                                                         ¯it , high inward migration access (low
it ), high access to imported goods (low Pit ), and--if 2 ( - 1) + 2  > 0, so that historical
spillovers are positive--with greater population density in the previous period. Second, the
elasticities of the population to these characteristics are governed by the strength of  , where
greater contemporaneous spillover elasticities 1 and 1 result in larger population responses.
Third, history--i.e. the distribution of the population in the previous period--only affects
the current population through the inward market access terms (it and Pit ) and through
the direct impact on productivities and amenities from the historical spillover elasticities 2
and 2 . Of course, while the first two determinants of population density in equation (20),
A¯it and u¯it , are exogenous in our model, the latter three determinants, it , Pit , and Li,t-1
are endogenous and are determined simultaneously through interactions with the endogenous
features in all other locations. It is the self-reinforcing potential of these interactions, both
over time and across space, that leads to the rich dynamics that we explore below.


2.3    Persistence and Path Dependence
We now turn to a characterization of the dynamic properties of the model, namely the
persistence of shocks to the economy and the possibility of multiple steady-states (i.e. the
potential for path dependence).

Persistence

Consider first the question of persistence: how long does a temporary shock to the economy
                                                                max xi,t /xi,t-1
take to dissipate? To answer this question we define x,t  minii xi,t    /xi,t-1
                                                                                 to be the ratio of
the maximum to minimum change in variable xi,t across all locations. Note that x,t  1
and is equal to one if and only if xi,t  xi,t-1 for all i, i.e. the economy is on a balanced
growth path (or, in our case where aggregate population is fixed, a steady-state). As such, it
provides a convenient economy-wide measure of how far xi,t is from a steady-state. We can
then define the economy-wide persistence of variable xi,t as the effect of x,t-1 on x,t --that
is, how much deviations from the steady-state in period t - 1 affect deviations from the
steady-state in period t. The following proposition bounds the persistence of all endogenous
outcomes in the model in this manner:

                                                                                    ¯i >
Proposition 2. Consider any initial population {Li0 } and time-invariant geography {A

                                                14
   ¯i > 0, ij = ji , µij > 0}. Suppose that  (A (1, , 1 )) < 1 so that from Proposition 1 the
0, u
dynamic equilibrium is unique. Then the following relationship holds:
                                                                             
                     ln L,t                                         ln L,t-1
                                                          -1
                    
                    ln W,t   B
                               -1              ~ (1 , 1 )
                                             I-A             C |B| ln W,t-1  ,
                                                                             
                                                                                                        (21)
                     ln ,t                                          ln ,t-1
                                                                                       
                     A11 (,  ) 0 A12 (,  )              ~ (1 - 1 ( - 1) - 1 )     ~ 0
where A ~ (,  )    A21 (,  ) 0 A22 (,  ), B  
                                                     
                                                                  1               - 0, |B|
                                                                                       

                         0       1      0                         0                0 
indicates the element-wise absolute value of B, and C is a 3-by-3 matrix whose first two
rows are strictly positive (with values that depend on the parameters 1 , 2 , 1 , 2 ,  and ,
as fully defined in Section A.2) and whose third row consists entirely of zeroes.

Proof. See Section A.2.

    Proposition 2 provides an upper bound on how much the endogenous variables Lit , Wit
and it change form period t - 1 to period t that depends on how much they changed
from period t - 2 to period t - 1 (while holding constant the underlying geography in
order to isolate the endogenous evolution of the economy). Loosely speaking, the propo-
sition states that the closer the spillover parametersare to the boundary at which unique-
ness can no longer be guaranteed, the greater the possibility of particularly long persis-
tence. To see this, note that as the spectral radius  (A (1 , 1 )) approaches one from
below, the largest eigenvalue of (I - A (1 , 1 ))-1 --and hence also the largest eigenvalue of
                       -1
|B-1 | I - A~ (1 , 1 )    C |B|--approaches infinity.7 Panel (b) of Figure 1 illustrates this re-
                                                                                        -1
                                                               ~ (1 , 1 )
lationship by showing how the largest eigenvalue of |B-1 | I - A          C |B| increases
as 1 and 1 approach this boundary (holding constant  , , 2 , and 2 at the values we
estimate in Section 3.3 below).

Path dependence

So far we have described the dynamic transition paths of this spatial economy. We now
discuss the steady-state(s) to which these paths may converge. Intuitively, if local agglom-
   7                                                               ~ (,  ), this can be seen from a simple
    Noting that the eigenvalues of A (,  ) are also eigenvalues of A
                                     -1
eigen-decomposition I - A ~ (1 , 1 )    = V V where  is a diagonal matrix whose elements are the
                             1
eigenvalues (including 1-(A(  1 ,1 )) , which approaches infinity as  (A (1 , 1 )) approaches one from below)
and V is a 3 × 3 matrix of the associated eigenvectors. Note that because A (1 , 1 ) is strictly positive and
                                                                     -1
hence  (A (1 , 1 )) > 0, the largest eigenvalue of (I - A (1 , 1 )) always exceeds unity, which indicates
that long-lived persistence can never be ruled out.

                                                     15
eration economies are strong enough then there could be multiple allocations at which the
economy would be in steady-state. Agents who come to reside in a location could find it
optimal, on average, to stay there; and yet the same could simultaneously be true for another
location, thanks to the reinforcing logic of local positive spillovers.
    To evaluate this possibility we consider a version of the above economy but for which
the potentially time-varying fundamentals A       ¯it and {u      ¯it } and trade {ijt } and migration
{µijt } costs are constant over time at the values A       ¯i , u
                                                                ¯i , ij , µij . The steady-states of our
economy will therefore be a set of time-invariant endogenous variables that we denote by
{Li , wi , Wi , i }.8 The following result provides a sufficient condition for existence and unique-
ness of the steady-state of this economy (for arbitrary geographies with symmetric trade and
migration costs). It also shows how this is a maximal domain sufficient condition--the weak-
est condition one could impose whose result would be true for any geographic fundamentals.

Proposition 3. For any time-invariant geography A       ¯i > 0, u
                                                                ¯i > 0, ij = ji , µij = µji , there
exists a steady-state equilibrium and that equilibrium is unique if  (A (1 + 2 , 1 + 2 ))  1.
Moreover, if  (A (1 + 2 , 1 + 2 )) > 1, then there exist many geographies for which there
are multiple steady-states at each geography.

Proof. See Section A.3.

    The condition for uniqueness of the steady-state in Proposition 3 is similar to that for
uniqueness of transition paths in Proposition 1. The only difference is that the latter con-
dition depends on the size of contemporaneous spillovers 1 and 1 , whereas the former
condition depends on the size of total (that is, contemporaneous plus historical) spillovers
1 + 2 and 1 + 2 . This highlights the importance of the A (,  ) matrix defined in equa-
tion (19). The second part of Proposition 3 demonstrates that the sufficient condition for
uniqueness is necessary for certain geographies. Indeed, the proof of this proposition provides
a continuum of example geographies under which multiple steady-states arise.
    Associated with each steady-state is a basin of attraction : a set of values of the initial
population distribution {Li0 } for which the economy will converge to the steady-state in
question. When there are multiple steady-states, and hence multiple basins of attraction,
the eventual steady-state equilibrium of the economy will generically depend on its initial
population distribution. Such a situation offers the potential for path dependence : where
historical events that determine {Li0 } can have permanent effects on the economy's outcomes
since they select the basin of attraction in which populations are distributed at time 0, and
   8
    Note that while population levels at each location Li are constant in steady-state, and hence net migration
flows are zero, gross migration flows are still positive in a steady-state equilibrium due to the churn induced
by the idiosyncratic locational preferences in equation (8).


                                                      16
hence the eventual steady-state that is reached. Since the dynamic equilibria described in
equations (15)-(18) feature a historical dependence on the state variable {Lit } with only
one lag, this means that from the perspective of any date t the "history" of the system (all
exogenous and endogenous outcomes in the past) is fully characterized by {Li,t-1 }. Hence,
observing the phenomenon that some event had a path-dependent impact hinges on whether
the event moved {Li,t-1 } across the boundary from one basin of attraction to another. We
explore this feature in our counterfactual simulations in Section 4.
    Combining Propositions 1 and 3, we see that the historical spillover parameters 2 and 2
play an important role in the study of path-dependent economies. Proposition 1 states that
when the contemporaneous spillover parameters 1 and 1 are low then dynamic equilibrium
paths will be unique. However, Proposition 3 states that when 1 + 2 and 1 + 2 are
high then steady-states are likely to be multiple. In this range of parameters (that is, with
relatively low 1 and 1 and yet relatively high 2 and 2 ) path dependence can occur and
yet be straightforward to study since the complications (for estimation, computation, and
interpretation of counterfactuals) of genuine equilibrium indeterminacy do not arise.

Steady-state welfare bounds

The possibility of multiple steady-states highlighted by Proposition 3 raises the question of
whether one steady-state is superior, in welfare terms, to others that could be reached from
different initial conditions. To describe this possibility requires defining a particular notion
of aggregate welfare. In the steady-state, it turns out that ex-ante welfare i is equalized
across all locations:
                                    i =  i  {1, ..., N } ,

so that  becomes a natural measure of the aggregate efficiency of a particular steady-state
equilibrium.
    Our penultimate proposition provides bounds on the aggregate welfare level  across
all steady-states that can arise for a given geography (with symmetric trade and migration
costs). Such bounds serve two purposes. First, they constrain the possible welfare impacts
of history in the long-run without having to explicitly calculate all possible steady-state
equilibria--a process that is infeasible in real-world settings with many locations and complex
geographies. Second, the bounds provide an insight into how features of the underlying
geography may exacerbate or attenuate the welfare impacts of history.
    These bounds apply when the sum of all spillovers,   1 + 2 + 1 + 2 , is sufficiently
strong to possibly generate multiple steady-states, but not so strong as to result in complete
concentration of economic activity in one location. Under these conditions (which require


                                              17
the stated parameter restrictions), the following proposition provides a relationship between
the geography of the economy and the possible values that the steady-state welfare  can
take.

Proposition 4. Consider any time-invariant geography A     ¯i > 0, u
                                                                   ¯i > 0, ij = ji , µij = µji
                             1     1         (1+(1 +2 ) +(1 +2 )( -1))
and suppose that  > max 0,  - -1 and (1-(1 +2 )(-1)-(1 +2 )) < 1. Then the equilib-
rium welfare values  across all steady-states are bounded by

                                            ¯,
                                            

where the upper bound is given by

                                    1       1
                                                              1
                      ¯
                              c1 × ¯ × ¯ -1 × max A
                                                  ¯i u    ¯ - 
                                                     ¯i × L     × N 1 ,                              (22)
                                    M   T
                                                          i


the lower bound is given by

                                        1       1
                              c2 × M
                                        -1
                                     × T         ¯i u
                                           × min A       ¯  × N -2 ,
                                                    ¯i × L                                           (23)
                                                              i


¯ M and  are the maximal and minimal eigenvalues (in absolute value) of the migration
        M
matrix M  µ-    ¯
           ij , T and T are the maximal and minimal eigenvalues (in absolute value)
                       1-                   1        1            1            1      1-2( -1)
of the trade matrix T  ij , 1               2        -1
                                                          +       
                                                                      +1 <   2( -1)     2( -1)
                                                                                                 > 0, 2 
  + 2(3 -1)
             + 21 > 0, and c1 and c2 are constants (defined in Section A.4) that bound the
variation in ex-post welfare Wi across locations (such that if    and hence Wi is equalized
across all locations, then c1 = c2 = 1).

Proof. See Section A.5.

    As the counterfactual simulations in Section 4 illustrate, when the presence of agglomer-
ation forces results in multiple steady-states, different initial conditions can lead to different
steady-states with different associated levels of aggregate welfare. Proposition 4 elucidates
the scope for such differences by providing upper and lower bounds to all levels of steady-state
welfare that are possible for a given geography.
    The bounds in Proposition 4 also provide an intuitive explanation for how each component
of geography can matter for welfare. The upper bound is the product of six terms: (i) the
largest eigenvalue of the migration costs matrix (scaled by the migration elasticity), which
generally rises as migration costs fall; (ii) an analogous term for the trade costs matrix (scaled
by the trade elasticity); (iii) the innate productivity and amenity of the best location; (iv)
the total labor endowment, scaled by the strength of net agglomerative forces ( > 0) and

                                                    18
tempered by diminished utility from people concentrating in locations for which they may
not have an idiosyncratic preference; (v) the total number of locations (scaled by locational
differentiation via trade and migration); and (vi) a term capturing the variation across
locations in Wi , which is included for technical reasons that--loosely speaking--arise because,
ceteris paribus, individuals migrate to destinations with higher ex-post welfare but purchase
goods from destinations with lower ex-post welfare.
    The lower bound includes similar terms to the upper bound but with the logic inverted:
the eigenvalues are now the smallest (in absolute value) of the trade and migration matrix,
the measure of the overall quality of the innate productivities and amenities places are those
of the worst location, and the number of locations is now scaled negatively by the strength
of the agglomerative forces.
    Proposition 4 characterizes how geography can shape the extent to which history matters
for welfare in the long-run. To see this, define     ^ P D as the ratio of the best to the worst
possible steady-state welfare, holding geography fixed. Proposition 4 immediately implies

                                         1            1             ¯i u
                                                               maxi A  ¯i ¯ - 1
                   ^PD  c
                                  (M)  ×  (T) -1 ×                        × L  × N 1 +2 ,                    (24)
                                                                    ¯
                                                               mini Ai u
                                                                       ¯i

where  (A) is the condition number of matrix A. Recall that the condition number of a
matrix measures how sensitive the solution to the linear equation Ax = b is to approximation
(where  (A) = 1 only if A is a scalar multiple of a linear isometry and  (A) =  only if A
is singular). Loosely speaking, equation (24) says that the welfare cost of history is bounded
above by the sensitivity of the matrices of migration and trade costs.
    Finally, we note that the upper and lower bounds provided here may not necessarily be
tight for a given geography. This is clear from the nature of equation (24), which serves to
decompose the sources of welfare variation across multiple steady-states into separate terms
for each component of geography (i.e. trade costs, migration costs, local productivities and
amenities, aggregate labor endowments, and the number of locations). Steady-state welfare
levels are driven by the combination of each of these forces, and so no attempt to divide
them up into separate contributions, as in equation (24), could ever provide tight bounds in
general.9 Whether the bounds are quantitatively useful will of course depend on the context;
fortunately, we will see below that they are informative in our empirical setting.
   9
     As an example, consider the case where migration is costless, i.e. µij = 1 for all i and j . In this case, the
steady-state of the model corresponds to the equilibrium of a large class of (static) spatial models, including,
for example, Helpman (1998), Allen and Arkolakis (2014), and Redding (2016). In this case, however, the
                          1
condition number  (M)  is infinite, as the migration cost matrix is singular. However, it can be shown
using a similar (but simpler) argument following the proof of Proposition 4 that in this case, the bounds of
Proposition 4 still hold by excluding ¯ M and  from the bound expressions.
                                               M



                                                          19
2.4     An example
To see the implications of Propositions 2, 3, and 4 more concretely, consider a simple economy
of three locations. Suppose, to begin, that these locations have identical and time-invariant
fundamentals A    ¯it , u
                        ¯it , ijt , µijt , and trade and migration costs are symmetric across loca-
      10
tions. Figure 2 shows phase diagrams on the two-dimensional space of Lit shares in this
economy. The blue rays indicate one period of movement (so a ray's length shows speed of
adjustment) in the direction towards each red dot and yellow stars denote steady-states.
    We begin by illustrating how historical persistence is shaped by model parameters in panel
(a). The left diagram shows the phase diagram with strong congestion forces (1 = -0.25)
so that the economy is far from the boundary of non-uniqueness. The right diagram, in
contrast, shows an economy with weak congestion forces (1 = 0), moving the economy
closer to the boundary of non-uniqueness. As evinced by the shorter arrows, moving closer
to the boundary of non-unique dynamics increases persistence--all dynamics of adjustment
toward the unique steady-state will be slower--consistent with Proposition 2.
    Panel (b) demonstrates how increasing the historical agglomeration forces creates the
possibility of path dependence (consistent with Proposition 3). In the left diagram (which is
identical to the right diagram of panel (a)), there are no historical agglomeration spillovers
(2 = 0), and the economy converges everywhere to the unique steady-state with equal
population in all locations. In the right diagram, we increase the strength of historical
agglomeration forces (2 = 0.25), resulting in a dramatic change in the qualitative dynamic
patterns. While the symmetric allocation remains a steady-state, it is no longer stable, and
now there are three stable steady-states with relatively concentrated population shares near
the corners of the simplex.11 Also apparent are the three basins of attraction around these
stable steady-states.
    We turn next to the welfare consequences of path dependence, using panel (c) to illustrate.
In the left diagram (which is identical to the right diagram of panel (b)), all locations have
identical innate productivities and amenities; as a result, each of the three stable steady-
states delivers the same level of aggregate welfare . The right diagram introduces asymmetry
in local geography by endowing location 1 with a slightly higher innate amenity (¯      u1 = 1.01,
u
¯2 = u¯3 = 1). Consistent with Proposition 3, there remain multiple steady-states but now
aggregate welfare is higher in the steady-state that achieves concentration in location 1. This
is consistent with Proposition 4, which states that the upper bound on the welfare differences
  10
     Throughout all economies in Figure 2, we set  = 9,  = 4, 1 = 2 = 0, A      ¯i = 1 for all i, and µij = 1.6
for all i = j and µii = 1.
  11
     In addition to the unstable steady-state in the center, there are three additional unstable steady-states
with equal concentration in two of the three locations (and almost no population in the third).



                                                      20
across steady-states is increasing in the ratio of the product of innate productivities and
amenities across the best and worst locations. In this example the economy could start
with a bad set of initial conditions and end up in a dominated steady-state. Reassuringly,
however, the basin of attraction of the relatively good steady-state is larger than that of the
dominated ones. So, in the space of all possible initial conditions, good steady-states are
more likely to arise.
    Finally, in panel (d) of Figure 2 we illustrate how the welfare consequences of path
dependence change with global geography (i.e. economy-wide trade and migration costs). In
the left diagram (which is identical to the right diagram of panel (c)), trade costs between
locations are high ( = 1.1). In the right panel, we lower bilateral trade costs ( = 1.08).
While reducing trade costs increases the aggregate welfare of the economy in all steady-
states, it does so disproportionately more for the "good" steady-state where all individuals
concentrate in location 1 than the steady-states with concentration in location 2 or 3. This
means that the welfare consequences of path dependence have increased. Since falling trade
costs are associated with an increase in the condition number of the trade cost matrix  (T),
this is consistent with the predictions of Proposition 4.


3     Identification and Estimation
We now describe a procedure for mapping the above model into observable features of the
U.S. economy throughout the past two centuries. The goal is to estimate the elasticity
parameters (1 , 1 , 2 , 2 ,  and ) and geographic fundamentals A          ¯it , u
                                                                                ¯it , ijt , µijt that
are critical for assessing the strength of persistence and likelihood of path dependence.


3.1    Data
Our quantification requires data on population Lit and per-capita nominal incomes wit . We
therefore build a dataset drawing on Manson, Schroeder, Van Riper, Ruggles, et al. (2017)
that tracks these two variables for subnational regions i of the coterminous U.S. for as long
a history as possible.
    Starting with Lit , we obtain this series from decennial Census records of county-level
population (by age group) from 1800 onward. To distinguish between children and adults
in the model, we consider persons aged 25-74 as adults and work with 50-year steps (1800,
1850, 1900, 1950 and 2000) in order to avoid overlaps of these cohorts. Turning to wit , for
the years 1850-1950 we proxy for the relative amount of total income in any location, wit Lit ,
by the estimated value of county-level agricultural and manufacturing output; for 2000 we


                                                 21
use the per-capita income reported in the Census.12 As a result, we have proxies for Lit and
wit from 1850-2000 and for Lit in 1800 as well; this allows estimation to proceed from 1850
onwards.13
    To account for county border changes over the years we work with the set of (the largest
possible) sub-county regions, each denoted by i, that can be mapped uniquely to every county
in our five years of data.14 In the end, our sample consists of 4,975 such sub-county regions
i, which we refer to as "locations" from now on.
    Three other variables--proxies for migration flows, trade flows and productivities and
amenities--play an auxiliary role in our model estimation and are described further below.


3.2     Identification and Estimation
We now describe a three-step procedure that estimates the unknown parameters of the model
in Section 2. In a nutshell, the third step involves estimating a system of locational labor
supply and demand equations that represent an augmented version of the spatial equilibrium
model due to Rosen and Roback (Rosen, 1979; Roback, 1982); the first and second steps
simply prepare the ingredients necessary to proceed in this standard tradition.
    The goal of the first step is to determine the level of the trade and migration cost terms,
raised to their respective elasticity exponents, that enter the equilibrium system of equa-
                                                     1-
tions (15)-(18), objects that we define as Tijt  ijt      and Mijt  µ-     15
                                                                        ijt . We do this using
the available data on intranational trade Xijt and migration Lijt in our context: the 1997
Commodity Flow Survey (CFS), which measures trade flows; and Census data from 1850
onwards documenting the state of birth of each respondent (aged 25-74), which corresponds
to the timing of migration in our model.16 We then project these trade and migration cost
terms onto bilateral distance (denoted distij ), in logs, as ln Tijt =  ln distij , for all t, and
  12
      In practice, manufacturing output is not available for 1950 so we use the 1940 value of agricultural and
manufacturing output. Per-capita income is not readily available prior to 1980.
  13
      Appendix Figures C.1 and C.2 present maps of Lit and wit in all years.
  14
      For example, suppose that county "A" in 1900 splits into "A1" and "A2" by 1950, and then "A2" splits
into "A2(i)" and "A2(ii)" by 2000. The resulting sub-county regions that we track throughout would be "A1",
"A2(i)" and "A2(ii)". We then apportion the county-level information into each of the sub-country regions
on the basis of land area shares (and cluster regression standard errors at the county-year level).
  15
      We note that only bilateral-specific elements of such terms matter in this system because origin- or
destination-specific components would be redundant conditional on the unrestricted components Ait and
uit . We therefore normalize any origin-time and destination-time components of Tijt and Mijt to one.
  16
      We aggregate both trade and migration flows to the state-to-state level, as this is the greatest level
of disaggregation possible that is consistent between the two datasets. This aggregation introduces the
measurement errors ijt and ijt in equations (25) and (26), which we assume are uncorrelated with distance.
We note that Monte, Redding, and Rossi-Hansberg (2018) find the aggregation bias from applying gravity
regressions on the CFS data (at the CFS area level) to county level data to be small.




                                                     22
ln Mijt = t ln distij .17 Substituting these expressions into the gravity equations for trade
and migration flows, equations (6) and (10) respectively, we obtain

                                  ln Xijt =  ln distij + it + jt + ijt ,                                  (25)

                                 ln Lijt = t ln distij + it + jt + ijt ,                                  (26)

where the terms it , jt , it , and jt represent fixed effects.
   Turning to our second step, we treat Tijt = (distij ) and Mijt = (distij )t as known from
step one. Then, re-writing the equilibrium system of equations (15)-(18) using equations (6)
and (10) yields, for all i:

                                    1-                           1-     -1
                                   Pit =           Tijt × Yjt × Pjt          ,                            (27)
                                               j
                                     1-                          1-     -1
                                   Pit  =          Tjit × Yjt × Pjt          ,                            (28)
                                               j
                                      -1                                  -1
                                 it        =       Mjit × Ljt-1 × jt             ,                        (29)
                                               j

                                      it =         Mijt × Ljt × jt .                                      (30)
                                               j


The following proposition shows that the four remaining unknown variables--comprising the
inward and outward trade and migration market access terms--in equations (15)-(18) are
identified (to scale), when raised to the exponents  - 1 or , because this system of equations
has a unique solution given data on Yit , Lit and estimates of Tijt and Mijt from step one.

Proposition 5. Given observed data on {Yit , Lit , Lit-1 } and given values of                    Tijt , Mijt
                                                              -1      -1
there exists a unique (up to scale) set of values of        Pit  , Pit   ,      
                                                                           it , it   that satisfy equations
(27)-(30).

Proof. See Section A.5.

    Finally, we turn to the third step of our estimation procedure. Substituting the produc-
tivity spillover function from equation (1) into the outward trade market access Pit from
equation (7) and imposing Yit = wit Lit , we obtain the following (inverse) demand equation
  17
     This assumes (due to the fact that the CFS is only available in recent years) that  is constant over time,
as is broadly consistent with the patterns in international trade data surveyed by Disdier and Head (2008).




                                                      23
for labor in location i:

                    -1         1              -1                   1     1-   -1
  ln wit = 1               -     ln Lit + 2          ln Lit-1 +      ln Pit +    ln Ait .
                                                                  1-          
                                                                                     (31)

    In this expression, the inverse elasticity of labor demand combines the inverse elasticity of
                                        1
demand for goods from a location, -       , with the contemporaneous productivity spillovers 1 ;
                                     -1
this latter effect is moderated by  because the location faces a downward-sloping demand
curve for its output. Notably, with strong positive spillovers the labor demand curve can
be upward-sloping. Also present in the demand equation are a set of shifters: (i) lagged
population Lit-1 , which raises productivity if there are historical productivity externalities
(i.e. 2 > 0); (ii) the outward trade market access Pit , which allows for the labor demand
in location i to be high if its ability to sell goods to other locations is high; and (iii) the
exogenous (and unobserved) component of productivity, Ait . An important feature of this
estimating equation is that it describes a cross-sectional relationship that holds within any
equilibrium, so it can be used for valid point estimation even if the model's parameters lie
in a region for which multiplicity is possible.
    Similarly, substituting the amenity spillover function from equation (3) into the inward
migration market access it from equation (11) and using Wit  w         it
                                                                          u , we obtain the fol-
                                                                      Pit it
lowing (inverse) supply equation for labor in location i:

                    1                              1         1      1-
         ln wit =     - 1 ln Lit + (-2 ) ln Lit-1 + ln it +    ln Pit  - ln uit .           (32)
                                                            1-
The inverse elasticity of labor supply combines the locational utility heterogeneity dispersion
 with the contemporaneous productivity spillovers 1 ; analogously to the demand case, the
elasticity of labor supply can be negative if such spillovers are positive and large. Shifters of
the inverse labor supply curve comprise: (i) lagged population in the location Lit-1 , which
matters to the extent that historical amenity externalities (i.e. 2 = 0) exist; (ii) the con-
sumer cost-of-living Pit , which increases the nominal wage wit that is required for a given
amount of mobile workers to be willing to live in location i; (iii) the inbound supply of po-
tential migrants from other nearby locations as captured by it ; and (iv) the exogenous (and
unobserved) component of location i s amenity, uit . Again, this equation allows parameter
estimation to proceed even though equilibria may be multiple.
    The locational demand-supply system in equations (31) and (32) generalizes that in the
Rosen-Roback framework (c.f. Glaeser and Gottlieb 2009; Kline and Moretti 2014; Hsieh
and Moretti 2019) in two senses. First, it relaxes the assumption that locations produce a
homogenous and freely traded product (i.e. that  is infinite and ijt = 1). Second, it relaxes

                                               24
the assumption that all workers have identical preferences across locations and face no costs
of migrating (i.e. that  is infinite, and µijt = 1). This added flexibility necessitates the
                                          1-     1-
inclusion of the market access terms Pit     , Pit  and    it as demand and supply shifters, as
recovered in step two.
    As with any demand-supply system, OLS estimates of the parameters in equations (31)
and (32) would typically suffer from simultaneity bias. We therefore use an instrumental
variable (IV) procedure that exploits the model's feature that exogenous shifters of amenities
(components of uit ) would be valid instruments for estimating the demand equation (31)
and exogenous shifters of productivities (components of Ait ) would be valid instruments for
estimating the supply equation (32) as long as those shifters are orthogonal to each other. In
practice, we include location and region-year fixed effects in these IV specifications so that
valid instruments for the case of the demand equation (31) are those that capture changes in
amenities over time (within region) but do not relate to changes in the exogenous component
of productivity.18 Analogously, the supply equation (32) requires instruments derived from
changes in productivity that are uncorrelated with changes in amenities. Given the 50-
year time intervals that we use for estimation, these instruments must derive from relatively
long-run changes to the U.S. economy.
    For the demand equation, we follow Barreca, Clay, Deschenes, Greenstone, and Shapiro
(2016) who note that technological advances like air conditioning and more effective heating
systems have made extreme hot or cold climates more bearable (delivering greater amenity
value) throughout our sample period. Accordingly, our IVs consist of a linear time trend
interacted with the average maximum temperature in the warmest month and the average
minimum temperature in the coldest month (and their squared values to allow for nonlin-
earities) in each location. We obtain such data from WorldClim.org.
    For the labor supply equation instruments, we leverage two major changes in U.S. agri-
culture over the past 200 years. The first is the increased use of more intensive cultivation
practices (e.g. mechanization, fertilizer, genetic modification of seeds, etc), which raised land
productivity. Following Bustos, Caprettini, and Ponticelli (2016), we measure the extent to
which locations could take advantage of this higher-intensity cultivation as the differential
potential yield under low and high intensity cultivation, according to the FAO-GAEZ agro-
climatic model of crop suitability (Fischer, Nachtergaele, Prieler, Van Velthuizen, Verelst,
and Wiberg, 2008). Our first IV interacts this differential yield for corn, the dominant crop
throughout our period, with a linear time trend.19
  18
     To construct regions, we draw a box around the continental U.S. (in the Mercator projection) and,
beginning from the southwest corner of the box, we overlay squares on top of the box, each of which has an
area equal to one tenth of the area of the box. This partitions the continental U.S. into 14 different regions.
  19
     To allow for within-location heterogeneity in agroclimatic suitability, we include both the mean differ-


                                                      25
    The second major change that we exploit is a shift in world demand that has altered
which crops are grown in the U.S., most notably soy.20 To proxy for which locations saw
the greatest gain in (revenue) productivity from this shift, we use the FAO-GAEZ predicted
difference in potential yield between soy and wheat (a crop for which demand has remained
relatively constant over time) and interact this with a linear time trend.21 Together, these
two sets of supply-equation instruments leverage heterogeneity in geographical exposure to
both within-crop and across-crop changes among the three most important food crops for
U.S. agriculture.
    Finally, when estimating the demand equation (31) we use the climate amenity-based
IVs, but additionally control for the agricultural productivity variables (in order to reduce
residual variation and the risk that our amenity-based IVs are correlated with unobserved
productivity variation). Analogously, our estimation of the supply equation (32) includes
controls for the climate amenity variables.
    To conclude the three-step procedure we note that, conditional on obtaining consistent
estimates of the elasticity parameters (1 , 1 , 2 , 2 ,  and ), equations (31) and (32)
allow recovery of the geographic fundamentals A     ¯it , u
                                                          ¯it as well. Combined with the earlier
estimates of {Tijt , Mijt } from step two all model parameters are thereby identified.


3.3     Estimation Results
We begin with estimates from the trade and migration gravity equations in step one, as
reported in Table 1. As is standard, our estimate of the elasticity of trade flows with respect
to distance, in column 1, is close to minus one: in particular, we obtain  = -1.35 (with
a standard error of 0.06 based on two-way clustering on origin and destination location).22
Table 1 also reports estimates of the migration-distance elasticity for each year 1850-2000 in
columns 2 through 5. The estimates t range from -1.51 to -2.16, with no clear trend over
the 150 years spanned.23
ential yield for corn and the standard deviation of the differential yield as instruments.
   20
      Virtually absent in 1900, soy trailed only corn in terms of both value and acreage in 2000. Roth (2018),
for example, argues that much of this rise is due to rising demand for U.S. exports of soy to Asia.
   21
      In 1909, wheat was cultivated on 14.7% of harvested acres allocated to principal crops; in 2000, the
figure was 17.2%; see USDA (2003). In practice, we use the high- and low-intensity scenarios for soy and
wheat, respectively, to reflect the fact that the former was grown predominantly in a more technologically
advanced era. As with the first labor supply instrument, we include both the mean soy-wheat differences
and the standard deviation of the differences as instruments.
   22
      In comparison, Hillberry and Hummels (2008) estimate a distance elasticity equal to -1.31 at a distance
of one mile and -0.91 at the mean distance of 523 miles; Dingel (2017) estimates an elasticity of -0.95.
   23
      Allen and Arkolakis (2018) calculate the migration distance elasticity for the U.S. for all decennial
censuses from 1850-2000 and find a similar similar range (-1.3 to -2.3). Estimated within-country migration
distance elasticities are of similar magnitudes in other contexts--for example, -0.7 in Indonesia (Bryan and
Morten, 2019) and -1.5 in India (Imbert and Papp, 2020).


                                                     26
    Turning to step three, the parameter values implied by our 2SLS estimates of the la-
bor demand equation (31) are reported in Table 2.24 Column 1 begins with a version that
estimates all three parameters (1 , 2 and  ) of this equation. It is apparent that these pa-
rameters are imprecisely estimated in this specification--the 95% confidence intervals for all
three parameters span a wide range of implausible values, such as a negative value for  and
an unreasonably large agglomeration elasticity 1 . It is unsurprising that these estimates
                                                                     1-
suffer from severe multicollinearity given that the regressor ln Pit    is a spatial aggregation
with (distance-based) weights that are smooth over space. We therefore, in columns 2 and
3, estimate equation (31) after imposing values of  = 5 and  = 9 that reflect typical
estimates of the trade elasticity (equal to  - 1 here).25 The resulting estimates of 1 and 2
are now considerably more precisely estimated, displaying substantial contemporaneous ag-
glomeration spillovers of magnitudes similar to those previously estimated, and more modest
historical spillovers.26 In column 3 (with  = 9), we estimate 1 = 0.11 (SE = 0.034) and
2 = 0.04 (SE = 0.030), and treat this as our preferred set of estimates in what follows.27
    Table 3 displays analogous 2SLS estimates of the parameters in the locational labor
supply equation (32), beginning with all four parameters (1 , 2 ,  and  ) in column 1. For
reasons that are similar to the case of Table 2 described above--though now exacerbated due
                                                                1-
to the presence of two market access terms, ln      it and ln Pit  --these estimates also suffer
from multicollinearity and hence lack precision. The remaining columns therefore focus on
obtaining estimates of 1 and 2 under assumed values for  and  that relate to prior work;
in particular, we consider the four combinations obtained from the same two values of  as
in Table 2 and the values  = 2 and  = 4.28 Regardless of the assumed values, we estimate
  24
     In Tables 2 and 3, the reported standard errors are two-way clustered at the location level and at the
county-year level. First-stage estimates are presented in Appendix Table C.1 and Appendix Figure C.3 maps
the spatial patterns of the predicted change in population from the first-stage regressions.
  25
     For example, Eaton and Kortum (2002) estimate a trade elasticity using international trade flows between
3.60 and 12.86 (with a preferred estimate of 8.28) depending on the method, and Simonovska and Waugh
(2014) estimate this elasticity to be 4. Donaldson and Hornbeck (2016) estimate a trade elasticity of 8.22
when focusing on intranational trade in the U.S. during the late 19th century. Given the similar setting, we
therefore use  = 9 as our preferred estimate in what follows.
  26
     In reviews of the literature, Rosenthal and Strange (2004) and Combes and Gobillon (2015) conclude
that contemporaneous agglomeration elasticities at the city level are likely between 0.03 and 0.08. Roca
and Puga (2017) find the combined effect of the immediate productivity gains and the subsequent seven
years of experience from moving to a city to imply an agglomeration effect of 0.05. Closer to our setting,
by studying how U.S. counties responded to the Tennessee Valley Authority investments, Kline and Moretti
(2014) estimate a contemporaneous (but manufacturing sector) agglomeration elasticity of 0.2. And Bleakley
and Lin (2012) estimate a long-run agglomeration elasticity (i.e. 1 + 2 ) of 0.09 in their study of persistent
clustering around portage sites in the U.S..
  27
     As reported in Table 2, the minimal first-stage Sanderson and Windmeijer (2016) F-statistic (taken
across the two first-stage equations) in this regression is 75.9, indicating that finite-sample 2SLS bias is
unlikely.
  28
     The closest estimate to the fifty-year bilateral migration elasticity in our model of which we are aware



                                                     27
large positive historical amenity spillovers 2 consistent with the microfoundations discussed
in Section 2.1 where previous durable investments in housing (or other amenity features
such as public spaces) increase the amenity value of residing in a location. In contrast, we
find that contemporaneous amenity spillovers 1 are smaller and sometimes negative, albeit
imprecisely estimated. In our preferred specification, with  = 9 and  = 4, we estimate
1 = -0.15 (SE = 0.279) and 2 = 0.33 (SE = 0.179).29
    What do these estimated spillovers imply for the degree of persistence and the possibility
of path dependence? To answer this, Figure 3 takes our preferred estimates from Tables 2
and 3 and illustrates their position (and their 95% confidence intervals) in the context of the
parameter thresholds identified in Propositions 1, 2, and 3. The red star indicates the location
of the contemporaneous spillover estimates, 1 and 1 . From Proposition 1, its location in
the yellow region indicates that the dynamic path of the economy is unique--i.e. given any
initial distribution of population {Li0 } and known evolution of geography {ijt , µijt , Ait , uit },
we can uniquely determine (and straightforwardly calculate) the evolution of the economy.
However, from Proposition 2, the red star's location near the boundary of uniqueness and
non-uniqueness suggests the possibility of very persistent historical shocks. Finally, the green
star indicates the location of the estimated combination of contemporaneous and historical
spillovers, 1 + 2 and 1 + 2 . From Proposition 3, its location in the blue non-unique region
suggests the possibility of multiple steady-states of the economy and hence the possibility of
path dependence.


4     Does History Matter for the U.S. Spatial Economy?
We have just seen in Figure 3 how the model from Section 2, estimated on U.S. data from
1800-2000 as in Section 3, features unique equilibria, but nevertheless the distinct possibility
of both long-lived persistence and genuine path dependence. In this section we proceed to
quantify the extent of these phenomena using a decomposition (Section 4.1), a simulation of
counterfactual histories (Section 4.2), and an analysis of welfare bounds (Section 4.3).
is due to Monte, Redding, and Rossi-Hansberg (2018), who estimate a location choice elasticity across U.S.
counties of 3.30, albeit in a static framework abstracting from bilateral migration costs. We therefore choose
the higher value,  = 4, as our preferred estimate in what follows, but also examine the lower value of  = 2
in order to approach shorter-horizon estimates (such as that from Caliendo, Dvorkin, and Parro (2019) on
U.S. states, with an implied annual elasticity of 0.5).
   29
      As reported in Table 2, the minimal (across equations) first-stage Sanderson-Windmeijer F-statistic in
this regression is 7.4, indicating the potential for finite-sample 2SLS bias. However, the estimates of 1 and
2 based on LIML are both larger in absolute value and lie in the same regions of the parameter space shown
in Figure 3 as our preferred estimates.




                                                     28
4.1       How much can history explain U.S. economic geography?
We begin with a model-based decomposition that can be used to quantify the extent to which
spatial inequalities across the U.S. exist because of unequal historical conditions. The model
identity in equation (20) implies that, for any year T , we can write

                                           T                                 T
                                      1            -s            ¯-1     1           -s         1-2
         ln LiT = C +    T
                         0   ln Li0 +            T
                                                 1      ln   ¯
                                                             uis Ais   +           T
                                                                                   1    ln is Pis   ,          (33)
                                          s=1
                                                                             s=1
                           history
                                              path of fundamentals               path of market access


where, as before,   1 +         
                                  - (1 ( - 1) + 1  ), and now 1  2 ( - 1) + 2  and
0  1 / .
    This expression allows us to decompose the variation in year-T population levels across
locations i into contributions deriving from three terms involving variation in: (i) exogenous
historical conditions Li0 at any "initial" date (i.e. t = 0) in the past; (ii) paths of exogenous
productivities A ¯it and amenities u¯it in these locations; and (iii) paths of endogenous market
access for trade Pit and migration it . While it is clear that term (i) reflects "history" and
term (ii) reflects geography "fundamentals", term (iii) involves a combination of history and
fundamentals that does not linearly decompose further. We therefore view term (i) as a
lower bound on the role of history in this decomposition.
    Panel (a) of Figure 4 presents the results of this exercise. We set T to be the year 2000
and consider initial years t = 0 ranging from 1800-1950. In each case we report the variance
(across the N locations) of each of the three terms in equation (33) divided by the variance
of ln LiT . History plays a large role. For example, historical conditions in 1800 account for at
least 32.6% of the variation in (log) population in 2000, rising to 56.6% in 1850 and 63.9% in
1900. To put these magnitudes in context, we note that equation (33) is the (T - 1)-period
iterated version of an AR(1) process with parameter 0 , augmented by the spatial interactions
arising in the market access term. Our parameter estimates imply that 0 = 0.90, which
is indicative of slow convergence purely because of the logic of agglomeration (since 0 is a
function of the spillover elasticities and the trade and migration elasticities, not migration
costs).
    We repeat this calculation using an analogous expression for ex-post welfare Wit in Panel
(b) of Figure 4.30 While history matters for the distribution of welfare, it matters much
 30
      An analagous derivation to equation (33) relying on equation (11) yields the following expression:
                                          T                                          T
                         T
                         0          1             -s        ¯-1 + ln iT -        1           -s        1-2
          ln WiT = C -     ln Li0 -             T
                                                1       ¯
                                                     ln uis Ais                            T
                                                                                           1    ln is Pis  .
                                          s=1
                                                                                     s=1
                          history
                                          path of fundamentals                   path of market access



                                                             29
less than it does for the distribution of population: the lower bound on the extent to which
historical conditions in 1800 account for variation in (log) ex-post welfare in 2000 is 4.0%,
though this rises to 26.5% and 54.7% in the case of the more recent historical conditions in
1850 and 1900, respectively. That history seems to matter more for the distribution of where
people live than for their welfare--a consistent theme of our analysis in this section--suggests
that historical differences in welfare are partially arbitraged away both contemporaneously
through the movement of goods and over time by the movement of people.


4.2     Persistence in the U.S. spatial economy
The results in Section 4.1 suggest that unequal historical conditions play a large role in ac-
counting for spatial inequalities in the U.S. economy today. But a decomposition exercise like
this one is unable to answer questions about the causal impact of historical conditions--how
different would the spatial economy look today if historical conditions had been different?
    To answer this question, we need to compare actual historical conditions to counterfactual
alternatives. One could imagine many counterfactual histories of interest, but we seek partic-
ular inspiration from the vagaries of industrial success that struck America's communities at
the turn of the 20th century. This period--known variously as the Technological Revolution
or the Second Industrial Revolution--was a period of rapid productivity growth across a
number of different industries due to wide-spread adoption of technological innovations such
as the internal combustion engine and electrification.31
    Crucially for us, the adoption of these innovations varied across locations within the
United States, often for reasons that (in hindsight) can be partially attributed to historical
"luck". For example, Detroit's rise as the "Motor City" plausibly owes something to the fact
that Henry Ford happened to be born on a nearby farm. Or perhaps Buffalo became the
"City of Light", in more than just a name, because it was chosen to host the Pan-American
Exposition at a time (1901) when Thomas Edison desired to show off his newly invented AC
power by adorning Buffalo's Exposition buildings with light bulbs.32
    Examples like these illustrate how relatively similar locations may (or may not) have been
the fortunate recipients of positive productivity shocks in a time of technological change. To
study the consequence of such hypotheticals, we generate a set of counterfactual histories in
which productivity fundamentals are randomly swapped between pairs of similar locations.
Note that a similar decomposition is not possible for ex-ante welfare i,t , as from equation (14) it can be
written solely as a function of inward and outward market access.
  31
     See e.g. Landes (2003).
  32
     Unfortunately, the Exposition's interiors were less well-lit. To illuminate the operating table used (un-
successfully) to remove a bullet from President McKinley, who was shot at the event, the doctor had to rely
on a mirror to reflect the rays of the setting sun (Leech, 1959, p. 596). He died of gangrene a week later.


                                                     30
For example, what if Cincinnati (with a population of 330,000 in 1900) had been chosen
instead of Buffalo (population 350,000 in 1900) for the site of the Pan-American Exposition?
     To operationalize this idea, albeit in an abstract manner, we carry out a set of simula-
tions, each indexed by b, as follows. First, we rank all locations in terms of their observed
Li,1900 . Second, we form pairs p of locations based on their nearest neighbor in this ranked
distribution, starting at the top; for example, Erie County, NY (home to Buffalo) and Hamil-
ton County, OH (home to Cincinnati) occupy ranks 11 and 12 in the distribution.33 Third,
                                                                                  (b)
in simulation b we draw (independently) for each pair p random variable Wp that is dis-
                                     (b)
tributed Bernoulli(1/2). When Wp = 1, we swap the values of the fundamental productivity
                                                                      (b)
in 1900 Ai,1900 among the two locations within pair p; and when Wp = 0 we leave the pair
unchanged. Fourth, we then simulate the model forwards from 1900 onward holding fixed
all other exogenous locational characteristics in the model (i.e. Li,1850 , ui,1900 , and the en-
tire path of Ait and uit for t > 1900) at their values estimated in Section 3.3 (and with
Ait = Ai,2000 and ui,t = ui,2000 held fixed for all t > 2000). This generates a stream of
counterfactual predictions for all the endogenous variables in the model (which we denote as
  (b)    (b)  (b)
Lit , Wit , it , etc.) at all dates t  1900.
     We then repeat these four steps for all B = 100 simulations. We will also draw on an
                                                                                          (F )
additional (B + 1)th simulation (the output of which we label as, for example, Lit , for
"factual") in which there are no swaps at all. This corresponds, for t  2000, to the factual
path taken by variables such as Lit in the data. For years t > 2000 this exercise therefore
simulates forward a model that (by design) fits the past data perfectly. We simulate each
counterfactual history (and the factual history) forward 30 generations past the year 2000,
to the year 3500. While these projections are obviously heroic, such a long horizon turns out
to be necessary in order to capture the full scope of historical persistence in this model.
     To summarize, each of these "swap" counterfactual history simulations holds everything
in the model constant apart from the fundamental sources of productivity in 1900, Ai,1900 ,
and even the Ai,1900 distribution is held exactly constant (not just on aggregate but also
across the N/2 pairs of locations). The only thing being perturbed in any counterfactual
history is the within-pair assignment of productivity in 1900 among pairs of locations that
are as close as possible to one another in terms of their 1900 populations.
  33
    Other examples of pairs include the counties that are home to Worcester and San Francisco (ranks 17
and 18), Providence and Baltimore (ranks 21 and 22), New Haven and New Orleans (ranks 23 and 24), and
Louisville and Minneapolis (ranks 27 and 28). Due to the odd number of locations, that with the smallest
1900 population--a subset of Craig County, VA--is without a partner. We therefore leave its productivity
unchanged in every simulation.




                                                  31
4.2.1    Local persistence elasticities

We begin by quantifying the local impact of these swap counterfactuals. While the counter-
factual changes are to productivities Ai,1900 , a useful way to summarize the effect of these
shocks can be obtained by noting that, from the perspective of any year t > 1900, the only
impact of these shocks is to alter {Li,1900 }, the initial conditions of the model's only state
variable. We therefore study the impact of a change in such initial conditions, rather than
the underlying shocks to Ai,1900 that altered these initial conditions, as follows.
    For any generic "outcome" of interest, Oit , we use the data generated by the model
simulations in order to estimate the regression

                                        (b) O    O           (b)       O(b)
                                   ln Oit = it + it ln Li,1900 + it                                      (34)

separately for each location i and time period t > 1900. Our interest lies in the local per-
                                                    O
sistence elasticity (for outcome O), denoted by it    . This elasticity measures the average
relationship, across the B simulations, in location i between that location's historical popu-
        (b)                                    (b)                                         O(b)
lation Li,1900 and its value for the outcome Oit in some later period t. The error term it
                                                     (b)
in equation (34) is almost surely correlated with Li,1900 , for any outcome--as, for example,
                                                                                    (b)
equation (20) makes clear when Oit represents population. But ln Ai,1900 can serve as an
                                               O
excludable IV for consistent estimation of it    given that it is randomly assigned (by design).
    Figure 5 reports the distribution (across locations) of the estimated values of the local
                                      L
persistence elasticity for population it that corresponds to each of the years t = 1950-3500.34
                                      L
For example, the median elasticity i,  2000 , 100 years after our simulated shocks, is 0.89, and
it remains high at 0.45 after 500 years. While there is considerable heterogeneity across
locations, even the lowest inter-quartile range value is 0.80 at t = 2000. This suggests that in
a dynamic economic geography model like the one developed here, it should be considered the
norm, rather than the exception, to observe that an event that raises a location's population
at a point in time leads to centuries-long economic persistence.
                                                                      W
    Also shown in Figure 5 is the distribution of the elasticities it   , where the outcome Oit
                      (b)                                              W
is ex-post welfare Wit . As expected, the local welfare elasticities it   are considerably lower
                                         L
than the local population elasticities it --because of both trade and migration, the welfare
of a location draws on both local and nearby geographical advantage, so the local impact of
local shocks is muted by spatial interactions and arbitrage. Still, the median elasticity after
100 years is 0.21 and it is not much lower, at 0.11, after 500 years.
  34                                                     O
    To account for the possibility that the elasticities it are estimated with error, in this figure we weight
each location by the inverse of the square of the estimated standard error of its estimate. The instruments
are typically very strong, with a mean (median) first stage F-statistic of 492 (166) and 85% of locations'
F-statistics exceeding 10.


                                                     32
    Finally, Figure 5 also reports the corresponding elasticities for ex-ante welfare, it . Even
                                                     
one period after the shock, the local elasticities it   are all essentially zero. This means
that while local shocks cast a long shadow over many characteristics (populations, prices,
wages, productivity, amenities) of the local economy, they have little bearing on the welfare
of children who are born in such locations because those children always have the option to
migrate outwards. However, while local shocks have no impact on the spatial distribution of
the next generation's welfare, this is not to say that such shocks have no aggregate welfare
consequences; indeed, as we will see below, we find precisely the opposite.

4.2.2    Fragility and resilience

As we have seen, local productivity swaps leave a sizable impact on their local economies,
even many centuries after the shocks occurred. One consequence of this is that we should
expect variability of local outcomes across simulations. But which locations tend to be
fragile in the face of these shocks and which tend to be resilient? To explore this for the
                                                                    (b)                   (b)
year 2000, Figure 6 shows a plot of the standard deviation of ln Li,2000 (as well as ln Wi,2000
          (b)                                                                       (F )
and ln i,2000 ) across the B simulations against the factual population in 2000, Li,2000 . We
see that no location is immune to these shocks (the minimum standard deviation of log 2000
population is 1.12), not even those in the largest locations (the average standard deviation
among the year 2000's 25 largest locations is 1.99). And many smaller locations see extremely
large variability across our simulations.35
                                                                                          (b)
    As expected, similar patterns are on display for the two welfare measures, ln Wi,2000
          (b)
and ln i,2000 , but in a substantially dampened fashion (especially for it ) throughout the
distribution. However, even ex-ante welfare is hardly impervious to 100 year-old shocks; for
                                                                              (b)
example, the largest 25 locations have an average standard deviation of ln i,2000 of 0.25.

4.2.3    Spatial configuration

Having seen that local historical shocks leave long-lasting impacts on individual locations, a
natural question is whether these impacts can be so large as to re-orient the spatial config-
uration of the entire economy.
    To investigate this, we examine the correlation of the entire distribution of population
across counterfactual historical simulations. For any pair of simulations, b and b , and any
                                        (b)      (b )
year t, we calculate L bb ,t  corr (ln Lit , ln Lit ) as a way of asking how similar the spatial
distribution of (log) population is across these two simulations. We do this using all pairs of
  35
    This tendency for smaller locations to have relatively greater variability across simulations, however,
                                                          L
does not account for the cross-location heterogeneity of i,2000 seen in Figure 5; the correlation between
L              (F )
i,2000 and ln Li,2000 is -0.06.


                                                    33
the 100 simulations of counterfactual history, and also that corresponding to actual history
              (F )
(i.e. for ln Lit ), so there are 5, 050 (i.e. 101×
                                                 2
                                                   100
                                                       ) values of L bb ,t for each year.
    Figure 7 reports the interquartile spread of this statistic across those 5, 050 values. Prior
to the onset of the shocks in 1850 this correlation (i.e. L       bb ,1850 ) is equal to one, of course.
Upon the realization of the shocks in 1900, it declines to 0.79 and continues to fall, reaching
0.76 by the year 2000 and 0.70 in the year 3500. At the same time, the spread of correlations
across simulation pairs rises, slowly, such that by the year 3500, 25% of simulation pairs have
a correlation less than 0.52, whereas 25% of simulation pairs have a correlation greater than
0.91. A similar pattern is seen in Figure 7 for the cross-simulation correlation of ex-post and
ex-ante welfare, W             
                     bb ,t and bb ,t .
                                      36

    Summarizing, while Figure 5 documents that historical shocks can have extremely per-
sistent effects on the local economy, Figure 7 points to the possibility of something stronger:
long-run outcomes that remain permanently distinct across simulations. This is indicative
of path dependence, as we now discuss.


4.3     Path Dependence in the U.S. Spatial Economy
Following Section 2.3, we now focus on the behavior of locations' ex-ante welfare, it , because
they will satisfy it =  once any steady-state has been reached. Figure 8 plots the path
                               (b)
of population-weighted ln it over time for each simulation b (the various colors used to
illustrate these paths reflect the spatial orientations underlying them, as we discuss shortly),
                                                    (F )
as well as that for the projected factual path ln it in light green.37 Recall that all of our 101
simulated economies feature exactly the same paths of fundamentals from t = 1950 onward,
so all heterogeneity across these simulations after 1900 is purely the result of heterogeneity
                          (b)
in the state variable {Li,1900 } induced by the simulated productivity swaps in 1900.
    Several features of Figure 8 stand out. First, aggregate welfare in each simulation tends
to rise as the pursuit of more attractive locations by mobile children entering adulthood
pushes the population distribution closer and closer to a more efficient allocation of resources
(even though it is certainly not guaranteed to do so). Second, this process stabilizes in most
simulations over the first 300-400 years, with relatively small adjustments over the 3,000 years
that follow. Third, these small ensuing adjustments do lead to genuine steady-states in a
  36
     Unlike population and ex-post welfare, the median ex-ante welfare correlations      bb ,t do increase from
their nadir of 0.20 in 2200 to 0.58 in 3500; this increase is due in part to the fact that ex-ante welfare is
equalized across all locations in the steady-state and we set the correlation between any pair in which at
least one is in the steady-state to one (as it would be otherwise undefined).
  37
     As our identification procedure recovers productivity and amenity levels to scale, to compare recovered
geographies across years, we choose the scale such that the factual welfare in years 1900 and 1950 have the
same mean as in the year 2000. No choice of scale is necessary for subsequent years, as the geography remains
constant at its year 2000 values.


                                                      34
number of cases (illustrated with yellow dots) but in many other cases the small adjustments
are still occurring, albeit at an exceedingly slow pace.38 Fourth, even though there is broad
convergence of many paths to the same or similar steady-states, this convergence is by no
means uniform, and periods of temporary divergence are common. Fifth, many of these
simulations stabilize at differing levels of aggregate welfare, which implies that this model
displays not only path dependence but path dependence with aggregate welfare consequences.
Finally, these aggregate welfare consequences can be substantial. For example, the welfare
gap across the three steady-states shown is 1.29 log integers--which, for context, is equivalent
to 516 years of growth at 0.25% per annum. And while the factual economy ends up closer
(in welfare terms) to the best steady-state than to the worst by the year 3500, it is still
poorer than the best steady-state by an amount that corresponds to 181 years of foregone
0.25% annual growth.
    Put together, these findings imply that the relatively small swap counterfactual shocks
in our simulations are large enough to tip the model economy towards different steady-
states, implying that the basins of attraction of these steady-states are also relatively small.
One might therefore conjecture that larger shocks in 1900 could have led to even greater
divergence in aggregate welfare. This is where the analytical bounds on ({Li0 }) obtained
in Proposition 4 prove useful. Figure 8 also plots the upper bound    ¯ according to equation
(22) as a dashed red line. While none of our simulations reaches this upper bound, the
cross-simulation variation is considerably larger than the gap between the best steady-state
and .¯
    However, the lower bound  from equation (23), which is calculated in Table 4, implies
that we cannot rule out the presence of alternative 1900 population distributions that would
have led this same post-1950 economy towards considerably (many orders of magnitude)
lower aggregate welfare. The factual 1900 distribution of population {Li,1900 } was hence
potentially quite close, in this welfare sense, to the basins of attraction of relatively good
steady-states, when compared to what might have been. This is consistent with the finding
in Section 2.4 that the basins of attraction of good steady-states tend to be larger than those
of dominated steady-states.
    Table 4 also reports the five components of the upper and lower bounds,        ¯ and , as
derived in Proposition 4. All of these components allow substantial latitude for historical
conditions to matter because their individual contributions to the ratio of upper-to-lower
bounds are each large. For example, one might have conjectured that the mere presence
  38
    For us to classify a simulation as being in a steady-state, we require that it is equalized across all
locations to numerical precision. By this definition, 11 of 101 simulations have reached a steady-state by
the year 3500. Of the remaining 90 simulations, the median standard deviation of ln it was 0.09, with an
interquartile range of 0.05 and 0.15, and none of the 90 have a standard deviation of ln it less than 0.001.


                                                    35
of large agglomeration spillover elasticities in each location would mean that the aggregate
welfare differences coming from concentration per se would be larger than any effects arising
from where that concentration occurs. But this conjecture turns out to be incomplete since
the effects of concentrating in superior locations (with better migration costs, trade costs,
or geographic fundamentals shown in columns 2-4, respectively) are similar in magnitude to
that from overall scale (in column 5).
    Finally, the presence of multiple steady-states begs the question of what these various
configurations look like, geographically speaking. As shown in the maps of Figure 9, our
100 simulations converge upon seven different forms of spatial organization by 3500, and the
factual economy simulation converges upon an eighth.39 The eight outcomes differ in many
senses, such as: where the location with the largest population is located, the relative size
of the largest location and secondary location(s) of agglomeration, the importance of the
West relative to the East, the extent to which historically outsized concentrations (such as
the Northeast) still hold sway in 1,500 years, and (as per Figure 8) aggregate welfare.40 The
highest-welfare steady-state (map g) has one dominant location (in Charlottesville, Virginia)
but the second-best configuration (map f), which is the factual history simulation, also has
substantial population concentration in Charlottesville, but a larger concentration in Denver,
Colorado. On the other hand, as illustrated in the scatter plots of Figure 9, all eight spatial
configurations display a similar degree of correlation, on average, between their year 3500
simulated populations and the factual population in 2000.


4.4     Summary
The results above paint a nuanced picture of how we might expect history to matter in
a dynamic economic geography model when it is estimated to fit long-run U.S. data. We
have seen how merely swapping the productivity fundamentals of similarly-sized locations
in 1900--while holding fixed all other exogenous features before, during and after the year
1900--can set in motion a wide range of endogenous consequences, playing out on multiple
spatial scales.
    On one end of the scale, there is a great deal of local persistence: local shocks have
large effects on their local economies, and these effects continue to leave their trace on local
outcomes over many centuries. At the same time, these local shocks also have large conse-
quences for the spatial configuration of the economy as a whole because of the logic of path
  39
     Specifically, we define a "form" here on the basis of the identity of the location with the greatest con-
centration of population. Simulations within the same form may nonetheless differ in the extent to which
population concentrates in that location and/or the distribution of economic activity elsewhere.
  40
     The color of the dots in the scatter plots beneath each map correspond with the colors of the welfare
paths shown in Figure 8.


                                                     36
dependence: the 101 random draws of swaps that we study converge towards at least eight
distinct configurations, each of which features unique patterns of economic agglomeration
and substantial differences in aggregate welfare.
    In short, history definitely matters in our estimated model U.S. economy. It matters in
terms of slow convergence to any steady-state, in terms of where a steady-state agglomerates
spatially, and even in terms of whether relatively good or bad steady-states are selected by
historical conditions. And as the analytical bounds of Table 4 suggest, it is likely that our
swap simulations are only probing a small extent to which history can matter in this context.


5     Conclusion
It is not hard to look at the geographic patterns of economic activity around us and believe
both that agglomeration forces are at work and that they may even be strong enough to
cause a self-reinforcing clustering of economic activity. This opens up the possibility that
there are many such spatial configurations in which mobile factors could settle--some good,
some bad--as well as the potential for historical accidents, such as initial conditions or long-
defunct technological shocks, to play a long-lived or even permanent role in determining the
distribution and efficiency of spatial allocations.
    This paper has sought to develop a dynamic economic geography framework that can
be used to characterize and quantify these possibilities. We have derived conditions on
how contemporaneous and historical agglomeration externalities in production and amenities
govern: (i) the existence and uniqueness of equilibria; (ii) the duration of persistence of shocks
around a steady-state; (iii) the scope for multiple steady-states; and (iv) the extent to which
such multiple steady-states may deliver different amounts of aggregate welfare.
    A particularly rich region of the model's parameter space--and one that is consistent
with our estimates based on U.S. Census data from 1800 onwards--is where equilibria are
unique and easy to solve for, persistence lasts many centuries, and only minor perturbations
in historical conditions can lead the economy towards distinct steady-states with substantial
differences in overall efficiency. One implication of this parameter region is that tempo-
rary economic events in many domains will leave large and long-lived geographical traces,
consistent with the numerous empirical studies discussed in the Introduction. Answers to
questions about optimal place-based policy will also be particularly subtle in the presence of
such features.
    While we have developed this paper's empirical and theoretical tools in the hopes of an
improved understanding of regional economic geography, these techniques could be applied
to other settings in which increasing returns and coordination failures, and hence multiplic-

                                               37
ity and path dependence, have long appeared as objects of theoretical interest that lack a
corresponding amount of high-dimensional quantification and simulation. Potential areas
of application could include: intra-city geographical phenomena such as residential segre-
gation, sorting, and so-called "tipping" dynamics (Schelling, 1971; Card, Mas, and Roth-
stein, 2008; and Lee and Lin, 2018); traditional "big push" models of economic development
(Rosenstein-Rodan, 1943; Murphy, Shleifer, and Vishny, 1989; and Krugman and Venables,
1995); competition policy questions surrounding technology adoption in the presence of net-
work effects and switching costs (David, 1985; and Farrell and Klemperer, 2007); and the
study of dynamic questions of political economy such as those surveyed in Acemoglu and
Robinson (2005).




                                            38
References
Acemoglu, D., and J. A. Robinson (2005): Economic Origins of Dictatorship and
 Democracy. MIT press.

Ahlfeldt, G. M., S. J. Redding, D. M. Sturm, and N. Wolf (2015): "The economics
 of density: Evidence from the Berlin Wall," Econometrica, 83(6), 2127­2189.

Allen, T., and C. Arkolakis (2014): "Trade and the Topography of the Spatial Econ-
 omy," The Quarterly Journal of Economics, 129(3), 1085­1140.

         (2018): "Modern spatial economics: a primer," in World Trade Evolution, pp.
  435­472. Routledge.

Allen, T., C. Arkolakis, and X. Li (2020): "On the Equilibrium Properties of Network
 Models with Heterogeneous Agents," NBER working paper no. 27837.

Anderson, J. E., and E. Van Wincoop (2003): "Gravity with Gravitas: A Solution to
 the Border Puzzle," American Economic Review, 93(1), 170­192.

Armington, P. S. (1969): "A Theory of Demand for Products Distinguished by Place of
 Production," International Monetary Fund Staff Papers, 16, 159­178.

Barreca, A., K. Clay, O. Deschenes, M. Greenstone, and J. S. Shapiro (2016):
 "Adapting to climate change: The remarkable decline in the US temperature-mortality
 relationship over the twentieth century," Journal of Political Economy, 124(1), 105­159.

Bazzi, S., M. Fiszbein, and M. Gebresilasse (2020): "Frontier Culture: The Roots and
 Persistence of "Rugged Individualism" in the United States," Econometrica forthcoming.

Bleakley, H., and J. Lin (2012): "Portage and path dependence," Quarterly Journal of
 Economics, 127(2), 587­644.

         (2015): "History and the Sizes of Cities," American Economic Review: Papers &
  Proceedings, 105(5), 558­563.

Bryan, G., and M. Morten (2019): "The aggregate productivity effects of internal mi-
 gration: Evidence from indonesia," Journal of Political Economy, 127(5), 2229­2268.

Bustos, P., B. Caprettini, and J. Ponticelli (2016): "Agricultural productivity and
 structural transformation: Evidence from Brazil," American Economic Review, 106(6),
 1320­65.

                                           39
Caliendo, L., M. Dvorkin, and F. Parro (2019): "Trade and labor market dynamics:
 General equilibrium analysis of the china trade shock," Econometrica, 87(3), 741­835.

Card, D., A. Mas, and J. Rothstein (2008): "Tipping and the Dynamics of Segrega-
 tion," Quarterly Journal of Economics, 133(1), 177­218.

Combes, P.-P., and L. Gobillon (2015): "The Empirics of Agglomeration Economies,"
 in Handbook of Regional and Urban Economics, ed. by G. Duranton, J. V. Henderson, and
 W. C. Strange, vol. 5, pp. 247­348. Elsevier.

David, P. A. (1985): "Clio and the Economics of QWERTY," American Economic Review,
 Papers and Proceedings, 75(2), 332­337.

Davis, D., and D. Weinstein (2002): "Bones, Bombs, and Break Points: The Geography
 of Economic Activity," American Economic Review, 92(5), 1269­1289.

         (2008): "A Search for Multiple Equilibria in Urban Industrial Structure," Journal
  of Regional Science, 48(1), 29­65.

Dekle, R., J. Eaton, and S. Kortum (2008): "Global Rebalancing with Gravity: Mea-
 suring the Burden of Adjustment," IMF Staff Papers, 55(3), 511­540.

Dell, M. (2010): "The Persistent Effects of Peru's Mining Mita," Econometrica, 78(6),
 1863­1903.

Dell, M., and B. Olken (2020): "The Development Effects of the Extractive Colonial
 Economy: The Dutch Cultivation System in Java," Review of Economic Studies, 87(1),
 164­203.

Deneckere, R. J., and K. L. Judd (1992): "Cyclical and Chaotic Behavior in a Dynamic
 Equilibrium Model, with Implications for Fiscal Policy," in Cycles and Chaos in Economic
 Equilibrium, ed. by J. Benhabib. Princeton University Press.

Desmet, K., D. K. Nagy, and E. Rossi-Hansberg (2018): "The Geography of Devel-
 opment," Journal of Political Economy, 126(3), 903­983.

Desmet, K., and E. Rossi-Hansberg (2014): "Spatial development," American Economic
 Review, 104(4), 1211­43.

Dingel, J. I. (2017): "The determinants of quality specialization," The Review of Economic
 Studies, 84(4), 1551­1582.


                                           40
Dippel, C. (2014): "Forced Coexistence and Economic Development: Evidence from Native
 American Reservations," Econometrica, 82(6), 2131­2165.

Disdier, A.-C., and K. Head (2008): "The Puzzling Persistence of the Distance Effect
 on Bilateral Trade," Review of Economics and Statistics, 90(1), 37­48.

Donaldson, D., and R. Hornbeck (2016): "Railroads and American Economic Growth:
 A "Market Access" Approach," Quarterly Journal of Economics, 131(2), 799­858.

Eaton, J., and S. Kortum (2002): "Technology, Geography and Trade," Econometrica,
 70(5), 1741­1779.

Farrell, J., and P. Klemperer (2007): "Coordination and Lock-In: Competition with
  Switching Costs and Network Effects," in Handbook of Industrial Organization, ed. by
  M. Armstrong, and R. Porter, vol. 3, pp. 1967­2072. Elsevier.

Feigenbaum, J., J. Lee, and F. Mezzanotti (2018): "Capital Destruction and Economic
 Growth: The Effects of Sherman's March, 1850-1920," NBER working paper no. 25392.

Fischer, G., F. Nachtergaele, S. Prieler, H. Van Velthuizen, L. Verelst,
  and D. Wiberg (2008): "Global agro-ecological zones assessment for agriculture (GAEZ
  2008)," IIASA, Laxenburg, Austria and FAO, Rome, Italy, 10.

Fujita, M., P. Krugman, and A. J. Venables (1999): The Spatial Economy: Cities,
 Regions, and International Trade. MIT Press.

Glaeser, E. L. (2008): Cities, Agglomeration and Spatial Equilibrium. Oxford University
 Press.

Glaeser, E. L., and J. D. Gottlieb (2009): "The wealth of cities: Agglomeration
 economies and spatial equilibrium in the United States," Journal of economic literature,
 47(4), 983­1028.

Glaeser, E. L., S. P. Kerr, and W. R. Kerr (2015): "Entrepreneurship and Ur-
 ban Growth: An Empirical Assessment with Historical Mines," Review of Economics and
 Statistics, 97(2), 498­520.

Hanlon, W. (2017): "Temporary Shocks and Persistent Effects in Urban Economies: Ev-
 idence from British Cities after the U.S. Civil War," Review of Economics and Statistics,
 99(1), 67­79.



                                           41
Helpman, E. (1998): "The Size of Regions," in Topics in public economics: Theoretical and
 applied analysis, ed. by D. Pines, E. Sadka, and I. Zilcha. Cambridge University Press.

Henderson, V., T. Squires, A. Storeygard, and D. N. Weil (2018): "The Global
 Spatial Distribution of Economic Activity: Nature, History, and the Role of Trade," Quar-
 terly Journal of Economics, 133(1), 357­406.

Herrendorf, B., A. Valentinyi, and R. Waldmann (2000): "Ruling out multiplicity
 and indeterminacy: the role of heterogeneity," Review of Economic Studies, 67(2), 295­307.

Hillberry, R., and D. Hummels (2008): "Trade responses to geographic frictions: A
  decomposition using micro-data," European Economic Review, 52(3), 527­550.

Hornbeck, R., and D. Keniston (2017): "Creative Destruction: Barriers to Urban
 Growth and the Great Boston Fire of 1872," American Economic Review, 107(6), 1365­
 1398.

Hornbeck, R., and S. Naidu (2014): "When the Levee Breaks: Black Migration and
 Economic Development in the American South," American Economic Review, 104(3), 963­
 990.

Hsieh, C.-T., and E. Moretti (2019): "Housing constraints and spatial misallocation,"
 American Economic Journal: Macroeconomics, 11(2), 1­39.

Imbert, C., and J. Papp (2020): "Short-term Migration, Rural Public Works, and Urban
  Labor Markets: Evidence from India," Journal of the European Economic Association,
  18(2), 927­963.

Jedwab, R., and A. Moradi (2016): "The Permanent Effects of Transportation Revo-
  lutions in Poor Countries: Evidence from Africa," Review of Economics and Statistics,
  98(2), 268­284.

Kim, S., and R. A. Margo (2014): "Historical perspectives on US economic geography,"
 in Handbook of regional and urban economics, ed. by J. V. Henderson, and J.-F. Thisse,
 vol. 4, pp. 2981­3019. Elsevier.

Kline, P., and E. Moretti (2014): "Local economic development, agglomeration
 economies and the big push: 100 years of evidence from the tennessee valley authority,"
 Quarterly Journal of Economics, 129, 275­331.

Krugman, P. (1980): "Scale Economies, Product Differentiation, and the Pattern of Trade,"
 American Economic Review, 70(5), 950­959.

                                            42
         (1991): "History versus expectations," Quarterly Journal of Economics, 106(2),
  651­667.

Krugman, P., and A. J. Venables (1995): "Globalization and the Inequality of Nations,"
 Quarterly Journal of Economics, 110(4), 857­880.

Landes, D. S. (2003): The unbound Prometheus: technological change and industrial de-
 velopment in Western Europe from 1750 to the present. Cambridge University Press.

Lee, S., and J. Lin (2018): "Natural Amenities, Neighborhood Dynamics, and Persistence
  in the Spatial Distribution of Income," Review of Economic Studies, 85(1), 663­694.

Leech, M. (1959): In the days of McKinley. Harper & Brothers.

Manson, S., J. Schroeder, D. Van Riper, S. Ruggles, et al. (2017): "IPUMS Na-
 tional Historical Geographic Information System: Version 12.0 [Database]," Minneapolis:
 University of Minnesota, 39.

Matsuyama, K. (1991): "Increasing returns, industrialization, and indeterminacy of equi-
 librium," Quarterly Journal of Economics, 106(2), 617­650.

Michaels, G., and F. Rauch (2018): "Resetting the Urban Network: 117-2012," Eco-
 nomic Journal, 128(608), 378­412.

Mitrinovic, D. S., and P. M. Vasic (1970): Analytic inequalities, vol. 1. Springer.

Monte, F., S. J. Redding, and E. Rossi-Hansberg (2018): "Commuting, migration
 and local employment elasticities," American Economic Review, 108(12), 3855­90.

Murphy, K. M., A. Shleifer, and R. W. Vishny (1989): "Industrialization and the
 Big Push," Journal of Political Economy, 97(5), 1003­1026.

Nagy, D. K. (2020): "Hinterlands, city formation and growth: evidence from the US
 westward expansion," UPF working paper.

Nunn, N. (2008): "Slavery, Inequality, and Economic Development in the Americas: An
 Examination of the Engerman-Sokoloff Hypothesis," in Institutions and Economic Perfor-
 mance, ed. by E. Helpman, pp. 148­180. Harvard University Press.

          (2014): "Historical Development," in Handbook of Economic Growth, ed. by
  P. Aghion, and S. Durlauf, vol. 2, pp. 347­402. Elsevier.



                                          43
Ottaviano, G. I. (2001): "Monopolistic competition, trade, and endogenous spatial fluc-
 tuations," Regional Science and Urban Economics, 31(1), 51­77.

Rauch, J. E. (1993): "Does History Matter Only When it Matters Little? The Case of
 City-Indu try Location," Quarterly Journal of Economics, 108(3), 843­867.

Redding, S., D. Sturm, and N. Wolf (2011): "History and Industrial Location: Evi-
 dence from German Airports," Review of Economics and Statistics, 93(3), 814­831.

Redding, S. J. (2016): "Goods trade, factor mobility and welfare," Journal of International
 Economics, 101, 148­167.

Redding, S. J., and E. A. Rossi-Hansberg (2017): "Quantitative Spatial Economics,"
 Annual Review of Economics, 9(1).

Roback, J. (1982): "Wages, rents, and the quality of life," The Journal of Political Economy,
 pp. 1257­1278.

Roca, J. D. L., and D. Puga (2017): "Learning by working in big cities," The Review of
 Economic Studies, 84(1), 106­142.

Rosen, S. (1979): "Wage-Based Indexes of Urban Quality of Life," in Current Issues in
 Urban Economics, ed. by P. Mieszkowski, and M. Straszheim, pp. 74­104. Johns Hopkins
 University Press.

Rosenstein-Rodan, P. N. (1943): "Problems of Industrialisation of Eastern and South-
 eastern Europe," Economic Journal, June-September, 202­11.

Rosenthal, S. S., and W. C. Strange (2004): "Evidence on the Nature and Sources of
 Agglomeration Economies," in Handbook of Urban and Regional Economics, ed. by J. V.
 Henderson, and J. Thisse, vol. 4, pp. 2119­2172. Elsevier.

Roth, M. (2018): Magic Bean: The Rise of Soy in America. University Press of Kansas.

Sanderson, E., and F. Windmeijer (2016): "A weak instrument F-test in linear IV
  models with multiple endogenous variables," Journal of Econometrics, 190(2), 212­221.

Schelling, T. C. (1971): "Dynamic Models of Segregation," Journal of Mathematical
  Sociology, 1(July), 143­186.

Sequeira, S., N. Nunn, and N. Qian (2020): "Immigrants and the Making of America,"
  Review of Economic Studies, 87(1), 382­419.

                                             44
Simonovska, I., and M. E. Waugh (2014): "The elasticity of trade: Estimates and
  evidence," Journal of international Economics, 92(1), 34­50.

Specht, W. (1960): "Zur theorie der elementaren mittel," Mathematische Zeitschrift, 74(1),
  91­98.

USDA (2003): "Historical Track Records," National Agricultural Statistics Service.




                                           45
                        Figure 1: Illustration of Propositions 1 and 2

           (a) Range of uniqueness                         (b) Bound on persistence




Notes : This figure illustrates the regions of the parameter range (in the space of 1 and 1 ,
holding other parameters constant) relating to Propositions 1 and 2. The left panel shows (in
yellow) the range of 1 and 1 that satisfy the conditions for the uniqueness of equilibrium,
as per Proposition 1, holding trade and migration elasticities constant at the values  = 9
and  = 4. The right panel shows the upper bound on the persistence of the economy, as
                                                                -1
measured by the largest eigenvalue of |B-1 | I - A   ~ (1 , 1 )    C |B|, as per Proposition 2,
holding trade and migration elasticities constant at the same values and choosing 2 = 0.04
and 2 = 0.33 to be consistent with the estimation results below. Note that the bound
on persistence approaches infinity as the parameter constellation approaches the threshold
where the sufficient condition for uniqueness is no longer satisfied (but we top-code the color
scale for readability).




                                              46
  Figure 2: Illustrating the implications of Propositions 2-4 in a three-location economy
                          (a)       Prop. 2: The closer to non-uniqueness, the greater the persistence
                                                Far from non-uniqueness                                                                Close to non-uniqueness
                                                               Location 2                                                                             Location 2




                 Location 1                                                                Location 3   Location 1                                                                Location 3
                                                 1
                                                     =-0.25, 2=0, ui =1      i, =1.1                                                         1
                                                                                                                                                 =0, 2=0, ui =1    i, =1.1




                                   (b)           Prop. 3: Historical spillovers can lead to path dependence
                                                      No path dependence                                                                         Path dependence
                                                               Location 2                                                                             Location 2




                 Location 1                                                                Location 3   Location 1                                                                Location 3
                                                      1
                                                          =0, 2=0, ui =1    i, =1.1                                                      1
                                                                                                                                             =0, 2=0.25, u i =1     i, =1.1




                (c)     Prop. 4: Greater differences in local geography, greater welfare consequences
                                                      Symmetric locations                                                                Asymmetric locations
                                                               Location 2                                                                             Location 2




                 Location 1                           =0, 2=0.25, u i =1     i, =1.1       Location 3   Location 1                   =0, 2=0.25, u 1=1.05, u 2=u 3=1, =1.1        Location 3
                                                  1                                                                              1
                          Welfare ( ) difference between good and bad (stable) steady states:1                  Welfare ( ) difference between good and bad (stable) steady states:1.02




                (d)    Prop. 4: Greater differences in global geography, greater welfare consequences
                                                          Higher trade costs                                                                     Lower trade costs
                                                               Location 2                                                                             Location 2




                 Location 1                   =0, 2=0.25, u 1=1.01, u 2=u 3=1, =1.1        Location 3   Location 1                  =0, 2=0.25, u 1=1.01, u 2=u 3=1, =1.08        Location 3
                                          1                                                                                     1
                         Welfare ( ) difference between good and bad (stable) steady states:1.02               Welfare ( ) difference between good and bad (stable) steady states:1.0204




Notes : These figures illustrate phase diagrams for a three-location example economy. Arrows
indicate the change in the equilibrium distribution of population from one period to the next,
with yellow stars denoting stable steady-states. See Section 2.4 for details.
                  Figure 3: Agglomeration spillover parameter estimates




Notes : This figure illustrates the parameter estimates (holding  and  constant) obtained
in Section 3.3. The red star denotes 1 and 1 , which lies in the yellow region of equilibrium
uniqueness following Proposition 1. The green star denotes 1 + 2 and 1 + 2 , which lies
in the blue region, indicating the possibility of multiple steady-states following Proposition
2. Confidence intervals are shown with dashed lines.




                                             48
Figure 4: How much of the spatial distribution of economic activity today is due to history?
                  (a) Population (Li,2000 )                                (b) Ex-post welfare (Wi,2000 )




                                                                    1.5
     1
     .8




                                                                    1
     .6




                                                                    .5
     .4




                                                                    0
     .2




                                                                    -.5
     0




           1800               1850          1900     1950                 1800               1850          1900     1950

                  Geography          Market Access   History                     Geography          Market Access   History




Notes : This figure presents the variance decomposition of the observed spatial distribution
of economic activity in the year 2000 into three components, as per equation (33): geography
fundamentals (i.e. the complete history of realizations of productivities A  ¯it and amenities
u
¯it from t = 0 until the present), market access (i.e. the complete history of goods market
access Pit and labor market access it from t = 0 until the present), and history (i.e. the
population distribution in t = 0, Li0 ). The decompositions shown correspond to four choices
of initial year t = 0: 1800, 1850, 1900, and 1950. Panel (a) presents the decomposition for
the observed distribution of population in the year 2000 (Li,2000 ), and panel (b) presents the
equivalent for ex-post welfare (Wi,2000 ).




                                                               49
                                   Figure 5: How persistent are local historical shocks for the local economy?
                1             .8
  Elasticity to 1900 population
      0      .2    .4   .6

                                    1950
                                    2000
                                    2050
                                    2100
                                    2150
                                    2200
                                    2250
                                    2300
                                    2350
                                    2400
                                    2450
                                    2500
                                    2550
                                    2600
                                    2650
                                    2700
                                    2750
                                    2800
                                    2850
                                    2900
                                    2950
                                    3000
                                    3050
                                    3100
                                    3150
                                    3200
                                    3250
                                    3300
                                    3350
                                    3400
                                    3450
                                    3500
                                                                         Year

                                                 Population       Ex-post welfare       Ex-ante welfare


Notes : This figure shows the distribution of estimated elasticities of the local persistence
            O
elasticity, it for various outcomes "O" (population Li,t , ex-post welfare Wit , and ex-ante
welfare it ), across all locations i and for each indicated year t. Following equation (34),
 O                                      (b)     (b)
it  is obtained in a regression of ln Oit on Li,1900 across 100 simulations b, separately by
                                                                                                           (b)
location-year, using the (randomly assigned) value of exogenous productivity Ai,1900 as an
IV. Each simulated history randomly shuffles the realized exogenous productivity in the year
1900 between all pairs of locations, where pairs are assigned to locations with the closest
                                                                        O
1900 populations. The dots indicate the mean estimated elasticity it       across all locations
(and the bar indicates the interquartile range) in a given year, weighting elasticity estimates
by the inverse of the square the estimate's standard error.




                                                                       50
                                             Figure 6: How resilient are locations to historical shocks?
                      10
       Log Std.dev. across simulations
        2        4    0   6         8




                                         0                      2                         4                6
                                                             Actual 2000 Population (millions)

                                                     Population     Ex-post welfare      Ex-ante welfare

                                                                                                 (b)
Notes : This figure plots the standard deviation of log population ln Li,2000 , log ex-post welfare
     (b)                                (b)
ln Wi,2000 , and log ex-ante welfare ln i,2000 in the year 2000 across 100 different simulations b
of history against each location's actual year 2000 population Li,2000 . Each simulated history
                                                              (b)
randomly shuffles the realized exogenous productivity Ai,1900 in the year 1900 between all
pairs of locations, where pairs are assigned to locations with the closest 1900 populations.




                                                                         51
                  Figure 7: How persistent are historical shocks for the economy as a whole?
                      1             .8
       Correlation across simulations
          0      .2    .4    .6

                                         1850
                                         1900
                                         1950
                                         2000
                                         2050
                                         2100
                                         2150
                                         2200
                                         2250
                                         2300
                                         2350
                                         2400
                                         2450
                                         2500
                                         2550
                                         2600
                                         2650
                                         2700
                                         2750
                                         2800
                                         2850
                                         2900
                                         2950
                                         3000
                                         3050
                                         3100
                                         3150
                                         3200
                                         3250
                                         3300
                                         3350
                                         3400
                                         3450
                                         3500
                                                            Year

                                         Population   Ex-post welfare   Ex-ante welfare


Notes : This figure shows the correlation across simulations in the location of economic
activity over time. For each year and each possible pair of simulations, we calculate the
                                                  (b)                           (b)
cross-location correlation in log population ln Li,t , ex-post log welfare ln Wi,t , and ex-ante
                (b)
log welfare ln i,t . The dot indicates the mean correlation across all possible pairs within a
year and the bar reports the interquartile range. We set the correlation of ex-ante log welfare
equal to one if either simulation in a given year is in a steady-state (since steady-state ex-
ante welfare is equalized across locations). As there are 100 simulated histories (plus the
                                                                                1
observed factual history), there are 5,050 possible correlations (101 × 100 × 2   ) in each year.
                                                                                          (b)
Each simulated history randomly shuffles the realized exogenous productivity Ai,1900 in the
year 1900 between all pairs of locations, where pairs are assigned to locations with the closest
1900 populations.




                                                          52
                                       Figure 8: How does history affect aggregate welfare?
                 4




                                                           1%             0.5%                            0.25%
                                                         growth          growth                           growth
                             3
      Aggregate (log) welfare
      1         20
                                  1850
                                  1900
                                  1950
                                  2000
                                  2050
                                  2100
                                  2150
                                  2200
                                  2250
                                  2300
                                  2350
                                  2400
                                  2450
                                  2500
                                  2550
                                  2600
                                  2650
                                  2700
                                  2750
                                  2800
                                  2850
                                  2900
                                  2950
                                  3000
                                  3050
                                  3100
                                  3150
                                  3200
                                  3250
                                  3300
                                  3350
                                  3400
                                  3450
                                  3500
                                                                     Year

Notes : This figure plots the evolution of the population-weighted distribution of ex-ante
                                              (b)
                                 (b)   N     Lit        (b)
welfare, ln t                          i=1    ¯
                                              L
                                                    ln it , over time for 100 different simulations b of history. The
color of each path corresponds to the location with the greatest concentration of population
in the year 3500 (see Figure 9). Also shown (in lime green) is the path of aggregate welfare
for the factual economy (normalized to its 2000 value because the scale of aggregate welfare
is unidentified for years prior to 2000). Yellow circles indicate when a steady-state has been
reached. The red dashed bar indicates the maximum possible steady-state aggregate welfare
according to Proposition 4. Grey lines indicate annualized growth rates from the year 2000.




                                                                   53
                                     Figure 9: Possible distributions of economic activity in the year 3500
                          (a) 12 simulations         (b) 1 simulation       (c) 2 simulations       (d) 26 simulations*




                       (e) 1 simulation (reality)   (f) 49 simulations*     (g) 5 simulations*       (h) 5 simulations




54
     Notes : This figure partitions 100 simulations into 7 groups (plus one more, for the simulation of the factual economy, shown in
     panel e) based on the location of greatest population in 3500. In each map, locations are colored on the basis of their population
     relative to the distribution, with red (blue) indicating more (less) population. Yellow dots denote a location at which all (and for
     green dots, some) of the simulations featured more than 10 million persons (in total 2000 population level units) concentrated
                                                                                         (b)
     in the location. Underneath each map, the corresponding scatter plot relates ln Li,3000 to ln Li,2000 across all of the locations and
     simulations b in the group, with the scatter-point colors corresponding to the paths in Figure 8. The number of simulations in
     each group is indicated above each map and groups that include a steady-state by 3500 are indicated by an asterisk.
                   Table 1: Gravity distance elasticity for trade and migration

                                  log(trade)                             log(migration)
                                      (1)                   (2)          (3)         (4)              (5)
                                     1997                  1850         1900        1950             2000
 log(distance)                    -1.353***            -2.157*** -1.798*** -1.890***              -1.511***
                                   (0.062)              (0.190)   (0.113)   (0.084)                (0.069)
 R-squared                           0.901                 0.689        0.793         0.857         0.908
 Observations                        2,091                  626         1,991         2,152         2,304
Notes: OLS estimates of equation (25) in column 1 and equation (26) in columns 2-5. Each observation is
an (origin state)×(destination state)×(year) triplet for the set of 48 coterminous U.S. states. The dependent
variable in column 1 is the log value of goods traded, and that in columns 2-5 is the log number of 25-74
year olds residing in the destination state in that year that were born in the origin state (as a proxy for
lifetime adult migration). All specifications control for origin-year and destination-year fixed effects. Trade
data comes from the Commodity Flow Survey (1997); migration data comes from the decennial U.S. census
(in the years indicated). Distance is the geodesic distance between the midpoint of each state, where own
distance is the expected distance between any two residents within a state, assuming the state is a square
and population is uniformly distributed within the state. Standard errors are two-way clustered at the origin
state and destination state. Stars indicate statistical significance (with *** denoting p<.01).




                                                      55
                             Table 2: Estimated productivity spillovers

                                                                            (1)          (2)          (3)
 Estimated parameters:
   Contemporaneous productivity spillover (1 )                             0.409 0.217*** 0.114***
                                                                          (0.963) (0.038)  (0.034)
    Historical productivity spillover (2 )                                 0.054   0.045    0.040
                                                                          (0.066) (0.033)  (0.030)
    Armington elasticity of substitution ( )                               3.065
                                                                          (4.986)
 Assumed parameter values:
   Armington elasticity of substitution ( )                                N/A            5            9
 Min. Sanderson-Windmeijer first-stage F-statistic                         28.5         75.9         75.9
 Observations                                                             15,640       15,640       15,640
Notes: This table reports 2SLS estimates of the parameters in equation (31) in column 1 (and subject to
the stated assumed parameter values in columns 2 and 3). Each observation is a sub-county from 1850-
2000. The instruments used are the interaction of linear time trends with the maximum temperature in the
warmest month (and its square), and with the minimum temperature in the coldest month (and its square).
All specifications control for sub-county and region-year fixed effects (where a region is one of 14 equally
sized squares covering the continental U.S.) and for the excluded instruments used to estimate productivity
spillovers in Table 3. Standard errors are two-way clustered at the sub-county (to allow for serial correlation
over time) and county-year levels (to allow for data aggregation across sub-counties within year) and are
reported in parentheses. Sanderson and Windmeijer (2016) F-statistic refers to the first-stage F-statistic for
each first-stage (shown in Table C.1) obtained while partialling out the other endogenous variable; the value
reported is the minimum of the two such F-statistics across the two equations. Stars indicate statistical
significance (with *** denoting p<.01).




                                                      56
                               Table 3: Estimated amenity spillovers

                                                         (1)       (2)        (3)        (4)        (5)
 Estimated parameters:
   Contemporaneous amenity spillover (1 )              1.216   0.088   -0.150  0.093   -0.145
                                                      (1.850) (0.284) (0.278) (0.284) (0.279)
    Historical amenity spillover (2 )                  0.399  0.317* 0.322* 0.325* 0.330*
                                                      (0.335) (0.182) (0.178) (0.182) (0.179)
    Migration elasticity ()                            0.620
                                                      (0.858)
    Armington elasticity of substitution ( )           0.268
                                                      (2.524)
 Assumed parameter values:
   Armington elasticity of substitution ( )                          5          5          9          9
   Migration elasticity                                              2          4          2          4
 Min. S-W first-stage F-statistic                     3.078      7.373      7.373      7.373      7.373
 Observations                                         15,640     15,640     15,640     15,640     15,640
Notes: This table reports 2SLS estimates of the parameters in equation (32) in column 1 (and subject to
the stated assumed parameter values in columns 2-5). The instruments used are the interaction of linear
time trends with the difference between high-intensity and low-intensity agro-climatic potential yields of
maize (mean and standard deviation), and with the difference between high-intensity yields of soy and the
low-intensity yields of wheat (mean and standard deviation). All specifications control for sub-county and
region-year fixed effects and for the excluded instruments used to estimate productivity spillovers in Table
2. Standard errors, two-way clustered at the sub-county and county-year levels, are reported in parentheses.
Notes to Table 2 contain further details. Stars indicate statistical significance (with * denoting p<.1).




                                                    57
                                Table 4: Steady-state welfare bounds

                                         Migration        Trade        Local     Scale
                            Constants     costs           costs      geography economies          Total
                              (1)          (2)             (3)          (4)       (5)              (6)
 Upper bound ln  ¯             1.62         0.19          0.09          0.90         1.18          3.98
 Lower bound (ln )            -1.59         -1.58         -0.68        -0.88         -1.33         -6.05
 Difference ln ^PD             3.21         1.77          0.77          1.78         2.51         10.03
Notes: This table reports the steady-state welfare bounds (and their decomposition into five exogenous
components) as stated in Proposition 4. The upper and lower bound equations are:
                  1        1 ¯  1    1 ¯ - 1
                                                 1      ¯i u      1   ¯ - 1
                                                                                     ¯
                    ln c1 + ln  M +    ln T 1 + max ln A   ¯i + ln L        N 1 = ln 
                  2        2         2           2 i              2
                      1       1    1     1     1
                                               -1   1        ¯i u   1    ¯  N 2 = ln ,
                    - ln c2 + ln M 
                                       + ln T      + min ln A   ¯i + ln L
                      2       2          2          2 i             2
where each terms refers to the impact of the constants (column 1), the migration costs (2), the trade costs
(3), the local geography (4), and the scale economies (5), respectively. The third row reports the difference
between the upper bound and lower bound, i.e. ln    ^ P D  ln   ¯ - ln , for each component and the total.
Column 6 is equal to the sum of columns 1-5.




                                                     58
A         Online Appendix: Proofs
Proofs of Propositions 1, 3, and 5 rely on Theorem 3 (parts (i) and (ii)) of Allen, Arkolakis, and Li, 2020,
which we restate here for convenience:
    Consider the following system of N × K system of equations
                                        K                   K                 H
                                                   kh                                    kh
                                              xh
                                               i        =            k
                                                                    Kij             xh
                                                                                     j        ,
                                        h=1                 j =1              h=1

                                                   k
where {kh, kh } are known elasticities and Kij       > 0 are known bilateral frictions. Let B  [kh ] and
  [kh ] be the K × K matrices of the known elasticities. Define A  B-1 and the absolute value
                                                                                           h{1,...,K }
(element by element) of A as Ap . Then there exists a strictly positive set of xh   i > 0 i{1,...,N } and that
solution is unique if the spectral radius (i.e. the absolute value of the largest eigenvalue, denoted  (·)) of
Ap is weakly less than one, i.e.  (Ap )  1.


A.1         Proof of Proposition 1
When trade costs are symmetric, Allen and Arkolakis (2014) show that the origin and destination fixed
effects of the gravity trade equation are equal up to scale. That is if Xij = Kij i j , Kij = Kji , and
   j Xij =   j Xji , there exists a  > 0 such that:

                                                            i = i .
41
     From equation (4), this implies:
                             1-  -1
                            wi Ai   = Pi-1 wi Li 
                                                         -1
                             1-  -1           wi ui
                            wi Ai   =                         wi Li 
                                              Wi
                                              1                           1
                                                ~ -
                                    wi =  1-2 Wi ui ~ A~ 1-2
                                                       i Li  
                                                                                                  (2 -2 )~
                                                                                                         
                                                        ~ (1 -1 + 1- )
                                                                   1
                                            1                         ~
                                    wi =  1-2 Wi~ -   ¯
                                                 ¯i ~ A
                                                 u     i Li             Llag
                                                                         i

                                                                                                                     2
where ~          -1                                                                 ¯i L1 Llag
               2 -1 ,   and we have used the spillover functions with notation Ai = A   i  i                             and ui =
                2
¯i L
u   i
      1
        Llag
         i     .
     We can use this to simplify our equilibrium equations:
                                    ~
                                                                                                         ~
                                                                                                             
                          ~ -                          1-  -1  -1
                        Wi ui ~ A~ 1-
                                 i Li      Li =        ij Ai uj Wj1- Wj~ -
                                                                        uj ~ A~ 1-
                                                                              j Lj                              Lj
                                                   j


                                                       i =           µ-   
                                                                      ij Wj
                                                                j

                                                                  - lag
                                              Li =          µ- 
                                                             ji Wi j Lj ,
                                                        j

as the equivalent set:
     41
    The exact scale () is determined by the aggregate labor market clearing condition. However, the scale
can be ignored by first solving for the "scaled" labor (i.e. imposing the scalar is equal to one) and then
recovering the scale by imposing the labor market clearing condition. This does not affect any of the other
equilibrium equations below, as they are all homogeneous of degree 0 with respect to labor.



                                                                59
                                                                                           ~ (2 ( -1)+2  )
                                                                                           
                    ~ (1-1 ( -1)-1  )
                                                  1- ¯( -1)~
                                                               ~ ( -1)~
                                                                       ¯
               Wi~
                   Li                   =         ij Ai      u
                                                             ¯i j        ~
                                                                        Aj Llag
                                                                            i
                                              j
                                                        ~ (2  +2 ( -1))
                                                        
                                                                            -( -1)~
                                                                                       ~ (1+1  +1 ( -1))
                                                                                       
                                             × Llag
                                                j                         Wj          Lj


                                                  i =        µ-   
                                                              ij Wj
                                                         j

                                                                 - lag
                                            Li Wi- =         µ-
                                                              ji j Lj .
                                                        j

If we order the endogenous variables as L, W, , then the matrix of LHS coefficients in this system becomes:
                                                                       
                                        ~ (1 - 1 ( - 1) - 1  ) 
                                                                  ~ 0
                                B                  0               0 
                                                   1             - 0

and the equivalent for the RHS coefficients is:
                                                                                   
                                 ~ (1 + 1  + 1 ( - 1)) - ( - 1) 
                                                                ~                0
                                               0                                 0 .
                                               0           0                     -

Hence, we have:
                                                                            ~ (2 -1)(1 +1)
                                                                                               
                                     - -1  +1  +1  +1                       
                                                                 0
                                     ++1 -  1  -1                          + +1  -1  -1 
                        A  B-1 =     ++ -   /~
                                                                 0        - (1 -1  )-1  +1  .
                                            1  -1                          + +1  -1  -1 
                                                                                           
                                          1
                                                  0              -1              0

It is straightforward to show that the spectral radius of the (element-wise) absolute value of A, denoted Ap ,
is the same as the spectral radius of the 2 × 2 matrix that removes the third row and second column from
Ap .42 Hence the uniqueness condition requires that the absolute value of this smaller matrix has a spectral
radius no greater than one, i.e.:
                                                                              
                                (1+1  +1 ( -1))-( -1)             ( -1)(1 +1)
                                  + (1+(1- )1 -1  )            + (1+(1- )1 -1  )        1,
                                         /~                     (1-( -1)1 -1  )
                                  + (1+(1- )1 -1  )            + (1+(1- )1 -1  )

as required.


A.2      Proof of Proposition 2
Recall that the equilibrium of the dynamic model corresponds to the set of endogenous variables {Lit , Wit , it }
that solve the following system of equations given exogenous parameters A    ¯it , u
                                                                                   ¯it , ij , µij , Lit-1 .
  42
    This result is achieved by construction. Let Ap denote the element-wise absolute value of A and let Ap    -2,3
denote the 2 × 2 matrix that removes the third row and second column from Ap . By the Perron Frobenius
theorem, we have Ap    -2,3 = x, where x is the unique (to-scale) strictly positive eigenvector corresponding
to the largest eigenvalue (i.e. the spectral radius) of Ap
                                                         -2,3 , . It is straightforward to show that A = x
                                                                                                           p    ~,
                     x2                                      p
where x~  x1 , x2 ,  ,i.e.  is also an eigenvalue for A . Moreover, because x         ~ is strictly positive--and
the Perron Frobenius theorem tells us that there is only one strictly positive eigenvector (to-scale) which
corresponds to the largest eigenvalue--we know that  must be the largest eigenvalue for Ap , i.e.  is the
spectral radius of Ap and Ap  -2,3 . We thank Vincent Lohmann for a helpful discussion about this point.



                                                         60
    We have the (combined) trade equation:
    ~ (1-1 ( -1)-1 )     ~                      ~ (1+( -1) + )
                                                                        (1- )~
                                                                                          ~ (2 ( -1)+2  )              ~ (2  +2 ( -1))
  Lit                  Wit =           Fij Ljt                    Wjt            (Li,t-1 )                  (Lj,t-1 )                    ,
                                  j
                                                                                                                                    (A.1)
the population law of motion:
                                                        -
                                                   Lit Wit =            µ-  -
                                                                         ji jt Ljt-1 ,                                              (A.2)
                                                                   j

and the value of living in a particular location (multilateral migration resistance):

                                                         it =            µ-   
                                                                          ij Wjt .                                                  (A.3)
                                                                    j

We take as given the population at time t = 0, i.e. {Li0 }. The proof of Proposition 2 proceeds in five steps.

Step #1: Redefine the system
We begin by redefining the left hand side of the equilibrium equations:
                                                                ~ (1-( -1)-1 )
                                                                                      ~
                                                    xit  Lit                        Wit
                                                              -
                                                    yit  Lit Wit
                                                    zit  it ,

or equivalently:
                                                                                                       
                             ln xit      ~ (1 -  ( - 1) - 1 ) ~                              0  ln Lit
                              ln yit  =           1           -                              0 ln Wit  
                              ln zit              0            0                                ln it
                                                                       B
                                              
                            ln xit     ln Lit
                         -1 
                        B    ln yit  = ln Wit  .
                             ln zit    ln it

                                      -1                                     th
With a slight abuse of notation, let Bkl denote the k, l                          component of B-1 . We can then re-write the
system of equations as:
                                        ~ (1+( -1)1 + )
                                                                                        (1- )~
                                                                                                                        ~ (2  +2 ( -1))
                                                                                                                        
                     B -1 B -1 B -1                                B -1 B -1 B -1                 B -1   B -1   B -1
  xit =        Fij xjt11 yjt12 zjt13                              xjt21 yjt22 zjt23              xjt11
                                                                                                    -1 yjt-1 zjt-1
                                                                                                          12    13


           j
                                 ~ (2 ( -1)+2  )
                                 
                B -1 B -1 B -1
          × xit-
               11
                 1 yit-1 zit-1
                      12    13


                                         -                               1
                      B -1 B -1 B -1              B -1   B -1    B -1
  yit =        µ-
                ji
                  
                   xjt31 yjt32 zjt33             xjt11
                                                    -1 yjt-1 zjt-1
                                                          12    13


           j
                                         
                      B -1 B -1 B -1
  zit =        µ-
                ij
                   
                    xjt21 yjt22 zjt23       ,
           j




                                                                       61
or, equivalently:
                                                                                                        ~ (2  +2 ( -1))
                                                                                                                                                       ~ (2 ( -1)+2  )
                                                                                                                                                       
                                       ~       ~          ~              B -1    B -1        B -1                               B -1 B -1 B -1
        xit =              Fij xA 11 A12 A13
                                jt yjt zjt      -1 yjt-1 zjt-1
                                             xjt11    12    13
                                                                                                                               xit-
                                                                                                                                  11
                                                                                                                                    1 yit-1 zit-1
                                                                                                                                         12    13
                                                                                                                                                                                (A.4)
                   j
                                       ~         ~           ~       B -1       B -1        B -1
        yit =              µ-  A21 A22 A23
                            ji xjt yjt zjt xjt-1 yjt-1 zjt-1
                                              11    12    13
                                                                                                                                                                                (A.5)
                   j
                                       ~         ~           ~
        zit =              µ-  A31 A32 A33
                            ij xjt yjt zjt ,                                                                                                                                    (A.6)
                   j

where:                                                                                                                                    
                                                         ~ (1 + ( - 1) 1 + 1  )                                       (1 -  ) ~         0
                                                     ~ =
                                                     A             0                                                      0             - B-1 .
                                                                   0                                                                    0
                                                                                 ~  A (1 , 1 ), i.e.
   Equations (A.4)-(A.6) constitute the redefined system. As an aside, note that A
                                                   ~.
A (1 , 1 ) is the (element-wise) absolute value of A

Step #2: Re-write the system in terms of changes
We can further re-write equations Equations (A.4)-(A.6) as:
                                                                                            ~ (2  +2 ( -1))
                                                                                                                                              ~ (2 ( -1)+2  )
                                                                                                                                              
                       ~           ~       ~             B -1        B -1       B -1                                   B -1 B -1 B -1
xit =        Fij xA 11 A12 A13
                  jt yjt zjt   xjt11
                                  -1 yjt-1 zjt-1
                                        12    13
                                                                                                                      xit-
                                                                                                                         11
                                                                                                                           1 yit-1 zit-1
                                                                                                                                12    13
                                                                                                                                                                   
         j
                                           ~11                           ~12                       ~13                     -1                   -1                 -1     ~ (2  +2 ( -1))
                                                                                                                                                                          
                                           A                             A                         A                      B11                  B12                B13
                            xjt                              yjt                        zj,t                    xj,t-1              yj,t-1             zj,t-1
xit =        Fij
         j
                           xj,t-1                        yj,t-1                        zj,t-1                   xj,t-2              yj,t-2             zj,t-2
                                    -1                                -1                           -1     ~ (2 ( -1)+2  )
                                                                                                          
                                   B11                               B12                          B13
                 xi,t-1                          yi,t-1                         zi,t-1
        ×
                 xi,t-2                          yi,t-2                         zi,t-2
                                                                                            ~ (2  +2 ( -1))
                                                                                            
             ~             ~           ~                 B -1        B -1       B -1
        × xA
           j,t-1 yj,t-1 zj,t-1 xjt-2 yjt-2 zjt-2
             11   A12    A13      11    12    13


                                                   ~ (2 ( -1)+2  )
                                                   
              A-1           A-1 A-1
        × xit-
             11
               2 yit-2 zit-2
                    12    13
                                                                                   ,                                                                                            (A.7)


                                           ~         ~           ~       B -1    B -1        B -1
         yit =                 µ-  A21 A22 A23
                                ji xjt yjt zjt xjt-1 yjt-1 zjt-1 
                                                  11    12    13


                       j
                                                              ~21                           ~22                 ~23                  -1                 -1                 -1
                                                              A                             A                   A                   B11                B12                B13
                                               xjt                          yj,t                        zj,t             xj,t-1               yj,t-1             zj,t-1
         yit =                 µ-
                                ji
                                  

                       j
                                           xj,t-1                         yj,t-1                    zj,t-1               xj,t-2               yj,t-2             zj,t-2
                                                                      -1         -1          -1
                               ~           ~             ~           B11        B12         B13
                   × xA      A22    A23
                      j,t-1 yj,t-1 zj,t-1 xjt-2 yjt-2 zjt-2 ,
                        21
                                                                                                                                                                                (A.8)


                                                                     ~      ~           ~
                                   zit =                 Fij xA 31 A32 A33
                                                              jt yjt zjt   
                                                   j
                                                                                       ~31
                                                                                       A                       ~32
                                                                                                               A                  ~33
                                                                                                                                  A
                                                                         xjt                       yjt                 zj,t               ~      ~      ~
                                   zit =                 Fij                                                                            xA      A32    A33
                                                                                                                                         j,t-1 yj,t-1 zj,t-1 .
                                                                                                                                           31
                                                                                                                                                                                (A.9)
                                                   j
                                                                     xj,t-1                       yj,t-1              zj,t-1

    Equations (A.7)-(A.9) are then the redefined system in changes.



                                                                                                           62
Step #3: Bound the changes
Define the following constants:
                                                    xj,t                  yj,t                zj,t
                                   Mx,t  max              , My,t  max           , Mz,t  max
                                               j   xj,t-1            j   yj,t-1          j   zj,t-1
                                                    xj,t                 yj,t               zj,t
                                   mx,t       min        , my,t  min           , mz,t  min
                                               j xj,t-1             j yj,t-1            j zj,t-1

                                              Mx,t           My,t           Mz,t
                                    µx,t           , µy,t         , µz,t          .
                                              mx,t           my,t           mz,t

Let us bound {xit } from above first:

                                       ~11               ~12                 ~13                     -1               -1               -1   ~ (2  +2 ( -1))
                                                                                                                                            
                                       A                 A                   A                      B11              B12              B13
                            xjt                  yjt                 zj,t                 xj,t-1           yj,t-1           zj,t-1
   xit =          Fij
             j
                          xj,t-1               yj,t-1            zj,t-1                   xj,t-2           yj,t-2           zj,t-2
                                   -1                   -1                   -1    ~ (2 ( -1)+2  )
                                                                                   
                                  B11                  B12                  B13
                       xi,t-1                yi,t-1            zi,t-1
            ×
                       xi,t-2                yi,t-2            zi,t-2
                                                                      ~ (2  +2 ( -1))
                                                                                                                    ~ (2 ( -1)+2  )
                                                                                                                    
                   ~       ~       ~           B -1    B -1   B -1                                B -1 B -1 B -1
            × xA
               j,t-1 yj,t-1 zj,t-1 xjt-2 yjt-2 zjt-2
                 11   A12    A13      11    12    13
                                                                                             xit-
                                                                                                11
                                                                                                  2 yit-2 zit-2
                                                                                                       12    13
                                                                                                                                      =
                 ~11 1{A
                 A     ~11 0}            ~12 1{A
                                         A     ~12 0}           ~13 1{A
                                                                      ~13 0}
                                                                A                         B -1 
                                                                                           11
                                                                                                                 -1
                                                                                               ~ (2  +2 ( -1))1{B11 ~ (2  +2 ( -1))0}
 xit        Mx,t                    My,t                      Mz,t                      Mx,t -1
         
xi,t-1        ~11 1{A
             -A     ~11 <0}             -A     ~12 <0}
                                         ~12 1{A               -A     ~13 <0}
                                                                ~13 1{A                  -B -1 
                                                                                        11
                                                                                                                 -1
                                                                                               ~ (2  +2 ( -1))1{B11 ~ (2  +2 ( -1))<0}
                                                                                                                    
            mx,t                   my,t                       mz,t                  mx,t- 1

                    11 B -1                   -1
                            ~ (2 ( -1)+2  )1{B11 ~ (2 ( -1)+2  )0}                        B -1 
                                                                                           12
                                                                                                                 -1
                                                                                               ~ (2  +2 ( -1))1{B12 ~ (2  +2 ( -1))0}
                                                                                                                    
                 Mx,t -1                                                                My,t -1
            ×
                   -B -1 
                     11
                                           -1
                         ~ (2 ( -1)+2  )1{B11 ~ (2 ( -1)+2  )<0}                         -B -1 
                                                                                        12
                                                                                                                 -1
                                                                                               ~ (2  +2 ( -1))1{B12 ~ (2  +2 ( -1))<0}
                                                                                                                    
                 mx,t- 1                                                            my,t- 1

                    12 B -1                   -1
                            ~ (2 ( -1)+2  )1{B12 ~ (2 ( -1)+2  )0}                        B -1 
                                                                                           13
                                                                                                                 -1
                                                                                               ~ (2  +2 ( -1))1{B13 ~ (2  +2 ( -1))0}
                                                                                                                    
                 My,t -1                                                                Mz,t -1
            ×
                   -B -1 
                     12
                                           -1
                         ~ (2 ( -1)+2  )1{B12 ~ (2 ( -1)+2  )<0}                         -B -1 
                                                                                        13
                                                                                                                 -1
                                                                                               ~ (2  +2 ( -1))1{B13 ~ (2  +2 ( -1))<0}
                                                                                                                    
                 my,t- 1                                                            mz,t- 1

                    13 B -1                   -1
                            ~ (2 ( -1)+2  )1{B13 ~ (2 ( -1)+2  )0}
                                                 
                 Mz,t -1
            ×                                                                       .                                                        (A.10)
                   -B -1 
                     13
                                           -1
                         ~ (2 ( -1)+2  )1{B13 ~ (2 ( -1)+2  )<0}
                                              
                 mz,t- 1




                                                                              63
Similarly, we can bound {xi,t } from below:

                                    ~11               ~12               ~13                    -1                 -1              -1    ~ (2  +2 ( -1))
                                                                                                                                        
                                    A                 A                 A                     B11                B12             B13
                            xjt               yjt              zj,t                  xj,t-1             yj,t-1         zj,t-1
   xit =          Fij
             j
                        xj,t-1              yj,t-1            zj,t-1                 xj,t-2             yj,t-2         zj,t-2
                                   -1                -1                -1     ~ (2 ( -1)+2  )
                                                                              
                                  B11               B12               B13                                                                      ~ (2  +2 ( -1))
                                                                                                                                               
                     xi,t-1               yi,t-1            zi,t-1                                  ~       ~     ~       B -1   B -1   B -1
            ×                                                                                   xA      A12    A13
                                                                                                 j,t-1 yj,t-1 zj,t-1 xjt-2 yjt-2 zjt-2
                                                                                                   11                   11    12    13

                     xi,t-2               yi,t-2            zi,t-2
                                          ~ (2 ( -1)+2  )
                                          
                   B -1 B -1 B -1
            × xit-
                 11
                   2 yit-2 zit-2
                        12    13
                                                              =
                 ~11 1{A
                 A     ~11 0}           ~12 1{A
                                        A     ~12 0}          ~13 1{A
                                                                    ~13 0}
                                                              A                        B -1 
                                                                                       11
                                                                                                              -1
                                                                                            ~ (2  +2 ( -1))1{B11 ~ (2  +2 ( -1))0}
 xit         mx,t                   my,t                    mz,t                    mx,t -1
         
xi,t-1            ~11 1{A
                 -A     ~11 <0}         -A     ~12 <0}
                                         ~12 1{A             -A     ~13 <0}
                                                              ~13 1{A                 -B -1 
                                                                                         11
                                                                                                              -1
                                                                                            ~ (2  +2 ( -1))1{B11 ~ (2  +2 ( -1))<0}
                                                                                                                 
            Mx,t                    My,t                  Mz,t                      Mx,t- 1
                    B -1 
                     11
                                           -1
                         ~ (2 ( -1)+2  )1{B11 ~ (2 ( -1)+2  )0}                       B -1 
                                                                                       12
                                                                                                             -1
                                                                                           ~ (2  +2 ( -1))1{B12 ~ (2  +2 ( -1))0}
                                                                                                                
                  mx,t -1                                                           my,t -1
            ×
                    -B -1 
                      11
                                            -1
                          ~ (2 ( -1)+2  )1{B11 ~ (2 ( -1)+2  )<0}                    -B -1 
                                                                                     12
                                                                                                             -1
                                                                                           ~ (2  +2 ( -1))1{B12 ~ (2  +2 ( -1))<0}
                                                                                                                
                 Mx,t- 1                                                        My,t- 1
                    B -1 
                     12
                                           -1
                         ~ (2 ( -1)+2  )1{B12 ~ (2 ( -1)+2  )0}                       B -1 
                                                                                       13
                                                                                                             -1
                                                                                           ~ (2  +2 ( -1))1{B13 ~ (2  +2 ( -1))0}
                                                                                                                
                  my,t -1                                                           mz,t -1
            ×
                    -B -1 
                      12
                                            -1
                          ~ (2 ( -1)+2  )1{B12 ~ (2 ( -1)+2  )<0}                    -B -1 
                                                                                     13
                                                                                                             -1
                                                                                           ~ (2  +2 ( -1))1{B13 ~ (2  +2 ( -1))<0}
                                                                                                                
                 My,t- 1                                                        Mz,t- 1
                    B -1 
                     13
                                           -1
                         ~ (2 ( -1)+2  )1{B13 ~ (2 ( -1)+2  )0}
                                              
                  mz,t -1
            ×                                                                   .                                                        (A.11)
                    -B -1 
                      13
                                            -1
                          ~ (2 ( -1)+2  )1{B13 ~ (2 ( -1)+2  )<0}
                                               
                 Mz,t- 1

    Combining equations (A.10) and (A.11) (dividing the maximum by the minimum) implies:

                  |A
                   ~11 | |A
                          ~12 | |A
                                 ~13 |
            µx,t µx,t µy,t µz,t
                        |B -1                    -1
                              ~ (2  +2 ( -1))|+|B11                     -1
                                                    ~ (2 ( -1)+2  )| |B12
                                                                           ~ (2  +2 ( -1))|+|B12
                                                                                              -1
                                                                                                 ~ (2 ( -1)+2  )|
                                                                                                 
                     × µx,t11
                           -1                                       µy,t-1
                        |B -1                    -1
                              ~ (2  +2 ( -1))|+|B13 ~ (2 ( -1)+2  )|
                                                    
                     × µz,t13
                           -1                                        .

Proceeding similarly for {yit } and {zit } yield, respectively:

                                                    |A
                                                     ~21 | |A      ~23 | |B -1 | |B -1 | |B -1 |
                                                            ~22 | |A
                                             µy,t  µx,t µy,t µz,t µx,t11           12      13
                                                                            -1 µy,t-1 µz,t-1

                                                                 |A      ~32 | |A
                                                                  ~31 | |A      ~33 |
                                                          µz,t  µx,t µy,t µz,t .

Step #4: Combining the bounds
Combining the three inequalities and taking logs                      yields:
                                                                                          
                                          A~                           ~12
                                                                       A            ~13
                                                                                    A
                                         11
                                                                                                                   
                        ln µx,t                                                            ln µx,t       ln µx,t-1
                       ln µy,t    A        ~21                         ~22
                                                                       A            ~23
                                                                                    A
                                                                                          
                                                                                           ln µy,t  + C ln µy,t-1  
                        ln µz,t         
                                           ~31                         ~32          ~33
                                                                                           ln µ
                                                                                               z,t       ln µz,t-1
                                          A                            A            A

                                                                     A(1 ,1 )
                                                 
                          ln µx,t     ln µx,t-1
         (I - A (1 , 1 )) ln µy,t   C ln µy,t-1  ,                                                                                       (A.12)
                           ln µz,t     ln µz,t-1




                                                                         64
                                                                                    -1
for all t > 0, where C is a 3x3 matrix whose first row has elements C1j = B1         j ~ (2  + 2 ( - 1)) +
   -1                                                                  -1
 B1j  ~ (2 ( - 1) + 2  ) , whose second row has elements C2j = B1j , and whose third row is a vector of
zeroes.
     Because  (A (1 , 1 )) < 1, (I - A (1 , 1 )) in an M -matrix and is invertible, which in turn implies that
                            -1
its inverse (I - A (1 , 1 )) is strictly positive. As a result, we can multiply both sides of equation (A.12)
                    -1
by (I - A (1 , 1 )) while preserving the inequality, which yields:
                                                                              
                                 ln µx,t                            ln µx,t-1
                               ln µy,t   (I - A (1 , 1 ))-1 C ln µy,t-1  .                             (A.13)
                                 ln µz,t                            ln µz,t-1

Step #5: Combining the bounds
Finally, we convert the bound (A.13) back into {Lit , Wit , it } space. To do so, recall that:
                                                                   
                                              ln xit        ln Lit
                                       B-1  ln yit  = ln Wit 
                                              ln zit        ln it

so that, for example, we have:

               maxi Li,t /Li,t-1
     µL,t                        
               mini Li,t /Li,t-1
                       B -1 B -1 B -1       B -1   B -1   B -1
               maxi xi,t
                       11
                          yi,t12 zi,t13 /xi,t
                                            11
                                              -1 yi,t-1 zi,t-1
                                                    12     13

     µL,t =                                                      =
                       B -1 B -1 B -1       B -1   B -1   B -1
               mini xi,t
                       11
                          yi,t12 zi,t13 /xi,t
                                            11
                                              -1 yi,t-1 zi,t-1
                                                    12     13

                                       -1                               -1                             -1
                                      B11                              B12                            B13
               maxi (xi,t /xi,t-1 )           × maxi (yi,t /yi,t-1 )         × maxi (zi,t /zi,t-1 )
     µL,t                              -1                               -1                         -1       
                                      B11                              B12                        B13
               mini (xi,t /xi,t-1 )           × mini (yi,t /yi,t-1 )         × mini (zi,t /zi,t-1 )
                                         B -1                               B -1                             B -1
               maxi (xi,t /xi,t-1 ) | 11 |            maxi (yi,t /yi,t-1 ) | 12 |      maxi (zi,t /zi,t-1 ) | 13 |
     µL,t                                     ×                                   ×                                
               mini (xi,t /xi,t-1 )                   mini (yi,t /yi,t-1 )             mini (zi,t /zi,t-1 )
              |B -1 |      -1    |B -1 |
     µL,t    µx,t11 µy,t |B12 | µz,t13 .

Proceeding similarly for µW,t and µ,t yields:
                                                            
                                        ln µL,t     ln µx,t
                                     ln µW,t   B-1 ln µy,t  .                                                     (A.14)
                                       ln µ,t       ln µz,t
                                                                          
                                                   ln xit          ln Lit
An identical argument starting with the expression  ln yit  = B ln Wit  yields:
                                                    ln zit         ln it
                                                                  
                                         ln µx,t          ln µL,t
                                       ln µy,t   |B| ln µW,t  .                                                   (A.15)
                                         ln µz,t          ln µ,t

Substituting bounds (A.14) and (A.15) into bound (A.13) yields:
                                                                              
                         ln µL,t                          -1        ln µL,t-1
                       ln µW,t   B-1 I - A     ~ (1 , 1 )    C |B| ln µW,t-1  ,
                         ln µ,t                                     ln µ,t-1



                                                                 65
as required.


A.3        Proof of Proposition 3
The proof of the first part of the proposition (sufficient conditions for uniqueness) proceeds similarly to
the proof of Proposition 1. If migration costs are symmetric and we are in the steady-state, we have:
  i Lij =   j Lji , Lij = Mij gi dj , and Mij = Mji . So then it will be the case that:

                                                      gi  di .

In our case, this implies:
                                                          1
                                                         -
                                                  Wi i Li     = 2 ,
which recall is our measure of steady-state welfare.
    This simplifies our system of equations as follows:
        ~ (1-(1 +2 )( -1)- (1 +2 ))
                                              1- ¯( -1)~
                                                           ~ ( -1)~
                                                                   ¯    -( -1)~
                                                                                 ~ (1+(1 +2 ) +(1 +2 )( -1))
  Wi~
      Li                              =       ij Ai      u
                                                         ¯i uj       ~
                                                                    Aj Wj       Lj
                                          j

                                                            -
                                           Li Wi- = 2                µ-   
                                                                      ij Wj .
                                                                 j

    Let us order the endogenous variables as L, W . Define ~  1 + 2 and ~  1 + 2 Then the matrix
of LHS coefficients becomes:
                                         ~ 1-   ~ ( - 1) -  ~  ~
                                 B                                 ,
                                                    1          -
and the matrix on the RHS coefficients becomes:

                                          ~ 1+~ + ~ ( - 1)             - ( - 1) ~
                                                                                  .
                                                0                          

Hence, we have:                                                                        
                                             - -~ +~ +1                 -( -1)(  ~ +1)
                                            +(1+(1-)~ -~ )             + (1+(1- )  ~ - ~ )
                             A  B-1 =                / ~              - ( ~ (1- )- ~ +1)  .
                                               + (1+(1- )~ -~ )        + (1+(1- )  ~ - ~ )

As a result, the condition for uniqueness is identical to that above, where we simply replace 1 and 1 with
~  (1 + 2 ) and 
                    ~  (1 + 2 ), as required:
                                                                                   
                                 (1+~ + ~( -1))-( -1)          ( -1)(  ~ +1)
                              +(1+(1-)        ~ -~ )        + (1+(1- )     ~ - ~ ) 
                                                                                     1.
                                         / ~                 (1- (  - 1) ~ - ~
                                                                                ) 
                                   + (1+(1- ) ~ -~ )        + (1+(1- )     ~ - ~ )


    The second part of the proposition claims that there exists a geography for which if
                                                                            
                               (1+~ + ~( -1))-( -1)         ( -1)(~ +1)
                            +(1+(1-)        ~ -~ )       + (1+(1- )  ~ -~ ) 
                                                                       ~ ) 
                                                                             > 1,
                                       / ~                (1-( -1) ~ -
                                 + (1+(1- ) ~ -~ )       + (1+(1- )  ~ -~ )


then there exist multiple equilibria. For readability, we present it this result as a general theorem, under
which our model clearly falls:




                                                        66
Theorem 1. Consider the following mathematical system:
                                                                 N
                                               xi,1 = 1               Kij,1 xa 11 a12
                                                                             j,1 xj,2                                   (A.16)
                                                             j =1
                                                                 N
                                               xi,2 = 2               Kij,2 xa 21 a22
                                                                             j,1 xj,2 ,                                 (A.17)
                                                             j =1

                l{1,2}
where {Kij,k }i,j {1,...,N } are the "kernels" of (exogenous) bilateral frictions, {alk }l,k{1,2} are (exogenous)
                   k{1,2}
elasticities, {xi,k }i{1,...,N } are (endogenous) strictly positive vectors and {k }k{1,2} are either endogenous
scalars determined by additional constraints or are exogenous. If the spectral radius of the 2 × 2 matrix
                                                                          k{1,2}
Ap  [|akl |] is greater than one, then there exist kernels {Kij,k }i,j {1,...,N } such that there are multiple
solutions to equations (A.16) and (A.17).

Proof. The proof proceeds by construction. We begin by performing two transformations of the problem
that simplifies the setup. First, we absorb the scalars into the endogenous variables. To do so, define
          d   d                                       -1
yi,k = 1k,1 2k,2 xi,k , where D = [dkl ]  - (I - A) . Note that this is well defined as long as the spectral
radius of A is not equal to one. It is straightforward to then show that the following equations:
                                                                            a11 a12
                                                    yi,1 =           Kij,1 yj, 1 yj,2
                                                             j
                                                                            a21 a22
                                                    yi,2 =           Kij,2 yj, 1 yj,2
                                                             j

are equivalent to equations (A.16) and (A.17). To see this, substitute in the definition of yi,k , yielding:
                                                                                    a11                      a12
                         d11 d12
                         1 2     xi,1 =              Kij,1 xa11 d11 d12
                                                            j,1 1 2                       xa    d21 d22
                                                                                           j,2 1 2
                                                                                             12


                                                j
                                                                                    a21                      a22
                         d21 d22
                         1 2     xi,2 =                     a21
                                                     Kij,2 yj,   d11 d12
                                                               1 1 2
                                                                                           a22
                                                                                          yj,   d21 d22
                                                                                              2 1 2                 ,
                                                j

which, rearranging, yields:
                                -d11 +a11 d11 +a12 d21 -d12 +a11 d12 +a12 d22
                         xi,1 = 1                     2                                        Kij,1 xa 11 a12
                                                                                                      j,1 xj,2
                                                                                           j

                         xi,2 =   -
                                  1
                                    d21 +a21 d11 +a22 d21 -d22 +a21 d12 +a22 d22
                                                         2                                            a21 a22
                                                                                               Kij,2 yj, 1 yj,2 ,
                                                                                           j


which, given the definition of D, is equivalent to equations (A.16) and (A.17) as claimed.43
    The second transformation is closely related to the "exact hat" algebra pioneered by Dekle, Eaton, and
Kortum (2008) in the field of trade and considers a "normalized" system of equations around an observed
equilibrium. Suppose we observe a steady-state solution {yi,k }iS,k{1,.2} that satisfies:

                                                                            a11 a12
                                                    yi,1 =           Kij,1 yj, 1 yj,2
                                                             j
                                                                            a21 a22
                                                    yi,2 =           Kij,2 yj, 1 yj,2 .
                                                             j

We are interested in knowing whether there exists a different steady-state solution {xi,k }iS,k{1,.2} that also

  43
       This follows because exp ((-D + AD) ln ) = exp ((- (I - A) D) ln ) = .


                                                                     67
satisfies the same equations:

                                               xi,1 =       Kij,1 xa 11 a12
                                                                   j,1 xj,2
                                                        j

                                               xi,2 =       Kij,2 xa 21 a22
                                                                   j,1 xj,2
                                                        j

               xi,k
Define zi,k    yi,k   and note that the previous equations can be written as:

                                                                   a11 a12
                                               zi,1 =       Fij,1 zj, 1 zj,2                            (A.18)
                                                        j
                                                                   a21 a22
                                               zi,2 =       Fij,2 zj, 1 zj,2 ,                          (A.19)
                                                        j

                 K   ak 1 ak 2
where Fij,k  yij,k
                i,k
                    yj, 1 yj,2 . By construction, note that zi,k = 1 is a solution to this system of equations.
Moreover, the matrices Fk are stochastic, i.e.:

                                           Fij,k = 1 i  {1, ..., N } k  {1, 2} .
                                       j

In what follows, we will search for stochastic matrices Fk that have two solutions: one in which zi,k = 1 for
all i  {1, .., N } and k  {1, 2} and another in which there exists a zi,k = 1.
     It turns out to do this requires N = 4. Choose any mk < 1 < Mk for k  {1, 2}. Then we will construct
a set of kernels that have the following solution:
                                          1{a11 >0} 1{a11 0}             1{a >0}  1{a 0}
                                                                                          
                                               m1        M1        ; m2 12       M2 12
                          A
                                     ~A
           
              z1,1 z1,2        m
                               ~1 m   2
                                B                1{a >0}  1{a 0}         1{a >0}  1{a 0} 
           z2,1 z2,2  m
                         = ~1       m~B
                                      2 
                                             m1 21       M1 21     ; m2 22       M2 22
                                          =                                                 .         (A.20)
                                                                                          
           z3,1 z3,2  m        ~C   m~C  m1{a11 0} M 1{a11 >0} ; m1{a12 0} M 1{a12 >0} 
                                             
                                1     2          1        1              2        2
                                                                                          
              z4,1 z4,2       m~D
                                1   m~D
                                      2
                                                 1{a 0}
                                               m 21
                                                          1{a >0}
                                                         M 21      ; m 22
                                                                         1{a 0}   1{a >0}
                                                                                 M 22
                                                    1             1              2   2

Before constructing the kernel, we note the following helpful properties.
                          ln m1             ln M1
    First, define ln m           , ln M             , and the indicator matrix
                          ln m2             ln M2

                                                1 {a11 > 0} 1 {a12 > 0}
                                           P
                                                1 {a21 > 0} 1 {a22 > 0}

                              1   1
(for "positive"); and E             . Then note that we can bound m and M as follows:
                              1   1

        (A  P) ln m + (A  (E-P)) ln M  ln m  ln M  (A  (1-P)) ln m + (A  P) ln M 
       (A  P) ln m + (A - (AP)) ln M  ln m  ln M  (A - (AP)) ln m + (A  P) ln M 
         A ln M - (A  P) (ln M - ln m)  ln m  ln M  A ln m + (AP) (ln M - ln m) 
            ln B - (A  P) (ln M - ln m)  ln m  ln M  ln b + (AP) (ln M - ln m) 
                             ln B - ln D  ln m  ln M  ln b + ln D,                               (A.21)
                                                                             
                                              a11 1{a11 >0}    a12 1{a12 >0}
                                           M1               M2
                                      ln m1                 m2
where ln D  (A  P) (ln M - ln m) =                             a22 1{a22 >0}  and Dk  exp ((ln D)k ).
                                                                             
                                              a21 1{a21 >0}
                                           M1               M2
                                        ln m1               m2
    Second, we note the existence and uniqueness of weights that can be used to relate the m  ~nk (n 
{A, B, C, D}) variables to other endogenous objects. In what follows, we define those weights for m ~Ak,
                                             B     C         D               A
but the corresponding results also hold for m
                                            ~k , m         ~ k . Since mk  m
                                                 ~ k , and m               ~ k  Mk , then there exists a


                                                            68
        A
weight Ck  [0, 1] such that:
                                                   ~A
                                                   m     A           A
                                                    k = Ck mk + 1 - Ck Mk

and there exists a weight cA
                           k  [0, 1] such that:

                                            ~A
                                         ln m      A              A
                                              k = ck ln mk + 1 - ck ln Mk 
                                                       cA       1-cA
                                             ~A
                                             m k = mk Mk
                                                     k             k
                                                                            
                                                                       -cA
                                                             Mk          k

                                             ~A
                                             m k   = Mk                          ,                                                           (A.22)
                                                             mk

or conversely:
                                                                                     1-cA
                                                                         Mk             k

                                                     ~A
                                                     mk     = mk                            .                                                (A.23)
                                                                         mk
                                          -cA
                                            k
                                    Mk
                  ~A
Note that because mk = Mk           mk             from equation (A.22) we can write:

                                                                         a11                                    a12
                                                                -cA                                  -cA
                      a11         a12                  M1         1
                                                                                            M2         2

                   ~A
                   m1         ~A
                              m 2        =     M1                                    M2                               
                                                       m1                                   m2
                                                                             a11      -cA
                                                                                        1                  a12       -cA
                                                                                                                       2
                      a11         a12         a11  a12            M1                                M2
                   ~A
                   m1         ~A
                              m 2        =   M1   M2                                                                       
                                                                  m1                                m2
                                                                      a11    -cA
                                                                               1                    a12    -cA
                                                                                                             2
                      a11         a12      B1               M1                              M2
                   ~A
                   m1         ~A
                              m 2        =    D1                                                                      
                                           D1               m1                              m2
                                                                a11     1{a11 >0}-cA
                                                                                   1                        a12       1{a12 >0}-cA
                                                                                                                                 2
                      a11         a12      B1          M1                                           M2
                   ~A
                   m1         ~A
                              m 2        =                                                                                           .       (A.24)
                                           D1          m1                                           m2

Similarly, we have:
                                                                a21     1{a21 >0}-cA
                                                                                   1                           a22    1{a22 >0}-cA
                                                                                                                                 2
                      a21         a22      B2          M1                                           M2
                   ~A
                   m1         ~A
                              m 2        =                                                                                           .       (A.25)
                                           D2          m1                                           m2

                                  1-cA
                                     k
                            Mk
            ~A
    Because mk = mk         mk           from equation (A.23) we can write:

                                                                a11                                       a12
                                              1-cA                                       1-cA
             a11      a12                 M1 ( 1 )                                   M2 ( 2 )
         ~A
         m 1       ~A
                   m2         =    m1                                   m2                                       
                                          m1                                         m2
                                                            a         (1-cA
                                                                          1 )                   a        (1-cA
                                                                                                             2 )
             a11      a12                            M1 11                              M2 12
         ~A
         m 1       ~A
                   m2         =   ma
                                   1 m2
                                    11 a12
                                                                                                                      
                                                     m1                                 m2
                                                            A                                A
                                                    a11 (1-c1 )                      a12 (1-c2 )
                                             M1                             M2
             a11       a12                   m1                             m2
         ~A
         m 1       ~A
                   m 2        = b1 D1                                                                 
                                                               D1
                                                     a11    (1-cA
                                                                1 )-1{a11 >0}                            a12     (1-cA
                                                                                                                     2 )-1{a12 >0}
             a11       a12                    M1                                                M2
         ~A
         m 1       ~A
                   m 2        = b1 D1                                                                                                    ,   (A.26)
                                              m1                                                m2

and similarly:

                                                      a21   (1-cA
                                                                1 )-1{a11 >0}                             a12     (1-cA
                                                                                                                      2 )-1{a12 >0}
             a21        a22                   M1                                                 M2
          ~A
          m1        ~A
                    m 2       = b2 D2                                                                                                        (A.27)
                                              m1                                                 m2



                                                                      69
As a result, the system of equations (A.18) and (A.19) becomes:

                                                   a11    1{a11 >0}-cB
                                                                     1                    a12    1{a12 >0}-cB
                                                                                                            2
                       B1         B1        M1                                   M2
          ~A
          m1    =F11,1    + F12,1
                       D1         D1        m1                                   m2
                                                           a11       (1-cD
                                                                         1 )-1{a11 >0}                    a12    (1-cD
                                                                                                                     2 )-1{a12 >0}
                                                    M1                                            M2
                  + F13,1 b1 D1 + F14,1 b1 D1
                                                    m1                                            m2


                                                   a11    1{a11 >0}-cB
                                                                     1                    a12    1{a12 >0}-cB
                                                                                                            2
                       B1         B1        M1                                   M2
          ~B
          m1    =F21,1    + F22,1
                       D1         D1        m1                                   m2
                                                           a11       (1-cD
                                                                         1 )-1{a11 >0}                    a12    (1-cD
                                                                                                                     2 )-1{a12 >0}
                                                    M1                                            M2
                  + F23,1 b1 D1 + F24,1 b1 D1
                                                    m1                                            m2


                                                   a11    1{a11 >0}-cB
                                                                     1                    a12    1{a12 >0}-cB
                                                                                                            2
                       B1         B1        M1                                   M2
          ~C
          m1    =F31,1    + F32,1
                       D1         D1        m1                                   m2
                                                           a11       (1-cD
                                                                         1 )-1{a11 >0}                    a12    (1-cD
                                                                                                                     2 )-1{a12 >0}
                                                    M1                                            M2
                  + F33,1 b1 D1 + F34,1 b1 D1
                                                    m1                                            m2


                                                   a11    1{a11 >0}-cB
                                                                     1                    a12    1{a12 >0}-cB
                                                                                                            2
                       B1         B1        M1                                   M2
          ~D
          m 1   =F41,1    + F42,1
                       D1         D1        m1                                   m2
                                                           a11       (1-cD
                                                                         1 )-1{a11 >0}                    a12    (1-cD
                                                                                                                     2 )-1{a12 >0}
                                                    M1                                            M2
                  + F43,1 b1 D1 + F44,1 b1 D1
                                                    m1                                            m2


                              a21   1{a21 >0}-cA                 a      1{a
                                                                       22      >0}-cA
                B2       M1                    1
                                                         M2 22                      2

   ~A
   m2    =F11,2
                D2       m1                              m2
                                                  a21    (1-cC
                                                             1 )-1{a11 >0}                      a12    (1-cC
                                                                                                           2 )-1{a12 >0}
                   B2                      M1                                       M2
           + F12,2    + F13,2 b2 D2                                                                                        + F14,2 b2 D2
                   D2                      m1                                       m2


                              a21   1{a21 >0}-cA                 a      1{a
                                                                       22      >0}-cA
                B2       M1                    1
                                                         M2 22                      2

   ~B
   m 2   =F21,2
                D2       m1                              m2
                                                  a21    (1-cC
                                                             1 )-1{a11 >0}                      a12    (1-cC
                                                                                                           2 )-1{a12 >0}
                   B2                      M1                                       M2
           + F22,2    + F23,2 b2 D2                                                                                        + F24,2 b2 D2
                   D2                      m1                                       m2


                                     a21   1{a21 >0}-cA
                                                      1                  a22   1{a22 >0}-cA
                                                                                          2
                       B2      M1                                M2                                             B2
          ~C
          m 2   =F31,2                                                                                + F32,2
                       D2      m1                                m2                                             D2
                                           a21   (1-cC
                                                     1 )-1{a11 >0}                  a12     (1-cC
                                                                                                2 )-1{a12 >0}
                                    M1                                         M2
                  + F33,2 b2 D2                                                                                      + F34,2 b2 D2
                                    m1                                         m2




                                                                 70
                              a21   1{a21 >0}-cA          a     1{a22 >0}-cA
              B2         M1                    1
                                                     M2 22                 2

  ~D
  m2   =F41,2
              D2         m1                          m2
                                               a21   (1-cC
                                                         1 )-1{a11 >0}          a12   (1-cC
                                                                                          2 )-1{a12 >0}
                     B2                   M1                              M2
           + F42,2      + F43,2 b2 D2                                                                     + F44,2 b2 D2 .
                     D2                   m1                              m2

   We now move on to constructing the kernel. Note that given the inequality (A.21), there exist constants
Pk  (0, 1) and Qk  (0, 1) such that:

                                                       Bk
                                            mk = Pk       + (1 - Pk ) bk Dk                                         (A.28)
                                                       Dk
                                                       Bk
                                            Mk = Qk       + (1 - Qk ) bk Dk .                                       (A.29)
                                                       Dk
                                                        ~A
Combining the last two results (where again we focus on m                                 ~B
                                                          k , but the following holds for m   ~C
                                                                                           k, m         ~D
                                                                                                k , and mk
as well) note that:
                                      m~A     A
                                        k = Ck mk + 1 - Ck Mk
                                                              A


and
                                                       Bk
                                            mk = Pk       + (1 - Pk ) bk Dk
                                                       Dk
                                                       Bk
                                            Mk = Qk       + (1 - Qk ) bk Dk
                                                       Dk
so that:
                               Bk                                    Bk
              ~A
              m     A
               k = Ck Pk          + (1 - Pk ) bk Dk + 1 - Ck A
                                                                 Qk     + (1 - Qk ) bk Dk 
                               Dk                                    Dk
                                                  Bk
              ~A
              mk =
                          A
                         Ck Pk + 1 - CkA
                                          Qk            A
                                                     + Ck (1 - Pk ) + 1 - CkA
                                                                              (1 - Qk ) bk Dk .
                                                  Dk
Moreover, noting that:
                          A           A                 A                  A
                         Ck Pk + 1 - Ck Qk           + Ck (1 - Pk ) + 1 - Ck (1 - Qk ) = 1,
                                                               Bk
we know that m~A                                                                                  A
                k can also be written as weighted average of Dk and bk Dk , with the weight being k 
   A             A
 Ck  Pk + 1 - Ck    Qk .
   With all of these properties established, we have enough information to define our kernels:
                                              A             A
                                                                  
                                               1 0 1 - 1        0
                                                B           B
                                             1      0 1 - 1     0
                                       F1 =     C           C
                                                                  
                                             1      0 1 - 1 0
                                                D           D
                                               1    0 1 - 1     0
                                                   A           A
                                                                 
                                              0 2      0 1 - 2
                                                   B           B
                                             0 2       0 1 - 2
                                       F2 =        C           C .
                                                                 
                                             0 2       0 1 - 2
                                                   D           D
                                              0 2      0 1 - 2
Note that the zi,k = 1 for all i  {1, .., 4} and k  {1, 2} trivially satisfies the equilibrium system. But it
is also straightforward to confirm that the proposed solution (A.20) is also an equilibrium. This is because
                                 Bk
every equation has a term of D     k
                                      and (bk Dk ), which we know every endogenous variable is a weighted
average of (see equations (A.28) and (A.29)).
     Finally, we mention that there are many geographies that deliver this multiplicity for two reasons. First,
the argument above holds for any choice of mk < 1 < Mk . Second, it is straightforward to show that
perturbations of the above kernel also generate multiple equilibria. Suppose we considered the perturbed


                                                           71
system of equations:                     A                      A
                                                                                                            
                                        1 -                 1 - 1 - (1 - )                         (1 -  ) 
                                           B                         B
                                         1                 0    1 - 1                                  0    
                                   F1 =    C                         C
                                                                                                            ,
                                         1                 0    1 - 1                                  0    
                                           D                         D
                                          1                0    1 - 1                                  0
                                                                                 A                         A
where  > 0,   [0, 1] and   [0, 1]. The only restriction we place is that 1         -  > 0   < 1               and
       A                                           A
 1 - 1 - (1 - )  > 0   (1 - ) < 1 - 1 . Note that both of these equations will hold for sufficiently
             A       l              l
small , as k   = Ck    Pk + 1 - Ck    Qk and Pk  (0, 1) and Qk  (0, 1). In what follows, we show for any
choice of  > 0 (that is sufficiently small to satisfy these inequalities) and any choice of   [0, 1], there exists
a   [0, 1] that ensures the multiplicity still holds.
    Then the relevant equation becomes:
                                                                                      a11    1{a11 >0}-cB
                                                                                                        1                     a12   1{a12 >0}-cB
                                                                                                                                               2
                            A B1               B1                   B1         M1                                      M2
                     ~A
                     m 1   =1         -               + 
                              D1               D1                   D1         m1                                      m2
                                                                                                                       a11   (1-cD
                                                                                                                                 1 )-1{a11 >0}
                                       A                                                                  M1
                             + 1-      1     b1 D1 - (1 - ) b1 D1 + (1 -  ) b1 D1
                                                                                                          m1
                                         a   (1-cD
                                                 2 )-1{a12 >0}
                                      M2 12
                             +                                 
                                      m2
       B1                             B1             1
          + (1 - ) b1 D1 =               G + (1 -  ) (b1 D1 )
       D1                             D1             G
                      a11 1{a11 >0}-1{a21 >0}                   a12 1{a12 >0}-1{a22 >0}
                M1                                      M2
where G         m1                                      m2                                        . Recall that

                                                                      a11  a12
                                             B1                      M1   M2
                                                =             a11 1{a11 >0}              a12 1{a12 >0}
                                             D1       M1                         M2
                                                      m1                         m2

                                                                     a11 1{a11 >0}                a12 1{a12 >0}
                                                              M1                            M2
                                   b1 D1 = ma
                                            1 m2
                                             11 a12
                                                                                                                   ,
                                                              m1                            m2
i.e. B1 /D1 is always the lowest that can be achieved given the signs of the exponents, and b1 D1 is the highest
that can be achieved given the signs of the exponents. As a result, we have:
                           a11    1{a11 >0}-1{a21 >0}                    a12   1{a12 >0}-1{a22 >0}                              a11  a12
       B1        M1                                           M2                                                               M1   M2
G           =                                                                                            ×              a11 1{a11 >0}        a12 1{a12 >0}
                                                                                                                                                             
       D1        m1                                           m2                                             M1                         M2
                                                                                                             m1                         m2
                                  a11  a12
       B1                        M1   M2
G           =         a11 1{a21 >0}           a12 1{a22 >0}
       D1       M1                      M2
                m1                      m2

and
                                                                     a11 1{a11 >0}               a12 1{a12 >0}
                 1                            ma
                                               1 m2
                                                 11 a12       M1
                                                              m1
                                                                                         M2
                                                                                         m2
                   (b1 D1 ) =                 a11 1{a11 >0}-1{a21 >0}                       a12 1{a12 >0}-1{a22 >0}
                                                                                                                              
                 G                      M1                                          M2
                                        m1                                          m2
                                                              a11    1{a21 >0}                   a12   1{a22 >0}
                 1                                   M1                                  M2
                   (b1 D1 ) = ma
                               1 m2
                                 11 a12
                                                                                                                   .
                 G                                   m1                                  m2




                                                                         72
Together these statements imply that:

                                    B1            B1          1
                                       G                  ,     (b1 D1 )  b1 D1 ,
                                    D1            D1          G

since B1 /D1 and b1 D1 are designed to be the lowest and highest (respectively) given the signs of the expo-
nents. As a result, there exist constants (weights) 1  [0, 1] and 2  [0, 1] such that:

                                            B1           B1
                                    G            = 1        + (1 - 1 ) b1 D1
                                            D1           D1

                                    1              B1
                                      (b1 D1 ) = 2    + (1 - 2 ) b1 D1 .
                                    G              D1
We now return to the above equation:

         B1                   B1                 1
            + (1 - ) b1 D1 =        G + (1 -  ) (b1 D1 ) 
         D1                   D1                 G
         B1                      B1                                  B1
            + (1 - ) b1 D1 =  1      + (1 - 1 ) b1 D1 + (1 -  ) 2        + (1 - 2 ) b1 D1             
         D1                      D1                                  D1
         B1                                   B1
            + (1 - ) b1 D1 = (1 + (1 -  ) 2 )     + ( (1 - 1 ) + (1 -  ) (1 - 2 )) b1 D1 .               (A.30)
         D1                                   D1

Choose   1 + (1 -  ) 2 . Then

                                1 -  = 1 - 1 - (1 -  ) 2 
                                1 -  = 1 +  -  - 1 - (1 -  ) 2 
                                1 -  =  (1 - 1 ) + (1 -  ) (1 - 2 ) ,

so that equation (A.30) holds. Hence, for any choice of  , we can find a  that ensures the equilibrium still
holds. Note that there is nothing in this argument that is particular to m~A
                                                                           1 . As a result, we can construct
examples of multiple equilibria of the form:
                          A
                           1 - A     A     A A         A
                                                         - 1 - A      A          A
                                                                                    A
                                                                                        
                                   1 1 ;  1  1 ; 1 - 1            1 1 ;     1 - 1     1
                            B
                          1    - B   B
                                   1 1 ;  1B B
                                              1 ; 1 - 1B
                                                         - 1 - B      B
                                                                  1 1 ;     1 - 1B
                                                                                    B 1 
                                                                                        
                   F1 =     C      C C     C  C        C          C   C
                          1 - 1 1 ; 1 1 ; 1 - 1 - 1 - 1 1 ;                 1 -  1 C
                                                                                 C
                                                                                      1
                                                                                        
                            D
                           1   - D   
                                   1 1
                                      D
                                        ;  D D
                                             
                                           1 1  ; 1 -  D
                                                       1 -   1 -  D
                                                                  1   D
                                                                      1 ;   1 -  D
                                                                                 1    D
                                                                                      1

                        A A   A
                                - A A                       A
                                                                   A          A
                                                                                        1 - A   A
                                                                                                  
                        2 2 ; 2   2 2 ;                 1 - 2      2      1 - 2 -           2   2
                        2 2 ; 2 - 2 B
                        B B   B   B
                                     2 ;
                                                            B
                                                        1 - 2      B
                                                                   2
                                                                              B
                                                                          1 - 2 -       1 - B
                                                                                            2   B
                                                                                                2 
                                                                                                  
                  F2 =  C C   C                                                                   ,
                        2 2 ; 2 - C  C
                                  2 2;
                                                            C
                                                        1 - 2      C
                                                                   2
                                                                              C
                                                                          1 - 2 -       1 - C
                                                                                            2   C
                                                                                                2
                        D D   D
                       2  2 ; 2 - D  D
                                  2 2 ;
                                                            D
                                                        1 - 2      D
                                                                   2
                                                                              D
                                                                          1 - 2 -       1 - D
                                                                                            2
                                                                                                D
                                                                                                2
for many different chosen values of l     l
                                    k and k .



A.4      Proof of Proposition 4
The steady-state system of equations we would like to examine can be written as:
                                                              -
                                        Li Wi- = 2                     Mij Wj                            (A.31)
                                                                   j



                                        1                                           1
                                                                                        a
                                                                       -( -1)~
                                                                             
                               Wi~
                                   Lip       =         Bi Tij Cj Wj               p
                                                                                 Lj         ,            (A.32)
                                                 j S




                                                          73
           1-              ( -1)~
                                                                     ( -1)~
                                                                                                                                                              -1
where Tij  ij       ¯
              , Bi  Ai            ¯i
                                  u ~
                                      ,         ¯
                                            Cj  A ~
                                                 j u¯j                               , Mij  µ- 
                                                                                                       (1 - (1 + 2 ) ( - 1) -  (1 + 2 )))
                                                                                             ij , p  (~                                                            ,
           (1+(1 +2 ) +(1 +2 )( -1))                                 a-1 1
and a      (1-(1 +2 )( -1)- (1 +2 )) .       Note that                p  -1 =                (1 + 2 + 1 + 2 ).
                                                                         1   1
    In what follows, we will assume  > max                                 - -
                                                            and a  (0, 1). In addition, we have the labor
                                                                      0,       1
                                       ¯
market clearing constraint i Li = L. Our goal is to provide bounds on . Since  > 0, it suffices (and
is a little less notation-heavy) to find bounds on 2 . In what follows, we refer to equation (A.31) as the
"migration equation" and equation (A.32) as the "trade equation".
    Before continuing with the proof, we remind the reader of a number of helpful mathematical properties.
                           1
Define x p  ( i xp      i ) . (With some abuse of terminology, we refer to x p as the "p-norm of x", even
                           p

though it is formally a norm only if p  1). First, we remind the reader of the relationship between different
p norms. For any 0 < p < q , we have the convenient relationship:

                                                                      x      q    x         p   .                                                    (A.33)

More generally, for any p < q , we have:
                                        1    1                                                             1   1
                                       N q-p x           p    x          q    C (p, q, µ) N q - p x                      p   ,                       (A.34)
                                        1                               1
                             q   p                   p       q         -p
                        (µ -µ )       q (µ -µ )
                                        q
where C (p, q, µ)  (qp -p)(µp -1)   (p-q )(µq -1) , and µ  max    i xi
                                                               mini xi . Note that C (p, q, 1) = 1. The first
inequality is the well known generalized mean inequality, whereas the second inequality is due to the less
known result originally due to Specht (1960) and reprinted (in English) in the textbook by Mitrinovic and
Vasic (1970) (see Theorem 1 on p. 79).
    Second, recall the Cauchy­Schwarz inequality that for any N × 1 vectors x  [xi ] and y  [yi ], we have:
                                                     1                           1
                                                     2                           2

                          |xi yi |           x2
                                              i
                                                                      2
                                                                     yi                             {xi yi }   1    {xi }        2   {yi }   2   .
                      i                 i                        i

Third, recall that the matrix norm induced by the vector p-norm for square matrix A is defined as A                                                    p   
         Ax p
sup      x p |x
              = 0 . Moreover, if A is real and symmetric then A 2 =  (A), i.e. the spectral radius of A.
   Fourth, recall that for any N × N real symmetric matrix A and any N × 1 vector x we have the following
quadratic form inequality:
                                            x Ax   (A) x 2 ,
where the inequality is strict when x is the eigenvector associated with the largest eigenvalue.

A.4.1       Lemma
We now offer a lemma which provides a bound on the maximum of the ratio of the highest and lowest welfare
and population across locations. This lemma is necessary in defining the constants c1 and c2 mentioned in
the proposition.

Lemma 1. In any steady-state equilibrium, we can bound the ratio of the maximum to minimum period
ex-post welfare by:
                                           maxiS Wi
                                       1              µW ,                                 (A.35)
                                           miniS Wi
where:                                           u                   A                                 p                             
                                        u
                                        ¯i               ¯i
                                                         A                               Tki                                 Mik
                       µW  max                           ¯j                  max                                   max                       ,
                                 i,j    u
                                        ¯j               A                           k   Tkj                        k        Mjk
                                                                         2
                    ( -1)/
and u  /   2 , A      2    , P    ~ /       /      1              
                                   2 ,   2 -  , and 2  1 +  - ((1 + 2 ) ( - 1) + (1 + 2 )  ),
               2 -1
and recall ~  -1 . Similarly, we can bound the ratio of the maximum to minimum period ex-post welfare,




                                                                                 74
inclusive of the idiosyncratic component, by:
                                                                             1
                                                                            -
                                                              max Wi Li
                                                     1                      -1    µW L ,                                       (A.36)
                                                              min Wi Li

where:                                                                                  1
                                                                             Mi,k       
                                                      µW L  max                             .
                                                                    i,j,k    Mj,k

Proof. The proof relies on two relationships that hold in steady-state. From the labor market clearing
conditions, we have:
                                              Wi   i  Li ,                                      (A.37)
where i          k
                          
                     Mik Wk . Similarly, noting that -
                                                     i
                                                       1
                                                         = i in the steady-state, we have from equation (20):
                                            ¯i - (2 - 1) ln Pi +  ln i + (2 ( - 1) + 2  ) ln Li ,
                             ¯i + ( - 1) ln A
            ln Li = C1 +  ln u
                           
where, recall,   1 +          - (1 ( - 1) + 1  ). Combining these two equations and solving for ln Wi yields:

                               ln Wi = u ln u         ¯i + P ln P 1- +  ln 
                                            ¯i + A ln A                    i + C,                                              (A.38)
                                                                 i

                                                                             1-
for some constant C . We now show that we can bound the difference in i and Pi  across locations. Note
that for any i and j we have:
                                                        
                                        i        k Mik Wk                         Mjk Wk
                                                                                                    Mik
                                          =               =                                             .
                                        j
                                                        
                                                 k Mjk Wk               k         l Mjl Wl
                                                                                                    Mjk

                                                                              
                                              Mik                      Mjk Wk
That is,   i
           
               is a weighted average of       Mjk ,      as     k        M    W         = 1. This in turn implies that for all i and j
           j                                                           l   jl   l
we have:
                                                          Mik         Mik
                                                 min           i  max                                                          (A.39)
                                                     k    Mjk  j   k  Mjk

Similarly, for any i and j we have:
                                                          Tki P 1-      Tki
                                                 min           i1-  max     .                                                  (A.40)
                                                  k       Tkj Pj     k Tkj

    Equation (A.38) implies:
                                                                             A         -        P             
                           maxi Wi          u
                                            ¯ imax
                                                         u      ¯i
                                                                A max
                                                                                    Pi1
                                                                                      
                                                                                      max             i
                                                                                                       max
                                   =                            ¯i                      -                         ,
                           minj Wj          u
                                            ¯ imin
                                                                A   min
                                                                                    Pi1
                                                                                                      i
                                                                                                      
                                                                                                        min
                                                                                         min


where imax
       W    arg maxi Wi and imin
                             W    arg mini Wi . Combining this with equations (A.39) and (A.40), we
have:
           maxi Wi           ¯i u A
                             u
                                     ¯i A          Tki p
                                                        
                                                                     Mik 
                                                                           
                    max              ¯j      max              max                 µW ,
           minj Wj    i,j    u
                             ¯j     A           k  Tkj          k    Mjk
as claimed.
    Similarly, combining (the log of) equation (A.37) and applying the inequality from (A.39) yields:
                                1
                               -
                       ln Wi Li     = ln i + C2 =
                               1                                                    1
                              -                                                                               1
                 maxi Wi Li               imax                    Mimax
                                                                    WL k
                                                                                                  Mik         

                              -1           WL
                                                              max                       = max max                  µW L ,
                  mini Wi Li              imin
                                           WL
                                                               k  Mimin
                                                                    WL k
                                                                                           i,j k Mjk


                                    1
                                   -                                         -1
where imax
       W L  arg maxi Wi Li              and imin
                                             W L  arg mini Wi Li , as required.
                                                                




                                                                       75
A.4.2     The upper bound
We now proceed by constructing the upper bound. The proof proceeds by first constructing an upper
bound for steady-state welfare as a function of the norm of the period ex-post welfare using the migration
equation. The proof then constructs an upper bound for the norm of the period ex-post welfare using the
trade equation. Given the lemma above, combining the two results yields the stated bound immediately.

The migration equation: Using the fact that the quadratic form of a matrix is bounded above by
the product of its largest eigenvalue and the norm of its eigenvector along with the labor market clearing
condition, we have, starting with the migration equation (A.31):
                                                
                                        2          Li Wi- =                     Mij Wj 
                                                                        j
                                                      2 
                                                           Li = Wi                   Mij Wj =
                                                                                j
                                               2 
                                                           Li =                 Wi              Mij Wj =
                                                      i                 i               j

                                                                   (M)
                                                      2             ¯ × Wi
                                                                           
                                                                                                     2
                                                                                                            
                                                                    L
                                                                      1  1
                                                          2       ¯ - 
                                                                  L     ¯ W                                 .                         (A.41)
                                                                         M                              2

where ¯ M is the largest eigenvalue of M. Because M is positive, this is also the spectral radius of M.

                                                                                                                                      1
                                                                                                                                          a
The trade equation: Turning to the trade equation (A.32), we define xi  Ci Wi-(-1)~
                                                                                  
                                                                                    Li                                                        so
that:
                                            1                                                                   1
                                                                                                                        a
                                                                                     -( -1)~
                                                                                           
                                 Wi~
                                     Lip            =            Bi Tij Cj Wj                             p
                                                                                                         Lj                 
                                                          j S
                                                                 x i Bi
                                                xi =                        1
                                                                                        Tij xj 
                                                          Wi~          Li   
                                                                                 j S

                                                                        a-1
                                                xi = Wi1- Li p Bi Ci                               Tij xj .
                                                                                            j S

We then sum both sides over i:
                                                   a-1
                             xi = Wi1- Li p Bi Ci                         Tij xj =
                                                                  j S
                                                                                                 
                                                           a-1
                             xi =       Wi1- Li             p
                                                                   Bi C i            Tij xj  =
                         i          i                                           j

                                                                                            1
                                                                                                                               2  1
                                                                                                                                  2
                                                                 a-1                2       2

                             xi                 Wi1- Li           p
                                                                       Bi Ci                                            Tij xj   =
                                                                                                                                 
                                                                                                
                         i              i                                                           i               j

                             1                                                              1
                                                                                                                               2  1
                                                                                                                                  2
                             2
                                                                 a-1                2       2

                        x2                      Wi1- Li           p
                                                                       Bi Ci                                            Tij xj   =
                                                                                                                                 
                         i                                                                      
                    i                   i                                                           i               j




                                                                            76
                                                                                                                                    1
                                                                                                                            2       2
                                                                      1
                                             a-1                2     2                        i        j   Tij xj
                    1             Wi1- Li p Bi Ci                             sup                                   1                   
                            i                                             {xi 0}                   (        i x)
                                                                                                                 2

                                                                      1
                                             a-1                2     2

                    1             Wi1- Li     p
                                                     Bi Ci                 (T) =
                            i
                                        a-1
                    1            Wi1- Li p Bi Ci                (T) =
                            i
                                                 1                                             1
                                                 2
                                                                     a-1                  2    2
                                      2
                    1            Wi1-                            Li   p
                                                                              Bi Ci                 (T) ,
                            i                             i

where the third line uses the Cauchy-Schwartz inequality, the fourth line uses the fact that x 2  x 1 , the
fifth line takes the supremum across all possible vectors x, the sixth line notes that this is the definition of
a matrix norm, the seventh line uses the fact (again) that x 2  x 1 , and the eighth line uses (again) the
Cauchy-Schwartz inequality. Continuing, we have:

                                                                                    1
                           1                                                   1    -
                         - - 1                                            2    2
                                                                                      1
                                                     a-1                                                    1
                Wi1-                             Li   p
                                                              Bi Ci                            (T) -1 
            i                           i
                                                                                                       1
                                                                                                   1   -1
                                                                                               2
                                                                          a-1
                                                                                                   2
                                  ¯    a-1                      Li         p                                   1
                    W   2(1- )    L     p    
                                                                ¯                  Bi C i                  (T) -1 
                                                                L
                                                                                                     
                                                     i
                                                                                                       1
                                                                                                   1   -1
                                                                                               2
                                                                          a-1
                                                                                                   2
                                   ¯ a- 1                       Li         p                                   1
                    W   2(1- )    L   p   
                                                                ¯                  Bi C i                  (T) -1 
                                                                L
                                                                                                     
                                                     i
                                                                                                                            1 1
                                                                                                                        2
                                                                                                            a-1
                                                                                                                            2  -1
                                                                     1
                                 ¯  × max Bi Ci                      -1                            Li        p                              1
                    W   2(1- )   L                                            ×                    ¯
                                                                                                                                         (T) -1 
                                                 i
                                                                                      i
                                                                                                   L
                                                                                                        
                                   ¯      ¯i u                                Li                                                1
                    W   2(1- )    L × max A  ¯i ×                             ¯                             ×  (T) -1 
                                             i                                L       2( -1)

                                                                          1-2( -1)            1{< 2(1
                                                                                                    -1) }                               1
                    W            L        ¯i u
                                 ¯  × max A  ¯i × N                         2( -1)                                      ×  (T) -1                  (A.42)
                        2(1- )               i

where the second line uses the fact that x 2  x 1 and rearranges, the third line uses the norm notation
(and multiplies and divides by the aggregate labor), the fourth line bounds the effect of the local geography
based on the best location, the fifth line rearranges, and the final line uses the relationships between different
norms mentioned at the beginning of the proof (and aggregate labor market clearing).

The bound: Recall from equation (A.34) that because (1 - ) < , we have:

                                                          cN 2 (  + -1 ) W
                                                                 1    1        1
                                        W        2                                             2(1- )           ,                                  (A.43)

where

                                                 c1  C (2 (1 -  ) , 2, µW )                                                                        (A.44)




                                                                      77
from equation (A.34), and µW is defined above in equation (A.35) from Lemma 1. Combining equation
(A.43) with the migration bound from equation (A.41) and the trade bound from equation (A.42) then
yields:
                          1     1                                                  1-2( -1)
                                                        × N 2 (  + -1 )+1{< 2(-1) } 2(-1) ,
                                                      1     1 1    1          1
              2  c ×    ¯ ×   ¯ -1 × max A¯i u    ¯ - 
                                             ¯i × L                                         (A.45)
                              M       T          i

as claimed.

A.4.3     The lower bound
We now proceed to prove the lower bound. As above, we first consider the migration equation and then
consider the trade equation.

                                                         -1
The migration equation: With some abuse of notation let Mij denote the {i, j }th element of M-1 .
Then:
                                      
                                  2       Li Wi- =             Mij Wj 
                                                           j
                                      2 -                       -1
                                                Wi   =         Mij Lj Wj- 
                                                           j
                                          2 -
                                                Li = Li Wi-              -1
                                                                        Mij Lj Wj- =
                                                                   j
                                           2 -
                                                 ¯=
                                                 L             Li Wi-         -1
                                                                             Mij Lj Wj- =
                                                           i             j
                                           2 -   ¯       ¯ M -1 Li W -
                                                 L                   i 2
                                                                                 
                                                              1      1
                                                         ¯ 1       -
                                                2        L    M Li Wi
                                                                     
                                                                                   ,                    (A.46)
                                                                              -2

where the second line inverts the linear equation, the third line multiplies both sides by the population, the
fourth line sums over all i and applies the labor market clearing condition, the fifth line uses the quadratic
form inequality where  ¯ M -1 denotes the largest eigenvalue (in absolute value) of M-1 , and the sixth line
                   ¯             -1
uses the fact that M -1 = (M ) , i.e. the largest eigenvalue (in absolute value) of M-1 is the inverse of
the smallest eigenvalue of M.

                                                             -1
The trade equation: Again, with some abuse of notation, let Tij denote the {i, j }th element of T-1 .
                       1
                 ~    
               Wi    Li
Defining yi       Bi       , inverting the linear system, and rearranging the trade equation (A.32) yields:

                                            1                                              1
                                                                                               a
                                                                         -( -1)~
                                                                               
                               Wi~
                                   Lip           =         Bi Tij Cj Wj                 p
                                                                                       Lj          
                                                     j S
                                           1
                               Wi~
                                   Lip                                                 1
                                                                                           a
                                                                       -( -1)~
                                                                                  p
                                                 =         Tij Cj Wj             Lj            
                                      Bi
                                                     j S




                                                                 78
                                                          yi                            -1
                                     yi =                               1
                                                                             a         Tij yj 
                                                 -( -1)~
                                                                        p        j S
                                            Ci Wi                      Li
                                                                   1
                                                      ~        p
                                                    Wi        Li

                                                          Bi                            -1
                                     yi =                               1
                                                                             a         Tij yj 
                                                 -( -1)~
                                                                        p        j S
                                          Ci Wi                        Li
                                                                 -1         -( -1)( a- 1    1    1
                                                                                                     )
                                                                                                         
                                                                                            -1 - 
                                                 1
                                                -                                    p
                                           Wi Li                        Li
                                                                                                                   -1
                                     yi =                                                                         Tij yj .
                                                                                                         
                                                                        Bi Ci
                                                                                                         
                                                                                                            j S


Proceeding similarly to the upper bound discussed above, we have:
                         
                                 -  1  -1 -( -1)(- 1 ) 
                                                   
                            W i L i       Li
                                                            -1
                   yi =                                    Tij yj =
                                                       
                                       Bi Ci
                                                       
                                                         j
                                      
                                                -1         -1       -( -1)(- 1
                                                                               )
                                                                                        
                                            Wi Li                  Li
                                                                                                     -1
                     yi =                                                                           Tij yj =
                                                                                 
                                                              Bi Ci
                                                                                        
                 i               i                                                          j

                                                                                                    1 
                                                                                     2 2                                        2  1
                                          
                                                   -1          -1       -( -1)(- 1
                                                                                   )                                               2
                                               Wi Li                   Li
                                                                                                                           -1  
                                                                                      
                     yi                                                                                                   Tij yj  =
                                                                                             
                                                                                                                
                                                                Bi Ci
                                                                                             
                 i                    i                                                                     i         j

                                                                                                    1 
                                                                                     2 2                                        2  1
                                
                         1
                                          
                                                   -1          -1       -( -1)(- 1
                                                                                   )                                               2
                         2                     Wi Li                   Li
                 2                                                                                                         -1  
                                                                                      
                yi                                                                                                        Tij yj  =
                                                                                             
                                                                                                                
                                                                Bi Ci
                                                                                             
            i                         i                                                                     i         j




                                                                                    1                                                1
                                                                                 2  2                                            2
                                                                                                                                     2
                              
                                         -1      -1    -( -1)(- 1
                                                                  )                                                      -1
                                     Wi Li            Li                                                    i         j Tij yj
            1                                                                         sup                                                
                                                                    
                                                                                                                             1
                                                  Bi Ci
                              
                                                                                                                  (      2 2
                                                                                                                      i yi )
                                                                                    {y 0}
                         i                                                                      i


                                                                                    1
                                                 -1                              2  2
                                         -1            -( -1)(- 1
                                                                  )
                                     Wi Li            Li                           
           T                                                                        =
                                                                    
                                                                                  
                                                  Bi Ci
                              
                         i

                             
                                          -1    -1    -( -1)(- 1
                                                                 )
                                                                              
                              Wi Li                  Li
           T                                                                   =
                                                                              
                                                Bi Ci
                             
                     i

                                                                                                        1
                                                               1                                     2  2
                                                          2    2               -( -1)(- 1
                                                                                          )
                                                 -1
                                                                              Li
                                           1
                                          -
           T                     Wi Li                                                                  =
                                                                                                       
                                                                                       Bi C i
                                                                   
                         i                                              i




                                                                                 79
                                                                        1                                           
                                                                2       2                 -( -1)(- 1
                                                                                                     )
                                                        -1
                   T 
                                             -1
                                         Wi Li                                        Li                             =
                               i                                             i
                                                                                                  Bi Ci
                                                                        1
                                                        -1      2       2
                                                                                                      -1
                                                -1                                                                             -( -1)(- 1
                                                                                                                                          )
                   T                     Wi Li                              × min Bi Ci                        ×           Li                     ,          (A.47)
                                                                                      i
                               i                                                                                    i

where the second line sums over i, the third line applies the Cauchy-Schwartz inequality, the fourth line
uses the fact that x 2  x 1 , the fifth line takes supremums, the sixth line combines the fact that the
spectral radius is equal to the matrix 2-norm when the matrix is real and symmetric and the fact that the
largest eigenvalue in absolute valueof T-1 is the smallest eigenvalue in magnitude of T (denoted by T ),
the seventh lines uses (again) the fact that x 2  x 1 , the eighth line uses (again) Cauchy-Schwartz,
                                                                                          -( -1)(- 1 )
                                                                                                   
                                                                                         Li
the ninth line uses (yet again) x 2  x 1 , and the tenth lines uses the fact that i         Bi Ci      

            -1          -( -1)(- 1
                                   )
(mini Bi Ci )      i   Li                 . Rearranging the last line yields:

                                                                                                                                                (- 1
                                                                                                                                                     )
                     -1
                                             1
                                             -1        ¯ (- 1
                                                              )           ¯i u                                     Li
                 Wi Li                T           ×L                × min A  ¯i ×                                  ¯                                     .
                            2( -1)                                               i                                 L       -( -1)(- 1
                                                                                                                                      )

                                   1    1                                                                       1
     Since we assume  > max 0,       - -  1 , we have - ( - 1)  -                                                       < 1, so that from the norm inequali-
ties referenced at the beginning of the proof:
                                                                                          1
                                     Li                                                               -1           Li
                                                                     N -(-1)(-  )
                                                                                                  1

                                     ¯                                                                             ¯            
                                     L          -( -1)(- 1
                                                           )                                                       L       1

                                                                                              1
                                     Li                                      -                            +1
                                                                    N                ( -1) - 1
                                                                                              (       )         ,
                                     ¯
                                     L          -( -1)(- 1
                                                           )

so that the inequality becomes:
                                    1                       1
                                   -                        ¯ (-   ) × min A  ¯i × N -(+ -1 -  ) .
                                                                 1                       1    1
                            Wi Li                       -1
                                                       T   ×L              ¯i u                                                                              (A.48)
                                         2( -1)                                                   i


The bound: Recall from equation (A.34) that because - < ( - 1), we have:
                                                                             1                                       1
                                                                            -                                       -
                                        N - 2 ( -1 +  ) c2 Wi Li
                                            1     1     1
                                                                                                    Wi Li                       ,                            (A.49)
                                                                                     2( -1)                               -2

where
                                                                                                           -1
                                                      c2  C (2 (1 -  ) , 2, µW L )                              ,                                            (A.50)

from equation (A.34) and µW L is defined above in equation (A.36) from Lemma 1. Combining equation
(A.46) from the migration bound with equation (A.48) from the trade bound then yields:
                                                        1           1
                                                     ¯i × N -(+ -1 + 2 ( -1 +  )) ,
                                                                                                                           1        1   1   1
                        2  c- 1 ¯
                            2 × L × M × T
                                         -1       ¯i u
                                            × min A                                                                                                          (A.51)
                                                                                      i

where   1 + 2 + 1 + 2 , as claimed.




                                                                                 80
A.5      Proof of Proposition 5
Note that the four equations can be considered as two distinct systems of two equations, where the two
systems of equations are:

                                     1-                              1- -1
                                    Pit =             Tijt × Yjt × (Pjt )
                                                  j
                                     1-                              1- -1
                                    Pit =             Tjit × Yjt × (Pit ) ,
                                                  j

and:

                                        -1                                    -1
                                   it        =        Mjit × Ljt-1 × jt
                                                  j

                                        it   =        Mijt × Ljt × jt .
                                                  j

The first system of equations can be written as:
                                                                   A -1
                                                 xi =             Kij yj
                                                          j
                                                                   B -1
                                                 yi =             Kij xj ,
                                                          j

which has a corresponding LHS matrix of coefficients:

                                                              1     0
                                                  B                   ,
                                                              0     1

and the matrix on the RHS coefficients becomes:
                                                          0 -1
                                                               .
                                                          -1 0

Hence, we have:
                                                                     0 -1
                                        A  B-1 =                          .
                                                                    -1 0
    The second system of equations can be written as:

                                                 x-
                                                  i
                                                    1
                                                      =             A -1
                                                                   Kij yj
                                                              j
                                                                    B
                                                  yi =             Kij xj ,
                                                              j

which has a corresponding LHS matrix of coefficients:

                                                              -1      0
                                                  B
                                                               0      1

and the matrix on the RHS coefficients becomes:
                                                          0 -1
                                                               .
                                                          1 0



                                                          81
Hence, we have:
                                                         0 -1
                                       A  B-1 =               .
                                                        -1 0
                                0   1
In both systems, we have Ap =         . It is then straightforward to check that  (Ap ) = 1, as required.
                                1   0




                                                   82
B        Online Appendix: Possible Microfoundations for Spillovers
Section 2 briefly discussed several microfoundations for the productivity and amenity spillover functions in
equations (1) and (3), respectively. This appendix elaborates.


B.1       Productivity spillovers
We formalize two models--based on the persistence of local knowledge and the durability of investments,
in turn--that provide examples of formal microfoundations for the productivity spillover function, Ait =
A¯it L1 L2 .
      it it-1


B.1.1     Microfoundation #1: persistence of local knowledge
We follow Deneckere and Judd (1992). Suppose that firms can pay a fixed cost fi (in terms of local labor)
to create a new variety, over which they have monopoly rights for one period (the period in which they
introduce the variety). In the subsequent period, the new variety exists but is produced under conditions
of perfect competition. In the following period (two periods after its introduction), we assume the variety
no longer exists (i.e. its value to consumers has fully depreciated). Finally, we assume that consumers
have Cobb-Douglas preferences (within locations) over the the new varieties and the old varieties, and CES
preferences across respectively.

Demand: Let new
            it  be the set of varieties created by monopolistically competitive firms in period t in
location i and old
               i,t be the set of varieties created in the previous period that are now produced under perfect
competition. We assume that consumers have the following preferences:

                                                                                                                  
                                                                                                        1-  - 1   -1
                      
                          ^                                           ^
                                                                                                            
                                                     -1                                            -1
                                            -1                                            -1                    
         Cjt =                   qijt ( )   
                                                 d                             qijt ( )   
                                                                                               d                     ,
                                                                                                                
                                                                                                           
                           new                                         old
                                                                                                                
                  i        it                                          it




where qijt ( ) is the quantity consumed in country j of variety  from location i. Hence,  is the elasticity
of substitution between varieties of a given type from a given location,  is the Cobb-Douglas share of the
CES composite of new varieties from a given location, and  is the elasticity of substitution of the aggregate
bundles (of new and old goods) across locations.
    Given these preferences, the quantity a consumer in location j in period t will demand from firm  in
location i can be written as:
                                                                                1-
                                                     1-      new      old 1-
                              -                    ijt    (Pit   ) (Pit  )
                                       new -1
                    p    (   )     ( P    )      ×                                 1- Yjt        if   new
                  
                   ijt
                                       it              1-      new  P old 1-                          it
                                                    k ijt   (Pkt   ) ( kt )
       qijt ( ) =                                           1-      new      old  1 -  1 -                  (B.1)
                                                          ijt    (Pit   ) (Pit   )
                                        -     old -1                                                  old
                  
                    (1 -   ) p ijt (  )     Pit      ×        1-      new  P old 1-
                                                                                          1- Yjt if   it
                                                                                                          ,
                                                                   (Pkt   ) ( kt )
                  
                                                           k ijt



where:
                                                           ^
                                         new       1-                          1-
                                       (Pit  )                      pijt ( )        d                                    (B.2)
                                                           new
                                                           ^
                                                           it

                                             old   1-                        1-
                                            Pit                     pijt ( )       d                                     (B.3)
                                                           old
                                                           it


denote the price indices of the inner CES nests.




                                                               83
    Supply: Let cit         wit                                                      ¯it is the (exogenous)
                             denote the marginal cost of production by a firm, where A
                            ¯it
                            A
productivity. The optimization problem faced by firm  is:

                                  max          (pijt ( ) qijt ( ) - cit ijt qijt ( )) - wit fit ,
                            {qijt ( )}j
                                           j

subject to consumer demand given by equation (B.1).
    As a result, conditional on positive production (of which more below), the first order conditions imply:
                                                                  
                                                     pijt ( ) =      cit ijt ,                                                     (B.4)
                                                                  -1
so that the price index across new varieties within a location is:

                                             new    new 1-
                                                                      1     
                                            Pit   (Mit )                       cit .                                               (B.5)
                                                                            -1

Profits of monopolistically competitive firms: The profits of a firm   new
                                                                       it  are:

                                  it ( )             (pijt ( ) - cit ijt ) qijt ( ) - wit fit .                                    (B.6)
                                                j

Substituting the consumer demand expression (B.1) and the price expression (B.4) into equation (B.6) yields:

                                                                           1-    new                old    1- 1-
               1    
                            1-                                             ijt (Pit  )             Pit
                                                     1-     new -1
     it ( ) =                           (cit ijt )        (Pit )                                                     Yjt   - wit fit
                    -1                                                       1-            new )       old     1- 1-
                                                                           k ijt         (Pkt         Pkt
                                   j


Noting that, from the consumer demand equation (B.1) and the price expression (B.4), the revenue a producer
receives is:

                       rit ( )          pijt ( ) qijt ( ) 
                                    j

                                                                            1-    new                old   1- 1-
                 
                       -1
                            1                                               ijt (Pit  )             Pit
                                                     1-     new   -1
       rit ( )                =         (cit ijt )        (Pit  )                                                    Yjt ,         (B.7)
                 -1                                                             1-    new )              old   1- 1-
                                                                              k ijt (Pkt                Pkt
                                    j


it is apparent that variable profits are simply equal to revenue divided by the elasticity of substitution:
                                                                           1
                                                it ( ) + wit fit =           rit ( ) .                                             (B.8)
                                                                           

Free entry: From the free entry condition, total profits of a firm are zero, i.e. it () = 0. Applying the
free entry condition to equation (B.8) yields:
                                                                      1
                                                          wit fit =     rit ( )                                                    (B.9)
                                                                      

Substituting equation (B.9) into equation (B.7) yields:

                                           1-    new                 old   1- 1-
                                           ijt (Pit  )              Pit                             1      
                                                                                                                  -1
           1- - -1       new       -1
           ijt wit Ait (Pit  )                                                      1- Yjt =                           fit ,      (B.10)
                                              1-    new )               old   1-                           -1
                                            k ijt (Pkt                 Pkt
       j


where we use the fact that cit = wit /Ait .


                                                                  84
Perfectly competitive varieties: The price charged for the perfectly competitive varieties  
new
it  is simply the marginal cost:
                                              pijt ( ) = ijt cit   new
                                                                   it ,

so that:
                                                                          1
                                                     old    old          1-
                                                    Pit  = Mit                cit ,                          (B.11)
       old
where Mit   old
            it  denotes the measure of existing varieties.

Labor market clearing: Labor market clearing requires that the total labor used by all firms (for
entry and production of the new varieties as well as production of the existing varieties) must equal to the
total number of workers in the location, Li,t . The total amount of labor required by new varieties is:

                                               ^
                                                                                   
                                                                     qijt ( )
                                  Lnew
                                   it  =                          ijt ¯       + fi  d 
                                                          j
                                                                       Ait
                                             new
                                             it

                                  Lnew
                                   it    =        new
                                             fit Mit  ,
         new
where Mit      |newit | denotes the measure of new varieties and we have used the free entry equation (B.10).
Similarly, the total amount of labor required by old varieties is:

                                                   ^
                                                                               
                                                                      qijt ( ) 
                                    Lold
                                     it =
                                                                   ijt ¯        d 
                                                              j
                                                                        Ait
                                               old
                                               it

                                                           1-
                                    Lold   new
                                     it = Mit                 fit ,
                                                            

where we have used the equations for the old and new variety price indices from equations (B.5) and (B.11).
   Total labor used by all firms is hence:

                                                   Lnew
                                                    it  + Lold
                                                           it = Lit 

                                                          new     Lit
                                                        Mit    =      ,                                      (B.12)
                                                                 fit
so that the measure of new firms is proportional to the labor supply.

The productivity microfoundation: Combining the old and new variety price indices from equa-
tions (B.5) and (B.11) yields:

                new       old    1- 1-                  1-         (1-)         1-
                                                                          new ( 1- )  old   (1-)( 1 -
                                                                                                  1- )
              (Pit  )    Pit                 = (cit )                   (Mit )       Mit                 .
                                                                  -1
    Total trade flows from i to j at time t are determined by simply aggregating across all firms of both
types. The total trade of new varieties is thus:
                               ^
                         new
                      Xijt =          pijt ( ) qijt ( ) d 
                                   new
                                   it
                                                                               1-
                                                                     old (1-)( 1- )
                                                              1-
                                                   1-  new ( 1- )
                         new         (ijt cit )    (Mit    )       Mit
                        Xijt    =                                                1-
                                                                                      Yjt .
                                                         new )( 1- ) M old (1-)( 1- )
                                                                1-
                                                 1-
                                     k (    c
                                         kjt kt )    ( M kt             kt




                                                                    85
Similarly, the total trade of existing varieties is:
                              ^
                        old
                     Xijt   =      pijt ( ) qijt ( ) d 
                                   old
                                   it
                                                                                          1-
                                                                                old (1-)( 1- )
                                                                         1-
                                                       1-         new ( 1- )
                          old                 (ijt cit )      (Mit    )       Mit
                         Xijt   = (1 - )                                                    1-
                                                                                                 Yjt .
                                                                    new )( 1- ) M old (1-)( 1- )
                                                                           1-
                                                            1-
                                              k ( kjt
                                                      ckt )     ( M kt             kt

Hence, total trade flows are:
                                                      new    old
                                              Xijt = Xijt + Xijt 
                                                     1- 1-  -1  -1
                                              Xijt = ijt wit Ait Pjt Yjt ,

where:
                                                  1-                  1- 1-  -1
                                                 Pjt                  kjt wkt Akt
                                                              k

and:                                                              1
                                                    ¯it f -1 × L1 × L2 ,
                                               Ait  A    it     it   it-1
                                1-
and 1     -1   and 2            -1 ,   as claimed.

B.1.2     Microfoundation #2: durable investments in local productivity
Setup: In each location i, there is a measure of firms that compete a la Bertrand. Firms can hire workers
either to produce or to innovate, where the total quantity produced in location i at time t depends on the
amount of labor used in the production Lit , the amount of land Hit , the amount of innovation it and some
productivity shifter Bit :
                                                                   1-µ
                                                Qit =  1       µ
                                                      it Bit Lit Hit   
                                                      1       µ
                                                qit = it Bit lit ,

where in what follows we focus on the output per unit land qit and the labor per unit land lit . We assume
the parameters satisfy µ < 1 (due to the diminishing marginal product of labor per unit land) and 1 < 1
(due to the diminishing marginal product of innovation).
    To employ a level of innovation it , a firm must hire it additional units of labor, where  < 1 / (1 - µ).
We assume that innovation today has an affect on the level of productivity tomorrow so that:

                                                           Bit =   1 ¯
                                                                 it-1 Bit ,                                              (B.13)

where B¯it is an exogenous shock and  < 1 indicates the extent to which innovation decays from one period
to the next. We assume the cost per unit of land rit is determined by a competitive auction, so that firms
obtain zero profits.

Profit maximization: Even though innovations today affect innovations in future periods, because
firms earn zero profits in the future, the dynamic problem reduces to a sequence of static profit maximizing
problems Desmet and Rossi-Hansberg (2014).
    As a result the firms' profit maximization problem becomes:

               max pit Bit ( 1       µ
                            it ) × (lit ) - wit                       lit      -wit            it               -rit ,
               lit ,it
                                                     # of production workers
                                                                                      # of innovation workers




                                                                      86
which has the following first order conditions:
                                                     1 -1 µ         -1
                                          1 Bit pit it   lit = wit it
                                                     1 µ-1
                                           µBit pit it lit = wit ,

which combine to yield:
                                                    1
                                                      lit = it 
                                                    µ
                                                        1
                                               1        
                                                 lit        = it .                                   (B.14)
                                              µ

Total employment ~
                 lit per unit land is equal to the sum of the production workers and the innovation workers:

                                              lit = lit + 
                                              ~
                                                          it 

                                              ~                1
                                              lit =    1+              lit .
                                                               µ

Rent and income: Equilibrium rent ensures that profits per unit land are equal to zero:
                                  rit = Bit pit  1 µ                   
                                                it lit + wit lit + wit it 
                                           1     1
                                  rit =      +1+              wit lit .
                                           µ     µ

Note that total income per unit labor in a location is:
                                                              ~ it 
                                          Yit = rit Hit + wit L
                                                                    
                                                    1       1
                                          Yit       µ + 1 + µ
                                               =                 + 1 wit .
                                          ~ it
                                          L           1+  1
                                                              µ


The productivity microfoundation: The output price is:
                                          µ-1
                             µBit pit  1
                                      it Lit  = wit 
                                                                               1
                                                                                                 1
                                                   1         1     µ           
                                                                                          1-µ-   
                                            pit =                                  wit lit
                                                  Bit        µ     1

total output is:

                                     qit =         µ
                                           it Bit lit 
                                            1

                                                       1
                                                                       1              1
                                                1      
                                                                ~ µ+           1-µ-   
                                    Qit =                   Bit L it       Hit            ,
                                               µ

      ~ it is total employment in location i at time t. Combining equations (B.13) and (B.14) yields:
where L

                                     Bit =   1 ¯
                                           it-1 Bit 
                                                            1
                                                 1
                                                µ
                                                     ~
                                                     Lit-1 
                                     Bit =                    ¯it ,
                                                              B
                                                   1 Hit-1
                                              1+        µ




                                                            87
so that in total we have:
                                      1
                                                                           1              
                                                     1
                                 1                            ~ it-1
                                                              L                                        1
                                                                                                            1-µ-
                                                                                                                   1

                    Qit =
                                                    µ                                ¯it 
                                                                                     B   L~ µ+         
                                                                                                           Hit     
                                                                                                                       
                                                                                            it
                                µ                             Hit-1
                                          
                                                       1
                                                  1+   µ

                          ¯it L
                    Qit = A   ~ 1 L~ 2 L ~
                                it   it-1 it ,
                            1                 1
                    (1+ )                 -                       1            1
      ¯it 
where A         1           
                                 1+   1       
                                                  ¯it H 1-µ-
                                                  B                       -
                                                                       Hit-1 , 1                  1
                                                                                                       - (1 - µ), and 2    , as required.
                                                                                                                          1
               µ                      µ                it                                         



B.2      Amenity spillover
                                                                                       ¯it L
We formalize here a possible microfoundation for the amenity spillover function, uit = u      1 2
                                                                                            it Lit-1 .


Demand: Suppose that consumers have Cobb-Douglas preferences over land and a consumption good,
so that their indirect utility function can be written as:

                                                                   (Yit /Lit )
                                                   Wit =                            1-
                                                                                          ,
                                                              (Pit )           H
                                                                              rit
         H
where rit  is the rental cost of housing. Let Hit denote the (equilibrium quantity) of housing and let Kit
denote the (exogenous) quantity of land in a location, so that hit  Hit /Kit is the housing density (e.g.
square feet of housing per acre of land).
     Given the Cobb-Douglas preferences (and, from balanced trade, that income equals expenditure, Yit =
Eit ), we have:
                                              H
                                            rit Hit = (1 - ) Yit
                                                          wit Lit = Yit ,
so that we can write the payment to housing as a function of the payment to labor:

                                                   H         1-             1
                                                  rit =                        wit Lit .
                                                                           Hit

Note then that we can write:
                                                         (Yit /Lit )
                                          Wit =                        1-
                                                                                 
                                                    (Pit )        H
                                                                 rit
                                                                                                  1-

                                          ~ it =             1             wit       Hit           
                                          W                       1-                                   ,                           (B.15)
                                                     (1 - )                Pit       Lit

                1
      ~ it  W  is a positive monotonic transform of Wit that hence can serve as our measure of welfare.
where W      it


Supply: We now determine the equilibrium stock of housing Hit . Suppose that each unit of land is
owned by a representative developer, who decides how much to upgrade the housing tract. The amount of
                             Hit
housing per unit land (hit  K  it
                                  ) is a function of the housing stock that has survived from the previous
                      existing
                     Hit
period hexisting
        it              Kit       and the amount of labor that the firm chooses to hire to rebuild it:

                                                                       µ            1-µ
                                           hit = hexisting
                                                  it
                                                                               d
                                                                              lit             
                                                                          µ          1-µ
                                                  existing
                                           Hit = Hit                           Ld
                                                                                it            .




                                                                   88
In what follows, we assume for simplicity that the existing housing stock from period t - 1 in period t is
some fraction of the development in the previous period:
                                                   existing                                   
                                                  Hit        ¯it Ld
                                                            =C    it-1                           ,                (B.16)
      ¯it is an (exogenous) shock.
where C

Profit maximization: A developer solves:
                                                                   H             d
                                                              max rit hit - wit lit - fit 
                                                                d
                                                               lit
                                                              µ           1-µ
                                    H
                               max rit hexisting
                                        it
                                                                   d
                                                                  lit                   d
                                                                                 - wit lit - fit ,
                                   d
                                  lit


where fit is a fixed cost (a "permit cost") that is remitted back to local residents and is set via a competitive
biding process, ensuring that the firm earns zero profits (and hence the dynamic problem simplifies into a
series of static profit maximization problems, as above).
     First order conditions are:
                                                                     µ           -µ
                                        H
                               (1 - µ) rit hexisting
                                            it
                                                                           d
                                                                          lit         = wit 
                                                                 µ              1-µ         1    1
                                                  hexisting
                                                   it
                                                                          d
                                                                         lit          =             w ld .
                                                                                                 H it it
                                                                                          1 - µ rit

Note that the fixed "permit costs" are then:
                                                                     µ           1-µ
                                           H
                                    fit = rit hexisting
                                               it
                                                                            d
                                                                           lit                d
                                                                                       - wit lit 
                                               µ                  d
                                    fit =                    wit lit ,
                                              1-µ

which recall are remitted to workers and ensure profits are zero.
    We can combine this with the rental rate above to calculate the fraction of workers hired in the devel-
opment of the land:
                                                                                          µ            1-µ
                                                        hit = hexisting
                                                               it
                                                                                                  d
                                                                                                 lit         
                                             1-
                              (1 - µ)                   Lit = Ld
                                                               it ,
                                              

so we require as a parametric restriction (so that only a fraction of workers are hired as local developers):

                                                                         1-
                                                    (1 - µ)                           < 1.
                                                                          

Since a constant fraction of local workers are hired, we can express the housing density solely as a function
of the local population, the local land area, and then:
                                                   µ          1-µ
                          hit = hexisting
                                 it
                                                        d
                                                       lit               
                                                                     (1-µ)+µ
                                                   1-                                 ¯ µ (Lit-1 )µ (Lit )1-µ .
                          Hit =         (1 - µ)                                       Cit                         (B.17)
                                                    




                                                                         89
The amenity microfoundation: We substitute equation (B.17) for the equilibrium stock of housing
into the welfare equation (B.15) to yield:
                                                                     1-

                                  ~ it =        1        wit   Hit    
                                  W                 1-                    
                                          (1 - )         Pit   Lit
                                  ~ it = wit u
                                  W          ¯it L  1 2
                                                  it Lit-1 ,
                                         Pit
                                        1-                1-
                 1                1-      ((1-µ)+µ)      ¯  , 1  -µ 1- , and 2  µ 1- as required.
      ¯it 
where u          1-     (1 - µ)                          C it                      
             (1-) 




                                                         90
C      Online Appendix: Additional tables and figures
This section includes additional tables and figures mentioned in footnotes in the text.

                                      Table C.1: First-stage estimates

                                                                                                       1-            
                                                                         ln(Lit )    ln(Lit-1 )   ln(Pit  )    ln(Wit )
                                                                           (1)          (2)          (3)         (4)
 Instruments shifting amenities (used to estimate productivity spillovers):
   Year*(Average max. temp. in hottest month)                             5.923*** -11.821***        0.079     8.499***
                                                                           (1.345)   (2.734)       (0.171)      (1.346)
   Year*(Average max. temp. in hottest month)2                           -0.011*** 0.024***         -0.000    -0.017***
                                                                           (0.002)   (0.005)       (0.000)      (0.002)
   Year*(Average min. temp. in coldest month)                             1.542***   -0.406*      0.324***     1.817***
                                                                           (0.132)   (0.245)       (0.019)      (0.132)
   Year*(Average min. temp. in coldest month)2                           0.010***   0.010***      0.002***    0.008***
                                                                           (0.001)   (0.001)       (0.000)      (0.001)

 Instruments shifting productivities (used to estimate amenity spillovers):
   Year*(High - low inten. corn potential yield, mean)                    0.026***    0.033***     0.003***    0.024***
                                                                           (0.003)     (0.006)      (0.000)     (0.003)
   Year*(High inten. soy - low inten. wheat potential yield, mean)       -0.048***   -0.034***    -0.004***   -0.046***
                                                                           (0.007)     (0.011)      (0.001)     (0.007)
   Year*(High - low inten. corn potential yield, st. dev.)                  -0.004      -0.019     0.003**        0.002
                                                                           (0.007)     (0.014)      (0.001)     (0.007)
   Year*(High inten. soy - low inten. wheat potential yield, st. dev.)      0.001     0.072**        -0.002      -0.005
                                                                           (0.017)     (0.031)      (0.003)     (0.017)
 F-statistic                                                              24.995      36.854       48.109      26.343
 R-squared                                                                 0.890       0.763        0.965       0.861
 Observations                                                             15,640      15,640       15,640      15,640
Notes: This table reports OLS regressions of the first-stage equations corresponding to the 2SLS estimates
of productivity and amenity spillover functions reported in Tables 2 and 3.. Each observation is a sub-county
from 1850-2000. All specifications control for sub-county fixed effects and region-year fixed effects, where a
region is one of 14 equally sized squares covering the continental U.S.. The sample is all sub-counties in all
years where geographic instruments and contemporaneous/lagged population values are observed. Standard
errors are two-way clustered at the sub-county (to allow for serial correlation across time) and county-year
levels (to allow for data aggregation across sub-counties within year) and are reported in parentheses. Stars
indicate statistical significance: * p<.10 ** p<.05 *** p<.01.




                                                          91
                  Figure C.1: Spatial distributions of population over time
                    (a) 1800                                        (b) 1850




                    (c) 1900                                        (d) 1950




                                           (e) 2000




Notes : This figure illustrates the distribution of population (Lit ) across all locations from
1800 to 2000. The average population in a location in each year is normalized to one. The
colors indicate the value, with red indicating a higher population and blue indicating a lower
population.



                                              92
              Figure C.2: Spatial distributions of per capita income over time
                     (a) 1850                                         (b) 1900




                     (c) 1950                                         (d) 2000




Notes : This figure illustrates the distribution of per capita income (wit ) in all locations 1850
to 2000. The average value of wit in a location in each year is normalized to one. The colors
indicate the value, with red indicating a higher population and blue indicating a lower wage.




                                               93
Figure C.3: Estimating productivity and amenity spillovers using plausibly exogenous shifts
in labor supply and demand curves over time
                        (a) Shifts to the supply curve from amenity changes




                     (b) Shifts to the demand curve from productivity changes




Notes : This figure illustrates the fitted values of the first-stages from the 2SLS regressions
in Tables 2 and 3. The left panel shows the predicted change (from 1850-2000) in log popu-
lation due to plausibly exogenous changes in amenities based on technological improvements
which make residing in places with extreme climates of relatively higher amenity value over
time. These improvements shift the labor supply curve in each location and can be used to
identify the contemporaneous productivity spillover. The right panel shows the predicted
trend in log population from plausibly exogenous changes in productivities based on techno-
logical improvements and changes in international demand in agricultural production. These
improvements shift the labor demand curve in each location and can be used to identify the
contemporaneous amenity spillover. Red indicates relatively large values and blue indicates
relatively low values.

                                                94
