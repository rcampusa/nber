                              NBER WORKING PAPER SERIES




    PRICING LONG-LIVED SECURITIES IN DYNAMIC ENDOWMENT ECONOMIES

                                           Jerry Tsai
                                      Jessica A. Wachter

                                      Working Paper 24641
                              http://www.nber.org/papers/w24641


                    NATIONAL BUREAU OF ECONOMIC RESEARCH
                             1050 Massachusetts Avenue
                               Cambridge, MA 02138
                                    May 2018




We thank Marco Grotteria, Yicheng Zhu, and seminar participants at the Wharton School for
helpful comments. The views expressed herein are those of the authors and do not necessarily
reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2018 by Jerry Tsai and Jessica A. Wachter. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Pricing Long-Lived Securities in Dynamic Endowment Economies
Jerry Tsai and Jessica A. Wachter
NBER Working Paper No. 24641
May 2018
JEL No. G12

                                          ABSTRACT

We solve for asset prices in a general affine representative-agent economy with isoelastic
recursive utility and rare events. Our novel solution method is exact in two special cases: no
preference for early resolution of uncertainty and elasticity of intertemporal substitution equal to
one. Our results clarify model properties governed by the elasticity of intertemporal substitution,
by risk aversion, and by the preference for early resolution of uncertainty. Finally, we show in a
general setting that the linear relation between normal-times covariances and expected returns
need not hold in a model with rare events.


Jerry Tsai
Department of Economics
University of Oxford
Manor Road Building
Oxford, OX1 3UQ
U.K.
jerry.tsai@economics.ox.ac.uk

Jessica A. Wachter
Department of Finance
2300 SH-DH
The Wharton School
University of Pennsylvania
3620 Locust Walk
Philadelphia, PA 19104
and NBER
jwachter@wharton.upenn.edu
1        Introduction

The framework of representative-agent asset pricing, in which complete markets allows for
the diversification of idiosyncratic risks, has for many years delivered benchmark models
of the cross-section and time-series of stock prices and returns.1 These models are at the
same time simple and rich in the types of economic intuition they capture. In this paper,
we focus on two nested sub-classes of the dynamic representative-agent framework with the
goal of clarifying important implications for risk premia and asset prices.
    In the first part of the paper, we extend classic cross-sectional results of Merton (1973)
and Breeden (1979) to a dynamic setting with recursive utility (Epstein and Zin, 1989)
and rare events. This section assumes only isoelastic recursive utility and a Markov struc-
ture. Thus this paper unifies and extends existing results such as those of Bansal and
Yaron (2004), Barro (2006), Benzoni, Collin-Dufresne, and Goldstein (2011), Drechsler and
Yaron (2011), Farhi, Fraiberger, Gabaix, Ranciere, and Verdelhan (2017) Gabaix (2012),
Hansen, Heaton, Lee, and Roussanov (2007), Longstaff and Piazzesi (2004) and Wachter
(2013). Widening the class of models beyond the traditional diffusion framework of Mer-
ton (1973) has dramatic implications for the cross-section. The intertemporal capital asset
pricing model (ICAPM) of Merton is a standard justification for the near-universal use
of covariance-based factor models in finance. However, the ICAPM relies on conditional
log-normality. Without the assumption of conditional log-normality, a factor structure may
not hold.
    In this section, we also show that the dynamics of the wealth-consumption ratio are prin-
cipally governed by the elasticity of intertemporal substitution (EIS) and the risk premia
in the cross-section relative to a consumption-based model are governed by the preference
for early resolution of uncertainty. However, relative to a wealth-based model, risk premia
in the cross-section are governed by risk aversion. When risk aversion is equal to one, a
rare-event wealth CAPM holds regardless of the EIS. In contrast, a rare-event consumption
    1
        Textbook treatments include Campbell (2018) and Cochrane (2001).



                                                    1
CAPM holds if there is no preference for early resolution of uncertainty, regardless of risk
aversion. Some of these comparative statics have appeared elsewhere in the literature, but
the advantage of our framework is that we can show them in a more general setting.
   In the second part of the paper, we derive approximate analytical solutions for the
pricing of long-lived assets. Our solution method takes as its starting point the widely-used
method of Campbell and Shiller (1988) which involves a first-order approximation of the
price-dividend ratio by a log-linear function. Previous studies use this method to compute
the wealth-consumption ratio (which is necessary for computing other asset prices under
recursive utility), and then to compute prices on other assets. While we use the method to
compute the wealth-consumption ratio, we then, given the approximation, compute prices
on other assets exactly. As a consequence, our method, unlike others, is exact both when the
elasticity of intertemporal substitution is equal to one, and when utility is time-additive.2
We illustrate our results by extending the model of Wachter (2013) to a case of non-unitary
EIS. We show that our technique is notably closer to the solution when the exact problem
is solved numerically, than under standard approximations. Allowing for an EIS greater
than one improves the fit of the model to the second moments of stock returns and to the
riskfree rate.
   By deriving approximate analytic solutions we reveal economic intuition that well-
known approximations conceal. Our results also reveal the role of risk aversion, the elas-
ticity of intertemporal substitution and the preference for early resolution of uncertainty,
in a fully non-parametric setting. This demonstrates that what drives the role of these
parameters is not the specific assumptions in current models, but more general principles.
   Finally, our understanding of the cross-section of returns, though well-developed em-
pirically, is, theoretically, more marked by ignorance than knowledge. Of the vast range of
cross-sectional anomalies, the value premium has received most of the attention, and even
here there is at present no consensus on the reason. This paper shows a potential answer as
   2
     In concurrent and independent work, Pohl, Schmedders, and Wilms (2017) derive related results in a
discrete-time conditional lognormal setting.



                                                  2
to why this may be the case: that by seeking to explain expected returns via normal-times
covariances, the literature may be looking in the wrong place. What matters for expected
returns is the covariance during extreme events.
    The remainder of the paper proceeds as follows. Section 2 describes our general set-up
and derives results for the cross-section. Section 3 describes the affine set-up with analyt-
ical solutions. Section 4 quantitatively evaluates the solution method under an example
economy.



2     General Model

2.1    The endowment process

Let Bct be a unidimensional Brownian motion and BXt an n-dimensional Brownian motion,
such that Bct and BXt are independent. For j = 1, . . . , m, let Njt be independent Poisson
processes. Consider functions µc : Rn → R, σc : Rn → R, µX : Rn → Rn , σX : Rn →
Rn×n , and λ : Rn → Rm . Assume the endowment follows the process

                                                         m
                   dCt                                  X
                       = µc (Xt− ) dt + σc (Xt− )dBct +     (eZcjt − 1)dNjt ,            (1)
                   Ct−                                  j=1


where Xt is a vector of state variables following the process

                                                             m
                                                             X
                    dXt = µX (Xt− ) dt + σX (Xt− )dBXt +           ZXjt dNjt ,           (2)
                                                             j=1


and where, for all j = 1, . . . , m and t, Zcjt are scalar random variables and ZXjt an n × 1
vector of random variables. We assume the joint distribution of Zcjt and ZXjt is time-
invariant, and thus suppress the t subscript when not essential for clarity. The intensity
for Poisson process Njt is time-varying and given by λj (x), the j-th element of λ(x). We
adopt the convention that BXt , and therefore Xt , are column vectors and that σc is a row
vector. We use the notation ej to denote the conforming column vector that has 1 in the


                                               3
jth position and 0 elsewhere. The literature focuses on the case of disasters (Zcjt < 0).
However, Tsai and Wachter (2016) show that booms (Zcjt > 0) have rich implications for
the cross-section of returns.
    Consider a stochastic process for dividends:

                                                         m
                      dDt                               X
                                                            eZdjt − 1 dNjt .
                                                                     
                          = µd (Xt− ) + σd (Xt− )dBct +                                              (3)
                      Dt−                               j=1


We will price the claim to (3). In equilibrium, this asset is in zero net supply. There may
be many such assets, but because we will assume complete markets, it suffices to consider
each asset in isolation. Similarly to the rare-event outcomes for consumption and for Xt ,
Zdjt is a random variable with time-invariant distribution for all j.3
                                                          > >
    Additional notation will be helpful. Let Bt ≡ [Bct , BXt ] . For a function F (c, d, x),
define
                                                      F (eZc , eZd , x + ZX )
                            JF (x, Zc , Zd , ZX ) ≡                           − 1.                   (4)
                                                           F (1, 1, x)

and


            J¯F (x) ≡ Eν [JF (x, Zc1 , Zd1 , ZX1 ), · · · , JF (x, Zcm , Zdm , ZXm )]>

                      ≡ [Eν1 JF (x, Zc1 , Zd1 , ZX1 ), · · · , Eνm JF (x, Zcm , Zdm , ZXm )]>


where Eνj denotes expectations taken with respect to the time-invariant joint distribu-
tion of Zcj , Zdj , ZXj .   We will use sometimes use the shorthand J¯F t = J¯F (Xt ), and
JF t (Zc , Zd , ZX ) ≡ JF (Xt , Zc , Zd , ZX ). We will also typically omit either the Zc or Zd
argument if the function does not depend on consumption or dividends, respectively. Fi-
nally, we follow the convention that partial derivatives with respect to a vector are row
vectors; for example, ∂I/∂X = [∂I/∂X1 , · · · , ∂I/∂Xn ].
   3
     Dividends are assumed to be perfectly correlated with consumption during normal times. Normal-
times dividend risk that is uncorrelated with consumption and the state variables will have no impact on
risk premia or on asset prices themselves. Our analysis can easily be extended to allow for dividend risk
that is correlated with the state variables.



                                                       4
2.2    Utility

Assume a representative agent with recursively-defined utility

                                               Z       ∞                 
                                    V t = Et                 f (Cs , Vs )ds ,                                      (5)
                                                    t


with
                            β
                                                        
                                                                                   1
                                                                                        1− ψ1     
                                                                                − 1−γ
               f (C, V ) =      1   ((1 − γ)V )                 C ((1 − γ)V )                    −1 .              (6)
                           1−   ψ

where ψ is the elasticity of intertemporal substitution and γ is risk aversion (Duffie and
Epstein, 1992b). When γ = 1/ψ, the recursion in (6) is linear, and (5) reduces to the
time-additive case.
   We are interested in two limiting cases of (6). When ψ = 1, (6) reduces to

                                                                                      
                                                                     1
                 f (C, V ) = β ((1 − γ)V ) log C −                      log ((1 − γ)V ) .                          (7)
                                                                    1−γ

(Duffie and Epstein, 1992a). When γ = 1, (6) reduces to

                                          β                     1
                                                                                  
                          f (C, V ) =           1           e(1− ψ )(log C−V ) − 1 .                               (8)
                                         1−     ψ


When γ = ψ = 1, Vt equivalent to time-additive log utility. In what follows, let θ =
(1 − γ)/(1 − ψ1 ). Then θ = 1 corresponds to time-additive utility, and                             1
                                                                                                    θ
                                                                                                        = 0 will, in a
formal sense, correspond to ψ = 1.
   Though this framework is quite general, it specifically assumes that the distribution
of dividends and consumption, as well as utility, are invariant to scale. This invariance
is empirically justified, useful computationally (because it eliminates state variables, and
important conceptually (the notation in Equation 4, for example, requires this scale invari-
ance). The economic import of scale invariance is that the level of consumption, while very
important for the level of utility, is not important for decision-making. Likewise, the level
of dividends, while important for prices, does not affect returns.


                                                            5
2.3     General characterization of the solution

We first characterize the value function, the wealth-consumption ratio, and the state-price
density in terms of the state variables.4 Here and in the remainder of the paper, Proofs
not given in the main text are contained in Appendix A.

Proposition 1 (Value function). Suppose the representative agent’s preference is defined
by (5)–(7), where the consumption growth process follows (1) and the state variable process
follows (2). In equilibrium, J(Ct , Xt ) = Vt , where

                                                C 1−γ I(x)1−γ
                                      J(C, x) =                                                     (9)
                                                    1−γ

for γ 6= 1 and
                                     J(C, x) = log C + log I(x)

for γ = 1. The function I(·) satisfies the partial differential equation

                                           "         >  !                    #
   β     h     1
                       i          1     1 ∂ 2I   γ ∂I          ∂I
      1   I(x) ψ −1 − 1 + µc (x) + tr        2
                                               − 2                   σ(x)σ(x)>
  1−  ψ
                                  2     I ∂x     I   ∂x        ∂x
                                      m
                                                   "                       1−γ   #
      1 ∂I         1             1   X                         I(x + Z Xj )
    +      µX (x) − γσc (x)2 +           λj (x)Eνj e(1−γ)Zcj                     −1 =0
      I ∂x         2           1 − γ j=1                          I(x)

                                                                                                   (10)

for ψ 6= 1 and

                             "                          >      !               #
                                 1 ∂ 2I
                                               
                      1                   γ        ∂I       ∂I
  − β log I + µc (x) + tr             2
                                        − 2                           σ(x)σ(x)>
                      2          I ∂x    I         ∂x       ∂x
                                     m
                                                           "              1−γ    #
     1 ∂I         1             1   X                         I(x + Z Xj )
   +      µX (x) − γσc (x)2 +           λj (x)Eνj e(1−γ)Zcj                     − 1 = 0.
     I ∂x         2           1 − γ j=1                          I(x)

                                                                                                   (11)
   4
     We assume parameter values are such that solutions exist. We discuss existence of solutions further
in Section 3.



                                                    6
for ψ = 1.

   Equation 11 is a special case of (10) as can be seen by taking the limit as ψ → 1.
   Given the value function (9), we can now express the wealth-consumption ratio and the
state price density in terms of I(Xt ). This ratio will play an important role in our solution
method for the affine case.

Corollary 2 (Wealth-consumption ratio). Let Wt denote the wealth of the representa-
tive agent at time t. Then the equilibrium wealth-to-consumption ratio Gc (Xt ) ≡ Wt /Ct is
a function of Xt and is given by

                                      
                                       β −1 I(x)1− ψ1 ψ 6= 1
                               c
                              G (x) =                                                    (12)
                                            β −1      ψ = 1.




Proof of Corollary 2 Conjecture that the equilibrium wealth-consumption ratio is a
function of Xt , namely Gc (Xt ) ≡ Wt /Ct . Optimality requires that the derivative of f
with respect to Ct equals the derivative of J with respect to Wt (Duffie, 1996, Chapter 9).
By the chain rule, ∂J/∂W = (∂J/∂C)Gc (Xt )−1 , so that

                                     ∂f   ∂J    1
                                        =     c
                                                     .                                   (13)
                                     ∂C   ∂C G (Xt )

Furthermore, Vt = J(Ct , Xt ). Taking the derivative of (6) with respect to C, and substi-
tuting (9) in for V implies
                                   ∂f                1
                                      = βCt−γ I(Xt ) ψ −γ .                              (14)
                                   ∂C

Combining (14) with (13), and applying (9) to calculate the right hand side of (13), verifies
the conjecture and implies (12).




                                              7
Corollary 3 (State-price density). The state-price density is given by:
                       Z t                        
                                             1                        1
                 exp −β       (1 − θ)I(Xs ) ψ + θ ds βCt−γ I(Xt ) ψ −γ ψ 6= 1
                                               −1
                
                
                                                                                                        (15)
                          0
           πt =         Z t                            
                             ((1 − γ) log I(Xs ) + 1) ds βCt−γ I(Xt )1−γ ψ = 1
                
                 exp −β                                                                                 (16)
                
                
                                 0




Proof of Corollary 3 Duffie and Skiadas (1994) characterize the state-price density as

                                          Z      t                       
                                                      ∂f                      ∂f
                               πt = exp                  (Cs , Vs )ds
                                              0       ∂V                      ∂C     Ct ,Vt


The results follow from substituting Vt = J(Ct , Xt ) using (9) into (6) and (7) and taking
partial derivatives.


2.4     Risk premia

Risk premia arise from the co-movement of asset prices with the marginal utility process.
Using Corollary 3, we can write the evolution of πt in terms of the underlying shocks:

                                                              m
                       dπt                        X
                           = µπt− dt + σπt− dBt +     Jπ (Xt− , Zcjt , ZXjt )dNt                         (17)
                       πt−                        j=1


where expressions for µπt = µπ (Xt ), σπt = σπ (Xt ) and Jπ follow from Ito’s Lemma and the
homotheticity in the non-locally deterministic terms of (15) and (16).5 Here and in what
follows, we drop the arguments Zc or Zd when these are unnecessary.
    We consider the valuation of an asset paying (3). Then, the absence of arbitrage implies
that this asset value is St = S(Dt , Xt ), where

                                                                  Z   ∞
                                     S(Dt , Xt ) = Et                     πs Ds ds                       (18)
                                                                  t
                                                       = Dt G(Xt )                                       (19)
   5
     The state-price density πt is not a function of Ct and Xt , and thus Jπ is not strictly speaking defined.
                                        1
To be precise, define π̂t = Ct−γ I(Xt ) ψ −γ , and replace Jπ in (17) with Jπ̂t ππ̂tt .

                                                          8
The Markov assumption implies that the right hand side of (18) is a function of Dt and
Xt , while the form of (3) implies (19). Note that G(Xt ) is the price-dividend ratio. We can
then apply Ito’s Lemma to conclude that prices evolve according to

                                                    m
                   dSt                        X
                       = µSt− dt + σSt− dBt +     JS (Xt− , Zdjt , ZXjt )dNjt ,         (20)
                   St−                        j=1


for µSt = µS (Xt ), σSt = σS (Xt ), and

                                    S(eZd , x + ZX )     S(DeZd , x + ZX )
               JS (x, Zd , ZX ) =                    −1=                   − 1.
                                     S(1, x + Zx )        S(D, x + ZX )

   Given the state-price density, risk premia and prices follow from no-arbitrage pricing.
This is equivalent to solving for an equilibrium with a representative agent, provided the
state prices are as in Corollary 3.

Lemma 4 (No arbitrage). Assume state prices given by (17). Suppose an asset has price
process given by (20). Then


                 µπ (x) + µS (x) + G(x) + σπ (x)σS (x)> + λ(x)> J¯πS (x) = 0.           (21)


   With the no arbitrage condition given in Lemma 4, we can calculate the risk premium
of the asset St . Note that the expected return on this asset is given by:


                            rS (x) = µS (x) + G(x) + λ(x)> J¯S (x)                      (22)


Furthermore,
                                µπ (x) = −r(x) − λ(x)> J¯π (x)                          (23)

   We now state a result that holds under the general form for the state-price density (17)
and for an asset price (20). The proof is straightforward given Lemma 4, (22) and (23).
We suppress the x argument when not essential for clarity.


                                                9
Theorem 5. Let rt = r(Xt ) denote the continuously compounded risk-free rate. The
continuous-time limit of the risk premium for the asset with price process (20) is


                                  >
                 rtS − rt = −σπt σSt − λ>   ¯        ¯        ¯
                                        t (JπS,t − Jπ,t − JS,t )                                         (24)
                                       Xm
                                  >
                          = −σπt σSt −     λjt Eνj [Jπt (Zcj , ZXj )JSt (Zdj , ZXj )]                    (25)
                                              j=1


    When there are no Poisson shocks, (25) is a standard pricing result that inspires tests
of factor models of the cross section. Elements of −σπt are risk prices, while elements of σSt
are referred to as risk quantities.6 As we will show, elements of σπt are determined based
on consumption growth, the state variables and the primitive parameters of the utility
function. The elements of σπt can then be uncovered, up to scaling factors, through OLS
regression of stock returns on consumption growth and on the state variables. The Poisson
terms represent the expected comovement of the state-price density and the price of the
asset during rare events. If a rare disaster coincides with a rise in the stock price, that
stock will command a risk premium.
    A large empirical literature in asset pricing tests (25), under various specifications for
the underlying processes, without the Poisson terms, sometimes with the model restrictions
discussed below and sometimes without. Theorem 5 suggests that such tests are mis-
specified. If risk is not purely Brownian, risk premia need not be linear functions of normal-
times covariances. In a recent paper (Tsai and Wachter, 2016), we calibrate a model of
rare events to show that this result can account for the value premium. Note also that
the convenient separation between prices and quantities of risk, which holds for diffusion
processes, fails in the case Poisson risk.7
   6
      Below, we will argue that it may make sense to refer to (σπt )k rather than −(σπt )k as the risk price
for for Brownian k depending on whether or not an increase in Bkt improves utility.
    7
      The above discussion associates risk prices with Brownian shocks. Alternatively, one may associate
risk prices with state variables and with consumption. Going between the two is straightforward. To
find the prices of risk associated with the state variables and consumption, project σS and σπ on the
                                       > >
(n + 1) × (n + 1) matrix σ = [σc e1 , σX ] . Thus the (n + 1) × 1 vector of risk prices is σπ σ > (σσ > )−1 and
the 1 × (n + 1) vector of risk quantities is σS σ > (σσ > )−1 . While we continue to use risk prices associated
with shocks for convenience, are results hold for this alternative definition.



                                                      10
    In what follows, we will emphasize the importance of the compensation for the Poisson
risk in (25). The literature has, recently, made progress on identifying this risk. Bai, Hou,
Kung, and Zhang (2018) show that anomalies become easier to explain if one includes
data over disaster periods. Chabi-Yo, Ruenzi, and Weigert (2017) identify the lower tail
dependence of assets on the market portfolio, and show that stocks with high dependence
have significantly greater returns that stocks with low dependence. Cremers, Halling, and
Weinbaum (2015) and Lu and Murray (2017) identify variation in the probability of disas-
ters using option prices. They show that assets that covary with this probability command
higher risk premia. These results support the implications of Corollaries 6 and 8 in what
follows, namely that rare-event risk determines expected returns even after controlling for
traditional measures such as market or consumption betas.
    For the remainder of this section, we assume the endowment process given in (1) and
(2) with utility given by (5–8).8


2.4.1    Risk premia in the consumption-based model

A natural benchmark is the Consumption CAPM of Breeden (1979). In what follows, we
show our results generalize the results in that paper.

Corollary 6 (Rare-event Consumption CAPM). Risk premia are given by (25) with

                                                                            
                                                         1          1 ∂I
                                  σπt = −γσct ,            −γ            σXt                             (26)
                                                         ψ          I ∂x

and
                                                                 ψ1 −γ
                                                    I(x + ZX )
                           Jπ (x, Zc , ZX ) =                              e−γZc − 1.
                                                       I(x)
                                                                                        1
    Consider the case of no preference for early resolution of uncertainty              ψ
                                                                                            = γ and no rare
events λj = 0. The model reduces to that of Breeden (1979). If we allow for rare events
but continue to assume no preference for early resolution of uncertainty, the model reduces
   8
     We assume that I(Xt ) > 0 for all realizations of Xt . This is a natural assumption given the form of
the value function in (9), and it is true in the affine jump-diffusion case explored in the following section.


                                                      11
to a rare-event consumption CAPM, in which what matters is not only covariance with
consumption, but covariance with the marginal utility during disaster periods. Because
these shocks are not small, they cannot be reduced to the covariance with consumption
multiplied by the coefficient of relative risk aversion. This insight is what allows disaster-
risk models to explain the equity premium: CRRA implies that large shocks are felt to a
greater extent than what we would find a pure quadratic setting.
   We consider a shock an improvement in the distribution of future consumption growth
if it makes an agent better off. In what follows, we refer to a shock to the kth component
of the vector Brownian motion BXt as Brownian shock k.

Definition 1. A shock to Brownian motion k, (dBXt )k > 0 is an improvement in the
                                                         ∂J                 ∂J
                                                                                
distribution of future consumption growth if and only if ∂X σX k > 0, where ∂X σX k is
                                        ∂J
the kth component of the row vector        σ .
                                        ∂X X


Definition 1 allows for a shock to affect multiple state variables through the matrix of load-
ings σX . In the special case where state variables are uniquely identified with a Brownian
motion, then σX is diagonal, and a shock to a variable is an improvement if and only if it
increases the value function.

Definition 2. If (dBt )k > 0 constitutes an improvement in the distribution of future con-
sumption growth, then −(σπt )k is the price of risk for Brownian shock k. If (dBt )k > 0
constitues a deterioration, then, (σπt )k is the price of risk.

While the definition doesn’t formally cover the case of shocks to Bct , clearly positive Brow-
nian shocks to consumption increase utility, and hence have a positive price of risk.
   Consider, for example, the case where there are shifts to average future consumption
growth through µc . These lead to higher consumption growth on average, and hence are
an improvement. The price of risk for this shock would be the negative of the marginal
utility response. Now consider the probability of a rare disaster. Shocks to this variable
lead future consumption to be lower and more risky. The price of risk for this shock would


                                                 12
be the marginal utility response itself. The benefit of our definition is that, given a fixed
set of preference parameters, both of these shocks would have the same sign.
   Given these definitions, there is a general result linking the utility function parameters
to the risk prices.

Corollary 7. A shock to the distribution of future consumption growth has a positive price
of risk if and only if γ > 1/ψ.

Proof. The result follows from the prices of risk (26), and from the fact that, given (9), the
          ∂J                                 1 ∂I
sign of ( ∂X σX )k is equal to the sign of     ( σ ) .
                                             It ∂X X k


Namely, if the agent has a preference for an early resolution of uncertainty, then shocks to
the distribution of consumption are associated with a positive risk premium. If there is no
preference for the timing of the resolution of uncertainty then these shocks do not have a
risk premium.
   Why is it that pricing of the state variables depends on the preference for early resolution
of uncertainty? To understand the appearance of these additional terms with recursive
utility, one must first understand the disappearance of the terms when utility is time-
additive, the central insight of Breeden (1979). Because of complete markets, we first
think of the investor as choosing an optimal consumption process. All that matters, when
weighing the desire to purchase contingent claims, is setting the marginal utility of this
consumption process against the marginal cost, namely the price, of the claim. Because
of the symmetry of risk and time, marginal utility depends only on consumption itself.
If we view the dynamic process of consumption as representing a compound lottery only
outcomes of this compound lottery are what needs to be hedged, not the manner in which
uncertainty is resolved.
   Under recursive utility, the desire to smooth consumption across states and time is of
course not the same – the agent has a dislike for uncertainty itself. This manifests itself
as an additional term in marginal utility. If the risk of negative outcomes increases, the
agent enjoys current consumption less, and marginal utility is higher. The agent considers

                                                13
this when purchasing contingent claims. Claims are more expensive if they fail to pay off
in states of the world when uncertainty is high.9


2.4.2    Risk premia in the wealth-based model

The theorems in Section 2.4.1 show additional terms relative to the consumption CAPM.
These additional terms depend on the preference for the early resolution of uncertainty.
However, many studies use the market portfolio rather than consumption in cross-sectional
regressions because asset returns are less noisy. Indeed, the original ICAPM of Merton
(1973) is written purely in terms of asset returns. Campbell (1993) derives an ICAPM in
a discrete-time homoskedastic setting with recursive utility; this is extended by Campbell,
Giglio, Polk, and Turley (2018) to allow for heteroskedasticity. An ICAPM also holds in
our general setting. The sign of prices of risk on the state variables no longer depends
on a preference for an early resolution of uncertainty, but rather on whether risk aversion
exceeds one.
    Using (9) and (12) we rewrite the value function as a function of wealth and of Xt :

                                                                      1−γ
                                             1                    1−γ Wt             1
                   J(Ct , Xt ) = J Wt      c
                                                  , Xt       =β               I(Xt ) ψ (1−γ) .         (27)
                                          G (Xt )                    1−γ

Likewise, from (15) it follows that

                      Z t                        
                                          1                                       1
         πt   = exp −β      (1 − θ)I(Xs ) ψ
                                            −1
                                               + θ ds β 1−γ Wt−γ Gc (Xt )γ I(Xt ) ψ −γ
                        0
                      Z t                        
                                          1                            1
              = exp −β      (1 − θ)I(Xs ) ψ + θ ds β 1−γ Wt−γ I(Xt ) ψ (1−γ)
                                            −1
                                                                                                       (28)
                              0

   9
      Another interpretation (Hansen, 2012) relates the concept of uncertainty preference to the idea of
consumption as a durable good. That is, an agent with a preference for early resolution of uncertainty
behaves similar to one who consumes at a lower frequency. Intuitively, if one is more willing to substitute
across time than over states, then exactly when this consumption takes place is less important. Under
this interpretation, the extra term in (15) reflects marginal utility over long-term consumption rather than
immediate consumption because of the information it contains about the consumption distribution. What
then determines risk premia are risks to consumption over multiple periods.




                                                    14
Moreover, from Wt = Ct Gc (Xt ), it follows that wealth evolves according to

                                                              m
                       dWt                        X
                           = µwt− dt + σwt− dBt +     (eZwjt − 1)dNjt ,
                       Wt−                        j=1


where
                                                              
                                                 1   1 ∂I
                               σwt   = σct , 1 −             σXt                          (29)
                                                 ψ I(Xt ) ∂X

and
                                                                                
                                           1                I(Xt− + ZXjt )
                        Zwjt   = Zcjt + 1 −    log                                   .    (30)
                                            ψ                    I(Xt− )

In the approximate affine model of the following section, Zwjt will not depend on Xt− . A
rare-event ICAPM then follows from Theorem 5:

Corollary 8 (Rare-event ICAPM). Risk premia satisfy the following:


                  >
 rtS − rt = γσwt σSt
                                           m
                           1 1 ∂I      >
                                            X
            + (1 − γ) 0, −        σXt σSt −     λjt Eνj [Jπt (Zwj , ZXj )JSt (Zdj , ZXj )] (31)
                           ψ I ∂X           j=1


where (for a given Xt , Zcj , and ZXj ) Zwjt is defined as (30) and Jπ can be expressed as

                                                              ψ1 (1−γ)
                                                 I(x + ZX )
                       Jπ (x, Zw , ZX ) =                                  e−γZw − 1.     (32)
                                                    I(x)

   Note the parallels between the role of wealth and of consumption in this ICAPM versus
the consumption CAPM. Also note the parallels between the compensation for Poisson risk
and for Brownian risk in (31) and (32).
   Consider first the special case with only Brownian risk. Then Corollary 8 is precisely
the ICAPM of Merton (1973), derived under the more general condition of recursive utility.
Risk premia are a weighted average of the covariance of returns with aggregate wealth and
the covariance of returns with investment opportunities. If an asset rises in price when
investment opportunities increase, the investor with γ > 1 demands less of the asset than

                                                    15
he would otherwise. In equilibrium, the risk premium rises to compensate. The investor
with γ < 1 seeks to hold more than otherwise, and the risk premium falls to compensate.
    Now consider the special case when γ = 1. Then a rare-event CAPM holds. Risk
premia depend only on the covariance with wealth during normal times and during rare
events. This holds regardless of the value of the EIS. When γ 6= 1 and there is Poisson risk,
a rare-event ICAPM holds, in which the covariance of investment opportunities and asset
returns during disasters also have the potential to determine risk premia.
    We derive a wealth-based analogue of Corollary 7. The analogue to the distribution
of future consumption growth is the investment opportunity set. We can define whether
a shock is an improvement to the investment opportunity set using the identical value
function criterion in Definition 1. We can also define the price of risk using the analogous
criterion in Definition 2.10

Corollary 9. Define prices of risk as in Definitions 1 and 2. Then a shock to the investment
opportunity set has a positive price of risk in the wealth-based model if and only if risk
aversion is greater than 1.

    Why the difference between the comparative statics in Corollary 7 and Corollary 9?
It is because wealth, or, depending on one’s point of view, consumption, already contains
an endogenous response of the agent to changes in investment opportunities. This change
is mediated through the elasticity of intertemporal substitution. The following corollary
follows directly from (12) and from (9).

Corollary 10. When ψ > 1, a shock representing an improvement in investment oppor-
tunities decreases the wealth-consumption ratio and a shock representing a deterioration
increases the ratio. The opposite holds when ψ < 1
  10
      Specifically, if (dBt )k > 0 constitutes an improvement in the investment opportunity set, then ψ1 (1 −
     1     ∂I
γ) I(X t ) ∂X
              σXt is the price of risk. If (dBt )k < 0 constitutes an improvement, then the negative of this
quantity is the price of risk.




                                                     16
3     Affine Model

We now make assumptions on the dynamics that imply exact solutions for the cases ψ = 1
and ψ = γ1 , and approximate solutions otherwise. We assume that drift and volatility in
the Ct and Xt processes, as well as the jump probability, are affine functions of the state
variables Xt . That is, for a column vector x of length n, define


                                         µc (x) = k0 + k1 x                              (33a)

                                         σc2 (x) = u0 + u1 x                             (33b)

                                        µX (x) = K0 + K1 x                               (33c)

                             (σX (x)σX (x)> )ij = (U0 )ij + (U1 )ij x                    (33d)

                                          λ(x) = l0 + l1 x,                              (33e)


where k0 and u0 are scalars, k1 and u1 are 1 × n, l0 is m × 1, l1 is m × n, K0 is n × 1, K1
and U0 are n × n matrices, and U1 can be thought of as an n × n × n matrix in a sense that
will be made more precise below.
    Finally, l0 is a column vector of length m. This is similar to the affine structure defined
by Duffie, Pan, and Singleton (2000), except in that case it is a specification of the endow-
ment process rather than the discount rate. This structure can accomodate time-varying
rare disasters as in Wachter (2013), as well as time-variation in the mean and standard
deviation of consumption growth, as in Bansal and Yaron (2004). The model can accomo-
date rare events that affect the mean and standard deviation of the consumption growth
process (Benzoni, Collin-Dufresne, and Goldstein, 2011; Drechsler and Yaron, 2011; Tsai
and Wachter, 2016), and self-exciting jumps (Nowotny, 2011). The model can also accomo-
date a stationary dividend-consumption ratio, while still allowing dividends to temporary
respond more to disasters (Longstaff and Piazzesi, 2004). Like Eraker and Shaliastovich
(2008), we solve for prices in a general continuous-time affine economy; we depart from
their approach in that we do not use the standard approximation to the price-dividend


                                               17
ratio.
    Assumption (33) place requirements on the functional form of conditional means, vari-
ances, and covariances for the processes Ct and Xt . Specifically, consider (33d). From (2), it
follows that σX (x)σX (x)> is the normal-times conditional variance of Xt . That is, it is the
instantaneous variance over an interval without rare events. Given two linear combinations
of Xt , a> Xt and b> Xt , for column vectors a, b, the normal-times conditional covariance
of a> Xt with b> Xt is a> σX (x)σX (x)> b. Assumption (33d) implies that this conditional
covariance is linear in x. To see this, note that from (33d) it follows that

                                                X
                     a> σ(x)σ(x)> b =                 ai (σ(x)σ(x)> )i.j bj                          (34)
                                                i,j
                                                X                       X
                                        =             ai (U0 )ij bj +         ai ((U1 )ij x) bj .    (35)
                                                i,j                     i,j


For a fixed i, j = 1, . . . , N , (U1 )ij is a row vector. Let (U1 )ij,k be the kth element of this
row vector so that

                                           X                            X
                     ai ((U1 )ij x) bj =        ai (U1 )ij,k xk bj =           ai (U1 )ij,k bj xk
                                            k                             k


From (35), it then follows that


                                 a> σ(x)σ(x)> b = a> U0 b + a> U1 bx,


where a> U1 b is formally defined to be the column vector with kth element ai (U1 )ij,k bj .11
    To complete the specification, we consider dividend-paying assets with cash flows of the
  11
     In (33d), we assume the existence of a solution σX (Xt ) for all Xt ; otherwise the variance matrix
for Xt is not well-defined. This restriction allows for a rich set of cases. For example, Xt could follow
a multivariate Cox, Ingersoll, and Ross (1985) process with uncorrelated shocks, but with interactions of
the variables introduced through K1 . Then U0 = 0 and the column vector (U1 )ij ∝ e>  j if i = j and zero
otherwise. With additional restrictions Xt will be non-negative and there will exist a σX (Xt ) satisfying
(33d). Other examples include processes that are a mix of homoskedastic multivariate Gaussian terms and
square root terms. Examples include models in Huang and Kilic (2018) and Seo and Wachter (2016).




                                                        18
form (3), where


                                    µd (x) = k0d + k1d x,                               (36)

                               σc (x)σd (x) = ucd   cd
                                               0 + u1 x, ,                              (37)


with scalar k0d and ucd        d      cd                n
                     0 , with k1 and u1 row vectors in R .

   In what follows, define a m × 1 vector Zc = [Zc1 , · · · , Zcm ]> and an m × n matrix
ZX = [ZX1 , · · · ZXm ]> . Given a vector x, we use ex to denote the exponential of each
                                                                1
element in x. To evaluate expressions at γ = 1, apply limγ→1   1−γ
                                                                   e(1−γ)y   − 1 = y.


3.1    Value function

We first solve for the value function. Theorem 11 shows that the PDE (10) has an exact
solution in the cases ψ = 1 and ψ = 1/γ. Outside of these cases, there is no known exact
solution.
   We can, however, find an approximate analytical solution. We approximate the wealth-
consumption ratio by a log-linear function of the state variables, following Campbell and
Shiller (1988) and Campbell and Viceira (1999). In a continuous-time setting, the analogue
of the discrete-time Euler equation is the PDE for the value function. Chacko and Viceira
(2005) show that, by log-linearizing the expression for the wealth-consumption ratio within
this PDE, one obtains a PDE that admits an analytical solution. In this section, we
generalize their results.

Theorem 11. The value function takes the form (9), with


                                  I(x) ' exp{a + b> x},                                 (38)




                                            19
where a is a scalar and b is n × 1. When ψ 6= 1,


        1       1                              1               1
  a=                 (i1 log β + i0 − β) + k0 − γu0 + b> K0 + (1 − γ) b> U0 b
        i1   1 − 1/ψ                           2               2
                                                                                 !
                                                                                >
                                                       
                                                   1         (1−γ)(Zc +Z b)
                                                +        Eν e            X
                                                                             −1    l0 , (39)
                                                  1−γ

and

 1                                       1       1                         >
   (1 − γ) b> U1 b − i1 b> + b> K1 + k1 − γu1 +     Eν e(1−γ)(Zc +ZX b) − 1
                                                      
                                                                               l1 = 0, (40)
 2                                       2      1−γ

                            1 −1
                               
              E log βI(Xt ) ψ
with i1 = e                           and i0 = i1 (1 − log i1 ). For ψ = 1, (38) is exact, and (39)
                                                            1
and (40) hold with limψ→1 i1 = β and limψ→1                   1
                                                           1− ψ
                                                                  (i1 log β + i0 − β) = 0. Given (38), the
wealth-consumption ratio follows from Corollary 2.

   It follows immediately from (40) that the vector b is nonzero if and only if at least one
state variable affects the consumption distribution directly, either through the mean (k1 ),
the variance u1 , or the jump probability l1 .


3.2     State price density

We next characterize the state-price density and the riskfree rate.

Theorem 12. The state-price density is given by

                                                                  m
                            dπt                        X
                                = µπt− dt + σπt− dBt +     (eZπj − 1)dNjt ,                          (41)
                            πt−                        j=1


where
                                                                 >
                                                        1      >
                                      σπt   ' −γσct ,     − γ b σXt                                  (42)
                                                        ψ

and
                                                               
                                                           1
                                      Zπj ' −γZcj +          − γ b> ZXj .                            (43)
                                                           ψ

                                                      20
where b is given in Theorem 11. Furthermore,

                                             m
                                             X
                               µπt = −rt −         λjt Eνj [eZπj − 1]
                                             j=1


where rt , the riskfree rate, is given by

                                                                 
         1             1          1                  1     1        1
                                                                        b> U0 b + b> U1 b Xt
                                                                                          
  rt ' β+ (k0 +k1 Xt )− γ 1 +          (u0 +u1 Xt )−    γ−      1−
         ψ             2          ψ                  2     ψ        ψ
                                                              >
                  1
                                                           
                                                         1
                       e(1−γ)(Zc +ZX b) − 1 − e−γZc + ψ −γ ZX b − 1
                                           
      + Eν    1−                                                        (l0 + l1 Xt ). (44)
                  θ

The approximations are exact in the case of ψ = 1 and γ = ψ1 .

   This theorem shows that derivatives with respect to the value function in Corollaries 6
and 8 can be replaced with the simpler constant vector b. Moreover, the rare events’ impact
on marginal utility πt can be replaced by the simpler expression (43).


3.3    Equity prices in the affine model

The value of equity is an integral of expected future dividends paid increasingly far in
the future. That equity takes the form (18) is powerful information that we can exploit
to derive an analytical solutions. Rather than solving for (18) all at once, we can solve
for individual components. These components have an economic interpretation: they are
prices of future dividends paid at specific points in time, otherwise known as equity strips
(Lettau and Wachter, 2007). Once we have these components, the solution for the overall
price is a one-dimensional integral over the horizon, where the integrand is a well-behaved
function.
   It is here that we depart most significantly from the previous literature in our solution
method. The previous literature uses log-linearization to compute the price-dividend ratio
(see Appendix B). However, by applying the economic insight that the market is an integral
of expected future dividends, we can reduce the problem from two approximations to only


                                              21
one, and give exact analytical solutions in the special cases of time-additive utility and
ψ = 1.
   The following theorem gives the value of the equity strip with maturity τ .

Theorem 13. Let H(D, x, τ ) denote the price of an asset that pays dividend D, τ years
in the future. Then
                              H(D, x, τ ) ' D exp aφ (τ ) + bφ (τ )> x ,
                                                 
                                                                                              (45)

where functions aφ (τ ) : [0, ∞) → R and bφ (τ ) : [0, ∞) → Rn solve

                                           
  ∂aφ (τ )     d    1         1           1                      >
           = k0 − k0 − β + γ 1 +              u0 − γucd
                                                     0 + bφ (τ ) K0
    ∂τ              ψ         2          ψ
                                                                       
             1        1         1     >        1     >                1
           +       1−      γ−        b U0 b + bφ (τ ) U0 bφ (τ ) +      − γ bφ (τ )> U0 b
             2        ψ         ψ              2                     ψ
        
                 1
                      
                                              −γZc +Zd +ZX (bφ (τ )+(1/ψ−γ)b)    >
                         (1−γ)(Zc +ZX b)
    + Eν           −1 e                  −1 + e                                 −1        l0 , (46)
                 θ

and

                >                     
      ∂bφ (τ )      1       1          1                       >
                      k1d
             = − k1 + γ 1 +                u1 − γucd
                                                   1 + bφ (τ ) K1
        ∂τ          ψ       2          ψ
                                                                    
           1      1          1     >       1      >                1
         +     1−       γ−        b U1 b + bφ (τ ) U1 bφ (τ ) +      − γ bφ (τ )> U1 b
           2      ψ          ψ             2                       ψ
        
             1
                  
                                           −γZc +Zd +ZX (bφ (τ )+(1/ψ−γ)b)    >
                      (1−γ)(Zc +ZX b)
      + Eν     −1 e                   −1 + e                                 −1        l1 . (47)
             θ

The approximations are exact if utility is time-additive or if ψ = 1.

   Given the above result, the price of the claim to all future dividends follows immediately.

Corollary 14. Let S(Dt , Xt ) denote the time t price of an asset that pays the stream of
dividends given by (3), then

                                            Z   ∞
                            S(Dt , Xt ) =           H(Dt , Xt , τ )dτ = Dt G(Xt ),            (48)
                                            0




                                                        22
where H is defined in (45) and G, the price-dividend ratio, satisfies

                                                 Z   ∞
                                                                        >X
                                      G(Xt ) '           eaφ (τ )+bφ (τ )    t
                                                                                 dτ.                   (49)
                                                 0


The approximation is exact if utility is time-additive or if ψ = 1.

    While we have written Theorems 12 and 13, as well as Corollary 14 in terms of approx-
imations, both results are exact given the state-price density in Theorem 12. Furthermore,
these results are all exact in the case of ψ = 1 and time-additive utility.12
    Corollary 14 applies to the asset that pays aggregate consumption as dividend, that is,
µd = µc , σd = σc and Zdj = Zcj for all j = 1, · · · , m. It follows that this theorem provides
an alternative way to solve for the wealth-consumption ratio Gc (Xt ). Indeed, when we set
ψ = 1 in the equations in this theorem, we find aφ (τ ) = −βτ and bφ (τ ) = 0, verifying that
Gc (Xt ) = β −1 . However, when ψ 6= 1, the wealth consumption ratio calculated using (49),
is not the same as (12). Which one is a better approximation? We return to this question
in Section 4.
    We now turn to risk premia. Despite the potential complexity of this model, risk premia
for equity strips always take a simple form. First note that the expected return on zero-
coupon equity is
                                rH(τ ) (x) = µH(τ ) (x) + λ(x)> J¯H(τ ) (x)

Corollary 15.          1. Consider the claim to the dividend τ years in the future, where divi-
       dends follow the process (3). The risk premium on this claim equals

                                      1
          H(τ )
         rt       − rt ' γσct σdt −  − γ b> σXt σXt
                                                  >
                                                    bφ (τ )
                                  ψ
                                                                                    
                                                    1
                                                      −γ b> Zπj      Zdj +bφ (τ )> ZXj
                               X           −γZcj + ψ
                             −   λjt Eνj e                      −1 e                   −1   (50)
                                 j

  12
     Note, however, that Theorem 11 is approximate in the case of time-additive utility. The distinction is
that it is not necessary to obtain the value function to price securities when utility is time-additive. The
value function does have an exact solution in this case, but we do not give it here.



                                                         23
  2. Consider the claim to the stream of dividends. The risk premium on this claim equals

                                  1                                            >
                                              
                                                   >        >       1       ∂S
        rtS   − rt ' γσct σdt −        −γ b            σXt σXt
                                   ψ                                S       ∂X
                                                                                                                     
                                                                                 1
                                                                                            b> Zπj
                                       X                             −γZcj +       −γ
                                   −              λjt Eνj           e            ψ                   − 1 JSt (Zdj , ZXj ) , (51)
                                          j


      where
                                                                ∞                           >
                                                                       eaφ (τ )+bφ (τ ) x
                                                         Z
                            1 ∂S   1 ∂G
                                 =      =                           R ∞ a (u)+b (u)> x bφ (τ )dτ                           (52)
                            S ∂x   G ∂x                     0        0
                                                                        eφ        φ       du

      and
                                                  ∞                          >
                                                          eaφ (τ )+bφ (τ ) x
                                          Z
                                                                                       >
                     JS (x, Zd , ZX ) =                R ∞ a (u)+b (u)> x (eZd +bφ (τ ) ZX − 1) dτ                         (53)
                                              0         0
                                                           e φ       φ       du

   These expressions are exact if utility is time-additive or ψ = 1.


Proof The first result follows from the general expression for risk premia in Theorem 5, the
expression for the state-price density (Theorem 12), and the price of the asset (Theorem 13)
in the affine case. The second result follows from similar reasoning, except that we apply
Corollary 14 in place of Theorem 13.


The complex asset St is a portfolio of zero-coupon claims. The weighted-average forms of
(52) and (53) reflect this.


3.4    A guide to using these results

The previous results suggest the following step-by-step guide for tackling a solving multi-
dimensional dynamic asset pricing economy.


  1. Model the underlying stochastic structure as in (33).

  2. Compute the stochastic process for the state-price density in Theorem 12, namely σπt
      and Zπj . This requires computation of the coefficient b, which is given explicitly in
      Theorem 11.


                                                                24
  3. Compute the riskfree rate (also given in Theorem 12).

  4. Calculate the price of assets of interest (Theorem 13 and Corollary 14).

  5. Using the price, Ito’s Lemma gives the stochastic process, and risk premia are given,
        in closed form, by Theorem 5).

  6. For unconditional moments, one can readily simulate from the process in (33) (ap-
        proximating the continuous-time dynamics with a discrete-time process as necessary),
        calculate a time series of price-dividend ratios from (49), dividend growth from (3),
        and from there, a series of returns.13


   A strength of the method is how it lends itself, not only to closed-form solutions, but
also to simulation. Given a simulated series of consumption growth, dividend growth,
returns, and scaled prices, one can compute any unconditional moments. Because prices
are available in closed form (up to the solution of ODEs), this method is very fast and does
not suffer from the curse of dimensionality.


3.5       Existence of solutions

Thus far we have assumed existence of the solution to the agent’s maximization problem.14
Pohl, Schmedders, and Wilms (2015) give examples in which such solutions fail to exist,
but where one can derive an apparent approximate solution (which would have no valid
economic interpretation). They also provide a simple diagnostic that helps in determining
existence. They prove that, if the wealth-consumption ratio exists for time-additive utility
at a given EIS ψ, then it will also exist for recursive utility with that ψ and γ ≥ 1/ψ.
Namely, at a given level of curvature, a preference for early resolution of uncertainty makes
the problem more well-behaved. They show their result in a discrete-time economy in
which state variables are conditionally normally distributed. It would be of interest to
  13
       For details, see Tsai and Wachter (2016), Appendix C.
  14
       See Schroder and Skiadas (1999) for existence theorems in a portfolio choice setting.



                                                     25
extend their results to the present setting, which allows for non-Gaussian shocks, and is of
course in continuous time. Such a result would be very useful because, as Theorem 11 states,
the time-additive utility case can be solved in closed-form, and one need not worry about
phantom solutions created by log-linearization. Moreover, the overwhelming majority of
empirical applications assume early resolution of uncertainty.15
    Even if a solution to (10) exists, it is possible that prices of dividends do not exist at all
maturities. This can occur if one is pricing long-term bonds (so the dividends in question are
interest payments that are fixed) in a model with time-varying disaster risk. The problem
is that long-term real default-free bonds are very safe, having negative risk premia, and
infinite prices (Wachter, 2013). The problem does not occur when the “dividends” are
actual dividends, namely risky cash flows for which a premium is required. Finally, even if
a solution for the zero-coupon claims exists, a third difficulty is that the indefinite integral
in (48) may fail to converge because the price of these claims grows exponentially as the
horizon increases. In a parametric example, Tsai and Wachter (2016) show that it suffices to
guarantee that bφ (τ ) converges to a fixed value as τ → ∞ and that limτ →∞ a(τ )/τ < 0. The
latter condition implies that H(Xt , τ ) decays geometrically, and hence that the indefinite
integral (essentially an infinite sum) converges.



4     Numerical accuracy in a calibrated economy

As an example of these techniques, consider a model with time-varying risk of disaster.
Assume n = m = 1 and Xt = λt , the disaster probability. Furthermore, let µX (x) =
                           √
κλ (λ̄ − x) and σX (x) = σλ x. We set ZXt = 0, and Zdt = φZct . We assume Zct < 0.
   15
      It is likely that their results do extend, as they rely simply on the characterization of the wealth-
consumption ratio as the solution to a fixed-point problem, and the Cauchy-Schwartz inequality.




                                                    26
Equations 39 and 40 have closed-form solutions with

                                                                           
                        1          1 −1                           1 2
                     a=      1−          (i1 log β + i0 − β) + µ − γσ + bκλ̄ ,                         (54)
                        i1         ψ                               2
                                    p
                        (κ + i1 ) − (κ + i1 )2 − 2σλ2 Eν [e(1−γ)Zc − 1]
                     b=                                                 .                              (55)
                                            (1 − γ)σλ2

When ψ = 1, these equations reduce to those in Wachter (2013).16                            It follows from
(55) that b < 0 regardless of the preference parameters. Therefore, an increase in the
probability of a rare disaster always decreases the investor’s utility. Applying the def-
initions from Section 2.4, the price of risk for λt (relative to the CCAPM) is equal to
                   √
(σπt )2 = ψ1 − γ bσλ λt , and thus is positive if and only if γ > ψ1 .
   Applying Corollary 2, we find the following approximation for the wealth-consumption
ratio:
                                                                              
                                  c            −1                  1
                                 G (λt ) ' β        exp         1−    (a + bλt ) .                     (56)
                                                                   ψ

It follows from Theorem 5 that the premium for bearing λt -risk is positive if ψ > 1 and
γ > 1/ψ or if ψ < 1 and γ < 1/ψ. In the former case, the wealth-consumption ratio
decreases in λt , and the agent prefers an early resolution of uncertainty (so the price of
λt -risk is positive). In the latter case, the wealth-consumption ratio increases in λt and the
agent prefers a late resolution of uncertainty (so the price of λt -risk is negative).
   It follows from Corollary 14 that the price-dividend ratio satisfies

                                                    Z    ∞
                                                                            >λ
                                      G(λt ) '               eaφ (τ )+bφ (τ )    t
                                                                                     dτ.               (57)
                                                     0
  16
       a and b in this paper are equal to a and b in the previous paper divided by 1 − γ.




                                                             27
where

                                                 
                         1            1     1
        a0φ (τ ) = µD − µ − β +          1+     − φ γσ 2 + κλ̄bφ (τ )                               (58)
                        ψ             2     ψ
                                               
          0        1 2       2          1 2
         bφ (τ ) =  σ bφ (τ ) +     1−    bσλ − κ bφ (τ ) +
                   2 λ                  θ
                                                                           
                   11 1           2 2        1         (1−γ)Zt
                                                                     (φ−γ)Zt
                           − 1 b σ λ + Eν      −1 e            −1 +e          −1 ,                  (59)
                   2θ θ                      θ

and aφ (0) = bφ (0) = 0.
    We calibrate the model to the first two moments of aggregate market (modeled as the
dividend claim) and Treasury bill returns, assuming ψ = 2. Data on the distribution for
disasters come from Barro and Ursúa (2008). We use their benchmark cutoff of 10% to
determine whether a consumption decline constitutes a disaster. To evaluate numerical
accuracy under more extreme conditions, we also consider a cutoff of 15%. We assume
λ̄ = 0.0286, the unconditional probability of a disaster in OECD countries as reported by
Barro and Ursúa. See Tsai and Wachter (2015) for further discussion on the parameters.17
The model reconciles the high equity premium and return volatility with a low volatility
of consumption growth and a risk aversion γ of 3.
    Panel A of Figure 1 shows the wealth-consumption as a function of the disaster proba-
bility. We compare (56) with an exact solution computed using Chebyshev polynomials.18
The approximation is highly accurate for the 10% minimum disaster size calibration. It
remains accurate even for the 15% cutoff.
    Panel B of Figure 1 shows the price-dividend ratio as a function of the disaster prob-
ability. We compare (57) to the exact solution computed using Chebyshev polynomials.
We also compare it to the standard log-linear approximation of the price-dividend ra-
tio (see Appendix B). Note that while our method does require a log-linear approxima-
  17
      Other parameters are as follows: discount rate β = 0.01, normal-times consumption growth µ =
0.0195, consumption growth volatility σ = 0.0125, dividend growth µD = 0.04, φ = 3, mean-reversion
κλ = 0.12, and volatility σλ = 0.081.
   18
      We solve (A.18) using the Chebyshev polynomial method, and then convert the solution to the wealth-
consumption ratio using (12).



                                                   28
tion to the wealth-consumption ratio to find the coefficients b, it does not require log-
linearization thereafter. While (57) is nearly indistinguishable from the numerical solution,
log-linearization is notably less accurate. That is, log-linearization appears to be accurate
when applied to the wealth-consumption ratio, but much less so when applied to the price-
dividend ratio. This makes sense, because the approximations are based on proximity to
the long-run mean, and the price-dividend ratio exhibits much more variation than the
wealth-consumption ratio. Fortunately, as we show, it is unnecessary to approximate the
price-dividend ratio.
   The inaccuracies in log-linearization become more apparent when one considers the
equity premium. Using Corollary 15, we find the following expression for the risk premium
on the dividend claim:

                                1     1 ∂G               h               i
             rtS − rt = γφσc2 −    −γ        bσλ2 λt −λt Eν e−γZc − 1 eφZc − 1 ,
                                 ψ     G ∂λ
                              |       {z           }
                                     λ-premium


where
                                              ∞
                                                     eaφ (τ )+bφ (τ )λ
                                        Z
                              1 ∂G
                                   =              R ∞ a (u)+b (u)λ bφ (τ )dτ,                    (60)
                              G ∂λ        0        0
                                                      eφ        φ      du

We consider two cases, one where ψ = 1 (in which case our method is exact) and the other
where ψ = 2. The first panel shows the price-dividend ratios under the analytical method
and the log-linear approximation method described in Appendix B. The second panel shows
the λ-premium, which on average accounts for about half of the total equity premium.19
   Approximating G(λt ) by a linear function implies that (60) is replaced with a constant
coefficient. However, (60) is a concave function as Figure 2 shows. This concavity reflects
an important economic effect that log-linearization obscures. The price-dividend ratio is
a sum of claims of varying duration. When the disaster probability increases, claims to
dividends in the long-term fall in price by more than claims to dividends in the short-term
because, as in simple models of bond-pricing, higher duration implies greater sensitivity to
  19
       The other components of the equity premium are constant in λt and so we leave them out.



                                                       29
state variables. These long-term claims have greater risk premia, again, because of their
higher duration. As the disaster probability increases, risk premia on all claims increase,
but claims on the long-term assets increase by more. At the same time, these assets have
a lower weight in the overall market. Figure 2 shows that, as a result, not only does
log-linearization imply an inaccurate relation between the state variable and the equity
premium, it also overstates the equity premium. Finally, because the discount rate is
overstated, it understates the level of the price-dividend ratio, as shown in Panel A.
   Finally, we return to an issue raised the previous section. Our method suggests two
ways of approximating the wealth-consumption ratio. The first method is to use (56). We
apply this method in Panel A of Figure 1 and show it already to be already quite accurate.
The second method is to treat the wealth-consumption ratio as a special case of the price-
dividend ratio, using the log-linear approximation to compute the coefficients b, and then
using (57).
   We show the results in Figure 3, and compare them to the exact numerical solution. We
refer to the first method as log-linearization and the second as analytical, to be consistent
with the terminology in the previous figures. We consider γ = 3, and look at the case of ψ =
3 and ψ = 1/3. In the latter case, utility is time-additive and the second method is exact.
The figure clearly shows that the second method, using (57), is a closer approximation to
the true wealth-consumption ratio.
   It may seem surprising that (57) achieves greater accuracy, given that it uses a log-
linearization of the wealth-consumption ratio as an input. However, note that (57) does not
require the entire solution for the wealth-consumption ratio. It only requires the coefficient
b, because this is what enters into the state-price density. Indeed, in the special case of time-
additive utility (in the right panel), the analytical method is exact because these responses
are zero, as Theorem 12 shows. The time-additive case is an extreme manifestation of a
more general result: the prices of risk are calculated more precisely than the level of the
value function. It is the prices of risk that that enter the computation for asset prices more
generally.

                                               30
5     Conclusion

In this paper, we have extended classic results on the cross-section to the setting of rare
events. When there are no rare events, and utility is time-additive, our results reduce to the
consumption CAPM of Breeden (1979). When there are no rare events and risk aversion
is equal to one, our results reduce to the wealth CAPM of Sharpe (1964). In the rare-
event versions of these models, risk premia are not necessarily determined by covariances
with consumption in the first case, nor in the second case are risk premia necessarily
determined by covariances with wealth. Moving beyond these knife-edge cases, the sign of
risk premia relative to the consumption CAPM is determined by the agent’s preference for
early resolution of uncertainty, while the sign of risk premia relative to the wealth CAPM is
determined by whether risk aversion is below or above one. While versions of these models
without rare events lead to the usual factor structure, when rare events can occur, there
is again no reason to assume the general factor structure holds. This is perhaps surprising
given that that the factor structure has dominated empirical asset pricing for many years.
    In the second part of the paper we specialized to an affine structure and solve explicitly
for the prices of long-lived assets. These assets are integrals of prices of equity strips:
claims to dividends at specific points in time. Our solution relies on an approximation for
the wealth-consumption ratio. It is fully exact in two special cases: EIS of one and time-
additive utility. In all other cases, asset prices are exact given the approximate solution of
the wealth-consumption ratio. Despite the richness of the problem, our formulas for prices
and risk premia are quite simple. Besides being highly accurate, our approach preserves the
important intuition that long-lived assets are sums (or integrals) of individual claims. As
we show, log-linearization obscures this insight, leading to an overstatement of risk premia
and an understatement of prices. The ease and accuracy with which the equilibrium can
be computed in this framework allows for many potential applications beyond what the
literature has considered, such as jumps in the state variables, learning, and multiple sources
of risk across different asset classes.


                                              31
Appendix

A     Proof of Theorems

Proof of Proposition 1 For convenience, let Jt = J(Ct , Xt ).                             The Hamilton-Jacobi-
Bellman (HJB) equation is given by:


                                             DJ + f (C, J) = 0.                                          (A.1)


Substituting (9) into (6)–(7) yields:
                                           h                i
                                      Jt βθ I(Xt ) ψ1 −1 − 1                   ψ 6= 1,                  (A.2)
                    f (Ct , Jt ) =
                                         −Jt β(1 − γ) log I(Xt )                       ψ = 1.            (A.3)
                                     


By Ito’s Lemma:


                                      1 ∂ 2J 2 2
                                                            2              
  DJ   1     ∂J           ∂J                           1    ∂ J           >
     =          Cµc (x) +    µX (x) +        C σc (x) + tr       σ(x)σ(x)
  J    J     ∂C           ∂X          2 ∂C 2           2    ∂X 2
                                             m
                                                                                            !
                                             X
                                                   λj (x)Eνj J C eZcj , x + ZXj − J (C, x) , (A.4)
                                                                                        
                                         +
                                             j=1


Equation 9 implies:

               1 ∂J   1−γ             1 ∂ 2J    −γ(1 − γ)                  1 ∂J   1 − γ ∂I
                    =     ,                 2
                                              =           ,                     =          ,             (A.5)
               J ∂C    C              J ∂C         C2                      J ∂X     I ∂X

                                                            2                  >         !
                  1 ∂ 2J                             ∂ 2I
                                                                      
                                             1                     γ       ∂I          ∂I
                         = (1 − γ)                               − 2                             ,       (A.6)
                  J ∂X 2                     I       ∂X 2         I        ∂X          ∂X

and                                                                1−γ
                      J c eZcj , x + ZXj
                                                      
                                             (1−γ)Zcj   I(x + ZXj )
                                           =e                            .                               (A.7)
                               J                           I(x)




                                                        32
Substituting (A.5–A.7) into (A.4) yields:


  DJ                    1 − γ ∂I          1
     = (1 − γ) µc (x) +          µX (x) − γ (1 − γ) σc (x)2
   J                      "I ∂X           2
                               2 2              >       !             #
                1−γ         1 ∂ I          γ    ∂I       ∂I
             +         tr         2
                                        − 2                      σ(x)σ(x)>
                   2        I ∂X          I     ∂X      ∂X
                                       m
                                                 "                       1−γ    #
                                      X                      I(x + Z Xj )
                                   +      λj Eνj e(1−γ)Zcj                     − 1 . (A.8)
                                      j=1
                                                                I(x)


Finally, substituting (A.2) and (A.8) into (A.1) yields (10) and verifies the form (9) for
ψ 6= 1. Analogously, substituting (A.3) and (A.8) into (A.1) yields (11), and verifies (9)
for ψ = 1.


Proof of Lemma 4 Let St be the price of the asset that pays a continuous dividend
stream Dt . Then by no arbitrage,

                                            Z    ∞           
                                                      πs
                                 S t = Et                Ds ds .                    (A.9)
                                              t       πt

Multiplying each side of (A.9) by πt implies

                                             Z       ∞           
                                πt St = Et                πu Du du .               (A.10)
                                                  t


The same equation must hold at any time s > t:

                                             Z       ∞           
                                πs Ss = Et                πu Du du .               (A.11)
                                                  s


Combining (A.10) and (A.11) implies

                                                         Z   s           
                             πt St = Et πs Ss +                   πu Du du .       (A.12)
                                                          t




                                                 33
         Rt
Adding      0
                πu Du du to both sides of (A.12) implies

                                                     Z    t                                         Z    s           
                                           πt St +            πu Du du = Et πs Ss +                           πu Du du .                     (A.13)
                                                      0                                               0

                             Rt
Therefore, πt St +             0
                                   πu Du du is a martingale. By Ito’s Lemma:

            Z       t                                    Z        t                    
                                                                   Du                 >
  πt St +               πu Du du = π0 S0 +     πu Su µπ,u + µS,u +    + (σπ,u )(σS,u ) du
                0                            0                     Su
                                  Z t                           X X                            
                                +     πu Su (σS,u + σπ,u )dBu +          πuij Suij − πu−ij Su−ij , (A.14)
                                             0                                                  j   0<uij ≤t



where uij = inf{u : Nju = i} (namely, the time that the ith type j jump occurs). Adding
and subtracting the jump compensation term from (A.14) yields:

            Z       t                                    Z        t                                                       
                                                                                              Du         >      > ¯
  πt St +               πu Du du = π0 S0 +                      πu S u          µπ,u + µS,u +    + σπ,u σS,u + λu JπS (Xu ) du
                0                                             0                               Su
                                                                Z t
                                                              +     πu Su (σS,u + σπ,u )dBu
                                                                      0
                                                 X X                                                        Z    t
                                                                          πuij Suij − πu−ij Su−ij −                    λ>        ¯
                                           +                                                                            u πu Su JπS (Xu ) du, (A.15)
                                                 j   0<uij ≤t                                                  0



where we use the definition of an intensity and the fact that

                              Z        t                                            Z    t
                                           λ>        ¯                                       λ>           ¯
                                            u πu Su JπS (Xu ) du                =             u− πu− Su− JπS (Xu− ) du
                                   0                                                 0


because the integrals differ on a set of measure zero. The second and third terms on the
right-hand side of (A.15) have zero expectation. Therefore the first term in (A.15) must also
have zero expectation, and it follows that the integrand of this term must equal zero.




                                                                                    34
Proof of Corollary 8 It follows from Theorem 5 and Corollary 6 that

                                                                       
                                               1          1 ∂I
      S
  r(x) − r(x0 =     γσc (x)e>
                            1 σS (x)  −          −γ  0,            σX (x) σS (x)>
                                               ψ        I(Xt ) ∂X
                                       m
                                                    "                  1 −γ           !       #
                                      X                   I(x + ZXj ) ψ
                                    −     λj (x)Eνj                           e−γZcj − 1 J¯S (x) .
                                      j=1
                                                              I(x)

                                                                     
The result follows from adding and subtracting the expression γ 1 − ψ1 [0, I1 ∂X
                                                                              ∂I
                                                                                 σXt ]σS> and
substituting in σw (x) and Zwjt using (29) and (30).


Proof of Theorem 11 Conjecture that I(x) is approximately exponential affine. Then

                                   1 ∂I
                                         ' [b1 , · · ·   , bn ] = b> ,                       (A.16)
                                   I ∂x
                                                                     
                                               b21        · · · b1 bn
                                  1 ∂ 2I    .
                                           
                                                                  .. 
                                                                      
                                                                           >
                                       2
                                         '  ..           ···      .  = bb .                (A.17)
                                  I ∂x                               
                                             b n b2       · · · b2n


For ψ 6= 1, substitute (33), (A.16), and (A.17) into (10) of Proposition 1 to find:

                                                                  
          1
            −1         1              1       1                      1  >                 
  βI(x)   ψ= β− 1 −        (k0 +k1 x)+ γ 1 −      (u0 +u1 x)− 1 −          b K0 +b> K1 x
                       ψ              2       ψ                      ψ
                                         
      1      1                                  1                         >
                 (1 − γ) b> U0 b + b> U1 b x −     Eν e(1−γ)(Zc +ZX )b − 1
                                                      
    −     1−                                                                  (l0 + l1 x).
      2      ψ                                  θ
                                                                                             (A.18)

We use the log-linear approximation

                                     1
                                                                     1
                                                                        
                             βI(Xt ) ψ −1 ' i0 − i1 log β −1 I(Xt )1− ψ ,                    (A.19)


where i1 = eE [log(βI(Xt )       )] , and i = i (1 − log i ). Substituting (A.19) into (A.18) and
                         1/ψ−1
                                           0   1          1

matching coefficients yields (40) and (39), verifying the conjecture.
   For ψ = 1 we follow a similar derivation and note that log I(x) = a + b> x. The HJB


                                                         35
(11) can be rewritten as:


                            1
  β a + b> x = (k0 + k1 x) − γ(u0 + u1 x) + b> K0 + b> K1 x
                                                           
                            2
       1                                1                          >
    + (1 − γ) b> U0 b + b> U1 b x +         Eν e(1−γ)(Zc +ZX b) − 1
                                             
                                                                       (l0 + l1 x). (A.20)
       2                             1−γ

We then match coefficients as above. To show that the limits work out as stated, see the
Lemma below.


Lemma A.1. Let y = (k0 , k1 , u0 , u1 , K0 , K1 , U0 , U1 , l0 , l1 , ν, γ). Let I(X, ψ; y) = exp a(ψ) + b(ψ)> X
                                                                                                 

denote the value function as a function of ψ with ψ 6= 1. Suppose I(X, ψ; y) is well-defined
at (y, ψ) for ψ ∈ (1 − , 1 + ) \ {1} with solutions b(ψ) and a(ψ) given by (40) and (39). Let
˜
I(X;                                          ˜
     y) denote the value function with ψ = 1, I(X; y) is well defined at y, with solutions
                                                                              ∂I(X,ψ;y)
b̃ and ã as described in Theorem 11. Furthermore, assume limψ→1                 ∂ψ
                                                                                          < ∞ exists.
Then, limψ→1 a(ψ) = ã and limψ→1 b(ψ) = b̃.


Proof of Lemma A.1 Note that

                                                                              
                h                 1
                                      −1
                                         i            1
       i1 = exp E log βI(Xt , ψ; y) ψ        = β exp      − 1 E[log I(Xt , ψ; y)] .
                                                        ψ

Since limψ→1 1/ψ − 1 = 0, the above expression converges to β. Next, we look at the limit
of (1 − 1/ψ)−1 (i1 log β + i0 − β). For convenience, we denote I(X, ψ; y) by Iy

                                                                                               
     1                                        ( 1
                                                  −1)E[log Iy ]      1     1
                                                                            (   −1)E[log Iy ]
          (i1 log β + i0 − β) = β E[log Iy ]e   ψ               +          e  ψ               −1
  1 − 1/ψ                                                         1 − 1/ψ

When ψ → 1, 1/ψ − 1 → 0 and the first term in the bracket converges to E[log Iy ]. Apply
l’Hopital’s rule to the second term:

                                                                            1
                      1     1
                              (   −1)E[log Iy ]
                                                           exp(E[log Iy ]) ψ −1 − 1
               lim          e   ψ               − 1 = lim −         1
               ψ→1 1 − 1/ψ                            ψ→1             −1
                                                                    ψ

                                                      = −E[log Iy ].


                                                 36
Therefore, as ψ → 1, θ(i1 log β + i0 − β) = 0, that is, limψ→1 a(ψ) = ã.


Proof of Theorem 12 Equation 41 follows from Ito’s Lemma applied to Corollary 3.
Equations 42 and 43 follow from Corollary 6, substituting for I(x) from Theorem 11.
   We directly calculate µπt and then back out the riskfree rate from the no-arbitrage
condition (23). First consider ψ 6= 1. We apply Ito’s lemma to (15) to find

                           1
                              −1
                                            1
  µπt = −β (1 − θ)I(Xt )   + θ − γµc (Xt ) + γ(γ + 1)σc2 (Xt )
                            ψ
                                             2
                                                   2 
                                                           1 ∂ 2I
                                                                                 
                    1       1 ∂I            1 1                                   >
                +      −γ        µX (Xt ) +     − γ tr            σX (Xt )σX (Xt ) .
                    ψ       I ∂X            2 ψ            I ∂X 2

Substituting in for I(Xt ) and its derivatives using (A.17–A.18), together with (33), we find

                                                                                    
             1           1      1               1       1           1      >        >
                                                                                        
  µπt   ' −β− (k0 +k1 x)+ γ 1 +     (u0 +u1 x)+    1−          γ−         b U0 b+ b U1 b x
             ψ           2      ψ               2      ψ            ψ
                                         
                                        1                          >
                                            Eν e(1−γ)(Zc +ZX b) − 1
                                               
                               − 1−                                    (l0 + l1 x). (A.21)
                                        θ

   For ψ = 1, apply the same argument using (16) to find:

                                                         1 ∂I              1
 µπt = −β ((1 − γ) log I(Xt ) + 1) − γµc (Xt ) + (1 − γ)       µX (Xt ) + γ(γ + 1)σc2 (Xt )
                                                         I ∂X              2
                                                                   2
                                                                                        
                                               1         2     1 ∂   I                 >
                                             + (1 − γ) tr              σX (Xt )σX (Xt )
                                               2               I ∂X 2
                                                                    >
        = −β − (k0 + k1 x) + γ(u0 + u1 x) − Eν e(1−γ)(Zc +ZX b) − 1
                                              
                                                                        (l0 + l1 x).    (A.22)


The risk-free rate then follows from the no-arbitrage condition (23). The exact result for
time-additive utility follows from the fact that (15) reduces to

                                                 Rt
                                       πt = e−   0    β ds
                                                             βCt−γ


when θ = 0. This is the standard form of the state-price density under time-additive utility
and constant relative risk aversion.


                                                 37
   We prove a no-arbitrage theorem for equity strips, analogous to the result for long-lived
assets (Lemma 4). We omit the proof, which follows along lines similar to that of Lemma 4).

Lemma A.2. Let H (Dt , Xt , T − t) denote the time-t price of a single future dividend
payment at time T > t. For fixed T , define Ht = H (Dt , Xt , T − t). Define µH,t and σH,t
such that
                                                         m
                      dHt                          X
                          = µH,t− dt + σH,t− dBt +     JH (Xt− , Zdt )dNjt .                  (A.23)
                      Ht−                          j=1

Then no-arbitrage implies that


                                                  >
                                                     + λ>  ¯
                               µπ,t + µHt + σπ,t σHt    t JHt = 0.                            (A.24)


Proof of Theorem 13 Conjecture (45). As in the proof of Lemma A.2, fix T and define
Ht = H (Dt , Xt , T − t), which follows (A.23). Let τ = T − t. It follows from Ito’s Lemma
that
                                                                 >
                                σH (x, τ ) ' σd , bφ (τ )> σX (x) ,
                                            
                                                                                              (A.25)

and


  µH (x, τ ) ' (k0d + k1d x) + bφ (τ )> (K0 + K1 x) − a0φ (τ ) + b0φ (τ )> x
                                                                             
                                                                                           
                                               1          >                    >
                                                                                          
                                             +     bφ (τ ) U0 bφ (τ ) + bφ (τ ) U1 bφ (τ ) x , (A.26)
                                               2

where b0φ (τ ) = [b0φ1 (τ ), · · · , b0φn (τ )]> denotes the vector of derivatives with respect to τ .
Also, by Ito’s Lemma,

                                                              >Z
                              JH (x, Zd , ZX ) == eZdj +bφ (τ )    Xj
                                                                        − 1.                  (A.27)




                                                  38
Substituting (42–44) and (A.25–A.27) into the no-arbitrage condition (A.24) implies:

                                           
              1                1          1
 0 = −β − (k0 + k1 x) + γ 1 +                  (u0 + u1 x) + (k0d + k1d x) + bφ (τ )> (K0 + K1 x)
             ψ                 2         ψ
                          > !                                                  
   ∂aφ (τ )       ∂bφ (τ )          1         1          1       >            >
                                                               b U0 b + b U1 b x − γ(ucd              cd
                                                                                   
−           +                 x +       1−          γ−                                         0 + u1 x)
     ∂τ             ∂τ              2         ψ          ψ
                                                                                                 
    1          >                    >
                                                        1                   >              >
                                                                                                 
  +     bφ (τ ) U0 bφ (τ ) + bφ (τ ) U1 bφ (τ ) x +         −γ        bφ (τ ) U0 b + bφ (τ ) U1 b x
    2                                                    ψ
  
      1
                                                h                                     i>
                                                   −γZc +Zd +ZX (bφ (τ )+(1/ψ−γ)b)
                    (1−γ)(Zc +Z b)     
+       − 1 Eν e                 X
                                    − 1 + Eν e                                     −1       (l0 + l1 x).
      θ

Matching the constant terms implies (46) and matching the terms multiplying x implies
(47), satisfying the conjecture.
    For ψ = 1 and ψ = 1/γ, (42–44) hold with equality. The conjecture that (45) holds
with equality is therefore satisfied.


B    Approximating the price-dividend ratio by a log-linear func-

     tion

An alternative to the approximate solution method we propose is to log-linearize the price-
dividend ratio. That is, consider

                                      1
                                          ≈ g0 − g1 log(G(x)),                                    (B.1)
                                     G(x)

where g1 = eEν [− log G] and g0 = g1 (1 − log g1 ). Conjecture

                                                          >
                                          G(x) ' eâφ +b̂φ x ,

                           h                   i
where âφ is a scalar b̂φ = b̂φ1 , · · · , b̂φn is a column vector. Ito’s Lemma then implies that

                                            h             i>
                                       σSt = σdt , b̂φ σXt ,                                      (B.2)



                                                  39
                                                                                                                
                                                                  1                            
             µSt =    (k0d   +   k1d x)   +   b̂>
                                                φ (K0   + K1 x) +          b̂>
                                                                             φ U0 b̂φ       +       b̂>
                                                                                                      φ U1 b̂φ    x ,   (B.3)
                                                                  2

and, if ψ 6= 1,
                                                                                 1
                             JπS (x, Zc , Zd , ZX ) = e−γZc +Zd +ZX (( ψ −γ )b+b̂φ ) .                                  (B.4)

Substituting (A.21), (42) along with (B.2), (B.3) and (B.4) into the no-arbitrage condition
(21) implies:

                                      
            1             1          1
  0 = −β − (k0 + k1 x) + γ 1 +           (u0 + u1 x) + (k0d + k1d x) + b̂> φ (K0 + K1 x)
            ψ             2          ψ
                       
        1      1        1                        1 >                                     1
     +     1−      γ−        b> U0 b + b> U1 b x +          b̂φ U0 b̂φ + b̂>φ U1 b̂ >
                                                                                    φ x +
        2      ψ        ψ                               2                                     Gt
                                              
                                         1                                 
                  − γ(ucd      cd
                        0 + u1 x) +        −γ      b̂>            >
                                                     φ U0 b + b̂φ U1 b x
                                         ψ
            
               1
                   
                                            −γZc +Zd +ZX (b̂φ +( 1 −γ )b)           >
                       (1−γ)(Zc +ZX b)
       + Eν      −1 e                  −1 + e                          ψ       −1         (l0 + l1 x).
               θ

Matching coefficients on x:

                                                                                           
               1    1     1                       cd 1        1             1             1
  0=  −g1 b̂>
            φ − k1 + γ 1+           d    >
                              u1 +k1 +b̂φ K1 −γu1 +     1−           γ−            >
                                                                                 b U1 b+       − γ b̂>
                                                                                                     φ U1 b
               ψ   2      ψ                          2        ψ             ψ             ψ
                                                                                  >
    1 >      >        1        (1−γ)(Zc +ZX b)
                                                                         1
                                                     −γZc +Zd +ZX (b̂φ +( ψ −γ )b)
  + b̂φ U1 b̂φ + Eν     −1 e                   −1 +e                               −1     l1 ,
    2                 θ

and âφ is given by

                                                                                
        1            1    1       1             >       cd 1        1             1             1
  âφ =      g0 −β− k0 + γ 1 +              d
                                      u0 +k0 +b̂φ K0 −γu0 +     1−          γ−         b> U0 b+ b̂> U0 b̂φ
        g1           ψ    2       ψ                         2      ψ              ψ             2 φ
                                                                                                  !
  
     1
                       
                           1
                                                                            1
                                                                                          >
       − γ b̂>               − 1 e(1−γ)(Zc +ZX b) − 1 + e−γZc +Zd +ZX (b̂φ +( ψ −γ )b) − 1
                                                     
+             φ U0 b+Eν                                                                        l0 .
     ψ                     θ




                                                             40
References

Bai, Hang, Kewei Hou, Howard Kung, and Lu Zhang, 2018, The CAPM strikes back? An
  equilibrium model with disasters, forthcoming, Journal of Financial Economics.

Bansal, Ravi, and Amir Yaron, 2004, Risks for the long run: a potential resolution of asset
  pricing puzzles, Journal of Finance 59, 1481–1509.

Barro, Robert J., 2006, Rare disasters and asset markets in the twentieth century, Quarterly
  Journal of Economics 121, 823–866.

Barro, Robert J., and José F. Ursúa, 2008, Macroeconomic crises since 1870, Brookings
  Papers on Economic Activity 39, 255–350.

Benzoni, Luca, Pierre Collin-Dufresne, and Robert S. Goldstein, 2011, Explaining asset
  pricing puzzles associated with the 1987 market crash, Journal of Financial Economics
  101, 552 – 573.

Breeden, Douglas T., 1979, An intertemporal asset pricing model with stochastic consump-
  tion and investment opportunities, Journal of Financial Economics 7, 265–296.

Campbell, John Y., 1993, Intertemporal asset pricing without consumption data, American
  Economic Review 83, 487–512.

Campbell, John Y., 2018, Financial Decisions and Markets: A Course in Asset Pricing.
  (Princeton University Press Princeton, NJ).

Campbell, John Y., Stefano Giglio, Christopher Polk, and Robert Turley, 2018, An in-
  tertemporal CAPM with stochastic volatility, forthcoming, Journal of Financial Eco-
  nomics.

Campbell, John Y., and Robert J. Shiller, 1988, The dividend-price ratio and expectations
  of future dividends and discount factors, Review of Financial Studies 1, 195–228.



                                            41
Campbell, John Y., and Luis M. Viceira, 1999, Consumption and portfolio decisions when
  expected returns are time-varying, Quarterly Journal of Economics 114, 433–495.

Chabi-Yo, Fousseni, Stefan Ruenzi, and Florian Weigert, 2017, Crash sensitivity and the
  cross-section of expected stock returns, Forthcoming, Journal of Financial and Quanti-
  tative Analysis.

Chacko, George, and Luis Viceira, 2005, Dynamic consumption and portfolio choice with
  stochastic volatility in incomplete markets, Review of Financial Studies 18, 1369–1402.

Cochrane, John H., 2001, Asset Pricing. (Princeton University Press Princeton, NJ).

Cox, John C., Jonathan C. Ingersoll, and Stephen A. Ross, 1985, A theory of the term
  structure of interest rates, Econometrica 53, 385–408.

Cremers, Martijn, Michael Halling, and David Weinbaum, 2015, Aggregate Jump and
  Volatility Risk in the Cross-Section of Stock Returns, The Journal of Finance 70, 577–
  614.

Drechsler, Itamar, and Amir Yaron, 2011, What’s vol got to do with it, Review of Financial
  Studies 24, 1–45.

Duffie, Darrell, 1996, Dynamic Asset Pricing Theory. (Princeton University Press Prince-
  ton, NJ).

Duffie, Darrell, and Larry G Epstein, 1992a, Asset pricing with stochastic differential utility,
  Review of Financial Studies 5, 411–436.

Duffie, Darrell, and Larry G. Epstein, 1992b, Stochastic differential utility, Econometrica
  60, 353–394.

Duffie, Darrell, Jun Pan, and Kenneth Singleton, 2000, Transform analysis and asset pricing
  for affine jump-diffusions, Econometrica 68, 1343–1376.



                                              42
Duffie, Darrell, and Costis Skiadas, 1994, Continuous-time asset pricing: A utility gradient
  approach, Journal of Mathematical Economics 23, 107–132.

Epstein, Larry, and Stan Zin, 1989, Substitution, risk aversion and the temporal behavior
  of consumption and asset returns: A theoretical framework, Econometrica 57, 937–969.

Eraker, Bjorn, and Ivan Shaliastovich, 2008, An equilibrium guide to designing affine pricing
  models, Mathematical Finance 18, 519–543.

Farhi, Emmanuel, Samuel P. Fraiberger, Xavier Gabaix, Romain Ranciere, and Adrien
  Verdelhan, 2017, Crash risk in currency markets, forthcoming, Quarterly Journal of
  Economics.

Gabaix, Xavier, 2012, An exactly solved framework for ten puzzles in macro-finance, Quar-
  terly Journal of Economics 127, 645–700.

Hansen, Lars Peter, 2012, Dynamic valuation decomposition within stochastic economies,
  Econometrica 80, 911–967.

Hansen, Lars Peter, John Heaton, Junghoon Lee, and Nikolai Roussanov, 2007, Intertem-
  poral Substitution and Risk AversionElsevier vol. 6 chap. 61, pp. 3967–4056.

Huang, Darien, and Mete Kilic, 2018, Gold, Platinum, and Expected Stock Returns, Work-
  ing paper, Cornell University and University of Southern California Rochester, NY.

Lettau, Martin, and Jessica A. Wachter, 2007, Why is long-horizon equity less risky? A
  duration-based explanation of the value premium, Journal of Finance 62, 55–92.

Longstaff, Francis A., and Monika Piazzesi, 2004, Corporate earnings and the equity pre-
  mium, Journal of Financial Economics 74, 401–421.

Lu, Zhongjin, and Scott Murray, 2017, Bear Beta, forthcoming, Journal of Financial Eco-
  nomics.



                                             43
Merton, Robert C., 1973, An intertemporal capital asset pricing model, Econometrica 41,
  867–887.

Nowotny, Michael, 2011, Disaster begets crisis: The role of contagion in financial markets,
  Working paper, Boston University.

Pohl, Walter, Karl Schmedders, and Ole Wilms, 2015, Higher-Order Effects in Asset Pricing
  Models with Long-Run Risks, Working paper, University of Zurich.

Pohl, Walter, Karl Schmedders, and Ole Wilms, 2017, Higher-Order Effects in Asset Pricing
  Models with Long-Run Risks, forthcoming, Journal of Finance.

Schroder, Mark, and Costis Skiadas, 1999, Optimal consumption and portfolio selection
  with stochastic differential utility, Journal of Economic Theory 89, 68–126.

Seo, Sang Byung, and Jessica A. Wachter, 2016, Do rare events explain CDX tranche
  spreads?, Working paper, University of Houston and University of Pennsylvania.

Sharpe, W., 1964, Capital asset prices: A theory of market equilibrium under conditions
  of risk, Journal of Finance 19, 425–444.

Tsai, Jerry, and Jessica A. Wachter, 2015, Disaster Risk and Its Implications for Asset
  Pricing, Annual Review of Financial Economics 7, 219–252.

Tsai, Jerry, and Jessica A. Wachter, 2016, Rare Booms and Disasters in a Multisector
  Endowment Economy, Review of Financial Studies 29, 1113–1169.

Wachter, Jessica A., 2013, Can time-varying risk of rare disasters explain aggregate stock
  market volatility?, The Journal of Finance 68, 987–1035.




                                             44
Figure 1: Accuracy of analytical approximations: wealth-consumption and price-dividend
ratios


                                          10% minimum jump                      15% minimum jump
                                                  Panel A: Wealth-consumption ratio (φ = 1)
                              120                                     Log-linear                                      120                                 Log-linear
                                                                      Chebyshev                                                                           Chebyshev
   Wealth-consumption ratio




                                                                                           Wealth-consumption ratio
                              105                                                                                     105

                                 90                                                                                      90

                                 75                                                                                      75

                                 60                                                                                      60

                                 45                                                                                      45
                                      0       0.05            0.1              0.15                                           0   0.05            0.1              0.15
                                               Disaster probability                                                                Disaster probability

                                                          Panel B: Price-dividend ratio (φ = 3)
                                 60                                   Analytical                                         60                               Analytical
                                                                      Log-linear                                                                          Log-linear
                                                                      Chebyshev                                                                           Chebyshev
          Price-dividend ratio




                                                                                                  Price-dividend ratio




                                 45                                                                                      45


                                 30                                                                                      30


                                 15                                                                                      15


                                 0                                                                                       0
                                      0      0.05            0.1               0.15                                           0   0.05            0.1              0.15
                                              Disaster probability                                                                 Disaster probability


Notes: This figure shows the wealth-consumption ratio (Panel A) and the price-dividend
ratio (Panel B) in a model with time-varying risk of rare disaster. We compare our analyti-
cal approximation with the exact solution computed using Chebyshev polynomials. For the
price-dividend ratio, we also compare our approximation to a log-linear approximation (in
the case of the wealth-consumption ratio, the two approximations are the same). Relative
risk aversion equals 3 and the EIS equals 2. The solid line denotes the unconditional mean
of the disaster probability.




                                                                                      45
   Figure 2: Accuracy of analytical approximations: price-dividend ratios and risk premia

                                              EIS= 1                                                                           EIS= 2
                                                            Panel A: Price-dividend ratio
                        40                                                                               40
                                                                  Analytical                                                                       Analytical
                                                                  Log-linear                                                                       Log-linear

                        30                                                                               30
 Price-dividend ratio




                                                                                  Price-dividend ratio
                        20                                                                               20



                        10                                                                               10



                        0                                                                                0
                             0            0.05            0.1              0.15                               0            0.05            0.1              0.15
                                           Disaster probability                                                             Disaster probability

                                  Panel B: Compensation for variation in the disaster probability
                        25       Analytical                                                              25       Analytical
                                 Log-linear                                                                       Log-linear

                        20                                                                               20
 Premium (%)




                                                                                  Premium (%)




                        15                                                                               15


                        10                                                                               10


                        5                                                                                5


                        0                                                                                0
                             0            0.05            0.1              0.15                               0            0.05            0.1              0.15
                                           Disaster probability                                                             Disaster probability

Notes: This figure shows the price-dividend ratio (Panel A) and the annual risk premium
for variation in the disaster probability (Panel B) for two values of the EIS, in a model
with time-varying risk of rare disaster. We compare our analytical approximation (which is
exact for EIS equal to 1) to the log-linear approximation. We assume a minimum disaster
size of 15% and relative risk aversion equal to 3. The solid line denotes the unconditional
mean of the disaster probability.




                                                                                                 46
                                Figure 3: Comparing two approximations for the wealth-consumption ratio


                                          RRA= 3, EIS= 3                                                                        RRA= 3, EIS= 1/3
                               150                                     Analytical                                     150                                     Analytical
                                                                       Log-linear                                                                             Log-linear
    Wealth-consumption ratio




                                                                                           Wealth-consumption ratio
                                                                       Chebyshev                                                                              Chebyshev




                               100                                                                                    100




                               50                                                                                     50
                                     0   0.02     0.04      0.06       0.08         0.1                                     0   0.02     0.04      0.06       0.08         0.1
                                                Disaster probability                                                                   Disaster probability


Notes: We compute a first-stage solution to the wealth-consumption ratio using log-
linearization (“log-linear”). We then use our analytical method to recompute the wealth-
consumption ratio as an integral of zero-coupon claims (“Analytical”). For comparison,
we show the exact numerical solution. We assume a minimum disaster size of 15% and
relative risk aversion equal to 3. When the EIS is equal to 1/3 (right panel), the analyti-
cal approximation is exact. The solid line denotes the unconditional mean of the disaster
probability.




                                                                                      47
