                              NBER WORKING PAPER SERIES




       STRUCTURAL CHANGE WITH LONG-RUN INCOME AND PRICE EFFECTS

                                        Diego A. Comin
                                        Danial Lashkari
                                         Martí Mestieri

                                      Working Paper 21595
                              http://www.nber.org/papers/w21595


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                           September 2015, Revised April 2020




We thank Robert Barro, Sam Kortum and Kiminori Matsuyama for comments on previous drafts.
We thank the editor, six anonymous referees, Gadi Barlevy, Timo Boppart, Paco Buera, Iv an
Canay, Berthold Herrendorf, Bart Hobijn, Chad Jones, Joe Kaboski, Sam Kortum, Pete Klenow,
Dirk Krueger, Robert Z. Lawrence, Erzo Luttmer, Serguei Maliar, Alex Monge-Naranjo, Martin
Rotemberg, Orie Shelef, Chris Snyder, Tomasz Swiecki, Chris Tonetti, Kei-Mu Yi, Chris Udry,
Jing Zhang and participants in several seminar and conference presentations for useful comments
and feedback. We thank Emily Breza and Cynthia Kinnan for their help with the Indian NSS
data. We thank Ana Danieli for her outstanding assistance in a revision of an earlier draft. Comin
acknowledges the generous support of the National Science Foundation, the Institute for New
Economic Thinking and the European Commission through the H2020 grant to the FRAME
project. Mestieri acknowledges the generous support of the Agence Nationale de la Recherche
(JJCC - GRATE program) while at TSE. All remaining errors are our own. The views expressed
herein are those of the authors and do not necessarily reflect the views of the National Bureau of
Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2015 by Diego A. Comin, Danial Lashkari, and Martí Mestieri. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including © notice, is given to the source.
Structural Change with Long-run Income and Price Effects
Diego A. Comin, Danial Lashkari, and Martí Mestieri
NBER Working Paper No. 21595
September 2015, Revised April 2020
JEL No. E2,O11,O4,O5

                                          ABSTRACT

We present a new multi-sector growth model that features nonhomothetic, constant-elasticity-of-
substitution preferences, and accommodates long-run demand and supply drivers of structural
change for an arbitrary number of sectors. The model is consistent with the decline in agriculture,
the hump-shaped evolution of manufacturing, and the rise of services over time. We estimate the
demand system derived from the model using household-level data from the U.S. and India, as
well as historical aggregate-level panel data for 39 countries during the postwar period. The
estimated model parsimoniously accounts for the broad patterns of sectoral reallocation observed
among rich, miracle and developing economies. Our estimates support the presence of strong
nonhomotheticity across time, income levels, and countries. We find that income effects account
for the bulk of the within-country evolution of sectoral reallocation.

Diego A. Comin                                   Martí Mestieri
Dartmouth College                                Federal Reserve Bank of Chicago
Economics Department                             230 South LaSalle Street
6106 Rockefeller Hall, Room 327                  Chicago, Illi 60604
Hanover, NH 03755                                marti.mestieri@gmail.com
and NBER
diego.comin@dartmouth.edu

Danial Lashkari
Boston College
Economics Department
Maloney Hall 343
140 Commonwealth Avenue
Chestnut Hill, MA 02467
United States
danial.lashkari@bc.edu




A data appendix is available at http://www.nber.org/data-appendix/w21595
1        Introduction
Economies undergo large scale sectoral reallocations of employment and capital as they develop,
in a process commonly known as structural change (Kuznets, 1973; Maddison, 1980; Herrendorf
et al., 2014; Vries et al., 2014). These reallocations lead to a gradual fall in the relative size of
the agricultural sector and a corresponding rise in manufacturing. As income continues to grow,
services eventually emerge as the largest sector in the economy. Leading theories of structural
change attempt to understand these sweeping transformations through mechanisms involving
either supply or demand. Supply-side theories focus on differences across sectors in the rates of
technological growth and capital intensities, which create trends in the composition of consump-
tion through price (substitution) effects (Baumol, 1967; Ngai and Pissarides, 2007; Acemoglu
and Guerrieri, 2008). Demand-side theories, in contrast, emphasize the role of heterogeneity
in income elasticities of demand across sectors (nonhomotheticity in preferences) in driving the
observed reallocations accompanying income growth (Kongsamut et al., 2001).
        The differences in the shapes of Engel curves across sectors play a crucial role in determin-
ing the contribution of supply and demand channels to structural change.1 If relative sectoral
demand shows a strong and stable dependence on income, the demand channel can readily ex-
plain the reallocation of resources toward sectors with higher income elasticities. For instance,
rising demand for services and falling demand for agriculture, when both are compared against
manufacturing, may give rise to sizable shifts of employment from agriculture toward services.
However, demand-side theories have generally relied on specific classes of nonhomothetic prefer-
ences, e.g., generalized Stone-Geary preferences, that imply Engel curves that level off quickly as
income grows. Because of this rapid flattening-out of the slopes of relative Engel curves across
sectors, these specifications limit the explanatory power of the demand channel in the long-run.
        The empirical evidence suggests that the relationship between relative sectoral expenditure
shares and income is stable, and the slopes of relative Engel curves do not level off rapidly
as income grows. Using aggregate data from a sample of OECD countries, Figure 1 plots the
residual (log) expenditure share in agriculture (Figure 1a) and services (Figure 1b) relative to
manufacturing on the y-axis and residual (log) income on the x-axis after controlling for relative
prices.2 The depicted fit shows that a constant slope captures a considerable part of the variation
in the data and that it does not appear that the relationship levels off as aggregate consumption
    1
      Engel curves are functions characterizing how consumption expenditure on a given good varies with income
under constant prices (Lewbel, 2008). More specifically, here we focus on relative Engel curves, which we define
as the relationship between the logarithm of the relative of sectoral consumption between two sectors on the
logarithm of the aggregate real consumption, holding prices constant.
    2
      Residual Aggregate Income is constructed by taking the residuals of the following OLS regresssion: log Ytn =
α log pn            n           n     n    n                                                                 n   n
        at + β log pmt + γ log pst + ξ + νt where superscript n denotes country, and subscript t, time. Yt , pat ,
pn
 mt  , and  p n
              st denote aggregate  income, the prices of agriculture, manufacturing, and services, respectively. ξn
                                        n
denotes a country fixed effect and νt the error term. Residual log-expenditures are constructed in an analogous
manner using the log of relative sectoral expenditures as dependent variables. Table F.1 in the online appendix
reports the estimates of the regression. Section 5 shows how the slopes of the regressions depicted in Figure 1 are
connected to our theory.


                                                        1
         Figure 1: Partial Correlations of Sectoral Expenditure and Aggregate Consumption
         (a) Agriculture relative to Manufacturing                (b) Services Relative to Manufacturing




Notes: Data for OECD countries, 1970-2005. Each point corresponds to a country-year observation after
partialling-out sectoral prices and country fixed effects. The red line depicts the OLS fit, the shaded regions, the
95% confidence interval.



grows.3 As discussed below, in this paper we complement this aggregate-level evidence with
micro-level household data from the Consumption Expenditure survey (CEX) from the US and
the National Sample Survey (NSS) from India. We analyze the relationship between relative
shares and expenditure in these data, and show that sectoral differences in the estimated slopes
do not level off and remain stable across households with different expenditure levels.4
       Motivated by this evidence, we develop a multi-sector model of structural change that ac-
commodates non-vanishing nonhomotheticities. The model builds on the standard framework
used in recent empirical work on structural transformation (e.g., Buera and Kaboski, 2009;
Herrendorf et al., 2013). Our key departure from the standard framework is the introduction
of a class of utility functions that generates nonhomothetic sectoral demands for all levels of
income, including when income grows toward infinity. These preferences, which we will refer
   3
     The partial R2 of the regressions shown in Figure 1 are 27% and 20%, respectively. In fact, if we split the
sample into observations below and above the median income in the sample and estimate the relative Engel curves
separately, we cannot reject the hypothesis of identical slopes of the Engel curves. See Table F.1 in the online
appendix. If we reported separately the Engel curves for agriculture, manufacturing and services, we would find
a negative, zero and positive slope, respectively.
   4
     A number of recent papers have similarly used log-linear specifications of Engel curves in analyzing micro-level
expenditure data. Aguiar and Bils (2015) use the U.S. Consumer Expenditure Survey (CEX) to estimate Engel
curves for 20 different consumption categories. Their estimates for the income elasticities are different from unity
and vary significantly across consumption categories. Young (2012) employs the Demographic and Health Survey
(DHS) to infer the elasticity of real consumption of 26 goods and services with respect to income for 29 sub-
Saharan and 27 other developing countries. He estimates the elasticity of consumption for the different categories
with respect to the education of the household head and then uses the estimates of the return to education from
Mincerian regressions to back out the income elasticity of consumption. Young also uses a log-linear formulation
for the Engel curves and finds that the slopes of Engel curves greatly differ across consumption categories but
appear stable over time. Olken (2010) discusses Young’s exercise using Indonesia survey data and finds similar
results for a small sample of three goods and services. Young (2013) also makes use of log-linear Engel curves to
infer consumption inequality.



                                                         2
to as nonhomothetic Constant Elasticity of Substitution (CES) preferences, allow for an arbi-
trary number of goods, include good-specific nonhomotheticity parameters that control relative
income elasticities, and feature a constant elasticity of substitution. They have been studied
by Gorman (1965), Hanoch (1975), Sato (1975), and Blackorby and Russell (1981) in the con-
text of static, partial-equilibrium models. Our theory embeds these preferences into a general
equilibrium model of economic growth. The framework predicts log-linear relations between
relative sectoral allocation, relative sectoral prices, and income. Thus, it lends itself to the task
of decomposing the contributions of the demand and supply channels to structural change. As
part of our contributions, we also derive a strategy for structurally estimating the parameters
of these preferences, using both micro and aggregate data. Finally, we use the estimated model
parameters to quantify the contributions of income and price effects to structural change across
countries.
       We characterize the equilibrium paths of our growth model in the long-run and derive the
dynamics of the economy along the transition path. The equilibrium in our model asymptotically
converges to a path of constant real consumption growth. The asymptotic growth rate of real
consumption depends on parameters characterizing both the supply and demand channels; it is
a function of the sectoral income elasticities as well as sectoral growth rates of TFP and sectoral
factor intensities. In this respect, our model generalizes the results of Ngai and Pissarides (2007)
and Acemoglu and Guerrieri (2008) to the case featuring nonhomothetic CES demand. We also
show that our theory produces similar evolutions for nominal and real sectoral measures of
economic activity, which is a robust feature of the data.5 This is a consequence of the role
of income elasticities in generating sectoral reallocation patterns. Our framework can generate
hump-shaped patterns for the evolution of manufacturing consumption shares, which is a well-
documented feature in the data (Buera and Kaboski, 2012a).
       In the empirical part of the paper, we first provide household-level evidence in favor of the
stable effect of nonhomotheticities implied by nonhomothetic CES preferences. We estimate our
demand system using household-level data from the Consumption Expenditure survey (CEX)
from the US. We group household expenditures into three broad categories of products: agri-
culture, manufacturing, and services. The estimated nonhomotheticity parameters imply that
income elasticities are highest in services, lowest in agriculture, and fall in between for manufac-
turing. We also show that the estimated nonhomotheticity parameters are similar for households
across different income brackets and time periods. As mentioned above, the theory also implies
a log-linear relationship between relative sectoral consumption and the real consumption index
(derived from nonhomothetic CES). We show that this log-linear relationship approximately
holds in our data.
       We then empirically evaluate the implications of our growth model for structural transfor-
mation at the macroeconomic level. We estimate the elasticities that characterize our demand
   5
    Herrendorf et al., 2014 show that supply-side driven structural transformation cannot account for the similar
evolution of nominal and real sectoral measures of activity.


                                                       3
function using cross-country sectoral data in a panel of 39 countries for the postwar period. The
countries in our sample substantially vary in terms of their stages of development and growth
experiences (e.g., our sample includes countries such as Ghana, Taiwan, and the US). We find
that the estimated nonhomotheticity parameters are similar across different measures of sectoral
activity (employment and output) and country groupings (OECD and Non-OECD countries).
   Armed with the estimated parameters of our model, we turn to the analysis of the drivers
of structural change. We use our model to decompose the within-country evolution of relative
sectoral employment into income and price effects. We find that income effects are the main
contributors to structural transformation. They account for over 73% of the within-country
sectoral reallocation in employment predicted by the estimated model. This finding contrasts
with previous studies (e.g., Dennis and Iscan, 2009, Boppart, 2014a). A key reason for this
discrepancy is that in our framework income effects are not hard-wired to have only transitory
effects on the structural transformation (as in Stone-Geary preferences) or to be correlated with
price effects. Without these constraints on income effects, our estimates are consistent with a
predominant role of income effects in accounting for the structural transformation.
   We further present two important empirical analyses that illustrate the robustness and gen-
erality of our baseline empirical results. We first investigate the robustness of our identification
strategy and the results of our decomposition with respect to a number of alternative param-
eterizations of the nonhomothetic CES preferences. We show that, as predicted by the theory,
the estimated parameters and the resulting decomposition of the patterns of structural change
are similar across these different specifications. We then provide an additional specification of
demand suitable for estimation of household-level data in cases where sectoral price data is not
available. This specification, which identifies the rank-ordering and the relative magnitude of
nonhomotheticity parameters across sectors, allows us to extend our micro-analysis to the Na-
tional Sample Survey (NSS) data from India. Despite the vast differences in the distribution of
household-level income and the sectoral composition of consumption between the US and India,
we find that the nonhomotheticity parameters estimated using NSS data are very similar to
those estimated using US CEX data.
   Finally, we provide a number of additional extensions as well as comparisons between our
framework and prior work. We compare the predictive power of our model with the two most
prominent demand systems that feature nonhomothetic preferences: the generalized Stone-
Geary (Buera and Kaboski, 2009) and the price-independent generalized-linear (PIGL) prefer-
ences (Boppart, 2014a). We find that nonhomothetic CES preferences provide a better account
for the patterns of structural transformation across agriculture, manufacturing and services in
our cross-country sample. We further extend our analysis by shifting the focus from sectoral
shares of final good consumption expenditure or employment to those of value added, following,
e.g., Herrendorf et al. (2013). We find similar results when we repeat our analysis in terms
of value added both for household and aggregate level data. We also discuss the connection



                                                 4
between the proxies of real consumption implied by nonhomothetic CES with off-the-shelf in-
dices of real consumption. As another noteworthy extension, we take advantage of the fact that
nonhomothetic CES can accommodate an arbitrary number of goods. We extend our empirical
analysis to a richer sectoral disaggregation and document substantial heterogeneity in income
elasticity within manufacturing and services.
    Our paper relates to a large literature that aims to quantify the role of nonhomotheticity of
demand on growth and development (see, among others, Matsuyama (1992), Echevarria, 1997,
Gollin et al., 2002, Duarte and Restuccia, 2010, Alvarez-Cuadrado and Poschke, 2011).6 Buera
and Kaboski (2009) and Dennis and Iscan (2009) have noted the limits of the generalized Stone-
Geary utility function to match long time series or cross-sections of countries with different
income levels. More recently, Boppart (2014a) has studied the evolution of consumption of
goods relative to services by introducing a sub-class of PIGL preferences that also yield non-
vanishing income effects in the long-run. PIGL preferences also presuppose specific parametric
correlations for the evolution of income and price elasticities over time (Gorman, 1965), and only
accommodate two goods with distinct income elasticities. In contrast, our framework features a
constant elasticity of substitution and allows for an arbitrary number of goods.7 The differences
between the two models are further reflected in their empirical implications. Whereas we find a
larger contribution for demand nonhomotheticity in accounting for structural change, Boppart
concludes that supply and demand make roughly similar contributions.8
    The remainder of the paper is organized as follows. Section 2 introduces the properties of
the nonhomothetic CES preferences and presents the model. Section 3 presents the estimation
of the model using the household-level and aggregate data. Section 4 uses the model estimates
to investigate the relative quantitative importance of price and income effects for explaining the
observed patterns of structural transformation. Section 5 presents the robustness analysis of our
benchmark empirical specification and the analysis of the Indian NSS micro-level data. Section 6
   6
     An alternative formulation that can reconcile demand being asymptotically nonhomothetic with balanced
growth path is given by hierarchical preferences (e.g., Foellmi and Zweimüller, 2006, 2008 and Foellmi et al.,
2014). Swiecki (2017) estimates a demand system that features non-vanishing income effects in combination with
subsistence levels à la Stone-Geary. However, this demand system also imposes a parametric relation between
income and price effects. In subsequent work, Duernecker et al. (2017b) use a nested structure of nonhomothetic
CES to study structural change within services. Sáenz (2017) extends our framework to time-varying capital
intensities across production sectors and calibrates his model to South Korea. Matsuyama (2015, 2017) embeds
nonhomothetic CES preferences in a monopolistic competition framework with international trade à la Krugman
to study the patterns of structural change in a global economy and endogenizes the pattern of specialization of
countries through the home market effect. Sposi (2018) and Lewis et al. (2018) incorporate nonhomothetic CES
in a quantitative trade model of structural change.
   7
     One can extend PIGL preferences to more than two goods by nesting other functions as composites within
the two-good utility function (Boppart, 2014a), e.g., CES aggregators (this is how we proceed to estimate them
in our empirical analysis). However, the resulting utility function does not allow for heterogeneity in income
elasticity among the goods within each nested composite.
   8
     In terms of the scope of the empirical exercise, while Boppart (2014a) estimates his model with U.S. data
and considers two goods, the empirical evaluation of our model includes, in addition to the U.S., a wide range of
other rich and developing countries and more than two goods. The variable price elasticity implied by PIGL is
also quantitatively important in accounting for the difference in the decomposition results (see Section 6).



                                                       5
discusses the comparison of our model with prior accounts of nonhomothetic preferences in
models of structural change, as well as a number of additional extensions. Section 7 presents a
calibration exercise where we investigate the transitional dynamics of the model, and Section 8
concludes. Appendix A presents some general properties of nonhomothetic CES. All proofs are
in Appendix B.


2       Theory
In this section, we present a class of preferences that rationalize the empirical regularities on
relative sectoral consumption expenditures discussed in the Introduction. We then incorporate
these preferences in a multi-sector growth model and show how we can use them to account
for the patterns of structural transformation across countries. The growth model closely follows
workhorse models of structural transformation (Buera and Kaboski, 2009; Herrendorf et al.,
2013, 2014, e.g.,). The only difference with these is that we replace the standard aggregators of
sectoral consumption goods with a nonhomothetic CES aggregator. This single departure from
the standard workhorse model delivers the main theoretical results of the paper and the demand
system later used in the estimation.

2.1     Nonhomothetic CES Preferences
Consider preferences over a bundle of goods C ≡ (Ci )Ii=1 characterized by a utility function
U = F (C) implicitly defined through the constraint

                                         I                         σ−1
                                         X      1
                                                σ
                                                           Ci         σ
                                               Υi                          = 1,                              (1)
                                                        g (U )εi
                                         i=1

for a positive-valued, continuously differentiable, and monotonically increasing function g(·).
We impose the parametric restrictions that σ ∈ (0, 1) ∪ (1, ∞), Υi > 0 and εi > 0 for all
i ∈ I ≡ {1, · · · , I}.9 Each sectoral good i is identified with a nonhomotheticity parameter εi .
As we will see below, parameters ε ≡ (εi )Ii=1 control relative income (expenditure) elasticities
    9
    We can show that under these parameter restrictions the function U (·) introduced in Equation (1) is globally
monotonically increasing and quasi-concave, yielding a well-defined utility function over the bundle of goods C,
see Hanoch (1975). In the case of σ = 1, the only globally well-defined CES preferences are homothetic and
correspond to Cobb-Douglas preferences (Blackorby and Russell, 1981).




                                                           6
of demand across different goods.10,11
    Next, we first characterize the demand implied by the utility function U = F (C), and then
discuss how to use expenditure and price data to identify these preferences.

2.1.1     Nonhomothetic CES Demand

To characterize the demand system, we begin with the Hicksian demand, which has a straight-
forward derivation for nonhomothetic CES, and further illustrates the key properties of the
preferences. We then discuss the Marshallian demand and the sector-level income elasticities
implied by the preferences.

Hicksian Demand Consider the expenditure minimization problem with the set of prices
p ≡ (pi )Ii=1 and preferences defined as in Equation (1). The nonhomothetic CES Hicksian
demand function is given by
                                               p −σ
                                                 i
                                   Ci = Υi                 g(U )(1−σ)εi ,        ∀i ∈ I,                              (3)
                                                E
                                                                       PI
where we have defined E as the expenditure E =                              i=1 pi Ci .    The associated expenditure
function is                                                                           1
                                                 " I                               # 1−σ
                                                  X
                                   E(U ; p) ≡              Υi g(U )(1−σ)εi p1−σ
                                                                            i              ,                          (4)
                                                     i=1
                               PI
and gives the cost E =            i=1 pi Ci   of achieving utility U . Note that substituting the demand
for Ci from (3) in the definition of nonhomothetic CES (1), we find that each summand in (1)
corresponds to the equilibrium expenditure share. Denoting expenditure shares by ωi ≡ pi Ci /E,
Equation (1) simply implies Ii=1 ωi = 1.
                             P


Properties of the Demand System                       Two unique features of nonhomothetic CES demand
make these preferences suitable for capturing the patterns discussed in the introduction:

   1. The elasticity of the relative demand for two different goods with respect to a monotonic
  10
     In Appendix A we discuss the most general formulation of nonhomothetic CES. In this case, instead of using
an isoelastic function g(U )εi in the definition of the utility aggregator (1), an i-specific function gi (U ) is allowed
and U is implicitly defined by
                                                I                σ−1
                                               X     1
                                                     σ
                                                           Ci       σ
                                                   Υi                  = 1.                                            (2)
                                               i=1
                                                         gi (U )
This formulation allows for more general patterns of nonhomotheticity and nests our baseline formulation. The
advantage of our baseline formulation is that it delivers an estimating equation that is log-linear in terms of
observables while preserving non-vanishing nonhomotheticity.
  11
     In a previous version of the paper, we used the functional form g(U ) = U 1−σ for 0 < σ < 1 and g(U ) = U σ−1
for σ > 1. We thank the editor for suggesting replacing U with g(U ) in our definition of utility, (1).




                                                              7
         transformation g(·) of utility is constant, i.e.,

                                     ∂ log (Ci /Cj )
                                                     = (1 − σ) (εi − εj ) ,          ∀i, j ∈ I.                       (5)
                                       ∂ log g(U )

   2. The elasticity of substitution between goods of different sectors is constant12

                                             ∂ log (Ci /Cj )
                                                             = σ,            ∀i, j ∈ I.                               (6)
                                             ∂ log (pj /pi )

       The first property ensures that the nonhomothetic features of these preferences do not sys-
tematically diminish as income (and therefore utility) rises. This property helps us account
for the empirical patterns discussed in the Introduction that consumption across sectors shows
non-vanishing, stable and heterogeneous income elasticities, both at the macro and micro levels.
The second property ensures that different goods have a constant elasticity of substitution and
price elasticity regardless of the level of income.13 It is because of this property that we refer to
these preferences as nonhomothetic CES.14
       The demand system implied by nonhomothetic CES for the relative consumption expendi-
tures of goods transparently summarizes the two properties above. The Hicksian demand for
any pair of expenditure shares ωi and ωj , i, j ∈ I, satisfies
                                                                                                         
                        ωi                           pi                                                  Υi
              log                = (1 − σ) log                + (1 − σ) (εi − εj ) log g(U ) + log                .   (7)
                        ωj                           pj                                                  Υj

Equation (7) highlights one of the key features of the nonhomothetic CES demand system, which
is the separation of the price and the income effects. The first term on the right hand side shows
the price effects characterized by a constant elasticity of substitution σ, and the second term
on the right hand side shows the change in relative sectoral demand as consumers move across
indifference curves. Equation (7) implies a log-linear form for relative demand of different goods
  12
     Note that for preferences defined over I goods when I > 2, alternative definitions for elasticity of substitution
do not necessarily coincide. In particular, Equation (6) defines the so-called Morishima elasticity of substitution,
which in general is not symmetric. This definition may be contrasted from the Allen (or Allen-Uzawa) elasticity
                                  E·∂Ci /∂Pj
of substitution defined as           Ci Cj
                                             , where E is the corresponding value of expenditure. Blackorby and Russell
(1981) prove that the only preferences for which the Morishima elasticities of substitution between any two goods
are symmetric, constant, and identical to Allen-Uzawa elasticities have the form of Equation (1), albeit with a
more general dependence of weights on U .
  13
     Nonhomothetic CES preferences inherit this property because they belong to the class of implicitly additively
separable preferences (Hanoch, 1975). In contrast, any preferences that are explicitly additively separable in
sectoral goods (e.g., Stone-Geary, price independent generalized linear or constant relative income elasticity
preferences) imply parametric links between income and substitution elasticities. This result is known as Pigou’s
Law (Snow and Warren, 2015). For a discussion of specific examples, see Appendix A.
  14
     Alternatively, if we assume that consumer preferences satisfy the two properties (5) and (6) for given parameter
values (σ, ε1 , · · · , εI ), the preferences correspond to the nonhomothetic CES preferences given by Equation (1).
More specifically, imposing condition (6) defines a general class of nonhomothetic CES preferences, defined in
Equation (A.1) in the appendix. Further imposing condition (5) yields the definition in Equation (1). See
Appendix A for more details.


                                                                 8
in terms of prices and our utility aggregator, but the latter is not readily observed in the data.
Below, we show how to use the Marshallian demand to rewrite our utility aggregator in terms of
observables and obtain a log-linear demand equation in terms of observables that can be readily
estimated.

Marshallian Demand                The expenditure function in Equation (4) is monotonically increasing
in g(U ) (and therefore utility U ) under the parametric restrictions we imposed. Define the
indirect utility function V (·; p) as the inverse of function E(·; p), such that V (E(U ; p); p) = g(U )
for all U . Substituting V (E; p) for g(U ) in Equation (3), gives the expression for the Marshallian
demand expressed in terms of prices p and expenditure E.

Implicit Marshallian Demand                     We derive an alternative expression for the Marshallian de-
mand that expresses the expenditure shares of I −1 goods in terms of prices p, total expenditure
E, and the expenditure share of a base good b ∈ I.15 We first use the expression for the demand
of the base good in Equation (3) to write the function g(·) of utility in terms of the price and
expenditure of the base good, as well as the total consumption expenditure
                                                                            
                                          1                             E             1
                          εb log g(U ) +     log Υb = log                        +       log ωb .                     (8)
                                         1−σ                            pb           1−σ

Substituting for g(U ) from expression (8) in the demand for other goods i ∈ I−b ≡ I\{b}, we
find that the consumption expenditure shares satisfy
                                                                                                       !
                                  pi                       εi          E   εi                        Υi
       log ωi = (1 − σ) log                + (1 − σ)          − 1 log     + log ωb + log             ε /εb
                                                                                                                 .    (9)
                                  pb                       εb          pb  εb                       Υbi

Equation (9) gives us a collection of I − 1 constraints implied by the nonhomothetic CES
preferences that together fully characterize the Marshallian demand.

Sectoral Income Elasticities                   The income (expenditure) elasticity of demand for sectoral
good i is given by
                                                   ∂ log Ci              εi
                                            ηi ≡            = σ + (1 − σ) ,                                          (10)
                                                   ∂ log E               ε̄
where E is the consumer’s total consumption expenditure, and we have defined the expenditure-
weighted average of nonhomotheticity parameters, ε̄ ≡ Ii=1 ωi εi with ωi denoting the expen-
                                                      P

diture share in sector i as defined above.16                  Equation (10) implies that ηi > ηj if and only if
εi > εj . As Engel aggregation requires, the income elasticities average to 1 when sectoral weights
  15
     Our approach is similar in spirit to the idea of implicit Marshallian demand introduced by Lewbel and
Pendakur (2009) and M-demands introduced by Browning (1999), both of which also rely on substituting for the
utility in the Hicksian demand as a function of expenditure shares and prices.
  16
     The expenditure elasticity of relative demand is ∂ log (Ci /Cj ) /∂ log E = (1−σ)(εi −εj )/ε̄. Note the difference
with Equation (5) that expresses the elasticity instead in terms of the function g(·) of utility.


                                                               9
                                         PI
are given by expenditure shares,            i=1 ωi ηi    = 1. If good i has a nonhomotheticity parameter εi
that exceeds (is less than) the consumer’s average nonhomotheticity parameter ε̄, then good i
is a luxury (necessity) good, in the sense that it has an expenditure elasticity greater (smaller)
than 1 at that point in time. This implies that being a luxury or a necessity good is not an
intrinsic characteristic of a good, but rather depends on the consumer’s current composition of
consumption expenditures and, ultimately, income.

2.1.2       Identifiability of Nonhomothetic CES

There are classes of functions F (C) introduced in Equation (1) that can be written as monotonic
transformations of one another. To see this, note that the expressions for the implicit Marshal-
                                                                       ε /ε
lian demand in Equation (9) only depend on the ratios εi /εb , Υi /Υbi b           . Therefore, all
                                                                                          i∈I−b
uniform scalings of parameters ε and Υ imply the same patterns of observable choice behavior.
As another example, if we let εi = εb > 0 for all i and some b ∈ I, the function g(U ) satisfies:

                                                             1
                                                                       σ
                                                     I          1−σ   1−σ
                                     1              X Υi σ
                                  Υb1−σ g(U )εb   =            Ci σ       .
                                                         Υb
                                                         i=1


Therefore, the definition above for different values of εb and Υb corresponds to different isoelastic
transformations of the standard homothetic CES utility, and are observationally equivalent with
it.
       Motivated by these observations, we introduce the reparameterization  ≡ (i )Ii=1 and Ω ≡
(Ωi )Ii=1 of the nonhomothetic CES preferences corresponding to a given base good b:

                                                  εi                   Υi
                                           i ≡      ,         Ωi ≡    ε /εb
                                                                               .                             (11)
                                                  εb                  Υbi

Note that, by definition, b = Ωb = 1 for the base good. We emphasize that the construction
that follows holds and leads to identical implications for observed behavior irrespective of the
specific choice of base good b ∈ I.17
       We now show that all our variables of interest only depend on the identifiable parameters
 and Ω. For this exercise, it is helpful to consider a sequence of prices (pt )Tt=1 , expenditures
(Et )Tt=1 , consumption expenditure shares (ωt )Tt=1 , and utility (Ut )Tt=1 that all maximize the utility
function Ut = F (Ct ) defined in Equation (1) under the budget constraint Ii=1 pit Cit ≤ Et for
                                                                                     P

all 1 ≤ t ≤ T .

Identifying Nonhomothetic CES Demand                             From Equation (9), the implicit Marshallian
demand can be written solely in terms of the reparameterization. That is, the sequence of
  17
       Appendix A.2.2 generalizes this construction to bases made from arbitrary convex combinations of all goods.




                                                           10
expenditures, expenditure shares of goods, and prices satisfies
                                                                                          
                                         pit                                           Et
           log ωit = (1 − σ) log                   + (1 − σ) (i − 1) log                        + i log ωbt + log Ωi ,     (12)
                                         pbt                                           pbt

for all i 6= b and all t. As we further discuss in the next section, the implicit demand Equa-
tions (12) can be used to identify parameters  and Ω. The next lemma shows that the Mar-
shallian demand can also be fully characterized in terms of the same parameters,  and Ω.

Lemma 1. The Marshallian demand corresponding to the nonhomothetic CES preferences given
by Equation (1) can be expressed as ω (pt , Et ; σ, , Ω), where parameters (, Ω) are defined in
Equation (11) for given base good b. Similarly, the vector of sectoral income elasticities defined
in Equation (10) can also be written in terms of the same set of parameters as η (pt , Et ; σ, , Ω).

Proof. See Section B.

CES Index of Real Consumption                       The discussions above motivate a natural cardinalization
for nonhomothetic CES preferences (following the terminology of Deaton and Muellbauer 1980,
page 42). For any function g (·) and the corresponding nonhomothetic CES utility function
U = F (·) introduced in Equation (1), we define the aggregator function C ≡ G (C) as a
monotonically increasing transformation of U given by

                                                                             1
                                     log C ≡ εb log g(U ) +                     log Υb ,                                     (13)
                                                                            1−σ

as the nonhomothetic CES index of real consumption for base good b ∈ I. Note that the
definition above corresponds to the left hand side of Equation (8), implying that the index Ct
at time t can be expressed as a function of observables and the parameter σ according to
                                                                   
                                                              E              1
                                     log Ct = log                       +       log ωbt .                                    (14)
                                                              pbt           1−σ

   Using this definition, we can rewrite Equation (1) in terms of the index C, parameters  and
Ω as
                                               I                        σ−1
                                               X         1
                                                         σ
                                                                 Ci         σ
                                                     Ωi                         = 1.                                         (15)
                                                                 C i
                                               i=1

The key property of aggregator C ≡ G (C) is that the elasticity of relative demand with respect
to the value of this aggregator is constant everywhere. This is readily verified by writing Equation
(7) in terms of C,
                                                                                                                
                       ωi                               pi                                                      Ωi
             log                = (1 − σ) log                    + (1 − σ) (i − j ) log C + log                        .   (16)
                       ωj                               pj                                                      Ωj

   We refer to index C as the index of real consumption as it generalizes the standard real

                                                                  11
consumption aggregators typically assumed under homothetic CES preferences. In particular,
for the case of εi = εb > 0 for all i discussed in the beginning of the section, we find the standard
                                                  1/σ (σ−1)/σ σ/(σ−1)
                                         P                  
                                            I
definition for homothetic CES, C =              Ω
                                            i=1 i    C i              . The definition also implies a
corresponding average price index defined as P = E/C.18

Separating the Roles of Relative Prices and Income Effects Given parameters σ, , and
Ω, along with observed data on expenditures and prices, we can decompose the time variations
in relative expenditures into the component driven by variation in relative prices and that driven
by changes in utility. To see this, note that Equation (7) and the definition (8) together imply
                                                                                              
            ωit                           pit                                Et      1                Ωi
  log                 = (1 − σ) log                 + (1 − σ) (i − j ) log     +     log ωbt + log     ,
            ωjt                           pjt                                pbt   1−σ                Ωj
                                                                        |         {z          }
                                                                                            ≡log Ct
                                                                                                        (17)
where the last term on the right hand side is a constant, the first term corresponds to the
contribution of the variations in prices, and the second term to that of the variations in the
nonhomothetic CES index of real consumption log Ct , following Equation (14). Importantly,
the second term that accounts for the role of variations in utility can be written only in terms of
observables and identifiable model parameters (σ, ). This expression constitutes the foundation
of our approach to the empirical decomposition of the variations in expenditure shares in Sec-
tion 4. In particular, it allows us to distinguish the roles of relative prices and nonhomotheticity
in a simple log-linear specification.

2.2     Multi-sector Growth with Nonhomothetic CES
We now integrate the nonhomothetic CES preferences in a general-equilibrium growth model to
study the effect of the demand forces documented in the Introduction on shaping the long-run
patterns of structural change. On the supply side, the model combines two distinct potential
drivers of sectoral reallocation previously highlighted in the literature: heterogeneous rates of
sectoral technological progress (Ngai and Pissarides, 2007) and heterogeneous capital-intensity
across sectors (Acemoglu and Guerrieri, 2008).

Households             A unit mass of homogenous households has preferences over an infinite stream
of consumption bundles {Ct }∞
                            t=0 defined by utility function

                                                                  ∞
                                                                  X
                                           U    ({Ct }∞
                                                      t=0 )   ≡         β t v (F (Ct )) ,               (18)
                                                                  t=0
  18
     The homothetic CES has the property that sectoral consumption Ci grows linearly in the index of real
consumption C, when the price of good i relative to the corresponding price index pi /P remains constant. The
nonhomothetic CES index of real consumption for given base good b preserves this property only for the base
good, that is, Cb = (pi /P )−σ C.


                                                                   12
where function F (·) is defined by Equation (1) and β ∈ (0, 1) is the discount factor. To complete
the characterization of the household behavior, we assume that each household inelastically
supplies one unit of perfectly divisible labor, and starts at period 0 with a homogeneous initial
endowment A0 of assets.

Firms     Firms in each consumption sector produce sectoral output under perfect competition.
In addition, firms in a perfectly competitive investment sector produce investment good, Y0t ,
that is used in the process of capital accumulation. We assume constant-returns-to-scale Cobb-
Douglas production functions with time-varying Hicks-neutral sector-specific productivities,

                                Yit = Ait Kitαi L1−α
                                                 it
                                                     i
                                                       ,            i ∈ {0} ∪ I,

where Kit and Lit are capital and labor used in the production of output Yit in sector i at time
t (we have identified the sector producing investment good as i = 0) and αi ∈ (0, 1) denotes
sector-specific capital intensity. The aggregate capital stock of the economy, Kt , accumulates
using investment goods and depreciates at rate δ, Y0t = Kt+1 − (1 − δ) Kt .

2.2.1    Competitive Equilibrium
                                                                                  n              o
Given an initial stock of capital K0 and a sequence of sectoral productivities (Ait )Ii=0             ,a
                                                               n                                  t≥0
                                                                                                    o
competitive equilibrium is defined as a sequence of allocations Kt+1 , (Yit , Cit , Kit , Lit )Ii=0
                           n                 o                                                       t≥0
                                         I
and a sequence of prices wt , Rt , (pit )i=0   such that (i) agents maximize the present dis-
                                                      t≥0
counted value of their utility given their budget constraint, (ii) firms maximize profits and
(iii) markets clear. In this section we focus on characterizing the features of the competitive
equilibrium of this economy that motivate our empirical specifications.

Household Problem           Households take the sequence of wages, real interest rates, and prices of
goods {wt , rt , pt }∞
                     t=0 as given,   and choose a sequence of asset stocks {At+1 }∞
                                                                                  t=0 and consumption
                ∞
bundles {Ct }t=0 to maximize         their utility defined in Equations (1) and Equations (18), subject
to the per-period budget constraint

                                              I
                                              X
                                     At+1 +         pit Cit ≤ wt + (1 + rt ) At ,                  (19)
                                              i=1

where we have normalized the price of assets to 1. The next lemma provides the solution to the
household problem, and shows that it can be characterized in terms of identifiable parameters
(σ, Ω, ) for any base good b ∈ {1, · · · , I}.

Lemma 2. (Household Behavior) Consider a household with preferences as described by Equa-
tions (1) and (18) with monotonically increasing g(·), σ ∈ (0, 1) ∪ (1, ∞) and Υ, ε ≥ 0. Define


                                                            13
the function
                                                                          1
                                                                                   
                                                                                  1
                                                            −1         (σ−1)εb
                                                                 
                                            u (C) ≡ v ◦ g             Υb       C εb
                                                                                      ,

for any base good b ∈ {1, · · · , I}, as the felicity function expressed in terms of the corresponding
nonhomothetic CES index of real consumption. Assume that the function u (·) is differentiable,
monotonically increasing, concave, and satisfies ηu0 (C) ≡ Cu00 (C) /u0 (C) ≤ −θ for some θ > 0
such that
                                 
                                 1 − min ,
                                                                                         0 < σ < 1,
                              θ>                                                                             (20)
                                                                2 
                                               1          max
                                 1 − min 1 − 4 (σ − 1) min − 1
                                                                      ,                  1 < σ,


where the vector of parameters  and Ω satisfy Equation (11) for the same base good b. Given
a sequence of prices {wt , rt , pt }∞
                                    t=0 and an initial stock of assets A0 , the utility maximiza-
tion problem
           Qof households
                             subject to the budget constraint (19) and the No-Ponzi condition
             t−1     1
limt→∞ At    t0 =1 1+r 0   = 0, has a unique solution, fully characterized by the following condi-
                                t
tions.
                                                       n                       o∞
  1. The intratemporal allocations of consumption goods Ct , Et = Ii=1 pit Cit
                                                                 P
                                                                                  satisfy Cit =
                                                                                                       t=0
                         −σ    (1−σ)i
         Ωi (pit /Et )        Ct  as well as Equation (12), where the index of real consumption Ct
                                               P                     1/(1−σ)
                                                   I        i    1−σ
         at time t is implicitly given by Et =        Ω
                                                   i=1 i (Ct itp )             .

  2. The intertemporal allocation of expenditures, the nonhomothetic CES indices of real ag-
         gregate consumption, and assets {Et , Ct , At+1 }∞
                                                          t=0 satisfy the Euler equation

                                            Ct+1 u0 (Ct+1 )        1       ¯t+1 Et+1
                                                  0
                                                            =                         ,                      (21)
                                              Ct u (Ct )      β (1 + rt+1 ) ¯t Et

         and the transversality condition

                                                                        At u0 (Ct )
                                                  lim β t (1 + rt )                 = 0,                     (22)
                                                 t→∞                       t Pt
                              PI
         where it ≡           i=1 ωit i   denotes the expenditure share weighted average of the vector of
         parameters .
Proof. See Section B.

   The first insight from Lemma 2 is that the household problem can be decomposed into two
sub-problems: one involving the allocation of consumption expenditures and savings over time,
and one involving the within-period allocation of consumption across sectors conditional on the
total expenditure allocated for a given period. This is an application of two-stage budgeting
that applies to all explicitly additive preferences, in our case over time (see Blackorby et al.,
1978).

                                                              14
    The first part of the lemma characterizes the intratemporal problem of allocating consump-
tion across different goods based on the sectoral demand implied by the nonhomothetic CES
preferences. The lemma establishes that the sectoral allocations and the nonhomothetic CES
index of real consumption (for any base good b) in every period satisfy the same constraints
as those imposed by the demand in the static case. In particular, a corollary of the lemma is
that for any base good b, the sequences of expenditure shares ωt satisfy the I − 1 constraints in
Equation (12) for all i 6= b at all times t. We rely on these constraints to derive a Generalized
Method of Moments (GMM) estimator for the parameters of the model in the next section.
    The second part of the lemma characterizes the intertemporal consumption-savings problem.
The proof of the lemma shows that the household solves for the sequence of {At+1 , Ct }∞
                                                                                       t=0 that
          P t
maximizes t β u (Ct ), subject to the constraint

                                                 1      1
                                                             !          !
                                              (σ−1)εb
                      At+1 + E      g   −1
                                             Υb       Ctεb       ; pt       ≤ wt + At (1 + rt ) ,           (23)


where E (·; pt ) is the expenditure function for the nonhomothetic CES preferences, defined in
Equation (4). Conditions (20) are sufficient to ensure that the instantaneous utility term cor-
responding to this dynamic consumption/savings problem is concave in per-period expenditure
everywhere. A simple example that ensures all these conditions are satisfied is given by the
choice of g (U ) = U and v (U ) = U 1−θ − 1 / (1 − θ) with σ ∈ (0, 1) and θ > 1, which we use in
                                           

the calibration exercise in Section 7.19
    The Euler equation (21) illustrates the consequences of nonhomotheticity for the optimal
savings behavior of the households. Because of nonhomotheticity, consumption expenditure rises
nonlinearly in the index of real consumption Ct to reflect changes in the sectoral composition
of consumption as income grows. The Euler equation (21) shows that this nonlinearity creates
a wedge t+1 /t between the growth of marginal utility of consumption and the growth in
the relative price (cost-of-living) index Pt ≡ Et /Ct , compared to the benchmark case with
homothetic CES (i ≡ 1).20 The size of this wedge depends on the growth in the average income
elasticities across sectors ¯t , and varies over time.

Firm Problem           Firm profit maximization and equalization of the prices of labor and capital
across sectors pin down prices of sectoral consumption goods,
                                                                             α0 −αi
                                       αα0 (1 − α0 )1−α0
                                                                    
                                  pit                                   wt             A0t
                            pit =     = 0αi                                                ,                (24)
                                  p0t   αi (1 − αi )1−αi                Rt             Ait
  19
     We used this benchmark setup in the working paper version of this paper Comin et al. (2018), where we
imposed an alternative set of sufficient conditions to ensure the concavity: σ ∈ (0, 1) , θ > 0, and additional
constraints on the nonhomotheticity parameters i ≥ 1 for all i ∈ I. The proof of the lemma in Section B also
provides the reasoning behind this alternative sufficient condition.
  20
     Note that the dynamic implications of the model only depend on the curvature of function u(·) that, in turn,
depends on the relative curvatures of the two functions g (·) and v (·).


                                                       15
where, since the units of investment good and capital are the same, we normalize the price
of investment good, p0t ≡ 1. Equation (24) shows that price effects capture both supply-side
drivers of sectoral reallocation: heterogeneity in productivity growth rates and heterogeneity in
capital intensities.

General Equilibrium Goods market clearing ensures that household sectoral consumption
expenditure equals the value of sectoral production output, ωit Et = Pit Yit .21 Competitive goods
markets and profit maximization together imply that a constant share of sectoral output is spent
on the wage bill,
                                                                     Et
                                                Lit = (1 − αi )ωit      ,                       (25)
                                                                     wt
where ωit is the share of sector i in household consumption expenditure.
       The main prediction of the theory that we take to the data in the next section is the
intratemporal consumption decision (Equation 12 and its empirical counterpart, 37). It provides
a log-linear relationship between relative sectoral demand, relative sectoral prices, and total
expenditure that has to hold at every period. From the market-clearing Equation (25) note that

                                         Lit   1 − αi ωit
                                             =            ,           i, j ∈ I.                 (26)
                                         Ljt   1 − αj ωjt

This implies that relative sectoral employment is proportional to relative expenditure shares.
Thus, relative sectoral employment also follows the same log-linear relationship with relative
prices and total expenditure. Equation (24) suggests that relative prices capture the effect of
supply-side forces in the form of differential rates of productivity growth and heterogeneous
capital intensities in the presence of capital deepening. Therefore, given the parameters of the
nonhomothetic CES preferences, we can rely on Equation (17) to separate out the impact of
demand and supply-side forces in shaping long-run patterns of structural change.
       For the case in which there are three sectors, agriculture, manufacturing, and services, Equa-
tion (16) also makes transparent how nonhomothetic CES can generate a steady decline in agri-
cultural consumption (real and nominal), a hump-shaped pattern in manufacturing consumption
and a steady increase in services. Suppose that relative prices are constant. In this case, the
evolution of the vector of expenditure shares ωt and sectoral consumption Ct depend only on
the evolution of the index of real consumption Ct (and correspondingly utility Ut ) as well as
the relative ranking of nonhomotheticity parameters. If nonhomotheticity parameters satisfy
a < m < s , as the index Ct grows, the relative consumption of manufacturing to agriculture
and of services to manufacturing steadily grow. Thus, the share of consumption raises mono-
tonically for services and declines monotonically for agriculture. For manufacturing, it is clear
that it asymptotically has to decline too. But, it is also easy to see that the share of manufac-
turing can temporarily rise and generate an inverted U-pattern if the initial share of agricultural
  21
       In our empirical applications, we additionally account for sectoral trade flows.


                                                           16
consumption is sufficiently high.22
       Finally, we note that Equation (7) also shows how our model can generate a positive corre-
lation between relative sectoral consumption in real and nominal terms, as it is observed in the
data (Herrendorf et al., 2014). In the empirically relevant case of gross complementarity (σ < 1),
the price effect implies that relative sectoral consumption should negatively correlate with rel-
ative sectoral prices, as is the case for homothetic preferences whith gross complementarity.23
However, our demand system has an additional force: income effects. The nonhomothetic effect
of aggregate consumption affects both series in the same way and thus is a force that makes
both time series co-move. Thus, if income effects are sufficiently strong, both time series can be
positively correlated. We revisit this result in Section 6.2, where we show that this is indeed the
case empirically.

2.2.2      Constant Growth Path

We characterize the asymptotic dynamics of the economy when total factor productivities at
the sectoral level grow at heterogeneous but constant rates. To this end, let us assume that the
function u(·) is such that for some θ > 0, we have

                                                 C u00 (C)
                                               lim         = −θ.                                                 (27)
                                              C→∞ u0 (C)


Moreover, we assume that sectoral productivity growth is given by

                                       Ait+1
                                             = 1 + γi ,         i ∈ {0} ∪ I.                                     (28)
                                        Ait

Under these assumptions, the competitive equilibrium of the economy converges to a path of
constant per-capita consumption growth. Along this path, consumption expenditure, invest-
ment, and the stock of capital all grow at a rate dictated by the rate of growth of the investment
sector γ0 . Denoting the rate of growth of the index of real consumption Ct by γ ∗ , the share of
each sector i in consumption expenditure also exhibits constant growth along a constant growth
  22
      Under the assumption that relative prices remain constant, Equation (7) implies that the relative growth
rate of sector i to sector j is (i − j )γ ∗ , where γ ∗ denotes the growth rate of Ct . Using the fact that
shares add up to one, we can write the growth rate of the manufacturing sector expenditure share as gm =
((m − a )ωa − (s − m )ωs ) γ ∗ . Thus, the sign of gm depends on whether (εm − εa )ωa ≶ (s − m )ωs . Since
                                                    s −m
a < m < s , this depends on whether ωa ≶ m           ω . If the initial expenditure share in agriculture is suffi-
                                                      −a s
ciently large to satisfy the previous inequality, then the evolution of manufacturing will be hump-shaped. Since
ωa decreases monotonically and ωs increases monotonically over time, gm changes sign at most once.
   23
      To see why, note that relative real consumption is decreasing in relative prices with an elasticity of −σ, while
relative nominal expenditure is increasing with an elasticity of 1 − σ. Thus, with CES aggregators and gross
complementarity, real and nominal variables are negatively correlated–a counterfactual prediction.




                                                          17
path, characterized by constants
                                                      "                          #1−σ
                                              ωit+1          (1 + γ ∗ )i
                                 1 + ξi ≡ lim       =              αi                 .                            (29)
                                          t→∞ ωit
                                                        (1 + γ0 ) 1−α0 (1 + γi )

Given the fact that expenditures shares have to be positive and sum to 1, Equation (29) allows
us to find the rate of growth of real consumption as a function of nonhomotheticity parameters,
factor intensities, and the rates of technical growth. The next proposition characterizes the
asymptotic dynamics of the competitive equilibrium.

Proposition 1. Let γ ∗ be defined as
                                        h             αi          i1
                                mini∈I (1 + γ0 ) 1−α0 (1 + γi ) i − 1,
                                
                                                                                     0 < σ < 1,
                           γ∗ =          h             αi          i 1                                            (30)
                                                                      i
                                                                        − 1,
                                
                                max
                                     i∈I   (1 + γ 0 ) 1−α0 (1 + γ )
                                                                 i                   1 < σ.

Assume that conditions (27) and (28) hold, and that γ ∗ satisfies the following condition
                                                                                      α 0
                                                                                    − 1−α
                                                         (                                                   )
                        α0
                     − 1−α                                              (1 + γ0 )         0
         (1 + γ0 )         0   < β (1 + γ ∗ )1−θ < min                                      1               ,1 .   (31)
                                                                                        − 1−α
                                                             α0 + (1 − α0 ) (1 + γ0 )         0   (1 − δ)

Then, for any initial level of capital stock, K0 , there exists a unique competitive equilibrium
along which the index of real consumption asymptotically grows at rate γ ∗ ,24

                                                    Ct+1
                                                  lim    = 1 + γ∗.                                                 (32)
                                                 t→∞ Ct


Along the constant growth path, (i) the real interest rate is constant, r∗ ≡ (1 + γ0 )1/(1−α0 ) /β(1 +
γ ∗ )1−θ − 1, (ii) consumption expenditure, total nominal output, and the stock of capital grow at
                     1
rate (1 + γ0 ) 1−α0 , and (iii) only the subset of sectors I ∗ that achieve the minimum in Equa-
tion (30) employ a non-negligible fraction of workers.

Proof. See Section B.

       Equation (30) shows how the long-run growth rate of the nonhomothetic CES index of real
consumption is affected by nonhomotheticity parameters, i , rates of technological progress, γi ,
and sectoral capital intensities, αi . To build intuition, consider the case in which all sectors have
the same capital intensity, and preferences are homothetic. In the empirically relevant case of
σ ∈ (0, 1), Equation (30) implies that the long-run growth rate of the real consumption index
is pinned down by the sectors with the lowest technological progress, as in Ngai and Pissarides
  24
    Here we follow the terminology of Acemoglu and Guerrieri (2008) in referring to our equilibrium path as a
constant growth path. Kongsamut et al. (2001) refer to this concept as generalized balanced growth path. As
with these papers, we normalize the investment sector price. See Duernecker et al. (2017a) for a discussion on
the connection between this price normalization and chained-price indexing of real consumption.


                                                              18
(2007). Consider now the case in which there is also heterogeneity in income elasticities. In this
case, sectors with higher income elasticity and faster technological progress can co-exist in the
long-run with sectors with low income elasticity and slow technological progress. The intuition is
that the agents shift their consumption expenditure toward income-elastic good, as they become
richer, and away from goods that are becoming cheaper due to technical progress. Finally, the
role of heterogeneity in capital shares in shaping the long-run rate of consumption growth is
analogous to the role of technological progress, as they both ultimately shape the evolution of
prices.
       Which sectors survive in the long-run? At all points in time, all sectors produce a positive
amount of goods, and their production grows over time. In relative terms, however, only the
subset of sectors I ∗ satisfying Equation (30) will comprise a non-negligible share of total con-
sumption expenditure in the long-run. Indeed, if the initial number of sectors is finite, generically
only one sector survives in the long-run.

2.2.3      Transitional Dynamics

To study the transitional dynamics of the economy, we focus on the special case where all
sectors have a common capital intensity, α ≡ αi for all i, and the felicity function in terms
of the index of real consumption is isolastic, i.e., u (C) = C 1−θ − 1 / (1 − θ), where θ con-
                                                                      

trols the elasticity of intertemporal substitution.25 Let us normalize each of the aggregate
variables by their respective rates of growth, introducing normalized consumption expenditure
                    t                                                        t
Ẽt ≡ (1 + γ0 )− 1−α Et , per-capita stock of capital k̃t ≡ (1 + γ0 )− 1−α Kt , and real per-capita
consumption C̃t ≡ (1 + γ ∗ )−t Ct . Using the assets market clearing condition, we can trans-
late Equations (21) and (23) into equations that characterize the evolution of the normalized
aggregate variables
                                                            1
                                                              h                        i
                                        k̃t+1 = (1 + γ0 )− 1−α k̃tα + k̃t (1 − δ) − Ẽt ,            (33)
                            !θ−1
                    C̃t+1          t+1 Ẽt+1       1 + αk̃tα−1 − δ
                                                =                   ,                                (34)
                     C̃t            t Ẽt              1 + r∗
  25
    The online appendix characterizes the dynamics along an equilibrium path in the more general case with
heterogeneous capital intensities αi in a continuous-time rendition of the current model.




                                                       19
where the normalized consumption expenditure Ẽt is a function of C̃t and the two functions of
the growth in C̃t , that is, C̃t+1 /C̃t , as26
                          !1−σ        I
                                                           !i (1−σ)
                  Ẽt+1               X            C̃t+1
                                 =          ωit                        (1 + ξi )t ,                              (35)
                   Ẽt                i=1
                                                    C̃t
                                                  !1−σ   I                          !i (1−σ)
                          t+1            Ẽt            X          i       C̃t+1
                                 =                             ωit                                (1 + ξi )t .   (36)
                           t            Ẽt+1                      t        C̃t
                                                         i=1


Starting from any initial levels of normalized per-capita consumption C̃0 and stock of capital k̃0 ,
we can find that period’s allocation of expenditure shares ωt using Equations (3) and (4), and
compute the normalized per-capita consumption and stock of capital of the next period using
Equations (33) and (34). Proposition 1 establishes that the equilibrium path exists, is unique,
and is therefore fully characterized by the dynamic equations above.
       At the aggregate level, the transitional dynamics of this economy deviates from that of the
standard neoclassical growth model since the household’s elasticity of intertemporal substitu-
tion (EIS) varies with income.27 Goods with lower income elasticity are less intertemporally
substitutable. Since the relative shares of high and low income-elastic goods in the consumption
expenditure of households vary over time, the effective elasticity of intertemporal substitution
of households correspondingly adjusts. Typically, as income rises, low income-elastic goods con-
stitute a smaller share of the households’ expenditure and therefore the effective elasticity of
intertemporal substitution rises over time. When the economy begins with a normalized stock
of capital k̃t below its long-run level k̃ ∗ , the interest rate along the transitional path exceeds
its long-run level. With a rising elasticity of intertemporal substitution, households respond
increasingly more strongly to these high interest rates. Therefore, the accumulation of capital
and the fall in the interest rate both accelerate over time.28
       In general, the transitional dynamics of the economy can generate a rich set of different
patterns of structural transformation depending on nonhomotheticity parameters and the rates
of productivity growth of different sectors {i , γi }Ii=1 . In Section 3 we estimate the demand-side
parameters of the model using both micro and macro level data. We then use these parameters
  26
     See Section B.2 for the derivation of this result.
  27
     For general multi-good consumption/savings problems, Crossley and Low (2011) show that the standard
assumption of constant EIS imposes the strong restriction on within period allocation of consumption that the
shapes of Engel curves have to be of at most rank 2. More specifically, they show that the only nonhomothetic
preferences satisfying this restriction is the PIGL and PIGLOG preferences of Muellbauer (1975) and Muellbauer
(1976) (see also Muellbauer, 1987). As with our findings in the next section, Crossley and Low (2011) find that
the data clearly rejects this restriction on the shapes of Engel curves.
  28
     King and Rebelo (1993) discuss this mechanism in the context of a neoclassical growth model with Stone-
Geary preferences. In the current model, if the rate of productivity growth in high income-elastic sectors is
large enough, the share of these sectors may in fact fall over time, and the effective elasticity of intertemporal
substitution of households may correspondingly fall. However, as we will see in the calibration of the model in
Section 7, the empirically relevant case is one in which the share of more income-elastic goods rises as the economy
grows.



                                                            20
to calibrate the model in Section 7 and study the implications for the evolution of sectoral shares
as well as the paths of interest rate and savings.


3     Model Estimation
In this section, we bring our model to the data with two goals in mind. Our first goal is
to show that nonhomothetic CES preferences, despite their parametric parsimony, provide a
reasonable account of the relation between the sectoral composition of the economy, relative
prices, and total expenditure, both at the household and and at the aggregate levels. Our
second goal is to provide estimates of the parameters of the nonhomothetic CES preferences
(i.e., nonhomotheticity parameters, {i }i∈I , and the elasticity of substitution, σ) that can be
used to calibrate our model and study its transitional dynamics in Section 7. In both household
and aggregate data, our estimating strategy relies on the construction of Section 2.1.2 and
particularly the intratemporal specification (17) for the allocations of consumption across three
sectors: agriculture, manufacturing, and services.
    To study relative sectoral demand at the household level, we use the U.S. Consumer Expen-
diture Survey (CEX) that reports the composition of household consumption expenditures on
different final goods. For the aggregate data, we use a panel of 39 countries over the post-war
period. The sample of countries covers a wide range of growth experiences, including developing
countries (e.g., Botswana and India), miracle economies (e.g., South Korea and Taiwan) and
developed economies (e.g., the U.S. and Japan). The aggregate data contains sectoral employ-
ment, value-added output, sectoral prices and consumption per capita. We briefly discuss each
of these datasets below, and present further details on the data sources in Section D of the
online appendix.

3.1   Data Description
U.S. Household Expenditure Data             We use U.S. household quarterly consumption data
for the period 1999-2010 from the Consumption Expenditure Survey (CEX). In the CEX, each
household is interviewed about their expenditures for up to four consecutive quarters. Our data
construction is based on Aguiar and Bils (2015), who in turn follow very closely Heathcote
et al. (2010) and Krueger and Perri (2006). As these authors, we focus on a sample of urban
households with a present household head aged between 25 and 64. We also use the same
total income measure (net of taxes) and household controls as Aguiar and Bils (2015). These
controls are demographic dummies based on age range of the household head (25-37, 38-50, 51-
64), household size dummies (≤2, 3-4, 5+) and dummies for the number of household earners
(1, 2+).
    The key difference from Aguiar and Bils (2015) is that we construct our consumption cate-
gories to match expenditure in agriculture, manufacturing and services. We follow Herrendorf


                                                21
et al. (2013) to construct these three categories. The agricultural sector is composed of food-at-
home expenditures. The main expenditure categories for the manufacturing sector are vehicles,
housing equipment, other durables, clothing, shoes and personal care items. For services, these
are housing, utilities, health, food away from home, television subscriptions and other entertain-
ment fees.
    We combine the CEX data with disaggregated regional quarterly price series from the BLS’s
urban CPI (CPI-U). Similar to Hobijn and Lagakos (2005) and Hobijn et al. (2009), we construct
the price for each sector faced by a household by taking the household expenditure-weighted
average of the log-price of each of the expenditure categories belonging to the sector. Since
expenditure weights are household-specific, this allows us to, albeit imperfectly, account for the
fact that the effective price for each sector may be different across households.

Aggregate Data Our aggregate data comes from two sources. The sectoral data comes from
Groningen’s 10-Sector Database (Vries et al., 2014). The 10-Sector Database provides a long-run
internationally comparable dataset on sectoral measures for 10 countries in Asia, 9 in Europe,
9 in Latin America, 10 in Africa and the United States. The variables covered in the data set
are annual series of production value added (nominal and real) and employment for 10 broad
sectors starting in 1947. In our baseline exercise, we aggregate the ten sectors into agriculture,
manufacturing and services following Herrendorf et al. (2013). In Section 6, we estimate our
model for 10 sectors. Our consumption expenditure per capita data comes from the ninth version
of the Penn World Tables, (Feenstra et al., 2015). Combining these two datasets gives us a final
panel of 39 countries with an average number of observations of 42 years per country. As we
have discussed, the countries in our sample span very different growth trajectories. For example,
the ratio of the 90th to the 10th percentile of consumption per capita in year 2000 is 18.2.29

3.2    Household-Level Results
Empirical Strategy and Identification Following the construction of Section 2.1.2, we
assume that the sectoral composition of the consumption of each household n across sectoral
goods follows nonhomothetic CES demand for a set of identifiable parameters (σ, , Ωn ), where
we have allowed the taste shifter Ωn to potentially vary at the household level. We consider
the manufacturing sector m as the base.30 We can then write an empirical counterpart of
  29
     The countries in our sample are Argentina, Bolivia, Botswana, Brazil, Chile, Colombia, Costa Rica, Denmark
Ethiopia, France, Germany, Ghana, Hong Kong, India, Indonesia, Italy, Japan, Kenya, Korea, Malawi, Malaysia,
Mauritius, Mexico, Netherlands, Nigeria, Perú, Philippines, Senegal, Singapore, South Africa, Spain, Sweden,
Taiwan, Tanzania, Thailand, United Kingdom, United States of America, Venezuela and Zambia. In a previous
version of this paper (Comin et al., 2015), we used the Barro-Ursua dataset instead of the PWTv9.0. The main
advantage of the PWTv9.0 is that it allows us to estimate our model for all countries in the 10-sector database
(39) relative to Barro-Ursua, for which we only had data for 25 countries. We find very similar results using both
data sets.
  30
     In Comin et al. (2018), we show that if we use services instead of manufacturing as base goods b = m, we
obtain similar results.


                                                       22
Equations (17) for each sector i ∈ I−m = {a, s} as
             n                            pnit                                    Etn
                                                                                    
            ωit                                                                                              n
 log         n        = (1 − σ) log                  + (1 − σ) (i − 1) log                  + (i − 1) log ωmt + ζin + νitn (37)
            ωmt                           pnmt                                    pnmt
       n and pn denote the share of consumption and the price of sector-i goods of household
where ωit     it
n at time t, Etn denotes their total expenditure, ζin ≡ log(Ωni /Ωnm ) accounts for relative taste
parameters, and νitn for the error terms.
       Furthermore, we impose the additional assumptions that the household level taste-shocks
are linear functions of observables ζin ≡ βi0 X n + δir , and that the error term may contain com-
mon sector-time fixed effects across households νitn ≡ δit + ν̃itn . The first assumption imposes
the constraint that the cross-household heterogeneity in time-invariant taste parameters can be
fully explained as a linear function of the vector Xin of household characteristics discussed above
(age, household size, and number of earners dummies) and sector-region (ir) fixed effects. The
second assumption allows for a dyad of sector-time (it) fixed effects to absorb potential aggregate
consumption shocks. This specification identifies income elasticities based on the within-region
covariation between expenditure shares and total household expenditures, controlling for house-
hold characteristics.
       To deal with potential measurement error and endogeneity issues, we use instruments for
the observed measures of household expenditures and relative prices. First, we follow Aguiar
and Bils (2015) and instrument household expenditures (total and on the reference good) in
a given quarter with the annual household income after taxes and the income quintile of the
household. The instruments capture the permanent household income and are therefore cor-
related with household expenditures without being affected by transitory measurement error
in total expenditures.31 Second, we instrument household relative prices with a “Hausman”
relative-price instrument. Each of the prices used in the relative-price instrument is constructed
in two steps. First, for each sub-component of a sector, we compute the average price across
regions excluding the own region. Then, the sectoral price for a region is constructed using the
average region expenditure shares in each sub-component as weights.32 These price instruments
capture the common trend in U.S. prices while alleviating endogeneity concerns due to regional
shocks (and measurement error of expenditure).33
  31
     The measure of total household income corresponds to a separate question in the CEX and is not constructed
adding household expenditures over the year. Boppart (2014a) also instruments quarterly expenditure levels by
household income.
  32
     Formally, we instrument relative prices log(prit /prmt ) with log(p−r    −r               −r
                                                                         it /pmt ), where log pit for i ∈ {a, m, s} is
constructed as follows. SupposePK that      for sector j we have information on the price of subcomponents k ∈
{1, . . . , K}, then log p−r
                          it =  k=1 ω̂ r
                                       kt log p̂−r         r
                                                kt where ω̂kt denotes the average expenditure share of k in region r
         −r
and p̂kt denotes the log of the average price in the U.S. excluding region r. We have verified that constructing
the instrument using the price in the own region or the average national price delivers similar results.
  33
     Using the average price in the U.S. excluding the own region addresses the concern of regional shocks, while
capturing the common component of prices across regions. Using average expenditures in the region addresses the
concern of mismeasurement of household expenditure shares in that region to the extent that the mismeasurement
averages out in the aggregate.


                                                                  23
                         Table 1: Estimates, CEX Final Good Expenditure

                                               (1)         (2)     (3)       (4)      (5)          (6)
            σ                                0.26      0.28        0.28     0.20     0.31      0.33
                                           (0.04)    (0.04)      (0.03)   (0.05)   (0.04)    (0.05)
            a − 1                          -0.80     -0.83       -0.81    -0.70    -0.95     -0.97
                                           (0.06)    (0.07)      (0.06)   (0.07)   (0.09)    (0.10)
            s − 1                           0.65      0.68        0.75     0.67     0.82      0.85
                                           (0.07)    (0.07)      (0.06)   (0.07)   (0.09)    (0.10)
            Expenditure Re-Weighted             N           Y        N        Y         N           Y
            Region FE                           N           N        Y        Y         Y           Y
            Year × Quarter FE                   N           N        N        N         Y           Y
  Notes: All regressions include household controls (described in the text). Standard errors clustered at the
  household level shown in parenthesis. The number of observations is 60,925 in all regressions.


       Equation (37) defines a system of log-linear equations for i ∈ I−m with constraints in its
coefficients. First, there is the constraint that σ is the same across equations. Second, for each
equation, the product of the coefficient on relative prices, (1 − σ), and expenditure share on
manufacturing, (i − 1), has to be equal to the coefficient on expenditure, (1 − σ) (i − 1). We
estimate the parameters {σ, i , ζin }i∈I−m of this system of equations (imposing these constraints)
via the generalized method of moments (GMM).34
       We present our estimation results under two alternative weighting schemes. We use the
household weights provided in the CEX data to make the household sample representative of the
entire U.S. population. Additionally, we re-weight households by their total level of expenditure
to bridge the gap with the estimates with aggregate-level data.35 Comparing the alternative
weighting schemes allows us to examine the stability of the estimated parameters across income
groups.

Estimation Results Table 1 reports our estimation results. Columns (1) and (2) report the
estimates when we control only for household characteristics X h but we do not include any time
or region fixed effects. Column (1) corresponds to the weighting scheme that replicates the U.S.
population, while column (2) corresponds to the expenditure re-weighted estimates. In both
cases we find very similar estimates. The estimates show that the nonhomotheticity parameter
is lower for agriculture relative to manufacturing (a − 1 = −0.80 in column 1) and higher for
services relative to manufacturing (s − 1 = 0.65 in column 1). The price elasticity estimates
are less than one (σ = 0.26 in the first column) suggesting that agriculture, manufacturing and
services are gross complements in household preferences. Using Equation (10), we find that
the expenditure elasticities for the average household in our sample are 0.37, 0.83 and 1.20 for
  34
     We also note that our estimation strategy is different from the one proposed in Hanoch (1975). Hanoch
proposes an estimation based on double differences that can only identify I − 2 nonhomotheticity parameters.
  35
     We thank the editor for this suggestion.


                                                      24
                          Table 2: Sample Splits, CEX Final Good Expenditure

                                          < P50        > P50          Pre ’05       Post ’05
                                               (1)           (2)             (3)             (4)
                                σ            0.35        0.31               0.33        0.25
                                           (0.07)      (0.05)             (0.07)      (0.05)
                                a − 1      -0.89       -0.99              -0.98       -0.92
                                           (0.17)      (0.12)             (0.15)      (0.08)
                                s − 1       0.75        0.59               0.74        0.65
                                           (0.19)      (0.16)             (0.14)      (0.10)
        Notes: Regressions estimated using CEX-replicate weights. Households controls included in all regres-
        sions (as described in the main text). All regressions include Region and Year × Quarter fixed effects.
        Standard errors clustered at the household level. The estimation in columns (2) and (3) is performed
        imposing the constraint a ≥ 0 (by estimating an exponential transformation of the variable). The
        corresponding standard errors are computed using the delta method.


agriculture, manufacturing and services, respectively. This implies that for the average U.S.
household agricultural and manufacturing goods are necessities while services are luxury goods.
       We subsequently add region and time fixed effects in columns (3) to (6). We find very similar
coefficients to those in columns (1) and (2). An important observation from Table 1 is that our
estimates of relative income elasticities do not change significantly between the specifications
with U.S. population weights (odd columns) and those with expenditure weights (even columns).
This finding suggests that the assumption in our model of nonhomotheticity parameters {i }i∈I
being constant across income groups, provides a good description of the data.36
       Table 2 explores the stability of the slope of the relative demand in expenditure across
different subsamples of the data. First, we split households in two groups: above and below the
annual median income in the sample. Columns (1) and (2) report the estimates of specification
(37) when we estimate it separately for each subsample. We find that the estimated elasticities
are not significantly different from each other. We also study the stability of the estimates over
time and estimate our baseline regression in the pre- and post-2005 sub-samples. Columns (3)
and (4) report the estimates, where we again find estimates that are close in magnitude.
       A key prediction of nonhomothetic CES is that relative expenditure shares are log-linear in
the real consumption index. We use the estimate of the elasticity of substitution σ̂ from Table
1 in Equation (14) to obtain our measure of the nonhomothetic CES index of real consumption

                                                           Etn
                                                                 
                                                                            1
                                     log Ctn   = log                  +               n
                                                                                 log ωmt .                        (38)
                                                           pnmt           1 − σ̂

Our theory (e.g., Equation 7) implies that log-relative expenditure shares are a linear function of
  36
    Table E.1 in the online appendix reports the regression of our instruments on aggregate expenditure and
prices, which would correspond to the “first-stage” in a 2SLS setting, and show that the coefficients have the
expected sign and are significant at conventional levels.


                                                             25
Figure 2: Partial Correlation of the Real Consumption Index and Relative Log Expenditure
Shares, CEX
        (a) Agriculture relative to Manufacturing                (b) Services Relative to Manufacturing




  Notes: These plots depict the (binned) residuals corresponding to the average value of 20 equal-sized bins
  of the data. The red line depicts the linear regression between the residualized variables.


log-relative prices and the log real consumption index. Figure 2 plots the (binned) residuals after
all controls and relative prices have been partialled-out from the instrumented real consumption
measure and relative expenditure shares. As implied by our model, we find that residual variation
in relative shares is well approximated by a log-linear function of residual consumption, both
for agriculture relative to manufacturing (2a) and services relative to manufacturing (2b).

3.3    Cross-Country Aggregate-Level Results
After estimating the model with household data, we explore the ability of these preferences
preferences to account for the broad patterns of structural transformations observed across
countries during the post-war period.

Empirical Strategy and Identification                  We employ a strategy similar to the one we used
for micro data to estimate the preferences with aggregate data. Recall that our model assumes
that each country is inhabited by homogeneous households.37 Hence, the specifications discussed
in Section 2.1.2 and, in particular, Equations (12) and (17) apply to aggregate data for a set
of identifiable parameters (σ, , Ωn ), where the taste shifters Ωn can vary at the level of each
   37
      The growth model developed in Section 2.2 abstracts from within-country dispersion of income and assumes
all households are identical. In Section B of the online appendix, we derive approximate expressions for aggregate
sectoral demand in an environment featuring within-country heterogeneity in income. In particular, we show
that the equations characterizing household-level and aggregate-level allocation of expenditure are identical up to
first order of approximation in the standard deviation of the logarithm of consumption expenditure, if the latter
has a symmetric distribution such as the log-normal distribution (see Battistin et al., 2009, for evidence for the
log-normality of the distribution of total consumption expenditure across households).




                                                        26
country n. Once again, we use the manufacturing sector b = m as the base.38
       In our baseline exercise, we estimate our model from the patterns of structural change in em-
ployment. In particular, Equation (26) implies that relative sectoral consumption expenditures
are proportional to relative sectoral employment shares, yielding

            Lnit                           pnit                                    Etn
                                                                                     
                                                                                                              n
  log                  = (1 − σ) log                  + (1 − σ) (i − 1) log                  + (i − 1) log ωmt + ζin + νitn .
            Lnmt                           pnmt                                    pnmt
                                                                                                                            (39)

The term ζin denotes a country-sector fixed effect.39 In addition, we include controls for log-
sectoral exports and imports in Equation (39) to account for the fact that some goods can
be traded, thus affecting the sectoral composition of employment.40 Using employment rather
than value-added shares in Equation (39) is our favored specification for investigating the cross-
country data because it does not use the price data (an explanatory variable) to construct the
dependent variables (Section 6 shows that we find similar estimates if we use value-added shares
as dependent variables). All other steps of the estimation procedure are identical to those used
in the case of household-level data.
       Our cross-country estimation relies on the within-country variation of employment shares,
expenditure, and relative prices to identify the price and income elasticities. The identification
assumption to obtain consistent estimates is that, for each country, the shocks to relative prices
and income are uncorrelated with the relative demand shocks νitn . This assumption would
be violated if, for example, sectoral taste shocks (which are part of νitn ) are correlated with
aggregate demand or relative price shocks. To alleviate these endogeneity concerns, we estimate
our model separately for OECD and Non-OECD countries and show that the estimates do not
change significantly across sub-samples. While the estimates could in principle be biased in both
cases, this would require sectoral taste shocks (or any other omitted variable) to be correlated
with aggregate demand or relative price shocks in the same way across sub-samples, which we
deem less likely.

  38
     Section 5 shows estimates with alternative bases.
  39
     In this case ζin , in addition to constant taste parameters, log Ωn       i , also absorbs country-specific heterogeneity
in sectoral capital intensity, αin ’s.
  40
     We note also that our sectoral price measures have embedded the effect of traded intermediate inputs and that
total expenditures embed the effect of trade on income. We use the “trade detail” data from the PWT to construct
sectoral exports and imports. Agricultural trade flows correspond to trade in food and beverages. Manufacturing
trade flows correspond to trade in industrial supplies, fuels and lubricants, capital goods, transport equipment
and consumer goods. Our baseline specifications includes directly as control log-sectoral exports and imports.
Alternatively, we can rely on a model with exogenous trade flows to derive less flexible estimation equations that
control for trade flows and are consistent with the model. In this case, we need to assume that factor intensities
are identical in the production function of the same sector across different countries approach. We can then use
the accounting identity pn       n     n n           n               n
                             it Cit = pit Yit − N Xit , where N Xit denotes the nominal value of net exports in sector i,
time t and country n. It follows that the expressions for sectoral employment in sector i should be adjusted by
                                                  n
terms involving the observed values of N Xit        /pn     n
                                                       it Yit . Using this alternative model-driven controls for trade flows,
we have found results very similar to what is presented here.


                                                                27
                                Table 3: Cross-Country Estimates, m = 1

                                       World                              OECD                        Non-OECD
                                      (1)             (2)                (3)             (4)             (5)             (6)
 σ                                  0.57            0.50               0.25            0.35            0.63            0.48
                               [0.32,0.69]    [0.26,0.71]         [0.20,0.66]    [0.03,0.55]     [0.06,0.74]     [0.34,0.75]
 a − 1                            -0.98           -0.89              -0.99           -0.99           -0.91           -0.80
                             [-1.13,-0.41]   [-1.14,-0.46]    [-1.00,-0.38]     [-1.00,-0.66]   [-1.15,-0.58]   [-1.14,-0.40]
 s − 1                             0.17            0.21               0.27            0.25            0.18            0.37
                               [0.07,0.60]    [0.03,0.67]         [0.03,0.55]    [0.09,1.95]     [0.11,2.08]     [0.03,0.67]

 Country × Sector FE                  Y              Y                   Y               Y              Y               Y
 Trade Controls                       N              Y                   N               Y              N               Y
 Observations                       1626           1626                 492             492           1134            1134
  Notes: Bootstrapped 95% confidence intervals clustering at the country level shown in square brackets
  (computed through bootstrapping 50 samples with replacement). The estimation in columns (3) and (4)
  is performed imposing the constraint that a ≥ 0 (by estimating an exponential transformation of the
  variable).41


Estimation Results Table 3 reports the results obtained from estimating (39) for the full
sample of 39 countries and separately for OECD and Non-OECD sub-samples. Columns (1)
and (2) report the estimates for our entire sample with and without trade controls, respectively.
The estimated nonhomotheticity parameter is lower for agriculture relative to manufacturing
(a < 1) and larger for services compared to manufacturing (s > 1). The price elasticity is also
less than unity (σ = 0.57). Introducing trade controls hardly changes our estimates, as shown
in column (2).42 Using Equation (10), we find that the implied expenditure elasticities for the
average country-year in our sample are 0.56, 1.03 and 1.14 for agriculture, manufacturing and
services, respectively. This implies that agriculture is a subsistence good, while manufacturing
(marginally) and services are luxury goods.
       As we discuss in Section 2.1, whether good i is a luxury or a necessity is not an intrinsic
characteristic of the good. Rather, it depends on the composition of consumer expenditures and
the relative ranking of i . To illustrate this point, we compute the expenditure elasticities for the
country at the 10th decile of income per capita in our sample (Tanzania) and at the 90th decile
(the Netherlands) in year 2000. For Tanzania, we find that the expenditure elasticites are 0.57,
1.15 and 1.29 for agriculture, manufacturing and services, respectively. Thus, manufacturing
was a luxury good from the perspective of Tanzania’s representative consumer in year 2000. In
  41
     We report bootstrapped standard errors because the weighting matrix in the second step of the GMM esti-
mation when we allow for clustering at the country-level becomes almost singular, as we include a large number
of fixed effects.
  42
     In a previous version of the paper (Comin et al., 2015), we used the Barro-Ursua measures of real consumption.
In that case, we only had data for 25 countries. Almost all of the differences from our current sample come from
the fact that we now have more Non-OECD countries. We find similar estimates using either sample. Also, we
can reject the null hypothesis that log(Et ) and log(Et /pmt ) have unit roots in our sample. Thus, the variables in
our regression are not cointegrated.



                                                             28
contrast, for the Netherlands, the expenditure elasticities are 0.55, 0.95 and 1.04, implying that
manufacturing was a necessity good from the standpoint of a Dutch consumer.
    Columns (3) and (4) report the estimated elasticities for OECD countries and columns (5)
and (6) report the estimates for the Non-OECD sample. The estimates are similar for the
two sub-samples. In fact, we cannot reject the null that the estimates for the nonhomotheticity
parameters are the same for both sub-samples at conventional levels. We find that our estimates
of nonhomotheticity parameters appear to be stable across countries of different levels of income.
The point estimates of σ vary more across subsamples. We find values between 0.25 and 0.63.
However, they always remain less than unity in all specifications. The estimates appear more
stable when controlling for sectoral trade. Moreover, the estimate of any specification falls
within the confidence interval of the estimates in the other sub-samples. Overall, the similarity
of the estimates across sub-samples is reassuring, as we deem less likely that unobserved relative
demand shocks may be correlated with relative prices and income in the same way across two
such different groupings of countries.


4    Accounting for Structural Change
Next, we use our estimated model to formally evaluate the fit of the model and quantify how
much of the variation in employment shares within countries is accounted for by changes in
relative prices and the real consumption index.
    To conduct this exercise, we rely on the estimated parameters of the nonhomothetic CES
preferences based on the aggregate data in Section 3.3, and the theory developed in Section 2.1.
In particular, Equation (17) implies that the within-country variation in log-relative employment
shares can be decomposed into the contribution of income and price effects using knowledge of
the demand parameters {σ, i }i∈I , relative prices, and the nonhomothetic CES index of real
consumption C (defined in terms of observables in Equation 13). Denoting with a “hat” the
estimated parameter values, {σ̂, ˆi , ζ̂in }, the predicted values of our estimation Equations (39)
for log-relative employment shares are

                                        pnit                                  Etn
       \ n                                                                      
         Lit                                                                                             n
    log       =      (1 − σ̂) log               + (1 − σ̂) (ˆ
                                                            i − 1) log                     i − 1) log ωmt
                                                                                         + (ˆ                +ζ̂in   (40)
         Lnmt                           pnmt                                  pnmt
                     |         {z              } |                            {z                           }
                          Price Effect                               Income Effect

for i = {a, s}. Using the definition of the nonhomothetic CES index of real consumption (13),
note that the term corresponding to income effects in the estimating Equations (40) is
                                                         n                     
                                                            Et       1          n
              (1 − σ̂)(ˆ
                       i − 1)log
                              \   Ct ≡ (1 − σ̂)(ˆ
                                                i − 1) log      +        log ωmt .                                  (41)
                                                            pnmt   1 − σ̂

    To assess the overall fit of our model, we report in Table 4 the ratio of the variance of predicted


                                                         29
                   Table 4: Accounting for Structural Change, Baseline Estimates
                                                                                                           
                                                                 Agriculture                    Services
                                                      log       Manufacturing       log       Manufacturing

            Explained over Total Variance                                  0.97                         0.57
            Within over Explained Variance                                 0.46                         0.61
                                                      Within-Country Variance Decomposition
            Price Effects                                                  0.02                         0.27
            Income Effects                                                 0.98                         0.84
            Both Effects                                                   1.00                         1.00
                                                                             h  n i
                                                                \   Ln                 L
  Notes: Explained over Total Variance is computed as Var log Lnit          Var log Lnit . Within over
                                                                     mt                 mt
                                                     n                                        
                                                                                            \ Ln
                                       h                                            i
                                                     pit
  Explained Variance is computed as Var (1 − σ̂) log pn   + (1 − σ̂) (ˆ
                                                                      i − 1) log
                                                                              \   Ct Var log Lnit    .
                                                            mt                                                mt



                                              
                                          Ln
                                        \             h  n i
                                                           L
and actual log-employment shares, Var log Lnit     Var log Lnit for i = {a, s}. We find
                                                            mt                      mt

that the model explains most of the variation in data, as the two values are 0.97 for agriculture
to manufacturing employment shares and 0.57 for services relative to manufacturing.43 Next, we
compute the fraction of the predicted within-country variation in employment shares accounted
for by the price and income effects. The second row of Table 4 reports the contribution of income
and price effects to the total predicted variation in employment shares,
                                h             n                             i
                                               p
                             Var (1 − σ̂) log pnit + (1 − σ̂) (ˆ
                                                               i − 1) log
                                                                       \   Ct
                                                mt
                                                                            .                                  (42)
                                                   \  Ln
                                             Var log Lnit
                                                                 mt



We find that this ratio is 46% and 61% in the equations for agriculture and services, respectively.
The reminder of the predicted variance is accounted for the country-sector fixed effects ζ̂in and
their covariance with the within-country terms. Thus, the within-country evolution of sectoral
employment shares, which is our object of interest in studying structural change, accounts for a
substantial part of the total variation at the estimated parameter values.44
       Next, we analyze the drivers of structural change within countries. We quantify the con-
tribution of price and income effects to the predicted within-country evolution of log-relative
  43
    Figure F.1 in the online appendix depicts the predicted fit against the data.
  44
    Nevertheless, the fixed effects indeed account for a substantial share of the variation as well. This is not
surprising since countries differ widely in their relative employment shares, and country-sector fixed effects capture
the average differences across countries. These fixed effects also absorb potential differences in technological
parameters, αin .




                                                         30
employment shares by calculating
                       h              n i                         h                       i
                                      p
                    Var (1 − σ̂) log pnit                        Var (1 − σ̂)(ˆ
                                                                              i − 1)log
                                                                                     \   Ct
                                       bt
                                                   and                               .                      (43)
                           \   Ln                                         \   Ln
                                                                                 
                    Var log Ln − ζ̂i
                                it       n                         Var log Ln − ζ̂i
                                                                               it      n
                                   mt                                             mt



                                                   \ n                       n 
                                                     L                         p
for i = {a, s}, where we have used the fact that log Lnit −ζ̂in = (1 − σ̂) log pnit +(1 − σ̂) (ˆ
                                                                                               i − 1) log
                                                                                                       \   Ct
                                                                 mt                             mt
from Equation (40). The last three rows in Table 4 report this variance decomposition exercise.
They report the contribution that we obtain for price and income effects in our two estimating
equations. The last row reminds the reader that, by construction, the variance of the sum of
both terms accounts for 100% of the within-country predicted variation.
       Let us first focus on the decomposition of within-country variation in log-relative agriculture
to manufacturing employment, which corresponds to the first column in Table 4. We find quite a
dramatic result: price effects account for only 2% of the within-country variation, while income
effects alone account for 98%. For log-relative services to manufacturing employment, we find
that price effects alone account for 27% of the overall within-country variation. Income effects
alone account for 84%. These individual contributions add up to more than one because they
are not independent from each other.
       Overall, Table 4 is consistent with the view that the nonhomotheticity of demand plays
a dominant role in accounting for within-country structural change in our panel of countries.
If we attribute all the covariation in prices and consumption to prices in our full sample, we
find that the within-country variation accounted for by real consumption is 98% for the log-
relative agriculture to manufacturing equation, and 73% (=100%-0.27%) for log-relative services
to manufacturing.45 Thus, we conclude that nonhomotheticities account for over 73% of the
structural change in our sample.46
  45
      If we break down our analysis between OECD and Non-OECD countries, a similar picture emerges (see Tables
F.7 and F.8 in the online appendix). For OECD countries, we find that the contribution of price effects alone is
somewhat larger, 13% and 36%. This may partially reflect better measurement by statistical agencies. Even in
this case, income effects play a more substantial role.
   46
      This conclusion differs from Boppart (2014a) who studies the evolution of services relative to the rest of the
economy in the U.S. during the postwar period. He finds that the contribution of price and income effects are
roughly of equal sizes. First, the differences in the results are partly due to the differences in the level of sectoral
aggregation. If we confine our analysis to the U.S. and lump together agriculture and manufacturing into one
sector, we find that price effects account for 26% of the variation. Second, our specification of demand is different
from Boppart (2014a) because in our specification the price elasticity is constant. In contrast, Boppart’s demand
system implies that the price elasticity of services relative to the rest of consumption is declining as the economy
grows. As noted by Buera and Kaboski (2009), since the relative expenditure and value added of services grows
at a faster rate than services relative price, a declining price elasticity automatically increases the explanatory
power of relative prices. We have checked that a declining variable elasticity is quantitatively important for
the decomposition exercise. We have generated a synthetic panel of countries with two sectors (agriculture
plus manufacturing, and services) with preferences given by nonhomothetic CES calibrated to capture the key
features of our true cross-country panel. We then do two decomposition exercises with these data: one estimating
a nonhomothetic CES demand, and another estimating a PIGL demand. We find that the within variation
accounted for by prices is four times larger with PIGL than with nonhomothetic CES.



                                                          31
5         Additional Robustness Analyses
In this section, we present two important sets of additional empirical analyses that showcase
the robustness and generality of our results. In Section 5.1, we show that our results are robust
to using services, agriculture, or a linear combination of three sectors as base sectors instead of
manufacturing. In Section 5.2, we analyze household expenditure data from the Indian National
Sample Survey (NSS) to show that our results generalize to a developing country with average
household incomes far below that of the US. We show evidence that the estimates of relative
income elasticities based on NSS are closely in line with those presented in Section 3.2 based on
the CEX data.

5.1        Estimation with Alternative Base Sectors
Our baseline empirical specification used manufacturing as a base sector in the estimating Equa-
tions (37). Here, we show that our findings are robust to using services, agriculture, or even
more general bases as reference sectors in our empirical estimation. Section A.2.2 of the ap-
pendix generalizes the construction of Section 2.1.2 for the identification and the definition of
the nonhomothetic CES index of real consumption to one in which we can use a convex com-
bination of the different sectors as base. Table 5 compares the key results of Sections 3 and 4
using three different choices of base: manufacturing, agriculture, service, and a uniform convex
combination of all three sectors.47
         The first three rows of Table 5 provide the estimated parameters (σ, εa /εm , εs /εm ) for each
choice of base. Let bi denote the nonhomotheticity parameter for sector i corresponding to base
b following Equation (11) (or Equation A.14 in the appendix). It is easy to see that the ratios
of the parameters ε, which have to be invariant to the choice of the base b, can be written in
terms of the estimated parameters b . In particular, we can write for any base b:

                              εi     εb · bi       bi
                                 −1=          − 1 =     − 1,              i ∈ {a, s}.
                              εm     εb · bm       bm

The first column of the table reports this value under our benchmark of manufacturing as base
b = m and m
           m = 1, which also equals i − 1 in Table 3. We find that εs /εm − 1 ranges between
0.17 and 0.33 across our specifications, meaning that services are more income elastic than
manufacturing, and εa /εm − 1 ranges between -0.99 and and -0.60, implying that agriculture
is less income elastic than manufacturing. The estimated values for the price elasticity are
between 0.3 and 0.6, implying that the three sectors are estimated to be gross complements in
all specifications.48
    47
     In Comin et al. (2018), we also show results of simultaneously estimating the system of moment conditions
that combines all three sets of specifications corresponding to three different sectors as bases. The results of that
exercise is similar and in line with those reported here.
  48
     Table 9 in the appendix presents the full set of parameter estimates for all bases.



                                                         32
                        Table 5: Variance Decomposition using Alternative Bases

                                         Estimates under Alternative Bases (see Table 9)
                           Agri. as base         Manu. as base         Serv. as base         3 sec. as base
       σ                        0.33                  0.57                  0.33                   0.40
                                (0.03)                (0.07)                (0.03)                (0.04)
       εa /εm − 1               -0.67                 -0.98                 -0.86                 -0.68
                                (0.06)                (0.06)                (0.07)                (0.04)
       εs /εm − 1               0.26                  0.17                  0.23                   0.31
                                (0.05)                (0.04)                (0.05)                (0.06)

                                      Variance Decomposition using Alternative Bases
                                                                                    
                                         Agriculture                         Services
                                   log Manufacturing                 log Manufacturing

                         A-base     M-base       S-base    3-base     A-base    M-base      S-base     3-base
       Price Effects        0.03          0.02     0.02        0.03     0.10         0.27      0.16        0.08
       Income Effects       0.94          0.98     0.94        0.94     0.95         0.84      1.00        1.00
Notes: Column A-base reports the result of performing the variance decomposition in Equation (43) using the
estimates obtained with agriculture as the base sector (reported in the first three rows of column “Agri. as
base” in this table). Analogously, M-base, S-base and 3-base denote the variance decomposition results using the
estimates obtained with manufacturing, services and the linear combination of the 3 sectors as bases. Robust
standard errors shown in parenthesis.


       Finally, the last two rows of Table 5 repeat our variance decomposition for the within-country
variation in relative employment shares in Section 4 for the same four choices of bases. We find
that our decomposition results are robust to using these alternative choices for the base. Income
effects still account for the bulk of the within-country variation–in fact, using manufacturing as
base gives the lowest average value for the income effects.

5.2        Evidence from Indian Household Expenditure Data
One key challenge in revisiting the robustness of our household-level estimation in the case of
NSS data is the absence of reliable price information. To circumvent this problem, we first
present an alternative econometric specification to partially estimate our demand system when
price data are missing. This estimation strategy allows us to recover all nonhomotheticity
parameters up to a scaling constant and it can thus be used to identify the rank-ordering and
relative magnitudes of the nonhomotheticity parameters. We apply this estimation approach to
the Indian NSS household data and to the CEX (as a robustness check). We find very similar
nonhomotheticity parameters in both samples. We also show that the estimates are consistent
with our baseline specification.49
  49
    Online Appendix I elaborates on this estimation strategy and introduces two additional estimation strategies:
(i) a non-linear specification that directly incorporates the average cost index and (ii) an iterative linear least
squares approach that uses a second-order approximation of the real consumption index. Online Appendix J


                                                          33
Inference without Price Data                         Consider the following log-linear demand specification for
i ∈ {a, s}:
                                 n
                                     
                                ωit              X
                      log        n        =               ςij log pnjt + (˜
                                                                          i − ˜m ) log Etn + ζin + νitn         (44)
                                ωmt
                                              j∈{a,m,s}

where, as before, n stands for a household. On first sight, this equation appears to be an ad hoc
and naive approach to estimating demand. However, Lemma 6 in Appendix C shows that this
specification indeed identifies i −m for any base b up to a scaling factor, i.e., ˜i −˜
                                                                                         m = λ̃(i −m )
                                                         s −˜
for some λ̃ > 0. In other words, the ratio of estimates (˜         a −˜
                                                             m )/(˜   m ) is a consistent estimator
of (s −m )/(a −m ) for any base. More generally, this approach identifies I −2 nonhomotheticity
parameters and allows us to find the rank-ordering of nonhomotheticity parameters with a simple
log-linear regression.50,51
        In some instances, specially when dealing with household survey data, price data may not be
available and it may not be possible to fully estimate Equation (44) or our baseline specification,
Equation (37). This is the case for our Indian household data. Building on Equation (44),
we propose an approach that approximately retrieves the nonhomotheticity parameters of our
demand system, up to a scaling factor. We estimate a model where we substitute prices faced by
households in (44) with a full set of interactions between region r, time t, sector i, and household
income quintile q fixed effects. Formally, we estimate the following system of equations for
i ∈ I−m
                                            n
                                                
                                           ωit                                rq
                                 log        n           i − ˜m ) log Eth + πit
                                                     = (˜                        + ζin + νitn ,                   (45)
                                           ωmt
       rq
where πit denotes the t × r × q fixed effects. This approach allows us to capture the effect
                                           rq
of prices in a non-parametric way through πit . It imposes the assumption that households in
the same income quintile, region and time should face the same prices and choose the same
consumption bundles up to the heterogeneity that we allow in household characteristics through
ζin .

Estimation Results from Indian Household Expenditure Data We next present the
estimation results based on Equation (45) for a household survey in India, and also compare
it to what we would obtain using the U.S. household expenditure data. We use data from
rounds 64, 66 and 68 of the India National Sample Survey (NSS), which span the years 2007
compares estimates of different econometric specifications using synthetic data.
   50
      We note that that this specification in fact closely corresponds to the exercise underlying the Figure 1 presented
in the Introduction. We report in Tables E.2 and F.3 of the online appendix the results of the estimating Equation
(44) on household and aggregate data, respectively. In the last two rows of each table, we show that the ratios
 s − ˜m )/(˜
(˜           a − ˜m ) are close to the corresponding ratios (s − 1)/(a − 1) found in our baseline specifications in
Tables 1 and 3.
   51
      Lemma 6 also implies that there exists an alternative scaling of m such that our baseline estimation results
in Tables 1 and 3 would coincide with the estimates ˜i − ˜m in Tables E.2 and F.3 of the online appendix.
Conversely, it is possible to estimate the full demand system in two stages. In the first step, we can estimate
Equation (44) (or Equation (45) below) to obtain ˜s − ˜m . In the second step, we substitute in our baseline
specification i − 1 = λ̃−1 (˜s − ˜m ) and estimate σ and λ̃.


                                                                 34
                       Table 6: Baseline Regression for India, NSS Expenditure

                                                                      < P50     > P50     Only Urban          U.S.
                                                    (1)        (2)       (3)      (4)       (5)       (6)       (7)
 ˜a − ˜m                                       -0.63     -0.55        -0.62    -0.69    -0.57    -0.52     -0.61
                                                (0.05)    (0.07)       (0.05)   (0.29)   (0.05)   (0.07)    (0.09)
 ˜s − ˜m                                        0.49      0.42         0.69     0.51     0.56     0.45      0.49
                                                (0.07)    (0.10)       (0.53)   (0.08)   (0.08)   (0.11)    (0.09)
                                                                     Comparison to US Baseline
  s − ˜m )/(˜
 (˜           a − ˜m )                         -0.78     -0.76        -1.11    -0.74    -0.98     -0.87    -0.80
 (s − 1)/(a − 1), baseline estimates           -0.81     -0.82        -0.84    -0.60    -0.81     -0.81    -0.81
 Expenditure Re-Weighted                             N          Y          N        N         N        Y         N
 Time × Region × Inc. Quintile FE                    Y          Y          Y        Y         Y        Y         Y
 T. × Reg. × Inc. Quint. × Rural FE                  Y          Y          Y        Y         N        N         N
Notes: Standard errors clustered at the year×state×district shown in parenthesis. All regressions include
household controls (discussed in the main text). Observations for the full sample are 293,007. Urban
observations are 118,681. Time fixed effects are the interaction of year×month. Region fixed effects are
the interactions of state×district. The ratios for the baseline estimates corresponding to columns 1, 2
and 5 to 7 are computed from columns 1 and 2 of Table 1. The ratios for columns 3 and 4 are computed
from Table 2.


to 2012. The NSS is a representative survey of household expenditure that collects repeated
cross-sections of expenditures incurred by households in goods and services. We construct total
expenditure in agriculture, manufactures and services following the same classification as for
the CEX data. Household total income is constructed from an earnings measure that averages
(potential) different sources of income within the household from different occupations, including
received benefits (net of taxes).
    We construct the controls in an analogous way to the U.S., with the only difference that the
requirement of a prime age household is between ages of 18 and 60. In contrast to the U.S., we
do not discard rural population as it represents more than half of the Indian population (around
55%). We instead show results for the entire sample and the subsample of urban households. The
composition of expenditure in India is vastly different from the CEX. The average expenditure
share in food and agricultural in the sample is 52% (versus 12% in the CEX). Expenditure
shares in manufactures and services in the NSS represent, on average, 27% and 21% of total
expenditure (versus 27% and 61% in the CEX).
    Table 6 reports our estimation results from estimating equation (45).52 Columns (1) and
(2) report our baseline estimates using the full sample for the same two weighting schemes we
  52
     We use total household annual income as instrument for household quarterly expenditure. The first stage
includes all controls used in the second stage. The coefficient on household annual income is positive and significant
in all first-stage regressions. We note also that for columns (1) to (4) we augment specification (45) interacting
the income-quintile×time×region with a dummy that indicates whether the household is classified as rural to
account for potential constant difference between rural and urban households.


                                                          35
used for the CEX. The first makes the estimates representative of the Indian population and
the second re-weights households according to their total expenditure. We find that the relative
income elasticities between agriculture and manufacturing, ˜a − ˜m , are negative, and between
services and manufacturing, ˜s − ˜m , are positive. Likewise, comparing the point estimates in
Columns (1) and (2) we see that they again remain stable across the two weighting schemes.
We further explore the stability of the parameter estimates by applying the same specification
separately to the subset of households above and below the median income level. Columns (3)
and (4) show that we find very similar estimates of income elasticities in the two sub-samples.
We show in Columns (5) and (6) that when we restrict our attention to urban households, we
also obtain very similar estimates regardless of the weighting scheme used.
    Column (7) shows the coefficient we would obtain if we run the same regression for the U.S.
CEX data. Despite the vast differences in the level of development between the US and India,
we find that the US estimates, ˜a − ˜m = −0.61 and ˜s − ˜m = 0.49, are very similar in magnitude
                                                                               s − ˜m )/(˜
to the estimates for India. The last two rows of the table compare the ratios (˜           a − ˜m )
obtained in the without-price specification, Equation (45), for India and the US with the ratios
(s − 1)/(a − 1) from the baseline US CEX estimation. As implied by Lemma 6, we find very
similar ratios. For the US, the ratio of the estimates in column (7) of Table 6 is -0.80. The
corresponding number from the baseline estimates in Table 1 is -0.81. For India, the ratio
in column (1) is also very close to US estimates, -0.78, and fairly stable across specifications.
We take these results as evidence of nonhomothetic CES being able to capture parsimoniously
with the same nonhomotheticity parameters demand conditions from very different stages of
development.


6    Comparison to Alternative Models and Extensions
In this section, we provide comparisons to alternative models and discuss several extensions
and robustness checks of our empirical results for both micro and macro data. In Section 6.1
we compare the model fit of nonhomothetic CES to alternative specifications of within-period
utility that have been used previously in the literature: generalized Stone-Geary and PIGL.
In Section 6.2, we shift the focus of our analysis of the patterns of structural change from the
evolution of employment to sectoral value added in production (which has been the focus of some
recent work, e.g., Herrendorf et al. 2013). We also show that our estimated model accounts for
structural change in both real and nominal value added. In addition, we revisit our results based
on household-level CEX data when we specify consumption expenditures in terms of sectoral
value added rather than expenditure in final goods. In Section 6.3, we show that the growth
rate of the model-implied nonhomothetic CES real consumption index strongly correlates with
the growth rate of off-the-shelf indices of real consumption. Finally, in Section 6.4, we extend
our estimation to more than three sectors.



                                                 36
6.1      Fit Comparison with Stone-Geary and PIGL prefrences
We compare the cross-country fit of our model to alternative specifications where we replace the
nonhomothetic CES aggregator with Stone-Geary (Herrendorf et al., 2014) and PIGL preferences
(augmented to three sectors as described in Boppart, 2014b). Appendix D introduces these two
demand systems and the estimation procedure. Here, we highlight two similarities between
these demand specifications and ours that allow us to perform this comparison. First, the
number of parameters to be estimated in these two demand systems is the same as that in
nonhomothetic CES. Second, as with nonhomothetic CES, there exist sets of parameters for
these two demand systems such that the expenditure shares are constant for each country-sector
(they correspond to Cobb-Douglas with expenditure shares equal to country-sector averages).
Thus, we benchmark the fit of these three demand systems relative to only using the country-
sector average as a prediction for each sector. This amounts to computing the R2 for agriculture,
manufacturing and services shares after subtracting country-sector means for each sector.53
       We find that the within-R2 for Stone-Geary is 0.14, meaning that 14% of the residual varia-
tion in agricultural, manufacturing and service shares after we partial out country-sector averages
is accounted for by the Stone-Geary demand system. The corresponding number for nonhomo-
thetic CES is more than two-times larger, 0.29. The intuition for the worse fit of Stone-Geary is
that income effects are very low for rich countries, since for high levels of income, the subsistence
levels responsible for introducing the nonhomotheticity become negligible (see, also, Dennis and
Iscan, 2009).54 For the PIGL demand system we find an R2 of 0.13, which is very similar to
that of Stone-Geary. PIGL preferences track the trends in services more accurately than Stone-
Geary due to the fact that they feature a non-vanishing nonhomotheticity of the service sector.
However, they under-perform relative to nonhomothetic CES mostly because they assume a ho-
mothetic composite between agriculture and manufacturing, while nonhomothetic CES allows
for sector-specific nonhomotheticities. Figure 3 illustrates the fit for the case of Taiwan for the
three demand systems.55
  53
      The R2 compares the sum of squared errors of the model fit to the
                                                                      Psum of squared errors    obtained by using the
country-sector average as a prediction. Formally, R2 = 1 − I1 Ii=1        N     c      c 2 PN       c      c 2
                                                               P
                                                                          t=1 (yit − ŷit ) / t=1 (yit − ȳi ) where N
                                                                                       c
denotes the total number of observations per sector, I, the number of sectors, yit , observed employment shares
                             c
in sector i and country c, ŷit , predicted employment shares, ȳic the sample average of yit for country c in sector
i, and i ∈ I = {a, m, s}. We also note that the estimates used to compute the within-R2 for nonhomoethetic
CES correspond to the structural estimates in column (1) of Table 3. Finally, note that in this exercise we are
computing the R2 on employment shares (and not relative log-shares). The reason is that the estimation of the
three demand systems is based on different left-hand-side variables (e.g., Stone-Geary is not log-linear and it is
estimated on shares directly). We chose to benchmark the fit of the three demand systems based on the level of
employment shares as it is arguably the most basic object of interest.
   54
      For the U.S., the value of the nonhomothetic terms pit c̄i relative to total expenditure is never higher (in
absolute terms) than 0.1%, which suggests that nonhomotheticity are insignificant. The highest values of the
nonhomotheticities in the sample are 37% for agriculture and 18% for services.
   55
      We report the fit of each country for nonhomothetic CES in Section F and for Stone-Geary and PIGL in
Section H of the online appendix.




                                                          37
                Figure 3: Comparison of Demand Systems and Fit for Taiwan
             (a) Overall Fit Comparison             (b) Nonhomothetic CES Fit for Taiwan


           Model:            Within-R2
           Stone-Geary               0.14
           PIGL                      0.13
           Nonhom.-CES               0.29




            (c) Stone-Geary Fit for Taiwan                   (d) PIGL Fit for Taiwan




6.2   Value-Added Estimation and Accounting of Structural Change
Estimation in Aggregate Data with Value-Added Shares                    We investigate whether we
find similar estimates to the baseline cross-country results when we use value-added output
shares as dependent variable (instead of employment shares). Table F.2 in the online appendix
reports the estimation results using sectoral output value added shares as dependent variables
in our baseline estimation, Equation (37). The estimates of the nonhomotheticity parameters
appear with the expected signs and overall similar magnitudes as in the baseline regression. The
price elasticity appears to be somewhat smaller, between 0.3 and 0.4.

Structural Change in Real and Nominal Value Added A salient feature of the patterns
of structural transformation observed in the data on sectoral value added is that they appear
regardless of whether we document them in nominal or real terms (Herrendorf et al., 2014). To
investigate our model’s ability to account for this fact, we combine our structural cross-country
estimates from Table 3 and the sectoral demands from our theory to generate the predicted
evolution of nominal and real sectoral demands.
   Table 7 reports the correlation between nominal and real shares both in our estimated model


                                               38
                         Table 7: Correlation of Nominal and Real Value Added

                                       Data     Model
                                                            Note: Model-predicted values constructed using the
 Agriculture/Manufacturing              0.96       0.94     structural estimates from column (2) in Table 3.
 Services/Manufacturing                 0.87       0.71


and in the data. We find that the model is able to generate correlation similar to the data. In
particular, the correlation between the nominal and real relative demand of agricultural goods to
manufactures is 0.94 in our model, while in the data it is 0.96. For services, the model generates
a correlation of 0.71 while in the observed correlation in the data is 0.87.
       The success in generating a correlation between nominal and real measures of the same
magnitude as in the data is important. Note that this is an out-of-sample test of the predictions
of our model, since our baseline estimation has not targeted the evolution of sectoral shares of real
or nominal value added. As discussed in Section 2, if we had used a homothetic CES framework,
the correlation generated by the model would have been negative because the price elasticity
of substitution is smaller than one. This implies that real and nominal variables can not have
positive co-movement with homothetic CES.56 Of course, any specification of preferences that
asymptotically converges to a homothetic CES (e.g., Stone-Geary) would face a similar problem
in explaining the nominal-real co-movement. This also holds for homothetic demand systems
with variable elasticity of substitution (since agriculture, manufacturing and services are gross
complements). In contrast, in our framework, there is a second force that makes the positive
co-movement possible: income effects. The nonhomothetic effect of real consumption affects in
an identical way real and nominal variables (this term is C (1−σ)(i −m ) , see Equation 3). At the
estimated parameter values, the implied income effects are sufficiently strong to overcome the
relative price effect and make both time series co-move positively. Therefore, we argue that the
ability to simultaneously account for the evolution of real and nominal sectoral shares is a key
feature of our specification of nonhomotheticity.

Partial Correlations of Relative Value Added and the Real Consumption Index
We motivated our focus on the role of nonhomotheticity in the Introduction by highlighting the
strong partial correlations between log sectoral expenditure shares and log aggregate income
per capita in Figure 1. We revisit this relationship through the lens of our model to draw some
intuitions about why the model predicts such a strong role for income effects in driving the
evolution of relative employment shares. Figure 4 shows the partial correlation between log
value-added shares and the log nonhomothetic CES real consumption index (after partialling
out country-sector fixed effects and relative prices) for the same set of countries and time period
  56
    To see that, note that the relative trend in nominal values ωi,t /ωj,t would be proportional to (pi,t /pj,t )1−σ .
For real values, ci,t /cj,t , would be proportional to (pi,t /pj,t )−σ . As 0 < σ < 1, both trends would move in opposite
directions.



                                                           39
   Figure 4: Partial Correlations of Sectoral Value Added and the Real Consumption Index
        (a) Agriculture relative to Manufacturing               (b) Services Relative to Manufacturing




  Notes: Data for OECD Countries, 1970-2005. Each variable has been residualized by partialling out country
  fixed effects and relative prices. Each point represents a country-year observation. The red line depicts the
  OLS fit, the shaded regions, the 95% confidence interval.


as Figure 1.57 We see that for both log-relative agriculture to manufacturing and log-relative
services to manufacturing employment a substantial part of the variation is well captured by
a simple log-linear relationship, similar to that in Figure 1. We take this result as additional
supporting evidence for nonhomothetic CES being able to capture salient patterns in the data
and nonhomotheticities playing an important role at all levels of development.

CEX Value-Added Demand Formulation                          So far, we have estimated household demand
defined over households’ final-good expenditure. Previous work has shown that the patterns
of structural transformation are qualitatively similar whether we measure sectoral economic
activity in terms of value-added or final-good expenditure shares (Herrendorf et al., 2013). We
estimate our model defining household utility over the value added provided by each sector
(rather than final good expenditure) and show that we obtain similar results. To do this, we
follow Buera et al. (2015) and assign each consumption expenditure category to an industry
of the U.S. input-output. We then compute the value added from each sector embedded in
the final good expenditure of a given CEX category to express household demand over value
added (see the online appendix for details). Table 10 in the appendix presents the estimates
of our baseline specification where we use as dependent variable household expenditure shares
measured in value added (instead of final good expenditure). We find that the estimates of a
are less than one, while the estimates of s are above one. The estimates do not vary once we
re-weight by expenditure, suggesting that estimates are stable across the income distribution.
  57
    Korea is excluded from the figure because it has substantially more variation in the partialled-out variables.
Plotting it with the other countries would prevent seeing the rest of the within-country variation. Figure F.2 in
the online appendix reproduces the same plot including Korea.



                                                       40
The point estimates we obtain for the price elasticity are in the 0.3 to 0.5 range. The magnitudes
of all estimated elasticities appear to be overall very comparable to the expenditure formulation.
The major difference is that the elasticity of agriculture a appears to be somewhat smaller in
the value added formulation (specially in the specification without time fixed effects, where we
find values of a between 0.02 and 0.06, for values around 0.2 in the expenditure formulation).

6.3    Connection to Off-the-Shelf Measures of Real Consumption
Nonhomothetic CES Index vs.                     Törnqvist Index            We next investigate if the model-
implied real consumption index behaves in a similar way as the “standard” measures of real
consumption. These measures deflate nominal expenditures with off-the-shelf price indeces. We
establish a result connecting the changes in the nonhomothetic CES index of real consumption
to the changes in off-the-shelf measures of real consumption. Let ∆ denote the time difference
operator between t + 1 and t. In the last part of Appendix B, we show that up to second-order
approximation
                                                Etn
                                                     
                                                               1−σ
                      ∆ log Ctn   ≡ ∆ log                 =                n          n
                                                                 n (∆ log Et − ∆ log Pt ) ,               (46)
                                                Ptn             Et
where Ptn is the chained Törnqvist price index of consumption unit n at time t, ∆ log Ptn ≡
1 PI     n       n
                           n       n
2   i=1 ωit + ωit+1 ∆ log pit and E t is a correspondingly chained average of nonhomotheticity
                    n
parameters i ’s, E t ≡ 12 i ωit
                              n + ωn
                          P              58
                                    it+1 i .
    Equation (46) sheds light on why the relationship between relative log-value-added shares and
consumption expenditure deflated by standard price indices is well approximated by a log-linear
relationship as suggested in Figure 1 in the Introduction. The relationship would be exactly
                                                          n
log-linear if the term in the denominator E                   was constant. Indeed, this term is not constant
by construction because, as total income grows, expenditure shares change and Etn changes
accordingly. However, Etn is slow-moving. Consider for example the case of the United States.
The ratio of nominal consumption deflated by a chained Törnqvist price in year 2000 relative
                                                                 U S /E U S = 1.09, implying a
to 1950 is 3.20. During the same period, we have that the ratio E2000  1950
smaller increase of the true consumption index.59 If we ignored the correction coming from the
growth of E, we would expect a 3.2-fold increase in real consumption, while the true increase
                                                  1.01
of the real consumption index is 3.2 ×            1.10        = 2.94. This simple exercise also illustrates the
broad fact that the growth rate of the real consumption index is smaller than the one implied
                                                                                  n
by deflating expenditures by a chained Törnqvist index because E t grows as income grows.
  58
     In Online Appendix I we show how to use this result to obtain an alternative estimating equation based in
this approximation. We show that the resulting estimating equation belongs to a class of demand systems called
“conditionally linear demand systems.” Blundell and Robin (1999) show that this type of demand systems can
be estimated using iterated OLS.
  59
     From 1950 to 2000, value added shares in agriculture, manufacturing and services went from 0.08, 0.41
and 0.51 to 0.02, 0.28 and 0.70, respectively. Normalizing m = 1 and taking the baseline estimates from the
cross-country regression, this implies that E 1963 = 0.08 × 0.02 + 0.41 × 1 + 0.51 × 1.17 = 1.01 and E 2000 =
0.02 × 0.02 + 0.28 × 1 + 0.70 × 1.17 = 1.10. Note that this ratio is invariant to re-scaling i ’s.



                                                               41
          Figure 5: Real Income per capita from PWT and Nonhomothetic CES Index




           Note: Both measures are residualized by partialling out country fixed effects.


Correlation with the Real Income Measure in the Penn World Tables The previous
insights hold more broadly across countries. Figure 5 plots the log-real nonhomothetic CES
index (constructed according to Equation 14) and the real income per capita measure reported
in the Penn World Tables after partialling out country fixed effects to both measures. The figure
shows that the these two measures are very well-approximated by a log-linear relationship.

6.4    Structural Change with More than Three Sectors
Jorgenson and Timmer (2011) have pointed out that in order to understand how structural
transformation progresses in rich countries, it is important to zoom in the service sector, as
it represents the majority of rich economies’ consumption shares (see also Buera and Kaboski,
2012b). Our framework lends itself to this purpose, as it can accommodate an arbitrary number
of sectors. We estimate our demand system to more than three sectors for both micro and macro
data. In the CEX data, the largest broad expenditure category is housing services. We extend
our analysis by separating housing from the rest of services and re-estimate our model with four
sectors.60 Table 11 in the appendix reports our findings. The price elasticity σ and the relative
elasticity of agriculture to manufacturing, and services to manufacturing (excluding housing),
remain very similar to our baseline estimates in Table 1. We find that the nonhomotheticity
parameter of housing to manufacturing housing − 1 is around 0.9, and thus somewhat larger than
for the rest of services (albeit not statistically different at conventional significance levels).
    For the macro data, we extend our estimation to the original sectors in Groningen’s data:
(1) agriculture, forestry and fishing, (2) mining and quarrying, (3) manufacturing, (4) public
utilities, (5) construction, (6) wholesale and retail trade, hotels and restaurants, (7) transport,
  60
     We define housing as expenditure in dwellings plus utilities. We use the same set of instruments plus a price
instrument for housing constructed in an analogous way to the other price instruments.



                                                       42
                         Table 8: Model Parameters for the Calibration Exercise

     Parameter      γa      γm = γ0       γs       σ          a   m      s      α       θ       β       δ
     Value        0.029      0.013      0.011     0.50    0.05     1.00   1.20    0.33    2.20    0.96   0.10


storage and communication, (8) finance, insurance, real state, (9) community, social and personal
services.61 Table 12 in the appendix reports the results estimating the demand system in an
analogous manner to our baseline estimation (39) with additional sectors. We find that the
smallest income elasticities correspond to agriculture and mining, while the highest correspond
to the finance, insurance and real state category. Columns (2) and (3) show that the ranking of
sectors in terms of nonhomotheticity parameters is very similar when we estimate OECD and
Non-OECD countries separately.62


7        Calibration Exercise
So far, we have only focused on the predictions of the model regarding the intratemporal allo-
cation of consumption expenditures. In this section, we rely on a simple calibration exercise to
study the dynamic, intertemporal predictions of the model implied by the Euler equation. As we
discussed in Section 2.2.3, the qualitative properties of the transitional dynamics of the model
heavily depend on the relationship between sectoral income elasticity and rates of productivity
growth. In this section, we study the dynamics of the economy calibrated for the set of pa-
rameters estimated for the nonhomothetic CES preferences in Section 3. We then compare our
model with simpler versions where we strip off different drivers of structural change. Relative
to the Neoclassical Growth Model benchmark, we find that including any drivers of structural
change in the model generates a slow-down of the convergence toward the long-run value.

Model Calibration For the preferences, we rely on the values estimated for the sectoral
nonhomotheticity parameters i ’s and the elasticity of substitution σ using the macro data in
Section 3 and set Ωi ≡ 1 for all i ∈ {a, m, s}. We assume that capital intensity is the same across
sectors and choose the standard value α = 0.33 and a rate of depreciation of δ = 0.1 for capital.
For the sectoral rates of productivity growth, we assume that the rates of productivity growth
in the investment sector and manufacturing are the same γm = γ0 , and calibrate them to the
    61
     We exclude government services since it is missing for a third of the observations. The data set also contains
information on dwellings that are not constructed within the period, but this information is very sparse and we
abstract from them. Note that in this case, the manufacturing sector is more narrowly defined than in the baseline
estimation as it excludes mining and construction.
  62
     In working paper version Comin et al. (2015), we exploit that the nesting properties of nonhomothetic CES
are analogous to homothetic CES and we also report the estimation results from a nested CES structure where
we estimate the demand for each of the sectors that belong to services or manufacturing separately.




                                                         43
    Figure 6: Transitional Dynamics: Comparison with Neoclassical Growth Model (NGM)

                 (a) Path in (k̃, Ẽ)–space                       (b) Evolution of the Real Interest Rate




  The evolution of the economy starting from initial per-capita stock of capital of k̃0 = 1 < k̃∗ = 2.10.
  The parameters for the Calibrated Model are given in Table 8. The nhCES/hetGr corresponds to the
  calibrated model with nonhomothetic CES and heterogeneous rates of sectoral productivity growth . The
  nhCES/homGr model corresponds to the case with nonhomothetic CES preferences and homogeneous rates
  of sectoral productivity growth, γi = 0.011 for i ∈ {a, m, s}. The CES/hetGr model corresponds to the case
  with homothetic CES preferences , i = 1.20 for i ∈ {a, m, s}. The CES/homGr corresponds to the case
  of the Neoclassical Growth Model (NGM) both the rates of productivity growth and the nonhomotheticity
  parameters are homogeneous across sectors. k̃∗ and Ẽ ∗ denote the asymptotic normalized per-capita stock
  fo capital and total consumption expenditure, respectively.


rate of growth of labor productivity observed in the in the postwar period in the US.63 We then
use the rates of decline in relative sectoral prices within the same period to calibrate the rates
of growth of sectoral productivity for agriculture and services. Finally, we choose the value of
the parameter θ such that the asymptotic value of the elasticity of intertemporal substitution
matches 0.5, a number within the range of various estimates provided in the literature (e.g.,
Guvenen, 2006; Havránek, 2015). Table 8 presents the set of model parameters used for the
calibration.64

Dynamics of Capital Accumulation                     First, we study how the presence of nonhomothetic
CES demand changes the dynamics of the process of capital accumulation and the real interest
rate. For this exercise, we compare the transitional dynamics of the calibrated model, in which
both the nonhomotheticity parameters and the rates of productivity growth vary across sectors,
with the following three different increasingly simpler models: 1) a model where the rates of
  63
     Note that based on the model the rate of growth of labor productivity growth exceeds the rate of growth of
multifactor productivity (TFP) γm by a factor α/(1 − α).
  64
     Section C discusses the details of the method used for solving Equations (33) and (34) to derive the transitional
dynamics of the model under these model parameters.



                                                         44
productivity growth are homogeneous across sectors and the evolution of sectoral allocations
is exclusively driven by nonhomotheticity in demand, 2) a model with homothetic preferences
where nonhomotheticity parameters are identical and, following Ngai and Pissarides (2007),
the evolution of sectoral allocations is exclusively driven by the heterogeneity in sectoral rates
of productivity growth, and 3) a standard neoclassical growth model (NGM) with homothetic
CES preferences and homogeneous rates of productivity growth across sectors. We choose the
parameters such that all models asymptotically converge to the same steady state as that of the
calibrated model.65
       Beginning at an initially low level of per-capita stock of capital of k̃0 = 1 < k̃ ∗ = 2.5, Figure
6a shows the path of the economy from this initial condition toward its steady state in the space of
the normalized per capita stock of capital and per-capita consumption expenditure. The figure
compares these paths for all four models. All three models featuring structural change have
higher values of total consumption expenditure relative to the NGM at all levels of per-capita
stock of capital along the transitional path. As a result, we conclude based on this calibration
that the presence of structural change implies a slower process of capital accumulation compared
to the NGM, whether it is driven through price or income effects.
       The slowdown in capital accumulation relative to the NGM benchmark is driven by the same
two forces that shape the evolution of sectoral shares, namely, the inter-sectoral heterogeneity in
the elasticities of income and the rates of productivity growth. In Section 2.2.3, we explained the
mechanism behind the former force: the elasticity of intertemporal substitution gradually rises
as their consumption shifts toward more income elastic goods that are also more intertemporally
substitutable. The latter force is present in the benchmark theory of Ngai and Pissarides (2007):
over time, household consumption shifts toward the sectors with the slower rates of productivity
growth, lowering the rate of fall in the price of consumption. If household consumption is
intertemporally inelastic (in the sense that θ > 1), conditional on a given level of interest rate, the
slowdown in the rate of decline of prices results in faster growth of consumption expenditure.66
As the figure shows, these two forces, as well as their potential interactions, contribute to the
slowdown in the accumulation of capital in the calibrated model, although nonhomotheticity
plays a larger role.

Dynamics of Interest Rate Figure 6b compares the implications of all four models above
for the evolution of the real interest rate. The slower process of capital accumulation implies
that the real interest rate also converges toward its steady state more slowly in all three models
  65
      Given the calibrated model parameters, the share of the service sector in consumption and employment
converges to 1. Therefore, asymptotically all four models behave identical to a single-sector Neoclassical Growth
                                                            s
Model where the instantaneous utility is defined as Ct = Cst   and the productivity in the final good sector grows
at rate γs .
   66
      To better see this point, consider a constant nonhomotheticity parameter across sectors, i = ,  P and log-
linearize the Euler Equation (21) to find θ∆ log Et ≈ (1 − θ) (γ0 − γ t ) + rt+1 − (1 − β), where γ t ≡ i ωit γi is
the consumption-weighted average of the sectoral rates of productivity growth (see also Equation 22 in Ngai and
Pissarides, 2007). When σ < 1, over time γ t falls and therefore ∆ log Et grows if θ > 1.


                                                        45
featuring structural change, relative to the NGM benchmark. Once again, the model that solely
features nonhomotheticity grows more slowly compared to the one solely featuring heterogeneous
sectoral rates of productivity growth. Nevertheless, the overall difference between the evolution
of the real interest rate between the calibrated model and the corresponding NGM is relatively
small: the time it takes for the real interest rate to go from 200% to 150% of its steady state
level (half-life) is 9.1 years in the former relative to 4.4 years in the latter.67


8         Conclusion
This paper presents a tractable model of structural transformation that accommodates both
long-run demand and supply drivers of structural change. Our main contributions are to intro-
duce the nonhomothetic CES utility function to growth theory, show its empirical relevance and
use its structure to decompose the overall observed structural change into the contribution of
income and price effects. These preferences generate nonhomothetic Engel curves at any level
of development, which are in line with the evidence that we have from both rich and developing
countries. Moreover, for this class of preferences, price elasticities are independent from non-
homotheticity parameters, and they can be used for an arbitrary number of sectors. We argue
that these are desirable theoretical and empirical properties.
         We estimate these preferences using household-level data for the U.S. and India, and aggre-
gate data for a panel of 39 countries during the post-war period. We argue that nonhomothetic
CES preferences provide a good fit of the data despite their parsimony. Armed with the esti-
mated price and nonhomotheticity parameters, we then use the demand structure to decompose
the broad patterns of reallocation observed in our cross-country data into the contribution of
nonhomotheticities and changes in relative prices. We find that the majority of the within-
country variation is accounted for nonhomotheticities in demand.
         To conclude, we believe that the proposed preferences provide a tractable departure from
homothetic preferences. They can be used in other applied general equilibrium settings that
currently use homothetic CES and monopolistic competition as their workhorse model, such
as international trade. These preferences can be nested in the same manner as homothetic
CES. Also, as we discuss in Appendix A, it is possible to generalize nonhomothetic CES to
generate variable nonhomotheticity parameters. These properties may be useful in some appli-
cations. Even in this case, nonhomothetic CES remains a local approximation (with constant
nonhomotheticity parameters) and can be used to guide how the varying elasticities should be
parametrized, e.g., by estimating nonhomothetic CES across sub-samples.




    67
    The corresponding numbers in the model with nonhomotheticity and in the model with differential rates of
productivity growth are 7.2 and 5.0, respectively.


                                                    46
References
Acemoglu, D. (2008): Introduction to Modern Economic Growth, Princeton University Press.

Acemoglu, D. and V. Guerrieri (2008): “Capital Deepening and Nonbalanced Economic Growth,”
  Journal of Political Economy, 116, 467–498.

Aguiar, M. and M. Bils (2015): “Has Consumption Inequality Mirrored Income Inequality,” American
 Economic Review, 105, 2725–56.

Alvarez-Cuadrado, F. and M. Poschke (2011): “Structural Change Out of Agriculture: Labor
  Push versus Labor Pull,” American Economic Journal: Macroeconomics, 3, 127–58.

Battistin, E., R. Blundell, A. Lewbel, S. Journal, and N. December (2009): “Why Is Con-
  sumption More Log Normal than Income? Gibrat’s Law Revisited,” Journal of Political Economy,
  117, 1140–1154.

Baumol, W. J. (1967): “Macroeconomics of Unbalanced Growth: The Anatomy of Urban Crisis,”
  American Economic Review, 57, 415–426.

Blackorby, C., D. Primont, and R. R. Russell (1978): Duality, separability, and functional struc-
  ture: Theory and economic applications, New York: Elsevier North Holland Inc.

Blackorby, C. and R. R. Russell (1981): “The Morishima elasticity of substitution; symmetry, con-
  stancy, separability, and its relationship to the Hicks and Allen elasticities,” The Review of Economic
  Studies, 147–158.

Blundell, R. and J. M. Robin (1999): “Estimation in large and disaggregated demand systems: An
  estimator for conditionally linear systems,” Journal of Applied Econometrics, 209–232.

Boppart, T. (2014a): “Structural Change and the Kaldor Facts in a Growth Model With Relative Price
  Effects and Non-Gorman Preferences,” Econometrica, 82, 2167–2196.

——— (2014b): “Supplement to ”Structural Change and the Kaldor Facts in a Growth Model With
 Relative Price Effects and Non-Gorman Preferences”,” Econometrica Supplementary Material, 82,
 2167–2196.

Browning, M. (1999): “Modelling Commodity Demands and Labour Supply with M-Demands,” Work-
  ing Paper 99-08, Institute of Economics, University of Copenhagen.

Buera, F. J. and J. P. Kaboski (2009): “Can Traditional Theories of Structural Change Fit The
  Data?” Journal of the European Economic Association, 7, 469–477.

——— (2012a): “Scale and the origins of structural change,” Journal of Economic Theory, 147, 684–712.

——— (2012b): “The Rise of the Service Economy,” American Economic Review, 102, 2540–69.

Buera, F. J., J. P. Kaboski, and R. Rogerson (2015): “Skill Biased Structural Change,” Working
  Paper 21165, National Bureau of Economic Research.



                                                   47
Comin, D. A., D. Lashkari, and M. Mestieri (2015): “Structural Change with Long-run Income
 and Price Effects,” Working Paper 21595, National Bureau of Economic Research.

——— (2018): “Structural Change with Long-run Income and Price Effects,” Working Paper 21595,
 National Bureau of Economic Research.

Crossley, T. F. and H. W. Low (2011): “Is the elasticity of intertemporal substitution constant?”
  Journal of the European Economic Association, 9, 87–105.

Deaton, A. and J. Muellbauer (1980): Economics and Consumer Behavior, Cambridge University
 Press.

Dennis, B. N. and T. B. Iscan (2009): “Engel versus Baumol: Accounting for structural change using
 two centuries of U.S. data,” Explorations in Economic History, 46, 186–202.

Duarte, M. and D. Restuccia (2010): “The Role of the Structural Transformation in Aggregate
 Productivity,” The Quarterly Journal of Economics, 125, 129–173.

Duernecker, G., B. Herrendorf, and A. Valentinyi (2017a): “Quantity Measurement and Bal-
 anced Growth in Multi-Sector Growth Models,” CEPR Discussion Papers 12300, C.E.P.R. Discussion
 Papers.

——— (2017b): “Structural Change within the Service Sector and the Future of Baumols Disease,”
 Mimeo.

Echevarria, C. (1997): “Changes in Sectoral Composition Associated with Economic Growth,” Inter-
  national Economic Review, 38, 431–52.

Feenstra, R. C., R. Inklaar, and M. P. Timmer (2015): “The Next Generation of the Penn World
  Table,” American Economic Review, 105, 3150–82.

Foellmi, R., T. Wuergler, and J. Zweimüller (2014): “The macroeconomics of Model T,” Journal
  of Economic Theory, 153, 617–647.

Foellmi, R. and J. Zweimüller (2006): “Income Distribution and Demand-Induced Innovations,”
  Review of Economic Studies, 73, 941–960.

——— (2008): “Structural change, Engel’s consumption cycles and Kaldor’s facts of economic growth,”
 Journal of Monetary Economics, 55, 1317–1328.

Gollin, D., S. Parente, and R. Rogerson (2002): “The Role of Agriculture in Development,”
 American Economic Review, 92, 160–164.

Gorman, W. (1965): “Production Functions in Which the Elasticities of Substitution stand in Fixed
 Proportions to each other,” Review of Economic Studies, 32, 217–224.

Guvenen, F. (2006): “Reconciling conflicting evidence on the elasticity of intertemporal substitution:
 A macroeconomic perspective,” Journal of Monetary Economics, 53, 1451–1472.




                                                 48
Hanoch, G. (1975): “Production and demand models with direct or indirect implicit additivity,” Econo-
 metrica, 43, 395–419.

Havránek, T. (2015): “Measuring intertemporal substitution: The importance of method choices and
  selective reporting,” Journal of the European Economic Association, 13, 1180–1204.

Heathcote, J., F. Perri, and G. L. Violante (2010): “Unequal We Stand: An Empirical Analysis
  of Economic Inequality in the United States: 1967-2006,” Review of Economic Dynamics, 13, 15–51.

Herrendorf, B., R. Rogerson, and A. Valentinyi (2013): “Two Perspectives on Preferences and
  Structural Transformation,” American Economic Review, 103, 2752–89.

——— (2014): “Growth and Structural Transformation,” in Handbook of Economic Growth, Elsevier,
 vol. 2 of Handbook of Economic Growth, chap. 6, 855–941.

Hobijn, B. and D. Lagakos (2005): “Inflation Inequality In The United States,” Review of Income
 and Wealth, 51, 581–606.

Hobijn, B., K. Mayer, C. Stennis, and G. Topa (2009): “Household inflation experiences in the
 U.S.: a comprehensive approach,” Working Paper Series 2009-19, Federal Reserve Bank of San Fran-
 cisco.

Jorgenson, D. W. and M. P. Timmer (2011): “Structural Change in Advanced Nations: A New Set
  of Stylised Facts,” Scandinavian Journal of Economics, 113, 1–29.

King, R. G. and S. T. Rebelo (1993): “Transitional Dynamics and Economic Growth in the Neoclas-
  sical Model,” American Economic Review, 83, 908–931.

Kongsamut, P., S. Rebelo, and D. Xie (2001): “Beyond Balanced Growth,” Review of Economic
 Studies, 68, 869–82.

Krueger, D. and F. Perri (2006): “Does Income Inequality Lead to Consumption Inequality? Evi-
 dence and Theory,” Review of Economic Studies, 73, 163–193.

Kuznets, S. (1973): “Modern Economic Growth: Findings and Reflections,” American Economic Re-
 view, 63, 247–58.

Lewbel, A. (2008): Engel curves, Palgrave Macmillan Basingstoke, vol. 2.

Lewbel, A. and K. Pendakur (2009): “Tricks with hicks: The EASI demand system,” American
  Economic Review, 99, 827–863.

Lewis, L. T., R. Monarch, M. J. Sposi, and J. Zhang (2018): “Structural Change and Global
  Trade,” Globalization and Monetary Policy Institute Working Paper 333, Federal Reserve Bank of
  Dallas.

Maddison, A. (1980): “Economic Growth and Structural Change in Advanced Countries,” in Western
 Economies in Transition, Croom Helm, 41–60.




                                                 49
Matsuyama, K. (1992): “Agricultural Productivity, Comparative Advantage, and Economic Growth,”
 Journal of Economic Theory, 58, 317–334.

——— (2015): “The Home Market Effect and the Patterns of Trade between Rich and Poor Countries,”
 Unpublished Manuscript.

——— (2017): “Engels Law in the Global Economy: Demand Induced Patterns of Structural Change,
 Innovation and Trade,” Unpublished Manuscript.

Muellbauer, J. (1975): “Aggregation, income distribution and consumer demand,” The Review of
 Economic Studies, 42, 525–543.

——— (1976): “Community preferences and the representative consumer,” Econometrica: Journal of
 the Econometric Society, 979–999.

——— (1987): “Estimating the intertemporal elasticity of substitution for consumption from household
 budget data,” in The Practice of Econometrics, Springer, 45–57.

Ngai, L. R. and C. A. Pissarides (2007): “Structural Change in a Multisector Model of Growth,”
 American Economic Review, 97, 429–443.

Olken, B. (2010): “Discussion of The African Growth Miracle,” Mimeo.

Sáenz, L. F. (2017): “Time-Varying Capital Intensities and the Hump-Shaped Evolution of Economic
   Activity in Manufacturing,” Mimeo.

Sato, R. (1975): “The Most General Class of CES Functions,” Econometrica, 43, 999–1003.

Snow, A. and R. S. Warren (2015): “Pigou’s Law and the proportionality of income and price
  elasticities of demand,” Economics Letters, 132, 136–138.

Sposi, M. (2018): “Evolving comparative advantage, sectoral linkages, and structural change,” Journal
  of Monetary Economics.

Stokey, N. L., R. E. Lucas, and E. C. Prescott (1989): Recursive Methods in Economic Dynamics,
  Harvard University Press.

Swiecki, T. (2017): “Determinants of Structural Change,” Review of Economic Dynamics, 24, 95–131.

Vries, K. d., G. d. Vries, and M. Timmer (2014): “Patterns of Structural Change in Developing
 Countries,” GGDC Research Memorandum GD-149, Groningen Growth and Development Centre,
 University of Groningen.

Young, A. (2012): “The African Growth Miracle,” Journal of Political Economy, 120, 696–739.

——— (2013): “Inequality, the Urban-Rural Gap, and Migration,” Quarterly Journal of Economics, 128,
 1727–1785.




                                                 50
Appendix             Click Here for the Online Appendix

A     General Nonhomothetic CES Preferences
In this section of the appendix, we provide an overview of the properties of the general family of non-
homothetic Constant Elasticity of Substitution (CES) preferences. We first introduce the general family
and then specialize them to the case of isoelastic nonhomothetic CES functions of Section 2.1.

Prior Work Sato (1975) derived a general family of CES functions as the solution to a partial
differential equation that imposes the constancy of elasticity of substitution. This family includes standard
homothetic CES functions as well as two classes of separable and non-separable nonhomothetic functions.
Hanoch (1975) showed that additivity of the direct or indirect utility (or production) function results
in price and income effects that are non-trivially dependent on each other. He then introduced implicit
additivity and derived a family of functions where the income elasticity of demand is not fully dependent
on the elasticity of substitution. Our nonhomothetic CES functions correspond to the non-separable
class of functions in the sense of Sato (1975), which also satisfy the condition of implicit additivity in the
sense of Hanoch (1975). Finally, Blackorby and Russell (1981) have proved an additional property that
is unique to this class of functions. In general, different generalizations of the elasticity of substitution to
cases involving more than two variables, e.g., the Allen-Uzawa definition or the Morishima definition, are
distinct from each other. However, for the class of nonhomothetic CES functions they become identical
and elasticity of substitution can be uniquely defined similar to the case of two-variable functions.


A.1     General Definition
Consider now preferences over a bundle C of I goods defined through an implicit utility function:

                                          I                        σ−1
                                          X      1         Ci         σ
                                                Υi
                                                 σ
                                                                           = 1,                           (A.1)
                                          i=1
                                                         gi (U )

where functions gi ’s are differentiable in U and σ 6= 1 and σ > 0. Theorem 2 in Blackorby and Russell
(1981) implies that property (6) holds if and only if the preferences can be written as equation (A.1). In
this sense, the definition above corresponds to the most general class of nonhomothetic CES preferences.
Standard CES preferences are a specific example of Equation (A.1) with gi (U ) = U for all i’s.
    These preferences were first introduced, seemingly independently, by Sato (1975) and Hanoch (1975)
who each characterize different properties of these functions. Here, we state and briefly prove some of
the relevant results to provide a self-contained exposition of our theory in this paper.

Lemma 3. If σ > 0 and functions gi (·) are positive and monotonically increasing for all i, the function
U (C) defined in Equation (A.1) is monotonically increasing and quasi-concave for all C  0.

Proof. Establishing monotonicity is straightforward. To establish quasi-concavity, assume to the contrary
that there exists two bundles of C 0 and C 00 and their corresponding utility values U 0 and U 00 , such that




                                                           51
U ≡ U (αC 0 + (1 − α)C 00 ) is strictly smaller than both U 0 and U 00 . We then have for the case σ ≥ 1
                                                                   σ−1
                                     Ci0                  Ci00
                                                                     σ
                                 1/σ
                            X
                    1 =         Υi
                                 α           + (1 − α)                    ,
                         i
                                   gi (U )              gi (U )
                                                                      σ−1
                        X 1/σ        Ci0                   Ci00        σ
                      >     Υi   α         0
                                             +  (1 − α)          00
                                                                            ,
                         i
                                   gi (U )               gi (U )
                                               σ−1                                       σ−1
                          X 1/σ  C 0  σ                         X 1/σ  C 00  σ
                                         i                                        i
                      ≥ α    Υi                     + (1 − α)          Υi                    ,
                           i
                                   gi (U 0 )                        i
                                                                              gi (U 00 )

where in the second inequality we have used monotonicity of the gi ’s and in the third we have used
Jensen’s inequality and the assumption that ∞ > σ > 1. Since the last line equals 1 from the definition
of the nonhomothetic CES functions valued at U 0 and U 00 , we arrive at a contradiction. For the case that
0 < σ < 1, we can proceed analogously. In this case, the inequality signs are reversed in both lines and
we also reach a contradiction.

Demand Function Henceforth, we assume the conditions in Lemma 3 are satisfied. The next lemma
characterizes the demand for general nonhomothetic CES preferences and provides the solution to the
expenditure minimization problem.

Lemma 4. Consider any bundle of goods that maximizes the utility function defined in Equation (A.1)
                                P
subject to the budget constraint i pi Ci ≤ E. For each good i, the real consumption satisfies:
                                                        p −σ
                                                             i
                                          Ci = Υi                     gi (U )1−σ ,                      (A.2)
                                                         E
where U satisfies
                                            " I                                   1
                                                                               # 1−σ
                                             X                           1−σ
                                       E=            Υi (gi (U ) pi )                  .                (A.3)
                                               i=1

and the share in consumption expenditure is given by
                                                             σ−1                  p i1−σ
                                p i Ci     1         Ci         σ         h
                                                                                      i
                           ωi ≡        = Υiσ                          = Υi gi (U )           .          (A.4)
                                  E                gi (U )                           E

Proof. Let λ and ρ denote the Lagrange multipliers on the budget constraint and constraint (A.1),
respectively:
                                                   σ−1 !                  !
                                  X 1  Ci  σ                   X
                   L=U +ρ 1−         Υiσ                 +λ E−       pi Ci .
                                   i
                                          gi (U )                  i

The FOCs with respect to Ci yields:
                                                    1 − σ ωi
                                                ρ            = λpi ,                                    (A.5)
                                                      σ Ci
                                  1
                                         σ−1
                                            σ
where we have defined ωi ≡ Υiσ giC(Ui )        . Equation (A.5) shows that expenditure pi Ci on good i is
proportional to ωi . Since the latter sums to one from constraint (A.1), it follows that ωi is the expenditure
                                        PI               ρ
share of good i, and we have: E = i=1 pi Ci = 1−σ     σ λ . We can now substitute the definition of ωi in
expression (A.5) and use the budget constraint above to find Equation (A.2), as well as Equations (A.2)


                                                                 52
and (A.4).

Elasticities of Demand Lemma 4 implies that the equation defining the expenditure function
(and implicitly the indirect utility function) for general nonhomothetic CES preferences is given by
Equation (A.3). The expenditure function is continuous in prices pi ’s and U , and homogeneous of degree
1, increasing, and concave in prices. The elasticity of the expenditure function with respect to utility is

                                               U     U ∂E   X
                                              ηE ≡        =   ωi ηgUi = ηgUi ,                                   (A.6)
                                                     E∂U    i


which ensures that the expenditure function is increasing in utility if all gi ’s are monotonically increas-
ing. It is straightforward to also show that the elasticity of the utility function (A.1) with respect to
consumption of good i is also given by

                                                      Ci     Ci ∂U   ωi
                                                     ηU  ≡         =      ,                                      (A.7)
                                                             U ∂Ci   ηgUi

                                          1                  σ−1
where, again, ωi is the ratio ωi ≡ Υiσ (Ci /gi (U )) σ .
    Examining sectoral demand from Equation (A.2) along indifference curves, we can derive the main
properties of nonhomothetic CES preferences. As expected, on a given indifference curve, the elasticity
of substitution is constant
                                    p /p       ∂ log (Ci /Cj )
                                   ηCii /Cjj ≡                           = σ.                    (A.8)
                                               ∂ log (pi /pj ) U =const.
More interestingly, the elasticity of relative demand with respect to utility, in constant prices, is in general
different from unity:68

                             U           ∂ log (Ci /Cj )                            ∂ log (gi /gj )
                            ηC i /Cj
                                     ≡                                  = (1 − σ)                   .            (A.9)
                                             ∂ log U         p=const.                  ∂ log U

Since utility has a monotonic relationship with expenditure, it then follows that the expenditure elasticity
of demand for different goods are different. More specifically, we can use (A.6) to find the expenditure
elasticity of demand:
                                      E    ∂ log Ci                ηgUi
                                     ηC  ≡          = σ + (1 −  σ)      .                            (A.10)
                                       i
                                            ∂ log E                ηgU              i



Convexity of the Expenditure Function in Utility First, we express the second derivative
of the expenditure function in terms of elasticities,

                                           ∂2E    E U U        U
                                                                      
                                                =    η E ηE + ηη U − 1  ,                                       (A.11)
                                           ∂U 2   U2             E


  68
     Preferences defined by Equation (A.1) belong to the general class of preferences with Direct Implicit Additivity.
Hanoch (1975) shows that the latter family of preferences have the nice property that is illustrated by Equations
(A.8) and (A.9): the separability of the income and substitution elasticities of the Hicksian demand. This is
in contrast to the stronger requirement of Explicit AdditivityP     commonly    assumed in nonhomothetic preferences,
whereby the utility is explicitly defined as a function U = F        i fi (Ci ) . In Section G.1 of the Online Appendix,
we will show examples of how substitution and income elasticities of Hicksian demand are not separable for
preferences with explicitly additivity in direct utility, e.g., generalized Stone-Geary preferences (Kongsamut et al.,
2001), or indirect utility, e.g., PIGL preferences (Boppart, 2014a).



                                                               53
where ηηUU is the second order elasticity of expenditure with respect to utility. We can compute this
         E
second order elasticity as follows:

                         ∂         X                            1−σ             ∂ log E
            ηηUU   = U       log          ηgi (U ) (gi (U ) pi )      − (1 − σ)         ,
               E       ∂U            i
                                                                                ∂ log U
                                                       1−σ                                1−σ
                                                            + (1 − σ) i ηg2i (gi (U ) pi )
                     P                                                   P
                         i ηηgi · ηgi (gi (U ) pi )
                   =                            P                       1−σ                   − (1 − σ) ηgi ,
                                                    i ηgi (gi (U ) pi )
                          "                                    #
                            η ηg i · η g i                       ηgi
                   = ηgi             2 + (1 − σ) V ar            η
                                                                          ,                                     (A.12)
                              (ηgi )                               gi


where Xi and V ar (Xi ) denote the expected value and variance of variable Xi across sectors with weights
given by expenditure shares ωi for prices p and utility U .


A.2     Isoelastic Nonhomothetic CES Preferences
A.2.1     Elasticities
We discussed that a class of preferences satisfies equation (6) if and only if we can write it as (A.1). If we
further impose condition (5), it follows that there is some function g (·) such that log gi (U ) = εi log g (U ),
where both g (·) is an increasing function and εi > 0 for all i. This gives us the definition of our
basic model in Section 2. We then have ηgUi = ηg εi where ηg ≡ d log g/d log U , and ηηgi = ηηg where
ηηg ≡ d log ηg /d log U . Equations (3) and (4) follow by substituting for gi in the results of Lemma 4 above.
                                                                       U     U ∂E
                                                                                                       P
From (A.6), the utility elasticity of the expenditure function is: ηE     ≡ E   ∂U = ηg ε, where ε =      i ωi εi .
Therefore, a sufficient condition for the function E (U ; p) to be a one-to-one mapping for all positive
prices is that all sectors have an income elasticity larger than the elasticity of substitution εi > 0. This
directly follows from Lemma 3. Combining Equations(A.11) and (A.12), we find

                              ∂2E    E        h                         ε 
                                                                           i
                                                                                       i
                                   =    η g ε   ηg ε   1 + (1 − σ) V ar        + η η g   .                      (A.13)
                              ∂U 2   U2                                   ε

where we have substituted in Equation (A.12) to find ηηUU = ηηg + ηg ε (1 − σ) V ar (ε/ε). In the special
                                                                        E
                              U
case of g (U ) = U , we find ηE = ε and ∂ 2 E/∂U 2 = E/U 2 × ε2 (1 + (1 − σ) V ar (εi /ε)).


A.2.2     Generalized Indices of Real Consumption and Demand Estimation
Let vector ψ ∈ RI+ denote a vector of weights defined over the I goods such that ψi ≥ 0 for all i and
PI
  i=1 ψi = 1. For the nonhomothetic CES preferences of Equation (1), define a ψ-index of nonhomothetic
CES real consumption C ψ as the following monotonic transformation of F (C):
                                                                1
                                                             ! 1−σ
                                                I
                                                Y                            PI
                                                                                       ψi εi
                                    C   ψ
                                            =         Υψ
                                                       i
                                                         i
                                                                     g (F (C))   i=1
                                                                                               .
                                                i=1




                                                                54
Substituting this expression in Equation (1), we find
                                                                           σ1                                   σ
                                                                                                                 σ−1
                           I
                           X                          Υi                                     Ci
                                                                                                                        = 1,
                                                                                                             
                                                      PI      εi                            εi
                                                                                             PI
                                       QI        ψj                ψj εj                          ψ ε
                           i=1
                                            j=1 Υj
                                                             j=1                    (C ψ )    j=1 j j



                                                                  
which suggests defining the following set of parameters σ, ψ , Ωψ :

                                       εi                                           Υi
                        ψ
                         i ≡ PI                   ,         Ωψ
                                                             i ≡                              εi           ,       1 ≤ i ≤ I,                  (A.14)
                                        ψj εj
                                                                                      PI
                                  j=1
                                                                   QI              jψ              ψ j εj
                                                                            j=1 Υj
                                                                                             j=1




             PI                        QI                 ψi
satisfying    i=1   ψ i ψ
                         i = 1 and          i=1       Ωψ
                                                = 1. Accordingly, we define the nonhomothetic CES prefer-
                                                       i
                                                   1            σ−1
                                                                     σ
                                            PI    ψ σ      Ci
ences for an aggregator C ψ       satisfying i=1 Ωi           
                                                                ψ       = 1, in line with Equation (15).
                                                                                (C ψ )   i

     The derivation above suggests that there exists a family of indices of real consumption and the
corresponding parameterizations indexed by vectors ψ that all characterize the same preferences. In
particular, our definition of the index of real consumption and parameters (, Ω) for a base good b ∈
{1, · · · , I} in Section 2.1.2 is a special case of the construction above for a vector ψ such that ψb = 1 and
ψi = 0 for i 6= b.
     To simplify the expressions, and in line with the convention in Section 2.1.2 , let us drop the superscript
ψ and denote the index of real consumption and the parameters by C and (σ, , Ω), bearing in mind that
both correspond to a given vector ψ. Solving for the Hicksian demand in terms of the ψ-index of real
                                                1−σ                          PI              QI
consumption, we find ωi = Ωi (pi C i /E)           . Using the constraints i=1 ψi i = 1, i=1 Ωψ    i
                                                                                                    i = 1, and
P
  i ψi = 1, we find that                                             1−σ
                                                       Q I
                                           YI
                                                           i=1 pψ
                                                                i
                                                                  i

                                               ωiψi =               C    .
                                           i=1
                                                             E

This allows us to write the ψ-index of real consumption in terms of observed data as

                                                                 I                              I
                                                                 X                         1 X
                                  log C = log E −                      ψi log pi +                 ψi log ωi ,                                  (A.15)
                                                                 i=1
                                                                                         1 − σ i=1

which generalizes the expression in Equations (8) and (13). Substituting this expression in the Hicksian
demand, we find the following I constraints that together define the implicit Marshallian demand
                                                                                                                      
                              I
                              X                                                                     I
                                                                                                    X                          I
                                                                                                                               X
log ωi = (1 − σ) log pi −             ψj log pj +(i − 1) (1 − σ) log E −                                ψj log pj +i           ψj log ωj +log Ωj ,
                                 j=1                                                                j=1                        j=1
                                                                                              (A.16)
generalizing Equation (12). Note that, as before, the set of equations defined in (A.16) imply I − 1
independent constraints on the expenditure shares.69
    Finally, the following lemma shows that the knowledge of the parameters for a given base ψ is
  69
    We also want to briefly make a complementary comment. After obtaining the estimates of the nonhomo-
theticity parameters, it is possible to refine the construction of the real consumption index and convexify the
solution in a similar way to what we have discussed above. Let (Ω̂i , ˆi , σ̂)i denote the set of estimates. We can


                                                                           55
sufficient to be able to recover the parameters for any other base ψ 0 .

Lemma 5. Consider two vectors ψ and ψ 0 , and the corresponding indices and parameters (C, , Ω) and
(C 0 , 0 , Ω0 ). We can show that one can transform the parameters from one index to the other according
to:
                                                                  i
                                                   0i = P           0    ,
                                                                 j ψ j j
                                                                            Ωi
                                               Ω0i =                                          i       .
                                                                                ψ0
                                                       QI                            P           0
                                                                                             j ψj j
                                                                  j=1 Ωj
                                                                         i




Proof. The results follow from a simple substitution of the expressions implied by Equation (A.14) for
(, Ω) and (0 , Ω0 ). We can recover 0 through:
                                                                  εi
                                   i                                     ε
                                                             P
                                                    0 ψ 0ε 0
                              P       0    =P     j j j             = P i 0 = 0i .
                                  j ψ j j      0 P εj                   j ψj εj
                                             j ψj      00 ψ 00 ε 00j        j        j



Similarly, we can recover Ω0 through

                                                                                                  Υi        
                                                                                                     ψ 0          i
                                                                                                   Υj 0j
                                                                                             Q
                                        Ωi                                                    j0
                                                     i      =                                                           i       ,
                                        ψ0                                         ψ0
                             Q               P        0
                                                                                                                      !P    0
                                 I                 j ψj j                            j                                j ψ j j
                                       Ωj i
                                                                                         Q
                                 j=1                                           j Υj
                                                                                        ψ0 
                                                                                 P
                                                                            ψj     j 00 j 00 j 00
                                                                       Q      
                                                                         j Υj

                                                                              Υi
                                                             =                  εi ,
                                                                Q            ψj0 Pj ψj0 εj
                                                                            Υ
                                                                           j j

                                                             = Ω0i ,

where in the last equality we have used the fact that 0i = i /                                            ψj0 j .
                                                                                                   P
                                                                                                       j

invert the Hicksian demand (3) for each sector i
                                                                   p 
                                                                        i
                         log ωi = log Ω̂i + (1 − σ̂) log                        + (1 − σ̂) ˆi log C,                      ∀i ∈ I,    (A.17)
                                                                       E
                                                       c i , where i denotes the estimate for sector i. If the demand
to obtain an estimate of the real consumption index, logC
system was exactly a nonhomothetic CES observed without noise, we would recover the same real consumption
index for all the equations. In general, however, this is not the case and, in general, we end up with a vector of
  c i )i∈I where each entry is different to each other. If we stick to the construction in Section 2, we would be
(logC
only using the base sector to recover the real consumption index, i.e., we would be selecting i = b. Despite being
perfectly logically consistent, this would disregard the information contained in the other entries of the vector.
Thus, if the goal is to find the “best” measure of the real consumption index, one could try to find a set of weights
for each entry of the vector that maximizes a given objective function. While a formal analysis of this is beyond
the scope of the paper, we note that in Comin et al. (2018), we used this approach and selected as weights the
average sectoral share of each country. We found that the model fit improved marginally.




                                                                       56
B     Proofs
B.1     Proofs of Propositions and Lemmas
Proof of Lemma 1. As we discussed in Section 2.1, the expression for the nonhomothetic CES Mar-
shallian demand is given by
                                              p −σ
                                                 i
                               Ci = Υi                       V (E; p)(1−σ)εi ,          1 ≤ i ≤ I,          (B.1)
                                              E
where the indirect utility function V (·, p) satisfies:

                                             "                                             1
                                                                                        # 1−σ
                                                 I
                                                 X
                                    E=                 Υi V (E; p)(1−σ)εi p1−σ
                                                                           i                    .           (B.2)
                                                 i=1


In line with the definition of the nonhomothetic CES index of real consumption, define a monotonic
                                                                                    1
transformation of the indirect utility function as C(E; p) ≡ Υb1−σ V (E; p)εb . Simple algebra shows that
we can rewrite Equations (B.1) and (B.2) solely in terms of parameters  and Ω defined in Equation (11)
as:                                     !
                                 Υi        p −σ
                                             i
                       Ci =      εi /εb
                                                  C(E; p)(1−σ)(εi /εb ) , 1 ≤ i ≤ I,                (B.3)
                               Υ            E
                                   b

where the function C(·, p) satisfies:

                                  "                          !                                     1
                                                                                                # 1−σ
                                       I
                                       X             Υi
                             E=                      ε /εb
                                                                 C(E; p)(1−σ)(εi /εb ) p1−σ
                                                                                        i               .   (B.4)
                                       i=1    Υbi

    Similarly, the observable income (expenditure) elasticities may also be written in terms of  and Ω.
Since we can express the Marshallian demand in terms of  and Ω, we can also write the expenditure-
share-weighted average at time t as εt ≡ εb × t , also in terms of these parameters. The expression for
the income elasticity in Equation (10) then implies that the income elasticity of sector i at time t satisfies
ηit = σ + (1 − σ)i /t .

Proof of Lemma 2. To connect the household problem to the static problem solved in Section A, we
explicitly add the expenditure to the problem and state it as:
                                                                   ∞
                                                                   X
                                                       max               β t v (F (Ct ))
                                                 (Ct ,Et At )t
                                                                   t=0

                                       s.t. wt + (1 + rt ) At − At+1 − Et ≥ 0,
                                                                 X
                                                            Et −    pit Cit ≥ 0.
                                                                            i∈I


along with the no-Ponzi constraint. Given the definition of the function u(·), it is straightforward to show
that v(F (Ct )) = u(G(Ct )), with function G(·) defined in Equation (13). Therefore, letting Ct ≡ G(Ct ),




                                                                    57
we can set up the intermediate Lagrangian problem:

                               ∞
                                             "                                                              !                      #
                                                                        X                    σ1     σ−1
                                                                                  (1−σ)i
                               X
                                         t
                max                  β           u(Ct ) + ρt     1−           Ωi Ct                 Citσ
                                                                                                                + λt (Et − pt · Ct ) ,
           (Ct ,Et ,Ct At )t
                               t=0                                       i

                                                                              s.t. wt + (1 + rt ) At − At+1 − Et ≥ 0.

The first order conditions for Ct ’s are given by

                                                                      σ − 1 ωit
                                                                 ρt             = λt pit ,                                               (B.5)
                                                                        σ Cit
                                   1            σ−1
where we have defined ωit ≡ Ωiσ Ct−i Cit σ . Note that this condition corresponds exactly to that
we found in the static problem in Equation (A.5). Substituting this condition in Et = pt · Ct and
                                                                     −σ
                                                  ρt                 pit        (1−σ)
using the definition of ωit , we find Et = σ−1σ λt   and C it = Ω i  Et       Ct i     . Substituting for Cit in
       PI
Et = i=1 pit Cit yields the expression relating Et and Ct , and Equation (12) follows along the same line
as the derivations in the main text.70
     The derivation above shows that along any optimal path, the streams of indices of real consumption
                                                      PI                1−σ
(Ct )t and total expenditures (Et )t satisfy Et1−σ = i=1 Ωi (Cti pit )     . Given the parameter restrictions,
we know that we can define a function Ct as a monotonically increasing and invertible function of Et
as Ct = C (Et ; pt ). This function is the indirect utility function corresponding to the cardinalization of
utility implied by the nonhomothetic CES index of real consumption. Therefore, we have decomposed the
problem into two independent parts. The intratemporal problem involves allocating the expenditure Et
across I goods so as to maximize instantaneous utility Ut defined by Equation (1). The solution is given
by Equations (3) and (4). The intertemporal one, which we will characterize next, involves allocating the
stream of expenditures (Et )t and assets (At )t over time given the paths of good prices and initial assets.
     Substituting for the expenditure Et from the period budget constraint, we can write the intertemporal
                                                              ∞
problem as that of finding the sequence of assets {At+1 }t=0 such that

                                                      ∞
                                                      X
                                             max            β t u (C (wt + (1 + rt ) At − At+1 ; pt )) .                                 (B.6)
                                             (At )t
                                                      t=0


Next, we provide conditions that ensure that the function u (C (·; pt )) is monotonically increasing and
strictly concave for all prices. Then, we invoke standard results from discrete dynamic programming
(e.g., see Acemoglu, 2008, Chapter 6, Theorem 6.12) to conclude that the Euler equation

                                                        ∂Ct                                           ∂Ct+1
                                             u0 (Ct )            = β (1 + rt+1 ) u0 (Ct+1 )                 ,
                                                        ∂Et                                           ∂Et+1

and the transversality condition

                                                                                        ∂Ct
                                                        lim β t (1 + rt ) At u0 (Ct )       = 0,                                         (B.7)
                                                      t→∞                               ∂Et
  70
    An alternative strategy
                      h     for deriving the two-stage budgeting
                                                              i nature of the optimal solution is to substitute for
                                                   P
one base good Cb,t = wt + (1 + rt ) At − At+1 − i6=b pit Cit /pb,t and note that the choice of control variables
C−b,t ≡ (Cit )i6=b do not have any dynamic implications. The optimality conditions for these control variables
coincide with Equation (B.5).



                                                                             58
                                                                             ∞
provide necessary and sufficient conditions for a sequence {At+1 }t=0 to characterize the solution.
    To ensure the concavity of u (C (·; pt )), let us compute its second derivative:
                                                            2
                  ∂2                                                         ∂ 2 Ct
                                                      
                                           00           ∂Ct         0
                      u (C (Et ; p t )) = u   (Ct ) ·           + u   (C t )        ,
                 ∂Et2                                   ∂Et                  ∂Et2
                                                            2         "                              #
                                                                         Ct u00 (Ct ) Ct ∂ 2 Ct /∂Et2
                                                     
                                           0           ∂Ct       1
                                        = u (Ct ) ·            ·     ·                +            2    .   (B.8)
                                                       ∂Et       Ct        u0 (Ct )     (∂Ct /∂Et )

Since u (·) is increasing and u0 (·) > 0, to ensure that the second derivative of u (C (·; pt )) is negative, it
is sufficient to ensure that the expression in the rightmost square brackets above is negative everywhere.
     To derive a sufficient condition that ensures this, we use the results of the previous section, and
in particular Equation (A.13) (under the choice of g(U ) = U, Υ = Ω, and ε = . Let E (·; pt ) be
the corresponding expenditure function in terms of the nonhomothetic CES index of real consumption.
Equation (A.13) implies that

                                 ∂ 2 E (Ct ; pt )
                                                                            
                                                    Et 2                     i
                                                  =       1 + (1 − σ) V ar      .
                                      ∂Ct2          Ct2 t                    t

Now, note that E (C (Et ; pt )) = Et , which implies:
                                                                                           2
                                                           ∂ 2 Ct   ∂ 2 Et
                                                                                 
                          ∂Et   ∂Ct                  ∂E                              ∂Ct
                              ×     = 1,                 ×        +        ×                    =0
                          ∂Ct   ∂Et                  ∂Ct   ∂Et2     ∂Ct2             ∂Et

These results allow us to rewrite the expression within the square bracket in Equation (B.8) as follows.
                                                                                     
                     Ct u00 (Ct ) Ct ∂ 2 Ct /∂Et2   Ct u00 (Ct ) Ct ∂ 2 Et /∂Ct2
                      u0 (Ct )
                                 +             2 = u0 (C ) −           ∂Et /∂Ct
                                                                                       ,
                                   (∂Ct /∂Et )              t

                                                    Ct u00 (Ct )    Ct2       ∂ 2 Et
                                                  =              −          ×        ,
                                                     u0 (Ct )      Et ηECtt   ∂Ct2
                                                                                     
                                                                                        i
                                                  < −θ − t 1 + (1 − σ) V art              + 1,
                                                                                       
where in the first equality, we have used the expressions relating the partial derivatives of Ct with respect
to Et as those of Et with respect to Ct , and in the last inequality we have used the bound on the second
derivative of E (·; pt ) stated above, as well as the bound on the elasticity of u0 (·).
     We now have two cases. If 0 < σ < 1, a sufficient condition for the upper bound in the expression
                                                                                                               2
above to be negative is that θ > 1 − min .71 If 1 < σ, we rely on the fact that V ar (i ) ≤ 14 (max − min )
to find Equation (20) to ensure the concavity of u (C (·; pt )).
     Having established the concavity of the instantaneous utility function in terms of At and At+1 , it
follows that the Euler equation

                                              ∂Ct                            ∂Ct+1
                                   u0 (Ct )       = β (1 + rt+1 ) u0 (Ct+1 )
                                              ∂Et                            ∂Et+1
  71
     In Lemma 1 of the working paper draft of this paper (Comin et al., 2018), we have imposed the alternative
set of assumptions i ≥ 1 and θ > 0.




                                                           59
and the transversality condition

                                                                           ∂Ct
                                      lim β t (1 + rt ) At u0 (Ct )            = 0,                             (B.9)
                                     t→∞                                   ∂Et
                                                                                 ∞
provide necessary and sufficient condition for a sequence {At+1 }t=0 to characterize the solution.
    Using the results of Section A, we can simplify each side of the Euler equation as

                                          ∂Ct            Ct 1               Ct 1
                               u0 (Ct )       = u0 (Ct )         = u0 (Ct )       ,
                                          ∂Et            Et ηECt            Et t
                                                                     t



where in the first equality we have used the definition of the utility elasticity of the expenditure function
ηEC , in the second inequality we have substituted ηEC = . We can now write the Euler equation as stated
in Equation (21). Moreover, using the same results, we can also rewrite the transversality condition (B.9)
as
                                                                 At Ct
                                      lim β t (1 + rt ) u0 (Ct )        = 0.
                                     t→∞                         t E t



Proof of Proposition 1. Our proof for the proposition involves two steps. First, we use the second
Welfare Theorem and consider the equivalent centralized allocation by a social planner. Due to the
concavity of the per-period indirect utility function v (V (·; pt )) ≡ u (C (·; pt )), which is ensured by the
conditions in Lemma 2, we can use standard arguments to establish the uniqueness of the equilibrium
allocations (see Stokey et al., 1989, p. 291). Next, we construct a unique constant growth path (steady
state) that satisfies the equilibrium conditions. It then follows that the equilibrium converges to the
constructed Constant Growth Path (CGP).
     Consider an equilibrium path along which consumption expenditure Et , aggregate stock of capital
                                                                                                           1
Kt , and the capital allocated to the investment sector K0t all asymptotically grow at rate (1 + γ0 ) 1−α0 ,
and the labor employed in the investment sector asymptotically converges to L∗0 ∈ (0, 1). Henceforth, we
                                                                    1                                      1
                                                              −                                        −
use the tilde variables to denote normalization by A0t 1−α0 , for instance, K̃t ≡ A0t 1−α0 Kt . Accordingly,
we can write the law of evolution of aggregate stock of capital as

                                          1−δ                               1               α0 1−α0
                        K̃t+1 =               1/(1−α0 )
                                                          K̃t +               1/(1−α0 )
                                                                                          K̃0t L0t ,           (B.10)
                                  (1 + γ0 )                       (1 + γ0 )

and the interest rate and wages as
                                                                           !α0 −1
                                                                    K̃0t
                                   rt = Rt − δ        = α0                           − δ,                      (B.11)
                                                                    L0t
                                                                         α0 −α0
                                                w̃t   =      (1 − α0 ) K̃0t L0t .                              (B.12)

From the assumptions above, it follows that K̃0t /L0t asymptotically converges to a constant, which from
Equation (B.11) implies that the rate of interest also converges to a constant r∗ .
   We first derive an expression for the asymptotic growth of nominal consumption expenditure shares




                                                            60
(and sectoral employment shares) of different sectors:
                                                       1−σ                    1−σ
                                                                 pit+1 Ct+1 i
                                                                        
                             ωit+1                 Et
                1 + ξi ≡ lim            =     lim                                        ,
                          t→∞ ωit         t→∞ Et+1                pit       Ct
                                                      1−σ
                                                    1−α                 1−αi            !(1−σ)
                                               1          0    (1 + γ0 ) 1−α0       ∗ i
                                        =                                     (1 + γ )          ,
                                            1 + γ0                1 + γi
                                          "                          #1−σ
                                                            
                                                  (1 + γ ∗ ) i
                                        =              αi                  ,                                (B.13)
                                            (1 + γ0 ) 1−α0 (1 + γi )

where in the second line we have used the definition of the constant growth path as well as the fact
                                                                                                  1
that from Equations (B.11) and (B.12), the relative labor-capital price grows as rate (1 + γ0 ) 1−α0 and
therefore from Equation (24) we have

                                         pit+1   1 + γ0          α0 −αi
                                       lim     =        (1 + γ0 ) 1−α0 .                                    (B.14)
                                      t→∞ pit    1 + γi

Equation (B.13) shows that the expenditure shares asymptotically grow (or diminish) monotonically.
Since the shares belong to the compact I − 1 dimensional simplex, they asymptotically converge to a
time-constant set of shares.
    Since shares have to add up to 1, we need to have that ξi ≤ 0 for all i. Moreover, this inequality has
to be satisfied with equality at least for one non-vanishing sector. Now, consider the expression defined
in (30) for the growth rate of the nonhomothetic CES index of real consumption. For sectors i ∈ I ∗
that achieve the minimum (maximum) for 0 < σ < 1 (1 < σ), the growth of nominal expenditure share
becomes zero, and their shares converge to constant values ωi∗ . For sectors i ∈
                                                                               / I ∗ , we find that the rates
of growth in nominal sectoral shares ξi in Equation (B.13) become negative.
    Asymptotically, the expenditure-weighted average income elasticity and expenditure-weighted capital
                                                                                 PI
intensity in the consumption sector both converge to constants ¯∗ ≡ limt→∞ i=1 i ωit = i∈I ∗ i ωi∗
                                                                                                 P
                   PI
and ᾱ∗ ≡ limt→∞ i=1 αi ωit = i∈I ∗ αi ωi∗ . Henceforth, with slight abuse of notation, we use tilde to
                                  P

also indicate variables normalized by their corresponding asymptotic rate of growth (or decline) along
                                                                                       1−αi
our proposed constant growth path. For instance, we let p̃it ≡ pit (1 + γ0 )− 1−α0 t (1 + γi )−t and C̃t ≡
Ct (1 + γ ∗ )−t . Furthermore, we define starred notation to indicate the asymptotic value of each variable
along the constant growth path, for example, we let p∗i ≡ limt→∞ p̃it and C̃ ∗ ≡ limt→∞ C̃t .
    We now show that a constant growth path exists and is characterized by γ ∗ as defined by equation (30).
We also show the existence of the asymptotic values {K̃ ∗ , Ũ ∗ , K̃0∗ , L∗0 }. First, note that the left hand side
                                                                         −θ
in the Euler equation (21) asymptotically converges to (Ct+1 /Ct ) due to assumption (27) as Ct → ∞.
Noting that Pt = Et /Ct , the Euler equation then implies
                                                                         1
                                                    1−θ       (1 + γ0 ) 1−α0
                                          (1 + γ ∗ )      =                  ,                              (B.15)
                                                               β (1 + r∗ )

which pins down r∗ , the asymptotic real interest rate in terms of γ ∗ given by Equation (30). Then
from Equation (B.11), we find the asymptotic capital-labor ratio in the investment sector in terms of the
asymptotic real interest rate
                                             ∗               1
                                                           1−α
                                         K̃0         α0         0
                                     κ≡ ∗ =         ∗
                                                                  .                               (B.16)
                                          L0       r +δ


                                                          61
This gives us the asymptotic relative labor-capital price from Equations (B.11) and (B.12) as
                                                                                                          1
                                    w̃∗   1 − α0 K̃ ∗
                                                                                                      1−α
                                                        1 − α0                                 α0               0
                                        =             =                                                             .   (B.17)
                                    R ∗     α0 L∗0        α0                                 r∗ + δ

       From Equation (24), we find

                                                                   1−α0                      α0 −αi
                                               α0α0 (1 − α0 )                         w̃∗
                                                                                
                                                                                                        A0,0
                                    p̃∗i   =                       1−αi                                      ,          (B.18)
                                               αiαi   (1 − αi )                       R∗                Ai,0

where w̃∗ /R∗ is given by Equations (B.17) and (B.15) and Ai,0 denotes the initial state of technology in
sector i and A0,0 ≡ 1. Given asymptotic prices
                                                    "                                                  1
                                                                                                    # 1−σ
                                                        X                     i          1−σ
                                           Ẽ ∗ =             Ωi        C̃ ∗          p̃∗i                  ,           (B.19)
                                                      i∈I ∗


and                                                                      i p̃∗ 1−σ
                                                 ωi∗ = Ωi           C̃ ∗         i
                                                                                        .                               (B.20)
                                                                               Ẽ ∗
     Next, we combine the equation for accumulation of capital (B.10), the household budget constraint
(23), and the market clearing condition of consumption goods to establish that there exists a unique
{K̃ ∗ , C̃ ∗ , K̃0∗ , L∗0 } satisfying the asymptotic equilibrium conditions and κ = K̃0∗ /L∗0 where κ is given by
Equation (B.16). From market clearing, the sum of payments to labor in the consumption sector is
PI
  i=1 (1 − αi )ωit Eit , which implies (1 − ᾱt ) Ẽt = w̃t (1 − L0t ). Asymptotically, we find that


                                           (1 − ᾱ∗ ) Ẽ ∗ = (1 − α0 ) κα0 (1 − L∗0 ) .                                 (B.21)
                                                   h          1
                                                                          i
Similarly, from Equation (B.10) it follows that (1 + γ0 ) 1−α0 − (1 − δ) K̃ ∗ = κα0 L∗0 . Defining the
expression within the square brackets at a positive constant ϑ, we write the asymptotic employment in
the investment sector in terms of the aggregate stock of capital as

                                                          L∗0 = ϑκ−α0 K̃ ∗ .                                            (B.22)

Finally, using the market      α0 condition in the assets market At = Kt and Equation (23), we find
                          clearing
                          K̃0t
that Ẽt = w̃t + Rt K̃t − L0t     L0t for all t. Taking the limit, it follows that

                                     Ẽ ∗ = (1 − α0 ) κα0 + α0 κα0 −1 K̃ ∗ − κα0 L∗0 .                                  (B.23)

       Substituting from Equation (B.22) into Equations (B.21) and (B.23) yields,

                                                ᾱ∗ Ẽ ∗ = α0 κα0 −1 − ϑ K̃ ∗ .
                                                                        
                                                                                                                        (B.24)

We can show that the left hand side of this equation is a monotonically increasing function of C̃ ∗ with
a given κ.72 From condition (31), we have that κα0 −1 − ϑ > 0 and therefore the right hand side is a

  72              ∂ (ᾱ∗ Ẽ ∗ )     ∗ ∗
   We have that ∂ C̃ ∗          = ᾱC̃Ẽ∗ 1−σ
                                           
                                           ¯
                                              [1 + (1 − σ) ρi ,αi ] where ρi ,αi is the correlation coefficient between i
and αi under a distribution implied by expenditure shares (see online Appendix for details of the derivation).


                                                                     62
linear increasing function of K̃ ∗ . Therefore, Equation (B.24) defines C̃ ∗ , and correspondingly Ẽ ∗ , as an
increasing function of K̃ ∗ . Finally, substituting this function and Equation (B.22) in Equation (B.23),
we find
                                     Ẽ + ϑ − ακα0 −1 K̃ = (1 − α0 ) κα0 .
                                                      
                                                                                                         (B.25)

From condition (31), we know that the left hand side is a monotonically increasing function of K̃ ∗ for con-
stant κ. This function is 0 when K̃ ∗ is zero, and limits to infinity as the latter goes to infinity. Therefore,
Equation (B.25) uniquely pins down K̃ ∗ as a function of κ, which in turn is given by Equation (B.16).
Condition (31) also ensures that the transversality condition (22) is satisfied. Finally, we verify that
L∗0 ∈ (0, 1). Combining equations (B.22), (B.21) and (B.23) we obtain that

                                                                 ᾱ
                                       L∗0 = h                                    i                                 (B.26)
                                                 1−ᾱ
                                                 1−α0   (α0 κα0 −1 ϑ−1 − 1) + 1

Assuming that the term in square brackets is positive, we have that L∗0 ∈ (0, 1) if and only if ϑ < κα0 −1 ,
                                                                                                          α0
                                                                                                     −
                                                                                           (1+γ0 )       1−α0
which in terms of fundamental parameters requires that β(1 + γ ∗ )1−θ <                                  −      1   which
                                                                                     α0 +(1−α0 )(1+γ0 ) 1−α0 (1−δ)
is the condition stated in (31). Also, it is readily verified that as             long as ϑ < κα0 −1 , L∗0 cannot
                                                                                                        be
negative.
    Therefore, we constructed a unique constant growth path that asymptotically satisfies the equilibrium
conditions whenever the parameters of the economy satisfy Equation (31). Together with the uniqueness
of the competitive equilibrium, this completes the proof.



B.2     Other Derivations
Derivations for the Results in Section 2.2.3 We first characterize the dynamics of the state
                                                                                               α 1−α
variable, the normalized per-capita stock of capital k̃t ≡ K̃t /L. Substituting in Kt+1 = A0t K0t L0t +
Kt (1 − δ) and noting the equality of per-capita stock of capital across sectors, we find
                                                 1
                                      (1 + γo ) 1−α k̃t+1 = k̃tα l0,t + k̃t (1 − δ) ,

where l0,t ≡ L0,t /L is the share of labor employed in the investment sector. We can show that this share
is given by l0,t = 1 − Ẽt /k̃tα (see the online appendix), therefore establishing Equation (33).
     For the evolution of per-capita consumption, we need to write Ct+1 /Ct in terms of variables known
                                                                  1−θ
at time t. Rewriting the Euler Equation (21) as (Ct+1 /Ct )            β (1 + rt+1 ) = (Et+1 /Et ) t+1 /t , first note
that the interest rate is given from Equation (B.11) as rt = αk̃tα−1 − δ. Substituting for the normalized
variables, we find
                                       !1−θ                                     !
                                                       1−θ
                                 C̃t+1      (1 + γ ∗ )                     Ẽt+1 t+1
                                                        1  β (1 + rt ) =                .
                                  C̃t       (1 + γ0 ) 1−α                   Ẽt      t

Using the expression for the asymptotic rate of interest r∗ from (B.15) then gives us Equation (34).

Therefore, the derivative is always positive and the function is a monotonic function of C̃ ∗ .




                                                            63
    Next, we can can write the growth in per-capita consumption expenditure as
                                1−σ           I            1−σ                1−σ
                          Et+1                  X         pit         Ct+1 i pit+1
                                            =     Ωi Cti                                  ,
                           Et                 i=1
                                                          Et            Ct       pit
                                               I            (1−σ)         (1−σ)t
                                              X         Ct+1 i         1 + γ0
                                            =     ωit                                 ,
                                              i=1
                                                         Ct            1 + γi

where we have used Equation (4), Equation (24), and the expression for expenditure shares ωit =
                   (1−σ)
Ωi (pit /Et )1−σ Ct i     under the assumption of αi ≡ α. Substituting for the normalized variables Ẽt
and C̃t in the expression above gives Equation (35).
     Finally, we use the same idea to rewrite the term t+1 as follows

                             I               1−σ
                 t+1       X
                                    i pit+1
                          =       Ct+1                i ,
                  t        i=1
                                        Et+1
                                   1−σ X  I              1−σ               1−σ  
                                Et                     pit           Ct+1 i pit+1        i
                          =                      Cti                                        ,
                              Et+1         i=1
                                                       E  t            C t    p it        t

                            PI               i (1−σ)         (1−σ)t  
                                        Ct+1                1+γ0           i
                                   ω
                               i=1 it     Ct                1+γi           t
                          =                     i (1−σ)         (1−σ)t .
                               PI           Ct+1              1+γ0
                                  i=1 ωit    Ct               1+γi

                                                                                      t
                                                                                  − 1−α
Multiplying both the numerator and the denominator by (1 + γ0 )                           0   and substituting again for the
normalized variables Ẽt and C̃t gives us Equation (36).

Proof of Equation (46). From the definition of the expenditure function in Equation (4), we have
                         1−σ      P            (1−σ)
                                                 i         1−σ
                   Et+1                     Ωi Ct+1       Pit+1
                                 = Pi            (1−σ)
                    Et                 Ωi Ct i          Pit1−σ
                                        i
                                                                              i (1−σ)        1−σ
                                     P            i (1−σ) 1−σ           Ct+1              Pit+1
                                        i  Ω i C  t        P it    ×       Ct               Pit
                                 =                                         −i (1−σ)         −(1−σ)
                                   P          i (1−σ) 1−σ            Ct+1                Pit+1
                                     i Ω  i Ct+1        P it+1  ×       Ct                 Pit
                                                                                  i (1−σ)        1−σ
                                                              P               Ct+1             Pit+1
                                   
                                     Et+1
                                            −(1−σ)
                                                                 i ω it ×      Ct               Pit
                                 =                                                −i (1−σ)         −(1−σ) .
                                      Et                 P                
                                                                            Ct+1                Pit+1
                                                            i ω it+1  ×       Ct                 Pit


Assuming that ∆ log Et = log (Et+1 /Et )  1 and ∆ log Pit = log (Pit+1 /Pit )  1 for all i, we can rewrite
the expression above up to the second order in ∆ log Et , ∆ log Ct , and ∆ log Pit as
                                                                                   
                Et+1       1    X                              Pit+1           Ct+1
            log      ≈              (ωit + ωit+1 ) (1 − σ) log       + i log         ,
                 Et    2 (1 − σ) i                              Pit             Ct
                       "                               # "                       #
                         1X                      Pit+1     1X                           Ct+1
                     =        (ωit + ωit+1 ) log        +       (ωit + ωit+1 ) i × log      ,
                         2 i                      Pit      2 i                           Ct
                       |             {z                } |          {z           }
                                            ≡∆ log Pit                            ≡E t




                                                                  64
from which Equation (46) follows.


C      Discussion of the Estimation Strategy without Exact Price
       Index
To simplify the exposition of the derivations, we define the following notation, only to be used within
this section of the Appendix: let Yitn ≡ log (ωit
                                                n   n
                                                  /ωmt ), Pitn ≡ log (pnit /pnmt ), Xtn ≡ log Ctn , and Zit
                                                                                                         n
                                                                                                            ≡
      n    n
log (Et /Pt ) for all i ∈ I− = I\ {m}. We can then rewrite Equation (7) as

                                Yitn = (1 − σ) Pitn + (i − m ) Xtn + ζin + νit
                                                                              n
                                                                                 , i ∈ I− .                           (C.1)

Henceforth, we assume i is always within set I− and drop the reference to the set.
   Throughout, we maintain the following assumptions.73
                                                                                                     n n
Assumption 1. Relative prices and income are orthogonal to the errors, that is, E Pjt                     νit = E [Xtn νit
                                                                                                                        n
                                                                                                                           ]=
0 for all i, j. Moreover, relative prices are not perfectly correlated with either the real income index Xtn
                                                                   1/2                                            1/2
or the proxy Ztn , that is, |E [Xtn Pitn ] | < (E [Xtn ] E [Pitn ])    and |E [Ztn Pitn ] | < (E [Ztn ] E [Pitn ]) .

    The different approaches discussed in Section 5 and Online Appendix I involve replacing the unob-
served index of real consumption Xtn by a proxy variable, for example, the consumption expenditure or
consumption expenditure deflated by a standard price index Ztn . For any population-level distribution of
relative prices and income, the indirect utility function Xtn (Ztn , P1t
                                                                      n             n
                                                                         , · · · , PIt ) can be log-linearized around
the population mean to yield
                                            X
                                     Xtn =       ηi Pitn + γZtn + ιn + unt ,                                     (C.2)
                                                      i

such that   E [unt ]
                  =                = E [Ztn unt ] = 0
                        E [Pitn unt ]                         for all i ∈ I−m (this corresponds to running an OLS
regression if we were to     observe Xtn ). It follows        that we can write
                                                                       X
                         Yitn = (1 − σ + ηi (i − m )) Pitn +                               n
                                                                              ηj (i − m ) Pjt                       (C.3)
                                                                       j6=i

                                         + (i − m ) γZtn + ζin + (i − m ) (ιn + unt ) + νit
                                                                                             n
                                                                                                .

    The lemma below establishes that we can identify the model’s nonhomotheticity parameters up to
a constant factor using a system OLS estimate or a feasible GLS estimate of log relative shares on log
relative prices and log real consumption expenditure, of the form74
                                                  X
                                         Yitn =                n
                                                          αij Pjt + βi Ztn + ζ̃in + ν̃it
                                                                                      n
                                                                                         .                            (C.4)
                                                  j



  73
      In the case of household-level data, instead of assuming the orthogonality of the covariates and the error,
we use instruments for both relative prices and income, which would slightly complicate the derivations that
follows. However, the main insights will remain intact whether we assume the orthogonality of the covariates or
the existence of instruments for them.
   74
      This result is fairly general and can be applied to all cases where one unobserved covariate appears on the
right hand side of more than one equation a system of equations, and a proxy variable exists that is correlated
with the unobserved covariate and is orthogonal to the error.


                                                                  65
Lemma 6. Assume that the model in Equation (C.1) is well-specified, Assumption 1 holds, and that
γ 6= 0, i.e., the real consumption index of nonhomothetic CES, Xtn , and our proxy variable, Ztn , e.g., the
real income calculated based on standard price indices, are correlated after controlling for relative prices.
Let βbi denote the coefficients on the real consumption expenditure based on estimating the system of
Equations C.4. Then, the coefficients on the proxy variable Ztn satisfy plim βbi /βbj = (i − m ) / (j − m ) .


D      Comparison with Stone-Geary and PIGL prefrences
We compare the cross-country fit of our model to alternative specifications where we replace the nonhomo-
thetic CES aggregator with Stone-Geary and PIGL preferences. A brief discussion of theses preferences
and estimation is given here. We relegate a detailed discussion to Online Appendix G.
    We start considering a generalized Stone-Geary formulation (Herrendorf et al., 2014). These prefer-
ences define the intra-period consumption aggregator as
                                                                                      σ
                                           σ−1            σ−1                  σ−1
                          h                                                        i σ−1
                     Ctc = Ωca (Cat
                                 c
                                    + c̄a ) σ + Ωcm (Cmt
                                                      c
                                                         ) σ + Ωcc (Cst
                                                                     c
                                                                        + c̄s ) σ        ,                                       (D.1)

where Ctc denotes aggregate consumption of country c at time t, Ωci > 0 are constant preference parameters
that are country specific, C,tc denotes consumption in sector i = {a, m, s}, c̄a and c̄s are constants that
govern the nonhomotheticity of these preferences, and σ is a parameter that tends to the price elasticity
                     c
of substitution as Cit   max{c̄a , c̄s }.75 We use the first-order conditions of the intra-period problem
to estimate the model. As with nonhomothetic CES preferences, we estimate three parameters that are
common across countries {σ, c̄a , c̄s } that govern the price and income elasticities and country-specific taste
parameters {Ωci }i∈I,c∈C . Our estimation results (reported in Table G.1 of the online appendix) imply
that the three sectors are gross complements and that nonhomotheticities are significantly different from
zero and of the expected sign, c̄a < 0 and c̄s > 0.
    Next, we study the cross-country fit of PIGL preferences as specified in Boppart (2014b). This
preference structure features a homothetic CES aggregator between agriculture and manufacturing with
price elasticity σ and a nonhomothetic aggregator between services and the agriculture-manufacturing
composite. The within-period indirect utility V of a household with total expenditure E c in country c is
                                                                                                             γ
                                                                                                            1−σ
                                                                          1−σ                        1−σ
                        1
                            
                                E c
                                       ε
                                                Ωcs           Ωca · (pcat )        + Ωcm · (pcmt )                     1 Ωcs
                  V =                       −         ·                                  γ                         −     +   ,   (D.2)
                        ε       pcst            γ                                  (pcst )                             ε   γ

with 0 ≤ ε ≤ γ < 1 and Ωci > 0 for i ∈ {a, m, s}. The nonhomotheticity and price elasticity between
services and the agriculture-manufacturing CES composite are governed by two parameters, ε and γ.
The nonhomotheticity is not vanishing as income grows, and the price elasticity grows with income but
is bounded above by 1.76
  75
     Since these preferences are not implicitly additive, the price and income elasticities are not independent. In
Appendix G.1 we show that the elasticity of substitution between i and j is σij = σηi ηj , where η’s denote income
elasticities.
  76
     The parameter ε governs the nonhomotheticity of preferences between services and the composite of agricul-
tural and manufacturing goods. If ε > 0, the expenditure elasticity is larger than one for services and less than
one for agricultural and manufacturing goods (and identical for both). The price elasticity of substitution between
services and the agriculture-manufacturing composite never exceeds one, it is increasing with the level of income
and it asymptotes to 1−γ. The baseline model in Boppart contains only two sectors. Here we follow the extension



                                                                              66
     We use the demand implied by these preferences to estimate the demand parameters. As with nonho-
mothetic CES and Stone-Geary, we estimate three elasticities that are common across countries {ε, γ, σ}
and we allow for country-specific constant taste parameters, {Ωci }i∈I,c∈C . We find that, at our estimated
parameter values, manufacturing and agriculture are gross complements and nonhomotheticities are sig-
nificantly different from zero. In fact, the nonhomotheticity parameter that we estimate is similar in
magnitude to the U.S. estimate reported in Boppart (2014a) (see table G.3).


E     Additional Tables and Figures




proposed in Appendix B.3.3 (Boppart, 2014b) to account for three sectors such that there can be a hump-shape
in manufacturing. We have generalized the demand to allow for constant taste parameters heterogeneous across
countries and not symmetric between agricultural and manufacturing goods. We have also experimented with
another proposed extension such that the expenditure share in the manufacturing sector constant (Appendix
B.3.2) obtaining a worse fit.


                                                    67
              Table 9: Estimation of Equation (39) under Different Base Sectors

                                   Manuf. as           Serv. as           Agri. as        Linear Comb.
                                  base, εm = 1       base, εs = 1       base, εa = 1      Three sectors
                                    (1)       (2)      (3)       (4)      (5)      (6)      (7)      (8)
    σ                              0.57     0.50      0.33      0.46     0.33     0.30     0.40     0.41
                                  (0.03)   (0.03)    (0.07)    (0.06)   (0.03)   (0.04)   (0.04)   (0.03)
    εa                             0.02     0.11      0.11      0.01        1        1     0.32     0.16
                                  (0.06)   (0.05)    (0.06)    (0.06)       -        -    (0.09)   (0.08)
    εm                                1        1      0.81      0.76     3.01     2.46        1        1
                                      -        -     (0.02)    (0.03)   (0.53)   (0.28)       -        -
    εs                             1.17     1.21           1       1     3.78     3.21     1.31     1.33
                                  (0.04)   (0.03)          -        -   (0.71)   (0.45)   (0.04)   (0.04)
    Country × Sector FE               Y        Y           Y      Y        Y        Y        Y        Y
    Trade Controls                    N        Y           N      Y        N        Y        N        Y

                                                 Implied Differences in Relative ε’s
    εa /εm − 1                    -0.98    -0.89     -0.86     -0.99    -0.67    -0.60    -0.68    -0.84
                                  (0.06)   (0.05)    (0.07)    (0.08)   (0.06)   (0.05)   (0.04)   (0.04)
    εs /εm − 1                     0.17     0.21      0.24      0.32     0.26     0.31     0.31     0.33
                                  (0.04)   (0.03)    (0.04)    (0.05)   (0.05)   (0.14)   (0.06)   (0.07)

                                                           R2 Measures of Fit
    Eq. 1                          0.95     0.94      0.94      0.94     0.66     0.77     0.93     0.92
    Eq. 2                          0.37     0.33      0.45      0.49     0.50     0.61     0.37     0.41
Notes: Robust standard errors are shown in parenthesis. εa /εm − 1 and εs /εm − 1 in columns (3) to (6) are
computed such that the results are comparable to our baseline exercise where we use manufacturing as base
(i.e., a − 1 and m − 1). Standard errors for these variables are computed using the delta method. Columns
(7) and (8) report the estimation where log C is a linear combination with equal weights across sectors as
described in Equation (A.15). Since the predicted values of our model do not come from ordinary least
squares regression, the R2 measures are computed as the squared of the Pearson coefficient of correlation
between true and predicted log-employment shares. This is equivalent to computing the R2 of the regression
of the true data on the predicted values plus a constant. For columns (1), (2), (7) and (8) Eqs. 1 and 2
corresponds to log (Ln    n              n    n
                     at /Lmt ) and log (Lst /Lmt ). For columns (3) and (4), Eqs. 1 and 2 correspond to

log (Ln    n              n    n                                                               n    n
      at /Lst ) and log (Lmt /Lst ). For Columns (5) and (6), Eqs. 1 and 2 correspond to log (Lmt /Lat ) and

log (Ln    n
      st /Lat ). All regressions have 1626 observations.




                                                      68
                        Table 10: Value-Added Household Estimation, CEX

                                          (1)          (2)         (3)         (4)         (5)         (6)
         σ                                0.34       0.34        0.31        0.52        0.30        0.33
                                        (0.02)     (0.02)      (0.02)      (0.04)      (0.03)      (0.03)
         a − 1                          -0.94      -0.98       -0.97       -0.99       -1.00       -0.99
                                        (0.08)     (0.09)      (0.08)      (0.47)      (0.11)      (0.10)
         s − 1                           0.64       0.62        0.66        0.90        0.88        0.94
                                        (0.08)     (0.09)      (0.08)      (0.58)      (0.11)      (0.11)
         Household Controls                 Y           Y           Y           Y           Y           Y
         Region FE                          N           N           Y           Y           Y           Y
         Year × Quarter                     N           N           N           N           Y           Y
Notes: Standard errors clustered at the household level. The number of observations is 60925 in all
regressions.




             Table 11: Housing as a Separate Group, CEX Expenditure, m = 1

                                                 (1)         (2)         (3)         (4)         (5)         (6)
     σ                                       0.17        0.19        0.20        0.17        0.19        0.23
                                           (0.04)      (0.04)      (0.03)      (0.04)      (0.03)      (0.03)
     a − 1                                 -0.71       -0.74       -0.73       -0.72       -0.81       -0.85
                                           (0.05)      (0.06)      (0.05)      (0.05)      (0.05)      (0.06)
     services (excl.   housing)   −1        0.75        0.77        0.77        0.67        0.65        0.65
                                           (0.07)      (0.07)      (0.07)      (0.06)      (0.06)      (0.07)
     housing − 1                            0.94        1.00        0.96        0.89        0.78        0.82
                                           (0.09)      (0.10)      (0.09)      (0.09)      (0.07)      (0.08)
     Expenditure Re-Weighted                      N           Y           N           Y           N           Y
     Region FE                                    N           N           Y           Y           Y           Y
     Year × Quarter FE                            N           N           N           N           Y           Y
     Notes: Standard errors clustered at the household level shown in parentheses. The number
     of observations is 60925 in all regressions.




                                                       69
                              Table 12: 10-Sector Regression, m = 1

                                                         World          OECD       Non-OECD
        Price Elasticity σ                                 0.10            0.13           0.07
                                                         (0.03)          (0.03)         (0.04)
        Sector i Nonhomotheticity Parameter i
        Agriculture                                        0.32            0.00           0.38
                                                         (0.05)          (0.04)         (0.06)
        Mining                                             0.41            0.01           0.67
                                                         (0.06)          (0.04)         (0.05)
        Public Utilities                                   1.59            1.32           1.61
                                                         (0.05)          (0.03)         (0.05)
        Transp., Storage, Communications                   1.44            1.36           1.41
                                                         (0.03)          (0.04)         (0.03)
        Construction                                       1.03            0.72           1.09
                                                         (0.02)          (0.02)         (0.02)
        Community, Social and Personal Serv.               1.18            0.85           1.21
                                                         (0.03)          (0.05)         (0.03)
        Wholesale and Retail                               1.62            1.59           1.58
                                                         (0.04)          (0.05)         (0.04)
        Finance, Insurance, Real State                     2.17            2.36           2.04
                                                         (0.07)          (0.11)         (0.07)
        Observations                                       1596             492          1104
Notes: Standard errors clustered at the country level. All regressions include a sector-country fixed ef-
fect. For the OECD regression, we constain the agriculture and mining parameter to be non-negative (by
estimating the exponent of i , standard errors are adjusted using the delta method).




                                                    70
