                              NBER WORKING PAPER SERIES




                          THE DARWINIAN RETURNS TO SCALE

                                         David Baqaee
                                        Emmanuel Farhi

                                      Working Paper 27139
                              http://www.nber.org/papers/w27139


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                           May 2020, Revised November 2020




Emmanuel Farhi tragically passed away in July, 2020. Emmanuel was a one-in-a-lifetime
collaborator and friend. Revising this paper without him has been very difficult. We thank Cédric
Duprez and Oleg Itskhoki for sharing their data. We thank Maria Voronina and Sihwan Yang for
outstanding research assistance. We thank Pol Antras, Andrew Atkeson, Ariel Burstein, Elhanan
Helpman, Chad Jones, and Marc Melitz for useful comments. We acknowledge research financial
support from the Ferrante fund at Harvard University and NSF grant #1947611. The views
expressed herein are those of the authors and do not necessarily reflect the views of the National
Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2020 by David Baqaee and Emmanuel Farhi. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
The Darwinian Returns to Scale
David Baqaee and Emmanuel Farhi
NBER Working Paper No. 27139
May 2020, Revised November 2020
JEL No. E0,E1,E23,O24,O4,O41

                                          ABSTRACT

How does an increase in the size of the market, say due to fertility, immigration, or globalization,
affect welfare? We study this question using a model with heterogeneous firms, Kimball
preferences, fixed costs, and monopolistic competition. We decompose changes in welfare from
increased scale into changes in technical efficiency and changes in allocative efficiency due to
reallocation. We non-parametrically identify residual demand curves with firm-level data from
Belgian manufacturing firms and, using these estimates, quantify our theoretical results. We find
that around 80% of the aggregate returns to scale are due to changes in allocative efficiency. As
markets get bigger, competition intensifies and triggers Darwinian reallocations: socially-
valuable firms expand, small firms shrink and exit, and new firms enter. However, important as
they are, improvements in allocative efficiency are not driven by reductions in markups or deaths
of unproductive firms. Instead, they are caused by a composition effect that reallocates resources
from low- to high-markup firms.


David Baqaee
Department of Economics
University of California at Los Angeles
Bunche Hall
Los Angeles, CA 90095
and CEPR
and also NBER
baqaee@econ.ucla.edu

Emmanuel Farhi
and CEPR
N/A user is deceased
        1     Introduction
        Aggregate increasing returns to scale underlie some of the most fundamental problems in
        economics, ranging from the mechanics of growth, to the gains from trade, to the benefits
        from industrial and competition policy. Despite their importance, the origins and magnitudes
        of these forces remain unclear. This paper argues that, to a large extent, increasing returns to
        scale at the aggregate level may reflect changes in allocative rather than technical efficiency.
        That is, as the market becomes larger, competition intensifies and reallocates resources across
        firms in ways that boost welfare. Thus, the aggregate return to scale is not an exogenous
        technological primitive. Instead, it is an endogenous outcome, affected by frictions and
        market structure and likely varies with time, place, and policy. Furthermore, even mild
        increasing returns at the micro level can catalyze large increasing returns at the macro level.
            In this paper, we consider economies with fixed costs, entry and exit, and monopolistic
        competition between heterogeneous firms. We study how welfare and real GDP change
        in response to an increase in the size of the market, say due to immigration, fertility, or
        globalization. Because of technological economies of scale, increases in market size raise
        individual welfare even when the allocation of resources is held constant as fixed costs are
        spread over a larger population. However, the change in population also triggers reallocations
        of resources, and these reallocations could further increase welfare. It is these endogenous
        changes in the allocation of resources, which we refer to as changes in allocative efficiency,
        that we focus on in this paper.1
            These reallocation effects only matter if the initial equilibrium is inefficient. This is because
        if the initial equilibrium is efficient, changes in consumer welfare locally behave like the
        solution to a planning problem. The logic of the envelope theorem then implies that changes
        in welfare only come from changes in technical efficiency and not from reallocation. In
        efficient equilibria, the marginal benefit of any input is equated across competing uses and so
        reallocations of resources have no first-order effect on welfare.
            Some classic models of increasing returns that emphasize the importance of reallocations,
        such as Melitz (2003), actually have efficient equilibria. The efficiency of the equilibrium is a
        consequence of assuming Constant-Elasticity-of-Substitution (CES) demand systems. In such
        models, reallocations may take place, but to a first-order, these reallocations are irrelevant for
        welfare.2 In such settings, comparative statics depend only on the technological aspects of
        the problem, that is, the aspects of the problem that are relevant to a social planner.
    1
       We define changes in allocative efficiency in response to a shock as the changes in welfare or real GDP that can
be attributed to the equilibrium reallocation of resources caused by the shock. See footnote 18 for more details and
see Baqaee and Farhi (2019) for a formal discussion.
     2
       A similar remark applies to Hopenhayn (1992), who assumes perfect competition and decreasing returns at the
margin at the producer level. This model also has efficient equilibria and, as a result, equilibrium reallocations are
irrelevant for welfare to a first-order.



                                                          1
          However, this simple elegance comes at the expense of realism. CES demand imposes
       constant and uniform markups with complete pass-through of marginal costs into prices.
       The data, on the other hand, features substantial heterogeneity in both markups and pass-
       throughs. Therefore, matching the empirical heterogeneity of markups and pass-throughs
       requires deviating from the CES benchmark. This in turn necessitates confronting ineffi-
       ciencies and changes in allocative efficiency due to reallocations. In the empirically relevant
       cases, an increase in market size intensifies competition amongst firms. This triggers real-
       locations along several margins, and because the economy is inefficient to begin with, these
       reallocations impact welfare.
          We propose a new approach for decomposing and interpreting comparative statics in
       this type of model. We characterize changes in technical and allocative efficiency separately.
       The "Darwinian" forces in the model are those which intensify competition and reallocate
       resources across firms as the market becomes larger. In the empirically relevant case, as the
       market gets larger, these forces are (1) a reduction in the price index due to new entry, (2) an
       increase in the minimum level of productivity a firm must have to survive, and (3) a reduction
       in firms' desired markups. We decompose changes in allocative efficiency into the different
       reallocations driven by adjustments along these three different margins of firm behavior. We
       quantify this decomposition by non-parametrically estimating the model using firm-level
       data for Belgium.
          In our empirical calibration, we find that changes in allocative efficiency are more impor-
       tant than changes in technical efficiency in determining aggregate increasing returns to scale.
       They account for between 70% and 90% of the overall effect. Furthermore, we show the typical
       mechanisms for reallocation emphasized in the previous literature, such as the toughening of
       selection and reductions in markups (2 and 3 above), are not the key drivers of the improve-
       ments in allocative efficiency. On the contrary, our estimates indicate that these particular
       mechanisms are harmful. Instead, we identify a different composition effect resulting from (1)
       that reallocates from low-markup firms to high-markup ones and unambiguously improves
       welfare. This channel turns out to be the main source of welfare gains.3
          To understand these reallocation effects, in our analysis we consider margins of adjustment
       one-by-one. In a first step, we let firms adjust their entry behavior, but hold exit behavior and
       markups constant. In the second step, we allow firms to adjust their entry and exit behavior,
       but not their markups. In the third and final step, we allow firms to also adjust their markups,
       which coincides with the full equilibrium outcome. Below, we describe the intuition of this
       step-by-step analysis and the novel composition effect that drives the welfare gains.
   3
      This reallocation from low- to high-markups firms improves efficiency because high-markup firms are inef-
ficiently too small relative to low-markup firms. Baqaee and Farhi (2019) show that this type of reallocation can
explain a significant fraction of aggregate TFP growth in the US over the last two decades. This paper raises the
possibility that increases in scale, perhaps driven by globalization, could be responsible for these reallocations.




                                                        2
                       Log Price
                                      A'                  A




                                                                         B       B'




                                                                     Log Quantity per capita


Figure 1: The residual demand curve in log-log space. An increase in market size shifts the
demand curve to the right and down (moving from solid to dashed line), holding fixed markups
and the selection cut-off. To see the reallocation effect, compare how quantities change for firms
A and B at different points on the demand curve. The inelastic firm expands relative to the elastic
firm.


     Intuition for Composition Effect. Consider the residual per-capita demand curve for a
     product
                                                 p     y
                                                   =  ( ),
                                                 P     Y
     where p and y are the price and quantity per capita of some product variety, P is an aggregate
     price index, Y is an aggregate per-capita utility index, and  is a decreasing function. To
     illustrate this demand curve, in Figure 1, we assume that larger firms face more inelastic
     demand curves and hence charge higher markups than smaller firms. This assumption,
     which is empirically justified, implies that the demand curve is log-concave (concave in
     log-log space).
        Holding fixed the allocation of resources across firm types, an increase in market size
     increases welfare since an increase in population results in more varieties, and more varieties
     increase welfare. This is the improvement in technical efficiency. When the equilibrium is
     efficient, this effect coincides with the average micro technological return to scale, and is all we
     need to consider. However, in an inefficient equilibrium, there are also changes in efficiency
     due to reallocations.
        Consider first the equilibrium response allowing only for adjustment in entry behavior
     but holding exit behavior and markups constant. In Figure 1, an increase in population shifts
     the demand curve down, because the aggregate price index P falls, and to the right, because
     the utility index Y rises. This means that demand per capita falls by more for the relatively
     elastic firms (A to A ) as compared to the inelastic ones (B to B ). In fact, the demand for



                                                      3
        the highly inelastic firms can even increase if the rightward shift is large enough (this is the
        case illustrated in the figure). So, resources are reallocated away from the elastic firms with
        low markups towards the inelastic firms with high markups. Because the low-markup firms
        were too large and the high-markup ones were too small to begin with, these reallocations
        unambiguously increase welfare.4 The positive changes in allocative efficiency associated
        with this composition effect turn out to be the largest positive force in the model when we
        take it to the data.
           This effect relies critically on the fact that the firm size distribution is non-degenerate and
        that the residual demand curve is not iso-elastic. The effect would disappear if the firm-size
        distribution were degenerate (homogeneous firms), or if the demand curve were linear in
        log-log space (CES demand system). In the former case, all firms are at the same point on the
        demand curve and in the latter case, shifting demand does not differentially affect different
        firms. Either way, there would be no reallocation from shifts in the demand curve.
           Of course, in equilibrium, exit behavior and markups adjust as well, leading to further
        changes in allocative efficiency. Similar to Asplund and Nocke (2006) and Melitz and Otta-
        viano (2008), we find that with log-concave demand curves, increases in population drive up
        the marginal/cut-off productivity level, reduce the probability of survival, and drive down
        markups. However, unlike the effect outlined in Figure 1, the toughening of selection and the
        reduction in markups have theoretically ambiguous effects on welfare. Empirically, we find
        they actually tend to reduce allocative efficiency.
           Our theoretical results do not depend on parametric assumptions. This is useful since
        there is no consensus on a parametric functional form for representing preferences, and our
        approach ensures that parametric restrictions are not inadvertently shutting down important
        channels. We use cross-sectional firm-level information from Belgium on pass-throughs
        (from Amiti et al., 2019) to non-parametrically identify the demand system, and given these
        estimates, we quantify how welfare changes in response to shocks. Importantly, the Kimball
        structure allows us to estimate our model from information on pass-throughs and does not
        require estimates of firm-level markups (which are harder to estimate). Non-parametric
        identification allows us the freedom to match the data in terms of both pass-throughs and sales
        shares, whereas typical parametric specifications of preferences, for instance CES, quadratic,
        or Klenow and Willis (2016) have counterfactual properties.5
           Finally, by separately characterizing the behavior of welfare and real GDP, we also clarify
    4
      The fact that this composition effect improves welfare does not rely on log-concavity of the demand curve in
Figure 1. For example, if the demand curve were log-convex, so that smaller firms had lower elasticities and higher
markups, they would be too small to begin with, and they would be the ones to grow in response to entry.
    5
      With monopolistic competiton, CES preferences imply that the pass-through of marginal cost into prices must
be constant and equal to one. Klenow and Willis (2016) preferences imply that pass-throughs go to zero too quickly
(markups increase too rapidly) for very productive firms, so that without demand shifters, it becomes impossible
to match the fat right-tail of the firm size distribution (see page 45 of Amiti et al., 2019). Quadratic preferences used
by Melitz and Ottaviano (2008) force pass-throughs to start at 0.5 and decline to zero.


                                                           4
some potentially confusing issues. It is well-known that when the set of goods can change
due to entry and exit, real GDP and welfare may not be the same. However, we show that
changes in real GDP are entirely driven by reductions in markups, and do not depend at all
on the reallocation effects that are so crucial for welfare. Therefore, intuitions that apply to
real GDP cannot naively be used to understand the behavior of welfare and vice versa.
   Relatedly, in the literature, aggregate productivity (TFP) is sometimes conflated with
the average of firm productivities (for example, Melitz and Ottaviano, 2008). However,
the growth in this average is not aggregate TFP growth as defined by or measured using
national income statistics. We formally show that changes in ad-hoc productivity indices and
changes in aggregate TFP behave in different ways. In particular, increases in ad-hoc average
productivity indices due to a right-shift in the productivity cut-off do not, by themselves, lead
to an increase in aggregate TFP.
   Many of the ideas that we develop regarding the response of the economy to changes in
population apply to changes in other parameters. In the appendix, we provide analytical com-
parative statics for changes in fixed costs of entry, fixed overhead costs, and the productivity
distribution, as well as their decomposition into technical and allocative efficiency.
   Finally, in addition to our comparative static results, in the appendix, we analytically
characterize (to a second-order) the distance of the economy from the efficient frontier as well
as the optimal combination of industrial and competition policy that restores efficiency. We
also compute the distance to the frontier in our empirical application. The welfare losses
from misallocation are between 2.5% and 6.3% in Belgium in our simple model. Therefore,
reallocation effects can be substantial even when the economy is not too far from the efficient
frontier.

Related Literature. This paper builds on the vast literature on entry and monopolistic
competition using a representative consumer with a taste for variety following Spence (1976)
and Dixit and Stiglitz (1977).
   Initially, the theoretical analysis of monopolistic competition was undertaken under the
assumption that firms are homogeneous, for example Krugman (1979), Mankiw and Whin-
ston (1986), Vives (1999), or Venables (1985). The heterogeneous-firm case has been studied
by Melitz (2003) when efficient, and by Asplund and Nocke (2006), Melitz and Ottaviano
(2008), Zhelobodko et al. (2012), Dhingra and Morrow (2019), Mr´
                                                               azov´
                                                                   a and Neary (2017),
and Mr´
      azov´
          a and Neary (2019) when inefficient. For efficient models, like Melitz (2003), the
envelope theorem implies that reallocations have no direct effect on welfare to a first-order.
Like us, Dhingra and Morrow (2019) also study inefficient models, but their focus is primar-
ily on comparing the decentralized equilibrium to the first-best, and providing qualitative
conditions under which the effect of market expansion can be signed.
   Relative to these papers, our paper makes several contributions. First, we provide analyti-



                                               5
       cal comparative statics for models with Kimball demand in the second best.6 Our comparative
       statics are stated in terms of sufficient statistics that are measurable in the initial equilibrium.
       Therefore, as long as an equilibrium exists and varies smoothly in response to changes in
       market size, our formulas describe its movement. Second, we decompose the overall effect
       into technical and allocative efficiency, and further decompose changes in allocative efficiency
       into adjustments along different margins of adjustment. This helps highlight a new mecha-
       nism, distinct from movements in the minimum productivity cut-off or changes in markups
       through which market size affects efficiency. Third, we provide an empirical strategy for
       backing out demand curves from data, allowing us to quantify our comparative statics and
       decompositions. This procedure allows us to perform local and global comparative statics.
       Fourth, we analyze real GDP as well as welfare, clarifying the similarities and differences
       between the object we typically measure (real GDP) and the one we care about (welfare).
          The focus of this paper is comparative statics in the second-best, and we do not, in the
       body of the paper, analyze the economy's distance to the frontier. Quantifying an economy's
       distance from the efficient frontier is the subject of a vast literature (e.g. Restuccia and
       Rogerson, 2008, Hsieh and Klenow, 2009, and Baqaee and Farhi, 2019). In particular, some
       recent papers have focused on the social cost of markups in models with entry (e.g. Edmond
       et al., 2018, Bilbiie et al., 2019, or Behrens et al., 2018). It should be noted that these papers
       study a very different question compared to this paper. However, in Appendix E, we also
       characterize the decentralized economy's distance from the efficient frontier, thereby linking
       our results to these aforementioned papers.
          The reallocation of resources towards firms with high markups, which drives most of the
       increasing returns to aggregate scale in the present paper relates to our previous work in
       Baqaee and Farhi (2019). There, we showed that the well-documented increase in average
       markups in the U.S. since 1980 is in large part driven by a composition effect whereby firms
       with high markups are getting larger. We also showed that these reallocations generated
       improvements in allocative efficiency which explained close to 50% of aggregate TFP growth
       over the past twenty years. An interesting possibility, suggested by this paper, is that these
       reallocations are in part caused by an increase in scale, perhaps due to globalization.
          Finally, although our model is static, it is related to models of endogenous growth in which
       increasing returns to scale can lead to sustained growth (e.g. Romer, 1986, Romer, 1990,
       Grossman and Helpman, 1991, Aghion and Howitt, 1992, Jones, 1995), and to the analysis of
       Perla et al. (2020) who find large gains from trade from increased technology adoption in a
       growth model with inefficiencies stemming from a technology-adoption externality.

       Structure of the paper. The structure of the rest of the paper is as follows. Section 2
       sets up the model and defines the equilibrium. Section 3 describes the solution strategy
   6
      We do not provide conditions under which equilibria exist or are unique. Instead, we characterize comparative
statics of locally isolated equilibria.


                                                        6
      and discusses efficiency. Section 4 analyzes the case where firms are homogeneous. Section 5
      considers the case with heterogeneous firms. Section 6 backs out demand curves from the data
      and quantifies our results. Section 7 summarizes two extensions developed in the appendix:
      (1) comparative static results for changes in fixed costs or productivities, and (2) an analytical
      characterization of optimal policy and a second-order approximation and quantification of
      the distance to the efficient frontier. Section 8 concludes. The appendix contains all the proofs.



      2     Model
      In this section, we specify the model and describe the equilibrium.


      2.1     Set Up
      Households. There is a population of L identical consumers. Each consumer supplies one
      unit of labor and consumes different varieties of final goods indexed by   R+ . Consumers
      have homothetic Kimball (1995) preferences, with per-capita utility Y defined implicitly in
      units of consumption by
                                                      
                                                             y
                                                         (     )d = 1,                                      (1)
                                                  0          Y
      where y is the per-capita consumption of variety  and  is an increasing and concave
      function in units of utils with (0) = 0.7 CES preferences are a special case of equation (1)
      when  is a power function.
          Consumers maximize their utility Y subject to the following budget constraint
                                                       
                                                          p y d = 1,                                        (2)
                                                   0

      where p is the price of variety . Normalize the nominal wage to one so that the income
      of each consumer is equal to one. This expression for the budget anticipates the fact that in
      equilibrium, there are no profits because of free entry.
          The per-capita inverse-demand curve for an individual variety  is

                                                      p     y
                                                        =  ( ),                                             (3)
                                                      P     Y
    7
      Kimball preferences are a natural benchmark. They are flexible enough to generate residual demand curves
of any shape. They are also homothetic with linear Engel curves for varieties of different sizes within a sector. We
view this property as desirable given the absence of precise empirical guidance on possible deviations from it. An
implication of homotheticity is that scale effects do not appear in the absence of fixed costs and entry. We have also
derived similar versions of our results (available upon request) using non-homothetic separable preferences which
do generate scale effects in the absence of fixed cost and entry (as in Krugman, 1979 or Dhingra and Morrow, 2019).




                                                             7
        where the price aggregator P is defined as

                                                                ¯
                                                                
                                                         P=                                                 (4)
                                                                Y

        and the demand index ¯ is defined as
                                                         
                                              1                 y y
                                                =           (    ) d.
                                              ¯
                                                     0          Y Y

             Equation (3) demonstrates the appeal of Kimball preferences -- by choosing , demand
        curves of any desired (downward-sloping) shape can be generated. Equation (3) can be
        thought of as a relative demand curve for y / Y as a function of the relative price p /P.
        Therefore, each variety competes with the price aggregator P, which acts like an aggregate
        price index for substitution.
             However, this price index P does not coincide with the ideal price index PY for the rep-
        resentative consumer: deflating income by P does not yield welfare.8 In fact, d log P =
        d log ¯ + d log PY . Since in general, ¯ is not a constant, d log P d log PY . It is only in the CES
        case, when (x) = x(-1)/() , that these two price indices coincide since then ¯ = /( - 1) is
        constant.9 Going forward, we refer to P as "the" price index without further qualification,
        despite the fact that it is not the ideal price index.
             This inverse demand curve can be inverted into a per-capita demand curve for an indi-
        vidual variety. We denote the price elasticity of this demand curve for an individual variety
        by
                                                                    y
                                                 y    ( )
                                                ( ) = y Y y .                                               (5)
                                                 Y   -Y (Y)
             Monopolistic competition models with Kimball demand are parsimonious in the sense that
        competition across varieties is mediated by the price index; every variety competes with the
        price index. The flexibility of the demand system comes from the fact that it allows different
        varieties to face different "intensities" of competition, as captured by the different elasticities
        of the demand curve at different points.

        Firms. Each variety is supplied by a single firm seeking to maximize profits under monop-
        olistic competition. Firms can enter to supply new varieties by incurring a fixed entry cost
        of fe units of labor. Upon entry, firms draw a type   R+ from a distribution with density
        g() and cumulative distribution function G(). Each firm's productivity A is an increasing
        function of its type . Having drawn its type, the firm then decides whether to produce or
    8
      Let e(p , Y) be the expenditure function of a household as a function of the price of all varieties p and
welfare Y, where the price of unavailable varieties is set to infinity. Since preferences are homothetic, we can write
e( p , Y) = PY ( p )Y, where PY ( p ) is the ideal price index.
    9
      Changes in the price index d log P also do not correspond to the way the deflators, such as the GDP deflator
  
 0
    p y d log p d, are measured in the data.



                                                            8
      to exit. Production requires paying an overhead cost of fo units of labor, with a constant
      marginal cost of 1/A units of labor per unit of the good sold. Finally, the firm decides what
      price to set, taking as given their residual demand curve.
          The profit-maximizing price p of a producing firm of type  is a markup µ over its
      marginal cost 1/A . Its per-capita quantity y is the demand at that price. We assume that
      marginal revenue curves are strictly decreasing so that profit maximization always has a
      unique solution.10 The price, markup, and per-capita quantity are determined implicitly by

                                        µ                                     y
                                  p =     ,    y = y(p ),     and    µ = µ(     ),                        (6)
                                        A                                     Y

      where the markup function is given by the usual Lerner formula

                                                  y       1
                                                µ( ) =           .                                        (7)
                                                  Y    1 - (1y )
                                                                Y


      A firm of type  chooses to produce if, and only if,

                                                             1
                                              Lp y 1 -          fo .                                      (8)
                                                             µ

      Since profits are increasing in productivity levels, there is an endogenous cut-off  such that
      firms of type    decide to produce, and firms of type  <  exit. The zero-profit condition,
      associated with entry, is

                                        
                                   1                   1
                                           Lp y 1 -      - fo w g()d  fe .                                (9)
                                                       µ

      The parameter  is introduced to allow the equations to represent a repeated version of the
      static model with an infinite number of periods 0, 1, · · · , , where each producing firm has
      an exogenous probability  of being forced to exit in every period t = 0, 1, · · · , . Under this
      interpretation, we assume there is no discounting so that the expected net present value of
      profits is then given by the left-hand side of the entry equation.

      Equilibrium. In equilibrium consumers maximize utility taking prices as given; firms
      maximize profits taking prices other than their own and consumer welfare as given; and
      markets clear.
10
     In terms of primitives, this requires that the Kimball aggregator satisfy always satisfy [ (x)x + 2 (x)] < 0.




                                                         9
      2.2     Summary of the Equilibrium Conditions
      Since data is usually recorded in terms of sales rather than physical quantities, we restate the
      model's conditions in terms of sales. Define the sales share density

                                               = (1 - G( ))Mp y ,                                         (10)

      where M is the mass of entrants and  is the selection cut-off so that (1 - G( ))M is the mass of
      surviving firms.11 The sales share density is such that the aggregate sales share (as a fraction
      of income) of firms with type in (,  + d) is  g()/(1 - G( ))d. Quantities per capita y
      and prices p can all be recovered from the sales share density  and markups µ :

                                                 A                          µ
                                     y =                       and    p =     .                           (11)
                                           µ (1 - G( ))M                    A

      Below we rewrite all the equilibrium conditions in terms of the endogenous variables M, Y,
       , µ , and exogenous parameters L, f , fe , and A .
          Using the expectation conditional on survival with measure [ g()/(1 - G( ))]1{ } d,
      consumer welfare per capita is given implicitly by

                                                                   A
                                   1 = (1 - G( ))ME (                      ) ,                            (12)
                                                            µ (1 - G( ))MY

      restating the definition in equation (1). Similarly, the free entry condition is

                                   M fe           1   (1 - G( ))M fo
                                         = E  1 -   -                ,                                    (13)
                                    L             µ          L

      restating that entry costs exactly offset the aggregate variable profit share net of the overhead
      costs. The cut-off productivity value  is the minimum  that satisfies

                                                    1  (1 - G( ))M fo
                                          1 -                         ,                                   (14)
                                                   µ          L

      restating that the overhead costs must cover the variable profit share. The individual markup
      equations is
                                                            A
                                            µ = µ(                  ).                                    (15)
                                                     µ (1 - G( ))MY
      restating the Lerner condition. Individual demand is

                                           µ              A
                                             = P (                ).                                      (16)
                                           A       µ (1 - G( ))MY
11
     We refer to  as a density since it integrates to one (due to our choice of numeraire) and is always non-negative.



                                                         10
Finally, the price and demand index equations are

                                                     ¯
                                                     
                                              P=                                               (17)
                                                     Y

and
                 1                       A                A
                   = (1 - G( ))ME                (                ) .                          (18)
                 ¯
                                           
                                  µ (1 - G( ))MY   µ (1 - G( ))MY
    To streamline the exposition, we have made use of the following convention. For two
variable x > 0 and z , define
                                                       g()
                                                x z
                                                 1-G( )
                                                            d
                                  Ex [z ] =           g()
                                                              .                                (19)
                                                 x  1-G( ) d 

We write E to denote Ex when x = 1 for all . The operator Ex operates a change of measure
by putting more weight on types  with higher values of x . In the rest of the paper, we will
often encounter E, E , and E(1-1/µ) , which respectively correspond to integrals with respect
to the physical density, the sales share density, and the profit share density.



3     Central Concepts and Solution Strategy
In this section, we introduce some central concepts and describe the solution strategy.


3.1    Markups, Pass-Throughs, and Infra-Marginal Surplus
In order to characterize changes in consumer welfare and in real GDP, we will need the
following definitions for markups, pass-throughs, and infra-marginal surplus ratios.

Markups, pass-throughs, and Marshall's second laws of demand.                     It is important to
define a number of notions related to markups and their behavior. We have already defined the
markup function µ( y/ Y) and described its relation to the elasticity of the individual demand
function
                                          y       1
                                        µ( ) =           .                                     (20)
                                          Y    1 - (1y )
                                                         Y

Define the individual pass-through of a variety as the elasticity of its price to its productivity
 = -d log p/d log A = 1 - d log µ/d log A. This elasticity is necessarily positive, and can be
                                                                    y              y
computed by differentiating the individual demand equation µ( Y )/A = P ( Y ) with respect




                                                11
        to A, holding Y and P constant (since each firm is infinitesimal):

                                               y                  1
                                              ( ) =         y      y           .                          (21)
                                               Y            Yµ   (Y)     y
                                                       1+        y
                                                              µ( Y )
                                                                       ( Y )

        The markup and pass-through of a variety of type  are denoted by µ = µ( y / Y) and
         = ( y / Y).
           A natural assumption is that markups are increasing with productivity. This condition is
        equivalent to the requirement that the individual demand curves be log-concave in log price
        (see Melitz, 2018). We call this the weak version of Marshall's second law of demand. Given that
        productivity is increasing in the type of a firm, it is also equivalent to the requirement that µ
        be increasing in , or equivalently,
                                                        y
                                                     µ ( )  0.                                            (22)
                                                        Y
        As discussed by Melitz (2018), a stronger version of Marshall's second law of demand is
        the requirement that pass-throughs be less than one and decreasing with productivity. The
        strong law implies the weak law, and is equivalent to the requirement that individual marginal
        revenue curve be log-concave. Given that productivity is increasing in the type of a firm, it is
        also equivalent the requirement that   1 be decreasing in , or equivalently

                                            y                 y
                                           ( )  1       and  ( )  0.                                      (23)
                                            Y                 Y

           Both the weak and strong version have empirical support (see Figure 4a in Section 6),
        however, our propositions do not require them to hold (unless explicitly mentioned). Never-
        theless, we expect these "laws" to hold in most empirically relevant applications.

        Infra-marginal surplus ratio and aligned preferences. We also define the infra-marginal
        surplus ratio of a variety  as the amount of infra-marginal surplus per unit sales. More pre-
        cisely,  is the ratio of the consumption equivalent utility ¯( y/ Y) from a marginal variety to
        its sales share py = ¯ ( y/ Y) y/ Y. It is given by the infra-marginal surplus ratio function

                                                              y
                                                y     ( )
                                               ( ) = y Y y  1.                                            (24)
                                                Y
                                                     Y (Y)


        Figure 2 gives a visual intuition for  as the ratio of consumer surplus A + B to revenues A.12
           We denote the equilibrium infra-marginal surplus ratio of a variety of type  by  =
        ( y / Y). There is an important relationship between the demand index     ¯ and the infra-
   12
    When goods enter and exit at a choke price we naturally have B = 0 for these firms. In these cases, the entry-exit
margin can be said to be "neoclassical" in the sense that revenues reflect consumer surplus. As can be seen from
equation (29), in such models, the equivalence between real GDP and welfare is restored.




                                                         12
                              Price
                                      B
                              p

                                      A


                                               y                        Quantity

Figure 2: Graphical illustration of  as the area under the residual demand curve divided by
revenues. That is  = (A + B)/A  1.


       marginal surplus ratios  : the former is the sales-weighted average of the latter13

                                                           ¯
                                                   E [ ] = .                                         (25)

          We say that (social and private) preferences are aligned if the infra-marginal consumer
       surplus ratio varies with productivity in the same direction as markups, or in other words
       if  ( y/ Y) and µ ( y/ Y) have the same sign.14 For example, if Marshall's weak second law of
       demand holds, so that µ ( y/ Y)  0, preferences are aligned if, and only if,  also increases with
       productivity. It is easy to see that a necessary and sufficient condition in terms of demand
       primitives is
                                                     y            y
                                       y   1 - [( Y ) - 1][( Y ) - 1]
                                      ( )=           y   y             0.                            (26)
                                       Y               ( )
                                                         Y    Y

       Whereas Marshall's second law of demand has empirical support, whether or not preferences
       are aligned has not been empirically documented one way or another. In fact, when we
       calibrate our model to match pass-throughs, we find that preferences are not aligned. Nev-
       ertheless, the notion of aligned preferences is useful theoretically as a sufficient condition for
       signing some comparative statics.


       3.2    Consumer Welfare and Real GDP Per Capita
       We are interested in changes in consumer welfare and real GDP per capita in response to
       changes in the exogenous parameters (note that consumer welfare is defined per capita). The
  13
     This follows from the definitions  = 1/E[(1 - G( ))M ( y / Y) y / Y] and 1 = (1 - G( ))ME(( y / Y)).
  14
     This terminology, due to Dhingra and Morrow (2019), captures the idea that when preferences are "aligned,"
then private gains from entry (which are increasing in markups) are aligned with social preferences (which are
increasing in the infra-marginal consumer surplus).




                                                         13
        change in consumer welfare, measured using the equivalent or compensating variation, is

                                                        d log Y.                                             (27)

           Changes in real GDP per capita are defined following the procedures used by statistical
        agencies. That is, using Divisia indices for continuing varieties present before and after the
        change.15 Hence, the change in real GDP per capita is defined to be nominal income deflated
        by the GDP deflator. In other words,

                                               d log Q = -E [d log p ].                                      (28)

        Since the supply of the primary factor (labor) is exogenous in our model, changes in real GDP
        per capita d log Q are equal to changes in aggregate TFP. An important theme of this paper
        is that changes in welfare and changes in aggregate TFP are different objects with different
        determinants.
           If the model did not allow for the creation and destruction of varieties, then changes in
        consumer welfare d log Y, and changes in real GDP per capita/aggregate TFP d log Q would
        coincide.16 Because the model does allow for entry and exit, changes in consumer welfare
        and real GDP/aggregate TFP do not coincide.17
           More concretely, changes in welfare are given by

                                                                       g( )               A
             d log Y = E [ ] - 1 d log M + E [ ] -                          
                                                                              d + E d log( ) ,               (29)
                                                                     1 - G( )             µ

        whereas changes in real GDP are given by

                                                                    A
                                              d log Q = E d log(      ) .                                    (30)
                                                                    µ
   15
       In principle, changes in real GDP can either be defined using a quantity index or a price index. In the body of
the paper, we use the price index definition. We include a discussion of the quantity index in Appendix H.
    16
       This is also true in models of entry devoid of non-convexities featuring no fixed costs and demand curves with
choke prices, where prices and quantities at the variety level change smoothly. If new goods enter smoothly from
the choke price, then  = 1 for all entrants, and real GDP and aggregate TFP in equation (30) coincide with welfare
in equation (1). This applies, for example, to Arkolakis et al. (2018). They consider an open economy with an export
margin where export quantities vary smoothly from zero (at the choke price) because there are no fixed costs in
exporting. They analyze the effect of changes in iceberg trade costs (somewhat analogous to productivity shocks) as
opposed to scale shocks. In their model, entry is not affected by iceberg costs and so plays no role in their analysis.
For these reasons, our results are not comparable to theirs.
    17
       A related point is that aggregate TFP is not equal to an average of productivity levels across firms. For example,
the sales weighted average productivity level E [A ] is not a sensible measure of aggregate TFP. Such an average is
ill-defined because it is unit-dependent, and does not measure economic efficiency. To see the latter point, note that
even in an efficient model, where welfare and real GDP are maximized, E [A ] is not being maximized and can be
driven to be arbitrarily high by changing units or by introducing distorting taxes that reduce welfare and real GDP
but nonetheless increase E [A ]. See Baqaee and Farhi (2019) for more details.



                                                           14
        Intuitively, consumer welfare changes d log Y incorporate the infra-marginal consumer sur-
        plus brought about by the entry of new varieties d log M, or destroyed by the exit of varieties
        d via the first two terms on the right-hand side of the expression. In contrast, changes in
        real GDP per capita/aggregate TFP d log Q do not, and instead only take into account changes
        in the intensive margin of prices d log p = d log(µ /A ).


        3.3     Changes in Technical and Allocative Efficiency
        To understand changes in consumer welfare and real GDP in response to changes in exogenous
        parameters, it will be useful to decompose them into changes in technical and allocative
        efficiency. Changes in technical efficiency capture the direct impact of the shock, holding the
        allocation of resources constant. Changes in allocative efficiency capture the indirect impact
        of the equilibrium reallocation of resources triggered by the shock. Because the economy is
        inefficient to begin with, these reallocations typically have nonzero first-order effects.
             To make this precise, following Baqaee and Farhi (2019), we define the allocation vector
        X = (le , lo , {l }). It describes the fractions of labor allocated to the following activities: entry,
        overhead, and variable production of varieties of type . Together with the technology vector
        A = (L, fe , fo , {A }), the allocation vector X entirely describes any feasible allocation. Let
        Y(A, X) be the associated level of consumer welfare.
             We will decompose changes in welfare into changes in technical and allocative efficiency
        as
                                                  log Y                     log Y
                                     d log Y =          d log A +                 dX ,                         (31)
                                                  log A                      X

                                                 technical efficiency   allocative efficiency

        and characterize each in terms of sufficient statistics in the initial equilibrium. Intuitively,
        changes in technical efficiency are the changes in welfare that are directly due to changes
        in technology d log A, holding the allocation of resources X constant. Changes in allocative
        efficiency are the changes in welfare that are due to the equilibrium reallocation of resources
        dX = (dX/d log A)d log A triggered by the shocks, holding technology A constant.18 These
        latter effects are the Darwinian reallocations, which take resources away from some firms and
        move them to others, as the market becomes larger.
             In efficient economies, the envelope theorem implies there are only changes in technical
   18
      There are different notions of changes in allocative efficiency. Each is obtained by comparing changes in welfare
in equilibrium against changes in welfare under a different benchmark allocation rule. Our notion captures changes
in allocative efficiency due to reallocation: the benchmark allocation rule keeps the allocation of resources constant.
A different notion is the change in the distance to the efficient frontier: the benchmark allocation rule is the first-best
allocation. The first notion identifies changes in allocative efficiency as changes in welfare due reallocation, holding
technology constant. Since technology is held constant, welfare can only increase if the efficiency of the allocation
improves. The second notion identifies changes in allocative efficiency as changes in the distance to the efficient
frontier due to technology and reallocation. Both notions are used in the literature but they are different. See Baqaee
and Farhi (2019) for a discussion.


                                                               15
efficiency and no changes in allocative efficiency. In inefficient economies, there are both
changes in technical efficiency and changes in allocative efficiency.


3.4    Outline of the Rest of the Paper
In the following sections, we provide analytical characterizations of first-order comparative
statics of the model with respect to changes in parameters. In the main text of the paper,
we focus exclusively on shocks to population. We treat shocks to other parameters, like
productivity or fixed costs, in Appendix F.
    To hone intuition, we begin by studying the homogeneous firm special case, before consid-
ering the model with heterogeneity. In each case, we derive expressions for changes in welfare
and real GDP, and break down the effect into changes in technical and allocative efficiency. As
mentioned earlier, we derive comparative statics in terms of measurable sufficient statistics
that can be taken to data, presupposing that an equilibrium exists and is locally isolated.

Non-parametric sufficient statistics.         We avoid putting any additional parametric struc-
ture on the model (the Kimball aggregator or the productivity distribution). Instead, we
express comparative statics in terms of ex-ante measurable non-parametric sufficient statis-
tics introduced in Section 3.1: sales shares  , markups µ , pass-throughs  , and relative
infra-marginal consumer surplus ratios  . In Section 6, we show that µ ,  , and  are
related to each other so that if we can measure one, then we can recover the rest by solving
some differential equations (up to boundary conditions). To calibrate the model, we will also
need the hazard rate  = ga (log A )/[1 - Ga (log A )] of the log-productivity distribution at
the selection cut-off, where ga (log A ) = g()/( log A /). The results make contact with the
data through these sufficient statistics.



4     Homogeneous Firms
To build intuition, we start by analyzing the case where firms are homogeneous. This case
is obtained by assuming that all types have the same productivity A = A. We denote the
common markup, pass-through, and individual demand elasticity by µ, , and .
    We proceed as follows. We start by discussing the sources of inefficiency. We then study
shocks to population. We end by analyzing the special case of CES preferences.
    To aid with the intuition, we state our results using both markups µ and elasticities , but
recall that the two are connected via µ = 1/(1 - 1/) or equivalently  = 1/(1 - 1/µ).




                                                16
        4.1    Sources of Inefficiency
        Since reallocation effects are the key object of interest, understanding their effect requires
        understanding the sources of inefficiency in the initial equilibrium. With homogeneous firms,
        the only margin that can be distorted is the allocation of labor to entry (and overhead) vs.
        variable production. As a result, social efficiency boils down to entry efficiency. This will no
        longer be true with heterogeneous firms, where distortions will arise on several other margins.
           The allocation matrix provides an intuitive way to think about entry efficiency. Starting at
        the initial equilibrium, change the allocation of resources by increasing the fraction of labor
        allocated to entry and overhead and decreasing the fraction of labor allocated to variable
        production. Compute the resulting change in consumer welfare. We say that there is (locally)
        too much entry if the change in consumer welfare is negative and that there is too little entry
        if it is positive.19 There is locally too much (too little) entry if, and only if, the following
        condition is verified (violated)


                                                        < µ.                                              (32)

        Rearranging (26) shows this condition is automatically verified under weak second Marshall
        law of demand and aligned preferences.
           To derive this condition, use the following formula, obtained by differentiation of the
        definition of consumer welfare,

                                           d log Y = d log M + d log y.                                   (33)

        The intuition for this formula is straightforward: new varieties capture a total sales share
        equal to d log M, with an effect d log M on consumer welfare; the per-capita quantity of each
        existing variety changes by d log y, with an effect d log y on consumer welfare.
           Note that the initial allocation of labor allocates a fraction l = 1/µ to variable production
        and le + lo = 1 - 1/µ to entry and overhead. Consider a reduction in the fraction of labor
        allocated to variable production d log l < 0 and a complementary increase in the fraction of
        labor allocated to entry and overhead d log le = d log lo = -[1/(µ - 1)]d log l > 0. The change
        in consumer welfare is d log Y = [1 - ( - 1)/(µ - 1)]d log l, which is negative (too much entry)
        if and only if  < µ.
           Indeed, in this experiment, we have d log y = d log l - d log M < 0, since the amount of
        labor per capita available for each variety is reduced by the reallocation of labor away from
        variable production and by the labor required to produce the new varieties. We also have
        d log M = -1/(µ - 1)d log l > 0, because of the reallocation of labor to entry and overhead. The
   19
     The comparative static underlying this definition is a feasible allocation, but not an equilibrium allocation. It
can only be supported as an equilibrium allocation by introducing a subsidy on entry. The defining question can
then be reformulated as whether this subsidy on entry decreases or increases equilibrium consumer welfare.


                                                         17
result follows.


4.2     Shocks to Population
Increases in population can be interpreted literally as immigration or increased fertility, or in
a more stylized way as the trade integration of more and more countries which are otherwise
operating under autarky. Changes in consumer welfare and real GDP per capita in response
to increases in population can therefore be interpreted as either gains from scale or as gains
from trade.

Proposition 1. Suppose that firms have the same productivity A = A. In response to changes in
population d log L, changes in consumer welfare are given by

                                                                 
                             d log Y = ( - 1)d log L +             d log L,                  (34)
                                                                1-
                                       technical efficiency   allocative efficiency


where
                                             -1 1         
                          = 1- 1-                 = 1- 1-   .                                (35)
                                             µ-1          µ
   This proposition provides the change in welfare in terms of ex-ante sufficient statistics
and decomposes the effect into technical and allocative efficiency following equation (31). We
assume throughout that, in the initial equilibrium,  < 1 guaranteeing that 0 < d log Y < .
   In response to a positive population shock d log L > 0, there are in general both changes
in technical efficiency and changes in allocative efficiency. Changes in technical efficiency are
given by ( - 1)d log L > 0. Recall that the technical efficiency effect holds fixed the fraction
of labor allocated to entry, overhead, and variable production. Because we hold the fraction
of labor allocated to entry (and overhead) constant, the increase in population implies a
proportional increase d log L > 0 in entry. The sales share captured by these new varieties is
also d log L. Therefore the increase in the number of varieties increases consumer welfare by
d log L > 0. On the other hand, the increase in the number of varieties reduces the amount of
labor per capita allocated to the production of each variety, and hence the per-capita quantity
of each variety, by d log L. This implies a reduction -d log L < 0 in consumer welfare. The
overall effect balances out these two offsetting effects.
   There are also changes in allocative efficiency. Intuitively, there are two different scenarios
whereby allocative efficiency improves. In the first scenario, the increase in population causes
markups to fall, which happens when pass-through is incomplete  < 1. If there was too
much entry to begin with µ > , then this reduction in markups improves allocative efficiency
because it discourages entry. The other scenario is where the increase in population raises
markups ( > 1) and there is too little entry to begin with µ < . The second scenario violates


                                                    18
        Marshall's second law of demand and is less empirically relevant.20
           We refer to the fact that markups decrease with market size as the pro-competitive effect of
        scale. In the homogeneous-firm case, these pro-competitive effects are the exclusive source
        of changes in allocative efficiency. That is, if markups did not change, there would not be
        any changes in allocative efficiency. In the next section, we will see that in the presence
        of heterogeneity, there are other drivers of allocative efficiency that are not related to the
        pro-competitive effect. In fact, quantitatively, we will find that these pro-competitive effects
        (reductions in markups) are quantitatively much less significant than the other sources of
        changes in allocative efficiency.
           Proposition 1 allows us to easily determine the sign of changes in allocative efficiency, and
        hence whether changes in allocative efficiency amplify or mitigate the effects of the shocks.

        Corollary 1. Suppose that firms have the same productivity A = A. Increased population increases
        allocative efficiency if and only if  > 0. As long as pass-through is incomplete ( < 1), this is
        equivalent to there being too much entry  < µ. There is always too much entry under weak second
        Marshall law of demand and aligned preferences.

           Now, consider the effects of the population shock on real GDP per capita.

        Proposition 2. Suppose that firms have the same productivity A = A. In response to changes in
        population d log L, changes in real GDP per capita are given by

                                                     1-
                                         d log Q =      (d log Y + d log L),                               (36)
                                                      

        where d log Y is given by Proposition 1.

           An increase in population leads to a reduction in markups under incomplete pass-through,
        and this pro-competitive effect increases increase real GDP per capita d log Q = -d log p.


        4.3    CES Example
        It is interesting to study the CES benchmark, obtained by setting (x) = x(-1)/ , where with
        some abuse of notation,  > 1 is some scalar. In this case, the elasticity of substitution is
        constant and equal to , markups are constant µ = 1/(1 - 1/), pass-throughs are equal to
        one  = 1, and the infra-marginal surplus ratio is constant  = /( - 1). Moreover, entry is
        efficient since  = µ.
   20
     To see the formal perturbation, note that changes in allocative efficiency are [/(1 - )]d log L. The shock reduces
the price index by d log P = -(1/)(d log Y + d log L) < 0 (since  < 1 implies that d log Y > 0). When pass-through is
incomplete  < 1 (e.g. when the weak second Marshall law of demand holds), this triggers a reduction in markups
by d log µ = (1 - )d log P < 0 and reduces the variable profit share and hence entry by [1/(µ - 1)](1 - )d log P < 0.
This in turn changes consumer welfare by [( - 1)/(µ - 1) - 1](1 - )d log P. These changes in consumer welfare are
positive if and only if there is locally too much entry to begin with ( < µ). The result in the proposition is obtained
by replacing d log P for its expression as a function of d log Y and solving for the fixed point.

                                                          19
   Changes in consumer welfare are given by

                           d log Y = ( - 1)d log L +                 0          .             (37)

                                     technical efficiency   allocative efficiency


Unlike in the general case, shocks to population only lead to changes in technical efficiency
and do not lead to any change in allocative efficiency. The reason, which is twofold, is
straightforward: first, there is no change in markups ( = 1) and hence no change in the
fraction of resources allocated to entry; second entry is actually efficient to begin with ( = µ),
so even if resources were reallocated, it would not matter for welfare.
   The response of real GDP per capita is

                                            d log Q = 0,                                      (38)

since markups and productivity shifters do not change.


4.4    Discussion
Increases in market size affect both technical and allocative efficiency. The positive changes in
technical efficiency arise from increasing economies of scale. When the allocation of resources
is kept constant, the total quantity sold by each firm remains constant, the per-capita quantity
declines, and new firms enter. If new varieties create inframarginal surplus  > 1, then welfare
improves.
   There are also changes in allocative efficiency which come into play as the allocation of
resources adjusts to the shock. When the weak second Marshall law of demand holds, existing
firms reduce their markups, the total quantities sold by these firms expands at the expense of
entry. If there was too much entry to begin with, this reallocation of resources is beneficial.
   The beneficial nature of these reallocation effects hinges entirely on second-best principles.
It depends on whether there was too much or too little entry from a social perspective to begin
with, and on whether reallocations decrease or increase entry.
   When the weak second law holds, an increase in population is pro-competitive in the sense
that it always reduces markups and expands the total (not per capita) quantities produced by
existing firms. However, these pro-competitive effects do not necessarily increase consumer
welfare. They do so only if there was too much entry to begin with, because the reduction in
markups has the effect of reducing profit shares, and hence entry. By contrast, the effect on
real GDP per capita is unambiguous: the reduction in markup always increases real GDP per
capita because it is associated with decreases in prices of existing firms.




                                                   20
5     Heterogeneous Firms
In this section, we turn to the case of heterogeneous firms. Once again, to understand the role
of reallocation, we must discuss the sources of inefficiency in the initial equilibrium. We then
study shocks to population. We end by analyzing the special case of CES preferences.


5.1    Sources of Inefficiency
As before, understanding the comparative statics relies on second-best principles. Therefore,
it helps to first consider the different margins of adjustment, and what efficiency looks like
along each margin. With homogeneous firms, the only margin that could be distorted was
the allocation of labor to entry (and overhead) vs. production. With heterogeneous firms,
more margins can be distorted: the allocation of labor to entry (and overhead) vs. variable
production, but also the selection cut-off determining which varieties are allocated labor for
variable production at all, and the allocation of labor for variable production across active
varieties.
    The allocation matrix continues to give us an intuitive way to think about efficiency along
these different margins. The following expression for changes in consumer welfare, derived
from the definition of consumer welfare, will be useful for this purpose

                                                       g( )
                  d log Y = E [ ]d log M -                    d + E [d log y ].                (39)
                                                     1 - G( )

We discuss the three different kinds of inefficiency in the heterogeneous model in turn.

Entry efficiency.       We say that there is too much (too little) entry if consumer welfare
increases (decreases) when labor is reallocated from variable production to entry and over-
head, but keeping the selection cut-off and the relative allocation of labor across non-exiting
varieties constant. There is too much (too little) entry if and only if the following condition is
verified (violated)
                                                    1    -1
                                       E [ ] < E µ-
                                                              ,                                (40)

which is a comparison of the sales-weighted average of the infra-marginal surplus ratios and
the harmonic average of markups. This is an averaged version of the same condition for the
homogeneous firm model.
    The intuition is the following. The initial allocation of labor allocates a fraction l = E[l ] =
E [1/µ ] to variable production and le + lo = 1 - E [1/µ] to entry and overhead. Consider
a reduction in the fraction of labor allocated to variable production d log l = d log l < 0 and
a complementary increase in the fraction of labor allocated to entry and overhead d log le =
d log lo = -[E [1/µ ]/(1 - E [1/µ ])]d log l > 0. The reduction in the per-capita quantity of


                                                21
each variety d log y = d log l - d log M < 0 reduces consumer welfare by E [d log y ] < 0.
We also have an increase in entry d log M = -[E [1/µ ]/(1 - E [1/µ ])]d log l > 0, which
increases consumer welfare by E [ ]d log M > 0. Finally, we have no change in selection
d = 0. Plugging these perturbations into Equation (39), the overall effect on welfare is
d log Y = [1 - (E [ ] - 1)E [1/µ ]/(1 - E [1/µ ])]d log l, which is negative (too much entry)
if and only if 1/E [1/µ ] < E [ ]. In the homogeneous-firm case, this condition collapses to
the simple  < µ.

Selection efficiency. We say that there is too little (too much) selection if consumer welfare
increases (decreases) when the selection cut-off is increased and the labor previously allocated
to variable production and overhead of the newly exiting varieties is reallocated proportion-
ately to entry, overhead, and to variable production. There is too little (too much) selection if
and only if the following condition is verified (violated)

                                          < E [ ].                                             (41)

   The intuition is the following. Suppose that we increase the selection cut-off by d > 0, and
reallocate the labor previously allocated to the variable production and overhead of varieties
with type in [ ,  + d ) proportionately to entry, overhead, and variable production. The
exiting varieties reduce consumer welfare by -  [ g( )/(1 - G( ))]d . The new varieties
d log M =  [ g( )/(1 - G( ))]d increases consumer welfare by E [ ]d log M. There is no
change in the production of existing varieties d log y = 0. Plugging these perturbations into
(39), the overall effect on welfare is (E [ ] -  ) [ g( )/(1 - G( ))]d , which is positive
(too little selection) if and only if  < E [ ].

Relative production efficiency. Finally, we say that the supply of a variety is too large
(too small) compared to another if consumer welfare increases (decreases) when labor is
reallocated from the former to the latter. The supply of variety  is too large (too small)
compared to that of variety  if, and only if, the following condition is verified (violated)

                                           µ < µ .                                             (42)

   The intuition is the following.     Consider a reduction d log l < 0 in the fraction of
labor allocated to the supply of varieties in ( ,  + d ) and a complementary increase
d log l = -( g( )/ g())(l /l )d log l > 0 in the fraction of labor allocated to the supply
of varieties in (,  + d ), which, using the fact that l /l = ( /µ )/( /µ ), can be
rewritten as d log l = -( g( )/ g())( /µ )/( /µ )d log l > 0. This leads to a decrease
d log y = d log l < 0 in the quantity of the former varieties and an increase d log y =
-( g( )/ g())( /µ )/( /µ )d log l > 0 in the quantity of the latter varieties. Plugging
these perturbations into (39), this effect on welfare is g( ) d log y d + g() d log y d =

                                               22
        -(µ /µ - 1) g( )d d log l , which is positive if and only µ > µ .


        5.2     Shocks to Population
        We characterize how welfare responds to changes in market size and decompose the effect
        into different reallocations. Recall that  = ga (log A )/[1 - Ga (log A )] is the hazard rate of
        the log-productivity distribution at the selection cut-off.

        Proposition 3. In response to changes in population d log L, changes in consumer welfare are given
        by
                                                                               
                                                         + µ + 
                        d log Y = E [ ] - 1 d log L +              E [ ] d log L,                       (43)
                                                      1 -  - µ - 

                                     technical efficiency               allocative efficiency

        where

                                                                                       1
                               = E [ ] - 1 E [ ] - E(1-1/µ) [ ] E                               ,
                                                                                       
                                                                - E(1-1/µ) [ ]                  1
                               = E [ ] -                                                   E        ,
                                                                     - 1                        
                                                            E [ ] - 1             1
                              µ = E (1 -  ) 1 -                          E             .
                                                             µ - 1                

             This proposition provides the change in welfare in terms of measurable sufficient statistics
                                                                                                        
        in the initial equilibrium and decomposes the effect. We assume throughout that  + µ +  <
        1, which guarantees that welfare is differentiable 0 < d log Y <  (this is verified in our
        empirical application). We examine this expression term by term and explain its underlying
        intuition.
             The intuition for the changes in technical efficiency is the same as in the case of homoge-
        neous firms covered in Section 4. The only difference is that the infra-marginal surplus ratios
         are heterogeneous and matter through their average E [ ]. We now dissect the allocative
        efficiency term.
                           
             Each of  ,  , and µ relates to adjustments along a specific margin. Starting at the initial
        equilibrium an increase in population d log L > 0 leads each firm to adjust its behavior on
        three margins: entry, exit, and markup. We decompose the general equilibrium response
        by analyzing three successive allocations which allow firms to adjust along more and more
        margins. All three allocations feature the same technical efficiency effect, but different changes
        in allocative efficiency, driven by different changes in the allocation of resources.21 First, we
   21
      This decomposition differs from the one in Dhingra and Morrow (2019), who decompose changes in utils for
given changes in real income, and focus on comparing representative firm models with heterogeneous firm ones.
Our decomposition is of the change in equivalent variation for given changes in population, and our decomposition
is of the different margins of firm behavior.


                                                               23
        consider what would happen if free entry holds but firms cannot not adjust their markups or
        alter their decision to operate upon entry (holding µ and  constant). Second, we consider
        what would happen if free entry holds and firms can adjust their decision to operate but could
        not alter their markups (holding µ constant). Last, we consider what happens if free entry
        holds, and firms can adjust both their exit and markup choices.

        Entry only margin. In the first step, consider the equilibrium where firms can only adjust
        their entry behavior (free entry) but can neither adjust exit behavior nor their markups. The
                                                                                                 
        resulting change in consumer welfare is given by Proposition 3 but with µ =  = 0.
           Changes in allocative efficiency are strictly positive ( > 0) as long as there is non-trivial
        heterogeneity. To see this, note that

                                                                                      1
                                                                             Cov [ , µ 
                                                                                        ]
                                                = E [ ] - E(1-1/µ) [ ] =                1
                                                                                             ,
                                           1                                  E [1 -
                         (E [ ] - 1)E                                                  µ ]


        where Cov [ , 1/µ ] denotes the covariance of price-elasticities  and inverse markups 1/µ
        under the sales share probability measure  g()/[1 - G( )]. Since the price elasticity of
        demand  and the reciprocal of the markup 1/µ covary positively,  is positive as long as
        there is any heterogeneity.
           Intuitively, the increase in population causes the price index to fall. The reduction in the
        price index triggers bigger reductions in per-capita quantities and sales for firms with higher
        elasticities and lower markups than for firms with lower elasticities and higher markups. Since
        the former were too large and the latter too small to begin with, this reallocation improves
        welfare. Basically, because it improves efficiency, this reallocation frees up labor, which ends
        up being used in entry, and this always improves welfare, irrespective of whether there was
        too much or too little entry to begin with. This is the composition effect that is graphically
        illustrated in Figure 1 in the introduction. This effect, which is unambiguously positive, will
        turn out to be the dominant welfare-improving force in the model.
           If the weak second Marshall law of demand holds, then it is the bigger firms that have
        have higher markups, and the beneficial reallocations are away from small firms and towards
        big firms. However, the composition effect is always positive, irrespective of whether the
        weak second Marhsall law of demand holds or not.22
           The detailed intuition for the changes in allocative efficiency captured by  is as follows.
        The shock increases consumer welfare d log Y > 0. It leads to a reduction in the price index
   22
     This composition effect is related to the "Matthew Effect" discussed by Mr´ azov´
                                                                                     a and Neary (2019), who show
that when Marshall's weak second law holds, an increase in scale increases the profits of large firms. The difference
here is that we relate this composition effect to welfare, and that the welfare relevant reallocation is in terms of
employment as opposed to profits. Furthermore, inspection of  shows that this effect is always positive regardless
of whether or not the weak second Marshall law of demand holds. In particular, if the demand curve is log-convex,
even though it still increases welfare, the composition effect becomes an "anti"-Matthew effect.



                                                         24
by d log P = -E [1/ ](d log Y + d log L) < 0. As a result, sales shares change by ( -
E [ ])d log P. This reallocates resources towards varieties with lower elasticities  , which
also have higher markups µ , and increases the aggregate variable profit share and entry
by -(E [ ] - E(1-1/µ) [ ])d log P > 0. This then increases consumer welfare by -(E [ ] -
1)(E [ ] - E(1-1/µ) [ ])d log P > 0. The result in the proposition is obtained by replacing
d log P by its expression as a function of d log Y and solving for the fixed point.

Entry and selection only margins. In the second step, consider the equilibrium where
firms can adjust their entry behavior and also their exit behavior (that is, firms can choose
whether or not to exit after drawing their type), but still cannot adjust their markups. The
resulting changes in consumer welfare are given by Proposition 3 but with µ = 0.
                                                                                      
   There is a new source of changes in allocative efficiency captured by                 0 which
accounts for changes in the selection cut-off, and whether or not there was too much selection
in the initial equilibrium. Intuitively, when the weak second Marshall law of demand holds,
markups are increasing with productivity and so the demand elasticity is higher at the selection
cut-off than above it. Hence, the reduction in the price index disproportionately hurts firms at
the selection cut-off and so the selection cut-off increases d > 0. This increase in the selection
cut-off improves welfare if, and only if, there is too little selection to begin with (E[ ] >  ).
   The formal perturbation can be derived by noting that the sales shares of the exiting
varieties with   [ ,  + d ) is  ( g( )/[1 - G( )])d . This is equal to   d log A ,
where d log A is the change in productivity associated with a change in type from  to  +d .
This reallocates sales from exiting firms to the average surviving firm and changes consumer
welfare by (E[ ] -  ) ( g( )/[1 - G( )])d . These changes in allocative efficiency are
            
positive ( > 0) if there is too little selection to begin with.
   It is important to note that the fact that  increases is not, on its own, evidence of an
improvement in allocative efficiency. In other words, increases in the cut-off  , due to
intensifying competition, are only socially desirable if the marginal firm provides households
with less infra-marginal surplus than the average surviving firm. In fact, in our empirical
Section 6 we find that increases in selection cut-off reduce welfare because preferences are not
aligned.

Entry, exit, and pricing/markup margins. Last, consider the equilibrium where firms
can not only adjust their entry and exit behavior, but also their pricing/markup behavior.
The resulting changes in consumer welfare are the full-blown changes in equilibrium welfare
given by Proposition 3.
   There is a new source of changes in allocative efficiency captured by µ       0. Adjustments
along this margin (markups) are the pro-competitive effects of scale.
   The intuition for the additional changes in allocative efficiency captured by µ is very
similar to that presented in the case of homogeneous firms in Section 4. The only difference is


                                               25
that the terms in µ are appropriately averaged versions of the now heterogeneous underlying
                                                                        
sufficient statistics. In the homogeneous-firm case, the  and  were equal to zero because
there was no heterogeneity, so we only had to contend with the markup margin. In that
case, the reduction in markups increased welfare if, and only if, there was too much entry to
begin with. In the heterogeneous-firm case, these changes in allocative efficiency are positive
(µ > 0) if and only if E(1-) 1 - (E [ ] - 1)/(µ - 1) > 0.
                                                                                              
   When reallocations along all three margins are beneficial, so that   0,   0, and
µ  0, we can unambiguously sign the changes in allocative efficiency.

Corollary 2. Sufficient conditions for positive changes in allocative efficiency in response to increases
in population are: (1) that the strong second Marshall law of demand hold; (2) that the condition
E (1 -  ) 1 - (E [ ] - 1)/(µ - 1) > 0, which can be stronger or weaker than the condition for
excessive entry, hold; and (3) that there be too little selection E [ ] >  , which is automatically
verified if (1) holds and if, in addition, preferences are aligned. More precisely, we always have   0,
                                                                                           
with a strict inequality as long as there is non trivial heterogeneity; (1) and (3) imply  > 0; and (2)
implies that µ > 0.

   Appealing as they may be, these conditions will not always be verified in our empirical
                                                         
application, and in fact, we will sometimes find   0 or µ  0. Nonetheless, we will find
that  > 0 will always be large enough to dominate the other terms, resulting in large positive
changes in allocative efficiency from increases in scale.
   Finally, we can also characterize the change in real GDP per capita as an appropriately-
averaged version of that presented in the case of homogeneous firms in Section 4.

Proposition 4. In response to changes in population d log L, changes in real GDP per capita are

                                                        1
                       d log Q = E (1 -  )         E          d log Y + d log L ,                   (44)
                                                        

where d log Y is given by Proposition 3.


5.3    CES Example
Once again, we consider the CES benchmark, (x) = x(-1)/ , where  > 1 is some scalar. With
heterogeneous firms, this example is a closed-economy version of Melitz (2003). The markups
are constant µ = 1/(1 - 1/), pass-throughs are equal to one  = 1, and the infra-marginal
surplus ratio is constant  = /( - 1). Moreover, entry is efficient since ¯=µ
                                                                           ¯ . Furthermore,
since E ( ) =  , the exit/selection margin is also efficient. Finally, since markups are
constant, there is no adjustment of markups. This means that changes in consumer welfare




                                                   26
are simply given by technical efficiency effects

                            d log Y = ( - 1) d log L +                0              .       (45)

                                      technical efficiency   allocative efficiency


The fact that changes in allocative efficiency are zero is not surprising: the CES model is
efficient, so this result is a consequence of the envelope theorem.
   Next, consider changes in real GDP per capita, which are

                                             d log Q = 0,                                    (46)

since markups do not change in response to changes in population, despite the fact that
welfare increases.


5.4    Discussion
We can now take stock and dispel some common misconceptions. Although we conduct this
discussion for shocks to population, which as discussed above, can also be interpreted as
shocks to trade integration, the spirit of our remarks applies more broadly to other shocks.
   There are positive changes in technical efficiency arising from economies of scale because
fixed entry and overhead costs can be spread across a larger population. When the allocation
of resources is kept constant, the total quantity sold by each firm remains constant, the per-
capita quantity declines, and new firms enter.
   There are also changes in allocative efficiency which come into play as the allocation of
resources adjusts to the shock. First, holding exit and pricing/markup behavior constant,
there is a reallocation away from firms with higher elasticities and lower markups towards
firms with lower elasticities and higher markups. This is the entry-only margin. Since the
former were too large and the latter too small to begin with, this reallocation is beneficial. It
frees up labor, which ends up being used in entry, and this is always beneficial, irrespective
of whether there was too much or too little entry to begin with.
   Second, holding markups constant the cut-off moves and this reallocation is beneficial
depending on whether there the cut-off moves in a socially beneficial direction. Under
Marshall's second law, the cut-off increases and causes the smallest firms to exit. If there was
too little selection to begin with, this reallocation of resources is beneficial.
   Third, existing firms change their markups their markups and the total quantities sold
by these firms changes at the expense of entry. This last effect is the only one that operates
in models with homogeneous firms. Under Marshall's strong second law, an increase in
market size causes markups to fall. The reduction in the average markup discourages entry,
and is beneficial if there was too much entry in the initial equilibrium. However, in models


                                                    27
        with heterogeneity, this effect is complicated by ambiguous reallocation effects across existing
        firms. These reallocation effects are ambiguous because large firms reduce their markups
        more than small firms but face less elastic demand curves. Whether these reallocations are
        beneficial or not (i.e. whether µ is positive or negative) is therefore an empirical question.
             The beneficial nature of these three reallocation effects hinges entirely on second-best
        principles: in which direction the underlying margin is distorted, and in which direction
        the reallocation effect is moving this margin. It has nothing to do with the productivities of
        expanding and shrinking or disappearing firms per se.
             The relative expansion of high-markup firms at the expense of low-markup firms under-
        lying the reallocation effects  increases consumer welfare only because high-markup firms
        were too small to begin with from a social perspective, not because they have "higher pro-
        ductivities". Similarly, the exit of the smallest firms underlying the second reallocation effect
          
         increases consumer welfare only if selection was too weak to begin with, which amounts
        to assuming that the marginal firm has lower infra-marginal consumer surplus ratio than
        average. Finally, the relative expansion of existing firms at the expense of entry underlying
        part of the third reallocation effect increases consumer welfare if and only if there was to much
        entry to begin with, which is the case when the average infra-marginal consumer surplus ratio
        is less than the average markup.23
             Similarly, these reallocations affect consumer welfare and real GDP or aggregate TFP
        through very different channels. In other words, the nature of the consumer welfare gains is
        distinct from that of aggregate TFP gains, and intuitions supporting the latter should not be
        used to shed light on the former. Indeed, changes in aggregate TFP only arise from changes
        in markups. For example, holding pricing/markups constant, aggregate TFP is completely
        unaffected. In particular, the oft-emphasized increase in the minimal productivity cut-off has
        no effect on aggregate TFP.
             This last observation may be of independent interest. In the literature, aggregate TFP
        is sometimes conflated with some ad-hoc productivity index obtained as an average of firm
        productivities (for example, Melitz and Ottaviano, 2008). However, the growth in this index is
        not aggregate TFP growth defined as real GDP growth net of the effects of factor growth. While
        the increase in the minimal productivity cut-off directly increases these ad-hoc productivity
        indices, it has no independent impact on aggregate TFP. Of course, in equilibrium, aggregate
        TFP does increase, but only because of the reduction in markups.
   23
      Although it is not directly relevant for welfare, it is possible to characterize how the absolute size of firms
changes in response to an increase in population. Assuming that the strong second Marshall law of demand holds,
big firms always expand and small firms shrink in absolute terms as long as their pass-throughs are close enough to
one since d log(l L) = (1 -   /E(1-1/µ) [ ])(d log Y + d log L). Similarly, the size of the smallest firms (at the cut-off)
increases since d log(l L) = [1/( - 1)][ /E(1-1/µ) [ ] - 1 +  (1 -  )(1 - 1/E(1-1/µ) [ ])](d log Y + d log L).




                                                            28
        6     Empirical Application
        In this section, we take the theory to the data. We first describe our non-parametric estimation
        procedure. We then implement it using Belgian data and decompose returns to aggregate
        scale into changes in technical and allocative efficiency following Proposition 3.


        6.1    Non-Parametric Model Estimation Approach
        To derive a non-parametric estimate of the Kimball aggregator , we use a restriction imposed
        by the demand system: the time-series pass-through capturing how a firm changes its markup
        in response to a productivity shock is equal to the cross-sectional pass-through capturing how
        markups increase as we move up the productivity distribution across firms.
            We will take two objects as data: (1) the density of sales shares  , and (2) the distribution
        of pass-throughs  . Sales are readily available in our dataset, and we use estimates of pass-
        throughs by firm size from Amiti et al. (2019). The pass-through function is a third-order
        differential equation in the Kimball aggregator, and can be used to solve for  up to boundary
        conditions. For boundary conditions, we need to take a stand on the average levels of first
        and second derivatives, i.e. on the average markup µ¯ and on the average infra-marginal
                                    ¯
        consumption surplus ratio  (these will be constants of integration). We will present our
        estimates for different values of these variables.
            Observation of sales  and pass-throughs  will allow us to back out productivities A up
                                                                         ¯ . Using  = 1/(1-1/µ )
        to a normalizing constant and markups µ up to the average markup µ
        to recover elasticities will then allow us to back out infra-marginal surplus ratios  and the
        whole Kimball aggregator up to the average infra-marginal surplus ratio     ¯.
          Basically, cross-sectional observations on pass-throughs allows us to trace the individual
        demand curve and hence to back out the Kimball aggregator  up to some constants      ¯ and µ
                                                                                                   ¯.
        Through this procedure, we will therefore be able to recover the whole nonlinear structure of
        the model.24
            In our empirical application, we use a uniform type distribution with g() = 1 and G() =
        1 -  by ranking firms by increasing size and associating their type to the fraction of firms
        with smaller sizes. The type distribution itself is irrelevant: the only thing that matters is the
        relation of the measure over types to the measure over sales.
            In principle, one could alternatively use markups µ (second derivatives of the Kimball
   24
     We refer the reader to Appendix G for the discussion of a model with taste shocks and heterogeneous overhead
costs in which cross-section and times-series are entirely disconnected. Although Proposition 3 can be adjusted to
account for taste-shifters, non-parametric estimation of this richer model would require a great deal of additional
data. In particular, we would need additional data on markups µ , the distribution of infra-marginal surplus ratios
 , and overhead costs fo, . All of this information would be very difficult to obtain in practice, and even with all this
extra information, only local estimation could be achieved, which would be enough for local comparative statics
but not global ones.


                                                           29
aggregator) or infra-marginal surplus ratios  (first derivatives of the Kimball aggregator) in
conjunction with sales  to recover . However, these objects are much harder to estimate,
requiring either strong structural assumptions in the case of µ , or in the case of  experi-
mental data tracing out individual demand curves. In comparison, estimating pass-throughs
is less daunting. The downside is that it will require outside information or informed guesses
to pin down boundary conditions µ  ¯ and   ¯.

Productivities, quantities, elasticities, and infra-marginal surplus ratios. Produc-
tivities A and markups µ must simultaneously solve the two differential equations

                                   d log      d log A
                                          =           ,                                       (47)
                                      d     µ - 1 d

                                  d log µ           d log A
                                          = (1 -  )         .                                 (48)
                                     d                 d
The intuition for the first differential equation for sales shares is the following: compared to a
firm of type , a firm with type  + d has higher productivity log A+d - log A = d log A /d,
lower price log p+d - log p =  d log A /d, and higher sales log +d - log  = ( -
1) d log A /d with  - 1 = 1/(µ - 1). The intuition for the second differential equation for
markups is the following: compared to a firm of type , a firm with type  + d has higher
markup log µ+d - log µ = (1 -  )d log A /d.
   Combining the two differential equations yields

                                d log µ           1 -  d log 
                                        = (µ - 1)             .                               (49)
                                   d                      d

Given sales shares  and pass-throughs  , this differential equation allows us to recover
markups µ up to a constant µ . The constant µ  1 can be chosen to match a given value
                                                ¯  1.
of the (harmonic) sales-weighted average markup µ
   Either of the two differential equations for sales shares or markups then allows us to
recover productivities up to a constant A . This constant A can be normalized to 1. For
example, using the differential equation for sales shares, we get


                                   d log A µ - 1 d log 
                                          =             ,
                                      d             d

with initial condition A = 1.
   Next we can then recover quantities using

                                                 A
                                     y =                .                                     (50)
                                           (1 - G( ))Mµ



                                               30
Quantities are increasing in  since d log y /d log  = µ d log  /d log . We denote by ( y)
the reverse mapping giving a firm type as a function of the quantity that it produces.
   Finally, we can recover infra-marginal consumption surplus ratios using the differential
equation
                                  d log  µ -  d log 
                                        =            ,                                       (51)
                                     d           d
with initial condition  chosen to match a given value of the average infra-marginal surplus
ratio E [ ] =   ¯.

Kimball aggregator. We can then recover the Kimball aggregator by combining the defi-
nition of  with the residual demand curve

                                   y        ( y)   ( y)
                                  ( ) =                 .
                                   Y            
                                        (1 - G( ))M ¯

Fixed costs and Selection Cut-off. The information so far does not reveal the cut-off
value  , so calibrating this number requires outside information. To calibrate the marginal
type  , we step slightly outside the model and imagine that new firms operate for one year
before they choose to shut down. Hence, in their first year, the unconditional probability of
exit is higher than the exogenous death rate. We then fit a quasi-hyperbolic process to firm exit
probability by age as reported by Pugsley et al. (2018). The difference between the probability
of exit in the first period versus later periods identifies  . Conditional on  , we can back out
the fixed costs using the free-entry condition

                           fe              fo 1      1
                               + (1 - G( )) = E  1 -                 ,                       (52)
                            L              L  M      µ

and the selection condition

                                            fo  1      1
                               (1 - G( ))      =  1 -    ,                                   (53)
                                            L   M     µ

where total population L, mass of firms M, and  can be normalized to 1.


6.2    Empirical Implementation
In this section, we implement the non-parametric estimation procedure described above using
estimates of the firm-level pass-throughs and the distribution of firms sales. We then use the
estimated model in conjunction with our theoretical formulas to investigate quantitatively
the effects of population shocks and the origins of increasing aggregate returns to scale. We
quantify both local and global comparative static effects of increasing market size.




                                                 31
                                                                                                                     1

                                                 1

                                                                                                                    0.8
              Average pass-through E [x |x < ]
                                             0.9




                                                                                                 Log sales share 
                                                                                                                    0.6

                                             0.8

                                                                                                                    0.4
                                             0.7

                                                                                                                    0.2
                                             0.6


                                                     0   0.2   0.4          0.6   0.8   1                            0
                                                                                                                          0   0.2   0.4          0.6   0.8   1
                                                                  Percentile
                                                                                                                                       Percentile

                  (a) Average cumulated pass-through                                               (b) Cumulative sales share distributions.

Figure 3: The blue dots are data showing the average sales-weighted pass-through and cumulated
sales share for firms smaller than the percentile given by the x-axis. The solid red line is a fitted
spline.


        Data sources. We only give a brief account of our data sources and procedures. The full
        details can be found in Appendix A. We rely on Amiti et al. (2019) who report estimates of pass-
        throughs by firm size for manufacturing firms in Belgium. They use annual administrative
        firm-product level data (Prodcom) from 1995-2007, which contains information on prices and
        sales, collected by Statistics Belgium. They merge this with Customs data, and using exchange
        rate shocks as instruments for changes in marginal cost, they show that they can identify the
        partial equilibrium pass-through by firm size (under assumptions that are consistent with our
        model). Their estimates are shown in Figure 3a. Prodcom does not sample very small firms
        (firms must have sales greater than 1 million euros to be included). Therefore, we merge their
        estimates of the pass-through function  (as a function of size) with the sales distribution  for
        the universe of Belgian manufacturing firms (from VAT declarations). The cumulative sales
        share distribution is shown in Figure 3b.
           For firms that are smaller than the smallest firms in Prodcom, we interpolate their pass-
        through in such a way that the smallest firm has pass-through equal to one. This is consistent
        with the estimates of Amiti et al. (2019) who find that the average pass-through for the smallest
        75% of firms in Prodcom is already 0.97.25

        Boundary Conditions. Our results require taking a stand on two boundary conditions: the
        average infra-marginal surplus ratio  ¯ = E [ ] and on the average markup µ¯ = 1/[E [1/µ ]].
        For the purposes of discussion, in the paper, we focus on two benchmark calibrations of ¯: (1)
        efficient entry ¯=µ
                          ¯ , and (2) efficient selection ¯ =  . We consider two different values for the
   25
    In mapping the model to the data, we assume that products sold by the same firm are perfect substitutes, so
each firm is a different variety. We could alternatively assume that each product is a separate variety. Appendix B
provides results using this assumption. Although this affects numbers change, the overall message does not change.


                                                                                            32
                            1

                                                                                                 4


                           0.8
                                                                                                 2




                                                                             Log sales share 
           Pass-through 




                           0.6                                                                   0



                                                                                                -2
                           0.4


                                                                                                -4

                           0.2
                                 0.2       0.4         0.6    0.8   1                                0.2    0.4         0.6    0.8   1
                                                 Percentile                                                       Percentile

                                       (a) Pass-through                                          (b) Log sales share density log 

                 Figure 4: Pass-throughs and sales share density as a function of firm type .


                      ¯ = 1.045 and µ
       average markup µ             ¯ = 1.090, which are chosen so that d log Y/d log L  0.13 under
       the first assumption, and d log Y/d log L  0.30 under the second assumption. An aggregate
       scale elasticity d log Y/d log L  [0.13, 0.3] is broadly in line with the literature (Bartelme et
       al., 2019; Jones, 2019).26 In Appendix C, we vary both boundary conditions along a 2-
       dimensional grid and show that the two benchmark cases we focus on are representative of
       broader patterns.

       Estimation Results. Figures 4a and 4b display pass-throughs  and log sales log  as
       a function of firm type . These are derived by differentiating the splines in Figures 3 (see
       Appendix A for more details). Sales are initially increasing exponentially (linear in logs), but
       become super-exponential towards the end reflecting a high degree of concentration in the
       tail. Pass-throughs decrease from 1 for the smallest firms to about 0.3 for the largest firms.
       Marhsall's strong second law of demand therefore holds.
          Figure 5a shows that markups µ are increasing and convex in log productivity log A .
                                                             ¯ = 1.090 but the patterns are similar for
       For brevity, we only show graphs of the estimates for µ
                                                                       ¯ = 1.045). The net markup
       the other case (though obviously, markups are lower when we set µ
       ranges from close to zero for the smallest firms to almost 80% for the very largest firms. The
       heterogeneity in markups is a consequence of the vast dispersion in the firm size distribution
       and estimated pass-throughs. Figure 5b shows the log productivity/quality distribution. As
       with the sales density, the productivity density is also initially exponential, and becomes super
       exponential in the tail, however, the pattern is more pronounced. The main reason is that
       elasticities are decreasing in .
          Figures 5d and 5c show the infra-marginal surplus ratio  for the efficient-selection case
  26
     In a CES model, d log Y/d log L = 0.13 correspond to setting an elasticity of substitution around 8 whilst
d log Y/d log L = 0.3 corresponds to an elasticity of substitution around 4.



                                                                        33
                                                                                                                                                                             2.40
          1.80

                                                                                                                                                                             2.20


          1.60                                                                                                                                                               2.00




                                                                                                                                          Log productivity
                                                                                                                                                                             1.80
 Markup




          1.40
                                                                                                                                                                             1.60


                                                                                                                                                                             1.40
          1.20
                                                                                                                                                                             1.20


                                                                                                                                                                             1.00
          1.00                                                                                                                                                                                 0.2           0.4           0.6          0.8         1
                                         0          0.1         0.2         0.3    0.4     0.5       0.6         0.7         0.8
                                                                             Log productivity
                                                                                                                                                                                                                     Percentile


                                                                (a) Markup µ                                                                                                                     (b) Log productivity A
                                                                                                                                                                                    7.00


                                         1.15                                                                                                                                       6.00
          Infra-marginal surplus ratio




                                                                                                                                                     Infra-marginal surplus ratio
                                                                                                                                                                                    5.00

                                         1.10
                                                                                                                                                                                    4.00


                                                                                                                                                                                    3.00
                                         1.05

                                                                                                                                                                                    2.00


                                         1.00                                                                                                                                       1.00
                                                0         0.1         0.2       0.3    0.4     0.5         0.6         0.7         0.8                                                     0     0.1   0.2         0.3    0.4     0.5   0.6   0.7   0.8
                                                                                 Log productivity                                                                                                                   Log productivity


          (c) Infra-marginal surplus ratio  (effi- (d) Infra-marginal surplus ratio  (effi-
          cient selection).                        cient entry).

                                                                                                         ¯ = 1.090.
                                                Figure 5: Markups and infra-marginal surplus ratios with µ


( = ¯) and the efficient-entry case (µ
                                     ¯ =¯). In both cases,  is U-shaped which means that
preferences are not aligned.
          Finally, Figure 6 plots the inverse residual demand curve in linear and log-log terms.
Figure 6a shows that our estimate has a distinctly non-iso-elastic shape, indicating substantial
departures from CES. The Lerner formula ties the markup to the price elasticity of demand
 , which means that  is greater than 100 for the very smallest firms, and around 2.5 for the
very largest firms. The log-log plot also shows that the residual demand curve is log-concave,
which confirms that Marshall's weak second of law of demand holds, and that markups are
increasing in size.

Implications. Markups are increasing in firm size (since Marshall's strong second law
holds, the weak second law holds a fortiori). However, since the infra-marginal surplus ratios
are U-shaped, preferences are not globally aligned.



                                                                                                                                         34
                                                                                                                                    100.00
                                1.00


                                                                                                                                   10-0.02




                                                                                                     Log relative price log(p/P)
           Relative price p/P

                                0.95

                                                                                                                                   10-0.04

                                0.90

                                                                                                                                   10-0.06

                                0.85

                                                                                                                                   10-0.08
                                       0   20       40         60         80        100   120                                                10-1            100             101   102
                                                Per-capita relative quantity y/ Y                                                               Log relative quantity log( y/ Y)


                                 (a) Inverse residual demand curve                               (b) Log-log inverse residual demand curve

Figure 6: Residual demand curve (price against quantity) for the efficient-selection case with
¯ = 1.09. The results for the efficient-entry case are similar.
µ


                                                                ¯ =
        In the efficient-entry case, entry is locally efficient µ  ¯ but we have  > ¯ implying that
     selection is too tough to begin with. Welfare could be improved by allowing more small firms
     to operate, and an increase in the selection cut-off worsens welfare. Nevertheless, this does
     not imply that we would want small firms to become larger -- since small firms have lower
     markups, efficiency would be improved by having them produce less than they already do.
     In other words, the smallest firms should continue to exist but produce less than they do.
     The fact that an increase in the cut-off  reduces welfare may be counterintuitive. In fact,
     it is sometimes taken for granted that an increase in the selection cut-off ipso facto increases
     efficiency. However, as our results show, this argument is flawed.
        In the efficient-selection case, selection is locally efficient  = ¯ but we have ¯ < µ
                                                                                             ¯,
     meaning that there is excessive entry. In both cases, markups µ are increasing in  indicating
     that small firms are too large and large firms are too small along the intensive margin.


     6.3                        Shocks to Population
     In this section, we report the elasticities of consumer welfare and real GDP per capita to
     changes in population.

     Baseline. Table 1 implements Proposition 3. It reports the elasticity of consumer welfare to
     population and its decomposition into changes in technical efficiency and changes in allocative
     efficiency
                                                                       d log Y = d log Ytech + d log Yalloc .

     The table also breaks down the allocative efficiency effect by considering the different margins
     of adjustment. Welfare under the entry-only allocation d log Y (holding fixed  and markups
                                                                                                                                               
     µ ); welfare allowing entry and selection to adjust d log Y, (holding fixed markups µ );

                                                                                                35
     and welfare when all three margins can adjust d log Y         , ,µ   = d log Y. Table 1 presents the
     contributions of endogenous entry d log Y - d log Ytech , exit d log Y     , - d log Y   , and markups
     d log Y   , ,µ - d log Y , to changes in allocative efficiency.   In other words, the sum of the three
     adjustment rows gives the overall change in allocative efficiency in equilibrium.

                                                          µ¯ = 1.045                ¯ = 1.090
                                                                                    µ
                                                       ¯ = 
                                                                   ¯=µ
                                                                     ¯           ¯ = 
                                                                                             ¯=µ
                                                                                               ¯
   Welfare: d log Y                                      0.130         0.145       0.293       0.323
   Technical efficiency: d log Ytech                     0.017         0.045       0.034       0.090
   Allocative efficiency: d log Yalloc                   0.114         0.100       0.260       0.233

   Adj. of Entry: d log Y - d log Ytech                  0.117          0.408      0.272        1.396
                          
   Adj. of Exit: d log Y , - d log Y                     0.000         -0.251      0.000       -1.006
                                                  ,
   Adj. of Markups: d log Y , ,µ - d log Y              -0.004         -0.057     -0.012       -0.157

   Real GDP per capita                                   0.024         0.024       0.051       0.052

Table 1: The elasticity of welfare and real GDP per capita to population following Propositions
3 and 4 for heterogeneous firms case.

                                                                                 ¯ = 1.045 but
        When discussing the results, for concreteness, we focus on the case with µ
                                              ¯ = 1.090. We start by discussing the case with
     similar comments apply to the case where µ
     entry-efficiency first. By construction, the elasticity of consumer welfare to population is 0.13.
     Only around a tenth of the overall effect is due to the technical efficiency effect ¯ - 1 = 0.017.
     Changes in allocative efficiency 0.114 account for around nine tenths of the overall effect.
     An Increase in population therefore brings about considerable improvements in allocative
     efficiency, and these improvements are about nine times larger than the technical efficiency
     effects arising directly from technological increasing returns.
        The changes in allocative efficiency from endogenous entry are large and positive at 0.117.
     Increases in population lead to a reduction in the aggregate price index. This causes a larger
     reduction in quantity per capita for small firms with high elasticities than for large firms with
     low elasticities. This reallocation towards large firms, which were too small to begin with, and
     away from small firms, which were too small to begin with, improves allocative efficiency. In
     other words, the composition effect highlighted in Figure 1 of the introduction is large.
        The changes in allocative efficiency from endogenous exit is zero by construction despite
     the fact that the cut-off increases in response to the increase in population.
        The changes in allocative efficiency from changes in markups are slightly negative -0.004.
     There are several effects to consider. First, increases in in population lead to a reduction
     in the price index. This triggers a pro-competitive effect by causing an overall reduction in
     markups, and a reduction in entry, which is beneficial since there was too much entry to

                                                       36
                            ¯ >
        begin with (because µ  ¯). However, the changes in markups are not uniform, and larger
        firms cut their markups by more than smaller firms since they have lower pass-through.
        However, large firms also face less elastic demand curves than small firms, so that the overall
        reallocation across large and small firms is, in principle, ambiguous and depends on whether
        the pass-through effect dominates the elasticity effect. Here, the detrimental reallocation effect
        dominates the beneficial pro-competitive effect, and the overall effect of changes in markups
        is negative.
           The elasticity of real GDP per capita is small at 0.024. This is much smaller than the elasticity
        of consumer welfare. This is a consequence of the well-known result that the welfare benefits
        of new goods are not reflected in changes in real GDP.27 Indeed, the positive changes in real
        GDP can be entirely attributed to the reduction in markups of existing firms. In particular,
        it also worth noting as before, that the movement in the minimal productivity cut-off on its
        own plays no role in determining real GDP or aggregate TFP, even though the model is not
        efficient. Hence, an increase in the cut-off does not translate into an increase in aggregate TFP.
           Next, consider the efficient-entry case. The elasticity of welfare with respect to population
        shocks is now slightly higher at 0.145. The technical efficiency effect is now 0.045, reflecting
        the fact that ¯ is calibrated to equal µ
                                               ¯ = 1.045. The allocative efficiency effect is still much
        more important than the technical efficiency effect at 0.100.
           The composition effect from endogenous entry is now much larger at 0.408. The intuition
        is the same as before: increases in population lead to a reduction in the aggregate price
        index; this shifts resources away from small firms facing elastic demand and charging low
        markups towards large firms facing less elastic demand and charging higher markups; this
        also increases the profit share and triggers entry. The main reason the effects are so much
        larger than they were in the efficient-selection case is because E ( ) - 1 is now 0.045 instead of
        0.017. This implies that entry is more valuable than it was before. Furthermore, since the new
        entry moves the price index, and the changes in the price index cause large firms to expand
        relative to small firms, there is a feedback loop from new entry, to changes in the price index,
        to changes in aggregate profits, back to entry, amplifying the effect.
           The selection effect from the adjustment of the exit cut-off is now non-zero and negative at
        -0.27. The reason for this can be seen from inspecting Figure 5d, which shows that the infra-
        marginal surplus at the cut-off is much higher than average, hence, as the cut-off increases in
        response to toughening competition, socially valuable small firms are forced to exit.
           Finally, the pro-competitive effect from the reduction in markups is still negative and larger
   27
      The large gap between the welfare and real GDP effect should be interpreted with caution, because it is sensitive
to a dimension of the problem, namely dynamics, which we have abstracted from. The reason is that real GDP, while
it misses the infra-marginal surplus created immediately upon entry of a new variety, captures all the post-entry
productivity gains for this variety. Everything else equal, if new varieties enter small and grow larger over time by
improving their productivity, as would be realistic if varieties were identified with firms, there would be less of a
difference between welfare and real GDP. By contrast, If new varieties enter large, as would be realistic if varieties
where products, then there would be bigger difference between welfare and real GDP.


                                                          37
in magnitude at -0.057. The reason the markup effect is now more negative than it was before
is because in the efficient-selection case there was too much entry, so the overall reductions
in markups had a positive effect (over and above the detrimental reallocation across existing
firms). Since we are now imposing entry efficiency, this latter effect no longer operates, and
the overall contribution of changing markups is more negative than before.
   The response of real GDP per capita is basically unchanged at 0.024, since in both specifi-
cations, the average reduction in markups for existing firms is roughly the same.

How important can selection be? An important theme in the literature has been to
emphasize the role of the selection margin (increases in the productivity cut-off) as a driver
of productivity and welfare gains. However, in our baseline results, the selection margin is
either neutral (when  =    ¯) or is deleterious (when ¯=µ¯ ). One may wonder how robust
this finding is and how it depends on our choice of boundary conditions.
   To answer this question, we consider a third possibility for the initial conditions. We try
setting  = 1, which implies that the residual demand curve for the infra-marginal firms is
perfectly horizontal. In other words, the marginal firms produce no infra-marginal surplus for
the household. This maximizes the importance of the selection margin for welfare, conditional
                 ¯ . The results, however, are quantitatively very similar to those in Table 1.
on our choice of µ
                      ¯ = 1.045, we find the overall effect on welfare is still 0.130 with technical
   Specifically, when µ
efficiency effect of 0.016 and an allocative efficiency effect of 0.114. The adjustment of entry
still accounts for the bulk of changes in allocative efficiency at 0.116. The contribution of
the adjustment of selection to welfare is now positive, but it is still close to insignificant at
0.001. And the pro-competitive effects through the endogenous adjustment of markups are
                                                                             ¯ = 1.09, the
still negative and of similar magnitude to before at -0.003. Similarly, when µ
welfare effect is 0.293 with a technical efficiency effect of 0.033 and an allocative efficiency
effect of 0.260. Once again, the overwhelming force is the adjustment of entry (holding fixed
markups and selection) at 0.269, with a negligible contribution of the adjustment of selection
at 0.003 and a small and negative pro-competitive effect through the endogenous adjustment
of markups at -0.012.
   These results suggest that the small role played by the selection margin is not an anomaly
                                                                              ¯ , it is impossible
resulting from our choice of initial conditions. In fact, given our choice of µ
to choose initial conditions that give selection a bigger role to play than the numbers in the
paragraph above. For more details, see the robustness exercise in Appendix C,

How important is heterogeneity? To emphasize the interaction of heterogeneity and
inefficiency, we compare our model to a model with homogeneous firms, calibrated to have a
pass-through equal to the average (sales-weighted) pass-through and a markup equal to the
harmonic average. The results can be found in Table 2.
   The most striking difference is that the elasticity of consumer welfare to population is


                                                38
                                                             µ¯ = 1.045              ¯ = 1.090
                                                                                     µ
                                                          ¯ = 
                                                                      ¯=µ
                                                                        ¯         ¯ = 
                                                                                              ¯=µ
                                                                                                ¯
   Welfare: d log Y                                         0.030      0.045        0.060       0.090
   Technical efficiency: d log Ytech                        0.017      0.045        0.034       0.090
   Allocative efficiency: d log Yalloc                      0.013      0.000        0.026       0.000

   Real GDP per capita                                      0.021      0.022        0.042       0.043

Table 2: The elasticity of welfare and real GDP per capita to population following Propositions
1 and 2 for homogeneous firms.


        much smaller, because changes in allocative efficiency become negligible. With efficient entry
        ¯=µ
           ¯ = 1.045 and  ¯=µ ¯ = 1.090, there are no changes in allocative efficiency since the model
        is efficient. With efficient selection, the changes in allocative efficiency are positive but fairly
        small. They are small because without heterogeneity, there are no longer changes in allocative
        efficiency from the entry margin (holding fixed selection and markups) or from the selection
        margin (holding fixed markups). Instead, all the changes in allocative efficiency come from the
        pro-competitive effect through the reduction of markups. The changes in allocative efficiency
        are positive because ¯<µ  ¯ , and so the reduction in markups, which reduces entry, improves
        welfare because there was too much entry to begin with.
            This exercise emphasizes once again that the much discussed pro-competitive effects (i.e.
        reductions in markups) are small in comparison the changes in allocative efficiency arising
        from reallocations across heterogeneous firms that we discussed above.
            The effects of population increases on GDP per capita are also smaller than with hetero-
        geneous firms. This is simply because, just like the change in welfare, the change in the price
        index which triggers the reduction in markups is smaller.

        Are there big nonlinearities? Table 1 shows that changes in allocative efficiency account
        for the bulk of the marginal increase in welfare from a marginal increase in population. More
        precisely, most of the effect comes from the reallocations from small firms with low markups to
        big firms with high markups that take place when only the entry margin is allowed to adjust,
        with a more limited role for the reallocations coming from the adjustment of markups and exit.
        One might worry that these composition effects could peter out quickly if we kept increasing
        the size of the population. Fortunately, since the model is identified globally, we can solve the
        model for large shocks and thereby analyze potential nonlinearities.28 The results in Table 3
        and Figure 7 below show that the forces identified for small shocks by Proposition 3 continue
        to apply for large shocks.
  28
       We do this by numerically solving the system of ordinary differential equations in Appendix D.



                                                         39
      0.20
                 Welfare                                            0.15       Entry
                 Technical efficiency                                          Exit
                 Allocative Efficiency                                         Markups
                                                                               Allocative efficiency

      0.15
                                                                    0.10


      0.10

                                                                    0.05

      0.05

                                                                    0.00

      0.00
             0         0.2               0.4   0.6   0.8   1               0         0.2               0.4   0.6   0.8   1


     (a) Welfare: technical and allocative efficiency (b) Allocative efficiency: adjustments of the
     as functions of  log L .                         different margins as functions of  log L.

Figure 7: Decomposition of changes in welfare and allocative efficiency following Proposition 3,
obtained by separately computing each term in the decomposition and integrating (cumulating)
                                                                     ¯ = 1.09 at the initial point.
the changes. The model is calibrated to have efficient selection and µ


         Table 3 reports the average (rather than the marginal) elasticity of welfare to a 0.5 log point
     increase in population (a roughly 68% increase). The magnitude of and the decomposition of
     the average effects are similar to those for the marginal effects reported in Table 1. Although
     the model is far from being log-linear, the conclusion that changes in allocative efficiency
     account for the bulk of aggregate increasing returns to scale, and in particular those changes
     driven the reallocation from small firms with low markups to big firms with high markups
     that take place when only the entry margin is allowed to adjust, with a more limited role for the
     reallocations coming from adjustment of markups and exit. Interestingly, for the calibrations
     assuming efficient selection with ¯ =  (columns 1 and 3), adjustments in exit continue to
     play a negligible role even though the selection cut-off increases with the size of the shock.
         Figure 7 shows cumulated changes in welfare, their breakdown into in technical and
     allocative efficiency, and the breakdown of allocative efficiency into the reallocation effects
     arising from the different margins of adjustment of firm behavior (entry, exit, and markups),
     focusing on the calibration assuming efficient selection with ¯ =  and average markups
     ¯ = 1.09 (column 3). The first panel shows that even though their relative importance decreases
     µ
     slightly with the size of the shock, changes in allocative efficiency continue to dwarf changes
     in technical efficiency even for large shocks. The second panel shows that as the population
     grows, changes in allocative efficiency due to reallocations from the adjustment of markups
     start to account for a non-trivial part of overall changes in allocative efficiency. This happens
     because as we increase population, average markups actually increase due to the composition
     effect that reallocates resources away from low-markup firms and towards high-markup firms
     (the average markup rises despite the fact that all individual markups decrease). This means


                                                               40
        that entry becomes more excessive, and hence that reallocations triggered by individual
        markup reductions improve allocative efficiency more.

        Are there larger increasing returns at the macro vs. micro levels? We also compare
        increasing returns at the macro vs. micro levels. The micro return to scale for a surviving type
         is the ratio of average cost to marginal cost minus one ac /mc - 1, so that 0 corresponds to
        constant returns to scale. The average cost is ac = [ fe /(1 - G( )) + fo + Ly /A ]/(Ly ). The
        marginal cost is mc = 1/A . The harmonic average across surviving producers of the micro
                                                          ¯ - 1.29
        return to scale is equal to 1/E[1/(ac /mc - 1)] = µ
                                                                                         ¯ = 1.045
            Hence average micro technological increasing returns to scale are 0.045 when µ
                       ¯ = 1.090. Increasing returns at the aggregate level are much larger: between
        and 0.090 when µ
        0.130 and 0.145 in the former case and between 0.293 and 0.323 in the latter case. This
        means that even small technological increasing returns at the micro level can give rise to large
        increasing returns to scale at the aggregate level. Once again, the interaction of inefficiency
        and heterogeneity is key. This result would neither hold if the economy were efficient nor if
        there were no heterogeneity.

                                                           µ¯ = 1.045               ¯ = 1.090
                                                                                    µ
                                                        ¯ = 
                                                                    ¯=µ
                                                                      ¯          ¯ = 
                                                                                             ¯=µ
                                                                                               ¯
    Welfare:  log Y                                       0.100       0.099        0.215       0.216
    Technical efficiency:  log Ytech                      0.025       0.048        0.052       0.098
    Allocative efficiency:  log Yalloc                    0.075       0.051        0.162       0.117

    Adj. of Entry:  log Y -  log Ytech                    0.066       0.107        0.145       0.272
                          
    Adj. of Exit:  log Y , -  log Y                       0.000      -0.065        0.000      -0.176
                                                   ,
    Adj. of Markups:  log Y , ,µ -  log Y                 0.008       0.008        0.017       0.021

    Real GDP per capita                                   0.025       0.024        0.054       0.051

Table 3: The average elasticity of welfare and real GDP per capita to population for a large shock
 log L = 0.5.




        7    Extensions
        Before concluding, we describe some extensions which are developed in the appendix.
   29
    From ac = [(le + lo )/(1 - G( )) + l ]/(A l ) and mc = 1/A , we have ac /mc - 1 = [(le + lo )/(1 - G( ))]/l and
hence 1/(ac /mc - 1) = (1 - G( )l /(le + lo ). The result follows since (1 - G( ))l =  /µ and le + lo = 1 - 1/µ¯.




                                                        41
Other shocks. In the main text of the paper, we have focused exclusively on shocks to
population. In Appendix F, we provide comparative statics with respect to other parameters,
like productivity or fixed costs.

Optimal policy and distance to the efficient frontier. In the main text of the paper, we
have focused exclusively on comparative statics. In Appendix E.1, we provide an analytical
characterization of optimal policy. We also provide an analytical second-order approximation
of the distance to the efficient frontier which neatly decomposes the contributions of the
different margins of inefficiency (entry, selection, and relative production) to the overall
amount of misallocation. In Appendix E.2 we compute the distance to the efficient frontier in
our empirical application. There, we quantify the extent of misallocation in the decentralized
equilibrium compared to the first-best allocation, or in other words, the gains from optimal
policy. We find the number to be somewhere between 2.5% and 6.8% in Belgium. Therefore,
there can be large changes in allocative efficiency even though the decentralized economy is
not too far from efficiency. Note that when we increase the size of the market, the frontier also
moves, which means that changes in allocative efficiency due to reallocation are not equal to
changes in the distance from the frontier.



8     Conclusion
In this paper, we analyze how changes in market size affect welfare in a model with mo-
nopolistic competition, heterogeneous firms, variable markups and pass-throughs, entry, and
exit. We decompose the overall change into changes in technical and allocative efficiency. We
use firm-level information to non-parametrically recover demand curves and quantify this
decomposition.
    We find that changes in allocative efficiency, due to the reallocation of resources, are a more
important source of welfare gains from increases in scale than changes in technical efficiency.
Quantitatively, the most important reallocation is a composition effect that shifts resources
from small firms with low markups towards big firms with high markups. This composition
effect results from the fact that the price index falls as the market becomes larger. This effect is
distinct from changes in the productivity cut-off and changes in markups. In fact, increases in
the productivity cut-off and the reduction in markups play only minor roles in comparison.
    Two important implications are: that the aggregate return to scale is an endogenous
equilibrium outcome shaped by frictions and market structure, and not an exogenous tech-
nological primitive; and that even mild increasing returns to scale at the micro level can give
rise to large increasing returns to scale at the macro level.
    Natural extensions of our analysis would be to consider alternative market structures
and entry processes, to add explicit dynamics, to model rich input-output structures, and to


                                                42
explicitly take trade into account.



References
Aghion, Philippe and Peter Howitt, "A Model of Growth through Creative Destruction,"
  Econometrica, March 1992, 60 (2), 323­351.
Amiti, Mary, Oleg Itskhoki, and Jozef Konings, "International Shocks, Variable Markups,
  and Domestic Prices," The Review of Economic Studies, 02 2019.
Arkolakis, Costas, Arnaud Costinot, Dave Donaldson, and Andr´      iguez-Clare, "The
                                                            es Rodr´
  elusive pro-competitive effects of trade," The Review of Economic Studies, 2018, 86 (1), 46­80.
Asplund, Marcus and Volker Nocke, "Firm turnover in imperfectly competitive markets,"
  The Review of Economic Studies, 2006, 73 (2), 295­327.
Baqaee, David Rezza and Emmanuel Farhi, "Productivity and Misallocation in General
  Equilibrium.," Technical Report, National Bureau of Economic Research 2019.
Bartelme, Dominick G., Arnaud Costinot, Dave Donaldson, and Andres Rodriguez-Clare,
  "The Textbook Case for Industrial Policy: Theory Meets Data," NBER Working Papers
  26193, National Bureau of Economic Research, Inc August 2019.
Behrens, Kristian, Giordano Mion, Yasusada Murata, and Jens Suedekum, "Quantifying
  the gap between equilibrium and optimum under monopolistic competition," Higher School
  of Economics Research Paper No. WP BRP, 2018, 185.
Bilbiie, Florin O, Fabio Ghironi, and Marc J Melitz, "Monopoly power and endogenous
  product variety: Distortions and remedies," American Economic Journal: Macroeconomics,
  2019, 11 (4), 140­74.
Dhingra, Swati and John Morrow, "Monopolistic competition and optimum product diver-
  sity under firm heterogeneity," Journal of Political Economy, 2019, 127 (1), 196­232.
Dixit, Avinash K and Joseph E Stiglitz, "Monopolistic competition and optimum product
  diversity," The American economic review, 1977, 67 (3), 297­308.
Edmond, Chris, Virgiliu Midrigan, and Daniel Yi Xu, "How costly are markups?," Technical
  Report, National Bureau of Economic Research 2018.
Grossman, Gene M. and Elhanan Helpman, "Quality Ladders in the Theory of Growth,"
  Review of Economic Studies, 1991, 58 (1), 43­61.
Hopenhayn, Hugo A, "Entry, exit, and firm dynamics in long run equilibrium," Econometrica:
  Journal of the Econometric Society, 1992, pp. 1127­1150.
Hsieh, Chang-Tai and Peter J Klenow, "Misallocation and manufacturing TFP in China and
  India," The Quarterly journal of economics, 2009, 124 (4), 1403­1448.
Hulten, Charles R, "Growth Accounting with Intermediate Inputs," The Review of Economic
  Studies, 1978, pp. 511­518.



                                               43
Jones, Charles I, "R&D-Based Models of Economic Growth," Journal of Political Economy,
  August 1995, 103 (4), 759­784.
  , "The End of Economic Growth? Unintended Consequences of a Declining Population,"
  Technical Report, Working Paper, Stanford University 2019.
Kimball, Miles, "The Quantitative Analytics of the Basic Neomonetarist Model," Journal of
  Money, Credit and Banking, 1995, 27 (4), 1241­77.
Klenow, Peter J and Jonathan L Willis, "Real rigidities and nominal price changes," Econom-
  ica, 2016, 83 (331), 443­472.
Krugman, Paul R, "Increasing returns, monopolistic competition, and international trade,"
  Journal of international Economics, 1979, 9 (4), 469­479.
Mankiw, N. Gregory and Michael D. Whinston, "Free Entry and Social Inefficiency," RAND
  Journal of Economics, Spring 1986, 17 (1), 48­58.
Melitz, Marc J., "The Impact of Trade on Intra-Industry Reallocations and Aggregate Industry
  Productivity," Econometrica, November 2003, 71 (6), 1695­1725.
Melitz, Marc J, "Competitive effects of trade: theory and measurement," Review of World
  Economics, 2018, 154 (1), 1­13.
   and Gianmarco IP Ottaviano, "Market size, trade, and productivity," The review of economic
  studies, 2008, 75 (1), 295­316.
Mr´   a, Monika and J Peter Neary, "Not so demanding: Demand structure and firm
  azov´
  behavior," American Economic Review, 2017, 107 (12), 3835­74.
   and      , "IO For Export(s)," 2019.
Perla, Jesse, Christopher Tonetti, and Michael E. Waugh, "Equilibrium Technology Diffusion,
  Trade, and Growth," Technical Report January 2020.
Pugsley, Benjamin W, Petr Sedlacek, and Vincent Sterk, "The nature of firm growth," 2018.
Restuccia, Diego and Richard Rogerson, "Policy distortions and aggregate productivity with
  heterogeneous establishments," Review of Economic dynamics, 2008, 11 (4), 707­720.
Romer, Paul M, "Increasing Returns and Long-run Growth," Journal of Political Economy,
  October 1986, 94 (5), 1002­1037.
  , "Endogenous Technological Change," Journal of Political Economy, October 1990, 98 (5),
  71­102.
Spence, Michael, "Product selection, fixed costs, and monopolistic competition," The Review
  of economic studies, 1976, 43 (2), 217­235.
Venables, Anthony J, "Trade and trade policy with imperfect competition: The case of
  identical products and free entry," Journal of International Economics, 1985, 19 (1-2), 1­19.
Vives, Xavier, Oligopoly pricing: old ideas and new tools, MIT press, 1999.
                                                                     ¸ ois Thisse, "Mo-
Zhelobodko, Evgeny, Sergey Kokovin, Mathieu Parenti, and Jacques-Franc
  nopolistic competition: Beyond the constant elasticity of substitution," Econometrica, 2012,
  80 (6), 2765­2784.



                                                44
                               Online Appendix
   Appendix A               Details of Empirical Implementation
   Amiti et al. (2019) provide estimates of the average sales-weighted pass-through (denoted
   by ) for Belgian manufacturing firms conditional on the firms being smaller than a certain
   size as measured by their numbers of employees. These estimates are based on information
   from Prodcom, which is a subsample of Belgian manufacturing firms. Inclusion in Prodcom
   requires that firms have turn-overs above 1 million euros, which means that the sample is not
   representative of all manufacturers. The estimates are in Table 4.

No of employees     Share of observations       Share of employment         Share of sales     
100                 0.76313963                  0.14761668                  0.23096292         0.9719
200                 0.85435725                  0.22086396                  0.3389753          0.8689
300                 0.88848094                  0.28832632                  0.4083223          0.9295
400                 0.92032149                  0.33549505                  0.48074553         0.8303
500                 0.93746047                  0.38345889                  0.54008827         0.6091
600                 0.94523549                  0.41987701                  0.58209142         0.6612
1000                0.96365488                  0.52280162                  0.66820585         0.6229
8000                0.99996915                  0.99999999                  0.99999174         0.6497

                           Table 4: Estimates from Amiti et al. (2019).

       Our objective is to infer the pass-through  as a function of firm size. With some abuse of
   notation, let   [0, 1] be the fraction of observations in Prodcom up to some sales value. Let
   () be the sales share density of Prodcom firms of type . Then the variable "Share of sales"
   is defined as
                                                        
                                           () =            (x)dx.
                                                    0

   We fit a smooth curve to (), then the pdf of sales shares () is given by

                                                           d
                                               () =          .
                                                           d

   The curve we fit has the form exp(c0 + c1  + c2 c3 ), where c0 , c1 , c2 , c3 are chosen to minimize
   the mean squared error.
       Next, the variable () satisfies

                                                   
                                                  0
                                                    (x)(x)dx
                                         () =        
                                                                ,
                                                    0
                                                       ( x ) dx


                                                   45
                                               
                                              0
                                                (x)(x)dx
                                          =                    ,
                                                   ()

where (x) is the sales-share of firms of type x. Next we fit a flexible spline function to ().
The fitted curve is shown in Figure 3a.
   To recover the pass-throughs (), we write

                               d   ()()                 ()
                                 =             -                   ().
                               d      ( x ) dx
                                                       
                                                        (x)dx
                                   0                  0

In other words, we can recover the pass-through function via

                                           
                                            (x)dx
                                          0             d
                                 () =                     + (),
                                         ()             d
                                        () d
                                      =      + ().
                                        () d

This gives us pass-throughs as a function of the number of employees.
   Next, we use information from VAT declaration in Belgium for the year 2014 to recover
the sales distribution of Belgian manufacturers (overcoming the sample selection issues in
Prodcom). Table 5 displays the underlying data.
   As before, we let   [0, 1] index the fraction of observations up to some size. Then the
variable "Share of sales" is defined as
                                                   
                                      () =            (x)dx,
                                               0

where (abusing notation)  is the sales share density of all manufacturing firms (rather than
just the ones in Prodcom). We fit a smooth curve to (), then the pdf of sales shares () is
given by
                                                      d
                                          () =          .
                                                      d
The curve we fit has the form exp(c0 + c1  + c2 c3 ), displayed in Figure 3b. Finally, we merge
our pass-through information from Prodcom with the sales density from VAT declarations by
assuming that the pass-through  of a firm with a given number of employees in Prodcom is
the same as it is in the bigger dataset. We then fit a smooth spline to this pass-through data
from [0, 1] assuming that the pass-through for the smallest firm is 1 and declines monotonically
from the smallest firm to the first observation (which is a pass-through of 0.97 for firms with
100 employees). Given a smooth curve for both  and  we follow the procedure outlined
in Section 6.1, solving the differential equations numerically using the Runge-Kutta algorithm
on a large grid.



                                               46
                 Number of employees          Share of sales    Share of Observations
                 1                            0.004559          0.16668
                 2                            0.00826           0.284539
                 3                            0.014786          0.375336
                 5                            0.022269          0.489659
                 10                           0.043011          0.652879
                 20                           0.076444          0.779734
                 30                           0.111713          0.843161
                 50                           0.163492          0.906204
                 75                           0.198242          0.932729
                 100                          0.231815          0.947413
                 200                          0.325376          0.974629
                 300                          0.386449          0.983547
                 400                          0.449491          0.989237
                 500                          0.486108          0.991927
                 600                          0.655522          0.994311
                 1000                         0.740656          0.997386
                 8000                         0.970654          0.999923

Table 5: Firm size distribution for manufacturing firms from VAT declarations in Belgium for
2014.


     Appendix B              Product-Level Data
     In the body of the paper, we assume that different products produced by a single firm are
     perfect substitutes from the perspective of the consumer, and so we use overall sales of a firm
     as the sales of each variety. An alternative approach is to instead to treat each product as a
     single variety instead. In Table 6 we display the average number of products each firm in
     Prodcom sells, for each firm-size bin.
        To map each product to a variety, we take the sales density for firms and divide the density
     for firms of a given size by the average number of products (renormalizing the density so that
     it still integrates to one). Mapping the model to the data in this way results in less dispersion
     in sales, a left tail which is slightly less thick, and as a result, less dispersed estimates of
     productivities and markups. The comparative statics for this version of the model are in
     Table 7. The basic qualitative message of our previous results in Table 1 is unchanged, and
     the composition effects from the adjustment of the entry margin (holding fixed markups and
     selection) are still overwhelmingly the dominant force in the model.




                                                    47
                         No of Employees     No of Products   No of firms
                         5                   1.3636364        22
                         10                  2.0550459        109
                         20                  2.200495         404
                         30                  2.4203297        728
                         50                  2.4203895        873
                         75                  2.3727506        389
                         100                 3.294686         207
                         200                 3.225            400
                         300                 3.3308824        136
                         400                 3.6511628        86
                         500                 5.2162162        37
                         600                 4.1724138        29
                         1000                8.3095238        42
                         8000                8.8780488        41

            Table 6: Number of products on average from Prodcom sample in 2014.




                                                    µ¯ = 1.045         ¯ = 1.090
                                                                       µ
                                                 ¯ = 
                                                             ¯=µ
                                                               ¯    ¯ = 
                                                                                ¯=µ
                                                                                  ¯
   Welfare: d log Y                               0.080    0.133     0.176    0.294
   Technical efficiency: d log Ytech              0.020    0.045     0.042    0.090
   Allocative efficiency: d log Yalloc            0.060    0.088     0.134    0.204

   Adj. of Entry: d log Y - d log Ytech           0.056    0.136     0.126    0.327
                          
   Adj. of Exit: d log Y , - d log Y              0.000   -0.037     0.000   -0.094
                                             ,
   Adj. of Markups: d log Y , ,µ - d log Y        0.004   -0.012     0.008   -0.029

   Real GDP per capita                            0.015    0.016     0.032    0.035

Table 7: The elasticity of welfare and real GDP per capita to population following Propositions
3 and 4 for heterogeneous firms case using product-level data.




                                                 48
        Appendix C                             Robustness to Boundary Conditions
        Table 8 provides the elasticity of welfare and changes in allocative efficiency, following Propo-
        sition 3 for different boundary conditions. Although the magnitude of d log Y/d log L changes
        as we change the boundary conditions, the contribution of allocative efficiency to the overall
        total is at least 50% of the overall effect. Table 9 breaks down the overall effect on allocative
        efficiency into the different margins of adjustment (entry-only, selection, and markups). The
        entry-only effect is always responsible for the bulk of the positive effect. As mentioned, for a
              ¯ , the selection effect is strongest when  is lowest, but even for  = 1, the selection
        given µ
        effect is negligible.

     Table 8: Change in log welfare and allocative efficiency for different boundary conditions
                                                                                        
                 1               2               3               4               5               6               7               8               9               10
     1.05   [0.144,0.126]   [0.150,0.122]   [0.155,0.117]   [0.161,0.112]   [0.166,0.107]   [0.171,0.102]   [0.177,0.097]   [0.182,0.092]   [0.187,0.086]   [0.192,0.082]
     1.06   [0.180,0.158]   [0.186,0.153]   [0.191,0.148]   [0.196,0.144]   [0.202,0.139]   [0.207,0.134]   [0.212,0.128]   [0.218,0.123]   [0.223,0.118]   [0.228,0.113]
     1.07   [0.213,0.187]   [0.218,0.183]   [0.224,0.178]   [0.229,0.173]   [0.235,0.168]   [0.240,0.163]   [0.245,0.158]   [0.251,0.153]   [0.256,0.148]   [0.261,0.143]
     1.08   [0.255,0.225]   [0.260,0.220]   [0.266,0.215]   [0.271,0.211]   [0.276,0.206]   [0.282,0.201]   [0.287,0.196]   [0.292,0.190]   [0.297,0.185]   [0.302,0.180]
     1.09   [0.293,0.260]   [0.299,0.255]   [0.304,0.251]   [0.310,0.246]   [0.315,0.241]   [0.321,0.236]   [0.326,0.231]   [0.331,0.226]   [0.336,0.220]   [0.341,0.215]
 ¯
 µ   1.10   [0.336,0.299]   [0.341,0.294]   [0.347,0.289]   [0.352,0.284]   [0.357,0.279]   [0.363,0.274]   [0.368,0.269]   [0.373,0.264]   [0.378,0.259]   [0.383,0.254]
     1.11   [0.382,0.341]   [0.387,0.336]   [0.393,0.331]   [0.398,0.326]   [0.403,0.321]   [0.409,0.316]   [0.414,0.311]   [0.419,0.306]   [0.424,0.301]   [0.429,0.296]
     1.12   [0.433,0.388]   [0.438,0.383]   [0.443,0.378]   [0.449,0.373]   [0.454,0.368]   [0.459,0.363]   [0.464,0.357]   [0.469,0.352]   [0.474,0.347]   [0.479,0.342]
     1.13   [0.489,0.439]   [0.494,0.435]   [0.499,0.430]   [0.505,0.424]   [0.510,0.419]   [0.515,0.414]   [0.520,0.409]   [0.525,0.404]   [0.530,0.398]   [0.535,0.393]
     1.14   [0.551,0.498]   [0.557,0.493]   [0.562,0.487]   [0.567,0.482]   [0.572,0.477]   [0.577,0.472]   [0.582,0.466]   [0.587,0.461]   [0.592,0.455]   [0.596,0.450]
     1.15   [0.622,0.563]   [0.627,0.558]   [0.632,0.553]   [0.637,0.548]   [0.642,0.542]   [0.647,0.537]   [0.651,0.531]   [0.656,0.526]   [0.661,0.520]   [0.665,0.515]


Each cell reports [d log Y/d log L, d log Yalloc /d log L] for different boundary conditions. Each column is a different
value for the boundary condition  and each row is a different aggregate markup µ             ¯ . Cells that approximately
correspond to efficient selection are colored in blue and cells that approximately correspond to efficient entry are
colored in yellow. The bulk of the changes in welfare are due to reallocation effects.




                                                                                  49
               Table 9: Change in allocative efficiency for different boundary conditions
                                                                    
                      1                       3                      5                         7                        9
     1.05    [0.129,0.001,-0.004]   [0.329,-0.169,-0.0430] [0.619,-0.428,-0.0850] [1.068,-0.842,-0.130]        [1.84,-1.576,-0.177]
     1.06    [0.162,0.002,-0.005]   [0.376,-0.180,-0.0470] [0.689,-0.459,-0.0910] [1.182,-0.915,-0.139]        [2.05,-1.743,-0.189]
     1.07    [0.192,0.002,-0.007]   [0.420,-0.191,-0.0510] [0.755,-0.490,-0.0970] [1.292,-0.986,-0.147]       [2.263,-1.914,-0.201]
     1.08    [0.232,0.003,-0.009]   [0.476,-0.205,-0.0560] [0.843,-0.531,-0.106] [1.439,-1.085,-0.159]        [2.559,-2.157,-0.216]
     1.09    [0.269,0.003,-0.012]   [0.530,-0.219,-0.0610] [0.927,-0.572,-0.114] [1.586,-1.184,-0.171]        [2.867,-2.415,-0.231]
 ¯
 µ   1.10    [0.310,0.004,-0.015]   [0.591,-0.234,-0.0670] [1.023,-0.620,-0.124] [1.756,-1.303,-0.184]        [3.244,-2.736,-0.249]
     1.11    [0.355,0.004,-0.019]   [0.658,-0.252,-0.0750] [1.131,-0.675,-0.135] [1.956,-1.445,-0.200]        [3.715,-3.145,-0.269]
     1.12    [0.406,0.005,-0.023]   [0.735,-0.273,-0.0840] [1.257,-0.741,-0.149] [2.195,-1.619,-0.218]        [4.322,-3.682,-0.293]
     1.13    [0.463,0.006,-0.029]   [0.822,-0.298,-0.0940] [1.403,-0.819,-0.164] [2.485,-1.836,-0.240]        [5.134,-4.415,-0.321]
     1.14    [0.527,0.007,-0.036]    [0.922,-0.327,-0.107]  [1.576,-0.916,-0.184] [2.847,-2.114,-0.266]       [6.280,-5.470,-0.355]
     1.15    [0.601,0.008,-0.046]    [1.039,-0.362,-0.123]  [1.785,-1.036,-0.207]  [3.31,-2.481,-0.298]       [8.023,-7.107,-0.396]

                                                                                         
Each cell reports [d log Y - d log Ytech , d log Y , - d log Y , d log Y , ,µ - d log Y , ] for different boundary conditions.
Each column is a different value for the boundary condition  and each row is a different aggregate markup µ                 ¯.
The bulk of the positive changes in allocative are due to the entry-only margin. Changes in markups and selection
margin are either unimportant or harmful.



       Appendix D                    Propagation and Aggregation Equations
       In this section, we summarize the propagation and aggregation equations for the model with
       heterogeneous firms. We expand the equilibrium equations presented in Section 2.2 to the first
       order in the shocks. Changes in all the equilibrium variables are expressed via propagation
       equations as functions of changes in consumer welfare. Changes in consumer welfare are
       then expressed as as functions of the changes in the equilibrium variable via an aggregation
       equation. Putting propagation and aggregation together yields a fixed point in changes in
       consumer welfare.

       Aggregate price index. Differentiating the definition of the price and demand indices, we
       find
                                          g( )                                   1        y
                    - d log P = -                d   + d log M + d log Y + E 1 -   d log(   ) .                         (54)
                                        1 - G( )                                          Y
       Combining this equation with the equation for quantities and markups, we get

                                 g( )
            - d log P = -               d + d log M + d log Y + E  ( - 1) d log A + d log P . (55)
                               1 - G( )

       Finally, combining with the second equation for entry derived below, we find

                                                                              fe       fe         f           f
                                                                               L d log( L )+[1-G( )] L d log( L )
                               -d log Y - E(1-1/µ) ( - 1)d log A +                     fe         f
                                                                                        L +[1-G( )] L
                   d log P =                                                                                        .   (56)
                                                              E(1-1/µ) [ ]



                                                               50
This equation for the aggregate price index can be replaced in all the equations below.

Entry. We derive two equations for free entry. The first equation is obtained as follows.
Differentiating the free-entry condition, we find

 fe       fe             f           f
  L d log( L ) + [1 - G( )] L d log( L )                   g( )                           1
                                           + d log M -          
                                                                  d = E(1-1/µ) d log  1 -        .
          fe             f                               1 - G( )                         µ
           L + [1 - G( )] L
                                                                                              (57)
Combining with the equation for variable profit shares, we get

                fe       fe             f           f
                 L d log( L ) + [1 - G( )] L d log( L )          g( )
  d log M = -                                             +             d
                         fe             f                      1 - G( )
                          L + [1 - G( )] L
                 + E(1-1/µ) ( - 1) d log A + d log P - E  ( - 1) d log A + d log P .

We can also use the equation for the demand index to get

                                                 g( )
  d log M = -d log Y - d log P +                        d - E  ( - 1) d log A + d log P .
                                               1 - G( )

Sales shares. Differentiating the sales shares equation, we find

                                      g( )                           A
            d log  = d log M -               + d log Y + ( - 1)d log( ) +  d log P.           (58)
                                    1 - G( )                         µ

Combining with the third equation for entry, we get


                          g( )
  d log  = ( - 1)                d +  ( - 1) d log A + d log P
                        1 - G( )
                                                               - E  ( - 1) d log A + d log P .

Markups. Differentiating the markup equation, we get

                               d log µ = (1 -  ) d log A + d log P .                          (59)

Variable profit shares. Combining the equations for sales shares and for markups, we get

                  1                   g( )
  d log  1 -            = ( - 1)             d + ( - 1) d log A + d log P
                  µ                 1 - G( )
                                                               - E  ( - 1) d log A + d log P .




                                                    51
Quantities. Differentiating the individual demand function, we find

                                       y            A
                              d log(     ) =  d log( ) + d log P .                          (60)
                                       Y            µ

Combining with the equation for markups, we get

                                       y
                              d log(     ) =   d log A + d log P .                          (61)
                                       Y

Selection. Differentiating the selection condition, we get

               log A                     1                             g( )             fo
 ( - 1)              |= d = -d log  1 -                + d log M -          
                                                                              d + d log( ). (62)
                                        µ                            1 - G( )           L

Combining with the equations for variable profits shares and entry, we get

               log A                                                              fo
 ( - 1)              |= d = -( - 1) d log A + d log P - d log P - d log Y + d log( ), (63)
                                                                                  L

   where we note that
                                    log A          g( )
                                          |= =             .                                (64)
                                               ga (log A )

Welfare. Differentiating the consumer welfare equation, we get

                                         g( )
               d log Y = -( - 1)                d + ¯ - 1 d log M + E d log( A ) .          (65)
                                              
                                       1 - G( )                              µ

Combining with the equation for markups, we get

                     g( )
 d log Y = -( - 1)
                            d + (¯ - 1)d log M + E  d log A - (1 -  )d log P . (66)
                   1 - G( )

Combining with the equations for the aggregate price index and entry leads to a fixed point
in d log Y.



Appendix E Distance to Efficient Frontier
In this appendix, we focus on the distance to the efficient frontier, that is the amount of
misallocation in the decentralized equilibrium compared to the first-best allocation.
   In Appendix E.1, we provide an analytical second-order approximation which neatly
decomposes the contributions of the different margins of inefficiency to the overall amount of
misallocation. The proof of the main proposition can be found in Appendix E.3. In Appendix
E.1, we compute the distance to the frontier in our empirical application.


                                                 52
        E.1    Analytical Second-Order Approximation
        In this section, we calculate the social costs of the distortions caused by monopolistic com-
        petition around the efficient CES benchmark. We index the Kimball aggregator t by some
        parameter t, where t = 0 gives an iso-elastic form for  (CES), and moving from t = 0 perturbs
        the Kimball aggregator away from iso-elasticity in a smooth fashion. The proposition below
        provides a second-order approximation in t of the distance to the efficient frontier, providing
        a link between our framework and the literature on the social costs of misallocation with entry
        (for example, Epifani and Gancia, 2011).

        Proposition 5. The difference between welfare at the first-best allocation and the decentralized equi-
        librium can be approximated around t = 0 by

                                                  2                             2
            Yopt 1         E µ                                E µ
                   
                     µ                                1                              1
        log      E       -                          + 2 E [ ] E [ ] - 1             +   (E [ ] -  )2 ,
                                                   
                   
                                                   
             Y   2  E [ ] E [ ]                                                      2
                                                   
                                                                


        where the remainder term is order t3 .

           The first term, familiar from the misallocation literature, captures distortions in the relative
        sizes of existing firms. It scales with the dispersion of the ratios of markups to the average
        infra-marginal surplus ratio µ /E [ ]. It also scales with the elasticities of substitution  .30
           The second term captures the distortions due to inefficient entry. It scales with the squared
        distance to unity of the ratio of the average markup to the average infra-marginal surplus
        ratio E [µ ]/E [ ]. It also scales with the elasticities of substitution  .
           The third and final term captures the distortions due to inefficient selection. It scales with
        the squared difference between the infra-marginal surplus of the marginal firm  and that of
        the average E ( ). It also scales with the hazard rate of the log productivity distribution for
        the marginal firm 
                           (rather than the price elasticity of demand), which captures the relevant
        elasticity of the selection margin.31
           In the CES case, markups are constant across varieties µ = E [µ ], the average markup is
        equal to the average infra-marginal surplus ratio E [µ ] = E [ ], and infra-marginal surplus
        ratios are constant across varieties  = E [ ]. As a result, all three terms are zero.


        E.2    Empirical Application
        In this appendix, we compute the distance to the efficient frontier in our empirical application.

   30
      The first term is a particular case of the formulas in Baqaee and Farhi (2019) applied to the relevant distortions
µ /E [ ] in the presence of entry (rather than to µ when there is no entry).
   31
      If there are many firms at the cut-off (high  ) or the cut-off moves very quickly (high  ) in response to
distortions, then the losses from selection inefficiency  E ( ) are amplified.



                                                          53
                                                  µ¯ = 1.045              ¯ = 1.090
                                                                          µ
                                               ¯ = 
                                                           ¯=µ
                                                             ¯         ¯ = 
                                                                                   ¯=µ
                                                                                     ¯
                   Heterogeneous firms           0.024         0.027     0.057       0.065
                   Homogeneous firms             0.021         0.000     0.041       0.000

                          Table 10: Distance to the efficient frontier log(Yopt / Y).

           We finish by computing the distance to the efficient frontier. The results are reported in
        Table 10 both for the case with heterogeneous firms and for the case with homogeneous firms.
                                                              ¯ = 1.045 the distance to the frontier
           With heterogeneous firms, and with average markups µ
                                                                                           ¯ = 1.09
        is around 2.5%. The distance to the frontier is higher with higher average markups µ
        at around 6%. In both cases, the numbers are similar for efficient entry and efficient selection.
           While these numbers are sizable, one might think that they are not large enough. Indeed,
        in Section 6.3, we saw in the decentralized equilibrium, cumulated changes in allocative
        efficiency are large relative to cumulated changes in technical efficiency even for large increases
        in population. If the distance to the frontier is sizable but not very large, doesn't that mean
        that the economy should quickly approach the frontier as we increase population? And then
        shouldn't this source of welfare gains grounded in misallocation quickly peter out? The
        answer to these questions is no and the reason is the following. At the first-best allocation,
        increases in population only increase welfare by improving technical efficiency. But changes in
        technical efficiency for the first-best allocation (at the frontier) turn out to be much larger than
        changes in technical efficiency for the decentralized equilibrium (inside the frontier). And so
        the distance to the efficient frontier remains sizable even for large increases in population.32
           With homogeneous firms, the distance to the frontier is zero when       ¯=µ ¯ since then entry,
        which is the only margin that can be distorted, is efficient. Otherwise the distance to the
        frontier is smaller than with heterogeneous firms, but not considerably so. Again, and for the
        same reasons as those explained above, this does not contradict the earlier observation that
        changes in allocative efficiency are small at the decentralized equilibrium with homogeneous
        firms.


        E.3      Proof of Proposition 5
        To do this, imagine a social planner who can implement the efficient allocation by regulating
        markups and imposing sales taxes. A sufficient condition is to set markups according to the
                                                         opt
        infra-marginal surplus each firm generates µ =  and sales taxes to be the reciprocal of
                   opt
        markups  = 1/µ . The markups provide socially optimal incentives along the extensive
   32
     This discussion goes back to our definition of changes in allocative efficiency as the changes in welfare that
arise from the reallocation of resources as opposed to the change in the distance to the efficient frontier already
discussed in footnotes 1 and 18.

                                                         54
      margin and the output taxes undo the inefficiencies brought about by dispersed markups.
      See Edmond et al. (2018) for an alternative implementation of the optimal allocation using
      taxes.33 This section contributes to the literature by providing an analytical approximation
      for distance to the efficient frontier.
          At the decentralized monopolistically competitive equilibrium, we instead have µ =
      (1 - 1/ )-1 and  = 1. The equilibrium equations are
                                                       
                                                              y    g()
                                     (1 - G( ))M          (     )        d = 1,                    (67)
                                                              Y 1 - G( )
                                                       
                                                           g()
                                             L =                    d,                             (68)
                                                           1 - G( )
                                       
                       ML fe                 1    1   (1 - G( ))ML fo    g()
                              =                1-   -                          d,                  (69)
                        L                         µ          L        1 - G( )

                                           1     1   (1 - G( ))ML fo
                                             1-    =                 ,                             (70)
                                                µ           L
                                                                     µ L y
                                            = (1 - G( ))M                  ,                       (71)
                                                                      A
                                                  µ L      y
                                                      = P ( ),                                     (72)
                                                  A        Y
                                                              ¯
                                                              
                                                         P=     ,                                  (73)
                                                              Y
                                                          
                                   1                          y  y    g()
                                     = (1 - G( ))M              ( )         d.                     (74)
                                   ¯
                                                              Y  Y 1 - G( )
          Efficiency requires
                                                          1    
                                                  µ =       = y .                                  (75)
                                                          
                                                              Y 

          In step 1, we log-differentiate the equilibrium equations (at an arbitrary point). In step 2,
      we specialize these equations to the monopolistically competitive equilibrium with changes
      in markups and taxes towards the efficient point. We use the resulting formulas to compute
      the distance to the efficient frontier by dividing the first order effect (of moving towards
      the efficient point) by 1/2. This is because we know that the derivative once we reach the
      efficient point is zero, and the average of two first-order approximations yields a second-
      order approximation.


      Step 1:
      In the first step, we generalize the propagation equations to allow for policy.
33
     Bilbiie et al. (2019) also consider related issues in a dynamic context.


                                                             55
   Aggregate price index:

                                                            g( )
                              d log M + d log Y -  1-G( ) d
             -d log P =
                                                             g()
                              1+   
                                     y            -1       1-G( ) d
                                     - Y 
                                                                                              g()
                               
                                 y            - 1 d log µ + d log  + d log L                1-G( ) d
                                 - Y 
                          -                                                                                  .
                                                                           g()
                                           1+     
                                                    y              -1    1-G( ) d
                                                    - Y 


   Sales shares:

                    g( )
                                               
                            
                                                                              
d log  = d log M-          d +d log Y-      - 1 d log µ + d log  + d log L + y  d log P.
                                               
                                         y
                                      
                         
                  1 - G( )             - Y                                  - Y 
                                               
                                                                               (76)
   Variable profits:

             1    1                        g( )      
                                                                    
   d log       1-               = d log M -       d   + d log Y -  y    d log  + d log L
            L     µ                      1 - G( )                 -Y 
                                                                      
                                                     
                                   1                                
                                 µ - 1 -         - 1   d log µ + y     d log P.
                                                     
                                +
                                                      
                                          y
                                                     
                                          - Y                     - Y 
                                                      
                                  


   Quantities:

                              y     
                  d log         = - y           d log µ + d log  + d log L - d log P .                                  (77)
                              Y    -  Y    

   Labor share:


                                                                          g()              g( )            
                g( )                   
                                                d log  - d log          1-G( ) d           1-G( ) d
    d log L =          d +                          g()
                                                                                      -     g()
                                                                                                             .          (78)
              1 - G( )                                     d,                                           ) d,
                                                    1-G( )                                    1 - G ( 


   Entry:

                                      1                1                                                       g()
                g()                  L 
                                                 1-   µ         d log  1 1 -     µ
                                                                                  1
                                                                                          - d log L          1-G( ) d
   d log M =          d +                                     1
                                                                                                                        .
             1 - G( )                                                 1-    1     g()
                                                             L             µ    1-G( ) d


Replacing to get aggregate price index:

                                                                          1                1                         g()
                                                                                   1-              y
                                                                                                     
                                                                                                          d log  1-G( ) d
                                          d log Y                         L               µ    -   Y 
  -d log P+d log L =            1
                                                                    -         1
                                            1          g()                                      1                  g()
                                      1-          y         d                             1-              y
                                                                                                            
                                                                                                                 1-G( ) d
                                L          µ     -Y  1-G( )                  L                 µ      -   Y 




                                                           56
       1           1    1                                     g()
             1-               -       
                                             - 1 d log µ 1-G( ) d       M(1-G( )) fo                        g( )
      L           µ    µ -1         y
                                   -Y                                       L          -  1 1 -     µ
                                                                                                     1
                                                                                                           1-G( ) d
                                                                                                                    
+                 1
                                                                    +        1
                                                                                                                       .
                                   1            g()                                          1             g()
                 L 
                         1-       µ     y
                                          
                                              1-G( ) d                       L  
                                                                                       1-   µ     y
                                                                                                    
                                                                                                         1-G( ) d
                                       -Y                                                        -Y 


     Replacing to get entry:

                                 g( )
    d log M = -d log Y +                d
                               1 - G( )
                                      
                                                           g() 
                                                                  
                                              
                                1 +                - 1
                              -                                    d log P
                                                                  
                                            y
                                           
                                                       1 - G( ) 
                                            - Y 
                                                                  
                                     
                                   
                                                                                   g()
                                                   
                                         
                                                - 1  d log µ + d log  + d log L          d.
                                                   
                               +      
                                                   
                                           y
                                         - Y                                    1 - G( )
                                                   
                                  
                                                   


     Selection cut-off:

                    log A                                                                     g( )
                 
                                                       1     1
              - 1                      d = -d log        1-                + d log M -               d . (79)
                 
      y
                 
      - Y                                             L     µ                               1 - G( )
     
                                  =
                 


     Welfare:


                                     
                                                                      g()
          d log Y = d log M  ¯-1 -      d log µ + d log  + d log L          d
                                                                   1 - G( )
                                    g( )
                                
                                            
                  -         - 1   1 - G( ) d ,
                                
                                 
                                  
                     y
                                
                      Y   

or

                          
                                              g() 
                                                     
                                 
    ¯d log Y = - ¯-1 1 +              - 1             d log P
                                         
                            
                                                     
                               y          1 - G( ) 
                               - Y 
                                         
                         
                                                     
                         
               
                                                                       g()
                                     
                             
           -      1 - ¯-1         - 1   d log µ + d log  + d log L           d
                                     
                  
                                     
                             y
                                     
                           - Y                                      1 - G( )
                                     
              
                                     

                                                                          g( )
                                                                    
                                                            ¯                   
                                                              -       1 - G( ) d .
                                                                    
                                                         +           
                                                                        
                                                                y
                                                                    
                                                                 Y 
                                                           



Step 2
We proceed in two steps.




                                                         57
Applying the formula at the monopolistic competitive equilibrium.                               We start at
the monopolistic competitive equilibrium. We can simplify the equations to get
                                                  
                                                                       g()
                            d log L = -                 d log                d,                        (80)
                                                                    1 - G( )
                                                                
                                                                                 g()
                   - d log P + d log L = d log Y -                  d log              d,              (81)
                                                                              1 - G( )


                            g( )
  d log M = -d log Y +             d
                          1 - G( )
                                 
                                                      g() 
                                                             
                                         
                           1 +                - 1
                         -                                    d log P
                                                             
                                       y
                                      
                                                  1 - G( ) 
                                       - Y 
                                                             
                                
                              
                                                                              g()
                                              
                                      
                                           - 1  d log µ + d log  + d log L          d,
                                              
                          +      
                                              
                                      y
                                   
                                    - Y                                    1 - G( )
                                              
                             
                                              


                 log A
               
                                                                  
            - 1                 d = -d log Y +                         d log  - d log P + d log L .    (82)
               
       y                                                        y
   
      -Y                                                       - Y 
               
                            =
               

The solution (apart from d log M which we do not need for what follows) is
                                                  
                                                                       g()
                            d log L = -                 d log                d,                        (83)
                                                                    1 - G( )

                                            - d log P = d log Y,                                       (84)
                                            
                                           y                            
       log A                           -    Y                                           g()
                   d = d log Y +                          d log  -          d log             d .      (85)
               =
                                       
                                               -1                                    1 - G( )
                                       y
                                   -    Y   

Plugging into welfare, we get


         
                                   g()                            g( )
                                                                               
                                                         
            ¯-1                                  ¯-                           
  1 -                      - 1             d  -                            d    d log Y =
                                                                               
                                                                             
                                                               
                                                                               
                     y                               y        
                                                                               
                                1 - G (  )             
                                                                1 - G ( )
                                                                        
                   - Y 
                                                       
                                                                               
                                                        
                                                           
                                                      Y   

              
                                                                      g()
                                             
                                   
          -        1 -    ¯-1        
                                         - 1   d log µ + d log                d
                                              
                 
                                             
                                y
                                             
             
                               
                                 - Y 
                                                                   1 - G( )
                                              
                                                             g()            g()
                                        
                              
               1 -  ¯ - 1           - 1          d log              d               d
                                         
        +                                                             
                                         
                            y
                                         
                            - Y                           1 - G( )       1 - G( )
                                         
                                             
                                        

                                                      
                                                       
                                                   y                           
                                                                                               g()
                              
                                                  - Y 
                        ¯                                          d log  -        d log             d .
                        - y
                       
                   +   
                              
                                                                                            1 - G( )
                              
                                                           -1                 
                              
                           Y                      y
                                              -    Y   




                                                          58
Applying to changes in markups and taxes towards the efficient point. Efficiency
                                                               
requires markups µ =       y    and taxes on production  = 1/ y . Hence we use the forcing
                           Y                                               Y   
                                                 
variables (the endogenous response of           y    is second order)
                                                Y 
                                                                  
                                                            µ
                                                                  
                                            d log µ  - log                                    (86)
                                                                  
                                                                   ,
                                                                  
                                                            y 
                                                                  
                                                                  
                                                             
                                                                  
                                                             Y 
                                                              
                                                             
                                            d log   - log                                     (87)
                                                              
                                                              .
                                                              
                                                           y 
                                                          
                                                           Y 
                                                              

Plugging into welfare, we get

               
                                          g()                        g( )
                                                                              
                                                           
     1 -          ¯-1              - 1               ¯                         d log Y 
                                       1 - G( ) -    - y
                                                                              
                                                    
                                                                1 - G( )  
                                                                              
                       y
                                                              
                       - Y 
                                                              
                                                           
                                                                              
                                                         Y   
                                                                           
                 
                                                                               g()
                                                                          
                                                         µ 
                                                            
                        ¯
                                                                           
               -    1 -  - 1               - 1    - log       - log                   d
                                                                           
                   
                                                                           
                                    y                                y
                                                                           
                                    -                     
                                                                            1 - G( )
                                                                       
                                                                           
                                                        y                
                                                                           
                                        Y    
                                                                               Y   
                                                             Y 
                                                     
                                                                   g()         g()
                                                                           
                                                             
           -         1 - ¯-1         - 1               log 
                                                              
                                                                         d           d
                                                                           
                                                                           
                                                                           
                                y                           y
                                                                           
                                - Y                             1 - G( )    1 - G( )
                                                                           
                                                            Y 
                                                     
                                                                           
                
                                        
                                     y                                  
                                                                                        g()
                                                                                               
                                    - Y                                            
                ¯
                - y                             - log                       log      1 - G( ) d
                                                                                               
           +                                               +
                                                                                               .
                                                                                               
                                                       y                         y 
                                                                                    
                                     
                                                           
                                             -1                                   
                                                                                               
                   Y                y                   Y                        Y 
                                   - Y 


And the loss function encapsulating the distance to the efficient frontier is

                                                  1
                                                L  d log Y.                                   (88)
                                                  2

     Using the notation in the paper, we therefore get

         1      E [ ] - 1     E [ ]                    1                    E [ ]
     L  - E 1 -           log                         +   (E [ ] -  ) µ log       ,           (89)
         2       µ - 1         µ                       2                     

or                          µ           2               
                     1 
                        
                           E [ ]   -1             E [ ] 
                                                        
                                                           1   µ 
                   L  E                     E [ ]        +         (E [ ] -  )2 ,             (90)
                                                        
                                                              
                                                        
                                                              
                     2      µ - 1                          2
                                                        
                                                   µ           
                                                                 
                                                                

or                                                       2
                        1   µ      µ                         1              2
                      L  E              -1                 + 2   (E [ ] -  ) ,                (91)
                                                          
                        2   µ - 1 E [ ]
                                                          

or                                                   2
                          1    µ                         1              2
                        L  E        -1                 + 2   (E [ ] -  ) ,                    (92)
                                                      
                             
                                                      
                          2   E [ ]
                                                      


                                                     59
or
                                               2                        2 
                      E µ                            E µ
              
          1    µ                                                           + 1   (E [ ] -  )2 ,
        L  E        -                                      -1                                     (93)
                                                                          
                                                   +
                                                                          
          2    E [ ] E [ ]                           E [ ]                 2
                                                                          



Appendix F                   Additional Comparative Statics
In this section, we characterize comparative statics with respect to shocks to the fixed costs
and shocks to the productivity distribution. We start with fixed cost shocks, and then examine
productivity shocks.


F.1     Shocks to Fixed Costs
As with population shocks, we begin by focusing on the homogeneous-firm case.


F.1.1    Homogeneous Firms

Proposition 6. Suppose that firms have the same productivity A = A. In response to changes in
population d log L, changes in consumer welfare are given by

                                                                       
                                   d log Y = ( - 1)d log L +             d log L,                 (94)
                                                                      1-
                                             technical efficiency   allocative efficiency


where
                                                    -1 1         
                                = 1- 1-                  = 1- 1-   .                              (95)
                                                    µ-1          µ
Changes in entry costs d log( fe ) and in overhead costs d log f0 respectively have the same effects
on consumer welfare as change in population shocks d log L = -[ fe /( fe  + f0 )]d log( fe ) and
d log L = -[ fo /( fe  + f0 )]d log( fo ).

Proposition 7. Suppose that firms have the same productivity A = A. In response to changes in
population d log L, changes in real GDP per capita are given by

                                                   1-
                                      d log Q =       (d log Y + d log L),                        (96)
                                                    

where d log Y is given by Proposition 1. Changes in entry costs d log( fe ) and in overhead costs
d log f0 respectively have the same effects on these variables as change in population shocks d log L =
-[ fe /( fe  + fo )]d log( fe ) and d log L = -[ fo /( fe  + fo )]d log( fo ).




                                                          60
F.1.2   Heterogeneous Firms

Now, we consider shocks to fixed costs when firms are heterogeneous.

Proposition 8. In response to changes in fixed costs of entry d log( fe ) and fixed overhead costs
d log fo , changes in consumer welfare are given by

                              fe d log( fe ) + fo d log fo
  d log Y = - E [ ] - 1
                                 fe  + (1 - G( )) fo

                            technical efficiency
                                      
                      + µ +           fe d log( fe ) + (1 - G( )) fo d log fo
                 -             E [  ]
                   1 -  - µ - 
                              
                                               fe  + (1 - G( )) fo

                                                   allocative efficiency
                                                                             
                                                                            fe [d log( fe ) - d log f ]
                                                                -                                       ,
                                                                    1- - -
                                                                        µ  
                                                                               fe  + (1 - G( )) f

                                                                                allocative efficiency

             
where  ,  , and µ are given in Proposition 3 and

                                                                            1
                                   = E [ ] -                                     .                         (97)
                                                                             - 1

   As with population shocks, we can provide sufficient conditions under which changes in
allocative efficiency amplify or mitigate the effects of the shocks.

Corollary 3. Sufficient conditions for positive changes in allocative efficiency in response to decreases
                                                                                                        
in the fixed cost of entry are the same as in Corollary 2. Indeed, (1), (2), and (3) imply  > 0,  > 0,
                                                           
and µ > 0. Furthermore, (1) and (3) imply  > 0. Sufficient conditions for positive changes in
allocative efficiency in response to decreases in the fixed overhead cost if selection decreases (d < 0)
are that (1) and (2) hold but that (3) fail (too much selection).

   To understand these results, it is useful to observe that the model is homogeneous of degree
zero in fixed costs and population fe , f , and L. This is because they only matter through
fixed costs per capita ( fe )/L and f /L. This means that joint proportional reductions in fixed
costs of entry and fixed overhead costs d log( fe ) = d log f < 0 have exactly the same effects on
consumer welfare as equivalent increases in population d log L = -d log( fe ) = -d log f > 0.
   With homogeneous firms, shocks to fixed costs act like scaled population shocks even in
isolation. The equivalent shock to population is inversely related to the shock to the total
fixed cost -[ fe d log( fe ) + (1 - G( )) f d log f ]/[ fe  + (1 - G( )) f ]. This is no longer true with
heterogeneous firms because the two fixed costs impact selection in different ways.
   Consider first a reduction in the fixed cost of entry d log( fe ) < 0. This reduces the total
(entry and overhead) fixed cost per entering variety in proportion to the share of the fixed

                                                           61
cost of entry in the total fixed cost [( fe )/[ fe  + (1 - G( )) f ]]d log( fe ) < 0. This reduction in
fixed cost acts like an equivalent increase in population coupled with an equivalent increase
in the fixed overhead cost. The effect of the former was analyzed in Proposition 3 and
Corollary 2. The effect of the latter is to further increase the sales shares of exiting varieties by
-[  /( - 1)][( fe )/[ fe  + (1 - G( )) f ]]d log( fe ) > 0. This in turn increases consumer
welfare by -[(E[ ] -  )  /( - 1)][( fe )/[ fe  + (1 - G( )) f ]]d log( fe ) > 0 as long as
there is too little selection (E [ ] >  ). The result in the proposition is obtained by solving
the fixed point in d log Y.
   Consider now a reduction in the fixed overhead cost d log f < 0. The effect on the selection
cut-off is reversed compared to the case of a reduction in the fixed cost of entry: compared to
an increase in population by -[(1 - G( )) f /[ fe  + (1 - G( )) f ]]d log( f ) > 0, the increase in the
fixed overhead cost reduces the selection cut-off, which typically overcomes the increase in
selection associated with the equivalent increase in population. If this is the case, the overall
change in consumer welfare from the change in selection is positive if and only if there is too
much selection (E [ ] <  ).
   In both cases, and exactly as for population shocks, we can decompose the general equi-
librium response by analyzing three successive equilibrium allocations which allow firms to
adjust along more and more margins: entry, entry and exit, and entry, exit and markups. All
three equilibrium allocations feature the same changes in technical efficiency, but different
changes in allocative efficiency, driven by different changes in the allocation of resources. The
corresponding changes in consumer welfare are respectively given by Proposition 8, but with
                     
µ =  = 0 and  = 0, µ = 0, and without any modification.
   We can also perform the same decomposition for changes in real GDP per capita.

Proposition 9. In response to changes in fixed costs of entry d log( fe ) and fixed overhead costs
d log f , changes in real GDP per capita are given by

                                     1                  fe d log( fe ) + (1 - G( )) f d log f
     d log Q = E (1 -  )        E          d log Y +                                          ,   (98)
                                                                fe  + (1 - G( )) f

where d log Y is given by Proposition 8.

   Proposition 9 can be used to decompose real GDP per capita along the same lines as the
                                                                          
decomposition of welfare in Proposition 8. Setting µ =  = 0,  = 0 and  = 1 holds fixed
markups and selection but allows entry, setting µ = 0 and  = 1 holds fixed markups but
allows entry and selection to adjust, and finally apply Proposition 9 without any modification
allows all margins to adjust.




                                                  62
F.2     CES Example
The CES case is once again very simple. We have  = , µ = µ = 1/(1 - 1/),  = 1, and
                                                
 = /( - 1). This implies that  =  = µ = 0. The simplicity of this expression is a
consequence of the fact that the equilibrium is efficient.


F.3     Shocks to Productivity
Now, we consider shocks to the distribution of productivity shifters, starting with the homogeneous-
firm case before moving onto the heterogeneous case.


F.3.1   Homogeneous Firms

Whereas the model is not homothetic in population and fixed costs L, fe , and f , it is homothetic
in productivity A.

Proposition 10. Suppose that firms have the same productivity A = A. In response to changes in
productivity d log A, changes in consumer welfare are given by

                             d log Y =       d log A            +            0              .    (99)

                                         technical efficiency       allocative efficiency


   In response to a positive productivity shock d log A > 0, individual quantities and con-
sumer welfare all increase proportionately with the shock d log y = d log Y = d log A. As a
result, there is no change in markups d log µ = 0, and hence individual prices decrease pro-
portionately with the shock d log p = -d log A. Entry remains unchanged d log M = 0. More
generally the allocation of resources actually stays unchanged, that is, the fractions of labor
allocated to entry, overhead, and variable production remain unchanged. The absence of
reallocations in turn implies that there are no changes in allocative efficiency. There are only
changes in technical efficiency.

Proposition 11. Suppose that firms have the same productivity A = A. In response to changes in
productivity d log A, changes in real GDP per capita are given by

                                          d log Q = d log A.                                    (100)

   Basically, the price of each variety is reduced by the amount of the productivity shock,
with no change in markups.


F.3.2   Heterogeneous Firms

Finally, we consider shocks to productivities when the firm-size distribution is heterogeneous.

                                                      63
Proposition 12. In response to changes in productivity d log A , changes in consumer welfare are
given by

                                                    
                                      d log A +  d log A + µ d log A
  d log Y = E d log A +                                                  
                                                1 -  - µ - 

              technical efficiency               allocative efficiency
                                                       
                                           + + 
                                            µ
                                      +             E(1-1/µ) ( - 1)d log A + E d log A ,
                                        1 -  - µ - 

                                                                    allocative efficiency

              
where  ,  , and µ are given in Proposition 3 and


          d log A = E [ ] - 1 E(1-1/µ) ( - 1)d log A - E ( - 1)d log A ,

                                                           d log A - E(1-1/µ)  d log A
         d log A = - E  -                                                                      ,
                                                                                - 1
                                                 E [ ] - 1
        µ d log A = - E (1 -  ) 1 -                        d log A .
                                                  µ - 1

     Exactly as for shocks to population and to fixed costs, we can decompose the general
equilibrium response by analyzing three successive equilibrium allocations which allow firms
to adjust along more and more margins: entry, entry and exit, and entry, exit and markups.
All three equilibrium allocations feature the same changes in technical efficiency given by
the sales-weighted changes in productivities, exactly as in Hulten's theorem (Hulten, 1978).
These three equilibrium allocations feature different changes in allocative efficiency, driven
by different changes in the allocation of resources. The corresponding changes in consumer
                                                                                            
welfare are respectively given by Proposition 12, but with µ =  = 0 and µ [d log A ] =
  
 [d log A ] = 0, µ = 0 and µ [d log A ] = 0, and without any modification.
     Changes in allocative efficiency are given by the sum of two sets of terms. The first
                                      
set of terms  d log A ,  d log A , and µ d log A captures the effects of changes in
                                                         ¯ Y constant. The second set of
productivities d log A holding the aggregate price index /
terms capture the effects of changes in the aggregate price index d log P = (E(1-1/µ) [( -
1)d log A ] + d log Y)E [1/ ].
     We have already discussed the effects of changes in the aggregate price index, for example
in Section 5.2. We therefore focus our discussion on the effects of changes in productivities
holding the aggregate price index constant. We quickly discuss the intuition for the terms
                    
 d log A ,  d log A , and µ d log A . These terms are then amplified by a multiplier
                          
1/[1 - ( + µ +  )] arising from solving the fixed point in d log Y.
     The intuition for the term  d log A is the following. Productivity shocks change prices
for given markups, exit behavior, and aggregate price index. The sales shares of varieties

                                                          64
with high markups tend to increase if they experience sufficiently higher relative productivity
shocks to offset their relatively lower elasticities. If they do, the variable profit share increases,
which increases entry by E(1-1/µ) [( - 1)d log A ] - E [( - 1)d log A ] and welfare by
(E [ ] - 1)(E(1-1/µ) [( - 1)d log A ] - E [( - 1)d log A ]).
                                     
      The intuition for the term  d log A is the following. Productivity shocks change
exit behavior for given markups and aggregate price index. The selection cut-off tends
to decrease if the productivity increases relatively more and if the elasticity of substitu-
tion is relatively higher at the cut-off.     If they do does, the sales share of exiting vari-
eties decreases by ( d log A - E(1-1/µ) [ d log A ])/( - 1), which changes welfare by
-(E [ ] -  )( d log A - E(1-1/µ) [ d log A ])/( - 1).
   The intuition for the term µ d log A is the following. Productivity shocks lead to changes
in markups for a given aggregate price index. Increases in productivity lead to increases in
markups, which increases the variable profit share. This in turn increases entry and changes
welfare by -E [(1 -  )[1 - [(E [ ] - 1)/(µ - 1)]d log A ]].
   Signing the overall changes in allocative efficiency is difficult because of offsetting effects.
For example if all productivity shocks are identical d log A = d log A, then there are no
changes in allocative efficiency, since just like in the case with homogeneous firms, the model
is homothetic with respect to such shocks. In this special case, the terms capturing the effects
of changes in productivities given the aggregate price index exactly offset (term by term) the
terms capturing the effects of changes in the aggregate price index given productivities: the
                                                                       
terms in  [d log A ] exactly offset the terms in  , the terms in  [d log A ] exactly offset the
             
terms in  , and the terms in µ [d log A ] exactly offset the terms in µ . This shows that
changes in allocative efficiency from productivity shocks depend finely on the distribution of
these shocks across types.
   It turns out to be easier to determine if changes in consumer welfare are greater than sales-
and pass-through-weighted changes in productivity.

Corollary 4. Sufficient conditions for changes in consumer welfare to be greater than sales- and
pass-through-weighted changes in productivity

                                        d log Y > E  d log A                                    (101)

in response to positive changes in productivity are the conditions (1), (2), and (3) of Corollary 2,
together with two conditions ensuring that productivity shocks are sufficiently skewed towards large
firms
                    E(1-1/µ) ( - 1)d log A - E  ( - 1)d log A > 0,                              (102)

and
                       E(1-1/µ) ( - 1)d log A - ( - 1)d log A > 0.                              (103)

   Finally, we can apply the same decomposition as above into three different equilibrium

                                                 65
allocations incorporating more and more margins of adjustment: entry, entry and exit, and
entry, exit and markups. The corresponding changes in real GDP per capita are respectively
                                                                             
given by Proposition 13 below, but with µ =  = 0 and µ [d log A ] =  [d log A ] = 0 and
 = 1, µ = 0 and µ [d log A ] = 0 and  = 1, and without any modification.

Proposition 13. In response to changes in productivities d log A , changes in real GDP per capita
are given by


  d log Q = E  d log A
                                                       1
                              + E (1 -  )      E           d log Y + E(1-1µ) ( - 1)d log A ,
                                                       

where d log Y is given by Proposition 12.



Appendix G               Differences in Tastes and Overhead Costs
In this section, we extend the model to allow for differences in tastes and overhead costs, by
                                  
allowing the Kimball aggregator ( Y ; ) and the overhead cost fo () to depend on the type 
of the variety. Instead of ranking types by productivity, we rank them in increasing order of
variable profits to overhead cost ratio so that X =  (1 - 1/µ )/ fo, is increasing in . The
formulas in the paper continue to apply, with one exception: changes in selection are now
given by

      log X                                                               fo,
            |= d = -( - 1) d log A - d log P - d log P - d log Y + d log(     ).           (104)
                                                                           L

This implies that in all the formulas, we must now use 
                                                        = [ gx (log X )/[1-Gx (log X )]]/( -
1) where gx (log X ) = g()/( log X /).
   Empirical implementation requires more data than the strategy described in Section 6.1.
This is because the model is richer. To simplify the discussion, assume that overhead costs
are homogeneous so that fo, = fo .
   The model without taste shocks required data on sales  and pass throughs  as well
as taking a stand on the average markup µ¯ = 1/[E [1/µ ]] and the average infra-marginal
surplus ratio ¯ = E [ ]. The nonlinear model could then be perfectly identified, allowing us
to perform local and global counterfactuals.
   Identification of the model with taste shocks requires additional data: we need data
on markups µ and we need to take a stand on the whole distribution of infra-marginal
consumption surplus ratios  . Even with this data, we only have a local identification of the
model, allowing us only to perform local first-order counterfactuals.
   The reason is that in the model without taste shocks, a bigger firm is a smaller firm which

                                               66
      received a positive productivity shock. Cross-sectional observations then allow us to trace
      the whole individual demand curve and hence to back out the Kimball aggregator up to some
      constants. This simplification disappears in the model with taste shocks.



      Appendix H                Real GDP via a Quantity Index
      In a neoclassical setting (without non-convexities), real GDP can in principle be measured in
      two equivalent ways, either using a Divisia quantity index or a Divisia price index. In this
      model, since new goods enter with finite sales, this breaks the equivalence between the two
      indices. The price index is the definition we adopt in the body of the paper, however, for
      completeness, we also discuss the quantity index. The quantity index measures the change in
      individual quantities at constant prices

                                            d log Qq = E [d log y ].                              (105)

      This is equal to

                                                        g( )               A
                           d log Qq = -d log M +             
                                                               d + E d log( ) ,                   (106)
                                                      1 - G( )             µ

          The two notions of changes in real GDP per capita differ. For the rest of this section, denote
      the price-index notion (that we use in the body of the paper) using d log Qp : this is the change
      in real GDP per capita measured at constant quantities (more precisely, the price index is
      measured at constant quantities, and then changes in real GDP are defined to be changes in
      nominal GDP deflated by the price index). Changes in real GDP per capita measured with
      quantities d log Qp depend only on changes in prices d log(p /w) = d log(µ /A ). For given
      prices p /w = µ /A , they do not depend on the allocation of spending between new, existing,
      and disappearing varieties. By contrast, changes in real GDP measured with quantities do
      depend on the allocation of spending for given prices. In fact, d log Qq penalizes new product
      creation since the quantity of new products produced is not included in the measure, but the
      reduction in the quantity of existing products is included. The reduction in the quantity of
      existing products comes about from the fact that, in order to produce new products, less of
      the old products must be produced.
          Since real GDP measured at constant prices has a physical interpretation, we can write
      real GDP per capita measured with quantities Qq (A, X):34
34
     However, no such representation is available for real GDP measured with prices Qp .




                                                       67
                                             log Qq                          log Qq
                              d log Qq =            d log A +                       dX .            (107)
                                             log A                            X

                                             technical efficiency        allocative efficiency

Note that changes in allocative efficiency are different for consumer welfare d log Y and for
changes in real GDP per capita at constant prices d log Qq . Changes in allocative efficiency are
changes in the object of interest originating in reallocation effects. It is therefore natural that
they depend on the object of interest.

Homogeneous Firms

Proposition 14. Suppose that firms have the same productivity A = A. In response to changes in
population d log L, changes in real GDP per capita are given by

                          d log Qq =      -d log L            + (1 - )(d log Y + d log L),          (108)

                                       technical efficiency             allocative efficiency


where d log Y is given by Proposition 1. Changes in entry costs d log( fe ) and in overhead costs
d log f0 respectively have the same effects on these variables as change in population shocks d log L =
-[ fe /( fe  + fo )]d log( fe ) and d log L = -[ fo /( fe  + fo )]d log( fo ).

    Changes in real GDP per capita measured with quantities are given by d log Qq = d log y
so that d log Qq = d log Y + d log( y/ Y) = d log Y - (d log Y + d log L). They can be decomposed
into changes in technical efficiency -d log L and changes in allocative efficiency (1 - )d log Y +
(1 - )d log L.
    Holding the allocation of resources constant, an increase in population d log L > 0 leads
to a proportional reduction -d log L < 0 in the per-capita quantity of each variety because
the number of varieties increases by d log L > 0. The new varieties do not contribute at all
to changes in real GDP measured with quantities. This explains, in this case, the negative
changes in technical efficiency -d log L < 0.
    Turning to changes in allocative efficiency, the pro-competitive reduction in markups
reduces entry and increases the per-capita quantity of each variety. This explains, in this case,
the positive changes in allocative efficiency (1 - )(d log Y + d log L) > 0.

CES Example Changes in real GDP per capita are given by

                               d log Qq =        -d log L           +             0             .   (109)

                                             technical efficiency       allocative efficiency


Even though the CES model is efficient, and there are no changes in allocative efficiency,
increases in population reduce real GDP measured using the quantity index. Intuitively, the

                                                              68
production of new goods means that fewer units of existing goods are produced per capita.
Since the quantity index only measures changes in the quantity of existing goods per capita,
it falls in response to the shock.

Heterogeneous Firms

Proposition 15. In response to changes in population d log L, changes in real GDP per capita are

                                                                  1
              d log Qq =      -d log L            + 1 - E   E              d log Y + d log L ,   (110)
                                                                  
                           technical efficiency            allocative efficiency


where d log Y is given by Proposition 3.

   We can apply the same decomposition as above into three different equilibrium allocations
incorporating more and more margins of adjustment: entry, entry and exit, and entry, exit and
pricing/markups. The corresponding changes in real GDP per capita are respectively given
                                                  
by Proposition 4, but setting µ =  = 0 and  = 1 (which holds fixed markups and the
cut-offs), µ = 0 and  = 1 (which holds fixed markups but allows the cut-off to adjust), and
without any modification (allowing all margins to adjust).
   For changes in real GDP per capita, it is actually even more interesting to study this
decomposition in reverse order, because of the more central role played by pricing/markups
in the evolution of these variables. This means incorporating more and more margins of
adjustment as follows: pricing/markups, pricing/markups and exit, and pricing/markups,
entry and exit. The corresponding changes in real GDP per capita are respectively given by
                                        
Proposition 4, but with  =  = 0,  = 0, and without any modification. For example,
under assumptions (1), (2), and (3), changes in real GDP per capita measured with prices
increase as more and more margins of adjustment are incorporated.




                                                      69
