                                 NBER WORKING PAPER SERIES




   BAYESIAN AND ADAPTIVE OPTIMAL POLICY UNDER MODEL UNCERTAINTY

                                          Lars E.O. Svensson
                                          Noah M. Williams

                                         Working Paper 13414
                                 http://www.nber.org/papers/w13414


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                    September 2007




The authors thank James Bullard, Martin Ellison, Alexei Onatski, Tamas Papp, Rujikorn Pavasuthipaisit,
Eric Schaling, Eric Swanson, Rick van der Ploeg, members of the Princeton Macro Lunch Workshop,
and participants in the following conferences: Monetary Policy and Uncertainty in Oslo, June 2006,
Macroeconomic Policy Design for Monetary Union in Amsterdam, June 2006, and the International
Research Forum on Monetary Policy in Washington, DC, December 2006, for helpful comments and
discussions. The views expressed in this paper are solely the responsibility of the authors and should
not to be interpreted as reflecting the views of any other member of the Executive Board of Sveriges
Riksbank. Research support from the National Science Foundation is gratefully acknowledged. The
views expressed herein are those of the author(s) and do not necessarily reflect the views of the National
Bureau of Economic Research.

© 2007 by Lars E.O. Svensson and Noah M. Williams. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
Bayesian and Adaptive Optimal Policy under Model Uncertainty
Lars E.O. Svensson and Noah M. Williams
NBER Working Paper No. 13414
September 2007
JEL No. D81,E42,E52,E58

                                             ABSTRACT

We study the problem of a policymaker who seeks to set policy optimally in an economy where the
true economic structure is unobserved, and he optimally learns from observations of the economy.
This is a classic problem of learning and control, variants of which have been studied in the past, but
seldom with forward-looking variables which are a key component of modern policy-relevant models.
As in most Bayesian learning problems, the optimal policy typically includes an experimentation component
reflecting the endogeneity of information. We develop algorithms to solve numerically for the Bayesian
optimal policy (BOP). However, computing the BOP is only feasible in relatively small models, and
thus we also consider a simpler specification we term adaptive optimal policy (AOP) which allows
policymakers to update their beliefs but shortcuts the experimentation motive. In our setting, the AOP
is significantly easier to compute, and in many cases provides a good approximation to the BOP. We
provide some simple examples to illustrate the role of learning and experimentation in an MJLQ framework.

Lars E.O. Svensson
Sveriges Riksbank
SE-103 37 Stockholm
Sweden
and NBER
svensson@princeton.edu

Noah M. Williams
Department of Economics
001 Fisher Hall
Princeton University
Princeton, NJ 08544-1921
and NBER
noahw@princeton.edu
1     Introduction

We study the problem of a policymaker (more concretely, a central bank), who seeks to set policy
optimally in an economy where the true economic structure is unobserved and the policymaker
optimally learns from his observations of the economy. This is a classic problem of learning and
control with model uncertainty, variants of which have been studied in the past, but very little has
been done with forward-looking variables, which are a key component of modern policy-relevant
models. We gain some tractability by taking our model of the economy to be a so-called Markov
jump-linear-quadratic (MJLQ) system, extended to include forward-looking variables. In this setup,
model uncertainty takes the form of different “modes” or regimes that follow a Markov process.
This setup can be adapted to handle many different forms of model uncertainty, but yet provides
a relatively simple structure for analysis.
    In a previous paper, Svensson and Williams [15], we studied optimal policy design in models of
this class when policymakers can or cannot observe the current mode, but we abstracted from any
learning and inference about the current mode. In this paper we focus on learning and inference in
the more relevant situation, particularly for the model-uncertainty applications which interest us, in
which the modes are not directly observable. Thus, decision makers must filter their observations to
make inferences about the current mode. As in most Bayesian learning problems, the optimal policy
thus typically includes an experimentation component reflecting the endogeneity of information.
This class of problems has a long history in economics, and it is well-known that solutions are
difficult to obtain. We develop algorithms to solve numerically for the optimal policy.1 Due to
the curse of dimensionality, the Bayesian optimal policy (BOP) is only feasible in relatively small
models. Confronted with these difficulties, we also consider adaptive optimal policy (AOP).2 In
this case, the policymaker in each period does update the probability distribution of the current
mode in a Bayesian way, but the optimal policy is computed each period under the assumption
that the policymaker will not learn in the future from observations. In our MJLQ setting, the
AOP is significantly easier to compute, and in many cases provides a good approximation to the
    1
      In addition to the classic literature (on such problems as a monopolist learning its demand curve), Wieland
[17]-[18] and Beck and Wieland [1] have recently examined Bayesian optimal policy and optimal experimentation in
a context similar to ours but without forward-looking variables. Tesfaselassie, Schaling, and Eijffinger [16] examine
passive and active learning in a simple model with a forward-looking element in the form of a long interest rate in
the aggregate-demand equation. Ellison and Valla [7] and Cogley, Colacito, and Sargent [3] study situations like
ours but where the expectational component is as in the Lucas-supply curve (Et−1 πt , for example) rather than our
forward-looking case (Et πt+1 , for example). More closely related to our present paper, Ellison [6] analyzes active and
passive learning in a New Keynesian model with uncertainty about the slope of the Phillips curve.
    2
      What we call optimal policy under no learning, adaptive optimal policy, and Bayesian optimal policy has in the
literature also been referred to as myopia, passive learning, and active learning, respectively.
BOP. Moreover, the AOP analysis is of some interest in its own right, as it is closely related to
specifications of adaptive learning which have been widely studied in macroeconomics (see Evans
and Honkapohja [8] for an overview). Further, the AOP specification rules out the experimentation
which some may view as objectionable in a policy context.3
    In this paper, we provide two simple examples, with and without forward-looking variables, to
illustrate the role of learning and experimentation in an MJLQ framework and compare the policy
functions and value functions under NL, AOP, and BOP. Of particular interest is how uncertainty
affects policy, and how learning interacts with the optimal policy decisions. We also diagnose
the aspects of the model which influence the size of experimentation motive, and thus drive the
differences between the Bayesian and adaptive optimal policies.
    MJLQ models have been widely studied in the control-theory literature for the special case when
the model modes are observable and there are no forward-looking variables (see Costa, Fragoso,
and Marques [4] (henceforth CFM) and the references therein).4 More recently, Zampolli [19]
has used such an MJLQ model to examine monetary policy under shifts between regimes with
and without an asset-market bubble. Blake and Zampolli [2] provide an extension of the MJLQ
model with observable modes to include forward-looking variables and present an algorithm for the
solution of an equilibrium resulting from optimization under discretion. Svensson and Williams
[15] provide a more general extension of the MJLQ framework with forward-looking variables and
present algorithms for the solution of an equilibrium resulting from optimization under commitment
in a timeless perspective as well as arbitrary time-varying or time-invariant policy rules, using
the recursive saddlepoint method of Marcet and Marimon [11]. They also provide two concrete
examples: an estimated backward-looking model (a three-mode variant of Rudebusch and Svensson
[13]) and an estimated forward-looking model (a three-mode variant of Lindé [10]). Svensson and
Williams [15] also extend the MJLQ framework to the more realistic case of unobservable modes,
although without introducing learning and inference about the probability distribution of modes,
which is our focus here.
    The paper is organized as follows: Section 2 lays out the basic model an MJLQ system with
forward-looking variables. Sections 3, 4, and 5 specify the optimal policy under no learning (NL),
the adaptive optimal policy (AOP), and the Bayesian optimal policy (BOP). Section 6 provides some
simple examples, and compares the value functions and policy functions for these three alternatives
  3
    In addition, AOP is useful for technical reasons as it gives us a good starting point for our more intensive
numerical calculations in the BOP case.
  4
    do Val and Başar [5] provide an application of an adaptive-control MJLQ problem in economics.



                                                       2
and clarifies the benefits and costs of optimal experimentation.


2        The model

We consider a Markov Jump-Linear-Quadratic (MJLQ) model of an economy with forward-looking
variables. The economy has a private sector and a policymaker. We let Xt denote an nX -vector
of predetermined variables in period t, xt an nx -vector of forward-looking variables, and it an ni -
vector of (policymaker) instruments (control variables).5 We let model uncertainty be represented
by nj possible modes and let jt ∈ Nj ≡ {1, 2, ..., nj } denote the mode in period t. The model of
the economy can then be written

                               Xt+1 = A11jt+1 Xt + A12jt+1 xt + B1jt+1 it + C1jt+1 εt+1 ,                     (2.1)

                       Et Hjt+1 xt+1 = A21jt Xt + A22jt xt + B2jt it + C2jt εt ,                              (2.2)

where εt is a multivariate normally distributed random i.i.d. nε -vector of shocks with mean zero
and contemporaneous covariance matrix Inε . The matrices A11j , A12j , ..., C2j have the appropriate
dimensions and depend on the mode j. As a structural model here is simply a collection of matrices,
each mode can represent a different model of the economy. Thus, uncertainty about the prevailing
mode is model uncertainty.6
        Note that the matrices on the right side of (2.1) depend on the mode jt+1 in period t + 1,
whereas the matrices on the right side of (2.2) depend on the mode jt in period t. Equation (2.1)
then determines the predetermined variables in period t + 1 as a function of the mode and shocks in
period t + 1 and the predetermined variables, forward-looking variables, and instruments in period
t. Equation (2.2) determines the forward-looking variables in period t as a function of the mode and
shocks in period t, the expectations in period t of next period’s mode and forward-looking variables,
and the predetermined variables and instruments in period t. The matrix A22j is invertible for each
j ∈ Nj .
        The mode jt follows a Markov process with the transition matrix P ≡ [Pjk ].7 The shocks εt are
mean zero and i.i.d. with density ϕ, and without loss of generality we assume that εt is independent
jt .8 We also assume that C1j εt and C2k εt are independent for all j, k ∈ Nj . These shocks, along
    5
     The first component of Xt may be unity, in order to allow for mode-dependent intercepts in the model equations.
    6
     See also Svensson and Williams [15], where we show how many different types of uncertainty can be mapped
into our MJLQ framework.
   7
     Obvious special cases are P = Inj , when the modes are completely persistent, and Pj. = p̄0 (j ∈ Nj ), when the
modes are serially i.i.d. with probability distribution p̄.
   8
     Because mode-dependent intercepts (as well as mode-dependent standard deviations) are allowed in the model,
we can still incorporate additive mode-dependent shocks.


                                                         3
with the modes, are the driving forces in the model and they are not directly observed. For technical
reasons, it is convenient but not necessary that they are independent. We let pt = (p1t , ..., pnj t )0
denote the true probability distribution of jt in period t. We let pt|t denote the policymaker’s and
private sector’s estimate of the probability distribution in the beginning of period t. The prediction
equation for the probability distribution is

                                                   pt+1|t = P 0 pt|t .                                     (2.3)

   We let the operator Et [·] in the expression Et Hjt+1 xt+1 on the left side of (2.2) denote expec-
tations in period t conditional on policymaker and private-sector information in the beginning of
period t, including Xt , it , and pt|t , but excluding jt and εt . Thus, the maintained assumption is
symmetric information between the policymaker and the (aggregate) private sector. Since forward-
looking variables will be allowed to depend on jt , parts of the private sector, but not the aggregate
private sector, may be able to observe jt and parts of εt . Note that although we focus on the
determination of the optimal policy instrument it , our results also show how private sector choices
as embodied in xt are affected by uncertainty and learning. The precise informational assumptions
and the determination of pt|t will be specified below.
   We let the policymaker’s intertemporal loss function in period t be
                                         ∞
                                         X
                                    Et          δ τ L(Xt+τ , xt+τ , it+τ , jt+τ )                          (2.4)
                                         τ =0

where δ is a discount factor satisfying 0 < δ < 1, and the period loss, L(Xt , xt , it , jt ), satisfies
                                                            0        
                                                          Xt         Xt
                                L(Xt , xt , it , jt ) ≡  xt  Wjt  xt  ,                                (2.5)
                                                          it         it

where the matrix Wj (j ∈ Nj ) is positive semidefinite. We assume that the policymaker optimizes
under commitment in a timeless perspective. As explained below, we will then add the term

                                                       1
                                                   Ξt−1 Et Hjt xt                                          (2.6)
                                                       δ

to the intertemporal loss function in period t. As we shall see below, the nx -vector Ξt−1 is the
vector of Lagrange multipliers for equation (2.2) from the optimization problem in period t − 1.
For the special case when there are no forward-looking variables (nx = 0), the model consists of
(2.1) only, without the term A12jt+1 xt ; the period loss function depends on Xt , it , and jt only; and
there is no role for the Lagrange multipliers Ξt−1 or the term (2.6).


                                                             4
    We will distinguish three cases: (1) Optimal policy when there is no learning (NL), (2) Adaptive
optimal policy (AOP), and (3) Bayesian optimal policy (BOP). By NL, we refer to a situation when
the policymaker and the aggregate private sector have a probability distribution pt|t over the modes
in period t and updates the probability distribution in future periods using the transition matrix
only, so the updating equation is
                                          pt+1|t+1 = P 0 pt|t .                                  (2.7)

That is, the policymaker and the private sector do not use observations of the variables in the
economy to update the probability distribution. The policymaker then determines optimal policy
in period t conditional on pt|t and (2.7). This is a variant of a case examined in Svensson and
Williams [15].
    By AOP, we refer to a situation when the policymaker in period t determines optimal policy
as in the NL case, but then uses observations of the realization of the variables in the economy to
update its probability distribution according to Bayes Theorem. In this case, the instruments will
generally have an effect on the updating of future probability distributions, and through this channel
separately affect the intertemporal loss. However, the policymaker does not exploit that channel in
determining optimal policy. That is, the policymaker does not do any conscious experimentation.
By BOP, we refer to a situation when the policymaker acknowledges that the current instruments
will affect future inference and updating of the probability distribution, and calculates optimal
policy taking this separate channel into account. Therefore, BOP includes optimal experimentation,
where for instance the policymaker may pursue policy that increases losses in the short run but
improves the inference of the probability distribution and therefore lowers losses in the longer run.


3    Optimal policy with no learning

We first consider the NL case. Svensson and Williams [15] derive the equilibrium under commit-
ment in a timeless perspective for the case when Xt , xt , and it are observable in period t, jt is
unobservable, and the updating equation for pt|t is given by (2.7). Observations of Xt , xt , and it
are then not used to update pt|t .
    It is worth noting what type of belief specification underlies the assumption that the policymaker
does not learn from his or her beliefs. In general this requires the policymaker to have subjective
beliefs which are inconsistent or differ from the true data-generating process. One possibility
would be to assume that the policymaker subjectively (and incorrectly) views modes as being


                                                   5
independently drawn each period, in which case there is no reason to learn. As discussed in detail
in Svensson and Williams [15], following a suggestion from Alexei Onatski, we instead assume
that the policymaker in period t forgets past observations of the economy, such as Xt−1 , Xt−2 , . . .,
when making decisions in period t. Without past observations, the policymaker cannot use current
observations to update the beliefs. This possibility has the advantage that the policymaker need
not view the modes as being independently drawn and can exploit the fact that the true modes
may be serially correlated. However, forgetting past observations implies that the beliefs do not
satisfy the law of iterated expectations. This complication leads to the slightly more complicated
derivations below.
    As a further difference, Svensson and Williams [15] assumed C2jt ≡ 0. With observable modes
or with unobservable modes with no learning, this is an innocuous assumption, since if C2jt 6≡ 0
the vector of predetermined variables and the block of equations for the predetermined variables,
(2.1), can be augmented with the vector Xεt and the equations Xε,t+1 = C2jt+1 εt+1 , respectively.
Here we allow C2jt 6≡ 0 and keep track of the term C2jt εt , since this term will serve as the shock
in the equations for the forward-looking variables, without which inference in some cases becomes
trivial.9


3.1    The general case

It will be useful to replace equation (2.2) by the two equivalent equations,

                         Et Hjt+1 xt+1 = zt ,                                                               (3.1)

                                      0 = A21jt Xt + A22jt xt − zt + B2jt it + C2jt εt ,                    (3.2)

where we introduce the nx -vector of additional forward-looking variables, zt . Introducing this vector
is a practical way of keeping track of the expectations term on the left side of (2.2). Furthermore,
it will be practical to use (3.2) and solve xt as a function of Xt , zt , it , jt , and εt

                     xt = x̃(Xt , zt , it , jt , εt ) ≡ A−1
                                                         22jt (zt − A21jt Xt − B2jt it − C2jt εt ).         (3.3)

We note that, for given jt , this function is linear in Xt , zt , it , and εt .
    In order to solve for the optimal decisions, we use the recursive saddlepoint method (see Marcet
and Marimon [11], Svensson and Williams [15], and Svensson [14] for details of the recursive sad-
dlepoint method). Thus, we introduce Lagrange multipliers for each forward looking equation, the
   9
     Alternatively, we could allow C2jt ≡ 0 and add the corresponding predetermined variables, but then we have to
assume that those predetermined variables are not observable. It turns out that the filtering problem becomes much
more difficult to handle when some predetermined variables as well as modes are unobservable.


                                                           6
lagged values of which become state variables and reflecting costs of commitment, while the current
values become control variables. The dual period loss function can be written
                                                                  X             Z
                         Et L̃(X̃t , zt , it , γt , jt , εt ) ≡         pjt|t       L̃(X̃t , zt , it , γt , j, εt )ϕ(εt )dεt ,
                                                                   j


where X̃t ≡ (Xt0 , Ξ0t−1 )0 is the (nX + nx )-vector of extended predetermined variables (that is,
including the nx -vector Ξt−1 ), γt is an nx -vector of Lagrange multipliers, and ϕ(·) denotes a generic
probability density function (for εt , the standard normal density function), and where

                                                                                                     1
   L̃(X̃t , zt , it , γt , jt , εt ) ≡ L[Xt , x̃(Xt , zt , it , jt , εt ), it , jt ] − γt0 zt + Ξ0t−1 Hjt x̃(Xt , zt , it , jt , εt ).     (3.4)
                                                                                                     δ

    As discussed in Svensson and Williams [15], the failure of the law of iterated expectations
leads us to introduce the collection of value functions V̂ (st , j) which condition on the mode, while
the value function Ṽ (st ) averages over these and represents the solution of the dual optimization
problem. The somewhat unusual Bellman equation for the dual problem can be written
                                  X
Ṽ (st ) = Et V̂ (st , jt ) ≡               pjt|t V̂ (st , j)
                                       j

        = max min Et {L̃(X̃t , zt , it , γt , jt , εt ) + δ V̂ [g(st , zt , it , γt , jt , εt , jt+1 , εt+1 ), jt+1 ]}
             γt   (zt ,it )
                              X             Z ·                                                                     ¸
                                                    L̃(X̃t , zt , it , γt , j, εt )
        ≡ max min                   pjt|t               P                                                               ϕ(εt )ϕ(εt+1 )dεt dεt+1 .
             γt   (zt ,it )     j                   + δ k Pjk V̂ [g(st , zt , it , γt , j, εt , k, εt+1 ), k]
                                                                                                                                           (3.5)

where st ≡ (X̃t0 , p0t|t )0 denotes the perceived state of the economy (it includes the perceived proba-
bility distribution, pt|t , but not the true mode) and (st , jt ) denotes the true state of the economy
(it includes the true mode of the economy). As we discuss in more detail below, it is necessary
to include the mode jt in the state vector because the beliefs do not satisfy the law of iterated
expectations. In the BOP case beliefs do satisfy this property, so the state vector is simply st . Also
note that in the Bellman equation we require that all the choice variables respect the information
constraints, and thus depend on the perceived state st but not the mode j directly.
    The optimization is subject to the transition equation for Xt ,

                     Xt+1 = A11jt+1 Xt + A12jt+1 x̃(Xt , zt , it , jt , εt ) + B1jt+1 it + C1jt+1 εt+1 ,                                   (3.6)

where we have substituted x̃(Xt , zt , it , jt , εt ) for xt ; the new dual transition equation for Ξt ,

                                                                       Ξt = γt ,                                                           (3.7)


                                                                           7
and the transition equation (2.7) for pt|t . Combining equations, we have the transition for st ,
                               
                        Xt+1
             st+1 ≡     Ξt      = g(st , zt , it , γt , jt , εt , jt+1 , εt+1 )
                      pt+1|t+1
                                                                                              
                      A11jt+1 Xt + A12jt+1 x̃(Xt , zt , it , j, εt ) + B1jt+1 it + C1jt+1 εt+1
                  ≡                                         γt                                . (3.8)
                                                             0
                                                          P pt|t
     It is straightforward to see that the solution of the dual optimization problem (3.5) is linear in
X̃t for given pt|t , jt ,
                                                                              
                                   zt       z(st )                      Fz (pt|t )
                                  it  =  i(st )  = F (pt|t )X̃t ≡  Fi (pt|t )  X̃t ,                                                    (3.9)
                                   γt       γ(st )                      Fγ (pt|t )
                xt = x(st , jt , εt ) ≡ x̃(Xt , z(st ), i(st ), jt , εt ) ≡ FxX̃ (pt|t , jt )X̃t + Fxε (pt|t , jt )εt .                      (3.10)

This solution is also the solution to the original primal optimization problem. We note that xt is
linear in εt for given pt|t and jt . The equilibrium transition equation is then given by

                     st+1 = ḡ(st , jt , εt , jt+1 , εt+1 ) ≡ g[st , z(st ), i(st ), γ(st ), jt , εt , jt+1 , εt+1 ].

     As can be easily verified, the (unconditional) dual value function Ṽ (st ) is quadratic in X̃t for
given pt|t , taking the form
                                                 Ṽ (st ) ≡ X̃t0 ṼX̃ X̃ (pt|t )X̃t + w(pt|t ).

The conditional dual value function V̂ (st , jt ) gives the dual intertemporal loss conditional on the
true state of the economy, (st , jt ). It follows that this function satisfies
                     Z ·                                             ¸
                         L̃(X̃t , z(st ), i(st ), γ(st ), j, εt )
       V̂ (st , j) ≡         P                                         ϕ(εt )ϕ(εt+1 )dεt dεt+1                                  (j ∈ Nj ).
                         + δ k Pjk V̂ [ḡ(st , j, εt , k, εt+1 ), k]
The function V̂ (st , jt ) is also quadratic in X̃t for given pt|t and jt ,

                                           V̂ (st , jt ) ≡ X̃t0 V̂X̃ X̃ (pt|t , jt )X̃t + ŵ(pt|t , jt ).

It follows that we have
                                           X                                                      X
                       ṼX̃ X̃ (pt|t ) ≡            pjt|t V̂X̃ X̃ (pt|t , j),      w(pt|t ) ≡             pjt|t ŵ(pt|t , j).
                                                j                                                     j

     The value function for the primal problem, with the period loss function Et L(Xt , xt , it , jt ) rather
than Et L̃(X̃t , zt , it , γt , jt , εt ), satisfies
                                                                       X               Z
                                                                 1
                               V (st ) ≡ Ṽ (st ) −        Ξ0t−1            pjt|t Hj       x(st , j, εt )ϕ(εt )dεt
                                                                   δ
                                                                        j
                                                                   1X
                                       = Ṽ (st ) − Ξ0t−1             pjt|t Hj x(st , j, 0)                                                  (3.11)
                                                                   δ
                                                                        j



                                                                            8
(where the second equality follows since x(st , jt , εt ) is linear in εt for given st and jt ). It is quadratic
in X̃t for given pt|t ,
                                          V (st ) ≡ X̃t0 VX̃ X̃ (pt|t )X̃t + w(pt|t )

(the scalar w(pt|t ) in the primal value function is obviously identical to that in the dual value
function). This is the value function conditional on X̃t and pt|t after Xt has been observed but
before xt has been observed, taking into account that jt and εt are not observed. Hence, the second
term on the right side of (3.11) contains the expectation of Hjt xt conditional on that information.10
    Svensson and Williams [15] present algorithms to compute the solution and the primal and
dual value functions for the no-learning case, with and without forward-looking variables, when
the matrices C2j ≡ 0. For completeness, appendix A presents variants of these algorithms that
incorporate the case when C2jt 6≡ 0. For future reference, we note that the value function for the
primal problem also satisfies
                                                          X
                                              V (st ) ≡              pjt|t V̌ (st , j),
                                                                 j

where the conditional value function, V̌ (st , jt ), satisfies
                Z ½                                             ¾
                    L[Xt , x(st , j, εt ), i(st ), j]
  V̌ (st , j) =        P                                          ϕ(εt )ϕ(εt+1 )dεt dεt+1              (j ∈ Nj ).     (3.12)
                    + δ k Pjk V̌ [ḡ(st , j, εt , k, εt+1 ), k]

3.2     The case without forward-looking variables

For the case without forward-looking variables, the recursive saddlepoint method is not needed, so
matters simplify. The transition equation for Xt+1 is

                                      Xt+1 = Ajt+1 Xt + Bjt+1 it + Cjt+1 εt+1 ,                                       (3.13)

and the period loss function is
                                                                 X
                                       Et L(Xt , it , jt ) ≡              pjt|t L(Xt , it , j),                       (3.14)
                                                                      j


where                                                        ·            ¸0         ·        ¸
                                                                 Xt                      Xt
                                        L(Xt , it , jt ) ≡                     Wjt                .                   (3.15)
                                                                 it                      it
The transition equation is
              ·          ¸                               ·                                  ¸
                  Xt+1                                     Ajt+1 Xt + Bjt+1 it + Cjt+1 εt+1
       st+1 ≡              = g(st , it , jt+1 , εt+1 ) ≡                                      .                       (3.16)
                pt+1|t+1                                               P 0 pt|t
   10
      To be precise, the observation of Xt , which depends on C1jt εt , allows some inference of εt , εt|t . xt will depend on
jt and on εt , but on εt only through C2jt εt . By assumption C1j εt and C2k εt are independent. Hence, any observation
of Xt and C1j εt does not convey any information about C2j εt , so Et C2jt εt = 0.


                                                                 9
The Bellman equation for the optimal policy problem is
                                   X
    V (st ) = Et V̂ (st , jt ) ≡           pjt|t V̂ (st , j)
                                       j

           = min Et {L(Xt , it , jt ) + δ V̂ [g(st , it , jt+1 , εt+1 ), jt+1 ]}
              it
                 X         ·                       X             Z                                        ¸
           ≡ min      pjt|t L(Xt , it , j) + δ             Pjk V̂ [g(st , it , k, εt+1 ), k] ϕ(εt+1 )dεt+1 .               (3.17)
                it      j                                        k


    This results in the optimal policy function,

                                                      it = i(st ) ≡ Fi (pt|t )Xt ,                                         (3.18)

which is linear in Xt for given pt|t . The equilibrium transition equation is then

                                   st+1 = ḡ(st , jt+1 , εt+1 ) ≡ g(st , i(st ), jt+1 , εt+1 ).                            (3.19)

The value function, V (st ), is quadratic in Xt for given pt|t ,

                                             V (st ) = Xt0 VXX (pt|t )Xt + w(pt|t ).

The conditional value function, V̂ (st , jt ), satisfies
                                                  X              Z
        V̂ (st , j) ≡ L[Xt , i(st ), j] + δ                Pjk       V̂ [ḡ(st , k, εt+1 ), k]ϕ(εt+1 )dεt+1   (j ∈ Nj ).
                                                       k



4    Adaptive optimal policy

Consider now the case of adaptive optimal policy, where the policymaker uses the same policy
function as in the no-learning case, but each period updates the probabilities that this policy is
conditioned on. This case is thus simple to implement recursively, as we have already discussed how
to solve for the optimal decisions and below we show how to update probabilities. However, the
ex-ante evaluation of expected loss is more complex, as we show below. In particular, we assume
that C2jt 6≡ 0 and that both εt and jt are unobservable. The estimate pt|t is the result of Bayesian
updating, using all information available, but the optimal policy in period t is computed under
the perceived updating equation (2.7). That is, the fact that the policy choice will affect future
pt+τ |t+τ and that future expected loss will change when pt+τ |t+τ changes is disregarded. Under the
assumption that the expectations on the left side of (2.2) are conditional on (2.7), the variables zt ,
it , γt , and xt in period t are still determined by (3.9) and (3.10).



                                                                      10
4.1      Information revelation

In order to determine the updating equation for pt|t , we specify an explicit sequence of information
revelation as follows, in no less than nine steps. The timing assumptions are necessary in order to
spell out the appropriate conditioning for decisions and updating of beliefs.
       First, the policymaker and the private sector enters period t with the prior pt|t−1 . They know
Xt−1 , xt−1 = x(st−1 , jt−1 , εt−1 ), zt−1 = z(st−1 ), it−1 = i(st−1 ), and Ξt−1 = γ(st−1 ) from the
previous period.
       Second, in the beginning of period t, the mode jt and the vector of shocks εt are realized. Then
the vector of predetermined variables Xt is realized according to (2.1).
       Third, the policymaker and the private sector observe Xt . They then know X̃t ≡ (Xt0 , Ξ0t−1 )0 .
They do not observe jt or εt
       Fourth, the policymaker and the private sector update the prior pt|t−1 to the posterior pt|t
according to Bayes Theorem and the updating equation
                                  ϕ(Xt |jt = j, Xt−1 , xt−1 , it−1 , pt|t−1 )
                        pjt|t =                                               pjt|t−1        (j ∈ Nj ),                   (4.1)
                                     ϕ(Xt |Xt−1 , xt−1 , it−1 , pt|t−1 )

where again ϕ(·) denotes a generic density function.11 Then the policymaker and the private sector
know st ≡ (X̃t0 , p0t|t )0 .
       Fifth, the policymaker solves the dual optimization problem, determines it = i(st ), and imple-
ments/announces the instrument setting it .
       Sixth, the private-sector (and policymaker) expectations,

                                        zt = Et Hjt+1 xt+1 ≡ E[Hjt+1 xt+1 | st ],

are formed. In equilibrium, these expectations will be determined by (3.9). In order to understand
their determination better, we look at this in some detail.
       These expectations are by assumption formed before xt is observed. The private sector and the
policymaker know that xt will in equilibrium be determined in the next step according to (3.10).
Hence, they can form expectations of the soon-to-be determined xt conditional on jt = j,12

                                                     xjt|t = x(st , j, 0).                                                (4.2)
  11                                                                                             P
       The policymaker and private sector can also estimate the shocks εt|t as εt|t =               j pjt|t εjt|t , where εjt|t ≡
Xt − A11j Xt−1 − A12j xt−1 − B1j it−1 (j ∈ Nj ). However, because of the assumed independence of C1j εt and C2k εt ,
j, k ∈ Nj , we do not need to keep track of εjt|t .
   12
      Note that 0 instead of εjt|t enters above. This is because the inference εjt|t above is inference about C1j εt , whereas
xt depends on εt through C2j εt . Since we assume that C1j εt and C2j εt are independent, there is no inference of C2j εt
from observing Xt . Hence, Et C2jt εt ≡ 0. Because of the linearity of xt in εt , the integration of xt over εt results in
x(st , jt , 0t ).


                                                              11
The private sector and the policymaker can also infer Ξt from

                                                        Ξt = γ(st ).                                         (4.3)

This allows the private sector and the policymaker to form the expectations
                                                                     X
                         zt = z(st ) = Et [Hjt+1 xt+1 | st ] =                  Pjk pjt|t Hk xk,t+1|jt ,     (4.4)
                                                                          j,k


where
                                                                              
                   Z      A11k Xt + A12k x(st , j, εt ) + B1k i(st )
     xk,t+1|jt   = x                       Ξt                       , k, εt+1  ϕ(εt )ϕ(εt+1 )dεt dεt+1
                                             0
                                           P pt|t
                                                                      
                        A11k Xt + A12k x(st , j, 0) + B1k i(st )
                 = x                  Ξt                        , k, 0 ,
                                         0
                                       P pt|t

where we have exploited the linearity of xt = x(st , jt , εt ) and xt+1 = x(st+1 , jt+1 , εt+1 ) in εt and
εt+1 . Note that zt is, under AOP, formed conditional on the belief that the probability distribution
in period t + 1 will be given by pt+1|t+1 = P 0 pt|t , not by the true updating equation that we are
about to specify.
    Seventh, after the expectations zt have been formed, xt is determined as a function of Xt , zt ,
it , jt , and εt by (3.3).
    Eight, the policymaker and the private sector then use the observed xt to update pt|t to the new
posterior p+
           t|t according to Bayes Theorem, via the updating equation

                                       ϕ(xt |jt = j, Xt , zt , it , pt|t )
                             p+
                              jt|t =                                       pjt|t       (j ∈ Nj ).            (4.5)
                                          ϕ(xt |Xt , zt , it , pt|t )

    Ninth, the policymaker and the private sector then leave period t and enter period t + 1 with
the prior pt+1|t given by the prediction equation

                                                     pt+1|t = P 0 p+
                                                                   t|t .                                     (4.6)

    In the beginning of period t + 1, the mode jt+1 and the vector of shocks εt+1 are realized, and
Xt+1 is determined by (2.1) and observed by the policymaker and private sector. The sequence of
the nine steps above then repeats itself.
    With the timing laid out, we now provide more detail on the updating equations (4.1) and (4.5),
explicitly writing out the densities. This will help in writing an explicit law of motion for beliefs.



                                                              12
Since C1j εt is a random nX -vector that, for given j, is normally distributed with mean zero and
                       0 ,13 we know that
covariance matrix C1j C1j

                                                                                                    0
       ϕ(Xt |jt = j, Xt−1 , xt−1 , it−1 , pt|t−1 ) ≡ ψ(Xt − A11j Xt−1 − A12j xt−1 − B1j it−1 ; C1j C1j ),                    (4.7)

where                                                               µ         ¶
                                                                 1    1 0 −1
                                     ψ(ε; Σεε ) ≡ p              exp − ε Σεε ε
                                                   (2π)nε |Σεε |      2
denotes the density function of a random nε -vector ε with a multivariate normal distribution with
mean zero and covariance matrix Σεε . Furthermore,
                                               X
                                                                                                           0
  ϕ(Xt |Xt−1 , xt−1 , it−1 , pt|t−1 ) ≡             pjt|t−1 ψ(Xt − A11j Xt−1 + A12j xt−1 + B1j it−1 ; C1j C1j ). (4.8)
                                                j

Thus, we know the details of the updating equation (4.1). Further, since C2k εt is a random nx -vector
                                                                       0 , we know that14
that is normally distributed with mean zero and covariance matrix C2k C2k

                                                                                                   0
                    ϕ(xt |jt = k, Xt , zt , it , pt|t ) ≡ ψ[zt − A21k Xt − A22k xt − B2k it ; C2k C2k ],                     (4.9)
                                                    X
                                                                                                       0
                   ϕ(xt |Xt , zt , it , pt|t ) ≡        pkt|t ψ[zt − A21k Xt − A22k xt − B2k it ; C2k C2k ].                (4.10)
                                                    k
Thus, we know the details of the updating equation (4.5).
       In particular, it follows that we can write the updating equation (4.5) as

                                  p+      +
                                   t|t = Q (st , zt , it , jt , εt )                                                        (4.11)

                                       ≡ [Q+                                  +                            0
                                           1 (st , zt , it , jt , εt ), ..., Qnj (st , zt , it , jt , εt )] ,


where
                                              ψ[Zk (Xt , zt , it , jt , εt ); C2k C2k0 ]
            Q+
             k (st , zt , it , jt , εt ) ≡
                                           P                                             0 pkt|t                (k ∈ Nj )   (4.12)
                                            k pkt|t ψ[Zk (Xt , zt , it , jt , εt ); C2k C2k ]

and
                      Zk (Xt , zt , it , jt , εt ) ≡ zt − A21k Xt − A22k x̃(Xt , zt , it , jt , εt ) − B2k it ,

where we use (3.3) to express xt as a function of Xt , zt , it , jt , and εt , and use this to eliminate xt
from the first argument of ψ(·, ·) in (4.9) and (4.10).
       The transition equation for pt+1|t+1 can then finally be written

                                         pt+1|t+1 = Q(st , zt , it , jt , εt , jt+1 , εt+1 ),                               (4.13)
  13                                                 0
     Assume for simplicity that the rank of C1j C1j     is nX ; if not, for instance when the predetermined variables
include lagged endogenous variables, choose the appropriate nonsingular submatrix and the appropriate subvector of
Xt .
  14                                      0
     Again, assume that the rank of C2k C2k  is nx , or else select the appropriate nonsingular components.


                                                                     13
where Q(st , zt , it , jt , εt , jt+1 , εt+1 ) is defined by the combination of (4.1) for period t + 1 with (3.6),
(4.6), and (4.11). The equilibrium transition equation for the full state vector is then given by
                                
                         Xt+1
               st+1 ≡     Ξt     = ḡ(st , jt , εt , jt+1 , εt+1 )
                        pt+1|t+1
                                                                                           
                        A11jt+1 Xt + A12jt+1 x(st , jt , εt ) + B1jt+1 i(st ) + C1jt+1 εt+1
                    ≡                                   γ(st )                             , (4.14)
                                    Q(st , z(st ), i(st ), jt , εt , jt+1 , εt+1 )
where the third row is given by the true updating equation (4.13) together with the policy function
(3.9). Thus, we note that in this AOP case there is a distinction between the “perceived” transition
equation, which includes the perceived updating equation, (2.7), and the “true” transition equation,
which includes the true updating equation (4.13).
    Note that V (st ) in (3.11), which is subject to the perceived transition equation, (3.8), does not
give the true (unconditional) value function for the AOP case. This is instead given by
                                                          X
                                             V̄ (st ) ≡          pjt|t V̌ (st , j),
                                                             j

where the true conditional value function, V̌ (st , jt ), satisfies
                Z ½                                             ¾
                    L[Xt , x(st , j, εt ), i(st ), j]
  V̌ (st , j) =        P                                          ϕ(εt )ϕ(εt+1 )dεt dεt+1            (j ∈ Nj ).   (4.15)
                    + δ k Pjk V̌ [ḡ(st , j, εt , k, εt+1 ), k]
That is, the true value function V̄ (st ) takes into account the true updating equation for pt|t , (4.13),
whereas the optimal policy, (3.9), and the perceived value function, V (st ) in (3.11), are conditional
on the perceived updating equation (2.7) and thereby the perceived transition equation (3.8). Note
also that V̄ (st ) is the value function after X̃t has been observed but before xt is observed, so it
is conditional on pt|t rather than p+
                                    t|t . Since the full transition equation (4.14) is no longer linear

due to the belief updating (4.13), the true value function V̄ (st ) is no longer quadratic in X̃t for
given pt|t . Thus, more complex numerical methods are required to evaluate losses in the AOP case,
although policy is still determined simply as in the NL case.
    Note that
                           Et Q(st , z(st ), i(st ), jt , εt , jt+1 , εt+1 ) = pt+1|t = P 0 pt|t .                (4.16)

The difference between the true updating equation for pt+1|t+1 , (4.13), and the perceived updating
equation (2.7) is that, in the true updating equation, pt+1|t+1 becomes a random variable from
the point of view of period t, with mean equal to pt+1|t . This is because pt+1|t+1 depends on the
realization of jt+1 and εt+1 . We can hence write the true transition equation for pt+1|t+1 as

                                              pt+1|t+1 = P 0 pt|t + vt+1                                          (4.17)

                                                            14
where
                                vt+1 ≡ Q(st , z(st ), i(st ), jt , εt , jt+1 , εt+1 ) − P 0 pt|t ,                   (4.18)

and thus Et vt+1 = 0. The first term on the right side of (4.17) is the prediction pt+1|t and the
second term is the innovation in pt+1|t+1 that results from the Bayesian updating and depends on
the realization of jt+1 and εt+1 .
    This way of representing beliefs sheds light on the gains from learning. If the conditional value
function V̌ (st , jt ) under NL is concave in pt|t for given X̃t and jt , then by Jensen’s inequality the true
expected future loss under AOP will be lower than the true expected future loss under NL. That
is, the concavity of the value function in beliefs means that learning leads to lower losses. While
it likely that V̌ is indeed concave, as we show in applications, it need not be globally so and thus
learning need not always reduce losses. In some cases the losses incurred by increased variability
of beliefs may offset the expected precision gains. Furthermore, under BOP, it may be possible to
adjust policy so as to further increase the variance of pt|t , that is, achieve a mean-preserving spread
which might further reduce the expected future loss.15 This amounts to optimal experimentation.


4.2     The case without forward-looking variables

For the case without forward-looking variables, again the recursive saddlepoint method is not
needed and the expressions simplify. With the transition equation for the predetermined variables
(3.13) and the period loss function (3.14), the optimal policy in the AOP case is determined as in
the NL case by the solution to (3.17), subject to the perceived transition equation (3.16) and given
by the same policy function, (3.18).
    The optimal policy under AOP is calculated under the perceived updating equation, (2.7). The
true updating equation for pt+1|t+1 is

                                             pt+1|t+1 = Q(st , it , jt+1 , εt+1 ),                                   (4.19)

where
                   Q(st , it , jt+1 , εt+1 ) ≡ [Q1 (st , it , jt+1 , εt+1 ), ..., Qnj (st , it , jt+1 , εt+1 )]0 ,

                                                   Qk (st , it , jt+1 , εt+1 ) ≡
                    ψ[(Ajt+1 − Ak )Xt + (Bjt+1 − Bk )it + Cjt+1 εt+1 ; Ck Ck0 ]         X
           P                                                                        0       Pjk pjt|t .
               j,k Pjk pjt|t ψ[(Ajt+1 − Ak )Xt + (Bjt+1 − Bk )it + Cjt+1 εt+1 ; Ck Ck ]
                                                                                          j

 15
    Kiefer [9] examines the properties of a value function, including concavity, under Bayesian learning for a simpler
model without forward looking variables.


                                                                15
The equilibrium transition equation is then
                                                ·                                      ¸
                                                  Ajt+1 Xt + Bjt+1 i(st ) + Cjt+1 εt+1
                 st+1 = ḡ(st , jt+1 , εt+1 ) ≡                                          .
                                                        Q(st , i(st ), jt+1 , εt+1 )
    The true (unconditional) value function, V̄ (st ), taking into account that pt+1|t+1 will be updated
according to (4.19) and ex post depend on jt+1 and εt+1 , is given by
                                               X
                                    V̄ (st ) ≡   pjt|t V̌ (st , j),
                                                           j

where the true conditional value function V̌ (st , j) satisfies
                                                 X    Z
             V̌ (st , j) = L[Xt , i(st ), j] + δ   Pjk V̌ [ḡ(st , k, εt+1 ), k]ϕ(εt+1 )dεt+1 .
                                                       k

Again, if the conditional value function V̌ (st+1 , jt+1 ) under NL is concave in pt+1|t+1 , the value
function V̄ (st ) under AOP will be lower than under NL.


4.3    A special case when forward-looking variables do not reveal any further
       information

A special case that is simpler to deal with is when the forward-looking equation (2.2) does not vary
with the mode:

                     A21j = A21 ,     A22j = A22 ,         B2j = B2 ,      C2j = 0       (j ∈ Nj ).   (4.20)

That is, the matrices A21 , A22 , and B2 are independent of j, and the matrix C2 = 0, so

                              xt = x̃(Xt , zt , it ) ≡ A−1
                                                        22 (zt − A21 Xt − B2 it ).

In that case, the observation of xt does not reveal any further information about jt . This implies
that the updating equation (4.5) collapses to

                                                     p+
                                                      t|t = pt|t ,

so the prediction equation (4.6) is simply

                                                  pt+1|t = P 0 pt|t .

    In particular, we then have

                                           xt = x(st ) ≡ x̃[Xt , z(st ), i(st )],

                                    pt+1|t+1 = Q(st , zt , it , jt+1 , εt+1 ),

                                        st+1 = g(st , zt , it , γt , jt+1 , εt+1 ),

                          ḡ(st , jt+1 , εt+1 ) ≡ g(st , z(st ), i(st ), γ(st ), jt+1 , εt+1 ).


                                                           16
That is, there is in this case no separate dependence of st+1 and xt on jt and εt beyond st . This
special case also makes the Bayesian optimal policy simpler, as we see below.


5     Bayesian optimal policy

Finally, we consider the BOP case, when optimal policy is determined while taking the updating
equation (4.13) into account. That is, we now allow the policymaker to choose it taking into account
that his actions will affect pt+1|t+1 , which in turn will affect future expected losses. In particular,
experimentation is allowed and is optimally chosen. For the BOP case, there is hence no distinction
between the “perceived” and “true” transition equation.


5.1    The general case

The transition equation for the BOP case is:
                              
                        Xt+1
             st+1 ≡     Ξt     = g(st , zt , it , γt , jt , εt , jt+1 , εt+1 )
                      pt+1|t+1
                                                                                                
                      A11jt+1 Xt + A12jt+1 x̃(st , zt , it , jt , εt ) + B1jt+1 it + C1jt+1 εt+1
                  ≡                                        γt                                   .   (5.1)
                                      Q(st , zt , it , jt , εt , jt+1 , εt+1 )

Then the dual optimization problem can be written as (3.5) subject to the above transition equation
(5.1). However, in the Bayesian case, matters simplify somewhat, as we do not need to compute
the conditional value functions V̂ (st , jt ), which we recall were required due to the failure of the law
of iterated expectations in the AOP case. We note now that the second term on the right side of
(3.5) can be written as
                                                         h                  ¯ i
                                                                            ¯
                                 Et V̂ (st+1 , jt+1 ) ≡ E V̂ (st+1 , jt+1 ) ¯ st .




                                                        17
Since, in the Bayesian case, the beliefs do satisfy the law of iterated expectations, this is then the
same as
                                                                                 ¯ 
  h                 ¯ i                          Xt+1 (jt+1 , εt+1 )                    ¯
                    ¯                                                                   ¯
E V̂ (st+1 , jt+1 ) ¯ st = E  V̂                      Ξt                  , jt+1 ¯¯ st 
                                                                                     
                                           pt+1|t+1 (Xt+1 (jt+1 , εt+1 ))               ¯
                                                                                     ¯                        ¯ 
                                                     Xt+1 (jt+1 , εt+1 )                   ¯                         ¯ 
                                                                                            ¯                         ¯
                              = E E V̂                     Ξt                   , jt+1 ¯ Xt+1 , pt+1|t+1 (Xt+1 ) ¯¯ st
                                                                                           ¯                       
                                                                                           ¯                         ¯ 
                                                 pt+1|t+1 (Xt+1 (jt+1 , εt+1 ))
                                                                         ¯ 
                                                 Xt+1 (jt+1 , εt+1 )             ¯
                                                                                 ¯
                              = E  Ṽ                 Ξt                 ¯ st 
                                                                                 ¯
                                           pt+1|t+1 (Xt+1 (jt+1 , εt+1 ))        ¯
                                  h          ¯ i
                                             ¯
                              = E Ṽ (st+1 ) ¯ st ,

where we use the definition of Ṽ (st ), that Xt+1 is a function of jt+1 and εt+1 , and that pt+1|t+1 is
a function of Xt+1 . Appendix B provides a more detailed proof.
      Thus, the dual Bellman equation for the Bayesian optimal policy is

 Ṽ (st ) = max min Et {L̃(X̃t , zt , it , γt , jt , εt ) + δ Ṽ [g(st , zt , it , γt , jt , εt , jt+1 , εt+1 )]}
             γt (zt ,it )
                          X        Z ·                                                                    ¸
                                        L̃(X̃t , zt , it , γt , j, εt )
          ≡ max min          pjt|t             P                                                            ϕ(εt )ϕ(εt+1 )dεt dεt+1 ,
             γt (zt ,it )  j            + δ k Pjk Ṽ [g(st , zt , it , γt , j, εt , k, εt+1 )]
                                                                                                                                (5.2)

where the transition equation is given by (5.1).
      The solution to the optimization problem can be written
                                                                                        
                          zt                 z(st )                         Fz (X̃t , pt|t )
                  ı̃t ≡  it  = ı̃(st ) ≡  i(st )  = F (X̃t , pt|t ) ≡  Fi (X̃t , pt|t )  ,                                (5.3)
                          γt                 γ(st )                         Fγ (X̃t , pt|t )

                        xt = x(st , jt , εt ) ≡ x̃(Xt , z(st ), i(st ), jt , εt ) ≡ Fx (X̃t , pt|t , jt , εt ).                 (5.4)

Because of the nonlinearity of (4.13) and (5.1), the solution is no longer linear in X̃t for given pt|t .
The dual value function, Ṽ (st ), is no longer quadratic in X̃t for given pt|t . The value function of
the primal problem, V (st ), is given by, equivalently, (3.11), (4.15) (with the equilibrium transition
equation (4.14) with the solution (5.3)), or
                    X       Z ½                                         ¾
                                L[XP t , x(st , j, εt ), i(st ), j]
          V (st ) =   pjt|t                                               ϕ(εt )ϕ(εt+1 )dεt dεt+1 .                             (5.5)
                                + δ k Pjk V [ḡ(st , j, εt , k, εt+1 )]
                          j

It it is also no longer quadratic in X̃t for given pt|t . Thus, more complex and detailed numerical
methods are necessary in this case to find the optimal policy and the value function. Therefore

                                                                 18
little can be said in general about the solution of the problem. Nonetheless, in numerical analysis
it is very useful to have a good starting guess at a solution, which in our case comes from the AOP
case. In our examples below we explain in more detail how the BOP and AOP cases differ, and
what drives the differences.


5.2   The case without forward-looking variables

In the case without forward-looking variables, the transition equation for st+1|t+1 is
                                                        ·                                      ¸
                                                            Ajt+1 Xt + Bjt+1 it + Cjt+1 εt+1
                   st+1 = g(st , it , jt+1 , εt+1 ) ≡                                              ,
                                                                  Q(st , it , jt+1 , εt+1 )

and the optimal policy is determined by the Bellman equation

        V (st ) = min Et {[L(Xt , i(st ), jt ) + δV [g(st , it , jt+1 , εt+1 )]}
                   it
                      X         ½                     X            Z                                   ¾
                = min      pjt|t L(Xt , it , j) + δ          Pjk V [g(st , it , k, εt+1 )]ϕ(εt+1 )dεt+1 .
                   it     j                                  k


This results in the optimal policy function

                                               it = i(st ) ≡ Fi (st ).

Again, because of the nonlinearity of Q(st , it , jt+1 , εt+1 ), the optimal policy function is no longer
linear in Xt for given pt|t , and the value function is no longer quadratic in Xt for given pt|t . The
equilibrium transition equation is

                              st+1 = ḡ(st , jt+1 , εt+1 ) ≡ g(st , i(st ), jt+1 , εt+1 ).


5.3   The special case when forward-looking variables do not reveal any further
      information

As above, the special case (4.20) makes it unnecessary to deal with the details of the updating
equation (4.11) and the separate dependence of st+1 on jt and εt . The transition equation is simply
                                  
                           Xt+1
                st+1 ≡      Ξt     = g(st , zt , it , γt , jt+1 , εt+1 )
                          pt+1|t+1
                                                                                          
                          A11jt+1 Xt + A12jt+1 x̃(st , zt , it ) + B1jt+1 it + C1jt+1 εt+1
                     ≡                                    γt                              .
                                          Q(st , zt , it , jt+1 , εt+1 )



                                                            19
5.4     Bayesian optimal policy with endogenous mode transition

In the baseline formulation of the model, the mode transition matrix is given, so the model uncer-
tainty represented by the Markov chain of the modes is independent of the state of the economy
and the policy choice. However, in some situations it is natural to think of the state or the policy
as influencing the likelihoods of the different modes. Assume now that the mode transition prob-
abilities are instead endogenous and do depend on Xt , xt , and it . That is, the transition matrix
depends on Xt , xt , and it ,
                                    P = P (Xt , xt , it ) ≡ [Pjk (Xt , xt , it )] .

Such dependence would ruin the tractability of our NL case (and thus make more difficult the AOP
case as well), which exploited the exogeneity of the modes. However, as we need to go for numerical
solutions in the BOP case anyway, these further complications are of less consequence.
    Let
                            P̃ (Xt , zt , it , jt , εt ) ≡ P [Xt , x̃(Xt , zt , it , jt , εt ), it ],

where we have used (3.3). Then equation (4.6) is replaced by

                                         pt+1|t = P̃ (Xt , zt , it , jt , εt )0 p+
                                                                                 t|t ,                  (5.6)

and (5.6) is used instead of (4.6) in the definition of Q(st , zt , it , jt , εt , jt+1 , εt+1 ). Furthermore,
everywhere, Pjk is replaced by P̃jk (Xt , zt , it , jt , εt ). The rest of the problems remains the same.
Thus, formally, the extension to endogenous mode transitions is easy. However, as we have noted,
the simplicity of the NL and AOP cases vanishes.


6     Examples

In this section we present some simple examples which help to illuminate the benefits of learning and
experimentation. First we consider a backward-looking case, then add forward-looking components.


6.1     A backward-looking example

6.1.1     The model and benchmark specification

We consider the simplest possible example, where nX = 1, nx = 0, ni = 1, nε = 1, and Nj = {1, 2},

                                  Xt+1 = Ajt+1 Xt + Bjt+1 it + Cjt+1 εt+1 ,


                                                              20
where εt is normally distributed with zero mean and unit variance. In our benchmark specification,
we assume that A1 = A2 = 1 and C1 = C2 = 1, so

                                          Xt+1 = Xt + Bjt+1 it + εt+1 .

Furthermore, B1 = − 1.5 and B2 = − 0.5. That is, the instrument it has a larger negative effect on
Xt+1 in mode 1 than in mode 2. We assume that the modes are quite persistent,
                             ·                 ¸ ·              ¸
                                 P11   1 − P11       0.98 0.02
                        P ≡                      =                .
                               1 − P22   P22         0.02 0.98

Below we consider some sensitivity analysis to see how the results vary as we vary the different
parameters. We also consider briefly the case where the uncertainty is over the state persistence
coefficient A rather than the response to the instrument B.
       It follows that the stationary distribution of the modes satisfies p̄ ≡ (p̄1 , p̄2 )0 = (0.5, 0.5)0 . We
note that the predicted probability of mode 1 in period t + 1, p1,t+1|t , is similar to the perceived
probability of mode 1 in period t, since the modes are so persistent,

                         p1,t+1|t = p1t|t P11 + (1 − p1t|t )(1 − P22 ) = 0.02 + 0.96p1t|t .              (6.1)

We finally assume that the period loss function satisfies

                                                       1
                                                   Lt = Xt2 .
                                                       2

For this simple example, the state st ≡ (Xt0 , p0t|t )0 can be represented by (Xt , p1t )0 , where we write
p1t for p1,t|t , the perceived probability of mode 1 in period t.
       Figure 6.1, panel a, shows the resulting value function V (Xt , p1t ) for the optimal policy under
no learning (NL), as a function of p1t for three different values of Xt .16 Panel b shows the value
function for the Bayesian optimal policy (BOP) as a function of p1t , for the same three different
values of Xt . Panel c plots the difference between the loss under BOP and NL. We see that the
loss under BOP is significantly lower than under NL, albeit less so for high values of p1t . Panel d
shows the difference between the loss under BOP and the adaptive optimal policy (AOP). We see
that the loss under BOP is lower than under AOP, but only modestly so.
       Taken together, these results show that there is indeed benefit from learning in this example,
although the additional benefits from experimentation are quite modest here. By moving from the
NL case to AOP, and thus updating beliefs, policymakers are able to capture most of the benefit
  16
    The example is solved with collocation methods via modifications of some of the programs of the CompEcon
Toolbox described by Miranda and Fackler [12]


                                                        21
Figure 6.1: Losses from no learning (NL), adaptive optimal policy (AOP), and Bayesian optimal
policy (BOP)

                             a. Loss: No learning (NL)                     b. Loss: Bayesian optimal policy (BOP)
                      25                                                   20

                                                                                                     Xt=0
                      20




                                                                    Loss
                                                                           15                        Xt=1.43
               Loss




                                                                                                     Xt=3.57
                      15

                                                                           10
                                                                             0               0.5                1
                      10                                                                     p1t
                        0              0.5               1
                                       p1t
                            c. Loss difference: BOP−NL                           d. Loss differences: BOP−AOP
                   −0.5                                                    0

                      −1
                                                                    −0.2
                   −1.5
            Loss




                                                             Loss


                                                                    −0.4
                      −2
                                                                    −0.6
                   −2.5

                      −3                                            −0.8
                        0              0.5               1              0                    0.5                1
                                       p1t                                                   p1t




of the fully Bayesian optimal policy. The additional incremental improvement from AOP to BOP,
arising from the experimentation motive, is much less significant. Thus, the AOP, which is relatively
simple to compute and to implement recursively in real time, provides a good approximation to
the fully optimal policy. Of course, these conclusions are dependent on the particular parameters
chosen for this simple example, but as we show below we have found similar qualitative results in
a number of other examples that we have analyzed.
   Figure 6.2 shows the corresponding optimal policy functions. Panel a shows the optimal policy
under NL as a function of Xt for three different values of p1t . For given p1t , the optimal policy
function under NL is linear in Xt . Panel b shows the optimal policy function under BOP. On this
scale, the nonlinearity in Xt for given p1t is not apparent. Panel c shows the difference between
the optimal policy under BOP and NL. Here we see that the Bayesian optimal policy is indeed
nonlinear in Xt for given p1t . Panel d plots the difference in the policies for all p1t and all Xt in the
interval [− 5, 5]. We see that the difference is largest for small p1t , where the Bayesian optimal policy


                                                             22
           Figure 6.2: Policy for no learning (NL) and Bayesian optimal policy (BOP)

                         a. Policy: No learning (NL)                 b. Policy: Bayesian optimal policy (BOP)
                  10                                                   10

                   5                                                    5

                                                                        0                     p =0.083




                                                                it
                   0                                                                           1t
             t
           i




                                                                                              p =0.5
                                                                      −5                       1t
                  −5                                                                          p =0.92
                                                                                               1t
                                                                     −10
                 −10                                                   −5              0                 5
                   −5                0                 5                               X
                                                                                          t
                                     Xt
                        c. Policy difference: BOP−NL                    d. Policy difference: BOP−NL
                   1
                                                                  2
                  0.5

                                                                  0
                                                           it
                   0
            t
           i




                 −0.5                                            −2
                                                                  1
                                                                                                             5
                                                                            0.5                 0
                  −1
                   −5                0                 5                     p1t   0 −5       Xt
                                     Xt




responds more aggressively (it is larger for positive values of Xt and smaller for negative values)
than the adaptive policy. We discuss below how more aggressive policies can sharpen inference,
and thus lessen future expected losses. But first we see how our results vary with the parameters
of the model.


6.1.2   Sensitivity analysis

In order to better determine what drives the gains from learning and experimentation, we now
consider some variations on the benchmark specification of the model. In each of the cases to
follow we will report the losses and loss differences at a particular point in the state space, namely
the center of it where Xt = 0 and p1,t|t = 0.5. As we have seen above, the differences may be
larger at other points in the space, but this provides a natural reference point and a convenient
way to summarize each loss function by a single number. Further, in what follows we change each
parameter one at a time, and thus we do not capture any potential interaction effects between the
different parts of the model.


                                                           23
Figure 6.3: Losses and loss differences from no learning (NL), adaptive optimal policy (AOP), and
Bayesian optimal policy (BOP) when the coefficient B2 varies.

                                               a. Loss                                              b. Loss differences
                                                                                     0
                     13.5                 NL
                                          AOP
                      13
                                                                                   −0.5
                                          BOP
                     12.5

                      12                                                            −1

                     11.5

                      11                                                           −1.5                 BOP−NL
                                                                                                        BOP−AOP
                     10.5

                                                                                    −2
                            −1.4   −1.2        −1        −0.8   −0.6   −0.4               −1.4   −1.2     −1        −0.8   −0.6   −0.4
                                                    B2                                                         B2




   For our first experiment, we see how the gains from learning and experimentation vary as
we vary the degree of differences across the modes. Thus, we fix B1 = −1.5 and vary B2 , with
our results shown in figure 6.3. As expected, when B1 and B2 are close together, there is little
difference among the losses in the NL, AOP, and BOP cases. But as the difference increases, here
by making B2 smaller in magnitude, the gains from learning increase sharply, as the gap between
the NL and AOP cases becomes visible in panel a. However, the gains from experimentation
remain negligible until the difference in the coefficients across modes becomes more extreme. This
is clear in panel b, where we see that the composite gains from learning and experimentation (BOP
minus NL) are mostly due to learning, as the gap between BOP and AOP is near zero except at
the rightmost edge of the figure. Thus, learning is beneficial even for moderate differences across
modes, while experimentation only has noticeable benefits for more extreme uncertainty. But even
in this more extreme range, the gains from experimentation are significantly smaller than the gains
from learning.
   In the next group of experiments, we keep the response coefficients fixed at B1 = −1.5 and
B2 = −0.5 as in our benchmark specification, but vary other aspects of the model. First, we change
the state persistence coefficient A1 = A2 = A which was fixed at 1 in our benchmark specification.
Our results in figure 6.4 show that when A is small, so that the state has less exogenous persistence,
the gains from learning and experimentation are low. This is to be expected, as the gains from
updating beliefs relate are due to improved knowledge which will help to make policy more accurate
in the future. But if there is little persistence in the state, then actions today have little consequence



                                                                              24
Figure 6.4: Losses and loss differences from no learning (NL), adaptive optimal policy (AOP), and
Bayesian optimal policy (BOP) when A1 = A2 = A varies (and B varies across modes).

                                           a. Loss                                                         b. Loss differences
                                                                                           0
                    13.5                 NL
                     13                  AOP
                                                                                        −0.5
                    12.5                 BOP

                     12                                                                  −1
                    11.5

                     11                                                                 −1.5                 BOP−NL
                    10.5                                                                                     BOP−AOP
                                                                                         −2
                           0     0.2     0.4      0.6          0.8         1                   0     0.2      0.4     0.6         0.8         1
                                                 A                                                                   A




Figure 6.5: Losses and loss differences from no learning (NL), adaptive optimal policy (AOP), and
Bayesian optimal policy (BOP) when P11 = P22 varies (and B varies across modes).

                                               a. Loss                                                      b. Loss differences
                                                                                          0
                     13




                    12.5                                                                −0.5




                     12                  NL                                              −1

                                         AOP                                                                 BOP−NL

                                         BOP                                                                 BOP−AOP

                    11.5                                                                −1.5
                           0.5     0.6     0.7           0.8         0.9       1               0.5     0.6       0.7        0.8         0.9       1
                                             P                                                                     P
                                                  11                                                                 11




for the future, and thus more accurate beliefs bring little or no gains. However, as the state becomes
more persistent, the gains from learning increase substantially. The gains from experimentation
become noticeable as well once the state becomes sufficiently persistent, but once again they are
dwarfed by the gains from learning.
   Along similar lines, we next consider the effects of the persistence of modes. We keep the
transition matrix diagonal and symmetric, and vary the persistence as measured by P11 = P22
which is set at 0.98 in the benchmark specification. Not surprisingly, when the modes are i.i.d. or
nearly so, and thus P11 is near 0.5, there are no gains from learning or experimentation. Similarly
to the previous case, there is no gain from increased accuracy of beliefs about the current mode if



                                                                                   25
Figure 6.6: Losses and loss differences from no learning (NL), adaptive optimal policy (AOP), and
Bayesian optimal policy (BOP) when C1 = C2 = C varies (and B varies across modes).

                                     a. Loss                             b. Loss differences
                     80                                        0
                               NL
                     70                                       −1
                               AOP
                     60
                               BOP                            −2
                     50
                                                              −3
                     40
                                                              −4
                     30
                                                              −5
                     20                                                  BOP−NL

                     10                                       −6         BOP−AOP

                     0                                        −7
                     0.5   1          1.5      2   2.5         0.5   1          1.5            2   2.5
                                       C                                         C




this knowledge has no consequence, which is the case here as the mode is about as likely to change
as it is to stay the same. As the modes become more persistent, the gains from learning increase
substantially while again the gains from experimentation are only sizeable at the very edge of the
range considered when modes are nearly permanent. But once again the experimentation gains are
much smaller in magnitude than the gains from learning, even when the modes are very persistent.
One additional interesting aspect of this case is that as the modes become more persistent the
level of the loss in the NL case increases, while it falls in the AOP and BOP cases. By exploiting
the better knowledge of modes which comes with updating beliefs, in these cases policymakers are
better able to tailor policy to the prevailing mode.
   The final parameter variation we consider is the amount of volatility in the model, as measured
by C1 = C2 = C. In our benchmark specification this is fixed at 1, but we now see what happens
when the model is more or less variable. Not surprisingly, as we increase the variability, losses
increase substantially in all cases. Moreover, the increases are nearly proportional in all the three
cases. In absolute terms, the gains from learning increase sizeably as the variability increases,
although by a much smaller amount as a percentage of the overall loss. Similarly, the absolute
gains from experimentation are larger with more variability, but again much less so as a proportion
of the total loss.
   All of the above experiments considered the case where the policy response coefficient B varied
across modes, which is perhaps the most natural starting case. However, now we analyze situations
in which B is constant across modes (at −1.5) but the state persistence coefficient A varies. In



                                                         26
Figure 6.7: Losses and loss differences from no learning (NL), adaptive optimal policy (AOP), and
Bayesian optimal policy (BOP) when A2 varies (and differs from A1 = 1).

                                    a. Loss                                     b. Loss differences
                    26                                               0
                                                    NL
                    24                                             −2
                                                    AOP
                    22                              BOP            −4
                    20
                                                                   −6
                    18
                                                                   −8
                    16
                                                                   −10
                    14                                                                         BOP−NL
                    12                                             −12                         BOP−AOP

                                                                   −14
                         −0.5   0             0.5         1              −0.5      0           0.5       1
                                      A2                                                A2




particular, we fix A1 = 1 and see what results when A2 takes on different values. (The rest of the
parameters are the same as in the benchmark specification.) Figure 6.7 summarizes our results,
which in qualitative terms are quite similar to our previous findings. When A2 is close to A1 , of
course there is once again little gain from having sharper inference about modes. As the difference
between A1 and A2 increases (as A2 falls) the gains from learning grow substantially. Once again,
only when the differences across modes are quite extreme are there sizeable experimentation gains,
which yet again are significantly smaller than the gains from learning.
   In summary, in all of the cases we have considered, the gains from learning and the gains from
experimentation both increase in the situations where one would expect sharper inference to be
beneficial. As the differences across modes grow larger, in the benchmark case where the instrument
response coefficient B varies across modes as well as the case where the state persistence coefficient
A varies, then the optimal policies conditional on each mode grow more different, and thus there are
more gains from correctly inferring the current mode. Similarly, the gains from sharper inference
increase as the effects of the current mode are longer lasting, either due to increased persistence
in the state through A or more directly through increased persistence of the modes themselves
through the transition matrix P . In all these cases the gains from learning are significant even for
relatively modest amounts of uncertainty, while the gains from experimentation are only noticeable
for more extreme uncertainty.




                                                              27
                     Figure 6.8: Probability density of Xt+1 and updating of pt+1|t+1

                                                                               b. ψ(Zt+1| p1,t+1|t=0.5, Xt, it=0.8)
                         a. ψ(Zt+1| k, Xt, it=0.8)
                                                                         0.5
                                                          k=1            0.4
               0.4                                        k=2
               0.3                                                       0.3
               0.2
                                                                         0.2
               0.1
                                                                         0.1
                0
                −5                  0                           5
                          Zt+1 ≡ Xt+1 − EtXt+1                            0
                                                                          −5                   0                      5
                                                                                     Zt+1 ≡ Xt+1 − EtXt+1

                                  c. p1,t+1|t+1                                              d. p1,t+1|t+1
                1                                                         1
                                                  i =0.8                                                     i =0.8
                                                      t                                                          t
                                                                                                             i =1.4
                                                                                                                 t
               0.5                                                       0.5



                0                                                         0
                −5                     0                        5         −5                      0                   5
                          Z       ≡X        −EX                                      Z       ≡X        −EX
                            t+1       t+1     t t+1                                    t+1       t+1     t t+1




6.2   The interaction of learning and control

In order to better understand the nature of the different solutions and the role of learning, we
consider figures 6.8 and 6.9 which depict how beliefs respond to different policies (all the calculations
in this section use our benchmark specification). First, figure 6.8 shows the components of the
Bayesian updating rule. Panel a shows the conditional density function of the innovation in Xt+1 ,
Zt+1 ≡ Xt+1 − Et Xt+1 , conditional on the mode jt+1 ≡ k where k = 1 or 2 in period t + 1, for given
Xt and it . Here Xt is set equal to 1, and it is set equal to 0.8; this value for it is approximately the
optimal policy under NL for Xt = 1 and p1,t+1|t = p1t|t = p̄1 = 0.5. Panel b shows the unconditional
(that is, not conditional on k) density function of the innovation in Xt+1 , for Xt = 1, it = 0.8, and
p1,t+1|t = 0.5. Panel c plots the resulting updated p1,t+1|t+1 as a function of the innovation in Xt+1 .
By Bayes Theorem, it is given by the ratio of the density of the innovation conditional on k = 1
to the unconditional density of the innovation multiplied by the period-t prediction of mode 1 in




                                                                    28
                                Figure 6.9: Probability density of pt+1|t+1

                    a. φ(p1,t+1|t+1| k, Xt, it=0.8)            b. φ(p1,t+1|t+1| p1,t+1|t=0.5, Xt, it=0.8)
               3                                               3

               2
                                                               2

               1
                                    k=1                        1
                                    k=2
               0
                0                0.5                  1
                              p1,t+1|t+1                       0
                                                                0                 0.5                 1
                                                                               p1,t+1|t+1
                    c. φ(p1,t+1|t+1| k, Xt, it=1.4)            d. φ(p1,t+1|t+1| p1,t+1|t=0.5, Xt, it=1.4)
               3                                               3


               2                                               2


               1                                               1


               0                                               0
                0                0.5                  1         0                 0.5                 1
                              p1,t+1|t+1                                       p1,t+1|t+1




period t + 1, p1,t+1|t = 0.5,

                                           ψ(Xt+1 − Et Xt+1 | k = 1, Xt , it )
                         p1,t+1|t+1 =                                             p        .                (6.2)
                                           ψ(Xt+1 − Et Xt+1 | p1,t+1|t , Xt , it ) 1,t+1|t

We see that p1,t+1|t+1 is decreasing in Xt+1 − Et Xt+1 . The larger the innovation in Xt+1 , the less
likely the mode 1, since, for a given positive it , mode 1 is associated with a larger negative effect
of it on Xt+1 and hence, everything else equal, a lower Xt+1 . This is apparent in panel a, where
the probability density of the innovation conditional on mode 1 is to the left of the density of the
innovation conditional on mode 2.
   Suppose now that the policymaker increases the value of the policy instrument, say from 0.8
to 1.4. Then, a larger value of the policy instrument multiplies the mode-dependent coefficient
Bjt+1 . As a result, the conditional probability densities in panel a move further apart, and the
unconditional density in panel b becomes more spread out. As a result, the updated p1,t+1|t+1
becomes more sensitive to the innovation. This is shown in panel d, where p1,t+1|t+1 as a function
of the innovation is plotted for both it = 0.8 and it = 1.4. Thus, with a larger absolute value of the

                                                          29
                                Figure 6.10: Loss from adaptive optimal policy (AOP)


                              a. Loss: Adaptive optimal policy (AOP)                        b. Loss: Adaptive optimal policy (AOP)
                         20

                         18                                                            30
                                                                 X =0
                         16                                       t
                  Loss




                                                                                Loss
                                                                 Xt=1.43               20
                         14                                      Xt=3.57
                         12                                                            10
                                                                                        5
                         10                                                                                                          1
                           0        0.2    0.4            0.6    0.8       1                     0                      0.5
                                                 p                                                Xt    −5 0          p1t
                                                     1t




instrument, for a given realization of the innovation, the updated p1,t+1|t+1 is closer to the extremes
of 0 or 1. The policymaker becomes less uncertain about the mode in period t + 1. In this sense,
we can say that a larger instrument setting improves the updating and learning of the distribution
of the modes. Thus, if the policymaker perceives that learning is beneficial, he or she would in this
example be inclined to experiment by pursuing more aggressive policy, in the sense of increasing
the magnitude of the instrument for a given Xt .
    We will return shortly to the issue of when learning and experimentation is beneficial. But
first, we note that, given the conditional and unconditional distribution of the innovation in Xt+1
illustrated in figure 6.8, panels a and b, and the relation between the updated probability p1,t+1|t+1
and the realization of the innovation in Xt+1 illustrated in panel c, we can infer the conditional
and unconditional probability densities of p1,t+1|t+1 .17 These are shown in figure 6.9, panels a and
b, respectively, for it = 0.8. Furthermore, panels c and d show the conditional and unconditional
probability densities of p1,t+1|t+1 when it is increased to 1.4. Comparing panels c and a, we see that
a higher absolute value of the instrument moves the conditional densities of beliefs further apart.
Thus, with a more aggressive policy, beliefs are much more sharply concentrated around the truth.
Comparing panels d and b, we see that the unconditional density is further spread out, and in this
case becomes bimodal. Thus, the mass of the unconditional distribution is closer to the extremes,
0 and 1, indicating that the uncertainty about the mode in period t + 1 falls.
  17
      If ψp (p) and ψZ (Z) denote the probability densities of scalars p and Z, and p is an invertible and continuously
differentiable function of Z, p = Q(Z), the densities are related by

                                                          ψp (p) = ψZ (Q−1 (p))dQ−1 (p)/dp.




                                                                           30
   When is learning beneficial? In order to understand this, we again look at figure 6.1, panel a,
which shows the value function under NL, as a function of p1,t|t for three different values of Xt .
Consider a policymaker in period t, with the perceived probability of mode 1 in period t equal to 0.5,
so p1,t|t = 0.5. Since 0.5 is the stationary probability for this Markov chain, this also means that the
period-t predicted probability of mode 1 in period t + 1, given by (6.1), is also 0.5. Under NL, the
policymaker’s predicted and updated probabilities are the same, p1,t+1|t+1 = p1,t+1|t . Thus, in this
case the conditional and unconditional probability distributions of p1,t+1|t+1 in figure 6.9, panels a
and b, are the same and are simply given by a spike with unit probability mass for p1,t+1|t+1 = 0.5.
   Under adaptive optimal policy (AOP), the policymaker applies the same policy function as under
NL, but now he uses Bayes Theorem to update the perceived probability of mode 1, p1,t+1|t+1 , after
observing the innovation in Xt+1 at the beginning of period t+1. That is, from the vantage point of
period t, the updated probability p1,t+1|t+1 in period t + 1 is a random variable with the probability
density shown in figure 6.9, panel b. As discussed above, the mean of this probability density is the
predicted probability, p1,t+1|t = 0.5. Comparing the perceived probability distribution of p1,t+1|t+1
under AOP with what prevails under NL, we see a dramatic mean-preserving spread, from a spike
with unit mass at 0.5 to the spread-out probability density shown in panel b.
   As discussed above, such a mean-preserving spread reduces the intertemporal loss if the value
function under NL is strictly concave as function of p1,t+1|t+1 . In this case Jensen’s inequality
implies that the expected future loss falls when the future beliefs become more dispersed. In
figure 6.1, panel a, we see that the value function under NL indeed is concave, more so for higher
values of Xt+1 and lower values of p1,t+1|t+1 , but also in the vicinity of p1,t+1|t+1 = 0.5. Thus,
we understand why the loss is lower under AOP, where the policymaker follows the same policy
function, it+1 = F (Xt+1 , p1,t+1|t+1 ), as under NL but updates the probability of mode 1 according
to (6.2).
   Under AOP, the policymaker does not consider adjusting the policy in order to change the
shape of the density of p1,t+1|t+1 and thereby improve the future precision of beliefs. Our previous
discussion of figure 6.9 has revealed that increasing the absolute value of the instrument in this
example will lead to a larger mean-preserving spread. In the case of increasing the instrument from
0.8 to 1.4, this increases the spread from that of the density in panel b to the that of the density in
panel d. The value function under AOP is shown in figure 6.10. Compared with the value function
under NL in panel a of figure 6.1, it is more concave for low values of p1,t|t and somewhat flatter
for higher values.


                                                  31
       Now, in the BOP case, the policymaker considers the influence of his policy on inference. Thus,
he has the option of increasing the magnitude of the policy instrument somewhat, in order to
increase the mean-preserving spread of the density of p1,t+1|t+1 , the benefit of which depends on
the concavity of the AOP value function. The cost of this is an increase in the expected period loss
in period t + 1 from its minimum. The result of the optimal tradeoff is shown in panels c and d
of figure 6.2 above. In this particular example, the policymaker chooses not to deviate much from
the policy under NL and AOP. That is, he does not experiment much, except for small values of
p1,t+1|t ≈ p1t|t where incidentally the concavity of the value function under AOP is the largest.18
Furthermore, from figure 6.1, panels c and d, we see that the fall in the intertemporal loss from
AOP to BOP is quite modest, and most of the fall in the loss arises in moving from NL to AOP.
       Thus, in this example, the main benefit from learning arises without any experimentation.
Although the amount of experimentation, measured as the policy difference between BOP and
AOP, is substantial for low values of p1t|t , the benefit in terms of additional loss is quite small. As
we have seen in our sensitivity analysis, this holds true for most of the other parameterizations as
well, and only when there are extreme differences across modes are the gains from experimentation
sizeable. Furthermore, in the above example there is no direct cost whatsoever of a large instrument
or a large change in the instrument. If such a cost is added, the magnitude and the benefits of
experimentation (moving from AOP to BOP) shrink, whereas there is still substantial benefits from
learning (moving from NL to AOP).


6.3      A forward-looking example

We now turn to a closely related example with forward-looking elements. The main implications
of the backward-looking example are preserved, with one important qualification. The Lagrange
multiplier associated with the equation for the forward-looking variable becomes a state variable,
and this introduces some changes in the optimal policy in response to movements in this new
multiplier state Ξt−1 . Rather than being symmetric around Xt = 0, in the forward-looking case
policies become asymmetric when Ξt−1 6= 0.
       The example here is perhaps the simplest possible in the forward-looking case. There is one
predetermined variable, one forward-looking variable, and two modes. The transition equation for
  18
    The approximation p1,t+1|t ≈ p1t|t is justified by (6.1). Because the modes are so persistent, the predicted
probability is close to the current perceived probability.




                                                      32
Figure 6.11: Losses from no learning (NL), adaptive optimal policy (AOP), and Bayesian optimal
policy (BOP) for the forward-looking example with Ξt−1 = 0.

                             a. Loss: NL, Ξt−1 = 0                                               b. Loss: BOP, Ξt−1 = 0
                     25                                                                 25
                                                                                                                            Xt =0
                                                                                                                            Xt =2
                     20                                                                 20                                  Xt =3




                                                                                 Loss
              Loss




                     15                                                                 15

                                                                                        10
                     10
                                                                                         5
                      5                                                                   0     0.2    0.4            0.6   0.8     1
                       0    0.2    0.4            0.6     0.8    1                                           p1t
                                         p
                                             1t

                           c. Loss difference: BOP-NL                                         d. Loss differences: BOP-AOP
                  −0.5                                                                  0

                     −1
                                                                                  −0.1
                  −1.5
           Loss




                                                                          Loss

                                                                                  −0.2
                     −2
                                                                                  −0.3
                  −2.5

                     −3                                                           −0.4
                       0    0.2    0.4            0.6     0.8    1                    0         0.2    0.4            0.6   0.8     1
                                         p                                                                   p
                                          1t                                                                     1t




the predetermined variable and the equation for the forward-looking variable are:

                                                        Xt+1 = Bjt+1 it + εt+1 ,                                                        (6.3)

                                                   Et xt+1 = Xt + xt .                                                                  (6.4)

   In the backward-looking example above, the uncontrolled system was a random walk which
policy stabilized. The current system is similar, in that the jump variable xt is essentially a random
walk in the absence of control. As in the backward-looking case, we suppose that the instrument
is more effective in mode 1:
                                                    B1 = − 1.5,           B2 = − 0.5.

Again, we assume that the modes are highly persistent with transition matrix:
                                         ·             ¸
                                           0.98 0.02
                                    P =                  .
                                           0.02 0.98



                                                                     33
Figure 6.12: Policy for no learning (NL) and Bayesian optimal policy (BOP) for the forward-looking
example with Ξt−1 = 0.

                         a. Policy: NL, Ξt−1 =0                                     b. Policy: BOP, Ξt−1 =0
                 10                                                      10


                  5                                                       5

                                                                          0




                                                                it
                  0
            t
           i




                                                                         −5                          p1t =0.08
                 −5                                                                                  p1t =0.36
                                                                                                     p1t =0.92
                                                                     −10
                −10                                                    −5                     0                  5
                  −5               0                  5                                       Xt
                                   Xt
                       c. Policy difference: BOP−NL                           d. Policy difference: BOP−NL
                  1

                                                                     1
                 0.5

                                                                     0
                                                               it

                  0
           it




                −0.5                                                −1
                                                                     1
                                                                                                                     5
                                                                              0.5                         0
                 −1
                  −5               0                  5                        p1t        0 −5      X
                                   Xt                                                                 t




The loss function is similar in spirit to the backward-looking case, although different in details:
                                            1
                                        Lt = x2t + 0.1i2t ,          δ = 0.95.
                                            2
Since the forward-looking variable xt now has the random walk elements, it is also the one which
receives the most weight in the loss function. We also include a small control-cost term.
   Figure 6.11 is analogous to figure 6.1 above. In the current figure, panel a shows the resulting
value function V (Xt , Ξt−1 , p1t ) for the optimal policy under NL, as a function of p1t for three
different values of Xt , and with Ξt−1 = 0. The shadow cost of the forward-looking constraint is
zero, and thus this value is most comparable to the backward-looking case. Below we discuss the
differences in results when the multiplier Ξt−1 differs from zero. Again, panel b shows the value
function for the BOP as a function of p1t , while panel c plots the difference between the loss under
BOP and NL, and panel d shows the difference between the loss under BOP and AOP. Overall,
these results are quite similar to the backward-looking case. The value functions appear nearly
linear with some modest concavity, suggesting that learning is beneficial but experimentation has

                                                          34
Figure 6.13: Differences in policy between Bayesian optimal policy (BOP) and no learning (NL)
for the forward-looking example with different Ξt−1 values. Solid line: p1t = 0.08; dashed line:
p1t = 0.36; dot-dash line: p1t = 0.92.

             a. BOP-NL, Ξt−1 = −4             b. BOP-NL, Ξt−1 = 0            c. BOP-NL, Ξt−1 = 4
             1                               1                              1

            0.5                             0.5                            0.5

             0                               0                              0
      it




                                      it




                                                                     it
           −0.5                            −0.5                           −0.5

            −1                              −1                             −1
             −5           0       5          −5        0         5          −5        0         5
                          Xt                           Xt                             Xt




modest effects. Indeed, we again see that the loss under BOP is significantly lower than under NL,
while the loss under BOP is lower than under AOP, but only modestly so.
   Figure 6.12 is analogous to figure 6.2 above, showing the corresponding optimal policy functions.
For the current figure, we again set Ξt−1 = 0. Panel a shows the optimal policy under NL as a
function of Xt for three different values of p1t , while panel b shows the optimal policy function under
BOP. As above, the nonlinearity in the BOP policy is not apparent at this scale. Panel c shows
the difference between the optimal policy under BOP and NL, while panel d plots the difference
in the policies for all p1t and all Xt in the interval [− 5, 5]. As in the backward-looking case, the
difference between policies is largest for small p1t , where the Bayesian optimal policy responds more
aggressively. Also note that, for a given p1t , the magnitudes of the differences, and hence the effects
of experimentation on policy, are symmetric about the Xt origin. That is, it is larger for positive
values of Xt and smaller for negative values, but the absolute value of the effect on it is the same
when |Xt | is the same.
   We now examine the effects of the forward-looking constraint, as summarized by different values
of Ξt−1 . A nonzero Ξt−1 correspond to a constraint from previous commitment and will therefore
increase the loss compared to when Ξt−1 is zero. However, a more interesting effect is on the
experimentation component of policy. In particular, for different Ξt−1 values some asymmetries in
the policy appear. This is evident in figure 6.13, which plots the differences in the optimal policy
under BOP and NL for three different values of p1t in each panel, now for different Ξt−1 . Panel b
repeats panel c of figure 6.12 with Ξt−1 = 0, while in panel a we set Ξt−1 = − 4 and in panel c we

                                                  35
set Ξt−1 = 4. We see that, in each case, the experimentation component of policy tends to lead
toward more aggressive policy, but this effect is altered by the multiplier Ξt−1 . Comparing panel
a to panel b, we see that when Ξt−1 < 0 the experimentation component is greater for positive
values of Xt and smaller for negative values. The converse happens in panel c, as when Ξt−1 > 0
the experimentation component is smaller for positive values.
    These differences reflect a feature of the tradeoff between experimentation and control which
is absent in the backward-looking case. Experimentation tends to push toward more aggressive
policy to sharpen the inference about the modes. However, when Ξt−1 < 0, the forward-looking
constraint implies a larger loss penalty for more negative Xt and it , which dampens this effect.
But, for positive Xt , the loss is smaller with Ξt−1 > 0, which amplifies the effect.
    More precisely, in this case the term (2.6) that must be added to intertemporal loss function to
represent previous commitments is
                                                  1
                                              Ξt−1 xt .
                                                  δ
A negative Ξt−1 hence makes it desirable to increase xt , everything else equal. By (6.3) and (6.4),
xt is determined by
                                               ∞
                                               X                           ∞
                                                                           X
             xt = − Xt + Et xt+1 = − Xt − Et          Xt+1+τ = − Xt − Et          Bjt+1+τ it+τ ,
                                               τ =0                        τ =0

where we assume that the sums converge. Since Bj < 0 for j = 1 and 2, increasing xt means
increasing it . Hence, for Ξt−1 < 0 (> 0) and for each Xt and p1t , under both NL and BOP the
optimal it is higher (lower), and more so for BOP.
    In economic terms, with forward-looking variables in the model, the key considerations are not
just sharpening inference versus inducing more volatility, but also influencing the expectations of
future variables. As we have seen the optimal policy embodies a rather intricate tradeoff amongst
these factors. However, it remains the case that the gains from optimal experimentation are much
smaller than the gains from learning.


7    Conclusions

In this paper we have presented a relatively general framework for analyzing model uncertainty and
the interactions between learning and optimization. While this is a classic issue, very little to date
has been done for systems with forward-looking variables, which are essential elements of modern
models for policy analysis. Our specification is general enough to cover many practical cases of


                                                  36
interest, but yet remains relatively tractable in implementation. This is definitely true for cases
when decision makers do not learn from the data they observe (our no-learning case) or when they
do learn but do not account for learning in optimization (our adaptive optimal policy case). In
both of these cases, we have developed efficient algorithms for solving for the optimal policy which
can handle relatively large models with multiple modes and many state variables. However, in the
case of the Bayesian optimal policy, where the experimentation motive is taken into account, we
must solve more complex numerical dynamic programming problems. Thus, we are haunted by the
curse of dimensionality, forcing us to study relatively small and simple models.
    Thus, an issue of much practical importance is the size of the experimentation component of
policy, and the losses entailed by abstracting from it. While our results in this paper are far from
comprehensive, they suggest that in practical settings the experimentation motive may not be a
concern. The above and similar examples that we have considered indicate that the benefits of
learning (moving from NL to AOP) may be substantial, whereas the benefits from experimentation
(moving from AOP to BOP) are modest or even insignificant. If this preliminary finding stands
up to scrutiny, experimentation in economic policy in general and monetary policy in particular
may not be very beneficial, in which case there is little need to face the difficult ethical and other
issues involved in conscious experimentation in economic policy. Furthermore, the AOP is much
easier to compute and implement than the BOP. To have this truly be a robust implication, more
simulations and cases need to be examined. In particular, it will be important in future work to
see how these results are affected in more realistic and empirically relevant settings.


Appendix

A     Details of the algorithm for the no-learning case

Here we provide more detail on the setup of the model in the no-learning case and adapt the
algorithms in Svensson and Williams [15] (DFT) to the specification with C2j 6≡ 0.




                                                 37
A.1     Setup

Our first task is to write the extended MJLQ system for the saddlepoint problem. We suppose that
we start with an initial period loss function which has the form
                                         0                                        
                                       Xt      Q11j               Q12j      N1j     Xt
                                Lt =  xt    Q012j              Q22j      N2j   xt  .
                                       it      N1j0                 0
                                                                  N2j       Rj      it

Then the dual loss is
                                                                       1
                                              L̃t = Lt − γt0 zt + Ξ0t−1 Hj xt .
                                                                       δ
We now substitute in for xt using

                          xt = x̃(Xt , zt , it , jt , εt )

                             ≡ A−1         −1               −1              −1
                                22,j zt − A22,j A21,j Xt − A22,j B2,j it − A22,j C2,j εt

                             ≡ AxX,j Xt + Axz,j zt + Axi,j it + Axv,j vt ,                                     (A.1)

where in the last line we introduce new notation for the shock. Since we assume C1j εt is independent
of C2j εt , we find it useful to denote the shock εt in the forward-looking equation by vt . After this
substitution we want to express the laws of motion and dual loss in terms of the expanded state
X̃t = [Xt0 , Ξ0t−1 ]0 and the expanded controls ı̃t = [zt0 , i0t , γt0 ]0 . Suppressing time and mode subscripts
for the time being (all are t and j, respectively (except t − 1 on Ξt−1 )), we see that the dual loss
can be written explicitly as

            ¡                               ¢        ¡                                     ¢
   L̃t = X 0 Q11 + A0xX Q22 AxX + 2A0xX Q012 X + 2X 0 N1 + Q12 Axi + A0xX Q22 Axi + A0xX N2 i
                                               1           1           1
       + 2z 0 (A0xz Q012 + A0xz Q22 AxX )X + Ξ0 HAxX X + Ξ0 HAxz z + Ξ0 HAxi i
                                               δ           δ           δ
       − γ 0 z + z 0 (A0xz Q22 Axz )z + i0 (R + A0xi Q22 Axi + 2A0xi N2 )i + 2z 0 (A0xz N2 + A0xz Q22 Axi )i

       + v 0 (A0xv Q22 Axv )v + cross terms in v,

where we don’t write out the cross terms since they have zero conditional expectations. Thus, we
can write the dual loss (ignoring the cross terms in v)
                                          ·          ¸0 ·              ¸·          ¸
                                              X̃t           Q̃j Ñj         X̃t
                                  L̃t =                                                + vt0 Λj vt ,
                                               ı̃t          Ñj0 R̃j         ı̃t




                                                                38
where (again suppressing the j index)
                                 ·           ¸
                                   Q̃11 Q̃12
                            Q̃ =               ,
                                   Q̃012 0

                               Q̃11 = Q11 + A0xX Q22 AxX + 2A0xX Q012 ,
                                       1 0
                               Q̃12 =    AxX H 0 ,
                                      2δ
                                      ·             ¸
                                        Ñ11 Ñ12 0
                                 Ñ =                 ,
                                        Ñ21 Ñ22 0

                               Ñ11 = Q12 Axz + A0xX Q22 Axz ,

                               Ñ12 = N1 + Q12 Axi + A0xX Q22 Axi + A0xX N2 ,
                                       1
                               Ñ21 =    HAxz ,
                                      2δ
                                       1
                               Ñ22 = HAxi ,
                                      2δ
                                                       
                                         R̃11 R̃12 R̃13
                                 R̃ =  R̃12
                                           0  R̃22 0  ,
                                           0
                                         R̃13 0     0

                               R̃11 = A0xz Q22 Axz ,

                               R̃12 = A0xz N2 + A0xx Q22 Axi ,

                               R̃13 = − I/2,

                               R̃22 = R + A0xi Q22 Axi + 2A0xi N2 ,

                                 Λ = A0xv Q22 Axv .

   Similarly, the law of motion for X̃t can then be written

                                X̃t+1 = Ãjt jt+1 X̃t + B̃jt jt+1 ı̃t + C̃jt jt+1 ε̃t+1 ,

where                                ·          ¸                ·                        ¸
                                         εt+1                         A11k + A12k AxXj 0
                           ε̃t+1 =                  ,   Ãjk =                              ,
                                          νt                                 0          0
                       ·                                               ¸           ·               ¸
                           A12k Axzj     B1k + A12k Axij             0               C1k A12k Axvj
              B̃jk =                                                     , C̃jk =                    .
                               0               0                     I                0       0
Furthermore, for the case where C2j ≡ 0 and the forward variables do not reveal the mode j, we
have that AxX , Axz , Axi are independent of the mode and Axv ≡ 0, so the dependence on j in Ãjk ,
B̃jk , and C̃jk disappears.
   The value function for the dual problem, Ṽ (Xt , pt|t ), will be quadratic in X̃t for given pt and
can be written
                                         Ṽ (X̃t , pt ) ≡ X̃t0 Ṽ (pt )X̃t + w(pt ),

                                                             39
where
                                          X                                               X
                             Ṽ (pt ) ≡                pjt V̂ (pt )j ,         w(pt ) ≡             pjt ŵ(pt )j .
                                                   j                                            j

Here, Ṽ (pt ) and V̂ (pt )j are symmetric (nX + nx ) × (nX + nx ) matrices and w(pt ) and ŵ(pt )j are
scalars that are functions of pt . (Thus, we simplify the notation and we let Ṽ (pt ) and V̂ (pt )j
(j ∈ Nj ) denote the matrices ṼX̃ X̃ (pt ) and V̂XX (pt , jt ) in section 3.) They will satisfy the Bellman
equation
                                                              (                                                                          )
                                               X                   X̃t0 Q̃j X̃t + 2X̃t0 Ñj ı̃t + ı̃0t R̃j ı̃t + tr(Λj )
   X̃t0 Ṽ (pt )X̃t + w(pt ) = max min                  pjt              P           0                                                       ,
                                 γt   zt ,it                       + δ k Pjk [X̃t+1,jk         V̂ (P 0 pt )k X̃t+1,jk + ŵ(P 0 pt )k ]
                                                   j

where
                                        X̃t+1,jk ≡ Ãjk X̃t + B̃jk ı̃t + C̃jk ε̃t+1 .

    The first-order condition with respect to ı̃t is thus
                        "                                                                         #
                 X                               X
                     pjt X̃t0 Ñj + ı̃0t R̃j + δ   Pjk (X̃t0 Ã0jk + ı̃0t B̃jk
                                                                            0
                                                                               )V̂ (P 0 pt )k B̃jk = 0.
                    j                                          k

We can rewrite the first-order conditions as
                       "                                                                  #
               X                             X
                          0                          0       0
                   pjt Ñj X̃t + R̃j ı̃t + δ   Pjk B̃jk V̂ (P pt )k (Ãjk X̃t + B̃jk ı̃t ) = 0.
                     j                                         k

It is then apparent that the first-order conditions can be written compactly as

                                                        J(pt )ı̃t + K(pt )X̃t = 0,                                                       (A.2)

where                                                      "                                                  #
                                           X                             X
                                                                                     0          0
                               J(pt ) ≡                pjt R̃j + δ             Pjk B̃jk V̂   (P pt )k B̃jk
                                               j                           k
                                                            "                                                 #
                                               X                          X
                              K(pt ) ≡                 pjt Ñj0 + δ                  0
                                                                               Pjk B̃jk V̂ (P 0 pt )k Ãjk
                                               j                           k

This leads to the optimal policy function,

                                                                ı̃t = F̃ (pt )X̃t ,

where
                                                       F̃ (pt ) ≡ − J(pt )−1 K(pt ).

    Furthermore, the value-function matrix Ṽ (pt ) for the dual saddlepoint problem satisfies
                               (                                                                         )
                         X       X̃ 0 Q̃ X̃ + 2X̃ 0 Ñ F̃ (p )X̃ + X̃ 0 F̃ (p )0 R̃ F̃ (p )X̃
                                        j t
                                   t P           t j        t   t       t    t     j     t   t
      X̃t0 Ṽ (pt )X̃t ≡   pjt                                                                             .
                                                                     0 ]V̂ (P 0 p ) [Ã + B̂ F̃ (p )]X̃
                                 + δ k Pjk X̃t0 [Ã0jk + F̃ (pt )0 B̃jk          t k jk        jk t    t
                         j


                                                                         40
This implies the following Riccati equations for the matrix functions V̂ (pt )j :

                     V̂ (pt )j = Q̃j + Ñj F̃ (pt ) + F̃ (pt )0 Ñj0 + F̃ (pt )0 R̃j F̃ (pt )
                                   X
                               +δ      Pjk [Ã0jk + F̃ (pt )0 B̃jk
                                                                 0
                                                                    ]V̂ (P 0 pt )k [Ãjk + B̃jk F̃ (pt )].
                                     k

The scalar functions ŵ(pt )j will satisfy the equations
                                                 X
                      ŵ(pt )j = tr(Λj ) + δ            Pjk [tr(V̂ (P 0 pt )k C̃jk C̃jk
                                                                                     0
                                                                                        ) + ŵ(P 0 pt )k ].                (A.3)
                                                   k

   The value function for the primal problem is

                                                                                  1X
              X̃t0 V (pt )X̃t + w(pt ) ≡ X̃t0 Ṽ (pt )X̃t + w(pt ) − Ξ0t−1            pjt Hj FxX̃ (pt )j X̃t ,
                                                                                  δ j


where we use that by (A.1) the equilibrium solution for xt can be written

                                          xt = FxX̃ (pt )j X̃t + Fxv (pt )j vt .

We may also find the conditional value function

                                                                           1
         X̃t0 V (pt )j X̃t + w(pt )j ≡ X̃t0 Ṽ (pt )j X̃t + w(pt )j − Ξ0t−1 Hj FxX̃ (pt )j X̃t                (j ∈ Nj ).
                                                                           δ

A.2     The algorithm

Consider an algorithm for determining F̃ (pt ), Ṽ (pt ), w(pt ), V̂ (pt )j and ŵ(pt )j for a given distribu-
tion of the modes in period t, pt . In order to get a starting point for the iteration, we assume that
the modes become observable T + 1 periods ahead, that is, in period t + T + 1. Hence, from that
period on, the relevant solution is given by the matrices F̃j and Ṽj and scalars wj for j ∈ Nj , where
F̃j is the optimal policy function, Ṽj is the value-function matrix, and wj is the scalar in the value
function for the dual saddlepoint problem with observable modes determined by the algorithm in
the appendix of DFT.
   We consider these matrices Ṽj and scalars wj and the horizon T as known, and we will consider
an iteration for τ = T, T − 1, ..., 0 that determines F̃ (pt ), Ṽ (pt ), and w(pt ) as a function of T . The
horizon T will then be increased until F̃ (pt ), Ṽ (pt ), and w(pt ) have converged.
   Let pt+τ,t for τ = 0, ..., T and given pt be determined by the prediction equation,

                                                       pt+τ,t = (P 0 )τ pt ,




                                                                41
and let V̂kT +1 = Ṽk and ŵkT +1 = wk (k ∈ Nj ). Then, for τ = T, T − 1, ..., 0, let the mode-dependent
matrices V̂jτ and the mode-independent matrices Ṽ τ and F τ be determined recursively by
                                                    "                                            #
                                     X                            X
                               τ
                             J ≡          pj,t+τ,t R̃j + δ                     0
                                                                         Pjk B̃jk V̂kτ +1 B̃jk       ,
                                     j                               k
                                                    "                                            #
                                     X                            X
                            Kτ ≡          pj,t+τ,t Ñj0 + δ                    0
                                                                         Pjk B̃jk V̂kτ +1 Ãjk ,
                                     j                               k

                            F̃ τ = − (J τ )−1 K τ ,

                            V̂jτ = Q̃j + Ñj F̃ τ + F̃ τ 0 Ñj0 + F̃ τ 0 R̃j F̃ τ
                                     X
                                 +δ      Pjk [Ã0jk + F̃ τ 0 B̃jk
                                                                0
                                                                  ]V̂kτ +1 [Ãjk + B̃k F̃ τ )],
                                          k
                                                    X
                             ŵjτ = tr(Λj ) + δ             Pjk [tr(V̂kτ +1 C̃jk C̃jk
                                                                                   0
                                                                                      ) + ŵkτ +1 ],
                                                     k
                                     X
                               τ
                            Ṽ =          pj,t+τ,t V̂jτ ,
                                     j
                                     X
                             wjτ =        pj,t+τ,t ŵjτ .
                                     j


    This procedure will give F̃ 0 , Ṽ 0 and w0 as functions of T . We let T increase until F̃ 0 and Ṽ 0
have converged. Then, F̃ (pt ) = F̃ 0 , Ṽ (pt ) = Ṽ 0 , and w(pt ) = w0 . The value-function matrix V (pt )
(denoted VX̃ X̃ (pt ) in section 3) for the primal problem will be given by
                                               ·                   1           0
                                                                                     ¸
                                                    0              2 Γ X (p t )
                           V (pt ) ≡ Ṽ (pt ) − 1           1                     0    ,
                                                 2 ΓX (pt ) 2 [ΓΞ (pt ) + ΓΞ (pt ) ]

where the matrix function

                                                        1X
                           [ΓX (pt ) ΓΞ (pt )] ≡            pjt Hj [FxX (pt )j FxΞ (pt )j ]
                                                        δ j


is partitioned conformably with Xt and Ξt−1 . The conditional value function matrix V (pt )j for the
primal problem will be given by
                                          ·                              1         0
                                                                                               ¸
                                                  0                      2 ΓX (pt )j
                 V (pt )j ≡ V̂ (pt )j −       1                1                                         (j ∈ Nj ),
                                              2 X (pt )j
                                                Γ              2 [ΓΞ (pt )j   + ΓΞ (pt )0j ]

where V̂ (pt )j = V̂j0 and the matrix function

                                                       1
                               [ΓX (pt )j ΓΞ (pt )j ] ≡ Hj [FxX (pt )j FxΞ (pt )j ]
                                                       δ

is partitioned conformably with Xt and Ξt−1 .


                                                                42
B      Verifying the law of iterated expectations in the case of Bayesian
       optimal policy

It will be slightly simpler to use the general probability measure notation, Pr(· | ·), although we will
translate this to the specific cases at the end. We also write pt for pt|t , for simplicity. Finally, for
simplicity we only consider the case without forward-looking variables (so we need only deal with
Xt rather than X̃t ). The generalization to forward-looking variables is straightforward.
    Thus, we want to verify
                                               Et V̂ (st+1 , jt+1 ) = Et V (st+1 ),

where V (st ) ≡ Et V̂ (st , jt ).
    First, in the BOP case, we note that we can write pt+1 = Q̂(Xt+1 ; Xt , pt , it ), and so we can
define
                          V̆ (Xt+1 , jt+1 ; Xt , pt , it ) ≡ V̂ (Xt+1 , Q̂(Xt+1 ; Xt , pt , it ), jt+1 ).

Then we consider
                                                   Z
                  Et V̂ (Xt+1 , pt+1 , jt+1 ) ≡        V̆ (Xt+1 , jt+1 ; Xt , pt , it )d Pr(Xt+1 , jt+1 | Xt ),          (B.1)

where the identity specifies the notation for the joint probability measure of (Xt+1 , jt+1 ), Pr(Xt+1 , jt+1 | Xt ),
conditional on the information set in period t, Xt ≡ σ({Xt , Xt−1 , ...}) (that is, the sigma-algebra
generated by current and past realizations of Xs , s ≤ t). We note that pt = E(jt | Xt ) is Xt -
measurable, that is, pt is a function of Xt . Furthermore, it is Xt -measurable. Hence, Et [·] ≡
E[· | Xt , pt , it ] ≡ E[· | Xt ]. Also, we note that we can write
                                           Z
         Et+1 V̂ (Xt+1 , pt+1 , jt+1 ) ≡        V̆ (Xt+1 , jt+1 ; Xt , pt , it )d Pr(jt+1 | Xt+1 ) ≡ V (Xt+1 , pt+1 ).

    We will use two equivalent decompositions of the joint measure. First, perhaps the most natural
decomposition is

                    Pr(Xt+1 , jt+1 = k | Xt ) = Pr(Xt+1 | jt+1 = k, Xt ) Pr(jt+1 = k | Xt )

                           X
                      =          Pr(Xt+1 | jt+1 = k, Xt ) Pr(jt+1 = k | jt = j) Pr(jt = j | Xt )
                             j
                           X
                      =          Pr(Xt+1 | jt+1 = k, Xt )Pjk pjt .                                                       (B.2)
                             j




                                                               43
Alternatively, we can decompose the joint measure as

                         Pr(Xt+1 , jt+1 = ` | Xt ) = Pr(jt+1 = ` | Xt+1 , Xt ) Pr(Xt+1 | Xt )

                                   X
     = Pr(jt+1 = ` | Xt+1 )              Pr(Xt+1 | jt = j, Xt ) Pr(jt = j | Xt )
                                    j
                                   X
     = Pr(jt+1 = ` | Xt+1 )              Pr(Xt+1 | jt = j, jt+1 = k, Xt ) Pr(jt+1 = k | jt = j) Pr(jt = j | Xt ).
                                   j,k
                  X
     = p`,t+1           Pr(Ak Xt + Bk it + Ck εt+1 | jt = j, jt+1 = k, Xt )Pjk pjt
                  j,k
                  X
     = p`,t+1           ϕ(εt+1 )Pjk pjt .                                                                       (B.3)
                  j,k

   Thus, using the first decomposition, (B.2), with (B.1) we have an expression as in section 5.2,

    Et V̂ (Xt+1 , pt+1 , jt+1 )
         Z X
    =           V̆ (Ak Xt + Bk it + Ck εt+1 , k; Xt , pt , it )Pjk pjt ϕ(εt+1 )dεt+1
            j,k
          Z X
     =            V̂ [Ak Xt + Bk it + Ck εt+1 , Q(Ak Xt + Bk it + Ck εt+1 ; Xt , pt ), k]Pjk pjt ϕ(εt+1 )dεt+1
            j,k

On the other hand, using the second decomposition, (B.3), we can write (B.1) as

     Et V̂ (Xt+1 , pt+1 , jt+1 )
          Z X
     =           V̆ (Xt+1 , `; Xt , pt , it )p`,t+1 Pjk pjt ϕ(εt+1 )dεt+1
             j,k,`
          Z X
      =              V (Xt+1 , Q̂(Xt+1 ; Xt , pt ))Pjk pjt ϕ(εt+1 )dεt+1
             j,k
          Z X
      =              V [Ak Xt + Bk it + Ck εt+1 , Q(Ak Xt + Bk it + Ck εt+1 ; Xt , pt )]Pjk pjt ϕ(εt+1 )dεt+1
             j,k

      = Et V (Xt+1 , pt+1 )

Note that, by averaging with respect to pt , we thus eliminate jt as a state variable and do not need
to compute the conditional value function V̂ (Xt , pt , jt ).


References

 [1] Beck, Günter W., and Volker Wieland (2002), “Learning and Control in a Changing Economic
     Environment,” Journal of Economic Dynamics and Control 25, 1359–1377.

                                                             44
 [2] Blake, Andrew P., and Fabrizio Zampolli (2006), “Time Consistent Policy in Markov Switching
    Models,” Working Paper No. 298, Bank of England.

 [3] Cogley, Timothy, Riccardo Colacito, and Thomas J. Sargent (2007) “The Benefits from U.S.
    Monetary Policy Experimentation in the Days of Samuelson and Solow and Lucas,” Journal
    of Money Credit and Banking 39, s67–99.

 [4] Costa, Oswaldo L.V., Marecelo D. Fragoso, and Ricardo P. Marques (2005), Discrete-Time
    Markov Jump Linear Systems, Springer, London.

 [5] do Val, João B.R., and Tamer Başar (1999), “Receding Horizon Control of Jump Linear
    Systems and a Macroeconomic Policy Problem,” Journal of Economic Dynamics and Control
    23, 1099–1131.

 [6] Ellison, Martin (2006), “The Learning Cost of Interest Rate Reversals,” Journal of Monetary
    Economics 53, 1895–1907.

 [7] Ellison, Martin, and Natacha Valla (2001), “Learning, Uncertainty and Central Bank Activism
    in an Economy with Strategic Interactions,” Journal of Monetary Economics 48, 153–171.

 [8] Evans, George, and Seppo Honkapohja (2001) Learning and Expectations in Macroeconomics,
    Princeton University Press, Princeton.

 [9] Kiefer, Nicholas M. (1989), “A Value Function Arising in the Economics of Information,”
    Journal of Economic Dynamics and Control 13, 201–223.

[10] Lindé, Jesper (2005), “Estimating New-Keynesian Phillips Curves: A Full Information Maxi-
    mum Likelihood Approach,” Journal of Monetary Economics 52, 1135–1149.

[11] Marcet, Albert, and Ramon Marimon (1998), “Recursive Contracts,” working paper,
    www.econ.upf.edu.

[12] Miranda, Mario J., and Paul L. Fackler (2002), Applied Computational Economics and Finance,
    MIT Press.

[13] Rudebusch, Glenn D., and Lars E.O. Svensson (1999), “Policy Rules for Inflation Targeting,”
    in John B. Taylor (ed.), Monetary Policy Rules, University of Chicago Press.




                                              45
[14] Svensson, Lars E.O. (2007), “Optimization under Commitment and Discretion, the Re-
    cursive Saddlepoint Method, and Targeting Rules and Instrument Rules: Lecture Notes,”
    www.princeton.edu/svensson.

[15] Svensson, Lars E.O., and Noah Williams (2007), “Monetary Policy with Model Uncer-
    tainty: Distribution Forecast Targeting,” working paper, www.princeton.edu/svensson/ and
    www.princeton.edu/∼noahw/.

[16] Tesfaselassie, Mewael F., Eric Schaling, and Sylvester C. W. Eijffinger (2006), “Learning about
    the Term Structure and Optimal Ruels for Inflation Targeting,” CEPR Discussion paper No.
    5896.

[17] Wieland, Volker (2000a), “Learning by Doing and the Value of Optimal Experimentation,”
    Journal of Economic Dynamics and Control 24, 501–534.

[18] Wieland, Volker (2006), “Monetary Policy and Uncertainty about the Natural Unemployment
    Rate: Brainard-Style Conservatism versus Experimental Activism,” Advances in Macroeco-
    nomics 6(1).

[19] Zampolli, Fabrizio (2006), “Optimal Monetary Policy in a Regime-Switching Economy: The
    Response to Abrupt Shifts in Exchange-Rate Dynamics,” Working Paper No. 297, Bank of
    England.




                                                46
