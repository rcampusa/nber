                                 NBER WORKING PAPER SERIES




      NONPARAMETRIC IDENTIFICATION OF MULTINOMIAL CHOICE DEMAND
               MODELS WITH HETEROGENEOUS CONSUMERS

                                            Steven T. Berry
                                            Philip A. Haile

                                         Working Paper 15276
                                 http://www.nber.org/papers/w15276


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     August 2009




We have had helpful conversations on this topic with Liran Einav, Jin Hahn, Hide Ichimura, Jon Levin,
Rosa Matzkin and Yuichi Kitamura. We also received useful comments from Sunyoung Park and participants
in several conferences and seminars. Financial support from the NSF is gratefully acknowledged. The
views expressed herein are those of the author(s) and do not necessarily reflect the views of the National
Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2009 by Steven T. Berry and Philip A. Haile. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.
Nonparametric Identification of Multinomial Choice Demand Models with Heterogeneous
Consumers
Steven T. Berry and Philip A. Haile
NBER Working Paper No. 15276
August 2009, Revised March 2010
JEL No. C35

                                              ABSTRACT

We consider identification of nonparametric random utility models of multinomial choice using "micro
data," i.e., observation of the characteristics and choices of individual consumers. Our model of preferences
nests random coefficients discrete choice models widely used in practice with parametric functional
form and distributional assumptions. However, the model is nonparametric and distribution free. It
allows choice- specific unobservables, endogenous choice characteristics, unknown heteroskedasticity,
and high-dimensional correlated taste shocks. Under standard "large support" and instrumental variables
assumptions, we show identifiability of the random utility model. We demonstrate robustness of these
results to relaxation of the large support condition and show that when it is replaced with a weaker
"common choice probability" condition, the demand structure is still identified. We show that key
maintained hypotheses are testable.


Steven T. Berry
Yale University Department of Economics
Box 208264
37 Hillhouse Avenue
New Haven, CT 06520-8264
and NBER
steven.berry@yale.edu

Philip A. Haile
Department of Economics
Yale University
37 Hillhouse Avenue
P.O. Box 208264
New Haven, CT 06520
and NBER
philip.haile@yale.edu
1     Introduction

We consider identi…cation of nonparametric random utility models of multinomial choice
using “micro data,” i.e., observation of the characteristics and choices of individual con-
sumers.   Our model of preferences nests random coe¢ cients discrete choice models widely
used in practice with parametric functional form and distributional assumptions. However,
the model is nonparametric and distribution free. It allows choice-speci…c unobservables,
endogenous choice characteristics, unknown heteroskedasticity, and high-dimensional corre-
lated taste shocks. Under standard “large support”and instrumental variables assumptions,
we show identi…ability of the random utility model, i.e., of (i) the choice-speci…c unobserv-
ables and (ii) the joint distribution of preferences conditional on any vector of observed and
unobserved characteristics. We demonstrate robustness of these results to relaxation of the
large support condition and show that when it is replaced with a weaker “common choice
probability”condition (de…ned below), the demand structure is still identi…ed. We also show
that key maintained hypotheses are testable.
    Motivating our work is the extensive use of discrete choice models of demand for di¤eren-
tiated goods in a wide range of applied …elds of economics and related disciplines. Examples
include transportation and urban economics (e.g., Domencich and McFadden (1975)), in-
dustrial organization (e.g., Berry, Levinsohn, and Pakes (1995)), international trade (e.g.,
Goldberg (1995)), marketing (e.g., Guadagni and Little (1983)), education (e.g., Manski and
Wise (1983)), migration (e.g., Schultz (1982)), voting (e.g., Poole and Rosenthal (1985)),
and health economics (e.g., Capps, Dranove, and Satterthwaite (2003)). We focus in par-
ticular on models in the spirit of Berry (1994), Berry, Levinsohn and Pakes (1995, 2004),
Nevo (2001), Petrin (2002) and a large related literature. These models combine two es-
sential features: heterogeneous tastes for choice characteristics, and endogeneity through
market/choice-speci…c unobservables. Although this class of models is used in a wide range
of applications, their identi…cation has not been addressed in the prior literature. Without
an understanding of the sources of identi…cation in these models, it is di¢ cult to know what
quali…cations are necessary when interpreting estimates or policy conclusions.

                                               1
   Our analysis demonstrates that with su¢ ciently rich micro data, random utility multino-
mial choice models featuring unobserved market/choice characteristics are identi…ed without
the parametric or distributional assumptions used in practice— typically, linear utility with
independent additive and/or multiplicative taste shocks drawn from parametrically speci…ed
distributions.   Our results may therefore lead to greater con…dence in estimates and policy
conclusions obtained in empirical work based on discrete choice models. In particular, para-
metric speci…cations used in estimation can often be viewed as parsimonious approximations
in …nite samples rather than as essential maintained assumptions.         We view this as our
primary message.     However, our results also suggest that with large samples even richer
speci…cations (parametric or nonparametric) of preferences might be considered in empirical
work, and our identi…cation proofs may suggest estimation approaches.
   An important strategy in our work is modeling utility as a nonparametric random func-
tion of observed and unobserved characteristics. This contrasts with the usual approach
of building up randomness from random coe¢ cients and/or other taste shocks.           Our for-
mulation not only enables us to consider a very general model of preference heterogeneity,
but also leads us to focus directly on identi…cation of the conditional joint distribution of
utilities. The advantage of this approach might be unexpected: a natural intuition is that
added structure on the way randomness enters the model would aid identi…cation. However,
whereas the conditional distribution of utilities has the same dimension as the observable
conditional choice probabilities (i.e., the dimension of the choice set), even the standard lin-
ear random coe¢ cients model will involve taste shocks of larger dimension unless signi…cant
restrictions are placed on the correlation structure. Focusing directly on the joint distribu-
tion of utilities naturally leads to primitives whose dimension exactly matches the dimension
of the observables without imposing strong distributional or functional form restrictions.
   A second key aspect of our work is our explicit modeling of market/choice-speci…c un-
observables. Although this is standard in the applied literature, much of the prior work on
identi…cation of discrete choice models has embedded the sources of preference heterogeneity
and the sources of endogeneity in the same random variables. In applications to demand


                                               2
estimation, an endogeneity problem typically arises because some observed choice character-
istics (price being a leading example) depend on unobserved choice characteristics. For such
environments, explicitly modeling market/choice-speci…c unobservables enables one to de…ne
counterfactuals involving exogenous changes in endogenous characteristics within a model
of heteroskedastic random utilities. For example, our formulation allows characterization
of demand elasticities, which require evaluating the e¤ects of a change in price (including
resulting changes in the variance or other moments of random utilities), holding unobserved
product characteristics …xed.1
       A third novel component of our work is its exploration of both identi…cation of the full
model and identi…cation of “demand,”i.e., the mapping from observed and unobserved char-
acteristics to the vector of choice probabilities.       For many questions motivating estimation
of discrete choice models, knowledge of this demand structure su¢ ces.                 Not surprisingly,
identi…cation of demand can be obtained under weaker conditions than those giving full
identi…cation of the random utility model.
       Despite these di¤erences from the prior literature, we rely heavily on two standard ideas.
One is the use of variation in exogenous observables to “trace out” the distribution of un-
observables. Antecedents in the discrete choice literature include Manski (1985), Matzkin
(1992, 1993), Lewbel (2000), Honoré and Lewbel (2002), and Briesch, Chintagunta, and
Matzkin (2005), among others. We show that this strategy is particularly useful in a micro
data setting, where one can exploit variation in individual-level observables within a market,
holding market-level unobservables …xed. As usual, we require the observables tracing out
the joint distribution to have dimension as large as the choice set. However, we show that the
support conditions commonly used with this strategy can be substantially relaxed without
losing identi…cation of demand.         A second standard idea is the use of exogenous variation
in choice sets to decompose variation in the distribution of utilities into the contributions
   1
    Although this is the type of endogeneity typically relevant to demand applications, it obviously is not
the only possibility. For example, our model typically would not be appropriate for evaluating treatment
e¤ects on multinomial outcomes when treatments depend on individual-speci…c unobservables. See Berry
and Haile (2009b) for additional discussion and examples in the context of a generalized regression model.



                                                    3
of observed and unobserved characteristics. This strategy has been exploited in parametric
discrete choice models by, e.g., Berry (1994) and Berry, Levinsohn and Pakes (1995, 2004).
Here we rely heavily on results from the recent literature on nonparametric identi…cation of
regression models using instrumental variables, particularly Newey and Powell (2003) and
Chernozhukov and Hansen (2005). To our knowledge, the applicability of these results to
discrete choice settings has not been previously exploited. An implication of our results is
that the primary requirement for identi…cation of demand is the availability of instruments.
As discussed below, one advantage of micro data is the variety of instruments that may be
available.
        In the following section we provide some additional discussion of related literature. We
then set up the choice framework and de…ne the observables and structural features of inter-
est in section 3. Section 4 provides an illustration of key lines of argument in a simple case:
binary choice with exogenous characteristics. Section 5 addresses full identi…cation in the
case of multinomial choice with endogeneity. There we consider two alternative instrumen-
tal variables conditions that deliver full identi…cation of the model.           In section 6 we show
identi…ability of demand under weaker support conditions and illustrate the robustness of
the full identi…cation results to the relaxation of the large support assumption (cf. Cham-
berlain (2010)). Section 7 discusses testable restrictions of key maintained hypotheses. In
section 8 we show how our results can be reinterpreted to show identi…cation in one type of
environment in which only market level data are available. We conclude in section 9.



2         Relation to the Literature

Our work is motivated by a large applied literature using models of discrete choice demand
incorporating two key components: heterogeneous preferences for choice characteristics and
endogeneity through market/choice-speci…c unobservables.                The former allows a ‡exible
model of substitution patterns (e.g., cross-elasticities),2 while the latter is essential if one

    2
    See, e.g., the discussions in Domencich and McFadden (1975), Hausman and Wise (1978) and Berry,
Levinsohn, and Pakes (1995). Early models of discrete choice with heterogeneous tastes for characteristics

                                                    4
is to control for the classical endogeneity of prices.             Although there is a large literature
on identi…cation of discrete choice models,3 there has been no analysis that covers even the
linear version of these models typically used in the applied literature. Thus, although we
relax functional form restrictions considered in the prior identi…cation literature, a more fun-
damental distinction is that our model allows simultaneously for heterogeneity in preferences
for choice characteristics and endogeneity through market/choice-speci…c unobservables.
       Identi…cation of heterogeneous preferences for choice characteristics has been explored by
Ichimura and Thompson (1998) and Briesch, Chintagunta, and Matzkin (2005). Ichimura
and Thompson (1998) studied the linear random coe¢ cients binary choice model. Briesch,
Chintagunta, and Matzkin (2005) considered multinomial choice, allowing generalizations of
the linear random coe¢ cients model. Neither considers endogenous choice characteristics,
and both impose restrictions we do not require on how heterogeneity enters preferences.
       Lewbel (2000) considered identi…cation in the semi-parametric linear random utility
model
                                             vij = xij +     ij                                         (1)

where the distribution of      ij   can vary with xij . Unlike (1), our model makes a distinction
between the unobservables responsible for taste heterogeneity and those responsible for en-
dogeneity.4      To see why this is essential in applications to discrete choice demand, suppose
we wish to describe how quantities would change in response to an exogenous change in
the price of good j— e.g., to describe own- and cross-price demand elasticities. Accounting
for heterogeneity in tastes requires that the entire distribution of vij (not just its mean)
be permitted to change with the change in price.                  At the same time, controlling for the
endogeneity of price requires that all else (in particular, market/product-level unobservables
that are correlated with price) be held …xed.            Meeting both requirements is not possible

include those in Quandt (1966), Quandt (1968), and Domencich and McFadden (1975).
   3
   Important early work includes Manski (1985, 1987, 1988) and Matzkin (1992, 1993), who study linear
models with exogenous regressors.
   4
    We also relax functional form restrictions; for example, we do not require mean e¤ects of observables to
enter separably from unobservables.


                                                     5
in a model like (1) that has a single “composite” error term. Thus, while (1) provides an
attractive structure if the parameter       is the object of interest, the model lacks the structure
needed to de…ne key objects of interest in the context of discrete choice demand.
       Honoré and Lewbel (2002) consider a binary panel version of the model in Lewbel (2000),
relying on linearity in a composite error term and focusing on identi…cation of a slope pa-
rameter. Altonji and Matzkin (2005) consider a similar but nonparametric model. Their
results for discrete choice models focus on identi…cation and estimation only of local average
responses. Other work considering models similar to (1) includes Hong and Tamer (2004),
Blundell and Powell (2004), Lewbel (2005), and Magnac and Maurin (2007).
       Matzkin (2004) (section 5.1) considers a model incorporating choice-speci…c unobserv-
ables and an additive preference shock, but in a model without random coe¢ cients or other
sources of heteroskedasticity/heterogeneous tastes for characteristics.5              Hoderlein (2008)
allows for both heteroskedasticity and endogeneity in the case of a binary choice model,
focusing on identi…cation of a particular average derivative. Hoderlein (2008), like Blundell
and Powell (2004) and Matzkin (2004), limit attention to binary choice in semiparametric
triangular models, leading to the applicability of control function methods or the related
idea of “unobserved instruments.”6 For binary choice demand, triangular models can be
appropriate when price depends on either a demand shock or a cost shock, but not both. In
the case of multinomial choice, standard oligopoly models imply that each price depends on
the entire vector of demand shocks (and cost shocks, if any). Thus, triangular models do not
permit the type of endogeneity relevant for most applications to discrete choice demand.7
       Berry and Haile (2009a) considers identi…cation of multinomial choice models allowing
heterogeneity and endogeneity, but for the case when only market level data are available.8
   5
       See also Matzkin (2007a, 2007b).
   6
     See also Lewbel (2000), Honoré and Lewbel (2002), Altonji and Matzkin (2005), and Petrin and Train
(2009).
   7
   Gautier and Kitamura (2007) have considered binary choice in a linear random coe¢ cients environment.
They include a brief discussion of endogeneity under a triangular structure.
   8
    Berry and Haile (2009b) provide additional results for binary choice and other models that are special
cases of a “generalized regression model.”



                                                    6
Although the results there extend immediately to the richer micro data environment consid-
ered in the present paper, here our focus is on the gains that micro data can deliver. The lack
of micro data in Berry and Haile (2009a) makes it impossible to exploit the within-market
variation that plays a central role throughout the present paper. Consequently, the results
in Berry and Haile (2009a) require more restrictive representations of preferences than those
considered here. However, given the results on identi…cation of demand below, the results
in Berry and Haile (2009a) on identi…cation of marginal costs do extend to the micro data
environment considered here.
    Our work is distinguished from much of the prior literature by a neglect of estimation.
This limited focus is shared by the concurrent work of Fox and Gandhi (2009), which explores
identi…ability of several related models, including a model of multinomial choice in which
consumer types are multinomial and utility functions are analytic. More recently, Chiappori
and Komunjer (2009) have explored identi…cation of a multinomial choice model with an
additive structure in a micro data environment, allowing for heterogeneous preferences and
endogeneity through choice-speci…c unobservables. They use a change of variables approach
more closely related to one of the approaches we have developed in Berry and Haile (2009a).



3     Model

3.1    Preferences and Choices

Consistent with the motivation from demand estimation, we describe the model as one in
which each consumer i in each market t chooses from a set Jt of available products. We will
use the terms “product,” “good,” and “choice” interchangeably to refer to elements of the
choice set. The term “market”is synonymous with the choice set. In particular, consumers
facing the same choice set are de…ned to be in the same market. In practice, markets will
typically be de…ned geographically and/or temporally. Variation in the choice set will of
course be essential to identi…cation, and our explicit reference to markets provides a way to
discuss this clearly.

                                              7
       Each consumer i in market t is associated with a matrix of observables zit = (zi1t ; : : : ; ziJt t ).
The j subscript on zijt allows the possibility that some characteristics are both consumer- and
choice-speci…c. This can result from interactions between consumer characteristics and prod-
uct characteristics, or from measures that are inherently consumer/choice-speci…c. Examples
from the literature include interactions between family size and automobile size (Goldberg
(1995), Berry, Levinsohn, and Pakes (2004)), distance from an individual’s home to a hos-
pital, school, or retailer (Capps, Dranove, and Satterthwaite (2003), Hastings, Staiger, and
Kane (2007), Burda, Harding, and Hausman (2008)), household exposure to product-speci…c
advertising (Ackerberg (2001)), matches between a voter’s position and party a¢ liation and
those of each candidate (Rivers (1988)), and matches between the income, education and
race of a household to that of a neighborhood (Bayer, Ferreira, and McMillan (2007)). We
will require one such measure for each market t and each product j                           1.9
       In applications to demand it is important to model consumers as having the option to
purchase none of the products the researcher focuses on.10 We represent this by choice j = 0
and assume 0 2 Jt 8t. Choice 0 is often referred to as the “outside good.” We denote the
number of “inside goods” by Jt = jJt j                      1.11 Observables (to us) at the level of the good
and/or market are denoted by xjt . Among other things, xjt can include product dummies
and price.         Let xt = (x1t ; : : : ; xJt t ).        Unobservables at the level of the product and/or
market are characterized by a scalar                  jt   (zit ) for each j; t; zit . This may re‡ect unobserved
choice characteristics, unobserved market characteristics, and/or unobserved taste for choice
j in market t.        Although we follow the literature in restricting                jt   (zit ) to be a scalar, we
permit it to vary across subpopulations with di¤erent zit :12 For simplicity we will assume
   9
    If zijt = z~it for all j, the identi…cation problem is identical to that in the case of market-level data (see
Berry and Haile (2009a)) conditional on each value of z~it .
  10
    See, e.g., Bresnahan (1981), Anderson, DePalma, and Thisse (1992), Berry (1994), Berry, Levinsohn,
and Pakes (1995), and Goldberg (1995).
  11
    In applications with no “outside choice”our approach can be adapted by normalizing preferences relative
to those for a given choice. The same adjustment applies when characteristics of the outside good vary
across markets in observable ways.
  12
     Athey and Imbens (2007) point out that the assumption of a scalar vertical unobservable jt can lead to
testable restrictions in some models. Although their observation does not apply to our more general model,



                                                               8
that   jt   (zit ) has an atomless marginal distribution in the population for all zit .
    We consider preferences represented by a random utility model. Letting                                                         denote the
support of xjt ;          jt   (zit ) ; zijt , each consumer i in market t has a conditional indirect utility
function uit :           ! R. However, consumers have heterogeneous tastes, even conditional on
observables. Thus, from the perspective of the researcher, each utility function uit can be
viewed as a random draw from a set U of permissible functions fu :                                                  ! Rg :
    More formally, let ( ; F; P) denote a probability space. Given any xjt ;                                             jt   (zit ) ; zijt 2 ,


                                    uit xjt ;    jt   (zit ) ; zijt = u xjt ;         jt   (zit ) ; zijt ; ! it                             (2)


where ! it 2           , and u is measurable in ! it . The realization of ! it determines the utility
function of consumer i in market t.                         The draw ! it from the sample space                               is independent
of the arguments of the utility function; i.e., the probability measure P does not depend
on xjt ;     jt   (zit ) ; zijt .    This is without loss of generality, since the function u permits the
distribution of uit xjt ;            jt   (zit ) ; zijt to vary arbitrarily with xjt ;                      jt    (zit ) ; zijt . P also does
not vary with the market index t. This re‡ects our earlier assumption that all unobserved
choice/market-level heterogeneity is captured by                                 jt   (zit ). We discuss testable implications
below.
    Let
                                                vijt = u xjt ;       jt   (zit ) ; zijt ; ! it :

We emphasize that ! it is not a random variable (or random vector) but an elementary event
in the sample space . The realization of ! it could determine the realizations of any number
of number of random variables with arbitrary joint distribution. As one example, consider
mapping our general model to a more familiar special case:

Example 1. Consider the linear random coe¢ cients random utility model


                                    u xjt ;     jt ; zijt ; ! it   = xjt    it   + zijt +          jt   +   ijt :                           (3)

below we derive a testable implication that does.

                                                                      9
                                                                                                   (1)                (K)
Here          jt   (zit ) =       jt      and the random variables                                 it ; : : : ;       it ; i1t ; : : : ; iJt t          can be de…ned
                                                                                                           (k)            (k)
on the probability space ( ; F; P), for example as                                                         it     =             (! it ) and           ijt     =   j    (! it ).13
                                                                                                                                 (1)                (K)
This speci…cation permits an arbitrary joint distribution of                                                                     it ; : : : ;       it ; i1t ; : : : ; iJt t

but requires that it be the same for all t and                                                     xjt ;    jt ; zijt      j=1:::Jt
                                                                                                                                      .14       This speci…cation
of           it ; f ijt gj       relaxes standard assumptions in the literature but is still more restrictive
than we require, even within a linear random coe¢ cients model. For example, recalling
that xt can include product dummies, a more general model is obtained by letting                                                                                           it    =
     (1)                               (K)
(          (zit ; ! it ) ; : : : ;           (zit ; ! it )) and            ijt   =         xjt ;    jt ; ! it     .     We could generalize further by
specifying            ijt    =         xjt ;      jt   (zit ) ; zijt ; ! it ; however, then the sum xjt                                 it   + zijt +             jt    in (3)
would be redundant and the model would collapse to our fully general formulation (2).

          Aside from the restriction to scalar market/choice-speci…c unobservables, our representa-
tion of preferences is so far fully general. However, all of our results will require a restriction
                                                                                                                         (1)    (2)                     (1)
on the set U of permissible utility functions. Let zijt = zijt ; zijt , with zijt 2 R.                                                                                      Let
                                                                       0                                                                        0
    (1)                                           (1)           (1)                      (2)                             (2)           (2)
zit denote the vector zi1t ; : : : ; ziJt t                                and zit the matrix zi1t ; : : : ; ziJt t                                 : For most of our
                                                                             (2)
results we will require that for every zit there exist a representation of utilities with the
form
                                           (1)                              (2)           (2)
                                       it zijt    + ~ xjt ;       jt       zit       ; zijt ; ! it                8i; j = 1; : : : ; Jt                                         (4)

where the function ~ is strictly increasing in its second argument, and the random coe¢ cient

    it   =     (! it ) is strictly positive with with probability one.15
          This imposes three restrictions:
                                                          (1)
(i) invariance of                    jt   (zit ) to zit
                                                                                  (1)
(ii) separability in a “vertical”attribute zijt
(iii) monotonicity in                      jt .

Part (i) requires one component of zit whose variation is not confounded with variation in the
    13
          We can write choice-speci…c functions such as                              j   ( ) because xt is permitted to include product dummies.
    14
    This formulation allows variation in Jt across markets. For example, ! it determines the values of the
random variables ijt = j (! it ) for all possible choices j, not just those in the current choice set.
    15                                                   (1)               (1)
     If it < 0 w.p. 1, we replace zijt with                            zijt . As long as j              it j   > 0 w.p. 1, identi…cation of the sign of                          it
is straightforward.

                                                                                         10
market/choice-speci…c unobservable. While an important restriction, this relaxes the stan-
                                                                                                                       (2)
dard assumption                 jt    (zit ) =        jt   8zit . Part (ii) requires that, for each zit , there be a monotonic
                                                                      (1)
transformation of utilities such that zijt enters in additively separable form.16 With separa-
bility, the invariance of P to xjt ; zijt ;                                 jt   (zit )    — previously without loss— now has bite:
                                                                                             j2J
                                                                                                   n                            o
                                                (2)         (2)        (1)                                      (2)   (2)
conditional on xjt ;                      jt   zit     ; zit        , zijt       is independent of ~ xjt ; jt zit ; zijt ; ! it   .
                                                                                                                                                  j2J
                                                                                    (2)
Part (iii) requires that, conditional on                                     xjt ; zijt            , all consumers rank the possible values of
            (2)                                                                              (2)
 jt        zit       the same way. If we interpret                                jt     zit         as an unobserved product characteristic,
                               (2)
this means               jt   zit          is a “vertical” rather than “horizontal” characteristic.                                      We do still
                                                                                       (2)
allow heterogeneity in preferences for                                      jt    zit         , and we allow a di¤erent representation (4)
                                    (2)
for each value of zit .
                                                                                                                (1)
          The invariance and separability restrictions together give zijt the properties of a “special
regressor”(e.g., Lewbel (2000)) that will provide a mapping between units of (latent) utility
and units of (observable) choice probabilities.17 Monotonicity plays important roles as well,
enabling us to map observed conditional choice probabilities to values of the market/choice
unobservables. We show in section 7 that all three restrictions have testable implications.
          Henceforth we condition on Jt = J , with jJ j = J.                                                 We also condition on a value of
 (2)
zit and suppress it in the notation. For simplicity, we will now write only zijt and zit to

     16                                                                                (2)
          For binary choice, if we assume                    t   (zit ) =         zit
                                                                         and that u (xt ; t (zit ) ; zit ; ! it ) is strictly increasing
                                                                             t
                                                                       n                                            o
       (1)                                                               (1)                 (2)       (2)
in    zit ,      fu (xt ; t (zit ) ; zit ; ! it ) > 0g is equivalent to zit > u 1 0; t zit ; zit ; ! it . This leads to
                                                                                                    (1)
an observationally equivalent model with separability in zit . This is well known. Nonetheless, additive
separability is not without loss under these assumptions. This is because there may be no monotonic
transformation of the original utility function that leads to the separable form. For example, suppose that
                        (2)                                                        (1)                    (1)
according to u xt ; t zit ; zit ; ! it the marginal rate of substitution between zit and xt varies with zit .
This property would be preserved by any monotonic transformation but fails under separability. Thus,
although the separable structure preserves consumers’ordinal rankings of the outside good and any inside
good, it need not preserve their ordinal rankings of alternative inside goods. An implication is that there
                                   (1)
can be simultaneous changes in zit and xt that would raise welfare under one model but lower welfare under
the other. Nonetheless, the observational equivalence demonstrates why it may be di¢ cult to obtain full
identi…cation without a restriction like the separability we assume. Note that quasilinearity also provides a
cardinal representation of utility, making it possible to characterize aggregate welfare.
     17                       (1)                                                                                             (2)
          We can allow zijt to be an index g (cijt ) where cijt is a vector, as long as                                      zit     cijt . Fixing t and
                                                                                                                                    j=




                                                                                                                      jt
 (2)
zit ,utilities have the form vijt = g (cijt ) + ijt with cijt ijt . If g ( ) is linear, identi…cation of g ( ) follows
                                                                                              j=




by standard results (e.g., Manski (1985)). Identi…cation of nonlinear g ( ) can be obtained under restrictions
considered in Matzkin (1993).



                                                                                        11
           (1)      (1)                                                                                                (2)
represent zijt and zit , respectively. Likewise, we will write                              jt   instead of   jt   zit       . With
this simpli…ed notation, each market t is de…ned by the values of xjt ;                                  jt j2J    :


3.2    Normalizations

Before discussing identi…cation, we must have a unique representation of preferences for
which the identi…cation question can be posed. This requires several normalizations.
   First, because unobservables enter non-separably and have no natural units, we must
normalize the location and scale of              jt     for each j.            It will be useful to employ di¤erent
normalizations for di¤erent results, so we provide these below.
   We must also normalize the location and scale of utilities. Without loss, we normalize
the scale of each consumer i’s utility using his marginal utility from zijt , yielding utilities
with the form
                                       ~ j xjt ;      jt ; ! it
                             zijt +                                     8i; j = 1; : : : ; J:
                                                   it

Here we include a subscript j on the function ~ j because in general we will have conditioned
                           (2)
on a di¤erent value of zijt for each j. Letting

                                                                   ~ j xjt ;    jt ; ! it
                                   j    xjt ;   jt ; ! it     =
                                                                               it


this gives the representation of preferences we will work with below:


                          vijt = zijt +     j   xjt ;      jt ; ! it        8i; j = 1; : : : ; J:                               (5)


To normalize the location we set vi0t = 0 8i; t.                       Treating the utility from the outside good
as non-stochastic is without loss, since choices are determined by di¤erences in utilities and
we have not restricted the joint distribution of utilities across products.




                                                              12
3.3       Observables and Structural Features of Interest

Each consumer i maximizes her utility, choosing good j whenever vijt > vikt 8k 2 J                      fjg.
For simplicity we assume that any ties with the outside good are broken in favor of the
outside good. We denote consumer i’s choice by


                                           yit = arg max vijt :
                                                         j2J



       We will typically require excluded instruments, which we denote by w̃jt . One advantage
of micro data is the variety of instrumental variables that may be available.                   Depending
on the environment, instruments for prices18 might include cost shifters excludable from the
utility function, prices in other markets (e.g., Hausman (1996), Nevo (2001)), characteristics
of competing products (e.g., Berry, Levinsohn, and Pakes (1995)), and/or “average” values
of zit in market t (e.g., Waldfogel (2003), Gentzkow and Shapiro (2009)).19                   Because the
arguments are standard, we will not discuss assumptions necessary to justify the exclusion
and “rank”conditions, which we will assume directly below.
       The observables then consist of the market index t and the variables


                                        (yit ; fxjt ; w̃jt ; zijt gj2J ) :


To discuss identi…cation, we treat their joint distribution as known. In particular, we take
the conditional probabilities


                               pijt = PrP (yit = jjt; fxkt ; w̃kt ; zikt gk2J )                          (6)

  18
    We discuss instruments for prices here because price is the leading case of an endogenous product char-
acteristic. Our results permit any number/types of endogenous characteristics as long as valid instruments
are available.
  19
    The last of these obviously is unavailable without micro data. The analysis in Berry and Haile (2009a)
suggests that characteristics of other goods may not be su¢ cient on their own without micro data or addi-
tional restrictions on preferences. Thus the variety of instruments that may be available can be an important
advantage of micro data.




                                                       13
as known. Loosely speaking, we consider the case of observations from a large number of
markets, each with a large number of consumers, who are anonymous conditional on zit .
    Our …rst objective is to derive su¢ cient conditions for identi…cation of the market/choice-
speci…c unobservables and the distribution of preferences over choices in sets J , conditional
on the characteristics xjt ; zijt ;     jt j2J .     In particular, we will show identi…cation of           jt j2J

and the joint distribution of fvijt gj2J conditional on any xjt ; zijt ;              jt j2J    in their support.
These conditional distributions fully characterize the primitives of this model. We therefore
refer to identi…cation of these probability distributions as full identi…cation of the random
utility model.
    We will also consider a type of partial identi…cation: identi…cation of demand. For many
economic questions motivating estimation of discrete choice demand models, the joint distri-
bution of utilities is not needed. For example, to discuss cross-price elasticities, equilibrium
markups, or pricing/market shares under counterfactual ownership or cost structures, one
requires identi…cation of demand, not the full random utility structure. Identi…cation of
demand naturally requires less from the model and/or data than identi…cation of the distri-
bution of preferences. Demand is fully characterized by the unobservables                         jt j2J   and the
structural choice probabilities


                       j   fxjt ;   jt ; zijt gj2J   = Pr yit = jjfxjt ;   jt ; zijt gj2J   :                  (7)


These conditional probabilities are not directly observable from (6) because of the unobserv-
ables   jt .




4       Illustration: Binary Choice with Exogeneity

To illustrate key elements of our approach, we begin with the simple case of binary choice
with exogenous xjt . Dropping the j subscripts, consumer i selects the inside good whenever


                                            zit + (xt ; t ; ! it ) > 0:

                                                         14
Here we normalize                      t   by letting it have a uniform distribution on (0; 1).                                We consider
identi…cation under the following assumptions.

Assumption 1.                              (xt ; zit ) :




                                      j=
                                  t


Assumption 2. supp zit jxt ;                           t   = R 8x:

      Assumption 1 merely restates that for this illustration we are considering the special
case of exogenous observables.                              This assumption is dropped in the following section. A
“large support” condition like Assumption 2 is common in the literature on nonparametric
and semiparametric identi…cation of discrete choice models (e.g., Manski (1985), Matzkin
(1992), Matzkin (1993), Lewbel (2000)).20 We relax this assumption in section 6.
      Here we show that Assumptions 1 and 2 are su¢ cient for full identi…cation of the random
utility model. Let                    it   =       (xt ; t ; ! it ) as shorthand. Holding the market t …xed, all variation
in    it   is due to ! it . The observed conditional probability that a consumer chooses the outside
good in market t is
                                                                 Pr (     it        zit jxt ; zit ) :

Because zit and              it   are independent conditional on t (i.e., conditional on (xt ; t )), Assumption
2 guarantees that variation in zit within market t identi…es the distribution of                                                  it jt.   Call
this F      it jt
                    ( ). This argument can be repeated for all markets t.
      In writing            it jt,    we …x the values of xt and                            t,   although only the former is actually
observed. However, once we know the distribution of                                               it jt   for all t, we can recover the value
of each         t   as well. To see this, let


                                               t   = med [       it jt]   = med [ (xt ; t ; ! it ) jxt ; t ] :


With F          it jt
                        ( ) now known, each                  t   is known and satis…es


                                                                          t    = D (xt ; t )                                                (8)
 20
   As usual, the support of zit need not equal the entire real line but need only cover the support of
 (xt ; t ; ! it ). We will nonetheless use the real line (real hyperplane below) for simplicity of exposition.

                                                                                  15
for some function D that is strictly increasing in its second argument. Identi…cation of each

 j    then follows standard arguments. In particular, for                             2 (0; 1) let             (xt ) denote the th
quantile of             t jxt   across markets. Recalling the normalization of                t,   strict monotonicity of D
in        t   implies
                                                         (xt ) = D (xt ; ) :

Since               (xt ) is known for all xt and , D is identi…ed on fsupp xt g                     (0; 1). With D known,
each           t   is known as well.
          Thus far we have shown identi…cation of F                    it jt
                                                                               and of each latent         t.    So for any (xt ; t )
in their support, the value of


                                       F (rjxt ; t )       Pr ( (xt ; t ; ! it )        rjxt ; t )

                                                       = F    it jt
                                                                      (r)


is uniquely determined for all r 2 R. Since vit = zit + (xt ; t ; ! it ), this proves the following
result.

Theorem 1. Consider the binary choice setting with preferences given by (5). Under As-
sumptions 1 and 2, each                   t   and the distribution of vit conditional on any (xt ; t ; zit ) 2                    is
identi…ed.

          Our argument involved two simple steps, each standard on its own. First, we showed that
variation in zit can be used to trace out the distribution of preferences across consumers. It is
in this step that the role of idiosyncratic variation in tastes is identi…ed. Antecedents for this
step include Matzkin (1992), Matzkin (1993), Lewbel (2000).21 Here we apply this step within
each market, exploiting the fact that conditioning on the market …xes all characteristics of
the choice set, even those not observed. In the second step, we use variation in choice
characteristics across markets to decompose the variation in utilities across products into
the variation due to observables and that due to the unobservables                                   t.        This idea has been

     21
          See also Matzkin (2007a, 2007b).


                                                                16
used extensively in estimation of parametric multinomial choice demand models following
Berry (1994), Berry, Levinsohn, and Pakes (1995), and Berry, Levinsohn, and Pakes (2004).
This second step is essential once we allow the possibility of endogenous choice characteristics
(e.g., correlation between price and        t ),   as will typically be necessary in demand estimation.
Our approach for the more general cases follows the same broad outline.



5        Multinomial Choice: Full Identi…cation

We now consider the general case of multinomial choice with endogenous characteristics
using the speci…cation of preferences in (5). We will use the following generalization of the
large support assumption:

Assumption 3. supp fzijt gj=1;:::;J j xjt ;          jt j=1;:::;J   = RJ :

       This is a strong assumption, essentially requiring su¢ cient variation in (zi1t ; : : : ; ziJt t )
to move choice probabilities through the entire unit simplex.22                     Equivalent conditions are
assumed in prior work on multinomial choice by, e.g., Matzkin (1993), Lewbel (2000), and
Briesch, Chintagunta, and Matzkin (2005). Such an assumption provides a natural bench-
mark for exploring identi…ability under ideal conditions.                      However, we will also explore
results that do not require this assumption in section 6.
                                                                                                    (1)    (2)
       Without Assumption 1, we will require instrumental variables.                   Let xjt = xjt ; xjt ,
            (1)                                                                                      (2)
where xjt 2 RK denotes the endogenous characteristics. We then let wjt                              xjt ; w̃jt
denote the vector of exogenous conditioning variables.                       We will consider two alternative
sets of instrumental variables conditions below, each taken from the recent literature on
nonparametric instrumental variables regression.
  22
    This is only “essentially” required by the large support condition because we do not require continuity
                            (1)
of choice probabilities in zit .




                                                       17
5.1          Identi…cation with Fully Independent Instruments

We …rst explore identi…cation using instrumental variables conditions from Chernozhukov
and Hansen (2005). We normalize                             jt j2J   by assuming that for each j,                    jt   has a uniform
                                                                                      (1)
marginal distribution on (0; 1). Here we will assume xjt is continuously distributed, with
                                                     (1)                                                                  (2)      (2)
conditional density function fxj xjt jwjt .23 We will condition on a value of x1t ; : : : ; xJt ,
                                                                                                           (1)
suppress these arguments in the notation, and let xjt now denote xjt . De…ne the random
variable

                                jt   = Dj xjt ;        jt      med        j   xjt ;   jt ; ! it    xjt ;   jt                       (9)

and let f j ( jxjt ; wjt ) denote its conditional density.
       Let     and   f   be some small positive constants. For each j and                                        2 (0; 1) de…ne Lj ( )
as the convex hull of functions mj ( ; ) that satisfy
(a) for all wjt , Pr (     jt        mj (xjt ; ) jwjt ) 2 [               ; +         ]; and
(b) for all xjt , mj (xjt ; ) 2 sj (xjt )                     : f j ( jxjt ; w)             f   8w with fxj (xjt jw) > 0 .
We now make the following instrumental variables assumptions, taken from Chernozhukov
and Hansen (2005, Appendix C).24

Assumption 4.                        (wjt ; zijt ) 8j; t:
                               j=




                          jt


Assumption 5. For all j and                        2 (0; 1), (i) for any bounded function Bj (x; ) = mj (x; )
Dj (x; ) with mj ( ; ) 2 Lj ( ) and "jt           Dj (xjt ; ), E Bj (xjt ; ) j (xjt ; wjt ; ) jwjt =
                                                                jt
                                                      R1
0 a.s. only if Bj (xjt ; ) = 0 a.s., for j (x; w, ) = 0 f"j ( Bj (x; ) jx; w) d > 0.
(ii) the density f"j (ejx; w) of              jt   is continuous and bounded in e over R a.s.;
(iii) Dj (xjt ; ) 2 sj (xjt ) for all xjt .

       Assumption 4 is a strong exclusion restriction requiring fully independent instruments.
Assumption 5 is a particular type of “bounded completeness” condition, requiring that the
  23
    This could be dropped by appealing below to Theorems 2 and 3 (and the associated rank conditions)
in Chernozhukov and Hansen (2005) instead of their Theorem 4. We focus on continuous endogenous
characteristics here because price is our leading example.
  24
    Chernozhukov and Hansen’s “rank invariance” property holds here because the same unobservable jt
determines potential values of jt for all possible values of the endogenous characteristics. As in their
framework, jt and xjt can be assumed without loss to be tranformed to have bounded support.

                                                                     18
instruments induce su¢ cient variation in the endogenous variables. This condition plays the
role of the standard rank condition for linear models, but for the nonparametric nonseparable
model   j   = Dj (x; ).25 With these assumptions, we obtain the following result.

Theorem 2. Under the representation of preferences in (5), suppose Assumptions 3–5 hold.
Then each     jt      and the joint distribution of fvijt gj2J conditional on any (xjt ; zijt ;                                                        jt ) j2J

in their support is identi…ed.

Proof. Let     ijt    =       j    xjt ;    jt ; ! it       and observe that


                                                    lim       pijt = Pr zijt +               ijt   > 0jzijt :                                             (10)
                                             zikt ! 1
                                                8k6=j




Holding t …xed,                       zijt , so Assumption 3 guarantees identi…cation of the marginal distri-
                                  j=




                            ijt

bution of    ijt jt   for each j. This implies identi…cation of the conditional median


                       jt    = med            j     xjt ;    jt ; ! it    jxjt ;    jt   = med         j    xjt ;   jt ; ! it   jt :                      (11)


Thus, the left side of (9) can be treated as known for all j and t. Noting that the function
Dj in (9) must be strictly increasing in                                 jt ,   Theorem 4 of Chernozhukov and Hansen (2005)
then implies that under Assumptions 4 and 5, each function Dj (and therefore each                                                                        jt )   is
identi…ed. Finally, observe that for any market t


                      pi0t = Pr (zi1t +                      i1t         0; : : : ; ziJt +     iJt     0j t; zi1t ; : : : ; ziJt )                        (12)

                                  = Pr (          i1t          zi1t ; : : : ;      iJt       ziJt j t; zi1t ; : : : ; ziJt )


so that Assumption 3 implies identi…cation of the joint distribution of (                                                              i1t ; : : : ;    iJt ) jt.

Since each xjt is observed and each                                jt    is identi…ed, this implies identi…cation of the joint
distribution of (           i1t ; : : : ;   iJt )   conditional on any (xjt ; zijt ;                       jt ) j2J    in their support. Since

  25
   Chernozhukov and Hansen (2005) discuss su¢ cient conditions. We also consider an alternative to As-
sumption 5 below.

                                                                                19
vijt = zijt +         ijt ,   the result follows.

       Our proof exploits the large support condition wherever possible, including in an “identi-
…cation at in…nity”argument (equation (10)) often employed in this literature (e.g., Matzkin
(1993)). However, we will show below that demand is identi…ed without this assumption,
and that even full identi…cation is robust to relaxation of the support assumption.26


5.2            Identi…cation with Mean-Independent Instruments

Any application of instrumental variables methods requires that the instruments induce
su¢ cient exogenous variation in the endogenous variables. Assumption 5 provides the ap-
propriate formal condition for the model (9), and this is the same condition that has been
used to show identi…cation of nonseparable regression models. Nonetheless, a possible limita-
tion of Theorem 2 is that Assumption 5 may be di¢ cult to check and/or interpret. Whether
there are useful su¢ cient conditions on economic primitives delivering this property is an
open question of broad interest in the literature on nonparametric instrumental variables
regression, but beyond the scope of this paper.27                                  However, if we are willing to impose
additional structure on the utility function, we can utilize a somewhat more intuitive suf-
…cient condition for full identi…cation. Doing so also enables us to relax the excludability
restriction to require only mean independence.
                                     (2)
       Conditioning on xt                  as in the prior section, suppose (for this subsection only) that each
consumer i’s conditional indirect utilities can be represented as


                                    vijt =    it zijt   + ~ j (xjt ; ! it ) +   it jt   j = 1; : : : ; J           (13)


where          it   and       it   are strictly positive with probability one and the expectations E [              it ],

E[     it ],   and E ~ j (xjt ; ! it ) jxjt are …nite. This imposes a restriction relative to (5) but is

  26
    See also Berry and Haile (2009a), which does not use an identi…cation at in…nity argument even for full
identi…cation.
  27
    In Berry and Haile (2009a) we explore an alternative argument relying on classical exclusion and support
conditions in an environment combining discrete choice demand with a partially speci…ed model of supply.


                                                                       20
still quite general relative to the prior literature. A representation of preferences equivalent
to (13) is
                       vijt = zijt +          j   xjt ;     jt ; ! it                8i; j = 1; : : : ; J                   (14)

where now
                                                                    ~ j (xjt ; ! it )           it
                                j   xjt ;    jt ; ! it     =                              +          jt :                   (15)
                                                                              it                it




   Here we also use a di¤erent normalization of                               jt .    Instead of letting    jt   have a standard
uniform distribution, we make the location normalization


                                                  E        jt       = 0 8j


and scale normalization
                                                                it
                                                       E                = 1:                                                (16)
                                                                it

Both are without further loss of generality.
   With this structure we can replace the full independence assumption (Assumption 4)
with mean independence.

Assumption 6. E        jt jwjt ; zijt   = 0 8j; t;wjt ; zijt .

   To show identi…cation of the joint distribution of fvijt gj2J conditional on xjt ; zijt ;                              jt j2J ,

…rst note that the marginal distribution of                     j     xjt ;     jt ; ! it   jt for each j is identi…ed using the
same argument used in the …rst lines of the proof of Theorem 2. This implies identi…cation
of the conditional means

                                        jt        E        j        xjt ;     jt ; ! it     t

for all j and t. With the separable structure (15) and the normalization (16), for each j and
t we have

                                                  jt   = Dj (xjt ) +                 jt


for some unknown function Dj . It is then straightforward to con…rm that, under Assumption

                                                                21
6, the following “completeness”condition is necessary and su¢ cient for identi…cation of each
function Dj from observation of (             jt ; xjt ; w̃jt )    (Newey and Powell (2003)).

Assumption 7. For all j and all functions Bj (xjt ) with …nite expectation, E [Bj (xjt ) jwjt ] =
0 a.s. implies Bj (xjt ) = 0 a.s.

       The completeness condition is the analog of the standard rank condition for identi…ability
in linear models.           Like the standard rank condition, completeness requires that variation
                                                    (1)
in wijt induce su¢ cient variation in xjt to distinguish the true function Dj ( ) from other
                    (1)
functions of xjt using the conditional mean restriction of Assumption 6.28
       We can now state a second full identi…cation result for the multinomial choice model.

Theorem 3. Under the representation of preferences in (14)-(15), suppose Assumptions 3,
6 and 7 hold. Then each             jt   and the joint distribution of fvijt gj2J conditional on any
 (xjt ; zijt ;   jt ) j2J   in their support are identi…ed.

Proof. From the preceding argument, under the completeness Assumption 7, we have iden-
ti…cation of each Dj and therefore of each                  jt .    The remainder of the proof then follows that
of Theorem 2 exactly, beginning with (12).



6        Identi…cation of Demand Using Limited Support

The large support assumption (Assumption 3) in the preceding section is common in the
literature but is obviously strong. Although our results describe only su¢ cient conditions for
identi…ability, it should not be surprising that a large support assumption may be needed for
full identi…cation of the random utility model: if the exogenous observables can move choice
probabilities only through a subset of the unit simplex, we should only hope to identify the
joint distribution of utilities on a subset of their support.                      Of course, one would like to
  28
   Lehman and Romano (2005) give standard su¢ cient conditions and references. See also Newey and
Powell (2003) and Severini and Tripathi (2006). If we add the assumption that E ~ j xjt ; jt jxjt is
bounded, the completeness assumption could be replaced with bounded completeness.



                                                              22
understand how heavily the results rely on the tails of the large support and what can be
learned from more limited variation. We explore these questions here.
       We show that more limited variation can be su¢ cient to identify demand, i.e., to identify
the unobservables      jt   and the structural choice probabilities   j   fxjt ;      jt ; zijt gj2J    at all points
of support. We also show continuity of the identi…ed features with respect to the support of
the micro data. In particular, moving from our limited support condition to the large support
condition moves the identi…ed features of the model smoothly toward the full identi…cation
results of the preceding sections.
       For multinomial choice we obtain these results under a somewhat more restrictive spec-
i…cation of preferences than that in (5).          Up to this quali…cation, however, these results
should be a comforting.          Demand is identi…ed without the large support condition. And
although we require the large support for full identi…ability of the random utility model in
the previous section, the identi…cation is not knife-edge: the tails of the large support are
needed only to determine the tails of the joint distributions of utilities.


6.1       Binary Choice

6.1.1      Identi…cation of Demand

As before, we begin with binary choice to illustrate our main insights. We begin with the
relaxed support condition on zit . We assume existence of one “common choice probability”
that is attainable in each market t by the appropriate choice of zit .

Assumption 8. For some q 2 (0; 1), for each market t there exists a unique ztq 2supp zit
such that Pr (yit = 1jzit = ztq ) = q.

       This requires su¢ cient variation in zit to push the choice probability to q in each market,
not over the whole interval (0; 1) in each market.29 This is not innocuous but is much less
demanding than the full support condition.
  29
    Implicitly we also require a continuous (region of) support for   (xt ;   t ; ! i ) jxt ; t   to ensure uniqueness
of each ztq .


                                                    23
   Consumer i chooses the inside good if


                                         zit + (xt ; t ; ! it ) > 0:


Under Assumption 8, for each market t we can …nd the value ztq such that


                           Pr (      (xt ; t ; ! it ) < zit jxt ; t ; zit )jzit =ztq = q:


Observe that each ztq is the qth quantile of the random variable                            (xt ; t ; ! it ) conditional
on t, i.e., on (xt ; t ). Thus, we can write


                                              ztq = (xt ; t ; q)                                                  (17)


for some function ( ; q) that is strictly decreasing in              t.   This strict monotonicity is the key
idea here: holding xt …xed, markets with high values of ztq are those with low values of the
unobservable    t.   Here we will revert to the uniform normalization of                      t.

   Identi…cation of the function         ( ; q) ; and therefore of each             t;   then follows from (17) as
in the preceding sections, using the nonparametric instrumental variables result of Cher-
nozhukov and Hansen (2005).            This holds under the same type of bounded completeness
assumption made in section 5.1; we state this condition formally as Assumption 12 in the
Appendix.     With each      t   known, the observable choice probabilities reveal the structural
choice probabilities
                                   (xt ; t ; zit ) = Pr (yit = 1jxt ; t ; zit )                                   (18)

at all points (xt ; t ; zit ) of support. This gives the following result.

Theorem 4. In the binary choice model with preferences given by (5), suppose Assump-
tions 4, 8, and 12 hold.         Then each      t   is identi…ed and the structural choice probabilities
 (xt ; t ; zit ) are identi…ed at all points (xt ; t ; zit ) in their support.




                                                       24
6.1.2      Continuity of the Identi…ed Features

Theorem 4 required only one common choice probability. If there is more than one, each
provides additional information about the distribution of vit jxt ; zit ; t . In particular, we can
identify a function ( ; q) in (17) for each common choice probability q, each then determining
the qth quantile of                (xt ; t ; ! it ) jxt ; t . Since vit = zit +         (xt ; t ; ! it ), this determines the
corresponding quantiles of the distribution of vit conditional on (xt ; t ; zit ). In the limit—
i.e., with su¢ cient variation in zit to make every q 2 (0; 1) a common choice probability— all
quantiles of vit conditional on (xt ; t ; zit ) are identi…ed, and we are back to full identi…cation
as in Theorem 2. This illustrates the notion of continuity of the identi…ed features described
above. It also shows that we require the tails of fzijt gj2J only to identify the tails of the
conditional distributions of utilities.


6.2       Multinomial Choice

For multinomial choice we will require a di¤erent representation of preferences:30


                                  vijt =    j   zijt +   jt ; xjt ; ! it        8i; j = 1; : : : ; J                     (19)


where each        j   is strictly increasing in its …rst argument. This is similar to (13) in requiring
that zijt and         jt   be perfectly substitutable. Here we require all consumers to have the same
marginal rate of substitution (normalized to one) between zijt and                                 jt ,   but allow the index
zijt +    jt   to enter the utility function in a fully nonparametric way.                             This restriction …xes
the scale of each           jt   but not the locations. So we set E                   jt   = 0 8j, leaving the marginal
distributions of each             jt   otherwise unrestricted.
       A key implication of (19) is that choice probabilities depend on the sums


                                                         ijt      zijt +   jt

  30
    Here we focus on identi…cation of demand. Continuity of the identi…ed features can be obtained as in
the binary model if we have the separable structure zijt + jt + j (xjt ; ! it ).



                                                                  25
rather than on zijt and       jt   separately. Thus, letting          t   =(   i1t ; : : : ;    iJt )   and xt = (x1t ; : : : ; xJt ),
we can write the structural choice probabilities as


                                                    j   ( t ;xt ) :


       For the multinomial choice model our results rely on invertibility of the mapping from
the latent indexes       t   to the market shares implied by utility maximization. To show that
this holds we require a weak notion of the choice set J being a set of substitute goods that
“belong”in the same market. To state this “connected substitutes”condition, we …rst need
a de…nition.

De…nition 1. Product k substitutes to product ` at (                      t ; xt )   if   `   ( t ; xt ) is strictly decreasing
            31
in     ikt .


       This de…nition provides a natural directional notion of one product’s being a substitute
for another. For example, if a reduction in              kt   leads (all else equal) to a larger market share
for product `, we say that product k substitutes to product `.
       Given any values of ( t ; xt ), let     (J ) denote the (J + 1)                        (J + 1) matrix of zeros and
ones, with the (r; c) element equal to one if product (r                       1) substitutes to product (c                        1) at
( t ; xt ). We will assume that the products j 2 J all belong in the same choice set in the
following sense.

Assumption 9 (“Connected Substitutes”). At any ( t ;xt ) such that (                                         1   ( t ;xt ) ; : : : ;   J   ( t ;xt ))
is on the interior of 4J , the directed graph of               (J ) is strongly connected.

       The directed graph of         (J ) has nodes (vertices) representing each product and an edge
from product k to product ` whenever product k substitutes to product `.32 The “connected
substitutes” condition requires that this graph include a directed path from every product
  31
     Because we introduce this de…nition after normalizing the utility of the outside good to zero, we de…ne
an increase in i0t to mean equal reductions in ijt for all j > 0. Thus product 0 substitutes to product j
if the probability good j is chosen goes up whenever ikt increases by an equal amount for all k > 0:
  32
    In standard models        (J ) will typically be symmetric, so the edges of its directed graph will be bi-
directional.

                                                          26
j 2 J to every other product j 0 2 J . Of course, the path between j and j 0 may be through
other nodes. Thus, for example, even a market with two independent goods satis…es this
condition if both substitute to and from the outside good.                          On the other hand, if the
connected substitutes condition fails, then there is some strict subset of J that substitute
only among themselves for some values of ( t ;xt ).                      In Berry and Haile (2009a) we provide
additional discussion of this condition and show that it is satis…ed in standard models. There
we also point out that this condition is equivalent to a condition used by Gandhi (2008) to
show invertibility of market shares. Using his argument, we can show the following result for
our framework, generalizing well-known invertibility results for linear discrete choice models
in Hotz and Miller (1993), Berry (1994) and Berry and Pakes (2007).33

Lemma 1. Consider any choice probability vector p = (p1 ; : : : ; pJ )0 on the interior of 4J .
Under Assumption 9, for any xt there is at most one vector                        2 RJ such that     j   ( ; xt ) = p j
for all j:

Proof. See Berry and Haile (2009a), Lemma 1.

       Finally, we generalize the previous common choice probability assumption in the natural
way.

Assumption 10. There exists q = (q0 ; q1 ; : : : ; qJ ) on the interior of 4J such that for each
market t there is a vector ztq = (z1t
                                   q             q
                                      ; : : : ; z1t ) 2supp(zi1t ; : : : ; ziJt t ) such that for all j; qj =
Pr(yit = j jx1t ; : : : ; xJt ; zi1t ; : : : ; ziJt t )zit =ztq :

       Assumption 10 requires the vector (zi1t ; : : : ; ziJt ) have su¢ cient support to drive the
choice probability vector to q in each market. The value of q satisfying this condition need
not be known a priori, since this is observable. Indeed, the existence of the common choice
  33
    Berry (1994) and Berry and Pakes (2007) show existence and uniqueness of an inverse choice probability
in models with an additive structure. Gandhi (2008) relaxes the separability requirement. Our lemma
addresses only uniqueness conditional on existence. Under the maintained assumption that the model is
correctly speci…ed, any observed choice probability vector must have a vector ( 1 ; : : : ; J ) that rationalizes it.
Gandhi (2008) provides additional conditions guaranteeing that an inverse exists for every choice probability
vector in 4J . Our uniqueness result di¤ers from his only slightly, mainly in recognizing that the argument
applies to a somewhat more general model of preferences.


                                                                    27
probability is directly testable. This condition still requires su¢ ciently rich J-dimensional
micro data; however, it is considerably weaker than the full support condition, which essen-
tially required all points in 4J to be common choice probabilities.
    With the connected substitutes and common choice probability assumptions, we can show
identi…cation of demand using the instrumental variables conditions of Newey and Powell
(2003).

Theorem 5. In the multinomial choice model with preferences given by (19), suppose As-
sumptions 6, 7, 9, and 10 hold. Then each                          jt   is identi…ed and the structural choice proba-
bilities   j   fxjt ;   jt ; zijt gj2J   are identi…ed at all fxjt ;              jt ; zijt gj2J    in their support.

Proof. Fix xt = (x1t ; : : : ; xJt ) and let q be the common choice probability vector.                                                   By
Assumption 10 and Lemma 1, there is a unique vector                                  (xt ; q) = (      1   (xt ; q) :; : : : ;   J   (xt ; q))
such that

                                              j   ( (xt ; q) ; xt ) = qj           8j:

Further, by the de…nitions of ztq and                j   (xt ; q),      j   (xt ; q) =     jt
                                                                                                   q
                                                                                                + zjt , so that


                                              q
                                             zjt =       j   (xt ; q)        jt   8j; t:                                                (20)


Under Assumptions 6 and 7, the equations (20) identify the functions                                           j   ( ; q) and each          jt

for all j and t, using the identi…cation result in Newey and Powell (2003) for nonparametric
regression with instrumental variables. As demonstrated above, knowledge of all                                             jt   identi…es
the structural choice probability functions.

    Note that, in contrast to the results in section 5, here the entire xt vector appears as an
argument of the “regression”function                     j    in (20). One implication is that characteristics of
competing products are not available as instruments.




                                                                  28
7        Testable Restrictions

The models we have considered incorporate several important maintained assumptions.
These include the existence of a vertical consumer-choice observable zijt , the restriction
to a scalar vertical market/choice-speci…c unobservable                                    jt ,   and the invariance of   jt   to zit .34
Here we show that these assumptions imply testable restrictions. We begin with the exis-
tence of the vertical consumer-choice observable zijt .

Remark 1. Suppose preferences can be characterized by (5), or by (19) with                                                     strictly
increasing in its …rst argument. Then Pr (yit = jjt; fzikt gk2J ) is increasing in zijt :

       This is immediate from the requirement that the utility from good j be strictly increasing
in zijt . Furthermore, it is clear that the restriction need not hold if utilities sometimes are
decreasing in zijt .
       The assumption of a scalar vertical unobservable also leads to testable implications.                                        For
simplicity we show this here for binary choice. To state the result it will be useful to recall
Theorem 4 and let            t   (ztq ; q; xt ) denote the value of                   t   identi…ed from the common choice
probability q in market t.

Remark 2. In the binary choice model with preferences given by (5), suppose Assumptions
4, 12, and 8 hold. Then               t   (ztq ; q; xt ) must be strictly decreasing in ztq across markets.

       This follows from the fact that vit is strictly increasing in both zit and                                  t   under the as-
sumptions of the model. Thus, the value ztq required to attain the common choice probability
q in market t will be higher when the unobservable                              t    is lower. The following example shows
one way that a model with a horizontal rather than a vertical unobservable characteristic
can lead to a violation of this restriction.

Example 2. Suppose                 (xt ; t ;     it )   =   it t ,   with       it        N(0; 1). Take q > 1=2 and consider
the set of markets in which                t   (ztq ; q; xt ) > 0. Recall that each ztq is observable and is de…ned

  34                                                         (1)          (1)
       Recall that zijt and zit refer to the original zijt and zit .



                                                                     29
such that Pr (          it t   < ztq ) = q. Letting                  denote the standard normal CDF, this requires

                                                                         ztq
                                                                                     =q             8t:                                                    (21)
                                                                             t


                                                ztq
Therefore, by construction,                           will take the same value in every market. Since each ztq must
                                                 t

also be positive when q > 1=2, this requires a strictly positive correspondence between ztq and

 t   across markets, violating the restriction from Theorem 2.

      The restriction in Remark 2 follows from the requirement of a vertical                                                                jt .    Additional
testable implications follow from the restriction to a scalar choice/market-speci…c unobserv-
able      jt   that is invariant to zit : the values of                                   jt   inferred from any any two common choice
probabilities must agree.

Remark 3. In the binary choice model with preferences given by (5), suppose Assumptions
4 and 12 hold. In addition, suppose q and q 0 are two common choice probabilities.                                                                        Then
                                q0
 t   (ztq ; q; xt ) =   t      zt ; q 0 ; xt for all t.
                                                                                                                       0
Proof. Under the assumptions of the model,                                            t   (ztq ; q; xt ) =      t    ztq ; q 0 ; xt =        t.


      The following example demonstrates that this restriction can fail if the assumption of a
scalar market/choice-speci…c unobservable is violated.

                                                                                                                           1           2
Example 3. Consider a model with two vertical unobservables,                                                               t   and     t.   Let

                                                                         8
                                                                         <           it
                                                                                               1
                                                                                                   +      2
                                                                                                                it   < 1=2
                                                  1 2                                          t          t
                                         xt ;     t ; t ; ! it      =
                                                                         :                     1
                                                                                                   +2      2
                                                                                                                          1=2
                                                                                     it        t           t    it


                                     1                2
with      it    u[0; 1]. Let         t   and          t       be independent, each uniform on (0; 1). By de…nition, when
zit = ztq only consumers with                             it   >1    q choose the inside good. Thus, the value of ztq is
determined by the preferences of the consumer with                                                        it   =1     q.           Now consider the        t   (q)
inferred under the incorrect assumption of a scalar unobservable.                                                                   From the observations
                                                                                          1         2
above, when q > 1=2 we have                               t    (q) = F   1
                                                                             +   2
                                                                                          t    +    t      where F    1
                                                                                                                          +    2   is the CDF of the sum
                                                                                                                                            1       2
of two independent uniform random variables.                                                       Thus, if for market t,                   t   +   t   falls at

                                                                                 30
the      quantile in the cross-section of markets,                                          t   (q) will equal . Similarly, for q 0 < 1=2,
                      1           1           2                          1         2
 t   (q 0 ) = F   1
                      +2   2      t   +2      t   ; i.e., if             t   +2    t   fall at the                 0
                                                                                                                       quantile of this sum in the cross
section of markets,                   t    (q 0 ) will be           0
                                                                        . In general,              6=      0
                                                                                                               :



8        Aggregate Data with Market Groups

In many applications one is forced to work without micro data linking choices to individual
characteristics, relying instead on market level choice probabilities (market shares). In Berry
and Haile (2009a) we explore identi…cation in such settings. However, in some environments
without individual level data the results in the present paper can still be reinterpreted to
apply.
                                                                                                                                               (i)   (ii)
      Without micro data, the observables are f(yit ; xjt )gj2J . Partition xjt into                                                          xjt ; xjt
and suppose preferences can be represented by conditional indirect utilities of the form


                                                                             (i)            (ii)
                                                               vijt = xjt + (xjt ;                     jt ; ! it ):                                  (22)


Assume further that the set of markets can be partitioned into market groups                                                                  such that
                           (ii)                         (ii)
for all t 2 , xjt ;                   jt     = xj ;             j         . One natural example of such an environment is that
of a national industry (e.g., the U.S. automobile industry) in which the physical products
themselves are identical across regions of the nation, but regions may di¤er in average income,
product prices (e.g., due to f.o.b. pricing), prices of complementary goods (e.g., gasoline),
availability of substitute goods (e.g., public transportation), etc.
      For simplicity, we illustrate the argument only for the case of full identi…cation with
exogenous product characteristics. However, all the identi…cation results obtained above
have analogs in this setting.

                                                  (i)               (i)       (ii)              (ii)
Assumption 11. supp (x1t ; : : : ; xJt )j(x1t ; : : : ; xJt ) = RJ 8t:

      Here we require su¢ cient variation in a special product characteristic rather than a special
consumer-product characteristic (cf. Assumption 3). Further, the notion of “market group”

                                                                                       31
now replaces the notion of “market”in our original framework. Within each market group,
 (i)
xjt can now play the role of the “micro data.”
       With this reinterpretation, the setup is isomorphic to that in section 5, and the prior
                                                    (i)                                        (i)
arguments apply directly. Variation in xjt across market groups at the limit xj 0 t !                   1 8j 0 6=
                                             (ii)                                                    (ii)
j identi…es the distribution of i xj ; j exactly as in section 5. Letting  xj ; j =
   h                      i
         (ii)      (ii)                                     (ii)
E i xj ; j jxj ; j , identi…cation of the function        xj ; j    (and therefore each

 j   ) follows exactly as in the previous sections.               With each      j   and the distribution of
        (ii)
 i     xj ;    j   known, the conditional joint distribution of fvijt gj2J              J ; (xjt ;   jt ) j2J    is
uniquely determined at any J ; (xjt ;               jt ) j2J   in their support.
       Because the setup here is isomorphic to that for the original micro data setting, extensions
                                                                     (ii)
to the case of endogenous characteristics (elements of xjt ), a separable error structure, and
identi…cation of demand with limited support follow directly as well.35



9        Conclusion

We have studied nonparametric identi…cation of models of multinomial choice demand, al-
lowing for market/choice-speci…c unobservables, endogenous choice characteristics, and ar-
bitrary random heterogeneity across consumers in tastes for products and/or characteristics.
We obtained full identi…cation using the same kind of large support assumption used to
show identi…cation in even the simplest semiparametric discrete choice models, and the
same instrumental variables conditions required for identi…cation of nonparametric regres-
  35
     An interesting but unresolved question is what can be learned in a single market with a large choice
set, i.e., with J ! 1 (see Berry, Linton, and Pakes (2004)). Suppose that xjt does not include product
dummies but preferences can still be represented by (5), imposing a symmetry condition that the same
function apply to all products. Fixing a market with a …nite choice set, the market share of the outside
good is
                                (1)                                (1)
                      p0 = Pr zi1 + (x1 ; 1 ; ! it ) < 0; : : : ; ziJ + (xJ ; J ; ! it ) < 0 :

For any …nite J, a large support condition would give identi…cation of the joint distribution of
( (x1 ; 1 ; ! it ) ; : : : ; (xJ ; J ; ! it )), so that each j med xj ; j ; ! it jxj ; j could be considered known.
As J ! 1 one would then obtain an arbitrarily good approximation of the joint distribution of ( j ; xj ). If
this joint distribution were instead known, the fact that j = D xj ; j would allow identi…cation of D from
the results of Chernozhukov and Hansen (2005). Identi…cation of demand and full identi…cation would then
follow.


                                                          32
sion models. Further, the results rely on the large support only for identi…cation of tail
probabilities, whereas identi…cation of demand holds under a signi…cantly weaker support
condition.      This is particularly encouraging given the su¢ ciency of the demand structure
for many questions motivating estimation of discrete choice demand models.
       While one goal of our work has been to obtain results with few restrictions on preferences,
there are some costs to a choice not to place more structure on the form of utility functions.
One is that some types of counterfactuals will not be identi…able. An example is demand
for a hypothetical product with characteristics outside their support in the data generating
process. This kind of limitation is not special to our setting, but inherent to empirical analy-
sis: extrapolation and interpolation typically require some parametric structure. Of course,
one may have more con…dence in extrapolations when identi…cation holds nonparametrically
within the support of the observables.
       A second limitation concerns welfare. Our model (5) incorporates quasilinear preferences.
This provides a speci…cation of cardinal utility that can be used to characterize changes in
utilitarian social welfare (in aggregate, or across subpopulations de…ned by observables)36
or changes in welfare under any social welfare function that is anonymous conditional on
observables.      However, our model lacks the structure required for welfare analysis that
depends on the distribution of changes in individual utilities. Characterization of Pareto
improvements, for example, would require tracking each individual consumer’s position in
the distribution of utilities before a policy change to that after. Our model speci…es a dis-
tribution of conditional indirect utilities, not a distribution of parameters whose realizations
can be associated with individual consumers. This points out a limitation of nonparametric
random utility models as a theoretical foundation for some kinds of welfare analysis: such
welfare calculations require additional a priori structure.
  36
    The quasilinearity generally will not be in income, but one can describe changes in aggregate compen-
                                                                              (1)
sating/equivalent variation in units of the normalized marginal utility for zijt . Income (and/or price) will
typically enter preferences through the function in (5). The potential nonlinearity of , combined with our
inability to track individuals’positions in the distributions of normalized utilities as the choice environment
varies, prevents characterization of aggregate compensating variation or equivalent variation in income units.
One could address this limitation with an assumption that vijt is linear in price. Further, in Berry and
                                                                                                           (1)
Haile (2009a) we provide conditions under which quasilinearity in price can replace quasilinearity in zijt .


                                                      33
       An example of a model with su¢ cient structure to address all types of welfare ques-
tions (and to extrapolate/interpolate) is the linear random coe¢ cients random utility model
(Example 1)
                                        vijt = xjt    it   + zijt +       jt   +   ijt :                             (23)

This generates a special case of our model, so we have provided conditions for identi…cation
of      jt j2J   and the joint distribution of fvijt gj2J j xjt ;                  jt ; zijt j2J .   However, it should
be clear that the joint distribution of (             it ; i1t ; : : : ; iJt )   is not identi…ed without additional
restrictions.37 Moving from our full identi…cation results to identi…cation of the distribution
of parameters in (23) is equivalent to the standard problem of identi…cation of a linear random
coe¢ cients regression model. Beran and Hall (1992) and Beran, Feuerverger, and Hall
(1996) have discussed su¢ cient conditions, which involve regularity and support requirements
beyond those required for our results.                     Whether pursuing this line of argument enables
any relaxation of existing identi…cation results for linear random coe¢ cients models (e.g.,
Ichimura and Thompson (1998), Briesch, Chintagunta, and Matzkin (2005), Gautier and
Kitamura (2007)) is an open question.
       Finally, while a novel aspect of our work is its examination of identi…cation without
large support conditions, even our weaker “common choice probability” condition requires
J-dimensional micro data.               One can easily imagine applications where this will not be
available. In the extreme, when no micro data are available, one is in the case of market-
level data, and we explore that setting in Berry and Haile (2009a).                              Whether the su¢ cient
conditions for identi…cation there could be relaxed in intermediate cases— where there is
some micro data, but of a lower dimension than that of the choice set— is an interesting
question for future work.




  37
     For any true model with the form (23), an observationally equivalent model is obtained by set-
ting it =              = 0 and letting the joint distribution of ( i1t ; : : : ; iJt ) jfxjt ; zijt ; jt gj2J equal that of
(vi1t    1t ; : : : ; viJt  Jt ) jfxjt ; zijt ; jt gj2J .


                                                             34
Appendix
      Here we state Assumption 12, used in Theorem 4. From equation (17) we have


                                             ztq = (xt ; t ; q)


where xt denotes the endogenous characteristic of choice 1.               Let fzq ( jxt ; wt ) denote the
density of ztq conditional on xt and the instruments wt . Fix some small positive constants
  ;   f   > 0. Fix q 2 (0; 1). For each     2 (0; 1), de…ne L ( ) to be the convex hull of functions
m ( ; ) that satisfy
(a) for all wt , Pr (ztq   m (xt ; ) jwt ) 2 [       ; +     ]; and
(b) for all x in the support of xt , m (x; ) 2 s(x)      f : f ( jx; w)       f   8w with fx (xjw) > 0g.

Assumption 12. For all             2 (0; 1), (i) for any bounded function B (x; ) = m (x; )
 (x; ; q) with m ( ; ) 2 L ( ) and "t         ztq   (xt ; ; q), E [B (xt ; )      (xt ; wt ; ) jwt ] = 0 a.s.
                                                R1
only if B (xt ; ) = 0 a.s., for     (x; w, ) = 0 f" ( B (x; ) jx; w) d .
(iii) the density f" (ejx; w) of   t   is continuous and bounded in e over R a.s.;
(iv) (xt ; ; q) 2 s (xt ) for all xt .



References

Ackerberg, D. A. (2001): “Empirically Distinguishing Informative and Prestige E¤ects
  of Advertising,”RAND Journal of Economics, 32(2), 316–333.

Altonji, J., and R. L. Matzkin (2005): “Cross-Section and Panel Data Estimators for
  Nonseparable Models with Endogenous Regressors,”Econometrica, 73, 1053–1102.

Anderson, S., A. DePalma, and F. Thisse (1992): Discrete Choice Theory of Product
  Di¤erentiation. MIT Press, Cambridge MA.

Athey, S., and G. W. Imbens (2007): “Discrete Choice Models with Multiple Unobserved
  Choice Characteristics,”International Economic Review, 48, 1159–1192.

                                                    35
Bayer, P., F. Ferreira, and R. McMillan (2007): “A Uni…ed Framework for Measuring
  Preferences for Schools and Neighborhoods,” Journal of Political Economy, 115(5), 588–
  638.

Beran, R., A. Feuerverger, and P. Hall (1996): “On Nonparametric Estimation
  of Intercept and Slope Distributions in Random Coe¢ cient Regression,” The Annals of
  Statistics, 240, 2569–2592.

Beran, R., and P. Hall (1992): “Estimating Coe¢ cient Distributions in Random Coef-
  …cient Regressions,”The Annals of Statistics, 20, 1970–1984.

Berry, S. (1994): “Estimating Discrete Choice Models of Product Di¤erentiation,”RAND
  Journal of Economics, 23(2), 242–262.

Berry, S., J. Levinsohn, and A. Pakes (1995): “Automobile Prices in Market Equilib-
  rium,”Econometrica, 60(4), 889–917.

         (2004): “Di¤erentiated Products Demand Systems from a Combination of Micro
  and Macro Data: The New Vehicle Market,”Journal of Political Economy, 112(1), 68–105.

Berry, S., O. Linton, and A. Pakes (2004): “Limit Theorems for Di¤erentiated Product
  Demand Systems,”Review of Economic Studies, 71(3), 613–614.

Berry, S. T., and P. A. Haile (2009a): “Identi…cation in Di¤erentiated Products Markets
  Using Market Level Data,”Discussion paper, Yale University.

         (2009b): “Identi…cation of a Nonparametrc Generalized Regression Model with
  Group E¤ects,”Discussion paper, Yale University.

Berry, S. T., and A. Pakes (2007): “The Pure Characteristics Demand Model,”Discus-
  sion paper, Yale University.

Blundell, R. W., and J. L. Powell (2004): “Endogeneity in Semiparametric Binary
  Response Models,”Review of Economic Studies, 71, 655–679.

                                           36
Bresnahan, T. (1981): “Departures from Marginal Cost Pricing in the American Auto-
  mobile Industry,”Journal of Econometrics, 17, 201–227.

Briesch, R. A., P. K. Chintagunta, and R. L. Matzkin (2005): “Nonparametric
  Discrete Choice Models with Unobserved Heterogeneity,”Discussion paper, Northwestern
  University.

Burda, M., M. Harding, and J. Hausman (2008): “A Bayesian Mixed Logit-Probit
  Model for Multinomial Choice,”Discussion paper, M.I.T.

Capps, C., D. Dranove, and M. Satterthwaite (2003): “Competition and Market
  Power in Option Demand Markets,”RAND Journal of Economics, 34(5), 737–763.

Chamberlain, G. (2010): “Binary Response Models for Panel Data: Identi…cation and
  Information,”Econometrica.

Chernozhukov, V., and C. Hansen (2005): “An IV Model of Quantile Treatment Ef-
  fects,”Econometrica, 73(1), 245–261.

Chiappori, P.-A., and I. Komunjer (2009): “On the Nonparametric Identi…cation of
  Multiple Choice Models,”Discussion paper, University of California San Diego.

Domencich, T., and D. McFadden (1975): Urban Travel Demand: A Behavioral Analy-
  sis. North Holland, Amsterdam.

Fox, J., and A. Gandhi (2009): “Identifying Heterogeneity in Economic Choice Models,”
  Discussion paper, University of Chicago.

Gandhi, A. (2008): “On the Nonparametric Foundations of Discrete Choice Demand Esti-
  mation,”Discussion paper, University of Wisconsin-Madison.

Gautier, E., and Y. Kitamura (2007): “Nonparametric Estimation in Random Coe¢ -
  cients Binary Choice Models,”Discussion paper, Yale.



                                             37
Gentzkow, M., and J. Shapiro (2009): “What Drives Media Slant? Evidence from U.S.
  Newspapers,”Econometrica.

Goldberg, P. K. (1995): “Product Di¤erentiation and Oligopoly in International Markets:
  The Case of the U.S. Automobile Industry,”Econometrica, 63(4), 891–951.

Guadagni, P. M., and J. D. C. Little (1983): “A Logit Model of Brand Choice Cali-
  brated on Scanner Data,”Marketing Science, 2(3), 203–238.

Hastings, J., D. Staiger, and T. Kane (2007): “Preferences and Heterogeneous Treat-
  ment E¤ects in a Public School Choice Lottery,”Discussion paper, Yale University.

Hausman, J., and D. Wise (1978): “A Conditional Probit Model for Qualitative Choice:
  Discrete Decisions Recognizing Interdependence and Heterogeneous Preferences,”Econo-
  metrica, 46, 403–426.

Hausman, J. A. (1996): “Valuation of New Goods under Perfect and Imperfect Compe-
  titioin,” in The Economics of New Goods, ed. by T. F. Bresnahan, and R. J. Gordon,
  chap. 5, pp. 209–248. University of Chicago Press, Chicago.

Hoderlein, S. (2008): “Endogeneity in Semiparametric Binary Random Coe¢ cient Mod-
  els,”Discussion paper, Brown University.

Hong, H., and E. Tamer (2004): “Endogenous Binary Choice Mode with Median Restric-
  tions,”Economics Letters, pp. 219–224.

Honoré, B. E., and A. Lewbel (2002): “Semiparametric Binary Choice Panel Data
  Models Without Strictly Exogenous Regressors,”emet, 70(5), 2053–2063.

Hotz, J., and R. A. Miller (1993): “Conditional Choice Probabilites and the Estimation
  of Dynamic Models,”Review of Economic Studies, 60, 497–529.

Ichimura, H., and T. S. Thompson (1998): “Maximum Likelihood Estimation of a
  Binary Choice Model with Random Coe¢ cients of Unknown Distribution,” Journal of
  Econometrics, 86(2), 269–95.

                                             38
Lehman, E., and J. P. Romano (2005): Testing Statistical Hypotheses. Springer, New
  York, 3 edn.

Lewbel, A. (2000): “Semiparametric Qualitative Response Model Estimation with Un-
  known Heteroscedasticity or Instrumental Variables,” Journal of Econometrics, 97, 145–
  177.

         (2005): “Simple Endogenous Binary Choice and Selection Panel Model Estimators,”
  Discussion paper, Boston College.

Magnac, T., and E. Maurin (2007): “Identi…cation and Information in Monotone Binary
  Models,”Journal of Econometrics, 139, 76–104.

Manski, C. F. (1985): “Semiparametric Analysis of Discrete Response: Asymptotic Prop-
  erties of the Maximum Score Estimator,”Journal of Econometrics, 27, 313–333.

         (1987): “Semiparametric Analysis of Random E¤ects Linear Models from Binary
  Panel Data,”Econometrica, 55, 357–362.

         (1988): “Identi…cation of Binary Response Models,”Journal of the American Sta-
  titical Association, 83(403), 729–738.

Manski, C. F., and D. A. Wise (1983): College choice in America. Harvard University
  Press, Cambridge, MA.

Matzkin, R. L. (1992): “Nonparametric and Distribution-Free Estimation of the Binary
  Choice and Threshold Crossing Models,”Econometrica, 60(2).

         (1993): “Nonparametric Identi…cation and Estimation of Polychotomous Choice
  Models,”Journal of Econometrics, 58.

         (2004): “Unobservable Instruments,”Discussion paper, Northwestern University.

         (2005): “Identi…cation in Nonparametric Simultaneous Equations,”Discussion pa-
  per, Northwestern University.

                                           39
          (2007a): “Heterogeneous Choice,” in Advances in Economics and Economet-
  rics, Theory and Applications, Ninth World Congress of the Econometric Society, ed.
  by R. Blundell, W. Newey, and T. Persson. Cambridge University Press.

        (2007b): “Nonparametric Identi…cation,”in Handbook of Econometrics, ed. by J. J.
  Heckman, and E. Leamer, vol. 6B. Elsevier.

         (2008): “Identi…cation in Nonparametric Simultaneous Equations,”Econometrica,
  76, 945–978.

Nevo, A. (2001): “Measuring Market Power in the Ready-to-Eat Cereal Industry,”Econo-
  metrica, 69(2), 307–42.

Newey, W. K., and J. L. Powell (2003): “Instrumental Variable Estimation in Non-
  parametric Models,”Econometrica, 71(5), 1565–1578.

Petrin, A. (2002): “Quantifying the Bene…ts of New Products: The Case of the Minivan,”
  JPE, 110(4), 705–729.

Petrin, A., and K. Train (2009): “A Control Function Approach to Endogeneity in
  Consumer Choice Models,”Journal of Marketing Research, forthcoming.

Poole, K. T., and H. Rosenthal (1985): “A Spatial Model for Legislative Roll Call
  Analysis,”American Journal of Political Science, 29(2), 357–384.

Quandt, R. E. (1966): “A Probabalistic Abstract Mode Model,” in Studies in Travel
  Demand, Volume II, pp. 90–113. Mathematica, Princeton, N.J.

         (1968): “Estimation of Modal Splits,”Transportation Research, 2, 41–50.

Rivers, D. (1988): “Heterogeneity in Models of Electoral Choice,” American Journal of
  Political Science, 32(3), 737–757.

Schultz, T. P. (1982): “Lifetime Migration within Educational Strata in Venezuela: Esti-
  mates of a Logistic Model,”Economic Development and Cultural Change, 30(3), 559–593.

                                           40
Severini, T. A., and G. Tripathi (2006): “Some Identi…cation Issues in Nonparametric
  Models with Endogenous Regressors,”Econometric Theory.

Waldfogel, J. (2003): “Preference Externalities: An Empirical Study of Who Bene…ts
  Whom in Di¤erentiated-Product Markets,”RAND Journal of Economics, 34(3), 557–568.




                                        41
