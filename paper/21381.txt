                                 NBER WORKING PAPER SERIES




                          LEARNING AND (OR) DOING:
               HUMAN CAPITAL INVESTMENTS AND OPTIMAL TAXATION

                                          Stefanie Stantcheva

                                         Working Paper 21381
                                 http://www.nber.org/papers/w21381


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                       July 2015




I want to thank James Poterba, Ivan Werning, and Emmanuel Saez for insightful comments. I also
thank participants at the MIT Public Finance Lunch and seminar participants at Berkeley, Michigan,
Princeton, Stanford, UPenn, Yale, Wharton, and Santa Barbara for their useful feedback and comments.
The views expressed herein are those of the author and do not necessarily reflect the views of the National
Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2015 by Stefanie Stantcheva. All rights reserved. Short sections of text, not to exceed two paragraphs,
may be quoted without explicit permission provided that full credit, including © notice, is given to
the source.
Learning and (or) Doing: Human Capital Investments and Optimal Taxation
Stefanie Stantcheva
NBER Working Paper No. 21381
July 2015
JEL No. H21,H23,H24,H53,J24

                                               ABSTRACT

This paper considers a dynamic taxation problem when agents can allocate their time between working
and investing in their human capital. Time investment in human capital, or "training," increases the
wage and can interact with an agent's intrinsic, exogenous, and stochastic earnings ability. It also interacts
with both current and future labor supply and there can be either "learning-and-doing" (when labor
and training are complements, like for on-the-job training) or "learning-or-doing" (when labor and
training are substitutes, like for college). Agents' abilities and labor supply are private information
to them, which leads to a dynamic mechanism design problem with incentive compatibility constraints.
At the optimum, the subsidy on training time is set so as to balance the total labor supply effect of
the subsidy and its distributional consequences. In a one-period version of the model, particularly simple
relations arise at the optimum between the labor wedge and the training wedge that can also be used
to test for the Pareto efficiency of existing tax and subsidy systems. In the limit case of learning-by-doing
(when training is a direct by-product of labor) or in the case in which agents who are more able at
work are also more able at training, there are important modifications to the labor wedge.


Stefanie Stantcheva
Department of Economics
Littauer Center 232
Harvard University
Cambridge, MA 02138
and NBER
sstantcheva@fas.harvard.edu
1     Introduction

Most people spend a lot of time acquiring human capital throughout their life. These time investments
can take many different forms: formal college, continuing education, online degrees, on-the-job training,
or vocational training.1 Mirroring the variety of possible training types, there is also a plethora of
different policies throughout the world that aim to encourage people to invest time in improving their
skills. They include subsidies, grants or loans for time spent in college, firm incentives for job training,
regulations regarding on-the-job training, or mixed arrangements such as apprenticeships.2 At the
same time, other important and far-reaching policies, such as income taxation or social insurance,
could have an ambiguous effect on time investments in human capital. Indeed, they not only affect the
returns to time investments, but also the allocation of time between training and working.
    Standard models of social insurance and taxation typically focus only on time spent working,
abstracting from the fact that time can also be allocated to improving one’s productivity.3 Therefore,
this paper studies the following issues: How should a comprehensive social insurance and tax system
take into account time spent acquiring human capital, called “training”? What makes time investments
in human capital different from other investments, such as investments in physical capital or material
investments in human capital? What parameters do we need to know to determine the optimal policies
regarding training time and the optimal tax system in the presence of training?
    The first goal of this paper is to provide a flexible life cycle framework that can capture the unique
characteristics of training time in order to answer these questions. The second goal is to solve for the
optimal taxation and training policies over the life cycle in this general model, and to point out how
they depend on some important parameters.
    The peculiarity of time investments in human capital is that they are intrinsically linked to a given
agent: their returns depend on an agent’s type and their costs depend on the agent’s labor supply.
Accordingly, the wage of agents in the model depends on their age, their endogenous human capital
stock, acquired through training, and on an exogenous, stochastic, and persistent earnings ability.
The stochastic ability causes earnings fluctuations against which agents try to insure themselves by
adjusting their labor supply, training choices, and risk-free savings. Ability and training can interact
in any arbitrary way in the wage function and the wage function can change with age, allowing for
    1
      Heckman (1976a) indirectly infers that 30% of time in early working years is spent training. 40% of adults participate
in formal and/or non-formal education in a given year in OECD countries, and receive on average 988 hours of instruction
in non-formal education during life, out of which 715 are job-related (OECD, 2013).
    2
      The most notable example of which is probably the German apprenticeship system that combines formal training
with hands-on experience.
    3
      See Mirrlees (1971), Saez (2001), Golosov et al. (2006), Albanesi and Sleet (2006), Farhi and Werning (2013). The
literature review will present some recent papers that have tried to relax this assumption.




                                                             1
different impacts of training at different points in life.
   In the model, agents can invest time in training in every year of their working lives. They incur a
disutility cost from working and training, and the disutility specification allows for any age-dependent
interaction between work and training effort. To characterize this interaction, I introduce two concepts
“Learning-or-doing” and “Learning-and-doing.” The former designates the case in which labor and
training time are subsitutes: time spent working cannot be spent training. In the limit, this corresponds
to the standard opportunity cost of time model as in Ben-Porath (1976). “Learning-and-doing” is the
case in which labor and training are complements. For instance, training could reduce the marginal
disutility of working by making agents more aware of how to optimize their work effort. The limit case
here is the canonical “learning-by-doing” model in which training is a direct by-product of labor.
   The government wants to minimize the resource cost of providing any level of redistribution and
insurance, but faces asymmetric information about agents’ abilities and labor efforts. Because of this
informational asymmetry, I solve a dynamic mechanism design problem with incentive compatibility
constraints.
   In order to build the intuition for the results, I first present a simple one-period version of the
dynamic model, which features a single realization of uncertainty and a one-shot investment in human
capital. I introduce the notion of a net wedge, as a measure of the net incentive that is provided for
training, after one has compensated the agent for the existence of other distortions, such as the labor
tax (and, in the dynamic model, the savings tax). A positive net wedge means that the government
wants to encourage training acquisition on net. The net wedge has three effects: The first is to increase
the wage by stimulating investments in training, which in turn increases labor supply. At the same
time, the presence of learning-or-doing or learning-and-doing directly affects labor supply positively
or negatively. The third effect is the differential impact of training on people with different abilities
that can increase or reduce inequality, depending on the wage function. The optimal subsidy balances
these three effects.
   At the optimum, whether training needs to be encouraged or discouraged on net depends on two
crucial parameters: the Hicksian coefficient of complementarity between training and ability in the wage
function and the Hicksian coefficient of complementarity between training and labor in the disutility
function. The net wedge decreases the more complementary human capital and ability are in the wage
function, decreases the more learning-or-doing there is, and increases the more learning-and-doing
there is. I derive a simple relation between the labor wedge and the training wedge at the optimum.
In some special cases, this relation has to remain constant over life and can be used to easily test for
the Pareto efficiency of any tax and subsidy system.


                                                      2
      In the dynamic model, the sign of the net wedge also depends on the interaction of contemporaneous
training with future labor supply, and the sign of this effect is exactly the opposite of the one on the
interaction with current labor supply. The amplitude of the net wedge is determined by an insurance
motive and the persistence of the ability shocks – factors which usually affect the dynamic labor tax
in models without human capital.4
      The labor wedge is not fundamentally affected by the presence of training, except in two cases. The
first is the limit case of learning-by-doing, in which training is a direct by product of (unobservable)
labor supply. In this case, the labor wedge indirectly provides incentives for human capital acquisition
as well as for labor supply. The second case is when more able agents are not only more productive at
working, but also at training.

Related Literature: This paper contributes to the long-standing optimal taxation literature as
developed by Mirrlees (1971) and Saez (2001), and especially to the dynamic taxation literature, as
in Kocherlakota (2005), Albanesi and Sleet (2006), Golosov et al. (2006), Kapicka (2013b), Werning
(2007a,b,c), Battaglini and Coate (2008a,b). Recent taxation papers seek to expand and improve the
canonical optimal taxation framework (see Rothschild and Scheuer (2014a,b), Scheuer (2013a,b), and
Shourideh (2012)). The life cycle results directly speak to age-dependent taxation as in Weinzierl
(2011). Particularly relevant are the dynamic taxation models of Golosov, Tsyvinski and Troshkin
(2013), Shourideh and Troshkin (2012), Golosov, Tsyvinski and Werquin (2014), Werquin (2014), and,
most importantly, the life cycle taxation model in Farhi and Werning (2013).
      This paper is also related to the large literature on human capital acquisition, starting with Becker
(1964), Ben-Porath (1967), and Heckman (1976a,b). The findings in Heckman, Todd and Lochner
(2005) can justify the assumption of a disutility cost of human capital investment, above and beyond
a pure opportunity cost of time.
      Some papers have considered taxation in the presence of human capital investments, but have
focused exclusively on monetary human capital expenses in static models (see Bovenberg and Jacobs
(2005), Maldonado, 2007, Bovenberg and Jacobs, 2011, DaCosta and Maestri, 2007.) Gelber and
Weinzierl (2012) consider parental investments in children’s future abilities.
      Dynamic papers that examine the impact of taxation on human capital bear important differences
to the current paper. Bohacek and Kapicka (2008) or Kapicka (2013) focus on heterogeneity, without
uncertainty in human capital returns. Findeisen and Sachs (2013) focus on a one-shot monetary
investment during “college,” different from the life cycle time investments with progressive realization
of uncertainty in this paper. Complementary papers are those by Kapicka and Neira (2014) with
  4
      See for instance, Farhi and Werning (2013).


                                                      3
unobservable human capital, and Krueger and Ludwig (2013) with an overlapping generations model
and Ramsey taxation.
        The closest paper is Stantcheva (2014), which considers monetary investments in human capital.
Time investments, as already emphasized earlier in the introduction, are very different under asymmet-
ric information.5 Their costs interact with the unobservable labor supply, which affects the incentive
provision mechanism in a way that monetary expenses on human capital or physical capital invest-
ments do not. Accordingly, the results are substantially different and introduce new concepts such
as the learning-or-doing or learning-and-doing, which turn out to be the major drivers of the optimal
training policies.
        The rest of the paper is organized as follows. Section 2 presents a model of work and training over
the life cycle. Section 3 solves for the optimal policies in a simple one-period version of the model
which helps build the intuitions. Section 4 sets up the dynamic planning problem and explains the
solution method. Section 5 presents the results on the optimal dynamic training policies. Section 6
digs deeper into how the optimal labor wedge depends on the specification of the model with training.
Section 7 numerically illustrates some of the results. Section 8 concludes.


2        A model of work and training

In this Section, I present a dynamic model with work and training. I then solve for the first-best
allocation if there is no asymmetric information between the Planner and agents.

2.1       Environment

The economy consists of agents who live for T years, during which they work and spend time investing
in human capital. Agents who work lt ≥ 0 hours in period t at a wage rate wt earn a gross income
yt = wt lt . Each period, agents can build their stock of human capital by spending time. These time
investments in human capital will be called “training.” They could represent time spent in college,
in formal classes or training courses, time spent reading, or, importantly, time spent for on-the-job
training. Let zt denote the stock of training time, or the stock of human capital of an agent, at time t
and it the incremental training time acquired in period t. Human capital zt , evolves according to

                                                    zt = zt−1 + it .

        The disutility cost to an agent who provides lt ≥ 0 units of work and spends it ≥ 0 units in training
    5
    Note that under perfect information, in the first best, and with no other frictions, any time cost could be converted
into an equivalent monetary cost and the distinction between time and money investments would be blurred. This is no
longer true under asymmetric information, unless training does not interact with labor supply, a special case which will
be explored in the paper.


                                                           4
is φt (lt , it ). φt is strictly increasing and convex in each of its arguments ( ∂φ(l,i) ∂φ(l,i)
                                                                                    ∂i , ∂l       > 0, ∀ l, i > 0;
∂ 2 φ(l,i) ∂ 2 φ(l,i)                                                                                                ∂ 2 φ(l,i) 6
   ∂l2
          , ∂i2         ≥ 0, ∀l, i); however, no assumption is yet made on the cross partial                           ∂l∂i .

       The wage rate wt is determined by the training acquired as of time t and by a stochastic ability θt :

                                                              wt = wt (θt , zt )

                                                                 ∂w                                   ∂2w
wt is strictly increasing and concave in each of its arguments ( ∂m > 0,                              ∂m2
                                                                                                            ≤ 0 for m = θ, z). Again,
there are no restrictions placed on the cross-partials yet. Note that because the wage depends on time
t, which is the equivalent of age for the given cohort, human capital and ability are allowed to have
different wage impacts at different times in life.
       Agents start their life at time t = 1 with a heterogeneous type θ1 , distributed according to a density
function f 1 (θ1 ). Earning ability in each period is private information, and evolves according to a
Markov process with a time-varying transition function f t (θt |θt−1 ) , over a fixed support Θ ≡ θ, θ̄ .
                                                                                                  

The ability shock θ can be interpreted in several different ways. It could be a health shock, an
idiosyncratic labor market shock, or a shock to the return to an agent’s skills. To follow the taxation
literature, θt will simply be called “ability” throughout.
       The agent’s per period utility is separable in consumption and in the effort required for labor and
training:                                                                                                       
                                                                                         yt
                               ũt (ct , yt , zt ; θt , zt−1 ) = ut (ct ) − φt                     , zt − zt−1
                                                                                     wt (θt , zt )
ut is increasing, twice continuously differentiable, and concave.
   Denote by θt the history of ability shocks up to period t, by Θt the set of possible histories at t,
and by P θt the probability of a history θt , P θt ≡ f t (θt |θt−1 ) ...f 2 (θ2 |θ1 ) f 1 (θ1 ) . An allocation
                                                  

{xt }t specifies consumption, output, and the training stock for each period t, conditional on the history
θt , i.e., xt = x θt Θt = c θt , y θt , z θt Θt . The expected lifetime utility from an allocation,
                                           

discounted by a factor β, is given by:


            c θt , y θt , z θt
                             
  U
                                          T Z
                                                                                     y (θt )
                                          X                                                                      
                                                     t−1           t                                   t      t−1
                                                                                                                      P θt dθt
                                                                                                                      
                                      =          β          ut c θ      − φt                       ,z θ − z θ                       (1)
                                          t=1
                                                                                 wt (θt , z (θt ))

where, with some abuse of notation, dθt ≡ dθt ...dθ1 .
       Let wm,t denote the partial of the wage function with respect to argument m (m ∈ {θ, z}), and
wmn,t the second order partial with respect to arguments m,n ∈ {θ, z} × {θ, z}.
       There are two important parameters that drive the optimal policies. The first is the Hicksian
coefficient of complementarity between ability and training in the wage function at time t, denoted by
   6
       The Appendix links this model to the standard Ben-Porath model.


                                                                      5
ρθz :7
                                                             wθz w
                                                   ρθz ≡                                                                   (2)
                                                             wz wθ
A positive Hicksian complementarity between human capital z and ability θ means that the effect of
ability on the wage is amplified by human capital z, i.e, that human capital and ability are complements
(wθz ≥ 0). Put differently, human capital compounds the exposure of the agent to stochastic ability
and to risk. A Hicksian complementarity greater than 1 means that the wage elasticity with respect
                                                 ∂ ∂w θ      8
                                                        
to ability is increasing in human capital, i.e., ∂z ∂θ w ≥ 0. Some simple cases can illustrate the

complementarity coefficient: A separable wage such as wt = θt + ht (zt ), where ht is an increasing,
concave function, has ρθz,t = 0. A multiplicative wage wt = θt ht (z) has ρθz,t = 1. A CES wage such
as:
                                                                    1
                                        wt = α1t θ1−ρt + α2t z 1−ρt 1−ρt
                                            
                                                                                                                           (3)

has ρθz,t = ρt .


2.1.1      Learning-and-doing and Learning-or-doing

For training time, the most important parameter will be the one that characterizes the interaction
between training and labor. Define ρφlz to be the Hicksian complementarity coefficient between labor
and training in the disutility function φ:


                                                             φlz φ
                                                    ρφlz ≡                                                                 (4)
                                                             φl φz
                                                                                    ∂φt              ∂φt               ∂2φ
where the partials and second order partials of φ are denoted by: φz,t ≡            ∂zt ,   φl,t ≡   ∂lt ,   φlz,t ≡   ∂l∂z .

       How can we interpret this disutility function? It is really just a general way of capturing everything
in between two polar cases we often consider in the labor literature, namely an “opportunity cost of
time” specification, as in the canonical Ben-Porath (1967) model, and the “learning-by-doing” model
of Arrow (1962). In the former, training time and work time are perfect substitutes and time spent
training cannot be spent working. This can be captured by a disutility function linear in i and l, with a
total time endowment constraint. In the learning-by-doing case, the disutility is a Leontieff function.9
       But in between these two polar cases, there are many other possibilities. A less extreme case of
opportunity cost of time is when training and labor are substitutes, but not perfect ones. Time spent
training takes away effort from working. Fatigue effects may set in, at a convex rate. In this case, the
   7
     On studies of the Hicksian complementarity as see Hicks (1970), Samuelson (1973), Bovenberg and Jacobs (2011).
   8
     Equivalently, the wage elasticity with respect to human capital is increasing in ability.
   9
     This equivalence between training and labor in the learning-by-doing case ignores the fact that, in the planning
problem, labor is unobservable while training is not. Section 6.2 will consider this limit case in more detail.



                                                         6
Hicksian complementarity between training and labor in the disutility function is positive (ρφlz,t > 0), a
case I will label “Learning-or-doing.” Similarly, a less extreme case of learning-by-doing is when labor
supply and training are complements over at least some range (ρφlz,t < 0). The reasoning could be the
same as the standard learning-by-doing justification: skills or experience acquired by working might
make training less costly at the margin. Or, less commonly thought, the guarantee of regular training,
which gives workers a prospective for progress, might boost motivation and make labor effort seem less
painful. I will call this case “Learning-and-doing.”
    In addition, at different levels of training and labor supply, different effects could dominate: for
instance, labor and training could be complementary at low levels, but substitutable at high levels of
labor supply. The formulation is general enough to accommodate all these cases. Of course, the results
on optimal training policies in both the static and dynamic cases (Sections 3 and 5) will strongly
depend on this interaction between training and labor.

2.2    First best planning problem

Before turning to the planning problem under asymmetric information, let us first consider the first
best solution that would arise if the Planner had the same information as the agent. In the first best,
the Planner seeks to maximize the lifetime expected utility in (1) subject to the intertemporal resource
constraint, where R is the gross, exogenously given, borrowing rate:
                                        T  t−1 Z
                                        X  1
                                                            ct θt − yt θt P θt dθt ≤ 0
                                                                           
                                        t=1
                                              R        Θt

                           1
 Suppose that β =          R.
                         There is perfect insurance against earnings risk, as consumption is equalized
across all histories: u0 ct θt = λ, with λ the multiplier on the resource constraint. Output and
                              

training for each θt , given any level zt−1 , solve simultaneously:
                                                                
                                            yt
                                 φl,t                 , zt − zt−1 = wt (θt , zt ) λ
                                        wt (θt , zt )

                                                                    T
                                                                             1                                          
                         φ−1,l                                                                   −1,l
                                                                    X
              φz,t        l,t    (wt λ, zt − zt−1 ) , zt − zt−1 =              τ −t
                                                                                    Et   w z,τ φ l,τ  (wτ λ, zτ − z τ −1 )   λ
                                                                    τ =t
                                                                           R
Hence, higher ability agents produce more output, for a given level of training. The optimal training
equates the marginal disutility of training to its marginal benefit. The marginal expected benefit of
training is increasing in ability, as long as training and ability are complements in the wage function
 2        
  ∂ w
  ∂θ∂z ≥ 0   and assumption 2 i) holds. The cost of training, however, can also rise or fall with ability
depending on whether there is learning-or-doing or learning-and-doing. If the latter is prevalent, or if
there is no interaction between labor supply and training (φ is separable), then unambiguously higher



                                                                    7
types both work more and train more. However, if learning-or-doing is prevalent, higher types face both
a higher marginal benefit, and a higher marginal disutility from training. The net effect is ambiguous.
    When there is asymmetric information about the types θ between the Planner and the agents, this
first-best allocation is no longer achievable. The second-best allocation will have to take into account
the agents’ incentive compatibility constraints, an issue to which I turn now.


3     Illustrating the Optimal Policies in a Simple One-Period Model

Before solving the full-fledged dynamic planning problem, it is informative to draw out all the main
effects in a one-period model. The dynamic solution in Section 5 will extend these results, and it is
very helpful to build up the intuition from the static case.

3.1   Gross wedges versus net wedges

In the second best, ability θ is private information to the agent. Consumption and output are observ-
able. Because of the asymmetric information, the allocations will be distorted. The marginal distortions
in agents’ choices can be described using “wedges,” which represent the implicit local marginal tax and
subsidy rates (see Golosov et al. (2006) for an introduction to the wedges in dynamic public finance).
The wedges capture the magnitudes and signs of distortions in the allocation relative to the laissez-
faire (or, autarky) allocation. They are just definitions of variables that, evaluated at the optimal
second-best allocation, will characterize that allocation in a way analogous to taxes. Expressing the
properties of the optimal allocation in terms of wedges allows us to appeal to intuitions related to a
standard tax system.
    In the one-period model, suppose that types θ are distributed according to a distribution f (θ) on
Θ and that the starting stock of training is zero. Hence, z = i.
    For a given type θ, define the labor wedge τL (θ) and the training wedge τZ (θ) as follows:

                                                     φl (l, z)
                                   τL (θ) ≡ 1 −                                                      (5)
                                                   w(θ, z)u0 (c)
                                                φz
                                   τZ (θ) ≡           − (1 − τL (θ))wz l                             (6)
                                               u0 (c)

    The labor wedge τL is defined as the gap between the marginal rate of substitution and the marginal
rate of transformation between consumption and labor. It is akin to a locally linear marginal tax
because, without any government intervention, it would be zero. On the other hand, if the government
would set the marginal labor tax for agents of type θ equal to τL (θ) and let these agents optimize their
labor supply in a small neighborhood around their optimal allocation, and conditional on the optimal
training choice, they would choose their labor supply so that this relation would hold.

                                                    8
       The implicit subsidy on training τZ can be thought of as the incremental pay received by an agent
for training for one more unit of time. If the implicit subsidy is positive, human capital is distorted
upwards. Like any subsidy, it is defined as the gap between marginal cost and marginal benefit. The
only subtlety is that, since training entails a disutility cost, the right-hand side is scaled by marginal
utility in order to convert it to a dollar amount.
       Without the presence of training, the wedges just defined would be sufficient to characterize the
allocation. However, there are two simultaneous distortions: saying that the wegde on human capital,
τZ , is zero does not actually mean human capital is undistorted – if there is a positive labor wegde
τL > 0, then human capital is still distorted downwards, as part of its return is taxed away.
       It would thus be useful to find a measure of the net distortion on human capital, the one that goes
beyond just compensating for the presence of a labor distortion. We can ask: what is the subsidy on
human capital needed to exactly undo the labor distortion on human capital?
       To answer this, let’s consider a thought-experiment. Suppose that we set the training subsidy to
be τZ = τL ( uφ0 (c)
                  z
                     ). Then, locally, for a given labor supply l, the agent solves:

                                     max u(w(z, θ)l(1 − τL ) + τZ z) − φ(z, l)
                                       z


The first-order condition of the agent with respect to training then yields:

                                                                   φz
                                 wz lu0 (c)(1 − τL ) + u0 (c)τL          − φz (z, l) = 0
                                                                  u0 (c)

where we have used the supposed relation between τL and τZ . This implies that: (1 − τL )(wz lu0 (c) −
φz ) = 0, i.e., conditional on the labor choice, human capital is set optimally.
       This relation between τL and τZ is the equivalent of making training costs fully tax deductible from
the income tax base. More precisely, the agent is allowed to convert his disutility costs into monetary
equivalents, and then deduct this monetary equivalent from his income tax base.10
       Inspired by this example, let us define the net wedge on training as the gross wedge minus the
amount needed to compensate the agent for the distortion on labor.

Definition 1 The (static) net wedge on training time tz is defined as:

                                                       τZ − τL ( uφ0 (c)
                                                                      z
                                                                         )
                                            tz ≡                                                                     (7)
                                                   (( uφ0 (c)
                                                           z
                                                              ) − τZ )(1 − τL )

       As a matter of definition, the net wedge is scaled in the denominator by the net (monetary) cost
of training and the net of tax rate. This will serve to make the optimal formulas simpler.
  10
   This idea of full deductibility holds perfectly locally and conditional on the labor choice. Of course, given that the
wedges are nonlinear and conditional on the type, the analogy does not hold globally.


                                                            9
      It will be useful to denote by εxy the elasticity of any variable x with respect to variable y, εxy ≡
d log (x) /d log (y). Let εu and εc be the uncompensated and compensated labor supply elasticities to
the net wage, holding training fixed.11

3.2     The one-period planning problem

I briefly set up the planning problem in the static case: the full-fledged dynamic problem is rigorously
explained in Section 5 and nests this simple static case. Hence, many technical details (in particular,
about how the first-order approach works) are omitted here. Hence, the reader interested in the
derivations can refer to Section 5 and to the proofs in the Appendix.
      Let ω(θ) denote the utility of an agent of type θ:

                                           ω(θ) = u(c(θ)) − φ(l(θ), z(θ)).

I use a first-order approach that consists in replacing the incentive compatibility constraints by envelope
conditions of the agents. The envelope condition tells us how the utility for each type has to vary at
the optimum and how the informational rent received by each type evolves. In this one-period case,
the envelope condition is simply:12


                                                  ∂ω(θ)   wθ
                                      ω̇(θ) :=          =    l(θ)φl (l(θ), z(θ))
                                                   ∂θ     w
The one-period planning problem is then to minimize resources:
                                    Z
                               min (c(θ) − l(θ)w(z(θ), θ))f (θ)dθ

subject to the envelope condition and the utility constraint for each type:

                                                     ω(θ) ≥ ω(θ).

where the vector of lower bounds for utility is arbitrarily given.

3.3     The optimal training wedge

The next proposition (a special case of the full fledged, dynamic optimum in Proposition 2) shows how
the net wedge is set at the optimum.

Proposition 1 At the optimum, the net subsidy for training and the labor wedge are set according to:

                                                 τL∗ (θ)    εc              εφz φ
                                   t∗z (θ) =          ∗          (1 − ρθz −    ρ )                     (8)
                                               1 − τL (θ) 1 + εu            εwz lz
 11                                                        c
    With utility separable in consumption and labor, 1+εεu −εc is the Frisch elasticity of labor.
 12
    This is just a special case of the dynamic envelope condition in (16).


                                                            10
where: εφz ≡ d log(φ)/d log(z) is the elasticity of disutility with respect to training time. ρφlz is the
Hicksian coefficient of complementarity between l and z in the disutility φ as defined in (4).

       In this one-period model, there are three effects from subsidizing training that are balanced at
the optimum. First, a higher net wedge increases investments in training, and, hence, increases the
wage and labor supply. This is the so-called “labor supply effect.” However, there is also a differential
effect on different ability types. If ρθz > 0, training benefits able agents more and further spreads out
earnings inequality. On the other hand, if ρθs < 0, earnings inequality is compressed by training. This
is the so-called “inequality effect.” Given that ability is stochastic here, a complementarity to ability
also increases risk exposure.
       In mechanism design language, the inequality effect is just the result of the informational rent
that needs to be forfeited to higher ability agents. When ρθz > 0, the informational rent increases in
training.
    The third effect is the direct interaction with labor supply through the disutility function, i.e.,
                                                                            
                                                                     εφz φ
either learning-or-doing or learning-and-doing. In the formula, 1 − εwz ρlz,t is the total effect of the
bonus on labor, i.e., the sum of the labor supply effect (the increase in labor due to the higher wage),
and either one of the learning-and-doing or learning-or-doing effects, which can increase or decrease
work.
       Rearranging this, we can see that the total effect of a training subsidy on labor is positive if and
only if
                                            εwz > εφl z with εφl z ≡ ∂ log (φl ) /∂ log (z)

i.e., if and only if the wage is more sensitive to training than the marginal disutility of work is.13
       The question then is, whether the increase in total resources from the total labor effect of training
more than makes up for the increased rent transfers (the inequality effect). The net subsidy on training
will be positive if and only if the answer to this question is yes.

Corollary 1 The static net subsidy on training is positive if and only if:

                                                                   εφz φ
                                                              1−      ρ > ρθz                            (9)
                                                                   εwz lz

       With learning-and-doing (ρφlz < 0), as long as ability and human capital are not too complementary
(say, ρθz < 1), the net subsidy on training is positive. Intuitively, training does not distract from labor
effort, and so it’s good to encourage it as long as high types do not disproportionately benefit from
it. However, if there is learning-or-doing, training makes labor supply more costly. In this case, even
  13
       Note that: (εφz,t /εwz,t ) ρφlz,t = εφl z,t /εwz,t .


                                                                     11
if the coefficient of complementarity ρθz is small, it might not be sufficiently small to compensate for
the lost work effort.

Testing for Pareto efficiency: Note that the simple relation derived between the labor wedge and
the training wedge in (8) can be used to test for the optimality of an allocation.
   In the special cases highlighted in the next two subsections, that relation is constant over time and
does not depend on the exact allocation. In this case, we can use the ratio of the labor wedge and the
training wedge to test for Pareto efficiency of any tax schedule.
   As a special case, note that if the wage is multiplicatively separable and φ is additively separable,
we have ρθz = 1 and ρφlz = 0, and, accordingly, tz = 0. This case turns out to be of special interest, as
explained next.

3.4      A special case: an application of Atkinson-Stiglitz

The special case in which the wage is multiplicatively separable and φ is additively separable is an
application of the Atkinson-Stiglitz theorem (Atkinson and Stiglitz, 1976). Let the separable disutility
function φ(l, z) be given by: φ(l, z) = φ1 (l) + φ2 (z). The separable utility then satisfies all assumptions
of the Atkinson-Stiglitz theorem, where the two commodities are c and z.
   We can directly show that, in this case, the tax schedule should be neutral with respect to human
capital by using a simple variational argument.
   Recall that the objective is to maximize net resources (or minimize net cost):


                                      c(θ, ẑ(θ)) − l(θ, ẑ(θ))w(θ, ẑ(θ))                              (10)

where ẑ(θ) is a perturbation from z(θ) and c(θ, ẑ(θ)), l(θ, ẑ(θ)) are the solutions to the two constraints
below, as a function of ẑ(θ). Taking the first-order condition with respect to ẑ yields:
                                       ∂c    ∂l                      ∂w
                                           −     w(θ, ẑ) − l(θ, ẑ)                                    (11)
                                       ∂ ẑ ∂ ẑ                     ∂ ẑ
There are, as previously explained, two constraints on this problem. The first one is the envelope
condition for an agent of type θ, given here by:
                                                    wθ
                                          ω̇(θ) =      l(θ)φ10 (l(θ))                                   (12)
                                                    w
                                              wθ
The case with ρθz = 1 is the case where       w    does not change as z changes, so that at the optimum
given these parameters, this constraint yields dl/dz = 0.
   The second constraint is that utility for each type is unchanged. Using the implicit function theorem
gives:
                                u0 (c(θ))dc − φ10 (l(θ))dl − φ20 (z(θ))dz = 0                           (13)

                                                      12
Substituting this into the first-order condition, yields:


                                               φ20 (z(θ))        ∂w
                                                 0
                                                          − l(θ)    =0                                                (14)
                                               u (c(θ))          ∂z
Hence, conditional on l(θ) and c(θ), z(θ) should not be distorted. If we replace the definitions of τZ
and τL from above, and rearrange to make tz appear, this will be equivalent to tz = 0.

3.5      Other Special cases

There are three other special cases that are illustrative because they yield particularly simple relations
at the optimum between the training wedge and the labor wedge. Note that each of these special
relations will also hold in the dynamic model, if human capital fully depreciates between periods.

Multiplicatively separable wage and Cobb-Douglas disutility: Suppose that the wage is mul-
tiplicatively separable
                                                       w(θ, z) = θz

and the disutility is Cobb-Douglas:
                                                                1 γ α
                                                   φ(l, z) =      l z .
                                                               γα
In this case, ρφlz = 1, εφz = α, and εwz = 1, so that the formula for the optimal wedge yields a very
simple negative relation between the optimal labor wedge and the optimal training wedge at any point
in the skill distribution:


                                                                τL∗ (θ) α
                                                t∗z (θ) = −
                                                              1 − τL∗ (θ) γ
       Based on the fact that at every interior type τL > 0, we can sign the wedges.14 In this case,
tz (θ) < 0 at any interior type.

CES wage and separable disutility: Suppose that the wage takes a CES form

                                                                              1
                                             w(θ, z) = (θ1−ρ + z 1−ρ ) 1−ρ

and the disutility is separable with φ(l, z) = φ1 (l) + φ2 (z). Then, we have that ρθz = ρ and ρφlz = 0 so
that at the optimum:


                                                        τL∗ (θ)     εc
                                          t∗z (θ) =                      (1 − ρ)
                                                      1 − τL∗ (θ) 1 + εu
  14
    It is shown that the optimal labor wedge is positive for all interior types in the proof of proposition 2. There, it is
also shown that τL is optimally zero for the lowest and highest types.



                                                             13
If the disutility is in addition isoelastic in labor with φ1 (l) = γ1 lγ , then we have:


                                                                τL∗ (θ) (1 − ρ)
                                                  t∗z (θ) =
                                                              1 − τL∗ (θ) γ
Hence, the net wedge on training is positive if and only if ρθz < 1, i.e., if ability and training are not
too complementary in generating earnings.

Separable wage and Cobb-Douglas disutility: Suppose that the wage is separable with

                                                        w(θ, z) = θ + z

and the disutility is again Cobb-Douglas as above. Then the optimal training wedge is set according
to:


                                                                τL∗ (θ) (1 − α)
                                                  t∗z (θ) =
                                                              1 − τL∗ (θ)  γ
In this case, the optimal wedge is again negative since α > 1. See also Section 5.3 for a version of this
special case in the dynamic model.
      Equipped with the intuitions and results from this simple one-period model, I now turn to solving
the full dynamic life cycle model.


4         The dynamic planning problem

In the dynamic problem, the planner cannot see the ability realization θt in any period. Thus, the
wage realization wt (θt , zt ) , or labor supply lt = yt /wt are also unknown. Output yt , consumption ct ,
and training zt on the other hand are still observable in every period.
      The solution method of such a dynamic mechanism design problem is based on Farhi and Werning
(2013) and Stantcheva (2014). It is hence presented only briefly here. The reader can refer to Stantcheva
(2014) for a more detailed presentation of this approach.
      To solve for the constrained efficient allocations, I suppose that the planner designs a direct reve-
lation mechanism, in which agents report their types each period and the planner assigns allocations
as a function of the history of reports made. Each agent has a history of reports as a function of his
true history of shocks, and this history of reports is denoted by rt (θt ). For any reporting strategy r,
define the continuation value after history θt to be:

                                           y (rt (θt ))
                                                                                         
      r   t         t   t
                                                             , z rt θt − z rt−1 θt−1
                                                                                   
    ω (θ ) = ut (c(r (θ ))) − φt
                                       wt (θt , z(rt (θt )))
                                                                                              Z
                                                                                                  ω r θt+1 f t+1 (θt+1 |θt ) dθt+1
                                                                                                          
                                                                                    +β


                                                                 14
       The continuation value under truthful revelation, ω θt , is the unique solution to:
                                                             

                                                                  y (θt )
                                                                                                  Z
                  t                       t                                        t      t−1
                                                                                                 + β ω θt+1 f t+1 (θt+1 |θt ) dθt+1
                                                                                                      
            ω θ           = ut c θ                 − φt                        ,z θ − z θ
                                                              wt (θt , z(θt ))
Incentive compatibility requires that truth-telling yields a weakly higher continuation utility than any
reporting strategy r, after all histories θt :

                                                                   (IC) : ω θt ≥ ω r θt                  ∀θt , ∀r
                                                                                       
                                                                                                                                                          (15)

                                                                               ∂φ(l,i) ∂w(θ,z) l                      ∂f t (θt |θt−1 )
Assumption 1 i) ũt (c, y, z; θ, z− ) and                                        ∂l      ∂θ    w   are bounded. ii)       ∂θt−1          exists and is bounded.
iii) f t (θt |θt−1 ) has full support on Θ.

       The first order approach consists in replacing the incentive constraint by the envelope condition of
the agent. As in Section 3, it constrains the informational rent of each type of agent. In this dynamic
model, there is an additional future term that captures the fact that the agent has some advance
information about his future type because of the Markov persistence.

           ∂ω θt
                 
                                                                          ∂f t+1 (θt+1 |θt )
                                                                   Z
      t               wθ,t
                           l θt φl,t l θt , zt θt − zt−1 θt−1 + β ω θt+1
                                                         
  ω̇ θ :=          =                                                                          dθt+1
             ∂θt       wt                                                        ∂θt
                                                                                                 (16)
       The envelope condition is only a necessary condition for incentive compatibility.15 I use a numerical
ex post verification procedure to ensure that the solution found is indeed incentive compatible (see
Farhi and Werning (2013) and Stantcheva (2014) for more details).
       The next step is to rewrite the problem recursively. Denote the gradient of the expected future
continuation utility with respect to the type by:

                                                                                             ∂f t+1 (θt+1 |θt )
                                                                               Z
                                                                   t
                                                                                   ω θt+1
                                                                       
                                                          ∆ θ              ≡                                     dθt+1                                    (17)
                                                                                                    ∂θt

The envelope condition can then be rewritten as:

                                     wθ,t
                               ω̇ θt =     l θt φl,t l θt , zt θt − zt−1 θt−1 + β∆ θt
                                                                                 
                                                                                                                                                          (18)
                                       wt

Let v θt be the expected future continuation utility:
        

                                                                               Z
                                                                   t
                                                                                   ω θt+1 f t+1 (θt+1 |θt ) dθt+1
                                                                                        
                                                          v θ              ≡                                                                              (19)

Continuation utility ω θt can hence be rewritten as:
                         

                                                                                                                           !
                                                                                       y θt
                                                                                              
                                  t                           t                                            t         t−1            t
                                                                                                                                 
                            ω θ           = ut c θ                     − φt                          , z θ     − z θ         + βv θ                       (20)
                                                                                   wt (θt , z (θt ))
  15
       An application of Theorem 2 in Milgrom and Segal (2002), under assumption 1.


                                                                                            15
Define the expected continuation cost of the planner at time t, given vt−1 , ∆t−1 , θt−1 , and zt−1 :
                                                         T      Z
                                                        X    1
                         K(v, ∆, θt−1 , zt−1 , t) = min[ ( )τ −t (cτ (θτ ) − yτ (θτ )P (θτ −t )dθτ −t ]
                                                        τ =t
                                                             R
where, with some abuse of notation, dθτ −t = dθτ dθτ −1 ...dθt , and P θτ −t = f τ (θτ |θτ −1 ) ...f t (θt |θt−1 ).
                                                                            

       A recursive formulation of the relaxed program is then for t ≥ 2:

                                        Z
                                                                                  1
  K (v, ∆, θ− , z− , t) = min                (c (θ) − wt (θ, z (θ)) l (θ) +         K (v (θ) , ∆ (θ) , θ, z (θ) , t + 1))f t (θ|θ− ) dθ   (21)
                                                                                  R

subject to:

                                             ω (θ) = ut (c (θ)) − φt (l (θ) , z (θ) − z− ) + βv (θ)
                                                      wθ,t
                                             ω̇ (θ) =      l (θ) φl,t (l (θ) , z (θ) − z− ) + β∆ (θ)
                                                       w
                                                      Z t
                                                  v = ω (θ) f t (θ|θ− ) dθ

                                                                ∂f t (θ|θ− )
                                                      Z
                                                 ∆ = ω (θ)                    dθ
                                                                    ∂θ−

where the maximization is over (c (θ) , l (θ) , z (θ) , ω (θ) , v (θ) , ∆ (θ)).
       For period t = 1, suppose all agents have identical initial human capital level z0 .16 The problem
for t = 1 is then indexed by (U (θ))Θ , the set of target lifetime utilities U (θ) for each type θ:

                                                   Z
                                                                                              1
  K ((U (θ))Θ , 1)          =            min           (c (θ)   −   w1 (θ, z (θ)) l (θ)   +     K (v (θ) , ∆ (θ) , θ, z (θ) , 2))f 1 (θ) dθ
                                                                                              R


                                      s.t.ω (θ) = u1 (c (θ)) − φ1 (l (θ) , z (θ) − z0 ) + βv (θ)
                                               :
                                  .       wθ,1
                                  ω (θ) =      l (θ) φl,1 (l (θ) , z (θ)) + β∆ (θ)
                                           w1
                                  ω (θ) ≥ U (θ)


Technical assumptions: The following assumptions are sufficient conditions to determine the sign
of the optimal wedges and are used only for that purpose in some proofs.17
                            R θ0               R θ0
Assumption 2 i) θ f t (θ|θb ) dθ ≤ θ f t (θ|θs ) dθ, ∀t, θ0 , and θb > θs ;
          t                          
             (θt |θt−1 )
ii) ∂θ∂ t ∂f ∂θ t−1
                               1
                         f (θt |θt−1 ) ≥ 0, ∀t, ∀θt−1 ;
                          t

       ∂v(θ)
iii)    ∂θ     > 0 for all θ,
       ∂                 ∂2
iv)    ∂v K    ≥ 0 and   ∂v 2
                              K   ≥ 0.

       They guarantee (in this order) that that there is first-order stochastic dominance, that a form of
monotone likelihood ratio property is satisfied, that the expected continuation utility is increasing in
the type, and that the resource cost is increasing and convex in promised utility.
  16
       Otherwise, given that human capital is observable, we would need to condition on the initial levels.
  17
       In addition, all theoretical results on the signs of the wedges are indeed satisfied in the simulations (section 7).


                                                                          16
5     Optimal dynamic training policies

This section characterizes the allocations, obtained as solutions to the relaxed recursive program above.

5.1   The dynamic gross and net wedges

As already explained in the one-period model in Section 3, marginal distortions in agents’ choices
can be described using wedges, which represent the implicit local marginal tax and subsidy rates. In
the dynamic program, wedges are defined after each history. They hence represent implicit taxes and
subsidies, locally, and conditional on a given history.
   Define the intratemporal wedge on labor τL θt , the intertemporal wedge on savings or capital
                                                      

τK θt , and the human capital wedge τZ θt as follows:
                                             

                             φl,t (lt , zt − zt−1 )
             τL θt
                     
                         ≡ 1−                                                                           (22)
                              wt (θt , zt ) u0t (ct )
                              1         u0t (ct )
                  θt ≡ 1 −
                      
            τK                                                                                          (23)
                             Rβ Et (u0t (ct+1 ))
                                                                       0                         
                    t
                                        t
                                                       φz,t           ut+1 (ct+1 ) φz,t+1
             τZ   θ     ≡ − 1 − τL θ wz,t lt + 0                 − βEt                                  (24)
                                                        ut (ct )           u0t (ct ) u0t+1 (ct+1 )

    The intratemporal labor wedge was already explained in Section 3. The savings or capital wedge τK
is defined as the difference between the expected marginal rate of intertemporal substitution and the
return on savings and is standard in the dynamic public finance literature (see Golosov et al. (2006)).
    As in the static case, the training subsidy τZ can be viewed as the incremental pay received by an
agent for one more unit of training time. It is again equal to the difference between marginal cost and
marginal benefit. But the marginal benefit now lasts into all future periods. To write this recursively,
I express it as a function of the future marginal cost. Solved forward, (24) would yield the full future
stream of marginal benefits. Recall that the marginal disutility cost is scaled by marginal utility in
order to be expressed as an equivalent monetary cost.
    The following definitions will be needed for the dynamic formulas below. For any variable x, define
the “insurance factor” of x, ξx,t+1 :
                                             u0t+1
                                                        0               
                                                             ut+1
                            ξx,t+1   ≡ Cov −β 0 , xt+1 / Et β 0   Et (xt+1 )
                                              ut              ut
with ξx,t+1 ∈ [−1, 1]. If x is a flow to the agent, it is a good hedge if ξ < 0, and a bad hedge otherwise.
With some abuse of notation, define also:
                                             βu0t+1
                                                                0                     
                          0                                         βut+1
                         ξx,t+1 ≡ −Cov              − 1, xt+1  / Et       − 1   Et (xt+1 )
                                              u0t                    u0t
which, up to an additive constant, captures the same risk properties as ξx,t+1 .



                                                           17
       Denote by εxy,t the elasticity of xt to yt , εxyt ≡ d log (xt ) /d log (yt ). Let εut and εct be the uncom-
pensated and compensated labor supply elasticities to the net wage, holding both savings and training
fixed.18
       As in the simple one-period model of Section 3, it would be useful to have a measure of the net
distortion and real incentive effect on training, that takes into account the need to filter out whatever
goes towards compensating for other distortions. By analogy to the one-period case, we can define a
net wedge on training, tzt , that looks more complicated, but follows the same logic.

Definition 2 The net wedge or net bonus on training time tzt is defined as:

                                                                                               φz,t d
                                                                                                       
                                                               τZt − τLt                      u0t (ct )
                                                                                                            + PZt
                                                        tzt ≡       d                                                                             (25)
                                                                         φz,t
                                                                        u0t (ct )
                                                                                          − τZt (1 − τLt )

            φz,t d
                                                                        φ           
                              φz,t              1
           u0t (ct )
                         ≡   u0t (ct )
                                         −   R(1−τK )   1 − ξφ0 /u0 ,t+1 Et u0 z,t+1
                                                                                (ct+1 )
                                                                                          is the dynamic risk-adjusted disutility
                                                                                               t+1

cost, converted into monetary units.
                                                     φ0       
             τK            0                              z,t+1
    PZt ≡ R(1−τ K)
                     1 − ξ φ0 /u0 ,t+1   (1 − τLt ) Et u0 (ct+1 ) is the risk-adjusted savings distortion.
                                                                                    t+1



       Setting the net wedge to zero can be thought of as making training costs locally fully tax deductible
from taxable income in a dynamic risk-adjusted way. Recall that in the static case, a zero net wedge
corresponded to contemporaneous full deductibility. In the dynamic case, we need to take into account
three more effects. First, the cost is dynamic, due to the fact that training acquired today persists
into the future. Second, marginal utility is not smooth across states and time and, hence, the agent
does not value one dollar of transfer today the same as one dollar of transfer tomorrow. Thus, we need
to reweight any monetary amount by the ratio of marginal utilities. Finally, there is a savings wedge
that distorts intertemporal transfers and which also needs to be filtered out.
       The net wedge is positive if the government wants to encourage training on net, i.e., above and
beyond simply compensating for the distortive effects of the other wedges.

5.2         The optimal dynamic training subsidy

The following proposition characterizes the net training subsidy at the optimum.
  18
       I.e., εc and εu are defined as in the static framework (e.g., Saez, 2001), at constant savings and training time:
                                                                    φl (l,i)2 00
                                              u
                                                   φl (l, i) /l +   u0 (c)2
                                                                             u      (c)                       φl (l, i) /l
                                             ε =                    φl (l)2 00
                                                                                               εc =                  φl (l)2 00
                                                    φll (l, i) −    u0 (c)2
                                                                            u    (c)                  φll (l, i) −   u0 (c)2
                                                                                                                             u    (c)

                                                                                                         εc
                                                                                                          t
Again, with per-period utility separable in consumption and labor,                                    1+εu   c   is the Frisch elasticity of labor.
                                                                                                         t −εt




                                                                                       18
Proposition 2 i) At the optimum, the net training subsidy is given by:
                                                                                                                                     !
                                                                                     ∗
                                                                                                
                    ∗
                       (θt )      εct                                                     θt+1      εct+1 wz,t+1 lt+1 εφz,t+1 φ
                                                                      
                   τLt                                    εφz,t φ           1      τLt+1
t∗zt θ   t
           
               =       ∗ (θ t ) 1 + εu        1 − ρθz,t −      ρ           + Et                                              ρ
                 1 − τLt              t                   εwz,t lz,t        R            ∗ (θ t ) 1 + εu
                                                                                    1 − τLt             t+1 wz,t   lt εwz,t+1 lz,t+1
                                                                                                                                  (26)

with εφz,t = d log (φt ) /d log (zt ) the elasticity of disutility with respect to training time. ρφlz,t is the
                                                                                                         ∗ θt
                                                                                                              
Hicksian coefficient of complementarity between l and z in the disutility φt . The labor wedges τLt
     ∗     θt+1 are at their optimal levels.
                
and τLt+1
       ii) The net training wedges are zero at the bottom and the top of the ability distribution:

                                                        t∗zt (θt−1 , θ) = t∗zt (θt−1 , θ) = 0

       As in the one-period case, we see the labor supply effect, the inequality effect, and the contempo-
raneous learning-or-doing or learning-and-doing effects. However, in this dynamic model, the subsidy
on training time has an additional direct interaction with future labor supply through the disutility
function.
       Even if training diverts time away from contemporaneous labor supply, the effects on future labor
supply can motivate a positive net subsidy. Whatever the pattern of complementarity or substitutabil-
ity between contemporaneous labor supply and training, the relation between current training and
future labor supply is its mirror image. If the former are complements, the latter are substitutes, and
vice versa, because investing in human capital today means having to invest less tomorrow to reach
any given level.19
       If there is learning-or-doing, the net wedge co-moves positively with the future income tax rate
τLt+1 , but negatively with the current tax rate τLt . Intuitively, if there is a higher contemporaneous
wedge on labor, there already is an indirect stimulus to training because training is a substitute for
labor; hence the need for an additional stimulus through a net subsidy is reduced. However, a higher
future labor wedge is a stimulus for training in the future, which is a substitute for training today.
Hence, to stimulate training today, there is a need for a higher net subsidy.
       Corollary 2 illustrates two cases, among other possible ones.

Corollary 2 Under assumption 2:
                                                     
                                             εφz φ
       i) The net subsidy is positive if 1 − εwz ρlz,t ≥ ρθz,t and ρφlz,t ≥ 0.
                                                      
                                               εφz φ
       ii) The net subsidy is negative if 1 − εwz ρlz,t ≤ ρθz,t and ρφlz,t ≤ 0.

   The sufficient conditions in i) guarantee that, although training diverts time away from contempo-
                                                                
                                                        εφz φ
raneous labor effort, the total labor supply effect 1 − εwz ρlz,t (the direct labor supply effect plus the
  19
    This is because only the flow it = zt − zt−1 , and not the stock zt−1 enters the disutility. This reasoning is also only
valid at interior solutions for training.


                                                                           19
interaction of labor and training) outweighs the inequality effect ρθz . On the other hand, the sufficient
conditions in ii) imply that, despite stimulating contemporaneous labor supply through learning-and-
doing, training disproportionately benefits high productivity workers.
   One can revert back to the one-period special cases in Section 3.5 if it is assumed that the training
stock depreciates entirely each period. In this case, all the simple relations derived in that section
between the labor wedge and the training wedge continue to hold.

Life cycle evolution of the optimal net training wedge: It is natural to think that the parameters
affecting the optimal net wedge in (26) are age-dependent and would be evolving over the life cycle.
In particular, the interaction between labor and training could be very different at different ages in
life – something that is easily accommodated by the general, age-dependent disutility function φt . It
is an interesting empirical question how labor supply and the acquisition of training evolve over life,
and the answer turns out to be important for optimal tax considerations as well.

5.3      A special case: separability between training and labor

The peculiarity of time spent investing in human capital, unlike monetary human capital investments
or physical capital, is that it interacts with labor supply. With perfect information this would not
matter, as any given disutility cost can be converted into an equivalent monetary cost. This is no
longer true under asymmetric information, unless the disutility function is separable in labor and
               2      
                ∂ φ
human capital ∂z∂l  = 0 . Then, as corollary (3) shows, the training subsidy is set only as a function
of its complementarity with ability.

                 ∂ 2 φt
Corollary 3 If   ∂z∂l     = 0 and assumption 2 holds:
   i) The net wedge satisfies:
                                                    ∗
                                                   τLt     εct
                                        t∗zt =         ∗         (1 − ρθz,t )                        (27)
                                                 1 − τLt 1 + εut
   ii)
                                            t∗zt θt ≥ 0 ⇔ ρθz,t ≤ 1
                                                   


   ii) If the wage function is CES with parameter ρ as in (3) and the disutility is separable and
isoelastic
                                                   1 γ 1 η
                                     φ (l, i) =      l + i (γ > 1, η > 1),                           (28)
                                                   γ    η
then the net wedge satisfies:                            ∗      
                                                         τLt             (1 − ρ)
                                          t∗zt /             ∗       =
                                                       1 − τLt              γ




                                                            20
    First, when there no longer is a direct interaction with labor supply, the net stimulus to training
is positive if and only if training is not too complementary to ability (ρθz ≤ 1). In addition, because
the future interaction with labor supply no longer matters, the training wedge and labor wedge are set
according to a contemporaneous inverse elasticity rule, in which the training wedge is higher whenever
its complementarity with ability is lower. With a CES wage function, this relation is particularly
simple: in any period, the relation between the training wedge and the labor wedge needs to stay
constant.


6     The optimal labor wedge in the presence of training

What happens to the labor wedge in the presence of training? It is natural to think that the presence
of training, given its strong interaction with labor, would affect the optimal labor wedge. However,
it turns out that in the case just analyzed, the presence of learning-or-doing or learning-and-doing
does not really change the labor wedge. The specification of the model matters a lot for this result.
I therefore consider two modifications to the model, which have important implications for the labor
wedge. The first is the limit case of learning-by-doing, in which all training comes directly as a by-
product of the (unobservable) labor supply. The second is the case in which higher ability agents are
not only more productive at producing output, but are also more able at training.

6.1       Does learning-or-doing versus learning-and-doing matter for the optimal labor
          distortion?

In the model analyzed up to here, the labor wage is only slightly affected by the presence of human
capital, but not by either learning-or-doing or learning-and-doing. The full formula for the labor wedge
is given in the next proposition.

Proposition 3 i) At the optimum, the labor wedge is equal to:
                               ∗ θt         µ θt u0t c θt εwθ,t 1 + εut
                                                            
                              τLt
                                          =                                                  (29)
                            1 − τL∗ (θt )     f t (θt |θt−1 )    θt εct
with µ θt = η θt + κ θt , where η θt can be rewritten recursively as a function of the past labor
                                       

        ∗
wedge, τL,t−1 :
                                  ∗
                                              "                                                             #
                                        θt−1                          εct−1
                                                                                     Z θ̄
                     t
                                τLt−1                   Rβ                    θt−1       ∂f (θs |θt−1 )
               η θ           =      ∗                                                                    dθs
                               1 − τL,t−1 (θt−1 ) u0t−1 (c (θt−1 )) 1 + εut−1 εwθ,t−1 θt     ∂θt−1

and                                                                                                !
                                     Z   θ̄                      Z     θ̄
                                     1                                           1
                             t
                                            1 − u0 (c (θ))                             f (m|θ− ) dm f t (θ|θ− )
                                 
                    κ θ =         0
                            θt  u   (c (θ))                        θ        u0 (c (m))
     ∗                 ∗ θ t−1 , θ = 0, ∀t.
          θt−1 , θ̄ = τLt
                                 
ii) τLt

                                                                21
   Hence, the only effect of training is to introduce the wage elasticity with respect to ability εwθ,t ,
which is usually constant and equal to one in a model without training (in which wt = θt ). With train-
ing, a higher elasticity amplifies the labor wedge as it increases the value of insurance and redistribution.
However, it does not directly matter whether there is learning-or-doing or learning-and-doing. The
standard zero distortion at the bottom and the top results from the static Mirrlees model continue to
apply.
   The multiplier µ θt on the envelope condition captures two effects that amplify or dampen the
                      

labor wedge over the lifecycle. Because the training wedge in (26) was derived in relation to the labor
wedge, they also influence the magnitude of the net training wedge. The first effect is an insurance
motive, captured by κ θt , familiar from the static taxation literature. It would be zero with linear
                          

utility. The term η θt captures the previous period’s labor wegde, hence indirectly the previous
                        

period’s insurance motive, weighted by a measure of ability persistence. In the limit, if θt is identically
and independently distributed (iid), only the contemporaneous insurance motive κ (θt ) matters.

6.2      The limit case of Learning-by-Doing

A limit case of learning-and-doing would be the learning-by-doing model introduced by Arrow (1962),
which posits that agents acquire human capital through work itself. With asymmetric information,
this limit case actually leads to very different implications for the labor wedge. This is because
human capital with learning-by-doing is a direct by-product of labor, but labor is unobserved by the
government. There is no separate instrument for training and all the incentives have to be set indirectly
through the labor wedge. Indeed, this case is much closer to a case with unobservable training. As
soon as training is a direct by-product of labor, either the government will be able to perfectly infer
labor effort from observing training (if we maintain the assumption that training is observable) or it
has to be that training like labor is unobservable.
   Learning-by-doing can be modelled by letting the investment in training be the direct result of
labor, not of a separate effort, so that training time as previously defined, it is equal to it = i (lt ) where
i () is an increasing, concave function of lt . The stock of human capital zt is zt = tτ =1 i (lτ ). For
                                                                                            P

simplicity, I will consider a linear function with it = lt , but the more general formulation gives similar
results.
   The next proposition highlights how the optimal labor wedge needs to be modified in order to take
into account the presence of learning-by-doing.

                                                                         Pt
Proposition 4 With learning-by-doing, such that it = lt and zt =           τ =1 lτ :




                                                      22
   i) The optimal labor wedge is given by:

                                                   εwθ 1 + εut
                                                                                 
   τLt          wz,t            µ (θt )     0                      wzt
            1+        lt   =               u (ct )              −      lt [1 − ρθz ]
(1 − τLt )     τLt wt        f (θt |θt−1 )          θt   εct       wt
                                                             (1 − τL,t+1 ) µ (θt+1 ) εwθ,t+1 1 + εut+1 0
                                                                                                             
                                1       wt+1 τL,t+1
                             + E                         −                                            u (ct+1 )
                               R           wt (1 − τLt )      (1 − τLt ) f (θt+1 |θt ) θt+1    εct+1

      ii) Except in the last period t = T , the zero tax results at the bottom and the top no longer hold:
 ∗                         ∗ θ t−1 , θ =
       θt−1 , θ̄ 6= 0 and τLt
                                     
τLt                                     6 0.

      Three elements are noteworthy in this formula relative to (29). First, the relevant efficiency cost
                                                                                      1+εu
of taxation is no longer just the own-price elasticity, as captured by                 εct .
                                                                                          t
                                                                                               Instead, it also includes the
incentive effect of training time, as captured by the Hicksian coefficient of complementarity ρθz . All
else equal, a lower Hicksian coefficient of complementarity of training and ability tends to decrease the
labor wedge because it is attractive to encourage training acquisition (which corresponds to supplying
more labor when there is learning-by-doing). The reason for this was explained in Section 3: when the
Hicksian coefficient of complementarity is below 1, training has a redistributive and insurance effect.
      Secondly, the optimal labor wedge, which is normally an intratemporal wedge, now becomes
forward-looking and dynamic. Labor supply now has an intertemporal effect and lasting impacts
because it indirectly builds human capital. There is a need to take into account the next period’s
incentive effects of having a higher human capital stock and the next period’s tax.
      Third, and related to the dynamic implications of the labor wedge, the zero tax result at the bottom
and top of the ability distribution no longer holds (except in the last period, which is akin to a static
model). The intertemporal effects of the labor wedge lead to different incentive implications.

6.3     Higher ability for working and training

There is another natural modification of the model which also has different implications for the labor
wedge. Suppose that higher ability agents are not only more productive at producing output, but are
also more productive at training, i.e., they have a lower marginal cost for any training achieved.
      In this case, the per-period utility of an agent of current type θt takes the form:

                                                                                 
                                                           yt         zt − zt−1
                                      u(ct ) − φt                   ,                                                  (30)
                                                        w(θt , zt )       θt
The envelope condition needs to be modified accordingly (see the Appendix) and is now given by:

                                            wθt           z(θ) − z
                                 ω̇ (θ) =       l(θ)φlt +          φit + β∆(θ)
                                            wt               θ2

where φit is the derivative of φ with respect to its full second argument.


                                                           23
         Solving the problem in exactly the same way as before, with the augmented envelope condition,
yields a modified formula for the optimal labor wedge.

Proposition 5 If higher ability types are also more able at acquiring training, according to φ as in
(30), the optimal labor wedge takes the form:


                                                        wθt 1 + εu
                                                                                       
                         τL (θ)       µ (θ) 0                          zt − zt−1    φ
                                  =           u (ct )               +              ρlzt εφz                       (31)
                       1 − τL (θ)   f (θ|θ− )           wt    εc           zt
where µ(θ) still takes the same form as in proposition 3.

         Note that the first term on the right-hand side of (31) is the same as the optimal tax in formula
(29). The second term tells us that, when agents who have high ability for work also have high
ability at training, the labor tax needs to be adjusted. In particular, whenever there is learning-or-
doing (ρφlz > 0), the labor wedge is adjusted upwards. The intuition for this result is that, if labor
and training are substitutes, then discouraging labor encourages training and relaxes the incentive
compatibility constraint. The opposite happens when there is learning-and-doing (ρφlz < 0).
         This additional effect can be first-order. Typically, whenever the horizon is short the labor wedges
are small because the compensated elasticity in the data is small. However, the crowding out or
crowding in of training could be a much stronger consideration.



7         A Simple Numerical Illustration

In this section, I illustrate numerically some of the theoretical results from Sections 5 and 6. The goal
is not to provide a full-fledged quantitative analysis of the results, but rather to point out how the
interaction between labor and training can influence optimal policies.20

7.1        Calibration

Functional specifications: Agents work for 20 periods, corresponding to 40 years in the data and
are retired for 10 periods, corresponding to 20 years in the data.
         The focus is on the complementarity between training and labor in the disutility function, i.e.,
on ρφlz . Therefore, the rest of the specifications are intentionally kept very simple. Ability follows a
log-normal iid process, with:
                                                     log θt = ψt
    20
    An estimation of the model is complicated and might maybe not be that informative. Indeed, while this life cycle
model is more general than other models of dynamic taxation, the quest for analytical results limits the complexity we
can introduce into the model. Hence, many features of the real-world are highly stylized and simplified. A separate
analysis could give up on theoretical and analytical results and instead perform a more rigorous quantitative analysis.


                                                          24
                         
with ψt ∼ N − 12 σψ2 , σψ2 . The wage function is also taken to be simply additively separable, with
ρθz = 0, namely:
                                                       wt (θt , zt ) = θt + zt                                            (32)

The focus is hence on the preferences. The first simulation considers the baseline separable preferences
between training and labor, with ρφlz = 0:
                                                               γ
                                                κ     yt            1
           ũ (ct , yt , zt , θt ) = log(ct ) −                    − (zt − zt−1 )α , κ > 0, γ > 1, α > 1                  (33)
                                                γ wt (θt , zt )     α

The second simulation considers a specification with learning-or-doing in which training and labor are
substitutes:
                                                                              γ
                                                       κ           yt
                 ũ (ct , yt , zt , θt ) = log(ct ) −                               (zt − zt−1 )α , κ > 0, γ > 1, α > 1   (34)
                                                      γα       wt (θt , zt )

In this case, ρφlz = 1.
       During retirement, utility is in both cases simply ũR (ct ) = log (ct ).

Parameter values: The parameter values are calibrated exogenously from the existing literature. I
set γ = 3 and κ = 1, in order to obtain a Frisch elasticity of 0.5 as in Chetty (2012). Given the lack
of evidence on the elasticity of training to the net return, I select α = 2. The discount factor is set to
                                                                   1
β = 0.95, and the gross borrowing rate to R =                      β   = 1.053. The variance of ability is taken to be, to a
first order, the variance of productivity, for which there are many different estimates in the literature.
I take a medium-range value of 0.0095 (Heathcote et al., 2005).                             21



Simulations: After using the recursive formulation of the problem to compute the policy functions, I
simulate 100,000 draws through a Monte Carlo simulation for each of the two preference specifications
(i.e., for the values ρφlz = 0 and ρφlz = 1). The initial states are set to yield a zero present value resource
cost for the allocation. This ensures comparability across simulations, and gives a sense of outcomes
achievable without outside government revenue.

7.2       Discussion of the numerical illustration

Figure 1 shows the simulation results. Each panel depicts the cross-sectional average (taken across
all 100,000 simulations) of the corresponding wedge at the given time period. It is most natural to
interpret time t = 0 as approximately age 20 –when the agent is adult and makes labor and training
choices on his own – and time t = 20 as the retirement age, or age 60.
  21
    It naturally is very challenging to assess what is uncertainty versus what is heterogeneity from the point of view
of the agent (as opposed to the point of view of the econometrician). Ideally, we would like estimates of the initial
hetereogeneity, and of the transition function between different ability states, which is also uncertain for the agent.


                                                                       25
       As is usual, the labor wedge in panel (a) grows over the life cycle. Because the ability shock is iid
over time. the labor wedge is relatively small, even at age 60. More persistent or more volatile shocks
would make the labor wedge higher and steeper over the life cycle.22 The gross training wedge in panel
(b) closely tracks the labor wedge. The training wedge τZt is lower and grows slower when there is
learning-or-doing. The intuition for this is that when there is learning-or-doing (ρφlz = 1), encouraging
training discourages labor and is less attractive than when there is no learning-or-doing (ρφlz = 0).

                                         Figure 1: Average Wedges over the Life Cycle
                                                               (a) Labor Wedge τLt
                                             0.08
                                                      ρφ = 0
                                                       lz
                                             0.07
                                                      ρφ = 1
                                                       lz
                                             0.06

                                             0.05

                                             0.04

                                             0.03

                                             0.02

                                             0.01

                                                 0
                                                  0             5          10           15           20
                                                                            t


                                  (b) Gross Wedge τZt                                   (c) Net Training Wedge tzt
                0.1                                                              0.03
                       ρφ = 0                                                           ρφ = 0
                        lz                                                               lz
                       ρφ    =1                                                 0.025   ρφ = 1
               0.08     lz                                                               lz


                                                                                 0.02
               0.06
                                                                                0.015

               0.04
                                                                                 0.01

               0.02                                                             0.005


                  0                                                                0
                   0               5        10          15           20             0            5        10   15    20
                                             t                                                             t


 Each of the three panels depicts the average wedge at the given time period across the 100,000 simulations. Panel (a)
   depicts the labor wedge τLT , panel (b) depicts the gross training wedge, τZt , and panel (c) depicts the net training
 wedge tzt . The blue line represents the benchmark separable case with preferences as in (33) and ρφlz = 0. The green
  line represents the case with learning-or-doing and nonseparable preferences as in (34) for which ρφlz = 1. Each time
period in the simulations represents two years in the data. It is most natural to view time t = 0 as approximately age 20
                                    and time t = 20 as the retirement age, or age 60.


       Given the close parallel between the labor wedge and the gross wedge, the net wedge in panel (c)
is very small. Since training is a dynamic decision, it is very costly to distort it for redistributive
and incentive reasons. Hence, the optimal allocation remains very close to neutrality with respect to
  22
       As compared, for instance, to the numbers in Farhi and Werning (2013) and Stantcheva (2014).



                                                                          26
training. The net wedge is less steep when there is learning-or-doing. In that case, it is especially
attractive to encourage human capital relatively more in the earlier periods than in later periods.
Inutitively, training will always distract effort away from labor when there is learning-or-doing, but
the benefits will be recouped over more periods when the agent is younger.


8    Conclusion

This paper considered optimal taxation and training policies when agents allocate their time between
working and acquiring human capital. Time investments in human capital are peculiar because they
cannot be dissociated from the agent: their returns interact with an agent’s intrinsic and stochastic
type, and their costs interact with an agent’s labor effort. The model allows for a general wage function
and a general interaction between labor and training that ranges from learning-and-doing (training and
labor are complements) to learning-or-doing (training and labor are substitutes), and which can be
different at different ages in life.
    I first considered a simple one-period model to highlight the main intuitions related to human
capital acquired though training. The notion of a net wedge was introduced, as a measure of the net
incentive that the government wants to provide for training, above and beyond simply compensating
for the labor distortion. At the optimum, the ratio of the net training wedge to the labor wedge needs
to satisfy a simple relation that depends on two parameters: negatively on the Hicksian coefficient of
complementarity between training and ability in the wage function, which measures how much more
high ability agents benefit from training, and negatively on the Hicksian coefficient of complementarity
between training and labor in the disutility function. The latter is positive if there is “learning-or-
doing” and negative in the presence of “learning-and-doing.” The net wedge is positive if and only
if the total labor supply effect outweights the inequality effect. Some special cases yield particularly
simple, constant ratios between the labor wedge and training wedge and can be used to test for the
Pareto efficiency of any tax and subsidy system.
    In the dynamic life cycle model, there is an additional interaction between contemporaneous training
and future labor supply, which is the mirror image of the interaction with the contemporaneous labor
supply. This makes the sign of the net wedge more complex and there are many possible configurations.
    The labor wedge is not affected by learning-or-doing or learning-and-doing. I considered two mod-
ifications of the model which do induce important changes for the labor wedge: the limit case of
“learning-by-doing,” in which training is a direct by-product of labor effort, and the case in which
agents who are more able at work are also more able at training.
    In future work, it would be interesting to pin down empirically how the interaction between labor


                                                   27
supply and time investments in human capital evolves over the life cycle. At what ages and at what
levels of labor supply and training is learning-or-doing more prevalent than learning-and-doing, and
vice-versa? Then, a more complete quantitative analysis of the optimal policies would be feasible and
insightful.




                                                 28
9    References

Albanesi, S. and C. Sleet. 2006. “Dynamic Optimal Taxation with Private Information,” Review
of Economic Studies 73, 1-30.
Arrow, Kenneth 1962. “The Economic Implications of Learning by Doing,” The Review of Economic
Studies 29(3), 155-173.
Atkinson, A. and J. Stiglitz 1976. “The Design of Tax Structure: Direct versus Indirect Taxation,”
Journal of Public Economics 6, 55-75.
Battaglini, M. and S. Coate. 2008a. “Pareto Efficient Income Taxation with Stochastic Abilities,”
Journal of Public Economics 92(3-4), 844-868.
Battaglini, M. and S. Coate. 2008b. “A Dynamic Theory of Public Spending, Taxation, and
Debt,” American Economic Review 99(1), 201-236.
Becker, G. 1964. A Theoretical and Empirical Analysis, with Special Reference to Education, The
University of Chicago Press.
Ben-Porath, Y. 1967. “The Production of Human Capital and the Life Cycle of Earnings”, Journal
of Political Economy, Vol. 75, No. 4, pp. 352-365.
Bohacek, R. and M. Kapicka. 2008. “Optimal Human Capital Policies,” Journal of Monetary
Economics 55(1), 1-16.
Bovenberg, L. and B. Jacobs. 2005. “Redistribution and Education Subsidies are Siamese Twins,”
Journal of Public Economics, 89(11-12), 2005–2035.
Bovenberg, L. and B. Jacobs. 2011. “Optimal Taxation of Human Capital and the Earnings
Function,” Journal of Public Economic Theory, 13, (6), 957-971.
Da Costa, C. E., and L. J. Maestri. 2007. “The risk Properties of Human Capital and the Design
of Government Policies,” European Economic Review 51(3), 695-713.
Farhi, E. and I. Werning 2013. “Insurance and Taxation over the Life Cycle,” Review of Economic
Studies 80, 596-635
Findeisen, S. and D. Sachs 2012. “Education and Optimal Dynamic Taxation: The Role of Income-
contingent Student Loans,” Working Paper, University of Konstanz.
Gelber, A. and M. Weinzierl 2012. “Equalizing Outcomes and Equalizing Opportunities: Optimal
Taxation When Children’s Abilities Depend on Parents’ Resources,” NBER Working Paper, 18332.
Golosov, M, A. Tsyvinski and M. Troshkin. 2013. “Redistribution and Social Insurance,”
Working paper, Princeton University.
Golosov, M, A. Tsyvinski and I. Werning. 2006. “New Dynamic Public Finance: A User’s
Guide,” NBER Macroeconomic Annual, MIT Press.

                                                 29
Golosov, M, and A. Tsyvinski. 2007. “Optimal Taxation with Endogenous Insurance Markets,”
Quarterly Journal of Economics, 122(2), 487-534.
Golosov, Mikhail, Aleh Tsyvinski, and Nicolas Werquin 2014. “A Variational Approach to
the Analysis of Tax Systems,” Working Paper, Yale.
Heathcote, J., K. Storesletten and G. Violante. 2005. “Two Views of Inequality Over the Life
Cycle,” Journal of the European Economic Association, 3, 765-775.
Heckman, James. 1976a. “Estimates of a Human Capital Production Function Embedded in a
Life-Cycle Model of Labor Supply,” in N. Terleckyj (ed.), Household Production and Consumption,
NBER, p. 225-264.
Heckman, James. 1976b. “A Life-Cycle Model of Earnings, Learning, and Consumption,” Journal
of Political Economy, 84(4), S11-S44.
Heckman, J., L. Lochner, and P. Todd. 2005. “Earnings Functions, Rates of Return, and
Treatment Effects: The Mincer Equation and Beyond,” NBER Working Paper 11544.
Hicks, J. 1970. “Elasticity of Substitution Again: Substitutes and Complements,” Oxford Economic
Papers, 25, 289-296.
Kapicka, M. and J. Neira 2014. “Optimal Taxation in a Life-Cycle Economy with Endogenous
Human Capital Formation,” Working Paper, University of California, Santa Barbara.
Kapicka, M. 2013a. “Optimal Mirrleesean Taxation with Unobservable Human Capital Formation,”
Working Paper, University of California, Santa Barbara.
Kapicka, M. 2013b. “Efficient Allocations in Dynamic Private Information Economies with Persistent
Shocks: A First-Order Approach,” Review of Economic Studies, 80(3), 1027-1054.
Kocherlakota, N. 2005. “Zero Expected Wealth taxes: A Mirrlees Approach to Dynamic Optimal
Taxation,” Econometrica, 73(5), 1587-1621.
Krueger, D., and A. Ludwig. 2013. “Optimal Capital and Progressive Labor Income Taxation
with Endogenous Schooling Decisions and Intergenerational Transfers,” University of Pennsylvania
Working Paper.
Maldonado, D. 2007. “Education Policies and Optimal Taxation,” International Tax and Public
Finance, 15(2), 131-143.
Milgrom, R. and I. Segal. 2002. “Envelope Theorems for Arbitrary Choice Sets,” Econometrica,
70(2), 583-601.
Mirrlees, J. 1971. “An Exploration in the Theory of Optimal Income Taxation,” Review of Economic
Studies, 38, 175-208.
Williams, Timothy 2014. “Seeking New Start, Finding Steep Cost Workforce Investment Act Leaves


                                                   30
Many Jobless and in Debt,” New York Times , August 17, 2014.
OECD. 2004. “Improving Skills for More and Better Jobs: Does Training Make a Difference?,” OECD
Employment Outlook.
OECD. 2013. “Education at a Glance, 2013,” OECD, Paris.
Rothschild, Casey and Florian Scheuer. 2014a. “A Theory of Income Taxation under Multidi-
mensional Skill Heterogeneity,” NBER Working Paper 19822.
Rothschild, Casey and Florian Scheuer. 2014b. “Optimal Taxation with Rent-Seeking,” NBER
Working Paper 17035.
Saez, Emmanuel.        2001. “Using Elasticities to Derive Optimal Income Tax Rates,” Review of
Economic Studies 68(1), 205-229
Samuelson, P. 1973. “Complementarity – An Essay on the 40th Anniversary of the Hicks-Allen
Revolution in Demand Theory”, Journal of Economic Literature, 12, (4), 1255-1289.
Shourideh, Ali 2012. “Optimal Taxation of Wealthy Individuals,” Working Paper University of
Pennsylvania.
Shourideh, Ali, and Maxim Troshkin 2012. “Providing Efficient Incentives to Work: Retirement
Ages and the Pension System,” Working Paper University of Pennsylvania.
Scheuer, Florian 2014. “Entrepreneurial Taxation with Endogenous Entry,” American Economic
Journal: Economic Policy, 6, 126-163.
Stantcheva, Stefanie 2014. “Optimal Taxation and Human Capital Policies over the Life Cycle,”
Working Paper, Harvard University.
Weinzierl, M. 2011. “The Surprising Power of Age-Dependent Taxes,” Review of Economic Studies,
78, 1490-1518.
Werning, Ivan 2002 “Optimal Unemployment Insurance with Unobservable Savings,” Working Paper
MIT.
Werning, Ivan 2007a “Nonlinear Capital Taxation,” Working Paper MIT.
Werning, Ivan 2007b “Optimal Fiscal Policy with Redistribution,” Quarterly Journal of Economics,
122, 925-967.
Werning, Ivan 2007c “Pareto Efficient Income Taxation,” Working Paper MIT.
Werquin, Nicolas 2014 “Income Taxation with Frictional Labor Supply,” Working Paper, Yale.




                                               31
A     Appendix
Notation:

    wθ,t , wz,t are the partials of the wage with respect to ability, human capital z respectively. wθz,t ,
wzz,t are the second order derivatives. φl,t and φz,t are the partials of the disutility with respect to
labor and training respectively, and φzz,t , φlz,t , φll,t the corresponding second order derivatives. εxyt is
the elasticity of variable x with respect to variable y, εxyt = d log (xt ) /d log (yt ), hence for instance,
εwθ,t is the elasticity of the wage with respect to ability θ. When clear, the history dependence of
allocations is omitted, e.g., ct denotes c θt .
                                              


    Link to the Ben-Porath model in discrete time.

    In the Ben-Porath model, the general accumulation process for human capital is zt+1 = H (zt , αt ) +
(1 − δ) zt with αt the fraction of human capital reinvested into human capital acquisition and δ the
depreciation rate of human capital. Labor supply is equal to lt = 1 − αt , the residual time from human
capital acquisition. The rental rate of human capital wt is constant and earnings are yt = wt zt lt . The
most general functional form used is zt+1 = β0 αtβ1 (αt zt )β2 +(1 − δ) zt , so that wt αt zt is the opportunity
cost of human capital acquisition.
    In this paper, a variation of this model is used, which is better adapted to a Mirrleesian analysis.
The accumulation process is simplified along some dimensions and made more complex along others.
First, instead of αt , the input into human capital is effort or time it . it plays the same role of αt but
has a disutility cost, potentially nonseparable from the disutility cost of labor φt (l, i) , and not just an
opportunity cost of time. This is because, first, disutility costs from learning are empirically relevant
(see Heckman et al. 2005) and second, with observable human capital, labor would also be observable
if we only had: lt = 1 − it . Second, the parameters are fixed so that only time, but not the previous
stock of human capital matters for the accumulation, and there is no depreciation: β1 = 1 = β0 and
β2 = δ = 0. This leads to a linear accumulation process zt+1 = zt + it . The diminishing returns to
human capital are instead captured in the more complex rental rate for human capital, i.e., the wage,
which is heterogeneous, nonlinear, and stochastic wt = wt (θt , zt ).
    Generalized model a la Ben-Porath: It is possible to generalize the model to feature an
accumulation process close to the one in Ben-Porath. The key change is to make the accumulation
process depend on the human capital stock. Hence, let zt = Zt (zt−1 , it ) = zt−1 + Ht (zt−1 , it ) be a
more general production function without depreciation (which is without loss of generality). Define
the inverse function with respect to i, It (zt , zt−1 ) ≡ Zt−1,i (zt−1 , zt ). The accumulation process can be
time-dependent. Note now that with ∂φ       t      ∂φt ∂it   ∂φt ∂It
                                         ∂zt = ∂it ∂zt = ∂it ∂zt , the definition for the net bonus tzt is
unchanged. The same formula for the optimal bonus on training time as in (26) applies.

     Derivations and proofs for Propositions (2) and (3) and Corollary (2):
     The expenditure function: c̃ (l, ω − βv, i, θ) defines consumption indirectly as a function of labor l,
current period utility (ũ = ω − βv), training, and the current realization of the type. Then, ω (θ) =
ut (c (θ))−φt (l (θ) , z (θ) − z− )+βv (θ) becomes redundant as a constraint, and the choice variables are
(l (θ) , z (θ) , ω (θ) , v (θ) , ∆ (θ)). Let the multipliers in program (21) be (in the order of the constraints


                                                      32
there) µ (θ), λ− , and γ− . The problem is solved using the optimal control approach where the “types”
play the role of the running variable, ω (θ) is the state (and ω̇ (θ) its law of motion), and the controls
are l (θ) , v (θ) and ∆ (θ). The Hamiltonian is:


      (c̃ (l (θ) , ω (θ) − βv (θ) , z (θ) − z− , θ) − wt (θ, z (θ)) l (θ)) f t (θ|θ− )
          1
      + K (v (θ) , ∆ (θ) , θ, z (θ) , t + 1) f t (θ|θ− )
         R
                                                         ∂f t (θ|θ− )
                                                                                                                               
                                                                                    wθ,t
      +λ− v − ω (θ) f t (θ|θ− ) + γ− ∆ − ω (θ)
                                   
                                                                         + µ (θ)         l (θ) φl,t (l (θ) , z (θ) − z− ) + β∆ (θ)
                                                             ∂θ−                    wt
with boundary conditions:
                                                                 lim µ (θ) = lim µ (θ) = 0
                                                                 θ→θ̄           θ→θ

    First, we solve for the optimal labor wedge, which is then used in the formula for the optimal
training wedge.
    Taking the first order condition of the recursive planning problem with respect to the labor choice:
                            τL∗ (θ)
                                                                                                  
                                           µ (θ) wθ,t 0                l (θ) φll,t (l (θ) , i (θ))
                [l (θ)] :             =               u  (c (θ))   1 +
                          1 − τL∗ (θ)   f t (θ|θ− ) wt t                  φl,t (l (θ) , i (θ))
using the definitions of εc , εu and ε in the text:
                                                      τL∗ (θ)        µ (θ) εwθ 0           1 + εu
                                                                =               ut (c (θ))
                                                    1 − τL∗ (θ)   f t (θ|θ− ) θ              εc
   Taking the first order condition of the Hamiltonian with respect to zt yields:

                                          Z                                                                                 
                      φz,t                      1 φz,t+1 t+1                   1           µ (θt+1 ) wθ,t+1
      [zt ] :       − 0      + wz,t lt +                     f    (θt+1 |θt ) + Et                               lt+1 φlz,t+1
                     u (ct )                   R u0 (ct+1 )                    R       f t+1 (θt+1 |θt ) wt+1
                                                                                                               
                           µ (θt )                               1                          1     wθ,t
                     − t                lt φl,t (lt , zt − zt−1 ) wθz,t − lt φl,t wθ,t wz,t 2 +         lt φlz,t = 0
                        f (θt |θt−1 )                            wt                        wt       wt
   Using the definition of the training time bonus, τZt to replace for wz,t lt yields:
                                              Z                                                                                d           !
            φz,t                                   1 φz,t+1 t+1                       1                                φz
          − 0      + wz,t lt +                                  f (θt+1 |θt ) = −                    τZt − τLt                       + PZt
           u (ct )                                 R u0 (ct+1 )                   (1 − τLt )                         u0 (ct )
                                     d
                          φz
with PZt and             u0 (c   t)
                                           as defined in the text. The FOC then becomes:

                                                                       
                                                    φz,t d
                                                           
                    τzt − τLt              + PZt   u0 (ct ) µ (θt )            εwθ,t
   [zt ] : tzt =                                 = t               u0 (ct )       (1 − ρθz,t )
                                   φz,t
                                        d              f (θt |θt−1 )            θt
                   (1 − τLt ) u0 (ct ) − τzt
                                                                                                               
                         1               µ (θt ) εwθ,t              1            µ (θt+1 ) εwθ,t+1
           −                                          lt φlz,t − Et                              lt+1 φlz,t+1
                 φz,t d
                                    f t (θt |θt−1 ) θt             R        f t+1 (θt+1 |θt ) wt+1
                u0 (ct )   − τzt

We can again replace the multipliers by the labor wedges, and note that
                                                                     wt                 εφz,t φ
                                                                                φlz,t =      ρ
                                                                wz,t φl,t (lt )         εwz,t lz,t

                                                                               33
to obtain formula (26). In this case the elasticities are defined as εφz = d log(φ)/d log(z) and εwz =
d log(w)/d log(z).
    The law of motion for the co-state µ (θ) comes from the first-order condition with respect to the
state variable ω (θ):

                                                     ∂f t (θ|θ− )
                                                                                                        
                              1                                      1
              [ω (θ)] : − 0          + (λ− ) + (γ− )               t
                                                                                                             f t (θ|θ− ) = µ̇ (θ)   (35)
                          ut (c (θ))                    ∂θ−       f (θ|θ− )
                                                           
Integrating this and using the boundary condition µ θ̄ = 0, yields:

                                       θ̄
                                                                           ∂f t (θ|θ− )
                                 Z                                                                            
                                                    1                                      1
                  µ (θ) =                        0         − (λ− ) − (γ− )               t
                                                                                                                   f t (θ|θ− )      (36)
                                   θ            ut (c (θ))                    ∂θ−       f (θ|θ− )

Integrating and using both boundary conditions yields:
                                                                  Z   θ̄
                                                                               1
                                                           λ− =                         f t (θ|θ− ) dθ                              (37)
                                                                  θ        u0 (c (θ))

Using the envelope conditions ∂K(v(θ),∆(θ),θ,s(θ),z(θ),t+1)
                                          ∂v(θ)             = λ (θ) and ∂K(v(θ),∆(θ),θ,s(θ),z(θ),t+1)
                                                                                  ∂∆(θ)               = −γ (θ),
the first-order conditions with respect to v (θ) and ∆ (θ) respectively lead to:

                                                                                1           λ (θ)
                                                               [v (θ)] :                =                                           (38)
                                                                             u0 (c)          Rβ

and
                                                                             γ (θ)    µ (θ)
                                                            [∆ (θ)] : −            = t                                              (39)
                                                                              Rβ    f (θ|θ− )
Using (37) and (39) in the expression for µ (θ) from (36) yields: µ θt = κ θt + η θt where
                                                                                          

                       Z θ̄                          Z θ̄                        !
                  t             1           0                  1
                                                                     f (m|θ− ) dm f t (θ|θ− )
                    
              κ θ =          0 (c (θ))
                                       1 − u (c (θ))       0 (c (m))
                        θt  u                         θ   u

                                                                               µ θt−1
                                                      θ̄
                                                                                               Z θ̄
                                                           ∂f t (θ|θ− )                              ∂f t (θ|θ− )
                                                  Z
                        t
                            
                  η θ           = − (γ− )                               dθ =                 Rβ                   dθ
                                                   θt         ∂θ−            f (θt−1 |θt−2 )     θt     ∂θ−
where the last equality uses the lag of (39).

Lemma 1 Under assumption (2), µ θt ≥ 0 ∀t, ∀θt .
                                  



   Proof of Lemma 1:
   The proof is close to the one in Golosov, Tsyvinski and Troshkin (2011), for a separable utility
function and with human capital. From the envelope condition and the FOC for v (θ) in (38):

                                                              ∂K             Rβ
                                                                 = λ (θ) = 0
                                                              ∂v          ut (c (θ))
                                                                                                                                     ∂K
Since by assumption v (θ) is increasing in θ and K () is increasing and convex in v, it must be that                                 ∂v
                                1
is increasing in θ, so that u0 (c(θ)) as well is increasing in θ.
                                       t




                                                                               34
                                                                                                                         ∂f 1
    Start in period t = 1. In this case, since θ0 has a degenerate distribution,                                         ∂θ0    (θ1 |θ0 ) = 0 and
                                                                                                 
                                                     Z     θ̄
                                                                              1               
                                    µ (θ1 ) =                                 − λ−  f 1 θ̃1 dθ̃1
                                                       θ1                u01 c θ̃1

Choose the θ0 such that u0 (c(θ
                             1                        1                                  0
                                0 )) = λ− . Since u0 (c(θ)) is increasing in θ, for θ ≥ θ , µ (θ) ≥ 0 (integrating

over non-negative numbers only). Using the boundary condition µ (θ) = 0, µ (θ1 ) can also be rewritten
as:                                                                   
                                        Z θ1
                                             −  1  + λ−  f 1 θ̃1 dθ̃1
                                                                             
                             µ (θ1 ) =
                                         θ       u01 c θ̃1

Since for θ1 ≤ θ10 , u0 (c(θ
                          1
                             1 ))
                                  ≤ λ− , we again have µ (θ1 ) ≥ 0. Thus, for all θ1 , µ (θ1 ) ≥ 0.
   By the first-order condition for ∆ in (39):

                                                                             γ (θ1 )   µ (θ1 )
                                                                         −           =
                                                                              Rβ       f (θ1 )

so that γ (θ1 ) ≤ 0, for all θ1 . Note that µ (θ2 ) is equal to:
                                                                                                                
                              Z    θ̄
                                                 1                                      ∂f θ̃2 |θ1        (γ )            
                  µ (θ2 ) =                      − (λ− ) −                                           −   f θ̃2 |θ1
                              θ2            u02 c θ̃2                                       ∂θ1         f θ̃2 |θ1

                                            g (θ̃2 |θ1 )                                                                                       1
Since by assumption (2) iii),               f (θ̃2 |θ1 )
                                                            is increasing in θ̃2 , and we already showed that                             u0 (c(θ̃2 ))
                                                                                                                                                         is
increasing in θ̃2 , there is a θ20 such that

                                           1          ∂f (θ20 |θ1 ) (γ− )
                                                    −                           = λ−
                                     u02 (c (θ20 ))      ∂θ1       f (θ20 |θ1 )

and such that for θ2 ≥ θ20 , µ θ2 ≥ 0 (since integrating over non-negative numbers only). Rewriting
                                     

µ θ2 as an integral from θ to θ2 and using the boundary condition θ = 0, we can again show that
      

µ (θ2 ) ≥ 0 also for θ2 ≤ θ20 . Proceeding in the same way for all periods up to T shows the result.
    If θ is iid, γ− = 0 and η θt = 0 for all t. In addition, if u0t (ct ) = 1 ∀t, then κ θt = 0 as well.
                                                                                          
                                                       
    From the boundary conditions µ (θ) = µ θ̄ = 0.

    The Inverse Euler Equation for capital:

Proposition 6 At the optimum, the inverse Euler Equation holds:
                                                           Z        θ̄
                                      Rβ                                          1            t+1
                                   0           =                                           f         (θt+1 |θt ) dθt+1                              (40)
                                  ut (c (θt ))                  θ        u0t+1 (c (θt+1 ))


   Proof of Proposition (6):
   Taking integral of µ̇ (θ) in equation (35) between the two boundaries, θ̄ and θ, and using the
                           
boundary conditions µ θ̄ = µ (θ) = 0, as well as the expression for λ− from (38) , lagged by one
period, yields the inverse Euler equation in (40).


                                                                                   35
   Proof of Proposition (4):
   In the learning-by-doing case, the training stock is a result of past labor supply:
                                                           X
                                                                lt = zt
                                                            t

and
                                                       lt = zt − zt−1 .

   The labor wedge is appropriately redefined here as:
                                              0
                                                                  φ0 (lt+1 )      φ0 (lt )
                                                                           
                                wzt             u (ct+1 )
              (1 − τLt ) wt 1 +     lt = βE               w t+1 −               +
                                wt               u0 (ct )          u0 (ct )       u0 (ct )

   Taking the first-order condition of the planning problem with respect to zt :


                                                 φ0 (l)
                                                               0                    
                                    l                     1        φ (lt+1 )
            [z (θ)]   : −wt 1 + εwi + 0                 − E                  −   w t+1
                                    i            u (c) R          u0 (ct+1 )
                                                 2                            
                             µ (θ)                ∂ wt 1        ∂wt ∂wt 1               µ (θt ) wθt 0       1
                      = −               lφ0 (l)              −               2   −                    φ (l)
                          f (θt |θt−1 )          ∂θt ∂zt wt     ∂θt ∂zt wt           f (θt |θt−1 ) wt       εt
                                                                   
                        1        µ (θt+1 ) wθt+1 0               1
                      +   E                          φ (lt+1 )
                        R      f (θt+1 |θt ) wt+1              εt+1

                              0
                                                          φ0 (lt+1 )
                                                                    
                    τLt        φ (lt )    1
  [z (θ)]   :                          +     E   w t+1 −
                 (1 − τLt ) u0 (ct ) R                    u0 (ct+1 )
                                                                                                                
                    µ (θ)       0    εwθ,t wz,t                   1      1       µ (θt+1 ) 0            εwθ,t+1 1
            =                  φ (l)         l     [ρθz,t − 1] +       − E                    φ (lt+1 )
                 f (θt |θt−1 )         θt      wt                 εt     R      f (θt+1 |θt )            θt+1 εt+1
                                 0                               0
                                                                             
                     1               u (ct+1 )    1                φ (lt+1 )
            −               E β 0              −          wt+1 − 0
                 (1 − τLt )            u (ct )    R                u (ct+1 )


   Proof of Proposition (5):
   Suppose that                                                          
                                                           yt zt − zt−1
                                                  φt          ,
                                                           wt     θt
   The envelope condition is:
                                                                                           
                                   wθt             zt − zt−1     zt − zt−1          zt − zt−1
                          ω̇ (θ) =     lt φlt lt ,             +           φit lt ,
                                   wt                  θt            θt2                θt

   Where φit denotes the derivative with respect to its second argument and we have the relation:

                                                         1
                                                  φzt = φit
                                                         θ
where φzt is the usual derivative with respect to zt from the text.
    Again, let the expenditure function: c̃ (l, ω − βv, z, z , θ) defines consumption indirectly as a function
of labor l, current period utility (ũ = ω − βv), training, and the current realization of the type. The
Hamiltonian is:

                                                                36
           (c̃ (l (θ) , ω (θ) − βv (θ) , z (θ) − z− , θ) − wt (θ, z (θ)) l (θ)) f t (θ|θ− )
               1
           + K (v (θ) , ∆ (θ) , θ, z (θ) , t + 1) f t (θ|θ− )
              R
                                                              ∂f t (θ|θ− )
                                                                           
           +λ− v − ω (θ) f t (θ|θ− ) + γ− ∆ − ω (θ)
                                        
                                                                  ∂θ−
                                                                                                              
                     wθt                 z(θ) − z (θ )       z(θ) − z (θ )                 z(θ) − z (θ )
         + µ (θ)         l(θ)φlt l(θ),                    +                   φ zt   l(θ),                 + β∆ (θ)
                     wt                        θ                    θ2                           θ


   Taking the FOC with respect to labor and replacing for the definition of the labor wedge:

                                                                  wθt 1 + εu
                                                                                      
                                   τL (θ)       µ (θ) 0                          it φlit
                         [lt ] :            =           u (ct )                +
                                 1 − τL (θ)   f (θ|θ− )           wt    εc       θt φlt
   Using the fact that
                                                   it φlit         εφi
                                                           = ρφlit
                                                   θt φlt           θ
yields the formula in the text:

                                                                  wθt 1 + εu
                                                                                     
                                   τL (θ)       µ (θ) 0                           φ εφi
                         [lt ] :            =           u (ct )                + ρlit
                                 1 − τL (θ)   f (θ|θ− )           wt    εc            θ




                                                           37
