                                NBER WORKING PAPER SERIES




                    THE GEOGRAPHY OF DEVELOPMENT:
        EVALUATING MIGRATION RESTRICTIONS AND COASTAL FLOODING

                                           Klaus Desmet
                                       Dávid Krisztián Nagy
                                      Esteban Rossi-Hansberg

                                        Working Paper 21087
                                http://www.nber.org/papers/w21087


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                      April 2015




We are grateful to the Gallup Organization and to Angus Deaton for providing us with aggregate national
data on wellbeing and on preferred migration destinations from the Gallup World Poll. We also thank
Treb Allen, Maya Buchanan, Angus Deaton, Tom Holmes, Chang-Tai Hsieh, Erik Hurst, Steve Redding,
Frédéric Robert-Nicoud, Jesse Shapiro, Joe Shapiro, and Rob Townsend for comments and discussions.
The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2015 by Klaus Desmet, Dávid Krisztián Nagy, and Esteban Rossi-Hansberg. All rights reserved.
Short sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.
The Geography of Development: Evaluating Migration Restrictions and Coastal Flooding
Klaus Desmet, Dávid Krisztián Nagy, and Esteban Rossi-Hansberg
NBER Working Paper No. 21087
April 2015
JEL No. E2,F11,F18,F22,F43,O1,O4,R23

                                             ABSTRACT

We study the relationship between geography and growth. To do so, we first develop a dynamic spatial
growth theory with realistic geography. We characterize the model and its balanced growth path and
propose a methodology to analyze equilibria with different levels of migration frictions. We bring
the model to the data for the whole world economy at a 1°×1° geographic resolution. We then use
the model to quantify the gains from relaxing migration restrictions as well as to describe the evolution
of the distribution of economic activity in the different migration scenarios. Our results indicate that
fully liberalizing migration would increase welfare more than three-fold and would significantly affect
the evolution of particular regions in the world. We then use the model to study the effect of a spatial
shock. We focus on the example of a rise in the sea level and find that coastal flooding can have an
important impact on welfare by changing the geographic-dynamic path of the world economy.


Klaus Desmet                                        Esteban Rossi-Hansberg
SMU                                                 Princeton University
Department of Economics                             Department of Economics
3300 Dyer, Suite 301                                Fisher Hall
Dallas, TX 75205                                    Princeton, NJ 08544-1021
kdesmet@smu.edu                                     and NBER
                                                    erossi@princeton.edu
Dávid Krisztián Nagy
Princeton University
Department of Economics
Fisher Hall
Princeton, NJ 08544-1021
dnagy@exchange.Princeton.EDU
                                  The Geography of Development:
            Evaluating Migration Restrictions and Coastal Flooding
               Klaus Desmet                Dávid Krisztián Nagy                 Esteban Rossi-Hansberg
                   SMU                     Princeton University                  Princeton University

                                                       April 3, 2015


                                                           Abstract

          We study the relationship between geography and growth. To do so, we …rst develop a dynamic spatial
      growth theory with realistic geography. We characterize the model and its balanced growth path and propose
      a methodology to analyze equilibria with di¤erent levels of migration frictions. We bring the model to the data
      for the whole world economy at a 1        1 geographic resolution. We then use the model to quantify the gains
      from relaxing migration restrictions as well as to describe the evolution of the distribution of economic activity
      in the di¤erent migration scenarios. Our results indicate that fully liberalizing migration would increase welfare
      more than three-fold and would signi…cantly a¤ect the evolution of particular regions in the world. We then
      use the model to study the e¤ect of a spatial shock. We focus on the example of a rise in the sea level and …nd
      that coastal ‡ooding can have an important impact on welfare by changing the geographic-dynamic path of the
      world economy.



1     Introduction
An individual’s place of residence is essential in determining her productivity, income, and well-being. A person’s
location, however, is neither a permanent characteristic nor a free choice. People tend to ‡ee undesirable and
low productivity areas to go to places that o¤er better opportunities, but these choices are often hindered by an
assortment of restrictions. An obvious example is the e¤ort to stop undocumented migration to Europe, the U.S.
and most developed countries. How do these restrictions a¤ect the evolution of the world economy? How do they
interact with today’s production centers, as well as today’s most desirable places to live, to shape the economy
of the future? Any attempt to answer these questions requires a theory of development that explicitly takes into
account the geography of economic activity and the mobility restrictions and transport costs associated with it.
Once we have a basic understanding of the role of geography in development, we can start evaluating the impact
of events that change this geography; here, as an application, we study the economic impact of coastal ‡ooding.
    Constructing a theory to study the e¤ect of geography on development requires incorporating some well-known
forces as well as others that have received, so far, less attention. First, a particular location is unique because
    We are grateful to the Gallup Organization and to Angus Deaton for providing us with aggregate national data on wellbeing and
on preferred migration destinations from the Gallup World Poll. We also thank Treb Allen, Maya Buchanan, Angus Deaton, Tom
Holmes, Chang-Tai Hsieh, Erik Hurst, Steve Redding, Frédéric Robert-Nicoud, Jesse Shapiro, Joe Shapiro, and Rob Townsend for
comments and discussions. Desmet: kdesmet@smu.edu, Nagy: dnagy@princeton.edu, Rossi-Hansberg: erossi@princeton.edu.



                                                               1
of where it is relative to other locations, which determines its costs of trading goods. Furthermore, each location
has particular amenities that determine its desirability as a place to live, and a particular productivity level that
determines its desirability as a place to produce and work. This singularity of individual places underscores the
importance of bringing the actual geography of the world, as measured by the location of land and water, as
well as the distribution of other local spatial and economic characteristics, into the analysis. Second, migration
across countries is possible but limited, mostly due to institutional restrictions. National borders restrain mobility
well beyond the existing frictions within countries. Third, the distinct levels of labor productivity of locations,
which re‡ect their institutions, infrastructure, education systems, and capital stocks, as well as location-speci…c
technological know-how, evolve over time. Firms can invest in improving this local technology and infrastructure.
Not all improvements in technology are local in nature or the result of purposeful investments though. Firms also
bene…t from the di¤usion of the innovations and creativity of others. Fourth, a location’s population density a¤ects
its productivity, its incentives to innovate, and perhaps most important, its amenities. Large concentrations of
people in, for example, urban areas bene…t from agglomeration e¤ects but also su¤er the undesirable costs from
congestion.
   Our aim is to study the evolution of the world economy at a rich level of geographic detail (one-degree-by-one-
degree resolution) over many years. So our analysis naturally involves many choices and compromises. The basic
structure of the model is as follows. Each one-degree-by-one-degree cell of the world contains …rms that produce a
variety of goods using location-speci…c technologies that employ labor and a local factor we refer to as land. Firms
can trade subject to iceberg transport costs. Each location is endowed with amenities that enhance the quality
of life in that cell. The static spatial equilibrium resembles the one proposed in Allen and Arkolakis (2014) with
local factors and a trade structure à la Eaton and Kortum (2002). The dynamic model uses this structure and
allows …rms to invest in improving local technology as in Desmet and Rossi-Hansberg (2014a). These technological
innovations determine next period’s productivity after taking into account the fact that part of these technologies
disseminate over space.
   We not only characterize the steady-state distribution of economic activity, but we are also able to compute
transitions since, as in Desmet and Rossi-Hansberg (2014a), the innovation decision can be reduced to a simple
static problem due to land competition and technological di¤usion. Our ability to prove the uniqueness of the
equilibrium, to characterize the steady state, to identify the initial distribution of amenities and productivity levels
in all locations, and to simulate the model, though novel, is importantly enhanced by the set of results in Zabreyko
et al. (1975), …rst used in spatial models in the related static and single-country model of Allen and Arkolakis
(2014). So we owe a substantial debt to this work.
   Identifying the reasons why agents locate in a particular place necessarily requires taking a stand on the oppor-
tunities they have to move across locations in search of better living and work opportunities. Under the assumption
of free mobility, a long tradition in urban and regional economics has identi…ed productivity and amenities across
locations using land prices and population counts (see, e.g., Roback, 1982, following the hedonic approach of Rosen,
1979). More recently, another strand of the literature has used income per capita and population counts, together
with a spatial equilibrium model, to identify these same local characteristics (see, among many others, Allen and
Arkolakis, 2014, Behrens et al., 2013, Desmet and Rossi-Hansberg, 2013, Fajgelbaum and Redding, 2014).
   We follow this second strand of the literature, but note that the static nature of these papers yields a de-
composition that depends crucially on parameters that are likely to evolve with the level of development of the
economy. That is, the parameters used to identify amenities and productivities depend on the particular time



                                                           2
period in which the exercise was done. As a result, they do not represent stable parameters that one can use
to obtain meaningful conclusions in a dynamic context. In fact, in our theoretical framework, the relationship
between income, population density, and amenities evolves over time as the economy becomes richer and slowly
converges to a balanced growth path. In Appendix A.1 we present some empirical evidence consistent with these
theoretical patterns, using data on U.S. counties and zip codes.
   Another problematic assumption in this literature is free mobility, particularly given that we are analyzing not
only migration across regions within a country but also migration across all countries in the world. While the
assumption of free mobility within countries may still be acceptable, it is hard to argue that people anywhere can
freely move to the nicest and most productive places on earth. To see this, it su¢ ces to have a casual look at
the U.S.-Mexico border, or the restrictions on African immigration in Europe. More important, ignoring mobility
restrictions leads to unreasonable conclusions. For example, it would result in an identi…cation of productivities
and amenities that makes the Democratic Republic of the Congo one of the nicest places to live on Earth. Although
it is hard to take a de…nitive stand on what characteristics a country’s individuals enjoy the most, basic evidence
on health, education, governance and institutions suggests that such a conclusion masks the fact that many people
in Congo do not choose to live there, but instead are trapped in an undesirable location.
    Once we explicitly account for migration restrictions, and therefore utility di¤erences across countries, we get
a more nuanced picture. To understand why, note that our theory only identi…es amenities relative to utility at
each location. Hence, in the absence of mobility restrictions, the large values of amenities relative to utility in
Congo would show up as those regions having high amenity levels. But if the Congolese are unable to move to
other countries, then the same large values of amenities relative to utility would show up as Congo having a low
utility level. Identifying the actual amenity levels therefore involves incorporating more data. To do so, we use
survey data on Cantril ladder measures of subjective well-being, as well as actual and desired migration ‡ows from
the Gallup World Poll.
    The subjective well-being data are an evaluative measure that asks individuals to assess their lives on a ladder
scale, from the worst possible to the best possible life they can envision for themselves. Deaton (2008) and
Kahneman and Deaton (2010) argue that this measure correlates well with log income and does not exhibit a
variety of well-known pathologies that a- ict hedonic measures of subjective well-being or happiness. We therefore
interpret this evaluative measure as giving us information on the welfare of individuals. Still, we need to convert this
ladder with eleven steps into a cardinal measure of the level of utility. To do so, we match the relationship between
the ladder measure and log income in the model and in the data. We also present an alternative methodology that
uses actual and desired migration ‡ows and yields similar results. Using the cardinal measure of utility together
with the amenity to utility ratio, we can recover the actual level of amenities for each cell of the world. As an
overidenti…cation check, we …nd that these estimated amenities correlate well with commonly used exogenous
measures of quality of life.1 With these amenities in hand, we are ready to perform a variety of exercises, including
counterfactual scenarios with either free mobility or partial removal of observed migration frictions.2
    We calibrate the rest of the model using data on the evolution of output across countries and other information
from a variety of sources. We then perform a number of experiments where we simulate the transition of the
world economy to its balanced growth path (which takes about 600 years). The parameters we estimate guarantee
    1 This suggests that subjective well-being di¤erences capture an essential part of utility di¤erences across countries, although both

concepts are unlikely to exactly coincide (see also Glaeser, Gottlieb and Ziv, 2014).
    2 An alternative approach to incorporate migration restrictions is to use strong distributional assumptions on the location preferences

of individuals (as in Kline and Moretti, 2014). See Section 4.5.2, where we incorporate migration data into our analysis using a similar
approach.


                                                                    3
that the equilibrium is unique and that the economy eventually converges to a balanced growth path in which
the geographic distribution of economic activity is constant. The transition to this balanced growth path can,
however, take very long. If current migration frictions do not change, it takes about 200 years for the economy to
reach its balanced growth path. The protracted length of this transition is the result of the sequential development
of clusters due to the complexity of the world’s geography. During these 200 years the world experiences large
changes. The world’s real output growth rate increases progressively, from around 2% to 3%, while the growth
rate of welfare declines from 5% to slightly above 3%. The correlation between GDP per capita and population
density also changes dramatically. The world goes from the current negative correlation of around -0.37 to a high
correlation of 0.76 in the balanced growth path.3 That is, in contrast to the world today, where many densely
populated areas are poor, in the future the dense regions will be the rich regions.
    Relaxing migration restrictions leads to large increases in welfare and productivity at impact. The growth rate
of real GDP and welfare also unambiguously increases in the balanced growth path. For example, with the current
frictions about 0.74% of people migrate in a year today, with this percentage converging to zero in the balanced
growth path.4 If, instead, we drop all restrictions, so there is free mobility, at impact 78.2% of the population
moves across countries and we get welfare gains in the world of 312%.5 Although this experiment is extreme and
we also compute the e¤ects of partial liberalizations, it illustrates the magnitude of the very large gains at stake
and it highlights the role of migration policies when thinking about the future of the world economy.
    Importantly, di¤erences in migration restrictions put the world on di¤erent development paths in which the
set of regions that bene…t varies dramatically. With the current restrictions, we get a productivity reversal, with
many of today’s high-density low-productivity regions in sub-Saharan Africa, South Asia and East Asia becoming
high-density high-productivity regions, and North America and Europe falling behind in terms of both population
and productivity. In contrast, when we relax migration restrictions, Europe and the Eastern areas of the United
States remain strong, with certain regions in Brazil and Mexico becoming important clusters of economic activity
too.
    The driving forces behind these results are complex since the world is so heterogeneous. One of the key
determinants of these patterns is the correlation between GDP per capita and population density. As we mentioned
above, the correlation is negative and weak today, and our theory predicts that, consistent with the evidence of the
U.S.,6 this correlation will become positive and grow substantially over the next six centuries. Two forces drive this
result. First, people move to more productive areas, and second, more dense locations become more productive
over time since investing in local technologies in dense areas is, in general, more pro…table. Migration restrictions
shift the balance between these two mechanisms. If migration restrictions are strict, people tend to stay where they
are, and today’s dense areas, which often coincide with developing countries, become the most developed parts of
the world in the future. If, in contrast, migration is free, then people move to the most productive, high-amenity
areas. This tends to favor the current developed economies. Liberalizing migration improves welfare so much
because it makes the high-productivity regions in the future coincide with the high-amenity locations. So relaxing
migration restrictions eliminates the productivity reversal that we observe when migration restrictions are kept
   3 The  correlation is computed using 1     1 land cells as units.
   4 In the data, the annual migration rate across countries (calculated in an identical way) was 0.6% in 1961, 0.4% in 1981, and 0.34%
in 2001. These numbers are a bit lower than in the early periods of our simulation with current migration restrictions, although the
model’s migration rate converges to zero, with yearly mobility rates declining by about half in the …rst 30 years.
   5 We use a utilitarian welfare criterion and just calculate the population weighted average utility in the world. Mobility across cells,

rather than across countries, when we liberalize is only slightly higher at 79.4%.
   6 See the results for U.S. counties and zip codes in Appendix A.1.




                                                                    4
constant.
   These results highlight the importance of geography, and the interaction of geography with factor mobility,
for the future development path of the world economy. Any policy or shock that a¤ects this geography can have
potentially large e¤ects through similar channels. We explore this further by using our framework to evaluate the
economic impact of coastal ‡ooding due to climate change. Scientists indicate that sea levels are on the rise as
a consequence of the melting of polar ice-sheets and changes in the volume of the water mass due to increases
in average world temperatures. These rising sea levels imply that many areas that host millions of residents and
workers today will become submerged in water in the future. For example, an increase of 6 meters in the sea level
(a fairly extreme scenario) would ‡ood 1% of land, home to 6.6% of the world’s population.
   What is the economic cost of coastal ‡ooding when taking into account the future development path of the
world economy? For a 6-meter rise in sea levels, we …nd welfare losses of around 8.0%. Two remarks are in order
here. First, these are present value welfare losses that take into account future development, not just simple static
losses as calculated in most of the related literature (e.g., Dasgupta et al., 2007).7 Second, welfare losses change
very little with migration restrictions.
   The …nding of welfare losses not depending on mobility is unexpected given the logic in Desmet and Rossi-
Hansberg (2014b). In that paper we argue that, in the absence of mobility frictions, local phenomena –like
temperature increases due to climate change–should result in small economic losses. Land is an abundant factor
in the world; so, as long as adaptation through mobility is an option, the world should be able to escape these
negative developments by moving economic activity and residents to areas that are not a¤ected by the phenomena.
It is only in the presence of migration restrictions, when adaptation through mobility becomes impossible or costly,
that local phenomena can have large e¤ects on welfare.
   The …ndings in our current analysis, though simpler in terms of the link between the economy and climate
change, incorporate a much more detailed geography as well as a more detailed description of mobility restrictions.
These additions a¤ect the argument above. Free mobility tends to attract more population and development to
coastal areas that are in danger of ‡ooding. This implies that when mobility is free and ‡ooding occurs, it a¤ects
a greater share of the population and the economy. Hence, although it is easier for people to move, more people
su¤er the impact of ‡ooding. Moreover, higher mobility does not ensure that people move to the socially optimal
places. In the face of ‡ooding, people move to locations where they individually gain most, disregarding both the
impact on others and the e¤ect on the future evolution path of the world economy. Although a planner would much
prefer to move people to nearby cells in the same country that will not be ‡ooded, in a competitive equilibrium this
may not happen. Because of the less detailed geography in Desmet and Rossi-Hansberg (2014b), and the simpler
spatial pattern of the climate shock considered there, this issue does not arise. As a result, mobility has small and
ambiguous e¤ect on the present value of welfare losses from ‡ooding, although it increases the losses in the long
term.
   The rest of the paper is organized as follows. Section 2 presents the model and proves the existence and
uniqueness of the equilibrium. Section 3 characterizes the balanced growth path of the economy and provides a
su¢ cient condition on the parameters of the model in order for a unique balanced growth path, where the non-
degenerate distribution of economic activity is invariant, to exist. Section 4 discusses the calibration of the model,
including the inversion to obtain initial productivity and amenity values, as well as the algorithm used to simulate
the model. Section 5 presents our numerical …ndings, which include the results for the benchmark calibration,
  7 Section 5.3 includes a more detailed discussion of how our exercise …ts into the broader literature on the economic impact of

‡ooding.


                                                               5
di¤erent levels of migration frictions, and the change in sea levels. Section 6 concludes. Appendix A presents
evidence from U.S. zip codes and counties that shows how the correlation of density and productivity changes with
income per capita. It also shows that our estimates of amenities correlate well with exogenous measures of quality
of life, and it presents results of the e¤ect of a 1-meter increase in sea level. Appendix B presents the proofs not
included in the main text, and Appendix C discusses the data and their sources in detail. An Online Appendix
includes videos with simulations of the world economy for di¤erent migration and ‡ooding scenarios.


2     The Model
Consider an economy that occupies a two-dimensional surface S. A location is a point r 2 S: Location r has land
                                                                                                  R
density H (r) 0, where H ( ) is an exogenously given continuous function that we normalize so that S H (r) dr =
1. There are C countries. Each location belongs to one country, so that countries constitute a partition of S:
(S1 ; : : : ; SC ). The world economy is populated by L agents who are endowed with one unit of labor, which they
supply inelastically.


2.1      Preferences
Every period, agents derive utility from local amenities and from consuming a set of di¤erentiated products with
CES preferences. An agent’s period utility is given by

                                                                  Z     1
                                                                                          1


                                                ut (r) = at (r)             c!
                                                                             t   (r) d!       ;                                     (1)
                                                                    0


where 1= [1       ] is the elasticity of substitution with 0 <              < 1, at (r) denotes amenities at location r and time
t, and   c!
         (r) denotes consumption of good ! at location r and time t. Agents discount the future at rate and
          t
                                                              P
so the welfare of an individual in the …rst period is given by t t ut (rt ) where, abusing notation, rt denotes her
location choice at t: Amenities take the form

                                                      at (r) = a (r) Lt (r)          ;                                              (2)

where a (r) is an exogenously given positive function, Lt (r) is population per unit of land at r in period t, and
is a …xed parameter where            0.8 Thus, we allow for congestion externalities in local amenities as a result of high
population density, with an elasticity of amenities to population given by                        :
   We assume that agents cannot write debt contracts with each other. So, as a whole, the residents of a location
can save only by investing to enhance the technology to produce in that location in the future, and therefore future
local land rents and wages. An agent earns income from work, wt (r) ; and from the local ownership of land. We
assume that local rents are distributed uniformly across a location’s residents.9 So if Rt (r) denotes rents per
unit of land, then each agent receives land rent income Rt (r) =Lt (r). Total income of an agent in location r at
time t is therefore wt (r) + Rt (r) =Lt (r) : Let Pt (r) denote the ideal price index at location r in period t, where
  8 This is consistent with the positive value of  we …nd in our estimation, although the theory could in principle allow for a negative
number, in which case there would be positive amenities from agglomeration.
  9 See Caliendo et al. (2014) for alternative assumptions on land ownership and their implications.




                                                                   6
             hR                              i   1
                  1
Pt (r) =          0
                      p!
                       t (r)
                                  1
                                        d!           . Then

                                                                                                         wt (r) + Rt (r) =Lt (r)
                                                     ut (r) = at (r) yt (r) = at (r)                                             ;                                         (3)
                                                                                                                 Pt (r)

where yt (r) denotes real income.
     Agents are freely mobile within countries, but we allow for migration restrictions that create di¤erences in
utility levels across countries. In particular, agents can migrate freely up to the point at which the relative utility
levels of countries are left unchanged over time. Beyond this point, migration is prohibited. That is, we model
migration as a quota that adjusts to keep relative utility levels constant.10 As an example, consider a receiving
country and a sending country, and suppose the utility in the receiving country goes up. In that case, the receiving
country relaxes the quota, more migrants enter, and the utility of the receiving country relative to that of the
sending country returns to its original level. If relative utility levels do not change over time, the equilibrium
utility of an agent in location r in country c can then be written as uW               W
                                                                       t u (c), where ut is common across countries
but changing over time, and u (c) is country-speci…c but constant over time (and averages to one). Hence, in the
special case of free mobility, utility levels equalize across countries and so u (c) = 1.


2.2         Technology
Firms produce a good ! 2 [0; 1] using land and labor. A …rm using L!
                                                                   t (r) production workers per unit of land at
location r at time t produces
                                                                                      !
                                                                      qt! (r) =       t   (r)   1
                                                                                                     zt! (r) L!
                                                                                                              t (r)

units of good ! per unit of land, where                               1;       2 (0; 1]. A …rm’s productivity is determined by its decision on the
                                                                                          !
quality of its technology –what we call an innovation                                     t   (r) –and an exogenous local and good-speci…c productivity
                                                             !                                                             !
shifter     zt!   (r). To use an innovation                  t   (r), the …rm has to employ                                t   (r) additional units of labor per unit of
land, where            >       1 = [1        ]. The exogenous productivity shifter                           zt!   (r) is the realization of a random variable that
is i.i.d. across goods and time periods. It is drawn from a Fréchet distribution with c.d.f.

                                                                                                     Tt (r)z
                                                                               F (z; r) = e                        ;

where Tt (r) =             t   (r) Lt (r) , and                  0,        > 0 are exogenously given. The value of                                 t   (r) is determined by an
endogenous dynamic process that depends on past innovation decisions in this location and potentially in others,
 !
     ( ).
     We assume that the initial productivity                               0   ( ) is an exogenously given positive continuous function. Conditional
on the spatial distribution of productivity in period t                                             1,    t 1   ( ), the productivity at location r in period t is
given by
                                                                                      Z                                1   2

                                                     t   (r) =    t 1      (r)    1
                                                                                                t 1      (s) ds                t 1   (r)   2
                                                                                                                                               ;                           (4)
                                                                                          S
  1 0 Alternatively, we could assume that migrants face a utility cost that is proportional to welfare in the destination country. These

iceberg utility costs would be …xed, so as to leave relative utility levels across countries constant. The equilibrium allocation is not
a¤ected by whether we use a cost or a quota, although the individual utility gains from migration, of course, are. We believe it is more
appealing to assume that migrants gain in relative utility terms and so use the quota interpretation in our welfare gains calculations
throughout.




                                                                                                7
                                                R
where        is a constant such that               S
                                                        dr = 1 and               1;          2   2 [0; 1]. If   2   = 1 and population density is constant over
time, this implies that the mean of                     zt!   (r) is       t 1   (r)         1
                                                                                                 times the mean of zt! 1 (r).11 That is, the distribution of
productivity draws is shifted up by past innovations, but with decreasing returns if                                                       1   < 1. If        2   < 1, the dynamic
                                                                                                                                               R
evolution of a location’s technology also depends on the aggregate level of technology,                                                             S    t (s) ds.
     Later we will see that assuming                    1;     2   2 (0; 1) helps with the convergence properties of the model since we can
have local decreasing returns, but economy-wide linear technological progress. If                                                          2       = 1; the evolution of local
technology is independent of aggregate technology and, as we will show below, in a balanced growth path in which
the economy is growing, economic activity will generally end up concentrating in a unique point. In contrast, if
 1   =   2   = 0; only the aggregate evolution of technology matters, there are no incentives to innovate, and the
economy stagnates. Therefore, in the calibration we will necessary obtain values of                                                            1   and    2   strictly in between
0 and 1. We …nd that the distribution of growth rates in the world implies a high                                                          2   = 0:993:
   Across locations zt! (r) is assumed to be spatially correlated. In particular, we assume that the productivity
draws for a particular variety in a given period are perfectly correlated for neighboring locations as the distance
between them goes to zero. We also assume that at large enough distances the draws are independent. This
implies that the law of large numbers still applies in the sense that a particular productivity draw has no aggregate
                                    !
e¤ects. Formally, let               t (r; s)   denote the correlation in the draws zt! (r) and zt! (s) and let                                                    (r; s) denote the
distance between r and s. We assume that there exists a continuous function s (d) where                                                                       (r; s (d)) = d such
                     !                                                 !
that limd!0          t (r; s (d))   ! 1. Furthermore,                  t (r; s) = 0 for (r; s) large                  enough. One easy example is having land
                                                                        !                                                       !
divided into regions of positive area, where                            t (r; s) = 1 within a region                  and       t (r; s)   = 0 otherwise.
     Since …rm pro…ts are linear in land, for any small interval with positive measure there is a continuum of …rms
that compete in prices (à la Bertrand). Note that the spatial correlation of the productivity draws, as well as the
continuity of amenities and transport costs in space, implies that the factor prices and transport costs faced by
these …rms will be similar in a small interval. Hence, Bertrand competition implies that their pricing will be similar
as well. As the size of the interval goes to zero, these price di¤erences converge to zero, leading to an economy in
which …rms face perfect local competition.
     Local competition implies that …rms will bid for land up to the point at which they obtain zero pro…ts after
                                                                                     !
covering their investment in technology wt (r)                                       t   (r) . So even though this investment in technology a¤ects
productivity in the future through equation (4), the investment decision at any given point can safely disregard
this dependence given the absence of future pro…ts regardless of the level of investment. This implies that the
solution to the dynamic innovation decision problem is identical to a sequence of static innovation decisions that
maximize static pro…ts. Firms innovate in order to maximize their bid for land, win the land auction, and produce.
This decision a¤ects the economy in the future, but not the future pro…ts of the …rm, which are always zero. The
implication, as discussed in detail in Desmet and Rossi-Hansberg (2014a), is that we only need to solve the static
optimization problem of the …rm and can disregard equation (4) in the …rm’s problem.
     Therefore, after learning their common local productivity draw, zt! (r), a potential …rm at r maximizes its
  1 1 To obtain the mean of the standard Fréchet distribution F (z) = e Tt z    , …rst write down the density function f (z) =
                                          R            R                                                R
 Tt z     1 e Tt z . The mean is then 01 zf (z)dz = 01 Tt z e Tt z dz. Remember that ( ) = 01 y 1 e y dy. Rede-
                                            1 dz.
                                                                                                        R 0  Tt z       y dy =
…ne Tt z      = y, so that dy =      Tt z         Substitute this into the previous expression, so that 1     Tt z  1e
R0                  1 R
                        1  1              1

 1 ze
          y dy = T
                   t   0 y   e y dy = Tt ( 1 ), where Tt = t Lt . If 2 = 1, we have t = t 11 t 1 . Assuming the labor
                                                                    Tt               t                1                     1
force does not change over time, we can write                      Tt 1
                                                                          =                  =     t 1,   so that Tt =   t 1 Tt 1 .    Hence, the expectation is given by
                                                                                 t       1
             1                       1
                      1         1              1          1
E (zt ) = Tt     (        )=   t 1 Tt 1   (        )=    t 1E       (zt   1 ).




                                                                                                  8
current pro…ts per unit of land by choosing how much labor to employ and how much to innovate,

                                                   !                                                                                 !
                      max!            p!
                                       t (r; r)    t   (r)    1
                                                                  zt! (r) L!
                                                                           t (r)                wt (r) L!
                                                                                                        t (r)           wt (r)       t   (r)        Rt (r) ;
                  L!
                   t (r);   t   (r)


where p!
       t (r; r) is the price charged by the …rm of a good sold at r, which is equivalent to the price the …rm charges
in another location net of transport costs. The two …rst-order conditions are

                                                                        !                                      1
                                                       p!
                                                        t (r; r)        t    (r)   1
                                                                                       zt! (r) L!
                                                                                                t (r)              = wt (r)                                                   (5)

and
                                             !                !              1                                             !         1
                                          1 pt   (r; r)       t   (r)   1
                                                                                 zt! (r) L!
                                                                                          t (r) = wt (r)                   t   (r)       :                                    (6)

So a …rm’s bid rent per unit of land is given by

                                                          !                                                                                  !
                           Rt (r) = p!
                                     t (r; r)             t   (r)   1
                                                                        zt! (r) L!
                                                                                 t (r)                wt (r) L!
                                                                                                              t (r)            wt (r)        t   (r) ;                        (7)

which ensures all …rms make zero pro…ts. Using (5) and (6) gives

                                                                                                 !
                                                                            L!
                                                                             t (r)               t   (r)
                                                                                       =                   :                                                                  (8)
                                                                                                  1

                                                                        !
Then, total employment at r for variety !, Lt (r), is the the sum of production workers, L!
                                                                                          t (r), and innovation
            !
workers,    t   (r) , so
                                                  !                                    !              L!
                                                                                                       t (r)               1
                                                 Lt (r) = L!
                                                           t (r) +                     t    (r) =                      +         :                                            (9)

Note also that
                                                                             (1         )                          !
                                                       Rt (r) =                                 1 wt (r)           t   (r) ;                                                 (10)
                                                                                   1

                                                                                                                                                         !
so bid rents are proportional and increasing in a …rm’s investment in technology, wt (r)                                                                 t   (r) ; as we argued
above.
   In equilibrium …rms take the bids for land by others, and therefore the equilibrium land rent, as given and
produce in a location if their land bid is greater than or equal to the equilibrium land rent. Hence, in equilibrium,
in a given location, the amount of workers hired per unit of land and the amount of innovation done per unit of
land are identical across goods. We state this formally in the following result.

                                                                                   !                                                                                     !
Lemma 1 The decision of how much to innovate,                                      t   (r) ; and how many workers to hire per unit of land, Lt (r) ;
is independent of the local idiosyncratic productivity draws, zt! (r), and so are identical across goods !.

Proof. Since in equilibrium Rt (r) is taken as given by …rms producing at r; the proof is immediate by inspecting
(8), (9), and (10).

   This will greatly simplify the analysis, as it will provide us with a relation between p!             !
                                                                                           t (r; r) and zt (r) similar
to the one in Eaton and Kortum (2002) in spite of …rms being able to innovate. Combining the expressions above




                                                                                            9
yields an expression for the price of a good produced at r and sold at r:

                                                           1                                             (1   )   1
                                          1                                   1 Rt   (r)                               wt (r)
                        p!
                         t   (r; r) =                                                                                          :         (11)
                                                       1           wt (r) ( (1             )        1)                 zt! (r)

To facilitate subsequent notation, we rewrite the above expression as

                                                                              mct (r)
                                                                p!
                                                                 t (r; r) =           ;                                                  (12)
                                                                              zt! (r)

where mct (r) denotes the input cost in location r at time t, namely,

                                                           1                                             (1   )   1
                                         1                                    1 Rt   (r)
                         mct (r)                                                                                      wt (r) :           (13)
                                                    1              wt (r) ( (1             )        1)


It is key to understand that from the point of view of the individual …rm, this input cost mct (r) is given. As
a result, expression (12) describes a straightforward relation between the productivity draw zt! (r) and the price
p!
 t (r; r). As in Eaton and Kortum (2002), this is what allows us in the next subsection to derive probabilistic
expressions on a location’s price distribution, its probability of exporting to other locations, and its share of exports.


2.3     Prices, Export Probabilities and Export Shares
Let & (s; r)   1 denote the iceberg cost of transporting a good from r to s. Assume & ( ; ) is a continuous function.
Therefore, the price of a good !, produced in r and sold in s, will be

                                                                                      mct (r) & (s; r)
                                         p!           !
                                          t (s; r) = pt (r; r) & (s; r) =                              :                                 (14)
                                                                                          zt! (r)

As we derive formally in Appendix B, the probability that a given good produced in an area r is bought in s is
given by
                                                           Tt (r) [mct (r) & (r; s)]
                                    t   (s; r) = R                                                  all r; s 2 S:                        (15)
                                                       S
                                                           Tt (u) [mct (u) & (u; s)]           du
   The price index of a location s, as we also show in Appendix B, is then given by
                                                                    1    Z                                                  1


                         Pt (s) =                          +1                 Tt (u) [mct (u) & (s; u)]               du        ;        (16)
                                          (1       )                      S

where      denotes the gamma function.


2.4     Trade Balance
We impose trade balance location by location since there is no mechanism for borrowing from or lending to other
agents. Market clearing requires
                           h     total revenuei in location r to be equal to total expenditure on goods from r. Total
                                                                                     1
revenue at r is wt (r) H (r) Lt (r) +          t   (r)         + H (r) Rt (r) =          wt (r) H (r) Lt (r), where the last equality comes
from (8), (9) and (10). As in Eaton and Kortum (2002), the fraction of goods that location s buys from r,                           t   (s; r),




                                                                         10
is equal to the fraction of expenditure on goods from r, so that the trade balance condition can be written as
                                                           Z
                               wt (r) H (r) Lt (r) =                t   (s; r) wt (s) H (s) Lt (s) ds all r 2 S:                                            (17)
                                                            S

where the superscript ! can be dropped because the number of workers does not depend on the good a …rm
produces, and L can be replaced by L because the proportion of total workers to production workers is constant
across locations.


2.5    Equilibrium
We de…ne a dynamic competitive equilibrium as follows:

De…nition 1 Given a set of countries, Sc                  S; and their relative utility levels, u (c), initial technology, amenity
and land functions ( 0 ; a; H) : S ! R, a competitive equilibrium with potentially restricted mobility is a set of
functions (Lt ;  t ; Rt ; wt ; Pt ; t ; Tt ) : S ! R for    all t = 1; :::; as well as a pair of functions (pt ; ct ) : [0; 1]                           S!R
                W
and a scalar   ut , for all t = 1; :::; such that:

  1. Firms optimize and markets clear. Namely, (5), (6) and (9) hold.

  2. The share of income of location s spent on goods of location r is given, for all t, by (13) and (15).

  3. Trade balance implies that (17) holds for all r 2 S and all t.

  4. Land markets are in equilibrium, so land is assigned to the highest bidder. Thus,

                                                                                        1
                                                     Rt (r) =                                wt (r) Lt (r) :
                                                                                +   1


  5. The utility of location r in country c and time t is given by

                                          wt (r) + Rt (r) =Lt (r)                                                wt (r)
                     uW
                      t u (c) = at (r)                            = a (r) Lt (r)                                        for all r 2 S                       (18)
                                                  Pt (r)                                                     + 1 Pt (r)

      where the price index Pt ( ) is given by (16).

  6. Labor markets clear so                                    Z
                                                                    H (r) Lt (r) dr = L:
                                                                S

  7. Technology evolves according to
                                                                            Z                        1   2

                                         t   (r) =    t   1 (r)
                                                                        1
                                                                                    t 1     (s) ds           t 1   (r)   2
                                                                                                                             :                              (19)
                                                                            S


   We can manipulate the system of equations that de…nes an equilibrium and, ultimately, reduce it to a system
of equations that determines wages and employment levels in all locations. In a given period, the following lemma
characterizes the relationship between labor density and wages conditional on a ( ),                                             t   ( ) ; & ( ; ), uc , uW
                                                                                                                                                          t , and
parameter values. Appendix B presents all proofs not included in the main text.


                                                                            11
Lemma 2 Given              t   ( ), uW
                                     t , and u (c), if trade costs are symmetric so that & (r; s) = & (s; r) ; all s; r 2 S, the
equilibrium wage schedule wt ( ) and population density schedule Lt ( ) satis…es

                                                     a (r)     1+2                    1                   1
                                                                                                                                     1+     [   +    1   [1   ]   ]
                                   wt (r) = w                                 t (r)
                                                                                    1+2
                                                                                        H (r)           1+2
                                                                                                                Lt (r)                           1+2
                                                                                                                                                                                                     (20)
                                                     u (c)

and
                               (1+ )
                  a (r)        1+2
                                                                                                    [   1+[ +      1       [1        ]]     ]
                                         t   (r)   1+2
                                                         H (r) 1+2 Lt (r)                     1+2
                                                                                                                                                                                                     (21)
                  u (c)
                                   C Z
                                                           2
                                   X           a (s)     1+2              1+                                                                       1+
          =       uW                                                   (s) 1+2 H (s) 1+2 & (r; s)                  Lt (s)
                                                                                                                                    1            + 1+2    [       1+[ +        1   [1   ]]   ] ds:
                   t           1                                   t
                                         Sd    u (d)
                                   d=1


where C denotes the number of countries, such that [C Sc = S, r 2 Sc , and                                                              1       is a constant.

    Following Allen and Arkolakis (2014) we can then use Theorem 2.19 in Zabreyko et al. (1975) to prove that, if

                                                                                  1
                                                                              +                 +1          ;


there exists a unique positive Lt ( ) that solves (21). Given an equilibrium Lt ( ) ; all other variables are determined
by the equations above, and                   t+1   is uniquely determined by (19). This immediately guarantees the existence and
uniqueness of an equilibrium. We summarize this result in the following Lemma.

Lemma 3 An equilibrium of this economy exists and is unique if                                                  = +             1=                   +1               .

Proof. Theorem 2.19 in Zabreyko, et al. (1975) guarantees that there exists a unique solution to equation (21) as
long as the ratio of exponents to Lt (r) on the RHS and LHS of (21) is weakly smaller than one, namely,

                           1+                                  1                                                                                              1
              1        +                       1+        +               [1       ]                                                     1+               +                [1       ]     ;
                           1+2                                                                              1+2

which, after simplifying, leads to the condition in the statement of the Lemma.


3        The Balanced Growth Path
In a balanced growth path (BGP) of the economy, if one exists, all regions grow at the same rate. A BGP might not
exist; instead, all economic activity might eventually concentrate in one point, or the economy may cycle without
reaching a BGP. Given the evolution of technology in (19), the growth rate of                                                                   t   (r) is given by
                                                                                               Z                       1
                                                         t+1  (r)                                       t (s)                   2

                                                                  =           t (r)
                                                                                          1
                                                                                                              ds                    :
                                                           t (r)                                S       t (r)

                                                                                                                   t+1 (r)
Hence, in a BGP in which technology growth rates are constant, so                                                      t (r)
                                                                                                                                        is constant over time and space and
 t (s)
 t (r)
         is constant over time, the investment decision will be constant but di¤erent across locations. Divide both



                                                                                          12
sides of the equation by the corresponding equation for location s, and rearrange to get

                                                                                   1                      1
                                                                                                     [1   2]
                                                 t (s)             (s)     1        2     L (s)
                                                       =                                =
                                                 t (r)             (r)                    L (r)

where the second equality follows from (8) and where we drop the time subscript to indicate that we refer to a
variable that remains constant in the BGP. We can then use Lemma 2 and the labor market clearing condition
to derive an equation that determines the spatial distribution of productivity                                      t   (r) on the balanced growth path.
According to Theorem 2.19 in Zabreyko et al. (1975) a unique positive solution to that equation exists if

                                                              1                1
                                                          +       +                          +1           :                                            (22)
                                                                      [1           2]

   This condition is strictly stronger than the condition that guarantees the existence and uniqueness of an
equilibrium in Lemma 3 since it includes an extra positive term on the left-hand-side. The condition is also
intuitive. On the left hand side we have the two static agglomeration e¤ects: agglomeration externalities ( = ) and
improvements in local technology for today’s production (                           1=   ). The third term, which appears in the condition for
the balanced growth path only, is related to the dynamic agglomeration e¤ect from local investments in technology
as well as di¤usion (   1 = [1    2]   ): In fact, without di¤usion, when 1                                   2   = 0, condition (22) is never satis…ed
and there is no BGP with a non-degenerate distribution of employment. On the right-hand-side of condition (22)
we have the parameters governing the two congestion forces, namely, congestion through lower amenities ( ) and
congestion through lower land per worker (1                       ). So condition (22) simply says that in order for the economy to
have a unique BGP, the congestion forces have to be large enough relative to the agglomeration forces. Similarly,
the condition in Lemma 3 says that congestion forces have to be strong enough relative to static agglomeration
forces in order for an equilibrium to exist. The di¤erence is that an equilibrium can exist even if condition (22) is
violated since the dynamic agglomeration e¤ect leads economic activity to progressively concentrate in an area of
measure zero.
   We summarize the result in the following Lemma.

Lemma 4 If      = +     1=   +   1 = [[1         2]   ]           + [1         ], then there exists a unique balanced growth path with a
constant distribution of employment densities L ( ) and innovation                                   ( ) : In the BGP           t   (r) grows at a constant
rate for all r 2 S.

   The condition that determines           t   (r) in the BGP (which we write explicitly in the proof of Lemma 4) guarantees
that in the BGP welfare grows according to
                                                                                             1
                                                              uW
                                                               t+1                 t+1 (r)
                                                                   =                             :
                                                              uWt                   t (r)

We can then use the equations above to show that the growth rate of world utility (or the growth rate of real
output) is a function of the distribution of employment in the balanced growth path.

Lemma 5 In a balanced growth path, under the conditions of Lemma 4, aggregate welfare and aggregate real




                                                                               13
consumption grow according to
                              "R 1                 #1                                 1   Z                        1   2
                     uW
                      t+1       0
                                     c!
                                      t+1 (r) d!            1   2            1=                          1
                          =     R1                      =                                     L (s) [1   2]   ds           :   (23)
                     uWt             c!
                                      t (r) d!                           1   +            S
                                 0

Hence welfare and aggregate real output growth depend on population size and its distribution in space.


4     Calibration and Simulation of the Model
In order to compute the equilibrium of the model we need values for the nine parameters used in the equations
above, in addition to values for initial productivities and amenities for all locations. We also need values for
transportation costs between any two cells. If we are interested in scenarios where migratory restrictions are kept
as in the world today, we only need to recover amenities relative to utility levels, since equations (21) and (20)
only depend on a (r) =u (c). However, when we consider scenarios with counterfactual mobility frictions, we need
to identify amenities and utility levels separately. In that case we also need values for the relative utility levels for
all locations. Once we have numbers for all of these variables and parameters, we can compute the model with a
simple iterative algorithm.
    Table 1 lists the parameter values and gives a brief explanation of how they are assigned. When assigning
parameter values, we assume a model period to be one year, so we set = 0:95. We base some of the parameter
values on those in the existing literature. We estimate other parameter values using our model. In what follows we
start by brie‡y discussing some of the parameter values that come from the literature, and then provide a detailed
discussion of how we estimate the remaining parameters.
    The elasticity of substitution, 1= (1      ), is set to 4, similar to the 3.8 estimated in Bernard et al. (2003). We
choose a trade elasticity, , equal to 6.5, somewhere in the middle between the 8.3 value estimated by Eaton and
Kortum (2002) and the 4.6 value estimated by Simonovska and Waugh (2014). The labor share in production, ,
is set to 0.8. While higher than the standard labor share, this parameter should be interpreted as the non-land
share. Desmet and Rappaport (2014) …nd a land share of 0.1 when accounting for the land used in both production
and housing. Taking a broader view of land by including structures, this share increases to around 0.2, based on
a structures share slightly above 0.1, as calibrated by Greenwood, Hercowitz and Krusell (1997). We therefore
take the non-land share to be 0.8 but have checked that our main results are robust to alternative values for this
parameter.


4.1    Amenity Parameter
The theory assumes that a location’s amenities decrease with its population. As given by a (r) = a (r) L (r)                   , the
parameter     represents the elasticity of amenities to population. Taking logs gives us the following equation:

                                      log (a (r)) = E (log (a (r)))               log L (r) + " (r) ;                          (24)

where E (log (a (r))) is the mean of log (a (r)) across locations, and " (r) is the location-speci…c deviation of
log (a (r)) from the mean. Assuming that amenities are log-normally distributed across locations, we use data from
Desmet and Rossi-Hansberg (2013) on amenities and population for 192 metropolitan statistical areas (MSAs) in



                                                                    14
                                                    Table 1: Parameter Values

      Parameter                      Target/Comment
                           P                                           hR               i1=
                                 t                                         1
      1. Preferences: t ut (rt ) where ut (r) = a (r) Lt (r) (r) 0 c!         t (r) d!       and e u~i (r)
        = 0:95              Discount factor
        = 0:75              Elasticity of substitution of 4 (Bernard et al., 2003)
        = 0:32              Relation between amenities and population
        = 1:8               Relation between actual migration, desired migration and subjective well-being
                                                                       Tt! (r)z
      2. Technology: qt (r) = !
                         !
                                t (r)
                                      1
                                        zt! (r) L!
                                                 t (r) , F (z; r) = e              and Tt! (r) = t (r) Lt (r)
        = 0:06              Elasticity of productivity to density (Ciccone and Hall, 1996)
        = 6:5               Trade elasticity (Eaton and Kortum, 2002; Simonovska and Waugh, 2014)
        = 0:8               Labor or non-land share in production
                            (Greenwood, Hercowitz and Krusell, 1997; Desmet and Rappaport, 2014)
       1 = 0:319            Relation between population distribution and growth
                                                              R                  1   2
      3. Evolution of productivity: t (r) = t 1 (r) 1 S t 1 (s) ds                     t 1 (r)
                                                                                               2
                                                                                                 and ( ) =
       2 =  0:993           Relation  between    population  distribution   and   growth
        = 125               Desmet and Rossi-Hansberg (2014a)
        = 0:2               Initial world growth rate of real GDP of 2%
      4. Trade Costs
       rail = 0:1434
       no_rail = 0:4302
       major_road = 0:5636
       other_road = 1:1272  Allen and Arkolakis (2014)
       no_road  = 1:9726
       water = 0:0779
       no_water = 0:779



the United States to estimate equation (24). One remaining issue is that population does not only a¤ect amenities,
but amenities also a¤ect population. To deal with this problem of reverse causality, we use an MSA’s exogenous
productivity level as an instrument for its population. Desmet and Rossi-Hansberg (2013) provide estimates for the
exogenous productivity of MSAs which they de…ne as the productivity that is not due to agglomeration economies.
When using this as an instrument, the identifying assumption is that a location’s exogenous productivity does not
a¤ect its amenities directly, but only indirectly through the level of its population. This is consistent with the
assumptions of our model. Estimating (24) by 2SLS yields a value of                 = 0:32, which is what we report in Table 1.


4.2     Technology Parameters
Our starting point is the economy’s balanced utility growth equation (23). To exploit the cross-country variation
in growth rates in the data, assume that all countries are in a balanced growth path, but their growth rates may
di¤er.12 In that case we can rewrite (23), after taking logs and discretizing space into cells, as
  1 2 Essentially, we are assuming that the relative distribution of population within countries has converged to what would be observed

in a balanced growth path, although international migration ‡ows may still change the relative distribution of population across
countries. As a result, growth rates may di¤er across countries, although each country is characterized by (23). As an alternative to
this simplifying assumption, we could use the whole structure of the model calibrated for 1990, and then estimate the parameters that
make the simulated model match the observed growth rates. This calculation requires enormous amounts of computational power and
so is left for future research. The fact that adding population growth to the estimating equation does not substantially change the
results alleviates this concern somewhat.




                                                                  15
                                                                                                                            X
                                                                                                                                          3
                          log ut+1 (c)       log ut (c) = log yt+1 (c)              log yt (c) =          1   +   2   log        Lc (s)                       (25)
                                                                                                                            Sc

where

                                                          1        2                 1                   1=
                                                 1   =                 log +             log
                                                                                                     1   +
                                                          [1        2]
                                                 2   =

                                                                   1
                                                 3   =                     ;
                                                          [1        2]


and country-level per capita growth is such that, in steady state, log yt+1 (c)                                        log yt (c) = log yt+1 (r)         log yt (r)
for all r 2 c.13 The theory therefore predicts that steady-state growth is a function of the following measure of the
spatial distribution of population
                                                                       X
                                                                                     3
                                                                           L (s)         :                                                                    (26)
                                                                       S

Assuming        2   > 0, then if 0 <     3   < 1, steady-state growth is maximized when labor is equally spread across space,
and if     3   > 1, steady-state growth is maximized when labor is concentrated in one cell. Before estimating (25),
we normalize (26) in order to eliminate the e¤ect of the number of cells di¤ering across countries:

                                                                1 X                          3
                                                                    L (s)                        ;                                                            (27)
                                                               NS
                                                                           S


where N S is the number of cells in a country. To see what this normalization does, consider two examples. Country
A has 4 cells: 2 have population levels L1 and 2 have population levels L2 . Country B is identical to country A,
but is quadruple its size: it has 16 cells, of which 8 have population levels L1 and 8 have population levels L2 . The
above normalization (27) makes the population distribution measures of countries A and B identical.
    To get empirical estimates for              1,   2   and   3,      we use cell population data from G-Econ 4.0 to construct a
measure of (27) for four years: 1990, 1995, 2000 and 2005. We focus on countries with at least 20 cells, and for the
data on real GDP per capita, we aggregate cell GDP and cell population from the G-Econ data set to compute a
measure of real GDP per capita. This gives us 106 countries and 3 time periods.
    When estimating (25), we use the between-estimator, i.e., we use the mean of the di¤erent variables. We do
so because the dependent variable (growth) is rather volatile, whereas the independent variable of interest (the
spatial distribution of population) is rather persistent. This suggests that most of the variation should come
from di¤erences between countries, rather than from di¤erences within countries. Moreover, (25) is a steady-state
relation, so focusing on the average 5-year growth rates seems sensible. Our estimation gives values of                                             2   = 0:00116
and    3   = 2:2. Using the expressions for          2   and   3   following (25), this yields                    1   = 0:319 and         2   = 0:993, which are
the values reported in Table 1.
    If we were to allow for population growth, this would not a¤ect the estimates as long as in the balanced growth
path population growth is the same across countries. If, however, population growth rates do di¤er across countries,
                                                                    P
equation (25) would become log yt+1 (c) log yt (c) = 1 + 2 log Sc Lc (s) 3 + [log Lt+1 (c) log Lt (c)]. Re-
  1 3 Equation (25) is consistent with there being no di¤erences in population growth across countries in a balanced growth path. If

we were to allow for such di¤erences, the …rst part ofPexpression (25) should be written as log ut+1 (c) log ut (c) = log yt+1 (c)
log yt (c)    [log Lt+1 (c) log Lt (c)], where Lt (c)    Sc Lt (s). As we will discuss later, this leads to very similar parameter values.



                                                                               16
estimating this equation and imposing a value of                           = 0:32, as estimated before, yields very similar results:                                 2   =
0:00103 and        3   = 2:6. This leaves the values of                1   and      2   virtually unchanged at, respectively, 0.335 and 0.993.


4.3     Trade Costs
We build on Allen and Arkolakis (2014) to calculate trade costs across locations. We discretize the world into 1
by 1 grid cells, which means 180                 360 = 64; 800 grid cells in total. A location thus corresponds to a grid cell.
To ship a good from location r to s, one has to follow a continuous and once-di¤erentiable path g (r; s) over the
surface of the Earth that connects the two locations. Passing through a location is costly. We assume that the
cost of passing through location r is given (in logs) by

log (r)       =        rail rail (r)   +   no_rail   [1   rail (r)] +         major_road major_road (r)                   +     other_road other_road (r)            +
                       no_road   [1    major_road (r)              other_road (r)] +                   water water (r)    +     no_water        [1      water (r)]

where rail (r) equals one if there is a railroad passing through r and zero otherwise, major_road (r) equals one if
there is a major road passing through r and zero otherwise, other_road (r) equals one if there is some other road
(but no major road) passing through r and zero otherwise, and water (r) equals one if there is a major water route
at r and zero otherwise. All coe¢ cients                  rail ,   no_rail ,        major_road ,          other_road ,        no_road ,         water   and   no_water
are positive constants, and their values are based on Allen and Arkolakis (2014).
     We observe data on water, rail, and road networks at a …ner spatial scale than the 1 by 1 level. In particular,
using data from http://www.naturalearthdata.com/, we can see whether there is a railroad, major road, etc.
passing through any cell of size 0:01 by 0:01 . We aggregate these data up to the 1 by 1 grid cell level such
that, for instance, rail (r) now corresponds to the fraction of smaller cells within cell r that have access to the rail
network. We do the same aggregation for the road and water variables.14
     Having       (r), we use the Fast Marching Algorithm to compute the minimum cost between any two cells r and
s:                                                                                  Z
                                                      log & (r; s) = inf                         log (u) du
                                                                           g(r;s)       g(r;s)
        R
where    g(r;s)
                  log (u) du denotes the line integral of log ( ) along the path g (r; s).15


4.4     Local Amenities and Initial Productivity
To simulate the model, we also need to know the spatial distribution of a (r) =u (c) and                                                0   (r). We use data at the
grid cell level on land H (r) from the National Oceanic and Atmospheric Administration, as well as population
L0 (r) and wages w0 (r) as measured by GDP per capita in 2000 (period 0) from G-Econ 4.0, to recover these
distributions. Using the equation

                                              a (r)       1+2                1                     1
                                                                                                                1+[   +   1    [1   ]
                                                                                                                                    ]

                              w0 (r) = w                           0   (r) 1+2 H (r)             1+2
                                                                                                       L0 (r)         1+2
                                                                                                                                            ;
                                              u (c)
   1 4 Clearly, building roads and rail is endogenous to local development. We abstract from this aspect, but note that major roads and

rail lines are in general constructed through geographically convenient locations, a feature of space that is, in fact, exogenous. In any
case, the major determinant of the cost of passing through a location is the presence of water.
   1 5 We apply Gabriel Peyre’s Fast Marching Toolbox for Matlab to calculate the minimum costs, taking into account that the Earth

is a sphere.



                                                                                 17
we obtain
                                          (1+2 )     a (r)                     1+2          1       [   +   1   [1   ]]
                           0    (r) = w                      H (r) w0 (r)              L0 (r)                                             (28)
                                                     u (c)
for any r 2 Sc . Plugging this into equation (21), we get

                                                                  C Z
                                                                  X
                        a (r)                                                        1+         1                           a (s)
  w0 (r)      L0 (r)               =      uW
                                           0        1w
                                                         (1+2 )
                                                                              w0 (s)      L0 (s)        H (s) & (r; s)              ds:   (29)
                        u (c)                                            Sd                                                 u (d)
                                                                  d=1


Given H (r), L0 (r) and w0 (r), and normalizing uW
                                                 0 to 1 and w to the average wage in the world in 2000, one has
to solve equation (29) for a (r) =u (c). Then one can use equation (28) to obtain                           0   (r). The following lemma says
that the values of a (r) =u (c) and        0   (r) that satisfy these equations are unique.

Lemma 6 The solution to equations (28) and (29) exists and is unique.

Proof. The existence and uniqueness of a solution to (28) directly follows from the existence and uniqueness of a
solution to (29). To prove existence and uniqueness for (29), see again Theorem 2.19 in Zabreyko et al. (1975).

   Lemma 6 guarantees the existence and uniqueness of the inversion of the model used to obtain the a (r) =u (c)
and   0   (r) : However, it does not guarantee that we can …nd a solution using an iterative procedure. At the end of
Appendix B we discuss the numerical algorithm we use to …nd a solution.
   Notice that our procedure only identi…es a (r) =u (c), but it cannot be used to tell a (r) apart from u (c). This is
not a problem if mobility restrictions remain unchanged after period 0. In that case, as can be seen from equation
(21), the equilibrium is in‡uenced only by the ratio a (r) =u (c). However, for counterfactual exercises where we
change migration restrictions, the values of u (c) change. In that case, we need an estimate of the initial u (c).
Of course, we also need to have such an estimate if we are interested in the values of local amenities per se.
For example, if we were to naively assume that utility was the same everywhere, we would erroneously interpret
a (r) =u (c) to be equal to local amenities. In that case unattractive places in which people are trapped would be
mistaken as fantastic places to live. In the next section we explain how we get an estimate of u (c) by using data
on countries’subjective well-being.


4.5       Relative Utilities
We use data on subjective well-being from the Gallup World Poll. Subjective well-being is measured on a Cantril
ladder from 0 to 10, where 0 represents the worst possible life and 10 the best possible life the individual can
contemplate for himself. This measure is, of course, ordinal, not cardinal. Furthermore, it requires the individual
to set her own comparison benchmark when determining what the best possible life, or the worst possible life,
might mean. This benchmark might vary across individuals, regions and countries. However, given that Deaton
and Stone (2013) and Stevenson and Wolfers (2013) …nd a relationship between subjective well-being and the log
of real income that is similar within the U.S. and across countries, we abstract from these potential di¤erences in
welfare benchmarks across the world. But we still need to transform subjective well-being into a cardinal measure
of the level of well-being. In what follows we suggest two ways of doing so.
   Recall that in the model the utility of an individual i residing in location r is linear in her real income, namely,

                                                         ui (r) = a (r) yi (r) ;                                                          (30)


                                                                        18
where real income is yi (r) = wi (r) + R (r) =L (r) =P (r). Since we are focusing on a given time period, we have
dropped the time subscript in the previous expressions. Then, to make the “ladder” data from the Gallup World
Poll comparable to the utility measure in the model, we need to transform subjective well-being into a measure
that is linear in income.

4.5.1       Using existing estimates of the relation between subjective well-being and income

Deaton and Stone (2013) …nd that the ladder measure of the subjective well-being of an individual i residing in
location r is linearly related to the log of her real income.16 In particular, they estimate a relation

                                                u
                                                ~i (r) = ln yi (r) + v (r) + "i ;                                               (31)

where the tilde refers to subjective well-being, as measured by the Cantril ladder, v (r) is a location …xed e¤ect,
and "i is a random variable with mean zero. Whereas the ladder measure is linear in the log of real income, our
utility measure in (30) is linear in the level of real income. To make (31) consistent with our model, take logs of
(30), multiply by , and allow for an idiosyncratic component to log utility. This yields

                                              ln ui (r) = ln yi (r) + ln a (r) + "i :                                           (32)

Equations (32) and (31) imply the following relation between utility as de…ned in our model, ui (r), and utility as
de…ned by subjective well-being, u
                                 ~i (r),
                                                                     u
                                                                     ~i (r)
                                                        ui (r) = e            ;                                                 (33)

where        = 1= . Given the structure of our model, one potential issue with estimating (31) if we only were to
use cross-country or cross-regional data is endogeneity: a location with a higher utility attracts more people and
therefore a¤ects the amenity levels through a (r) = a (r) L (r)                   . However, if (31) is estimated for a given time
period using the cross-sectional variation and including locational …xed e¤ects, this is less of a concern. Using
person-level data, Deaton and Stone (2013) estimate            to be around 0.55, which implies a value of            of 1.8.

4.5.2       Using data on actual and desired migration

Another way of obtaining an estimate of          is by using information on actual and desired migration. We proceed in
two steps. First, we derive an expression that relates the utility di¤erence between two locations in our model to
desired migration and the barriers to migration. Second, using equation (33), we use data on subjective well-being
and on desired migration from the Gallup World Poll, to estimate                     .

Step 1: Relate utility di¤ erences to desired migration.
We start by relating utility di¤erences between two locations and desired migration. As is standard in the migration
literature (Docquier et al., 2012; Behrens et al., 2013), we slightly adjust our model to allow for idiosyncratic taste
di¤erences across individuals and locations. Without such taste di¤erences, when individuals in location r are asked
whether they want to migrate to location s, either all of them or none of them should respond in the a¢ rmative.
Since survey data do not exhibit such extreme patterns, allowing for idiosyncratic taste di¤erences is reasonable.
 1 6 See   also Kahneman and Deaton (2010).




                                                               19
    We can then de…ne the utility of an individual i born in location r who moves to location s as

                                                uim (r; s) = u (s)      m(r; s) + "i (s);                                           (34)

where u (s) is the utility of residing in location s, common across all individuals; m(r; s) represent the barriers to
migrating from r to s; with m(r; s) = 0 if r and s are in the same country; and "i (s) represents idiosyncratic taste
di¤erences, distributed i.i.d. across individuals and locations according to an extreme value distribution with mean
zero and variance      2   2
                               =6, with a higher value of     indicating greater taste heterogeneity.17 The probability that
an individual born in r prefers location s over all other locations can then be written as

                                                                       exp ([u(s) m(r; s)] = )
                                 Pr um (r; s) = max um (r; k)        =P                          :                                  (35)
                                                     k                 k exp ([u(k) m(r; k)] = )

In equilibrium, this corresponds to the share of population born in location r that lives in location s:

                                             L (r; s)   exp ([u(s) m(r; s)] = )
                                                      =P                          :                                                 (36)
                                              L (r)     k exp ([u(k) m(r; k)] = )

By analogy, we can derive L(r; r)=L (r):

                                             L (r; r)        exp (u (r) = )
                                                      =P                          :                                                 (37)
                                              L (r)     k exp ([u(k) m(r; k)] = )

Taking logs and dividing expressions (36) and (37) yields

                                                     L(r; s)   u(s)      u (r)      m(r; s)
                                                ln           =                                 :                                    (38)
                                                     L(r; r)

Now suppose we eliminate legal migration barriers. Of course, some migration barriers would still persist. Denote
those remaining migration barriers by m0 (r; s). To simplify, assume that m0 (r; s) = m0 .18 In that case, the above
expression becomes
                                                      L0 (r; s)   u(s)      u (r)     m0
                                                 ln    0
                                                                =                          ;                                        (39)
                                                      L (r; r)
where the 0 superscript refers to variables in the absence of migration barriers. Rewriting (39), we can relate utility
di¤erences to desired migration and the migration barriers using

                                        u (s)   u (r) =      ln L0 (r; s)     ln L0 (r; r) + m0 :                                   (40)


Step 2: Estimation
According to our model, utility in (40) depends linearly on the level of income,19 whereas the subjective utility
measure from the Gallup World Poll depends linearly on the log of income, as shown by Deaton and Stone (2013).
  1 7 We interpret this barrier as a quota restriction that selects the individuals who are more willing to migrate. We model it here as

a cost faced by the marginal migrant that makes him indi¤erent to migrating. This cost m (r; s) is selected by the target country to
keep relative utility levels constant and is rebated to the number of migrants in the quota.
  1 8 Alternatively assuming that m0 (r; s) is a linear function of m(r; s) yields similar parameter estimates.
  1 9 Interpreting the utility in equation (40) as depending linearly on income is not only consistent with our model, it is also in line

with work by Grogger and Hanson (2011), who estimate a linear utility equation similar to (40) to study the relation between income
and migration.


                                                                   20
                                    u
                                    ~(s)
This implies that u (r) = e                , so that we can rewrite (40) as

                                                   u
                                                   ~(s)          u
                                                                 ~(r)
                                           e               e            =      ln L0 (r; s)     ln L0 (r; r) + m0 :                         (41)

The three parameters        ,       and m0 in (41) can then be estimated by minimizing

                                           Xh                                                                              i2
                                                          u
                                                          ~(s)          u
                                                                        ~(r)
                                min 0                e             e                ln L0 (r; s)      ln L0 (r; r)    m0        :           (42)
                                ; ;m
                                               r


We estimate (42) using aggregate data at the country level. To be more precise, for the 150 countries in our data
    ~ refers to subjective well-being on the Cantril ladder;20 L0 (r; s) is the number of people from location r who
set u
either reside in location s or desire to reside in location s; and L0 (r; r) is the number of people from location r
who want to stay in location r. Since migration costs are assumed to be zero within countries, which implies that
utility equalizes across locations within a country, we estimate equation (42) with locations aggregated by country.
The country-level data on subjective well-being and desired migration come from the Gallup World Poll, whereas
the data on actual migration come from Artuc et al. (2012). Note that, for each of the countries, we only know
how many people want to migrate to the most popular destination country. Hence, for each origin country we only
have information on one destination country.21
    One issue with the data is that, in some cases, taste di¤erences common to all individuals of a certain country
may render the di¤erence in average utility a poor measure of the desire to migrate. For example, the favorite
destination of Afghanistan is Iran (religious links); the favorite destination of Suriname is the Netherlands (colonial
links); and the favorite destination of Luxembourg is Portugal (migration links going back to the mid-1960s). To
minimize this issue, we exclusively focus on destination countries that are the favorite of a minimum number of
countries. When restricting our focus to countries that are favorite destinations shared by at least 7 countries,
we are left with 122 observations and estimate a value of                                     = 2:8. A more stringent restriction of the favorite
destination being shared by at least 10 countries limits the number of observations to 97 and yields an estimate of
  = 1:2.22 The average of these two estimates is very similar to the 1.8 …gure found by Deaton and Stone (2013),
so we take that value for       .


4.6        Computing Actual Local Amenities and Counterfactual Migration Scenarios
Local amenities. The inversion of the model described in Section 4.4 uses wage and population data to identify
a (r) =u (c), whereas the data on subjective well-being give us an estimate of utility, u (c) = e1:8~u(c) . Together, this
allows us to identify the amenity level of a location r,

                                                                                            a (r)
                                                                        a (r) = e1:8~u(c)         :                                         (43)
                                                                                            u (c)
  2 0 We  include a world map with the Cantril ladder data in Appendix A.3.
  2 1 Though   the data are at the country-level, it is important to point out that the information on how many people want to migrate
is based on individual-level survey data. It is therefore reasonable to assume that people do not take into account general equilibrium
e¤ects on utility through, for example, a change in amenities, when answering the question on whether they want to migrate. If not,
our estimation would be biased.
   2 2 The favorite destinations shared by at least 7 countries are Australia, France, Germany, Russia, South Africa, Spain, the U.K. and

the U.S. When restricting the list to include only destinations shared by at least 10 countries, Australia and Russia drop out.




                                                                                   21
Counterfactual migration scenarios. We now describe how to simulate the model under counterfactual mi-
gration restrictions.

Keeping mobility restrictions unchanged
Suppose we want to simulate the model over many periods, keeping current mobility restrictions unchanged. This
amounts to keeping relative utility di¤erences across countries constant. In that case, we use the values a (r) =u (c)
from the original inversion and keep them constant over time. Importantly, since the entire simulation is based
on the original values a (r) =u (c), this exercise makes no use of the data on subjective well-being and is thus
independent of the particular way in which we map subjective well-being in the data to utility in the model.

Free mobility
Now suppose we want to see what happens under free mobility. This requires reshu- ing the population such
that utility equalizes across all locations. In that case, rather than simulating the model forward using the
values a (r) =u (c) from the original inversion, we simulate the model using the values e1:8~u(c) a (r) =u (c), where
e1:8~u(c) a (r) =u (c) is nothing else than a (r). Hence, this amounts to substituting a (r) =u (c) by a (r), which is the
same as imposing utility equalization across space.

Partial mobility
Of course, we might also be interested in intermediate cases, where mobility restrictions are relaxed but not
completely eliminated. More generally, and by analogy with the previous argument, we can compute an equilibrium
               u
               ~(c)
using e               a (r) =u (c), where   2 [0; 1:8]. The two cases above correspond to the two extremes. If               = 0, then
    0~
     u(c)
e           a (r) =u (c) is equal to the values a (r) =u (c) of the original inversion, so we are in the case of keeping migration
restrictions unchanged. If             = 1:8, we are in the case of free mobility. If         is strictly in between 0 and 1:8, we have
partial liberalization of mobility restrictions. The closer                    is to 1.8, the greater is the liberalization of migration
restrictions. Note that all these exercises keep the ranking of migration restrictions (as re‡ected by the relative
utility levels in the observed subjective well-being data) unchanged. In principle, we could also consider negative
values of , implying a strengthening of migration restrictions around the world, or values of                      > 1:8, which would
amount to migration incentives rather than restrictions.


4.7          Description of Computational Algorithm
With the values of the structural parameters, trade costs, land, amenities and initial productivity in hand, we can
simulate the model from period 1 onward. The following algorithm is used to calculate the equilibrium population
                                                                                        0                                          0
distribution in period t. Guess some initial population distribution Lt ( ) and a world utility level uW
                                                                                                       t . Plug Lt ( )
into the right-hand side of equation (21), calculate the left-hand side, and solve for the distribution of population;
                 1                                                   1              0
call this Lt ( ). Then compute the distance between Lt ( ) and Lt ( ), de…ned as
                                                               Z h                     i2
                                                                      1           0
                                                    dist1t =         Lt (r)      Lt (r) dr:
                                                               S

                                                                                                       1
If dist1t < " where " is an exogenously given tolerance level, stop. Otherwise, plug Lt ( ) into the right-hand side of
                                                                2
(21), obtain the updated population distribution Lt (r), and compute dist2t , de…ned analogously to dist1t . Continue
the procedure until distit < " for some i.



                                                                          22
    The following lemma shows that this algorithm converges to the equilibrium population distribution whenever
the equilibrium exists, and is unique.

Lemma 7 If = +          1=        +1       (the su¢ cient condition for the existence and uniqueness of the equilibrium
in Lemma 3), the algorithm described above converges to the equilibrium distribution of population. That is,

                                                                      i
                                                     Lt (r) = lim Lt (r) :
                                                                i!1


Proof. See again Theorem 2.19 in Zabreyko et al. (1975).
    In an outer loop we then …nd the world utility level uW
                                                          t that solves the world labor market clearing
                                                     Z
                                                         H (r) Lt (r) dr = L:
                                                     S

Finally, technology can be updated using (19). Hence, the population distribution can be calculated for an arbitrary
number of successive periods t = 1; 2; : : : ; T .


5     The Geographic Evolution of the World Economy
The aim of this section is three-fold. First, we want to enhance our understanding of the relation between space
and growth. Our model has predictions for the future evolution of the spatial distribution of population and
productivity, as well as for the economy’s aggregate growth rate. As we will show, these predictions will depend
crucially on how easily people can move across countries. Second, we want to understand the welfare impact of
relaxing migration restrictions and how doing so changes the distribution of economic activity in the balanced
growth path. Finally, we want to analyze the impact of location-speci…c shocks, with a particular focus on the rise
in sea levels due to global warming.


5.1    Benchmark Calibration
As explained in Section 4.4, we use cell-level data on land, population, wages and trade costs to recover amenities
and productivity. Whenever time-variant, the data are mostly for 2000 (see Appendix C for more details). All
outcomes are plotted in natural logarithms. Figure 1 presents the results from the inversion exercise using actual
migration frictions to calculate the fundamental productivities and amenities. By ‘fundamental’ we refer to the
part of productivity and amenities that does not depend on population density. That is, it does not take into
account the positive agglomeration economies that bene…t productivity and the negative congestion e¤ects that
hurt amenities.
    Fundamental productivity exhibits the expected patterns (see Figure 1a). Productivity is generally high in
North America, Europe and Japan. When we look within countries, the main cities tend to display particularly
high levels of productivity. Mexico, for example, exhibits relatively low productivities, except for Mexico City and
Monterrey. In China, Beijing and Shanghai have clearly higher fundamental productivities than the rest of the
country. This may re‡ect rules and regulations, as well as local educational institutions that lead to higher skilled
populations. It is also well known that cities often tend to attract more productive workers. In that sense it should
not come as a surprise that urban areas stand out as places with high fundamental productivities. Clearly, since



                                                                23
      we are abstracting from local capital investments, fundamental productivities also re‡ect the local stock of capital,
      which tends to be larger in cities and, more broadly, in developed economies.
         As for fundamental amenities (see Figure 1b), the highest values can be found in South America, and in
      particular Brazil. North America also enjoys high fundamental amenities, particularly in urban areas. In Europe,
      Scandinavia and parts of France exhibit high amenities, while Portugal and Southern Europe fare worse. Thailand
      and Southeastern Australia are also desirable places to live, while some of the lowest amenities are found in
      Africa and Siberia. To validate our identi…cation strategy for amenities, it is worthwhile to correlate our estimates
      of amenities with commonly used exogenous measures of quality of life. We therefore collect data on di¤erent
      measures of geography (distance to oceans, distance to water, elevation and vegetation) and climate (precipitation
      and temperature). The correlations between our estimates of amenities and these measures are consistent with
      the literature. For example, we …nd that people like living close to water, prefer higher average temperatures, and
      precipitation (Morris and Ortalo-Magné, 2007; Albouy et al., 2014). Qualitatively the results do not depend on
      whether we look at all cells of the world, at only cells in the U.S., or at randomly drawn cells across countries.
      This suggests that our methodology of using data on subjective well-being to identify amenities performs well. To
      reinforce this point further, placebo correlations based on alternative identi…cation strategies of amenities yield
      correlations that are no longer the same across countries and within countries. Appendix A.2 presents these
      correlations and provides further details.

                                          Figure 1: Benchmark Calibration: Results from the Inversion

                                                                                   50
                                                                                                                                                 20
20                                                                                            20


                                                                                   40
40                                                                                            40                                                 18




60                                                                                 30         60
                                                                                                                                                 16



80                                                                                            80

                                                                                   20                                                            14


100                                                                                           100


                                                                                   10                                                            12
120                                                                                           120




140                                                                                           140                                                10
                                                                                   0



160                                                                                           160
                                                                                                                                                 8
                                                                                   -10


180                                                                                           180
           50      100         150        200           250    300           350                    50   100    150    200   250    300    350


                a. Fundamental Productivities:                       0 (r)                               b. Fundamental Amenities: a (r)

         Figure 2 (di¤erent panels) maps population, productivity, amenities, and real income per capita. In the case of
      amenities, the map now presents the overall level of amenities, a (r) Lt (r)                        , which depends on population and so
      takes into account congestion. That is, it takes into account the negative e¤ect that high density imposes on the
      amenities experienced by residents. We also present average productivity in each cell, which, following the theory,
                                                1
      is de…ned as       t   (r) Lt (r)             . This productivity includes the positive local agglomeration e¤ect with elasticity ,
      and takes into account that each location draws productivities from a Fréchet distribution. In contrast to Figure
      1, these are equilibrium outcomes in the …rst period of the model.
         A …rst observation is that the correlation between population density and productivity across countries is


                                                                                         24
                                          Figure 2: Equilibrium in Benchmark Calibration (Period 1)
                                                                      20
                                                                                                                                                8


 20                                                                              20
                                                                                                                                                7

                                                                      15

 40                                                                              40                                                             6



                                                                                                                                                5
 60                                                                   10         60


                                                                                                                                                4
 80                                                                              80

                                                                      5                                                                         3

100                                                                              100

                                                                                                                                                2


120                                                                   0          120
                                                                                                                                                1


140                                                                              140
                                                                                                                                                0

                                                                      -5

160                                                                              160                                                            -1



                                                                                                                                                -2
180                                                                   -10        180
            50         100        150    200     250      300   350                    50   100       150    200        250     300       350

                                                                                                                                      1
                               a. Population Density                                        b. Productivity:       t   (r) Lt (r)
                                                                                                                                                3
                                                                      16


20                                                                               20
                                                                      15                                                                        2



40                                                                    14         40
                                                                                                                                                1


                                                                      13
60                                                                               60
                                                                                                                                                0

                                                                      12
80                                                                               80
                                                                                                                                                -1

                                                                      11
100                                                                              100
                                                                                                                                                -2
                                                                      10

120                                                                              120
                                                                                                                                                -3
                                                                      9


140                                                                              140
                                                                      8                                                                         -4


160                                                                              160
                                                                      7
                                                                                                                                                -5


180                                                                   6          180
            50        100         150    200     250      300   350                    50   100       150    200        250     300       350



                             c. Amenities: a (r) Lt (r)                                           d. Real Income per Capita


      not that strong: there are some densely populated countries with high productivity levels, such as many of the
      European countries, but there are also some densely populated countries with low productivity levels, such as some
      of those located in sub-Saharan Africa. Countries that are densely populated in spite of having low productivity
      must either have low levels of utility (e.g., sub-Saharan Africa) or high levels of amenities (e.g., Latin America).23
      A second observation is that the same relation between population density and productivity is much stronger across
      locations within countries, where the high-productivity areas typically tend to be the metropolitan areas. This is
      not surprising: since there are no utility di¤erences across locations within countries, the negative congestion e¤ects
      from living in densely populated areas have to be compensated by either higher productivity or better amenities.
      A third observation suggests that both reasons play a role. Metropolitan areas have higher productivity but lower
      real income per capita, compared to less dense neighboring locations. The lower real income of metropolitan
       2 3 See   also the map of the subjective welfare measures in Appendix A.3.



                                                                            25
areas suggests that they must enjoy higher amenity levels (in spite of the negative e¤ect of density on amenities)
as we highlighted above. A fourth observation is that locations close to metropolitan areas tend to have lower
productivity relative not only to metropolitan areas but also to the rest of the country. Since those locations have
cheaper access to goods but are often not more densely populated compared to the rest of the country, they must
either have lower productivity or worse amenities.
    Now consider the evolution of this economy over time, when we keep utility di¤erences across countries un-
changed. We interpret this exercise as being equivalent to keeping migratory policy across countries unchanged. As
we explained before, for this exercise we do not use the data on subjective well-being.24 Figure 3 (di¤erent panels)
maps the predicted distributions of population, productivity, amenities and real income per capita in period 600,
at which point the economy has converged to its balanced growth path. Videos that show the evolution of these
variables over time and over space are available in an Online Appendix.25 To visualize the changes over time, we
should compare Figure 3, which represents the year 2600, with Figure 2, which represents the year 2000.
    Clearly, over time the correlation between population and productivity across countries becomes much stronger.
As predicted by the theory, in the long run, high-density locations correspond to high-productivity locations, while
in today’s world this relation is still largely absent. This can easily be seen when comparing the maps for period
1 and period 600. While in period 1 the population and the productivity maps look quite di¤erent, by period 600
they look very similar. As shown by the dashed-blue curve in the middle panel of Figure 4, which presents the
correlation of population density and productivity over time, the correlation increases from around 0.3 in period 0
to 1.0 by period 600. Note, however, that the correlation between population density and real GDP, which is driven
not only by productivity but also by local prices, and therefore transport costs and geography, also grows but is
never higher than 0.8. The dashed-blue curve in the left panel of Figure 4 shows this. Another remark is that the
high-productivity, high-density locations 600 years from now correspond to today’s low-productivity, high-density
locations, mostly countries located in sub-Saharan Africa, South Asia and East Asia. In comparison, most of
today’s high-productivity, high-density locations in North America, Europe, Japan and Australia fall behind in
terms of both productivity and population.
    This productivity reversal can be understood in the following way. The high population density in some of
today’s poor countries implies high future rates of innovation in those countries. To keep their relative utility
levels from increasing, population in those countries must increase, leading to greater congestion costs and worse
amenities. As a result, today’s high-density, low-productivity countries end up becoming high-density, high-
productivity, high-congestion and low-amenity countries, whereas today’s high-density, high-productivity countries
end up becoming low-density, low-productivity, low-congestion and high-amenity countries. As can be seen in
Figure 4, given that the correlation between population density, productivity and real income per capita becomes
very high, it must be that low-density, high-utility countries have high amenities.
    These dynamics imply a reallocation of population from high-utility to low-utility countries. In principle this
could be driven by decreased migration from low- to high-utility countries or by increased migration from high-
to low-utility countries. It is easier to think about the former if we want to interpret this exercise as one where
  2 4 As explained brie‡y in the theory section, the logic behind this argument is that the migration quota determines the number of

migrants who are allowed to cross the border. Suppose the utility in the receiving country goes up, then the quota is relaxed, so that
more people will enter, thereby lowering utility in the host country until the relative utility is unchanged. Now suppose the utility in
the sending country goes up, then the host country can make the quota more stringent, so that fewer people will enter, once again
leaving the relative utility unchanged. That is, we assume, admittedly without modeling the corresponding political economy process,
that countries impose migration quotas according to relative welfare levels.
  2 5 All videos can be viewed at https://www.princeton.edu/~erossi/videos.html.




                                                                  26
                           Figure 3: Equilibrium Keeping Migratory Restrictions Unchanged (Period 600)
                                                                 20
                                                                                                                                           24



 20                                                                         20
                                                                                                                                           22
                                                                 15

 40                                                                         40
                                                                                                                                           20


 60                                                              10         60

                                                                                                                                           18


 80                                                                         80

                                                                 5                                                                         16

100                                                                         100


                                                                                                                                           14

120                                                              0          120


                                                                                                                                           12
140                                                                         140

                                                                 -5
                                                                                                                                           10
160                                                                         160



                                                                                                                                           8
180                                                              -10        180
           50     100        150    200     250      300   350                    50   100       150    200        250     300       350

                                                                                                                                 1
                          a. Population Density                                        b. Productivity:       t   (r) Lt (r)

                                                                                                                                           19


20                                                               20         20

                                                                                                                                           18

40                                                                          40
                                                                 18

                                                                                                                                           17
60                                                                          60

                                                                 16
                                                                                                                                           16
80                                                                          80



                                                                 14
100                                                                         100
                                                                                                                                           15



120                                                                         120
                                                                 12
                                                                                                                                           14


140                                                                         140

                                                                 10                                                                        13

160                                                                         160


                                                                 8                                                                         12
180                                                                         180
           50     100        150    200     250      300   350                    50   100       150    200        250     300       350



                        c. Amenities: a (r) Lt (r)                                           d. Real Income per Capita


      we keep existing migratory policy unchanged. As increased innovation pushes up relative utility in low-utility
      countries, fewer people want to migrate, but a greater share of those who want to migrate are kept out, so that
      utility di¤erences do not go down. Over time, this reallocation of population peters out. As predicted by Lemma
      4, decreasing returns to innovation, together with congestion costs, imply that, in the long run, the distribution of
      population reaches a steady state in which all locations innovate at the same constant rate.
         Most of our discussion so far has focused on the changing di¤erences across countries, but there are also
      interesting di¤erences within countries. When focusing on the population distribution within countries, we observe
      that as the population share of North America and Europe declines, the locations that better withstand this decline
      are the coastal areas, which bene…t from lower transport costs and thus higher real income. In the countries whose
      population shares are increasing, such as China, India and parts of sub-Saharan Africa, there is less evidence of
      coastal areas gaining.


                                                                       27
                   Figure 4: Correlations with Di¤erent Migration Restrictions and Coastal Flooding Scenarios

   Corr (log real GDP per capita, log population density)    Corr (log productivity, log population density)   Corr (log productivity, log real GDP per capita)
       1                                                     1                                                 0.8


      0.8                                                   0.9                                                0.7

                                                                                                               0.6
      0.6                                                   0.8

                                                                                                               0.5
      0.4                                                   0.7
                                                                                                               0.4
      0.2                                                   0.6
                                                                                  =0
                                                                                                               0.3
                                                                                   = 0, Flooding
        0                                                   0.5                    = 0.9                      0.2
                                                                                   = 0.9, Flooding
      -0.2                                                  0.4                    = 1.8                      0.1
                                                                                   = 1.8, Flooding
      -0.4                                                                                                      0
             0         200          400         600               0        200           400           600           0        200           400          600
                             Time                                                 Time                                              Time



    Figure 5 presents the average growth rates and levels of productivity, real output and welfare for di¤erent
scenarios.26 The benchmark calibration, which leaves mobility restrictions unchanged, corresponds to                                                      = 0.
Consistent with the argument above, Figure 5 shows that the average growth rates of productivity, real GDP per
capita and utility converge to constants. Note that the long-run growth rate in real GDP per capita is higher than
the initial growth rate in real GDP per capita, whereas the opposite is true for the growth rate in utility. Recall
that the growth rate in utility is equal to the growth rate in real GDP per capita minus                                         times the growth rate
of population. What happens is that initially the correlation between the growth in real GDP per capita and the
growth in population is negative — many of the high-growth places in richer countries are losing population —
so that the growth rate in utility is greater than the growth rate in GDP per capita. In the long run, when the
steady state is reached, there is no more reallocation of population across space, so that real GDP per capita and
utility grow at the same rates.


5.2          Evaluating Mobility Restrictions
We now analyze the e¤ect of completely or partially relaxing existing migration restrictions. We start with the
free mobility scenario and then present some calculations for scenarios with partial mobility where                                           is in between
0 (current restrictions) and 1:8 (free mobility).

5.2.1            Free migration

In this exercise we start o¤ with the benchmark calibration in period 0, and then reallocate population such that
utility equalizes across countries from period 1 onward. With free migration, people move from low-utility countries
to high-utility countries. This reduces utility di¤erences across countries because of greater land congestion and
lower amenities in high-utility countries (and the opposite in low-utility countries). With enough migration, utility
 2 6 World
                                                       R                               1
            average productivity at time t is de…ned as S H (r) Lt (r) =L t (r) Lt (r)   dr, i.e., the population-weighted average of
                                                                                         R
locations’mean productivity levels. World average real GDP at t is de…ned analogously as S H (r) Lt (r) =L yt (r) dr: The growth of
utility is measured as the growth in uWt :



                                                                                 28
           Figure 5: Growth Rates and Levels with Di¤erent Migration Restrictions and Coastal Flooding Scenarios

                 Growth rate of productivity                          Growth rate of real GDP                             Growth rate of utility
1.06                                                      1.05                                          1.055

1.05                                                     1.045                                           1.05

1.04
                                                          1.04                                          1.045
1.03
                                                         1.035                                           1.04
1.02                           =0
                                = 0, Flooding            1.03                                          1.035
1.01
                                = 0.9
                                                         1.025                                           1.03
  1                             = 0.9, Flooding
                                = 1.8
0.99                                                      1.02                                          1.025
                                = 1.8, Flooding
0.98                                                                                                     1.02
       0             200           400             600           0       200          400         600           0          200            400            600
                           Time                                                Time                                               Time



             Log world average productivity                          Log world average real GDP                     Log world utility (not normalized)
 35                                                        25                                             40

                                                                                                          35
 30                                                        20
                                                                                                          30

 25                                                        15                                             25

                                                                                                          20
 20                                                        10                                             15

                                                                                                          10
 15                                                         5
                                                                                                           5

 10                                                         0                                              0
       0             200           400             600           0       200          400         600           0          200            400            600
                           Time                                                Time                                               Time




 equalizes across all countries. This reallocation of population across countries does not only have a static e¤ect; it
 also has a dynamic e¤ect by putting the economy on a di¤erent dynamic path.
           Figure 6 and Figure 7 map the distributions of population, productivity, amenities and real income per capita
 for period 1 and period 600, under the assumption that people are freely mobile across countries.27 Compared
 to the exercise where we kept migratory restrictions unchanged, several observations stand out. First, migration
 increases the initial correlation between population density and productivity across countries, so that we see fewer
 countries where high density and low productivity coexist. In the middle panel of Figure 4 we see that in the case
 of complete liberalization ( = 1:8) the initial correlation between density and productivity increases from around
 0.3 to nearly 0.7. Second, this initial e¤ect has important dynamic consequences. Because today’s poor countries
 lose population through migration, they innovate less. As a result, and in contrast to the previous exercise, no
 productivity reversal occurs between the U.S., India, China and sub-Saharan Africa. Third, this absence of a
 large-scale productivity reversal does not mean that relative productivities across countries remain unchanged.
 Some countries, such as Venezuela, Brazil and Mexico, start o¤ with relatively high utility levels but relatively low
 productivity levels. This means they must have high amenities. Because of migration, they end up becoming the
       2 7 For   videos that show the gradual evolution over time and over space, see the Online Appendix.


                                                                                29
      world’s densest and most productive countries. Fourth, migration changes the determination of the development
      path of the world and thereby increases the growth rate in the balanced growth path, as is clear from Figure 5.
      Fifth, within countries, there is stronger evidence of an increasing concentration of the population in coastal areas,
      compared to the benchmark case. The greater concentration of population within countries, which was already
      apparent in the benchmark case, is now reinforced by greater migration across countries. Sixth, the importance of
      coastal areas becomes even more apparent when we look at real income per capita. The fact that locations close
      to coastal areas have lower real income per capita but high population suggest that those locations have higher
      amenities than the coastal areas themselves.

                                         Figure 6: Equilibrium with Free Migration (Period 1)
                                                                 20
                                                                                                                                                    8


 20                                                                         20
                                                                                                                                                    7
                                                                 15

 40                                                                         40                                                                      6



                                                                                                                                                    5
 60                                                              10         60


                                                                                                                                                    4
 80                                                                         80

                                                                 5                                                                                  3

100                                                                         100

                                                                                                                                                    2

120                                                              0          120
                                                                                                                                                    1


140                                                                         140
                                                                                                                                                    0

                                                                 -5

160                                                                         160                                                                     -1



                                                                                                                                                    -2
180                                                              -10        180
           50       100    150     200      250    300     350                    50      100    150    200        250          300       350

                                                                                                                                                1
                  a. Population Density for       = 1:8                           b. Productivity for     = 1:8:         t   (r) Lt (r)
                                                                 16                                                                                 4



20                                                                          20
                                                                 15                                                                                 3



40                                                                          40
                                                                 14                                                                                 2


60                                                                          60

                                                                 13                                                                                 1


80                                                                          80

                                                                 12                                                                                 0

100                                                                         100


                                                                 11                                                                                 -1

120                                                                         120


                                                                 10                                                                                 -2
140                                                                         140



                                                                 9                                                                                  -3
160                                                                         160



                                                                 8                                                                                  -4
180                                                                         180
           50      100    150      200      250    300     350                    50      100    150    200        250          300       350



                c. Amenities for     = 1:8: a (r) Lt (r)                               d. Real Income per Capita for              = 1:8


         When analyzing the average growth in real income per capita and utility, two di¤erences become immediately
      apparent in Figure 5 when comparing the case of free migration ( = 1:8) to the case of no liberalization ( = 0).
      First, mobility increases the long-run growth rate of the economy as well as the average level of welfare, output


                                                                       30
                                             Figure 7: Equilibrium with Free Migration (Period 600)
                                                                     20


                                                                                                                                                        30
 20                                                                             20

                                                                     15                                                                                 28

 40                                                                             40

                                                                                                                                                        26

 60                                                                  10         60
                                                                                                                                                        24


 80                                                                             80
                                                                                                                                                        22
                                                                     5

100                                                                             100
                                                                                                                                                        20



120                                                                  0          120
                                                                                                                                                        18



140                                                                             140                                                                     16

                                                                     -5

160                                                                             160                                                                     14



                                                                                                                                                        12
180                                                                  -10        180
              50       100    150      200       250    300    350                    50      100    150    200        250          300       350

                                                                                                                                                    1
                     a. Population Density for         = 1:8                          b. Productivity for     = 1:8:         t   (r) Lt (r)

                                                                     19



20                                                                              20
                                                                                                                                                        24
                                                                     18


40                                                                              40
                                                                                                                                                        23
                                                                     17


60                                                                              60
                                                                                                                                                        22
                                                                     16

80                                                                              80

                                                                                                                                                        21
                                                                     15

100                                                                             100

                                                                                                                                                        20
                                                                     14
120                                                                             120


                                                                                                                                                        19
                                                                     13
140                                                                             140


                                                                                                                                                        18
                                                                     12
160                                                                             160



                                                                                                                                                        17
180                                                                  11         180
           50         100    150       200       250    300    350                    50      100    150    200        250          300       350



                   c. Amenities for      = 1:8: a (r) Lt (r)                               d. Real Income per Capita for              = 1:8


      and productivity in the world. Second, it is no longer the case that the growth rate in utility is lower in the long
      run than in the short run. Recall that in the case of no free migration the drop in the utility growth rate happened
      because initially the areas with high real GDP per capita growth were losing population. With free migration this
      is no longer the case.

      5.2.2        Partial liberalization

      We now present the changes in discounted real income and utility, as well as migration ‡ows, that result from a
      variety of scenarios where we partially relax migration frictions. Figures 4 and 5 in the previous section already
      presented correlations as well as growth rates and levels of the di¤erent variables for the partial liberalization
      scenario, where we set          = 0:9: As can be seen in Table 2, although this value of        is right in the middle between
      keeping existing migration restrictions unchanged and free migration, it leads to reallocations of population that


                                                                           31
are closer to the free migration case. When we liberalize migration fully, 78.2% of the population changes country;
the corresponding number when              = 0:9 is a not much lower 65.0%. As expected, the share of population that
moves increases monotonically with the degree of liberalization.
    In terms of welfare, migration frictions are tremendously important, particularly when we move closer to free
migration.28 As shown in Table 2, a liberalization that implies that a quarter of the world population moves at
impact ( = 0:3) yields a relatively modest increase in real output of 3.5%, but a substantially larger increase in
welfare of 71%. A liberalization that leads to three quarters of the world population migrating at impact gives
welfare gains of 298% and an increase in real income of 56.2%. Full liberalization leads to welfare gains of 312%,
with only a relatively small increase in migration at impact of 4:3 percentage points.29
    Three comments are in order when analyzing the numbers in Table 2. First, in general the gains in utility are
much larger than the gains in real income, especially when migration becomes freer. Relaxing migration restrictions
tends to relocate people to high-amenity countries. In the case of free migration this reallocation accounts for nearly
80% of the total welfare e¤ect. Second, the mobility numbers presented in Table 2 include agents who move across
countries at impact in period 1 only. Of course, as a result of migratory liberalization, the entire development
path of the world economy changes dramatically as shown in Figures 4 to 7. Third, real income numbers have
been normalized in period 1, so that they do not include the on-impact e¤ects. As for welfare, Table 2 reports the
present value of the population-weighted average utility levels after normalizing for the direct level e¤ect of the
change in migration restrictions.30 This normalization implies that we disregard the direct welfare e¤ects from the
change in policy and take into account only the e¤ects that result from the change in the equilibrium allocation
that results from it. Otherwise, the gains from mobility would be even larger, as can be seen in the lower-right
panel of Figure 5 where we present level e¤ects without this normalization.31

                                           Table 2: The Impact of Mobility Frictions

            Mobility    Discounted Real Income*           Welfare**               Migration Flows***
                                % w.r.t. = 0               % w.r.t. = 0
              0.0a      36.51          0%           2.64         0%                     0.74%
              0.3       37.80         3.5%          4.51         71%                    24.5%
              0.5       41.59        13.9%          6.11        131%                    42.0%
              0.9       51.03        39.8%          9.09        244%                    65.0%
              1.3       57.02        56.2%         10.52        298%                    73.9%
              1.8b      61.56        68.6%         10.89        312%                    78.2%
                            a: Observed Restrictions. b: Free Mobility. *: Normalized by
             world average for t = 1. **: Population-weighted average of cells’discounted utility levels.
                   ***: Share of world population moving to countries that grow between period 0
                                     and 1 (immediately after the change in ).


   2 8 These calculations assume that the economy is on its balanced growth path after period 600. Note in Figure 5 that in all cases the

balanced growth path growth rate remains strictly below the discount factor and so the discounted present value of income and utility
is well de…ned.
   2 9 To the best of our knowledge, this is the …rst paper to analyze the global gains from mobility in an endogenous growth model with

spatial heterogeneity, costly trade and amenities. Previous work, that focuses on models with capital accumulation, estimates long-run
gains in income per capita of around 100% (Klein and Ventura, 2007; Kennan, 2013). Though not directly comparable to the present
discounted numbers reported in Table 2, we …nd larger e¤ects. The main reason is that in our model mobility generates both a level
and a long-run growth e¤ect, whereas in these other models there is only a level e¤ect as the economy moves to its new steady state.
   3 0 Namely, we calculate the population-weighted average of uW e(1:8      )~
                                                                              u(c) :
                                                                   t
   3 1 In that …gure we just present uW :
                                      t




                                                                   32
5.3    Evaluating the Rise in Sea Levels
The rise in the sea level is one of the major issues when assessing the e¤ects of global warming. The thermal
expansion of the oceans, the melting of many of the world’s glaciers and the progressive depletion of the ice sheets
in Greenland and Antarctica are major contributors to this rise. According to the International Panel on Climate
Change (IPCC), sea levels are likely to rise by 0.5 to 1 meter by 2100 (Church et al., 2013). Over the longer
horizon of a millennium, the expected loss of much of Greenland’s ice sheet as a result of temperatures that are
at least 2 to 4 C higher would increase the sea level by 7 meters. The disproportionate location of the world’s
population in coastal areas bodes ill for many of its megacities, such as Mumbai, New York, Miami, Guangzhou
and Osaka (Nicholls et al., 2008). More than 50% of the U.S. population lives in locations prone to ‡ooding, and
every year, 1.2 million additional people are moving to those areas (Moser et al., 2014).
   When evaluating the impact of the rise in sea levels, some papers focus on a simple accounting exercise based
on current data. For example, Dasgupta et al. (2007) use detailed GIS data on current population and GDP to
compute the impact of a rise in the sea level of between 1 and 5 meters. Although this gives some idea of what is
at stake, these statements are unsatisfactory and simplistic for at least two reasons. First, much of the increase in
the sea levels will happen in the future, rather than today, and there is no reason why the share of the population
living in low-lying coastal areas, or the share of world GDP produced in those locations, will remain unchanged
100 or 500 years from now. Second, people can move in the face of rising sea levels. As this will lead to a di¤erent
distribution of population across space, it will also lead to a di¤erent dynamic path for the economy.
   Some papers partially address these issues by taking into account changing socio-economic conditions (see, e.g.,
Nicholls, 2004, Hinkel and Klein, 2009, and Antho¤ et al., 2010). These papers typically rely on di¤erent socio-
economic scenarios developed by the IPCC in its Special Report on Emissions Scenarios (SRES). As an example,
one scenario assumes rapid convergence in GDP per capita and in fertility across the di¤erent regions of the globe.
However, since these scenarios only make predictions for large regions, going to the level of countries, let alone
to the level of cells, is not easy. In most cases it is simply assumed that all cells in a given country experience
identical growth patterns (Arnell et al., 2004). This is unfortunate, since future changes within countries are likely
to be key when assessing the damage of coastal ‡ooding. In addition, these models are unable to address how the
economy will adjust when parts of it get ‡ooded.
   Our model is well equipped to address these issues. By proposing a general equilibrium spatial growth model
that incorporates trade, migration and innovation, our framework endogenously generates how the spatial distrib-
ution of population, GDP and amenities changes over time, both within and across countries. Our results suggest
that, depending on the assumption we make about migration, the negative impact of ‡ooding on the economy
can change dramatically. For example, if the sea level were to rise by 6 meters in 2100 and we kept migratory
restrictions unchanged, 15% of the world’s population would get ‡ooded. This …gure would increase to 54% under
free mobility. In spite of making matters worse in terms of how many people end up under water, we would
expect greater mobility to have an advantage in the aftermath of ‡ooding, as it should facilitate relocating people.
However, in a decentralized economy, there is no guarantee that people will coordinate on moving to the “right”
locations, so that more mobility need not improve the welfare impact of relocation.
   In what follows we …rst analyze the static cost of rising sea levels, depending on when the rise will occur. We
then look at the dynamic e¤ects of a rise in sea levels, with a particular focus on the welfare e¤ects. In all of the
exercises we assume an increase in sea levels by 6 meters, but we will also brie‡y compare our …ndings to a less
dramatic 1 meter rise in sea levels. The information on what areas would get ‡ooded comes from maps generated


                                                         33
by the Center for Remote Censoring of Ice Sheets (Cresis). To give a preliminary idea of the impact of ‡ooding,
Figure 8 shows today’s population in areas that would be ‡ooded if sea levels rose by 6 meters, and Figure 9
provides close-ups for di¤erent regions.

                   Figure 8: Population Flooded with Sea Level Rise of 6 Meters (Data of 2000)




Legend
    No Population Flooded
    0- 50.000
    50.000 - 500.000
    500.000 - 1.000.000
    1.000.000 - 3.000.000
    3.000.000 - 25.000.000




5.3.1    Timing of the rise in sea levels

In this section we analyze the static cost of a rise in the sea level, depending on when that rise occurs and depending
on which assumptions we make on mobility. Our starting point is the exercises of the previous subsection, where
we analyzed the evolution of the spatial distribution of population and aggregate growth under di¤erent mobility
assumptions. We then shock the world with a rise in the sea level by 6 meters and analyze how much of the
population, how much of the amenities and how much of the productivity gets lost upon impact. Since the spatial
distribution of population and production di¤ers across time and depends on the mobility assumptions, the answer
to that question will depend on when the sea level rises and on how mobile the population is.
   Table 3 (Panel A) reports the results for a world in which mobility restrictions are kept unchanged. Hence, we
start o¤ with the exercise in subsection 5.1, and we let the sea level rise by 6 meters in either period 1, period 100 or
period 500. Upon impact, without giving the economy a chance to react, we compute the percentage of population
‡ooded, the percentage of land rents lost, the percentage of technology lost and the percentage of amenities lost.
This gives us a sense of the economic magnitude of the shock, depending on when it happens. Before discussing the
                                                                                                          1=
results, it is important to de…ne some terms. As before, technology is de…ned as         t   (r) Lt (r)        and amenities
are de…ned as a (r) Lt (r)   . When discussing the percentage of technology lost, we weight technology either by


                                                           34
                 Figure 9: Population Flooded with Sea Level Rise of 6 Meters (Di¤erent Regions, Data of 2000)




                                 a. Asia                                              b. Europe




Legend
    No Population Flooded
    0- 50.000
    50.000 - 500.000
    500.000 - 1.000.000
    1.000.000 - 3.000.000
    3.000.000 - 25.000.000




                             c. North America                                          d. Africa


land or by population. We do the same for amenities.
     A number of …ndings stand out. First, the percentage of population ‡ooded is greater than the percentage of
land ‡ooded. Whereas 1% of land gets ‡ooded, 6.6% of population gets ‡ooded if the sea level rises in 2000. Second,
over time this di¤erence …rst increases, and then decreases. If the rise in the sea levels were to occur in 2100, 7.5%
of the population would be under water. By 2500, this percentage decreases to 5.7%. Third, the percentage of
technology lost is also greater than the share of land ‡ooded, even when technology is weighted by land, rather
than by population. This re‡ects the fact that coastal areas are more productive than non-coastal areas. Of course,
when we weight technology by population, this di¤erence is reinforced, given the disproportionate share of people
living on the coast. Fourth, the percentage of amenities lost is initially larger than the percentage of land lost,
but this gets reversed over time. This re‡ects partly the increase in population in coastal areas, which pushes


                                                              35
                              Table 3: The E¤ect of a Rise in Sea Levels by 6 Meters

                                                              Period 1          Period 100    Period 500
             A. Keeping mobility restrictions unchanged ( = 0)
             Percentage land ‡ooded                              1.0                1.0           1.0
             Percentage population ‡ooded                        6.6                7.5           5.7
             Percentage land rents lost                         6.3                8.0            6.2
             Percentage technology lost (land weighted)         2.4                2.5            2.6
             Percentage technology lost (population weighted)    9.5               10.5           5.7
             Percentage amenities lost (land weighted)           2.2               1.6            0.8
             Percentage amenities lost (population weighted)     8.8               9.6            9.6
             B. Free mobility ( = 1:8)
             Percentage land ‡ooded                              1.0                1.0          1.0
             Percentage population ‡ooded                       11.2               14.9          81.4
             Percentage land rents lost                         8.4                13.7          89.1
             Percentage technology lost (land weighted)         2.4                 3.0          6.0
             Percentage technology lost (population weighted)   11.6               19.4          97.4
             Percentage amenities lost (land weighted)           1.2               0.9            0.5
             Percentage amenities lost (population weighted)    11.9               18.0          80.9
             C. Partial mobility ( = 0:9)
             Percentage land ‡ooded                              1.0                1.0           1.0
             Percentage population ‡ooded                        9.1               12.4          33.8
             Percentage land rents lost                         7.2                10.0          41.6
             Percentage technology lost (land weighted)         2.4                 2.8          4.6
             Percentage technology lost (population weighted)   10.0               15.3          65.5
             Percentage amenities lost (land weighted)           1.8               1.4            0.8
             Percentage amenities lost (population weighted)    10.7               15.2          56.9


down the value of amenities, but there is also another e¤ect: the reallocation of people within countries tends to
move people from low-amenity to high-amenity places. This explains why the relation between the percentage of
amenities lost and the percentage of population ‡ooded may not be monotone.
   Table 3 (Panel B) redoes the exercise for free migration. The most striking …nding, already discussed in the
previous section, is that under free mobility, a signi…cantly greater share of people move to low-lying coastal areas.
Free mobility moves people toward high-density, high-productivity locations, which are disproportionately located
in coastal regions. This move gets reinforced over time, because of the positive e¤ect of density on productivity.
If the rise in sea levels were to happen in 2500, as much as 81.4% of the world population would get ‡ooded. Not
surprisingly, the percentage of technology and amenities lost, when weighted by population, is mostly driven by
the population dynamics. When weighted by land, rather than by population, the percentage of technology lost
increases over time (re‡ecting the positive relation between population and productivity), whereas the percentage
of amenities lost decreases over time (re‡ecting the negative relation between population and amenities). Panel C
in Table 3 focuses on the in-between case of partial liberalization of mobility restrictions. It illustrates that as we
relax migration restrictions, we tend to move monotonically between the two cases described in more detail above.
   Above we described the economic impact of ‡ooding by analyzing the shares of population, land rents, amenities
and technology lost. Another way of looking at the same phenomenon is by comparing the distribution of, say,
land rents under di¤erent scenarios. Figure 10a plots the distribution of the log of land rents (weighted by area)
under di¤erent mobility assumptions for period 1. As can be seen, liberalizing migration restrictions increases the



                                                          36
  dispersion of land rents. As expected, more mobility implies that more desirable locations become more crowded
  and less desired locations less crowded. This pushes up land rents in attractive places, with the opposite happening
  in less attractive places. Figure 10b compares ‡ooded vs. non-‡ooded areas. There the result that stands out is
  that ‡ooded areas tend to have higher land rents than non-‡ooded areas independently of the migration scenario
  we analyze. This is consistent with the share of rents lost to ‡ooding being larger than the share of land lost to
  ‡ooding. Coastal areas are economically valuable due to high amenities and low transport costs and are, obviously,
  the ones that are prone to be ‡ooded.

                                                                       Figure 10: Rent Distributions
0.15                                                                                        0.15
                Current Restrictions, ψ = 0.0                                                            Non-Flooded Areas, ψ = 0.0
                Partial Liberalization, ψ = 0.9                                                          Flooded Areas, ψ = 0.0
0.12            Free Mobility, ψ = 1.8                                                      0.12
                                                                                                         Non-Flooded Areas, ψ = 1.8
                                                                                                         Flooded Areas, ψ = 1.8


0.09                                                                                        0.09




0.06                                                                                        0.06




0.03                                                                                        0.03




0.00                                                                                        0.00
       -25        -20           -15          -10          -5     0         5      10               -25    -20         -15         -10        -5     0      5        10
                                         Rents per Area (Logs)                                                              Rents per Area (Logs)


                         a. Di¤erent Mobility Scenarios                                                     b. Flooded vs. Non-Flooded Areas



  5.3.2           Dynamic e¤ects of the rise in sea levels

  We now turn to analyzing the dynamic e¤ects of coastal ‡ooding by taking into account how the economy reacts
  to a rise in sea levels. In this exercise, the sea level rises by 6 meters between period 0 and period 1. As a result,
  people move to other areas, and the economy gets on a di¤erent dynamic path. To assess the welfare costs of
  ‡ooding, Table 4 reports the present discounted value of real income per capita and of utility for di¤erent values
  of         . The evolution of the correlation between GDP per capita, population density and productivity, as well as
  the paths of growth rates and levels, was already included in Figures 4 and 5. Also recall that                                                   is negatively
  associated with mobility restrictions:                             = 1:8 corresponds to free migration and                 = 0 corresponds to the currently
  observed restrictions as measured by the data on subjective well-being.
             As we know from Table 2, mobility increases real income per capita and utility. When comparing a situation
  where we leave migratory restrictions unchanged ( = 0) to one where we have free migration ( = 1:8), the
  present discounted value of utility, our measure of welfare, is multiplied by more than four. This is true whether
  we assume a world with ‡ooding or a world without ‡ooding. This increase in welfare is much larger than the
  corresponding increase in the present value of income that grows by 69%. Since the only di¤erence between real
  income and utility is the level of amenities, this implies that an important advantage of mobility is that it moves
  people from low-amenity to high-amenity places. So the main results on the gains from migration remain in place
  independently of whether the world experiences ‡ooding.


                                                                                       37
                             Table 4: Dynamic E¤ects of Coastal Flooding (6 Meters)

        Mobility    Discounted Present Value of Real Income*                    Welfare**
                    No Flooding Flooding      Ratio (NF/F)      No Flooding Flooding Ratio (NF/F)
           0.0a        36.51        35.21         1.037                 2.64         2.44   1.082
           0.3         37.80        36.77         1.028                 4.51         4.18   1.079
           0.5         41.59        40.72         1.021                 6.11         5.68   1.075
           0.9         51.03        50.24         1.016                 9.09         8.48   1.072
           1.3         57.02        55.69         1.024                10.52         9.77   1.076
           1.8b        61.56        59.39         1.037                10.89        10.10   1.078
                                   a: Observed Restrictions. b: Free Mobility.
                         *: Normalized by world average GDP without ‡ooding for t = 1.
                        **: Population-weighted average of cells’discounted utility levels.


    We now turn to comparing real income and welfare in a world without ‡ooding to one in a world with ‡ooding.
Several results stand out in Table 4. First, ‡ooding always leads to a loss in both real income and welfare. In the
case of real income, the drop ranges from 1.6% to 3.7% depending on our assumptions on mobility, whereas in the
case of utility the drop ranges from 7.2% to 8.2%. Second, the impact of ‡ooding on the present value of welfare
has only a weak, and non-monotonic, relation with mobility. When mobility restrictions are as in the current
world economy, the losses are 8.2%. These losses decline to 7.2% for intermediate levels of migration restrictions
(   = 0:9), and then increases again, to 7.8%, in a world with free migration. We see a similar U-shaped pattern
for income per capita.
    The …nding that ‡ooding has similar e¤ects, whether we maintain existing frictions or allow for free migration,
may come as a surprise. In principle, one would expect mobility to mitigate the negative welfare e¤ect of ‡ooding.
In fact, in Desmet and Rossi-Hansberg (2014b) we argued that adaptation through mobility can help reduce the
economic cost of global warming. There are three reasons why here we …nd that the benign e¤ect of mobility
is eroded. First, when we analyze the e¤ect of liberalizing migration, we are exclusively talking about changing
mobility across countries, since in all exercises there is always free mobility within countries. Hence, since mobility
within countries should be enough to absorb shocks due to ‡ooding (with the exception of maybe some small
islands in the Paci…c Ocean), we should not expect mobility across countries to make a huge di¤erence through
this direct e¤ect. Second, since greater mobility across countries causes more people to locate in low-lying coastal
areas, the impact of ‡ooding is greater, since it distorts the equilibrium more. That is, although greater mobility
makes moving easier, it also requires more people to move. Third, and maybe most important, di¤erent migration
policies put the economy on di¤erent dynamic paths, so that a priori there is no reason why greater mobility
should mitigate the impact of ‡ooding.
    To clarify this last point, assume that in the face of a 6-meter rise in the sea level that causes the ‡ooding of
1% of the land’s surface, the planner could push everyone some miles more inland to higher ground. Abstracting
from the moving costs, we would not expect a major impact. However, in a decentralized economy people may
move to already established locations far-o¤ rather than simply a little bit more inland. This behavior is optimal
for the individuals but would not be the choice of a central planner as it decreases overall growth and the level of
income. In fact, absent this con‡ict, the paths with and without ‡ooding in Figure 5 should be virtually identical,
and the cost negligible. However, by giving individuals a wider set of options, more mobility makes it easier for
them to move to farther o¤ places, thus exacerbating the di¤erence between what a planner would do and what



                                                          38
individuals actually do. Furthermore, recall that with higher mobility more people concentrate in low-lying coastal
lands, so that more people need to move when sea levels rise. Hence, the scope of the possible discrepancy between
the decentralized economy and the planner’s solution increases. This reasoning implies that, particularly in the
long run, the losses from ‡ooding increase as we reduce migration restrictions.
   Rather than looking at summary statistics, Figure 5 shows the entire dynamic path of productivity, real GDP
and utility, comparing ‡ooding and no ‡ooding under di¤erent mobility restrictions.32 Essentially these …gures
show that ‡ooding causes a negative shock to the growth rates of productivity, real GDP and utility. This e¤ect is
larger in the medium-term and in the case of free migration. The second row of Figure 5 presents the accumulated
level e¤ect of ‡ooding, which is particularly large for the case of free migration. To sharpen the comparison between
no ‡ooding and ‡ooding, Figure 11 shows the relative dynamic paths of real GDP per capita and utility. In a
world where we keep migratory restrictions unchanged, the immediate impact of ‡ooding on real GDP and utility
is negative, but the long-run impact is positive. In contrast, in a world with free mobility, the welfare e¤ect of
‡ooding is always negative, while for output it is negative in the short run and in the long run, with a short interval
after 200 years where it reverses sign. As is evident from the …gure, ‡ooding has a potentially large impact on
real GDP and welfare and interacts dramatically with migration restrictions. This is particularly true in the long
run. The level of migration restrictions determines ultimately the e¤ect of ‡ooding on the steady-state growth rate
and, therefore, its long-run impact. Figure 11 shows that the implications on the present value of real output and
welfare in Table 4 are the result of balancing short-term and long-term changes: migration restrictions increase the
losses from ‡ooding in the short run, but decrease them in the long run, explaining why in present value terms the
di¤erences are small. Furthermore, Figure 11 underscores the argument that relatively small geographic shocks
like ‡ooding can have a large impact on long-term outcomes by changing the development path of the economy.

                                             Figure 11: No Flooding vs Flooding (Levels)

                  Ratio of real GDP (No flooding / flooding)                          Ratio of utility (No flooding / flooding)
      1.5                                                                  1.5
                                                                                                                           =0
      1.4                                                                  1.4
                                                                                                                            = 0.9
      1.3                                                                  1.3                                              = 1.8

      1.2                                                                  1.2

      1.1                                                                  1.1

           1                                                                1

      0.9                                                                  0.9

      0.8                                                                  0.8

      0.7                                                                  0.7
         0        100      200      300       400      500     600            0      100      200      300        400       500      600
                                    Time                                                               Time


   According to the IPCC, sea levels are likely to rise by 0.5 to 1 meter by 2100 (Church et al., 2013). Since
a 6-meter rise in sea levels is an extreme and far-o¤ prospect, we are also interested in understanding how the
e¤ects of a sea level rise scale down as we consider a 1-meter increase. As expected, the e¤ects are smaller, but less
than proportionally so. Whereas a 6-meter rise today is predicted to lead to 1% of land lost, 6.6% of population
 3 2 For   videos that show the evolution over space of the e¤ect of ‡ooding, see the Online Appendix.


                                                                     39
‡ooded and 6.3% of land rents lost, the corresponding …gures for a 1-meter rise are 0.4%, 1.6% and 1.9%. Under
free mobility, the di¤erences between the di¤erent levels of ‡ooding are not as big. A 6-meter rise today would
imply 11.2% of population ‡ooded and 8.4% of land rents lost, whereas the corresponding …gures with a 1-meter
rise are 5.5% and 4.2%.33 As for the dynamic e¤ects of coastal ‡ooding, a 1-meter rise does not change the results
qualitatively. As before, the drop in the present value of welfare varies little with the degree of mobility, and is
around 3.5% to 4%.34 Hence, a six-time smaller rise in sea levels, that ‡oods an area that is only 40 percent its
size, with about a fourth of the population, generates losses that are about half the size.


6     Conclusion
The complex interaction between geography and economic development is at the core of a wide variety of important
economic phenomena. In our analysis we have underscored the fact that the world is interconnected through trade,
technology di¤usion, and migration. We have conducted our analysis at a …ne geographic detail, enabling us
to incorporate the signi…cant heterogeneity across regions in amenities and productivity. This framework and
quanti…cation have allowed us to evaluate the impact of migration frictions and to assess the e¤ect of a potentially
important geographic shock like coasting ‡ooding.
    Our results highlight the complexity of the impact of geographic changes as well as the importance of their
interaction with factor mobility. We found that relaxing migration restrictions can lead to very large welfare gains,
but that the world economy will concentrate in very di¤erent sets of nations depending on migratory frictions. This
inequity in the cross-country economic implications of relaxing migration frictions will undoubtedly lead to political
disagreements about their implementation. For example, the developed economies today will guarantee their future
economic superiority only in scenarios where the world relaxes migration restrictions. We have abstracted from
these political economy considerations, but they are extremely important.
    Even though our framework incorporates a large set of forces in a rather large general equilibrium exercise, we
had to make the choice of leaving some important forces aside. Perhaps the most relevant one is the ability of
the world economy to accumulate a factor of production like capital. In our framework, only technology can be
accumulated over time, not capital. In our view, the ability of regions to invest in technology substitutes partially
for the lack of capital accumulation, but clearly not fully. We also abstracted from local investments in amenities.
In our framework, amenities vary only through changes in congestion as a result of in or out migration. Finally, we
also abstracted from individual heterogeneity in education or skills. Given our long-term focus, we view educational
heterogeneity as part of the local technology of regions. It is obviously the case that individuals can migrate with
their human capital, and we ignore this. However, the human capital embedded in migrants lasts mostly for only
one generation. Ultimately, migrants and, more important their descendants, will obtain the local education that
is part of the local technology of a given region.




 3 3 Table   7 in Appendix A.4 gives all the details.
 3 4 See   Table 8 in Appendix A.4.


                                                         40
Appendix A: Density-Income Correlation and Subjective Well-Being
A.1 Correlation of Density and Income

   In our theory, the presence of both static and dynamic agglomeration economies, together with the role played
by amenities, implies that the correlation between density and income per capita is relatively low (and possibly
negative) when income per capita is low, and relatively high when income per capita is high. Two forces drive this
result. On the one hand, the standard positive correlation between density and per capita income, due to static
agglomeration economies, is stronger in high-productivity places that bene…t from greater dynamic agglomeration
economies. This explains why the correlation between density and per capita income is increasing in per capita
income. On the other hand, free mobility means that high-amenity places tend to have both high population
density and low per capita income. This explains why in relatively low per capita income locations, where dynamic
agglomeration economies are weak, the correlation between density and per capita income might be negative.
   To see whether these …ndings hold up in the data, we do two exercises. First, we compute the correlation
between population density and income per worker across U.S. zip codes. We split zip codes into di¤erent groups:
those with income per capita (worker) below the median and those with income per capita (worker) above the
median. The theory predicts a higher correlation between density and income per capita for the latter group and
possibly a negative correlation for the former group. We also consider a …ner split-up into four di¤erent groups
by income per capita quartile. In that case, we would expect the correlation to increase when we go from lower
income per capita quartiles to higher income per capita quartiles.
   Table 5 reports the results. Data on population, mean income per worker and geographic area come from the
2000 U.S. Census and from the American Community Survey 5-year estimates. The geographic unit of observation
are ZIP Code Tabulation Areas (ZCTAs). We use two di¤erent de…nitions of income: “earnings” correspond
essentially to labor income, whereas “total income” also includes capital income. As predicted by the theory,
Panel A shows that the correlation between population density and earnings per full-time worker, both measured
in logs, increases from 0.12 for ZCATs with below-median earnings per full-time worker to 0.31 for ZCATs above
the median. When we focus on total income in Panel B, the results are similar, but now the correlation between
population density and income per full-time worker is negative for ZCATs below the median. In particular, the
correlation increases from -0.06 for those ZCATs below the median to 0.36 for those above the median. All these
correlations are statistically di¤erent from zero at the 1% level, and in both cases, the increase in the correlation
is statistically signi…cant at the 1% level. When we compare di¤erent quartiles, rather than below and above the
median, the results continue to be consistent with the theory: the correlations between density and income are
greater for higher-income quartiles.
   Second, we explore whether the relation between density and income is stronger in richer areas by analyzing
how that relation at the zip code level changes with the relative income of the Core Based Statistical Area (CBSA)
the zip code pertains to. To analyze this, we start by running separate regressions for each CBSA of payroll per
employee on employee density at the zip code level. Using data of 2010 from the ZIP Code Business Patterns, this
yields 653 coe¢ cients of employee density, one for each CBSA. Figure 12 then plots these 653 coe¢ cients against
the relative income of the CBSA. As expected, as the relative income of the CBSA increases, the e¤ect of employee
density on payroll per employee increases.
   Rather than running separate regressions for each CBSA, we can also run a single regression with an interaction



                                                         41
                                                                                              Table 5: Density and Income

     A. Correlation Population Density (logs) and Mean Earnings per Full-Time Worker (logs)
                                              Percentiles based on mean earnings
     Year        < 25th        25-50th     50th-75th >75th          < Median        Median
     2000        0.0549***     0.0884*** 0.1293*** 0.2199*** 0.1216***           0.3128***
     2007-2011 -0.0237*        0.0428*** 0.1048*** 0.2727*** 0.0222***           0.3546***
     B. Correlation Population Density (logs) and Per Capita Income (logs)
                                              Percentiles based on mean earnings
     Year        < 25th        25-50th     50th-75th >75th          < Median        Median
     2000        -0.1001*** 0.0495*** 0.1499*** 0.2248*** -0.0609*** 0.3589***
     2007-2011 -0.0930*** 0.0175           0.0733*** 0.2420*** -0.0781*** 0.3234***
     ***signi…cant at 1% level, **at 5% level, *at 10% level.

                                                                                 Figure 12: Payroll per Employee and Employee Density
                                                                        .4
                      Effect of Worker Density on Payroll per Worker (ZIP)
                     -.4          -.2           0           .2




                                                                             3                3.5                     4               4.5
                                                                                             Payroll per Worker CBSA 2010
                                                                                                                                            	  



term of density at the zip code level with payroll per employee at the CBSA level:

                                                                                  y (zip) = a0 + a1 d (zip) + a2 d (zip) y (cbsa) + " (zip)                         (44)

where y (zip) is payroll per employee at the zip code level, y (zip) is payroll per employee at the CBSA level, and
d (zip) is employee density at the zip code level. The theory predicts that a1 may be negative and that a2 is
positive. Consistent with this, when using data from 2010, we …nd a1 =                                                              0:180 and a2 = 0:063, and both are
statistically signi…cant at the 1% level. Using data from 2000 yields similar results: a1 =                                                        0:075 and a2 = 0:039,
and once again both are statistically signi…cant at the 1% level.

A.2 Correlations of Amenities and Quality of Life

   Our goal is to compute correlations between our estimated measures of fundamental amenities and di¤erent
exogenous measures of a location’s quality of life. The di¤erent variables on quality of life, related to distance to


                                                                                                              42
water, elevation, precipitation, temperature and vegetation, come from G-Econ 4.0.35 The results are reported in
Table 6.

           Table 6: Correlations between Estimated Amenities and Di¤erent Measures of Quality of Life

                                   Correlations with Estimated Amenities (logs)
                                          (1)        (2)         (3)          (4)                             (5)
                                       All cells     U.S.      One cell     Placebo                         Placebo
                                                             per country     of (1)                          of (3)
             A. Water
             Distance to ocean      -0.2918***          -0.6300***        -0.2052***       -0.0983***      0.1911***
             Distance to water      -0.4546***          -0.2602***       -0.2388 ***       -0.3329***        0.2285
             Water < 50 km           0.2198***          0.1286***          0.1232**         0.1064***      -0.1363**
             B. Elevation
             Level                  -0.4152***          -0.1493***        -0.2816***       -0.2793***       0.1283**
             Standard deviation     -0.4599***          -0.2573***        -0.3099***       -0.3285***       0.1121*
             C. Precipitation
             Average                 0.4176***          0.08643***        0.3851***         0.3185***      0.1830***
             Maximum                 0.4408***           0.1068***        0.3128***         0.4286***      0.3200***
             Minimum                 0.2035***           0.2136***        0.2108***          -0.0096       -0.1965**
             Standard deviation      0.4160***             0.0212         0.2746***         0.4715***      0.4535***
             D. Temperature
             Average                 0.6241***          0.6928***         0.3087***         0.6914***       0.5692***
             Maximum                 0.5447***           0.7388***         0.1276***        0.6589***      0.4635***
             Minimum                 0.6128***           0.6060***         0.2931***        0.6565***       0.5389***
             Standard deviation     -0.5587***          -0.3112***        -0.3313***       -0.5539***      -0.3679***
             E. Vegetation
             Desert, ice or tundra -0.3201***            -0.3993***     -0.1827***         -0.2440***       -0.1291*
             ***signi…cant at 1% level, **at 5%        level, *at 10% level.


    Column (1) are correlations based on all 1 by 1 cells of the world. These correlations suggest that people prefer
to live close to water, dislike high elevations and rough terrain, like precipitation but not constantly, prefer warm
and stable temperatures, and dislike deserts, tundras and ice-covered areas. It is reassuring that these correlations
are largely consistent with those found in the literature. For example, Albouy et al. (2014) provide evidence that
Americans have a mild preference for precipitation and a strong preference to live close to water, and Morris and
Ortalo-Magné (2007) …nd that there is a positive correlation between quality of life and average temperature and
precipitation. One thing that may come as a surprise is that people not only prefer higher average temperatures,
they also like higher maximum temperatures. This result is driven by the imposed linearity: once we allow for a
quadratic relation between our measure of amenities and maximum temperatures, we …nd an optimal maximum
temperature of 27.4 degrees Celsius.
    The fact that our correlations are overall in line with what we would expect suggests that our methodology of
identifying amenities by using data on subjective well-being is reasonable. To further con…rm this, we compare our
results to what these correlations would look like within the U.S. Because utility is the same across all cells within
a country, the correlations within the U.S. do not depend on our use of data on subjective well-being. Hence, if the
  3 5 All variables come directly from G-Econ 4.0, but a couple require some further manipulation. In particular, the “distance to

water” measure is de…ned as the minimum distance to a major navigable lake, a navigable rivers or an ice-free ocean; and the di¤erent
vegetation categories in G-Econ can be found at http://data.giss.nasa.gov/landuse/vegeem.html.




                                                                 43
results for the U.S. are similar to those of the world, this is further evidence in favor of our methodology. Column
(2) con…rms that this is indeed the case.
   Another possible worry is that the correlations across all cells of the world are driven by a few large countries.
If so, what we observe in Column (1) may mostly re‡ect within-country variation, and this might explain why
Columns (1) and (2) look similar. To address this concern, we choose a random sample of 176 cells, one for each
country, and compute the correlations. We repeat this procedure 1,000 times and report the resulting cross-country
correlations in Column (3). They look similar to those in Column (1) and Column (2).
   As a further robustness check, we compute some placebo correlations to be compared with those in Column (1)
and Column (3). To do so, we take a di¤erent value of         when transforming subjective well-being into our measure
of utility. In particular, we assume that all countries in the world have the same utility, which is equivalent to
identifying fundamental amenities under the assumption that there is free mobility in the world today. The results
are reported in Column (4) and Column (5). Note that there is no need to run a similar placebo test on Column (2)
since the correlations within countries are independent of our measure of utility. Columns (4) and (1) are similar,
but far from identical. This is not surprising since most of the variation in those two columns is across cells within
countries, and that variation is una¤ected by the particular value of . In contrast, when we focus on the variation
across countries, using a di¤erent value of    should change the results. This is indeed what we …nd: Column (5)
yields very di¤erent correlations from Column (3). All the signs on proximity to water have switched signs; many
of the signs on elevation have also switched signs or give correlations that are statistically insigni…cant; and the
correlation on minimum precipitation changes from positive to negative.
   If the fundamental amenities that we have estimated are reasonable, then Columns (1), (2) and (3) should yield
similar results, Columns (4) and (1) should not di¤er too much, and Columns (5) and (3) should be quite di¤erent.
Our results in Table 6 con…rm these priors. Together with the fact that the correlations in Column (1) are in
line with those in the literature, this allows us to conclude that our particular methodology of using subjective
well-being to identify fundamental amenities performs well.

A.3 Subjective Well-Being

 Figure 13: Cantril Ladder Measure of Subjective Well-being from the Gallup World Poll (Max = 10, Min = 0)


                          20                                                          7




                          40
                                                                                      6



                          60
                                                                                      5


                          80

                                                                                      4


                         100

                                                                                      3

                         120


                                                                                      2
                         140



                                                                                      1
                         160




                         180                                                          0
                                  50     100    150     200        250   300    350




                                                              44
A.4 A Rise in Sea Levels by 1 Meter

   In the next two tables we present results on the impact of a 1-meter rise in the sea level. Tables 8 and 6
correspond to Tables 3 and 4 in the text for this case.

                              Table 7: The E¤ect of a Rise in Sea Levels by 1 Meter

                                                                Period 1   Period 100   Period 500
             A. Keeping mobility restrictions unchanged
             Percentage land ‡ooded                                0.4         0.4         0.4
             Percentage population ‡ooded                          1.6         1.3         0.8
             Percentage land rents lost                            1.9         2.1         1.2
             Percentage technology lost (land weighted)            0.8         0.9         0.9
             Percentage technology lost (population weighted)      1.8         1.6         0.7
             Percentage amenities lost (land weighted)             1.3         1.0         0.5
             Percentage amenities lost (population weighted)       3.5         3.2         1.9
             B. Free mobility
             Percentage land ‡ooded                                0.4         0.4          0.4
             Percentage population ‡ooded                          5.5         8.5         75.5
             Percentage land rents lost                            4.2         8.5         86.3
             Percentage technology lost (land weighted)            0.8         1.2          3.4
             Percentage technology lost (population weighted)      5.2        11.7         94.1
             Percentage amenities lost (land weighted)             0.7        0.4           0.2
             Percentage amenities lost (population weighted)       6.1        12.5         75.7
             C. Partial mobility
             Percentage land ‡ooded                                0.4         0.4          0.4
             Percentage population ‡ooded                          3.6         5.5         23.5
             Percentage land rents lost                            2.9         5.0         34.3
             Percentage technology lost (land weighted)            0.8         1.1         2.1
             Percentage technology lost (population weighted)      3.2         7.3         58.3
             Percentage amenities lost (land weighted)             1.1         0.8          0.4
             Percentage amenities lost (population weighted)       5.2         9.7         49.9



                             Table 8: Dynamic E¤ects of Coastal Flooding (1 Meter)

        Mobility   Discounted Present Value of Real Income*                     Welfare**
                   No Flooding Flooding      Ratio (NF/F)      No Flooding Flooding Ratio (NF/F)
          0.0a        36.51        36.12          1.011                 2.64          2.55 1.036
          0.3         37.80        37.40          1.011                 4.51          4.34 1.040
          0.5         41.59        41.20          1.010                 6.11          5.87 1.041
          0.9         51.03        50.64          1.008                 9.09          8.73 1.041
          1.3         57.02        56.37          1.012                10.52        10.12  1.039
          1.8b        61.56        60.70          1.014                10.89        10.54  1.034
                                  a: Observed Restrictions. b: Free Mobility.
                        *: Normalized by world average GDP without ‡ooding for t = 1.
                             **: Population-weighted average of cells’utility levels.




                                                          45
Appendix B: Proofs, Derivations, and Other Details
B.1 Derivation of Trade Shares and the Price Index

   We derive here in detail …rst the probability that a given good produced in an area r is bought in s. The area
B(r; ) (a ball of radius           centered at r) o¤ers di¤erent goods in location s. The distribution of prices B(r; )
o¤ered in s is given by                                                                                          h                   i
                                                                                           R                         mct (r)&(s;r)
                                                                                                        Tt (r)                             dr
                                           Gt (p; s; B(r; )) = 1                  e            B(r; )                      p
                                                                                                                                                :

The distribution of the prices of the goods s actually buys is then
                                                                 R                h                      i
                                                                                      mct (u)&(s;u)
                                                                         Tt (u)                                  du                      t (s)p
                                      Gt (p; s) = 1          e    S                         p
                                                                                                                       =1       e                   ;

where                                                            Z
                                                    t (s) =              Tt (u) [mct (u) & (s; u)]                          du:                                                         (45)
                                                                     S

   Now we calculate the probability that a given good produced in an area B(r; ) is bought in s. Start by comput-
ing the probability density that the price of the good produced in B(r;
                                                                    h
                                                                        ) and o¤ered
                                                                               i
                                                                                     in s is equal to p and that this
                                                                                       R                              mct (u)&(u;s)
                                                                                                        T (u)                               du
is the lowest price o¤ered in s. This is dGt (p;s;B(r;
                                                    dp
                                                            ))
                                                               e SnB(r; ) t         p
                                                                                               . Re-write dGt (p; s; B(r; )) =
    R          h               i
         T (r)
                 mct (r)&(s;r)
                                 dr R
e B(r; ) t             p
                                           T (r) [mct (r) & (r; s)] dr p 1 dp. Replace this into the previous expression
                                     B(r; ) t
                                                           h           i
                                            R 1 R T (u) mct (u)&(s;u)     du R
and integrate over all possible prices, 0 e S t                   p
                                                                                     T (r) [mct (r) & (r; s)] dr p 1 dp. Solv-
                                                                              B(r; ) t
                                                R
                                                         Tt (r)[mct (r)&(r;s)]                 dr 1
                                       t (s)p
                                                B(r; )
ing this integral yields [ e                                                                     ]0 ,    which gives
                                                                 t (s)


                              R                                                                     R
                                  B(r; )
                                           Tt (r) [mct (r) & (r; s)]                   dr            B(r; )
                                                                                                                     Tt (r) [mct (r) & (r; s)]                dr
          t   (s; B(r; )) =       R                                                            =                                                                   all r; s 2 S:
                                       Tt (u) [mct (u) & (u; s)]                  du                                            t    (s)
                                   S

Since in any small interval with positive measure there will be many …rms producing many goods, the above
expressions can be interpreted as the fraction of goods location s buys from B(r; ). In the limit, as                                                                           ! 0, this
expression can be rewritten as

                                           Tt (r) [mct (r) & (r; s)]                                Tt (r) [mct (r) & (r; s)]
                     t   (s; r) = R                                                             =                                                       all r; s 2 S;
                                       S
                                           Tt (u) [mct (u) & (u; s)]                   du                      t (s)


which is the expression in the text.
                                                                                                                                                                        R1
   To …nish this subsection, we derive the price index of a location s. We know that Pt (s) 1                                                                       =    0
                                                                                                                                                                             p!
                                                                                                                                                                              t (s)
                                                                                                                                                                                    1   d!.
This can be interpreted as the average price computed over the di¤erent goods that are being sold in s. This is
                                                                                          R1
the same as the expected value of the price of any good sold in s, so that Pt (s) 1 = 0 p 1 dGdp    t (s)
                                                                                                          dp. Since
dGt (s)                                                                            R  1
  dp    = t (s) p 1 e t (s)p , we can write the previous expression as Pt (s) 1 = 0 p 1     t (s) p
                                                                                                     1
                                                                                                       e t (s)p dp.
                                                                                h
                                                                             R 1 x (1 ) i
By de…ning x = t (s)p , we can write dx = p 1 t (s). Substituting yields 0                  e x dx which is equal
                                                                                  t (s)
               R1                                                      R1
to t (s) (1 ) 0 x (1 ) e x dx. The function is de…ned as ( ) = 0 y 1 e y dy, so that we can rewrite the




                                                                                        46
above expression as                   t (s)
                                                   (1       )       ( (1        )       + 1). Therefore Pt (s) 1                                =    t (s)
                                                                                                                                                               (1       )   ( (1       )       + 1), so that

                                                                                                                       1                                   1
                                                                                Pt (s) =                 t (s)             [ (                  + 1)]               ;
                                                                                                                                 (1        )

which is the expression in the text.

Proof of Lemma 2. Substituting (16) and (45) into (18), we obtain

                                                                                                                                                         wt (r)
                                    uW
                                     t u (c) = a (r) Lt (r)                                                            hP                                                                    i
                                                                                                         +     1             C        R                                                             1


                                                                                                                             d=1 Sd        Tt (s) [mct (s) & (r; s)]                       ds           p

                                                                                                                   1
for any location r 2 Sc , where p = [ ( (1                                                  )       + 1)]                   . We can rewrite this as

                                                                                                                                                     C Z
                                                                                                                                                     X
                                                                                                    +      1
                        a (r)         wt (r)                    Lt (r)              =                                       uW
                                                                                                                             t u (c) p                              Tt (s)(ct (s) & (r; s))                  ds;
                                                                                                                                                     d=1       Sd


from which
                                                                                                                   C Z
                                                                                                                   X
                        a (r)                                                                                                                                                                   (1           1   )
                                          wt (r)                 Lt (r)                 uW
                                                                                         t           =         1                      t (s)&    (r; s)     wt (s)               Lt (s)                               ds       (46)
                        u (c)                                                                                                Sd
                                                                                                                   d=1

                    h               i [    +       1
                                                        ]               h       i       1
                            +
where       1   =               1
                                                                                            p        . This yields the …rst set of equations that Lt ( ) and wt ( ) have to
                                                                            1
solve.
      Inserting (15) and (16) into the balanced trade condition, we get

                                                                                        C Z
                                                                                        X
                            wt (r) H (r) Lt (r) = p                                                      Tt (r) [mct (r) & (r; s)]                       Pt (s) wt (s) H (s) Lt (s) ds
                                                                                        d=1         Sd


Substituting (18) and Tt (r) =                                      t   (r) Lt (r) into the previous equation yields

                                                                                                                                     C Z
                                                                                                                                     X
            1                        1+                         1       +(1                 1
                                                                                                )                                                 a (s)                                                     1+            1
  t   (r)       H (r) wt (r)                Lt (r)                                                    uW
                                                                                                       t               =         1                              H (s) & (s; r)                  wt (s)               Lt (s)   ds:
                                                                                                                                           Sd     u (d)
                                                                                                                                     d=1
                                                                                                                                                                                                                              (47)
This gives the second set of equations that Lt ( ) and wt ( ) have to solve.
      We can use (46) and (47) to analyze the equilibrium allocation further under hsymmetric
                                                                                       i      trade costs. So assume
                                                                                                                                                                                           1
                                                                                                                                                                                a(r)
trade costs are symmetric so that & (r; s) = & (s; r). Now guess that wt (r) = wt                                                                                               u(c)            t   (r) 2 H (r) 3 Lt (r) 4 for
any location r 2 Sc . Substituting into (46) and (47) and using the symmetry of trade costs, one can verify the
guess if                                                                                                                                                                    h                                i
                                                                   1                                            1                                                   1+          +      1
                                                                                                                                                                                                 (1         )
                        1   =        1+2
                                               ;            2   =     ;                         3   =              ;                  and        4   =                                                               :
                                                                  1+2                                          1+2                                                              1+2
Hence, wages at location r are a function of amenities, productivity, land, and population density. Namely, as




                                                                                                                             47
stated in Lemma (2),

                                                     a (r)        1+2                           1                               1
                                                                                                                                                             1+  [       +   1    (1       )   ]
                            wt (r) = w                                              t   (r) 1+2 H (r)                         1+2
                                                                                                                                     Lt (r)                              1+2
                                                                                                                                                                                                    :
                                                     u (c)

Substituting in (46) then yields the second equation in Lemma (2),
                        (1+ )
               a (r)    1+2
                                                                                                                     [        1+[ +      1          (1        )]     ]
                                      t   (r)       1+2
                                                           H (r) 1+2 Lt (r)                                 1+2
                                                                                                                                                                                                                                 (48)
               u (c)
                            C Z
                                                             2
                            X                     a (s)    1+2                      1+                                                                                     1+
        =      uW                                                         (s) 1+2 H (s) 1+2 & (r; s)                                      Lt (s)
                                                                                                                                                             1           + 1+2         [           1+[ +   1   (1   )]   ] ds;
                t       1                                             t
                                      Sd          u (d)
                            d=1


which pins down the function Lt ( ) :

Proof of Lemma 4. Given the evolution of technology in (19), the growth rate of                                                                                                        t   (r) is given by
                                                                                                                Z                               1
                                                            t+1 (r)                                                            t (s)                     2

                                                                    =                   t (r)
                                                                                                        1
                                                                                                                                     ds                      :
                                                             t (r)                                                S            t (r)


Divide both sides of the equation by the corresponding equation for location s, and rearrange to get

                                                                                                            1                                       1
                                                                                                                                         (1         2)
                                                             t (s)                       (s)        1        2                L (s)
                                                                   =                                                =
                                                             t (r)                       (r)                                  L (r)

where the second equality follows from (8) and where we drop the time subscript to indicate that we refer to a
variable that remains constant in the BGP. Use this relationship to obtain that
                                                                                                                    (1        2)
                                                                                                t (s)                         1
                                                                      L (s) =                                                       L (r)
                                                                                                t (r)

and so, after integrating over s and using the labor market clearing condition, that
                                              Z                                                                     (1
                                                                                                                                    Z
                                                                                                                              2)                         (1        2)
                                                    L (s) ds = L = L (r)                        t (r)                         1
                                                                                                                                            t   (s)                1         ds
                                               S                                                                                     S

or
                                                                              L                                          (1    2)
                                                                                                                                              2
                                                                                                                                                                   (1        2)
                                              L (r) = R                        (1       2)
                                                                                                            t   (r)            1     =        t t        (r)                 1


                                                            S     t   (s)               1    ds
         2
where    t   depends on time but not on location.
     In equilibrium Lemma 3 (plus the power guess for wages) implies that the BGP labor density L ( ) has to satisfy
                            (1+ )
                a (r)       1+2
                                                                                                                     [         1+[ +     1          [1        ]]     ]
                                          t   (r)    1+2
                                                           H (r) 1+2 L (r)                                  1+2
                u (c)
                                C Z
                                                              2
                                X                 a (s)     1+2                         1+                                                                                 1+
         =      uW                                                            (s) 1+2 H (s) 1+2 & (r; s)                                      L (s)
                                                                                                                                                             1           + 1+2         [           1+[ +   1   [1   ]]   ] ds
                 t          1                                             t
                                          Sd      u (d)
                                d=1




                                                                                                        48
and so
                               (1+ )
                  a (r)        1+2                                     [1       2]
                                                                                       [                   [           1+[ +       1        [1           ]]   ]]
                                        H (r) 1+2            t   (r)            1                    1+2                                                               1+2
                  u (c)
                                  C Z
                                                               2
                                  X            a (s)         1+2                                                                       [1        2]                          1+                                                       1+
      =        uW             3
                                                                       H (s) 1+2 & (r; s)                                        (s)             1
                                                                                                                                                         [1                + 1+2      [           1+[ +         1   [1       ]]   ]]+ 1+2 ds;
                t             t                                                                                              t
                                         Sd    u (d)
                                  d=1


          3               2    +[   1         (1    )]
where     t   =     1     t                              .
   The solution to this integral equation is the spatial distribution of productivity                                                                                                             t   (r) on the balanced growth
path. According to Theorem 2.19 in Zabreyko, et al. (1975) a unique positive solution exists if

                                                                                           1                       1
                                                                               +                 +                                     +1                     :
                                                                                                      [1               2]




Proof of Lemma 5. Lemma 4 guarantees that if the economy is in its BGP in periods t and t + 1, then
                                                                                     1                                                              [1        2]
                                    uW                           2             +                     [1        ]
                                                                                                                               (r)
                                                                                                                                            1
                                                                                                                                                +
                                                                                                                                                              1
                                                                                                                                                                       [    +     1               (1       )]
                                     t+1                         t+1                                                       t+1
                                               =                   2
                                    uWt                            t                                                        t (r)
                                                                                   1
                                                                 t+1 (r)
                                               =
                                                                  t (r)


for all r and so since
                                                                                                                                        2                                                                   31
                                                                           Z                               1                             Z                                                            1                  2

                              t+1 (r)                                                    t (s)                         2
                                                                                                                                                                                 (s)          1        2
                                           =         (r)          1
                                                                                               ds                           =     (r) 1 4                                                                  ds5
                               t (r)                                        S            t (r)                                                                S                  (r)
                                                                                                  1        Z                                             1
                                                                            1=
                                                                                                                                                                   2
                                                                                                                                   1
                                                    1
                                           =                 2                                                     L (s) [1        2]       ds                         ;
                                                                       1    +                              S

we have that
                                                                                                                   1        Z                                                1        2
                                                   uW
                                                    t+1                1       2                 1=                                                      1
                                                        =                                                                        L (s) [1                2]       ds                      :
                                                   uWt                                       1   +                           S




B.2 Procedure to Find a Solution to Equation (29)

   We use the following procedure to solve equation (29). We approximate (29) by

                                                                                                      C Z
                                                                                                      X
                                                                                                                                                                                                                                      0
                               a (r)                                                                                               1+                             1                                                  a (s)
 w0 (r)        L0 (r)                          =    uW
                                                     0                     1w
                                                                                     [1+2 ]
                                                                                                                           w0 (s)                L0 (s)                         H (s) & (r; s)                                            ds (49)
                               u (c)                                                                               Sd                                                                                                u (d)
                                                                                                      d=1

          0                                                                            0
where         > 0 is a constant. For any positive
                                              , Theorem 2.19 in Zabreyko et al. (1975) guarantees that (49) can
                                                                                      h      i0
                                                                                        a(r)
be solved by the following simple iterative procedure. Guess some initial distribution u(c)     , plug it into the
                                                                                                                                                                                                                     0




                                                                                                                   49
                                                                                                                                       h          i1
                                                                                                                                           a(r)
right-hand side of equation (49), calculate the left-hand side, and solve for a (r) =u (c); call this                                      u(c)        . Compute
                                                                                                                                                   0
                      h      i1      h      i0
                        a(r)           a(r)
the distance between u(c)      0
                                 and   u(c)   0
                                                , de…ned as

                                                               Z "                   1                     0
                                                                                                                #2
                                                           1             a (r)                  a (r)
                                                     dist =                                                          dr:
                                                                S        u (c)           0      u (c)       0



                                                                                         h      i1
                                                                                           a(r)
If dist1 < " where " is an exogenously given tolerance level, stop. Otherwise, plug u(c)          0
                                                                                                    into the right-hand side
                                                                      h      i2
                                                                        a(r)
of (49), express a (r) =u (c) from the left-hand side, that is, obtain u(c)    0
                                                                                 , and compute dist2 , de…ned analogously
to dist1 . Continue the procedureh until      i
                                        i dist < " for some i.
                                   a(r)
    Having the solution to (49), u(c) 0 , one needs to check whether it is su¢ ciently close to the solution of (29).
Given that the system of (21) and (20) is equivalent
                                                h      i to the system of (29) and (28), we can
                                                                                             h check
                                                                                                   i this in the
                                                  a(r)                                        a(r)
following way. First, we solve for 0 (r) 0 using u(c) 0 and equation (28). Next, we plug u(c) 0 and 0 (r) 0
into (21), and solve for population levels L0 (r) 0 .36 Finally, we check whether L0 (r)                                   0   are su¢ ciently close to
                                                                37                                                             1       0
L0 (r), the population levels seen in the data.                          If they are not close enough, we take                     =       =2, and redo the
                                    1                0
whole procedure with                    instead of       . Now, if L0 (r)        1       are su¢ ciently close to Lh0 (r),iwe stop. Otherwise, we
                     2       1                                                                                        a(r)
proceed with             =       =2; and so on. This procedure results in a pair of distributions                     u(c) i and 0 (r) i which are
su¢ ciently close to the solution of (29) and (28).


Appendix C: Data Appendix
    The data description and sources follow approximately the order in which they appear in the paper. For
the numerical exercise, all data are essentially for the time period 2000-2010, whereas for the calibration of the
parameters we sometimes use data from a longer time period.

Population and amenities of U.S. Metropolitan Statistical Areas. Data on population of U.S. MSAs
come from the Bureau of Economic Analysis, Regional Economic Accounts, and are for the years 2005 and 2008.
Corresponding data on amenities are estimated by the structural model in Desmet and Rossi-Hansberg (2013).

Population, GDP and wages at 1 by 1 resolution. Data on population and GDP for 1 by 1 cells for the
entire world come from the G-Econ 4.0 research project at Yale University. For the calibration of the technology
parameters, we use data of 1990, 1995, 2000 and 2005 and take GDP measured in PPP terms. For the benchmark
model, we use data of 2000. Wages are taken to be GDP in PPP terms divided by population.

Railroads, major roads, other roads and waterways at 1 by 1 resolution. Data on railroads, major
roads and other roads come from http://www.naturalearthdata.com/, a public domain map data set built
through the collaborative e¤ort of many volunteers and supported by the North American Cartographic Information
  3 6 This    is done using the procedure explained in Section 4:7.
  3 7 The    criterion used here is                          Z
                                                     ]0 =                                             2
                                                    dist         L0 (r)              0       L0 (r)       dr < e
                                                                                                               "
                                                                     S
where e
      " is a positive tolerance level.



                                                                                 50
Society. For each 1 by 1 cell, we de…ne railroads as the share of 0.01 by 0.01 cells through which a railroad
passes. Major roads, other roads and waterways are de…ned analogously. Major roads refer to a major highway, a
beltway or a bypass; other roads refer to any other type of road; and waterways refer to either a river or an ocean.

Land at 1 by 1 and 3000 by 3000 resolution. Data on land come from the Global Land One-km Base Elevation
(GLOBE) digital elevation model (DEM), a raster elevation data set from the National Oceanic and Atmospheric
Administration (NOAA) covering all 3000 by 3000 cells that are located on land. Using this information, we compute
for each 1 by 1 cell on the globe the share of the 3000 by 3000 cells that are on land.

Subjective well-being at country level. Subjective well-being is measured on a Cantril ladder from 0 to 10,
where 0 represents the worst possible life and 10 the best possible life the individual can contemplate for himself.
The main data source is the Gallup World Poll, and we take the mean for the period 2007-2011 as reported in the
Human Development Report 2013. This gives us data on 151 countries. To increase the coverage of countries, we
proceed in three ways. First, we use the database by Veenhoven (2013) who reports data for a similar time period on
the same evaluative measure of subjective well-being from Gallup, the Pew Research Center and Latinobarómetro.
This gives an additional 7 countries. Second, Abdallah, Thompson and Marks (2008) propose a model to estimate
subjective measures of well-being for countries that are typically not surveyed. To make the data comparable, we
normalize the Abdallah et al. measure so that the countries that are common with those surveyed by Gallup have
the same means and standard deviations. This increases the coverage to 184 countries. Third, for the rest of the
world — mostly small islands and territories — we assign subjective well-being measures in an ad-hoc manner.
For example, for Andorra we take the average of France and Spain. For another example, in the case of Nauru, a
small island in the Paci…c, we take the average of the Solomon Islands and Vanuatu.

Desired and actual migration at country level. Data on desired migration come from the Gallup World
Poll, based on surveys starting in 2007. In particular, we have information on (i) how many people would like to
permanently migrate; (ii) which country is the favorite destination; (iii) and of those who want to migrate, the
share that chooses the favorite destination. Bilateral data on actual migration come from Artuc et al. (2012)
and are for 2000. To calculate shares of actual migrants, we use population data from the World Development
Indicators, also for 2000.

Rise in sea levels at 3000 by 3000 resolution. The raster data on inundation come from the Center for Remote
Censoring of Ice Sheets (Cresis). Inundation zones from a 6-meter rise in sea level were calculated by Cresis
from the same Global Land One-km Base Elevation digital elevation model of the NOAA mentioned before. The
resolution is 3000 by 3000 .

Population at 3000 by 3000 resolution. Population data at the same resolution of 30 arcsecond x 30 arcsecond
come from LandScan 2005 at the Oak Ridge National Laboratory.

Population (and share of population) ‡ooded at 1 by 1 resolution. Using population data and ‡ooding
data at a resolution of 3000 by 3000 , we compute how many people are ‡ooded at a resolution of 3000 by 3000 , and
then aggregate up to a resolution of 1 by 1 . It is then easy to compute the share of population ‡ooded.



                                                         51
Share of land ‡ooded at 1 by 1 resolution. The share of land ‡ooded at 1 by 1 resolution is de…ned
as the number of cells at 3000 by 3000 resolution (contained in each 1 by 1 cell) that get ‡ooded divided by the
number of cells at 3000 by 3000 resolution (contained in each 1 by 1 cell) that are on land.

U.S. zip code and CBSA data.          Data on area, population, mean earnings per worker and income per capita
come from the U.S. census. Data referred to as 2000 are from the 2000 Census and data referred to as 2007-2011
come from the 2007-2011 American Community Survey 5-year estimates. The geographic unit of observation is
the ZIP Code Tabulation Areas (ZCTAs).
   Data on payroll and number of employees for U.S. zip codes in 2010 come from the ZIP Code Business Patterns
from the U.S. Census. Note that zip codes and ZCTAs are not exactly the same. In particular, zip codes do not
have areas. ZCTAs should be understood as areal representations of United States Postal Service zip codes. When
calculating employee density for zip codes, we therefore use the corresponding ZCTAs. To match ZCTAs to Core
Based Statistical Areas (CBSA) we rely on tabulation …les from the U.S. Census.



References
 [1] Abdallah, S., Thompson, S. and Marks, N., 2008. “Estimating Worldwide Life Satisfaction,” Ecological Eco-
    nomics, 65, 35-47.

 [2] Albouy, D., Graf, W., Kellogg, R., and Wol¤, H., 2014. “Climate Amenities, Climate Change, and American
    Quality of Life,” unpublished manuscript.

 [3] Allen, T. and Arkolakis, C., 2014. “Trade and the Topography of the Spatial Economy,”Quarterly Journal of
    Economics, forthcoming.

 [4] Antho¤, D., Nicholls, R.J., Morgenroth, E.L.W., and Tol, R.S.J., 2010. “The Economic Impact of Substantial
    Sea-Level Rise," Mitigation and Adaptation Strategies for Global Change, 15, 321–335.

 [5] Arnell, N.W., Livermore, M.J.L., Kovats, S., Levy, P.E., Nicholls, R., Parry, M.L., Ga¢ n, S.R., 2004. “Climate
    and Socio-Economic Scenarios for Global-Scale Climate Change Impacts Assessments: Characterising the
    SRES Storylines,” Global Environmental Change, 14, 3–20.

 [6] Artuc, E., Docquier, F., Ozden, C., and Parsons, C., 2013. “A Global Assessment of Human Capital Mo-
    bility: The Role of Non-OECD Destinations.” Data at http://perso.uclouvain.be/frederic.docquier/
    oxlight.htm (accessed September 18, 2013).

 [7] Behrens, K., Mion. G., Murata, Y., and Südekum, J., 2013. “Spatial Frictions,” unpublished manuscript.

 [8] Bernard, A.B., Eaton, J., Jensen, B.J., and Kortum, S., 2003. “Plants and Productivity in International
    Trade,” American Economic Review, 93, 1268–1290.

 [9] Caliendo, L., Parro, F., Sarte, P. and Rossi-Hansberg, E., 2014. “The Impact of Regional and Sectoral Pro-
    ductivity Changes in the U.S. Economy,” unpublished manuscript.




                                                        52
[10] Church, J., Clark, P. Cazenave, A., Gregory, J., Jevrejeva, S., Levermann, A., Merri…eld, M., Milne, G., Nerem,
    R., Nunn, P., Payne, A., Pfe¤er, W., Stammer, D., and Unnikrishnan, A., 2013. “Sea Level Change,” in:
    Climate Change 2013: The Physical Science Basis. Contribution of Working Group I to the Fifth Assessment
    Report of the Intergovernmental Panel on Climate Change, Stocker, T., D. Qin, G.-K. Plattner, M. Tignor,
    S. Allen, J. Boschung, A. Nauels, Y. Xia, Bex, V. and Midgley, P. Eds., Cambridge UP.

[11] Ciccone, A., and Hall, R.E., 1996. “Productivity and the Density of Economic Activity,”American Economic
    Review, 86, 54–70.

[12] Dasgupta, S., Laplante, B., Meisner, C., Wheeler, D. & Jianping Y., 2007. “The Impact of Sea Level Rise on
    Developing Countries: A Comparative Analysis,” Policy Research Working Paper Series 4136, World Bank.

[13] Davis, M.A., and Ortalo-Magné, 2007. “Wages, Rents, Quality of Life,” unpublished manuscript.

[14] Deaton, A., 2008. “Income, Health, and Well-Being around the World: Evidence from the Gallup World Poll,”
    Journal of Economic Perspectives, 22, 53-72.

[15] Deaton, A. and Stone, A., 2013. “Two Happiness Puzzles,” American Economic Review, 103:3, 591–97.

[16] Desmet, K. and Rappaport, J., 2014. “The Settlement of the United States, 1800 to 2000: The Long Transition
    Towards Gibrat’s Law,” unpublished manuscript.

[17] Desmet, K. and Rossi-Hansberg, E., 2014a. “Spatial Development,”American Economic Review, 104:4, 1211–
    1243.

[18] Desmet, K. and Rossi-Hansberg, E., 2014b. “On the Spatial Economic Impact of Global Warming,” unpub-
    lished manuscript.

[19] Desmet, K. and Rossi-Hansberg, E., 2013. “Urban Accounting and Welfare,” American Economic Review,
    103:6, 2296–2327.

[20] Docquier, F., Machado, J., and Sekkat, K., 2012. “E¢ ciency Gains from Liberalizing Labor Mobility,” IRES
    Discussion Paper 2012–23.

[21] Eaton, J. and Kortum, S., 2002. “Technology, Geography, and Trade,” Econometrica, 70, 1741–1779.

[22] Fajgelbaum, P. and Redding, S. 2014. “External Integration, Structural Transformation and Economic Devel-
    opment: Evidence from Argentina 1870-1914,” unpublished manuscript.

[23] Glaeser, E.L., Gottlieb, J.D., and Ziv, O., 2014. “Unhappy Cities,”Journal of Labor Economics, forthcoming.

[24] Greenwood, J., Hercowitz, Z., and Krusell, P., 1997. “Long-Run Implications of Investment-Speci…c Techno-
    logical Change,” American Economic Review, 87, 342–362.

[25] Grogger, J. and Hanson, G.H., 2011. “Income Maximization and the Selection and Sorting of International
    Migrants,” Journal of Development Economics, 95, 42–57.

[26] Hinkel, J. and Klein, R.T., 2009. “Integrating Knowledge to Assess Coastal Vulnerability to Sea-Level Rise:
    The Development of the DIVA Tool,” Global Environmental Change, 19, 384–395.


                                                        53
[27] Kahneman, D. and Deaton, A., 2010. “High Income Improves Evaluation of Life but Not Emotional Well-
    being,” Proceedings of the National Academies of Science, 107 (38): 16489–93.

[28] Kennan, J., 2013. “Open Borders,” Review of Economic Dynamics, 16, L1-L13.

[29] Klein, P. and Ventura, G., 2007. “TFP Di¤erences and the Aggregate E¤ects of Labor Mobility in the Long
    Run,” B.E. Journal of Macroeconomics, 7, 1-36.

[30] Kline, P., and Moretti, E., 2014. “Local Economic Development, Agglomeration Economies and the Big Push:
    100 Years of Evidence from the Tennessee Valley Authority,” Quarterly Journal of Economics, 129, 275–331.

[31] Moser, S.C., Davidson, M.A., Kirshen, P., Mulvaney, P., Murley, J.F., Neumann, J.E., Petes, L., and Reed,
    D., 2014. “Ch. 25: Coastal Zone Development and Ecosystems,”Climate Change Impacts in the United States:
    The Third National Climate Assessment, J. M. Melillo, Terese (T.C.) Richmond, and G. W. Yohe, Eds., U.S.
    Global Change Research Program, 579–618.

[32] Nicholls, R.J., 2004. “Coastal Flooding and Wetland Loss in the 21st Century: Changes under the SRES
    Climate and Socio-Economic Scenarios,” Global Environmental Change, 14, 69–86.

[33] Nicholls, R.J., Hanson, S., Herweijer, C., Patmore, N., Hallegatte, S., Corfee-Morlot, J., Chateau, J., and
    Muir-Wood, R., 2008. “Ranking Port Cities with High Exposure and Vulnerability to Climate Extremes:
    Exposure Estimates,” OECD Environment Working Papers, No. 1, OECD Publishing.

[34] Roback, J., 1982. “Wages, Rents, and the Quality of Life,” Journal of Political Economy, 90:6, 1257–1278.

[35] Rosen, Sherwin. 1979. “Wage-Based Indexes of Urban Quality of Life,”in Current Issues in Urban Economics,
    edited by Peter M. Mieszowski and Mahlon R. Straszheim, 74–104. Johns Hopkins UP.

[36] Simonovska, I. and Waugh, M.E., 2014. “Trade Models, Trade Elasticities, and the Gains from Trade,”
    unpublished manuscript.

[37] Stevenson, B. and Wolfers, J., 2013. “Subjective Well-Being and Income: Is There Any Evidence of Satiation?,”
    American Economic Review, 103:3, 598–604.

[38] Veenhoven, R., 2013. World Database of Happiness, Erasmus University Rotterdam. Data at http://
    worlddatabaseofhappiness.eur.nl (accessed February 19, 2014).

[39] Zabreyko, P., Koshelev, A., Krasnoselskii, M., Mikhlin, S., Rakovshchik, L., and Stetsenko, V., 1975. Integral
    Equations: A Reference Text. Noordho International Publishing Leyden.




                                                        54
