                              NBER WORKING PAPER SERIES




           THE MACROECONOMIC IMPACT OF MICROECONOMIC SHOCKS:
                       BEYOND HULTEN'S THEOREM

                                      David Rezza Baqaee
                                       Emmanuel Farhi

                                       Working Paper 23145
                               http://www.nber.org/papers/w23145


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                    February 2017


We provide a nonlinear characterization of the macroeconomic impact of microeconomic
productivity shocks in terms of reduced-form non-parametric elasticities for efficient economies.
We also show how microeconomic parameters are mapped to these reduced-form general
equilibrium elasticities. In this sense, we extend the foundational theorem of Hulten (1978)
beyond the first order to capture nonlinearities. Key features ignored by first-order
approximations that play a crucial role are: structural microeconomic elasticities of substitution,
network linkages, structural microeconomic returns to scale, and the extent of factor reallocation.
In a business-cycle calibration with sectoral shocks, nonlinearities magnify negative shocks and
attenuate positive shocks, resulting in an aggregate output distribution that is asymmetric
(negative skewness), fat-tailed (excess kurtosis), and a has negative mean, even when shocks are
symmetric and thin-tailed. Average output losses due to short-run sectoral shocks are an order of
magnitude larger than the welfare cost of business cycles calculated by Lucas (1987).
Nonlinearities can also cause shocks to critical sectors to have disproportionate macroeconomic
effects, almost tripling the estimated impact of the 1970s oil shocks on world aggregate output.
Finally, in a long-run growth context, nonlinearities, which underpin Baumol’s cost disease via
the increase over time in the sales shares of low-growth bottleneck sectors, account for a 20
percentage point reduction in aggregate TFP growth over the period 1948-2014 in the US. The
views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.

© 2017 by David Rezza Baqaee and Emmanuel Farhi. All rights reserved. Short sections of text,
not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.
The Macroeconomic Impact of Microeconomic Shocks: Beyond Hulten's Theorem
David Rezza Baqaee and Emmanuel Farhi
NBER Working Paper No. 23145
February 2017
JEL No. E01,E1,E23,E32,L16

                                          ABSTRACT

We provide a nonlinear characterization of the macroeconomic impact of microeconomic
productivity shocks in terms of reduced-form non-parametric elasticities for efficient economies.
We also show how microeconomic parameters are mapped to these reduced-form general
equilibrium elasticities. In this sense, we extend the foundational theorem of Hulten (1978)
beyond the first order to capture nonlinearities. Key features ignored by first-order
approximations that play a crucial role are: structural microeconomic elasticities of substitution,
network linkages, structural microeconomic returns to scale, and the extent of factor reallocation.
In a business-cycle calibration with sectoral shocks, nonlinearities magnify negative shocks and
attenuate positive shocks, resulting in an aggregate output distribution that is asymmetric
(negative skewness), fat-tailed (excess kurtosis), and a has negative mean, even when shocks are
symmetric and thin-tailed. Average output losses due to short-run sectoral shocks are an order of
magnitude larger than the welfare cost of business cycles calculated by Lucas (1987).
Nonlinearities can also cause shocks to critical sectors to have disproportionate macroeconomic
effects, almost tripling the estimated impact of the 1970s oil shocks on world aggregate output.
Finally, in a long-run growth context, nonlinearities, which underpin Baumol’s cost disease via
the increase over time in the sales shares of low-growth bottleneck sectors, account for a 20
percentage point reduction in aggregate TFP growth over the period 1948-2014 in the US.


David Rezza Baqaee
UCLA
315 Portola Plaza
Los Angeles
baqaee@econ.ucla.edu

Emmanuel Farhi
Harvard University
Department of Economics
Littauer Center
Cambridge, MA 02138
and NBER
emmanuel.farhi@gmail.com
1    Introduction
The foundational theorem of Hulten (1978) states that for efficient economies and under
minimal assumptions, the impact on aggregate TFP of a microeconomic TFP shock is equal
to the shocked producer’s sales as a share of GDP:
                                               X
                                 d log TFP =           λi d log Ai ,
                                                   i


where d log Ai is a shock to producer i and λi is its sales share or Domar weight.
    Hulten’s theorem is a cornerstone of productivity and growth accounting: it shows
how to construct aggregate TFP growth from microeconomic TFP growth, and provides
structurally-interpretable decompositions of changes of national or sectoral aggregates into
the changes of their disaggregated component industries or firms. It also provides the
benchmark answers for counterfactual questions in structural models with disaggregated
production.
    The surprising generality of the result has led economists to de-emphasize the role
of microeconomic and network production structures in macroeconomic models. After
all, if sales summarize the macroeconomic impact of microeconomic shocks and we can
directly observe sales, then we need not concern ourselves with the details of the underlying
disaggregated system that gave rise to these sales. Since it seems to imply that the very
object of its study is irrelevant for macroeconomics, Hulten’s theorem has been something
of a bugbear for the burgeoning literature on production networks.
    Are these conclusions warranted? Even at a purely intuitive level, there are reasons to be
skeptical. Take for example shocks to Walmart and to electricity production. Both Walmart
and electricity production have a similar sales share of roughly 4% of U.S. GDP. It seems
natural to expect that a large negative shock to electricity production would be much more
damaging than a similar shock to Walmart. Indeed, this intuition will be validated by our
formal results. Yet it goes against the logic of Hulten’s theorem which implies that, because
the two sectors have the same Domar weight, the two shocks should have the same impact
on aggregate output.
    In this paper, we challenge the view that the macroeconomic importance of a microe-
conomic sector is summarized by its sales share and, more broadly, the notion that the
microeconomic details of the production structure are irrelevant for macroeconomics. The
key is to recognize that Hulten’s theorem only provides a first-order approximation. Non-
linearities can significantly degrade the quality of the first-order approximation for large
enough shocks. To capture these nonlinearities, we provide a general second-order approx-
imation by characterizing the derivatives of Domar weights with respect to shocks. The

                                               2
second-order terms are shaped by the microeconomic details of the disaggregated produc-
tion structure: network linkages, microeconomic elasticities of substitution in production,
microeconomic returns to scale, and the degree to which factors can be reallocated.
    Our results are general in that they apply to any efficient general equilibrium econ-
omy. They suggest that Cobb-Douglas models, commonly used in the production-network,
growth, and multi-sector macroeconomics literatures, are very special: the Domar weights,
and more generally the whole input-output matrix, are constant and can be taken to be
exogenous, the first-order approximation is exact, the model is log-linear, and as a result, the
microeconomic details of the production structure are irrelevant.1 These knife-edge prop-
erties disappear as soon as one deviates from Cobb-Douglas: the Domar weights and more
generally the whole input-output matrix respond endogenously to shocks, and the resulting
nonlinearities are shaped by the microeconomic details of the production structure.
    We also show that nonlinearities in production matter quantitatively for a number of
macroeconomic phenomena operating at different frequencies, ranging from the role of
sectoral shocks in business cycles to the impact of oil shocks and the importance of Baumol’s
cost disease for long-run growth:

   1. Using a calibrated structural multi-industry model with realistic complementarities in
      production, we find that nonlinearities amplify the impact of negative sectoral shocks
      and mitigate the impact of positive sectoral shocks.2,3 Large negative shocks to crucial
      industries, like “oil and gas”, have a significantly larger negative effect on aggregate
      output than negative shocks to larger but less crucial industries such as “retail trade”.
      Nonlinearities also have a significant impact on the distribution of aggregate output:
      they lower its mean and generate negative skewness and excess kurtosis even though
      the underlying shocks are symmetric and thin tailed. Nonlinearities in production
      generate significant welfare costs of sectoral fluctuations, ranging from 0.2% to 1.3%
      depending on the calibration. These are an order of magnitude larger than the welfare
   1
      A mixture of analytical tractability, as well as balanced-growth considerations, have made Cobb-Douglas
the canonical production function for networks (Long and Plosser, 1983), multisector RBC models (Gomme
and Rupert, 2007), and growth theory (Aghion and Howitt, 2008). Recent work by Grossman et al. (2016)
shows how balanced growth can occur without Cobb-Douglas.
    2
      The empirical literature on production networks, like Atalay (2017), Boehm et al. (2017), and Barrot and
Sauvagnat (2016) all find that structural elasticities of substitution in production are significantly below one,
and sometimes very close to zero, across intermediate inputs, and between intermediate inputs and labor at
business cycle frequencies. Furthermore, a voluminous literature on structural transformation, building on
Baumol (1967), has found evidence in favor of non-unitary elasticities of substitution in consumption and
production across sectors over the long-run.
    3
      While complementarities prevail at the sectoral level, substitutabilities dominate across firms within
sectors. This implies that while nonlinearities tend to amplify negative sectoral-level shocks and to attenuate
positive sectoral-level shocks, they tend to attenuate negative firm-level shocks and to amplify positive firm-
level shocks. Nonlinearities therefore introduce an important qualitative difference between sectoral- and
firm-level shocks which is absent from the linearized perspective.

                                                       3
       costs of business cycles arising from nonlinearities in utility (risk aversion) identified
       by Lucas (1987).

   2. We derive and use a simple nonparametric formula, taking into account the observed
      change in the Domar weight for crude oil, to analyze the impact of the energy crisis of
      the 1970s up to the second order. We find that nonlinearities almost tripled the impact
      of the oil shocks from 0.23% to 0.61% of world aggregate output.

   3. We show that the nonlinearities are also important for long-run growth in the pres-
      ence of realistic complementarities across sectors. They cause the Domar weights
      of bottleneck sectors with relatively low productivity growth to grow over time and
      thereby reduce aggregate growth, an effect identified as Baumol’s cost disease (Bau-
      mol, 1967). We calculate that nonlinearities have reduced the growth of aggregate TFP
      by 20 percentage points over the period 1948-2014 in the US.4

    The outline of the paper is as follows. In Section 2, we derive a general formula describing
the second-order impact on aggregate output of shocks in terms of non-parametric sufficient
statistics: reduced-form general-equilibrium elasticities of substitution and input-output
multipliers.5 We explain the implications of this formula for the impact of correlated shocks
and for the average performance of the economy. In Section 3, we use two special illustrative
examples to provide some intuition for the roles of the general-equilibrium elasticities of
substitution and of the input-output multipliers and for their dependence on microeconomic
primitives. In Section 4, we fully characterize second-order terms in terms of microeconomic
primitives for general nested-CES economies with arbitrary microeconomic elasticities of
substitution and network linkages. In Section 5, we further generalize the results to arbitrary
(potentially non-CES) production functions. In Section 6, we provide some illustrations of
the quantitative implications of our results.


Related literature. Gabaix (2011) uses Hulten’s theorem to argue that the existence of very
large, or in his language granular firms, can be a possible source of aggregate volatility. If
   4
      The literature on structural transformation emphasizes two key forces: non-unitary elasticities of substitu-
tion and non-homotheticities. Both forces cause sales shares to change in response to exogenous shocks. Since
Hulten’s theorem implies that sales shares are equal to derivatives of the aggregate output function, anything
that causes the derivative to change is a non-linearity. By characterizing the second-order terms in a general
way, our results encompass both non-unitary elasticities and non-homotheticities. In fact, non-homotheticities
can always be turned into non-unitary elasticities of substitution by adding more fixed-factors to an economy.
    5
      Studying the second-order terms is the first step in grappling with the nonlinearities inherent in multisector
models with production networks. In this sense, our work illustrates the macroeconomic importance of local
and strongly nonlinear interactions emphasized in reduced form by Scheinkman and Woodford (1994). Other
related work on nonlinear propagation of shocks in economic networks includes Durlauf (1993), Jovanovic
(1987), Ballester et al. (2006) Acemoglu et al. (2015), Elliott et al. (2014), and especially Acemoglu et al. (2016).


                                                         4
there exist very large firms, then shocks to those firms will not cancel out with shocks to
much smaller firms, resulting in aggregate fluctuations. Acemoglu et al. (2012), working
with a Cobb-Douglas model in the spirit of Long and Plosser (1983), observed that in an
economy with input-output linkages, the equilibrium sizes of firms depend on the shape of
the input-output matrix. Central suppliers will be weighted more highly than peripheral
firms, and therefore, shocks to those central players will not cancel out with shocks to small
firms.6 Carvalho and Gabaix (2013) show how Hulten’s theorem can be operationalized to
decompose the sectoral sources of aggregate volatility.7
    Relatedly, Acemoglu et al. (2017) deploy Hulten’s theorem to study other moments
of the distribution of aggregate output. They argue that if the Domar weights are fat-
tailed and if the underlying idiosyncratic shocks are fat-tailed, then aggregate output can
exhibit non-normal behavior. Stated differently, they show that aggregate output can inherit
tail risk from idiosyncratic tail risk if the distribution of the Domar weights is fat-tailed.
Our paper makes a related but distinct point. We find that, for the empirically relevant
range of parameters, the response of aggregate output to shocks is significantly asymmetric.
Therefore, the nonlinearity inherent in the production structure can turn even symmetric
thin-tailed sectoral shocks into rare disasters endogenously. This means that the economy
could plausibly experience aggregate tail risk without either fat-tailed shocks or fat-tailed
Domar weights.
    In a recent survey article Gabaix (2016), invoking Hulten’s theorem, writes “networks
are a particular case of granularity rather than an alternative to it.” This has meant that
researchers studying the role of networks have either moved away from efficient models,
or that they have retreated from studying aggregate output and turned their attention to
the microeconomic implications of networks, namely the covariance of fluctuations between
different industries and firms.8,9 However, our paper shows that except in very special cases,
models with the same sales distributions but different network structures only have the same
   6
      A related version of this argument was also advanced by Horvath (1998), who explored this issue quanti-
tatively with a more general model in Horvath (2000). Separately, Carvalho (2010) also explores how the law
of large numbers may fail under certain conditions on the input-output matrix.
    7
      Results related to Hulten’s theorem are also used in international trade, e.g. Burstein and Cravino (2015),
to infer the global gains from international trade.
    8
      Some recent papers have investigated aggregate volatility in production networks with inefficient equi-
libria (where Hulten’s theorem does not hold). Some examples include Bigio and La’O (2016), Baqaee (2018),
Altinoglu (2016), Grassi (2017), and Baqaee and Farhi (2018c). See also Jones (2011), Jones (2013), Bartelme and
Gorodnichenko (2015), and Liu (2017).
    9
      Other papers investigate the importance of idiosyncratic shocks propagating through networks to generate
cross-sectional covariances, but refrain from analyzing aggregate output. Some examples include Foerster et al.
(2011), Atalay (2017), Di Giovanni et al. (2014), and Stella (2015), and Baqaee and Farhi (2018b). Atalay (2017)
is particularly relevant in this context, since he finds that structural elasticities of substitution in production
play a powerful role in generating covariance in sectoral output. Our paper complements this analysis by
focusing instead on the way complementarities affect aggregate output.


                                                        5
aggregate-output implications up to a fragile first-order of approximation. Their common
sales distribution produce the same linearization, but their different network structures lead
to different nonlinearities. Hence, in the context of aggregate fluctuations, networks are
neither a particular case of granularity nor an alternative to it. It is simply that the sales
distribution is a sufficient statistic for the network at the first order but not at higher orders.


2    General Framework
In this section, we set up a non-parametric general equilibrium model to demonstrate both
Hulten’s theorem as well as our second-order approximation. Final demand is represented
as the maximizer of a constant-returns aggregator of final demand for individual goods

                                      Y = max D(c1 , . . . , cN ),
                                               {c1 ,...,cN }


subject to the budget constraint

                                    N
                                    X                   F
                                                        X                 N
                                                                          X
                                             p i ci =           wf lf +         πi ,
                                      i=1                f =1             i=1


where ci is the representative household’s consumption of good i, pi is the price and πi is the
profit of producer i, w f is the wage of factor f which is in fixed supply l f . The two sides of
the budget constraint coincide wtih nominal GDP, using respectively the final expenditure
and income approaches.
   Each good i is produced by competitive firms using the production function

                                 yi = Ai Fi (li1 , . . . , liF , xi1 , . . . , xiN ),

where Ai is Hicks-neutral technology, xi j are intermediate inputs of good j used in the
production of good i, and li f is labor type f used by i. The profits earned by the producer of
good i are
                                               F
                                               X            N
                                                            X
                                  πi = pi yi −   w f li f −   p j xij .
                                                        f =1              j=1

    The market clearing conditions for goods 1 ≤ i ≤ N and factors 1 ≤ f ≤ F are

                                      N
                                      X                                         N
                                                                                X
                               yi =           x ji + ci         and   lf =             li f .
                                       j=1                                      i=1




                                                               6
Competitive equilibrium is defined in the usual way, where all agents take prices as given,
and markets for every good and every type of labor clears.
    We interpret Y as a cardinal measure of (real) aggregate output and note that it is the
correct measure of the household’s “standard of living” in this model. We implicitly rely
on the existence of complete financial markets and homotheticity of preferences to ensure
the existence of a representative consumer. Although the assumption of a representative
consumer is not strictly necessary for the results in this section, it is a standard assumption
in this literature since it allows us to unambiguously define and measure changes in real
aggregate output without contending with the issue of the appropriate price index.
    We assume that the production function Fi of each good i has constant returns to scale,
which implies that equilibrium profits are zero. This assumption is less restrictive than it
may appear because decreasing returns to scale can be captured by adding fixed factors to
which the corresponding profits accrue.10 A similar observation applies to the assumption
that shocks are Hicks-neutral: we can represent a productivity shock augmenting a specific
input by adding a new producer that produces this input and hitting this new producer with
a Hicks-neutral shock.11 Note also that although we refer to each producer as producing
one good, our framework actually allows for joint production by multi-product producers:
for example, to capture a producer i producing goods i and i0 using intermediate inputs
and factors, we represent good i0 as an input entering negatively in the production and cost
functions for good i.12 Finally, note that goods could represent different varieties of goods
from the same industry, goods from different industries, or even goods in different time
periods, regions, or states of nature.13
    Define Y(A1 , . . . , AN ) to be the equilibrium aggregate output as a function of the exoge-
nous technology levels. Throughout the paper, and without loss of generality, we derive
results regarding the effects of shocks in the vicinity of the steady state, which we normalize
  10
      Our formulas can also in principle be applied with increasing-returns to scale under the joint assumption
of marginal-cost pricing and impossibility of shutting down production, by simply adding producer-specific
fixed factors with negative marginal products and negative payments (these factors are “bads” that cannot be
freely disposed of).
   11
      Shocks to the composition of demand can be captured in the same way via a set of consumer-specific
productivity shocks. For example, if the final demand aggregator is CES with an elasticity strictly greater
than one, an increase in consumer demand for i can be modeled as a positive consumer-specific productivity
shock to i and a set of negative consumer-specific productivity shocks to all other final goods such that the
consumption-share-weighted sum of the shocks is equal to zero. The sign of the shocks must be reversed if
the elasticity of substitution is strictly lower than one, and the Cobb-Douglas case can be treated as a limit.
These constructions generalize beyond the CES case. Hulten’s theorem implies that shocks to the composition
of demand have no first-order effect on aggregate output, but in general, they have nonzero second-order (and
more generally nonlinear) effects.
   12
      To satisfactorily capture such features, one probably needs to go beyond the nested-CES case of Section 4
and use instead the non-parametric generalization to arbitrary economies provided in Section 5.
   13
      If we apply the model to different periods of time and states of nature, then Y corresponds to an intertem-
poral aggregate consumption index reflecting intertemporal welfare.


                                                       7
to be (A1 , . . . , AN ) = (1, . . . , 1). All the relevant derivatives are evaluated at that point.

Theorem 1 (Hulten 1978). The first-order macroeconomic impact of microeconomic shocks is given
by:14
                                                    d log Y
                                                             = λi ,                              (1)
                                                   d log Ai
where λi = pi yi /( Nj=1 p j c j ) the sales of producer i as a fraction of GDP or Domar weight.
                   P


    Hulten’s theorem can be seen as a consequence of the first welfare theorem: since this
economy is efficient, Y(A1 , . . . , AN ) is also the social planning optimum and prices are the
multipliers on the resource constraints for the different goods. Applying the envelope
theorem to the social planning problem delivers the result.
    Hulten’s theorem has the powerful implication that, to a first-order, the underlying mi-
croeconomic details of the structural model are completely irrelevant as long as we observe
the equilibrium sales distribution: the shape of the production network, the microeconomic
elasticities of substitution in production, the degree of returns to scale, and the extent to
which inputs and factors can be reallocated, are all irrelevant.
    We now provide a characterization of the second-order effects in terms of reduced-
form elasticities. We need to introduce two objects: GE elasticities of substitution, and the
input-output multiplier. Later on, we show how these reduced-form elasticities arise from
structural primitives using a structural model.
    We start by introducing the GE elasticities of substitution. Recall that for any homoge-
neous of degree one function f (A1 , . . . , AN ), the Morishima (1967) elasticity of substitution
is
                                 1      d log(MRS ji )     d log( f j / fi )
                                      =                  =                   ,
                                ρ ji     d log(Ai /A j )   d log(Ai /A j )
where MRSij is the ratio of partial derivatives with respect to Ai and A j , and fi = d f / d Ai .15
    When the homothetic function f corresponds to a CES utility function and Ai to quantities,
ρij is the associated elasticity of substitution parameter. However, we do not impose this
interpretation, and instead treat this object as a reduced-form measure of the curvature of
isoquants. By analogy, we define a pseudo elasticity of substitution for non-homothetic
functions in a similar fashion.
  14
     In the special case where Ai is a factor-augmenting shock, the relevant λi corresponds to a producer’s bill
for this factor as a share of GDP. This is because if we relabel the labor input of producer i as a new producer,
we can represent a factor-augmenting shock to i’s labor as a Hicks-neutral shock to this new producer.
  15
     This is a generalization of the two-variable elasticity of substitution introduced by Hicks (1932) and
analyzed in detail by Blackorby and Russell (1989).




                                                       8
Definition 1. For any smooth function f : RN → R, the pseudo elasticity of substitution is

                                     1      d log(MRS ji ) d log( f j / fi )
                                          ≡               =                  .
                                     ρ ji      d log Ai      d log Ai

    The pseudo elasticity of substitution is a generalization of the Moroshima elasticity of
substitution in the sense that whenever f is homogenous of degree one, the pseudo elasticity
is the same as the Moroshima elasticity of substitution.
    When applied to the equilibrium aggregate output function of a general equilibrium
economy, we call the pseudo elasticity of substitution the general equilibrium pseudo elasticity
of substitution or GE elasticity of substitution for short. The GE elasticity of substitution ρ ji is
interesting because it measures changes in the relative sales shares of j and i when there is
an exogenous shock to i. This follows from the fact that

                  d log(λi /λ j ) d log[(Yi Ai )/(Y j A j )]     d log(Yi /Y j )    1
                                 =                           =1+                 =1− ,
                    d log Ai            d log Ai                    d log Ai        ρ ji

where the first equality applies Hulten’s theorem. A decrease in the productivity of i causes
λi /λ j to increase when ρ ji ∈ (0, 1), and to decrease otherwise. We say that a j is a GE-
complement for i if ρ ji ∈ (0, 1), and a GE-substitute otherwise. When f is a CES aggregator,
this coincides with the standard definition of gross complements and substitutes. As usual,
when f is Cobb-Douglas, i and j are neither substitutes nor complements. In general,
GE-substitutability is not reflexive.
    An important special case is when the shock d log A f hits the stock of a factor. In that
case, Hulten’s theorem implies that d log Y/ d log A f = Λ f , where Λ f = w f l f /( Nj=1 p j c j ) is the
                                                                                     P

share of factor f in GDP. Since Ff=1 w f l f = GDP, Euler’s theorem implies that the aggregate
                                   P

output is homogenous of degree one in the supplies of the factors. This implies that the
general equilibrium pseudo elasticity of substitution between two factors can be interpreted
as a genuine elasticity of substitution between these factors in general equilibrium.16
    Next,we introduce the input-output multiplier.

Definition 2. The input-output multiplier is

                                              N              N
                                             X   d log Y X
                                          ξ≡              =     λi .
                                             i=1
                                                 d log Ai   i=1
  16
     The difference between an elasticity of substitution and a pseudo elasticity of substitution is that the former
is the elasticity of the ratio of marginal rates of substitution with respect to the ratio of two arguments, whereas
the latter is the elasticity of marginal rates of substitution with respect to an argument. The two definitions are
equivalent whenever the function they are applied to is homogeneous of degree one.




                                                         9
    When ξ > 1, total sales of the shocked quantities exceed total income: an indication that
there are intermediate inputs. When ξ > 1, the impact of a uniform technology shock is
correspondingly amplified due to the fact that goods are reproducible. The input-output
multiplier ξ captures the percentage change in aggregate output in response to a uniform
one-percent increase in technology. Loosely speaking, it captures a notion of returns-to-
scale at the aggregate level. Changes d log ξ/ d log Ai in the input-output multiplier can
be interpreted as another kind of GE elasticity of substitution: namely the substitution
between the underlying factors (whose payments are GDP) and the reproducible goods
(whose payments are sales).17
    Having defined the GE elasticities of substitution and the input-output multiplier, we
are in a position to characterize the second-order terms. We start by investigating the impact
of an idiosyncratic shock.


Idiosyncratic Shocks
Theorem 2 (Second-Order Macroeconomic Impact of Microeconomic Shocks). The second-
order macroeconomic impact of microeconomic shocks is given by18

                        d2 log Y     d λi     λi X                        d log ξ
                                                                   !
                                                              1
                                 =          =          λj 1 −        + λi          .                           (2)
                               2
                        d log Ai   d log Ai   ξ 1≤ j≤N        ρ ji        d log Ai
                                                          j,i


   The second-order impact of a shock to i is equal to the change in i’s sales share λi .
The change in i’s share of sales is the change in the aggregate sales to GDP ratio, minus
the change in the share of sales of all other industries. The former is measured by the
  17
      The input-output multiplier is called the intermediate input multiplier in a stylized model by Jones (2011),
but it also appears under other names in many other contexts. It is also related to the network influence
measure of Acemoglu et al. (2012), the granular multiplier of Gabaix (2011), the international fragmentation
measure of Feenstra and Hanson (1996), the production chain length multiplier in Kim et al. (2013), and
even the capital multiplier in the neoclassical growth model since capital can be trated as an intertemporal
intermediate input. It also factors into how the introduction of intermediate inputs amplifies the gains from
trade in Costinot and Rodriguez-Clare (2014). Although these papers feature multiplier effects due to the
presence of round-about production (either via intermediate inputs or capital), they do not take into account
the fact that this multiplier effect can respond to shocks. This is either because they assume Cobb-Douglas
functional forms or because they focus on first-order effects.
   18
      In the case where shocks are factor-augmenting, the aggregate output function is homogeneous of degree
1 and the formula becomes
                                       d2 log Y
                                                                                  !
                                                           X                1
                                                   = λi f       λ jg 1 −            ,
                                       d log A2i f                       ρ jg,i f
                                                          1≤j≤N
                                                        1≤g≤F
                                                     ( j,g),(i, f )

where Ai f is a shock augmenting factor f in the production of good i, λi f is the share of factor f in GDP arising
from its use by producer i, and ρ jg,i f is the GE elasticity of substitution between factor f in the production of
good i and factor g in the production of good j.

                                                         10
elasticity of the input-output multiplier ξ, while the latter depends on the GE elasticities
of substitution. Collectively, the sales shares λi , the reduced-form elasticities ρ ji , and the
reduced-form elasticity of the input-output multiplier d log ξ/ d log Ai are sufficient statistics
for the response of how aggregate output to to productivity shocks up to a second order.
    This result implies that Hulten’s first-order approximation is globally accurate if reduced-
form elasticities are unitary ρ ji = 1 for every j and if the input-output multiplier ξ is
independent of the shock Ai . We shall see that this amounts to assuming Cobb-Douglas
production and consumption functions where sales shares and more generally the whole
input-output matrix are constant. The model is then log-linear.
    Outside of this special case, there are nonlinearities, and the quality of the first-order
approximation deteriorates as the shocks become bigger. The deterioration can be extreme,
with the aggregate output function becoming nearly non-smooth, when ρ ji approaches 0
for any j, either from above or from below. As we shall see, these arise in the cases of
extreme microeconomic complementarities with no reallocation or extreme microeconomic
substitutabilities with full reallocation. In these limiting cases, the first-order approximation
is completely uninformative, even for arbitrarily small shocks. Similar observations apply
when d log ξ/ d log Ai approaches infinity. Therefore, although the Cobb-Douglas special
case is very popular in the literature, it constitutes a very special case where the second-order
terms are all identically zero.19
    The second-order approximation

                                                             2
                                        d log Y           1 d log Y
                        log Y ≈ log Y +          log Ai +             (log Ai )2
                                        d log Ai          2 d log A2i

of the aggregate output function with respect to the productivity of producer i can then be
written as

                                   1 λi X                         2 1 d log ξ
                                                          !
                                                     1                                2
       log Y ≈ log Y + λi log Ai +            λj 1 −        log Ai + λi         log Ai ,
                                   2 ξ 1≤ j≤N        ρ ji            2 d log Ai
                                            j,i


where Y is Y evaluated at the steady-state technology values. When goods are GE-
complements, the second-order terms amplify the effect of negative shocks and attenuate
the effect of positive shocks relative to the first-order approximation. Instead when goods
are GE-substitutes, the second-order approximation attenuates the negative shocks and am-
plifies the positive shocks instead. A similar intuition holds for the input-output multiplier:
if the input-output multiplier is increasing, then the second-order approximation amplifies
  19
    See for example Acemoglu et al. (2012), Long and Plosser (1983), Bigio and La’O (2016), Acemoglu et al.
(2017), Bartelme and Gorodnichenko (2015).

                                                    11
positive shocks and dampens negative shocks, and if this multiplier is decreasing, then the
opposite is true.


Correlated Shocks
To compute the second-order approximation

                X d log Y               X 1 d2 log Y                             d2 log Y
                                                                  2 1
                                                                        X
log Y ≈ log Y+                log Ai +                 2
                                                         (log Ai ) +                            log Ai log A j
               1≤i≤N
                     d log Ai
                                       1≤i≤N
                                             2 d log A i
                                                                     2 1≤i≤N
                                                                             d log A j d log Ai
                                                                          1≤ j≤N
                                                                            i, j


of the aggregate production function with respect to to shocks to several producers at once
we must extend these results to cover the off-diagonal terms in its the Hessian.

Proposition 3 (Correlated Shocks). The second-order macroeconomic impact of correlated microe-
conomic shocks is given by

       d2 log Y         d λi      λi X                    d log ξ
                                                   !                              !
                                               1                             1
                     =          =      λk 1 −        + λi           − λi 1 −        .             (i , j)   (3)
   d log A j d log Ai d log A j   ξ           ρk j        d log A j          ρi j
                                          1≤k≤N
                                           k, j


    The second-order effect of a common shock to i and j is not simply the sum of the second-
order impacts of the idiosyncratic shocks to i and to j, and instead there are interactions
between the two shocks.20 In Section 4, we provide an explicit characterization of the Hessian
in terms of microeconomic primitives.


Macro Moments
We can use the second-order terms to approximate an economy’s macroeconomic moments.
To illustrate this intuition while preserving expositional simplicity, we consider shocks to a
single producer i which are lognormal with mean log 0 and variance σ2 .21
    We first consider average log aggregate output µY , for which a Taylor approximation
  20
      We can also use these ideas to capture the impact of an aggregate shock to the economy, since an aggregate
shock is simply a common shock that affects all industries. If A is an aggregate productivity shock, then
d2 log Y          d log ξ
         = ξ Ni=1 d log Ai . So, for aggregate shocks, deviations from Hulten’s theorem can only come from the
            P
d log A2
input-output multiplier.
   21
      In Appendix E, we include the approximation equations for mean, variance, and skewness for multivariate
shocks.




                                                      12
yields
                                                                                      
                                                                                     
                                2
                                           1  λi                                 ξ
                                                                     !
                            1 d   log Y          X            1           d  log      
         µY = E(log(Y/Y)) ≈             σ = 
                                         2
                                                         λj 1 −        + λi                σ .
                                                                                          2
                                           2  ξ 1≤ j≤N        ρ ji
                                                
                            2 d log Ai2                                     d log Ai 
                                                                                          
                                                               j,i


Average log aggregate output can be nonzero even though the technology shocks have
zero log average, and it has the same sign as the second-order term. For example, when
the second-order terms is negative, corresponding to GE-complementarities, average log
aggregate output is lower than its deterministic steady state because nonlinearities magnify
negative shocks and attenuate positive shocks.
   Second-order terms also shape higher moments of the distribution of aggregate output.
The variance is given by
                                                                 µ 2 !
                                                                     Y
                         σ2Y = Var(log(Y/Y)) ≈ λ2i + 2                     σ2 ≥ λ2i σ2 ,
                                                                     σ

where the right-hand side is the variance of the log-linear approximation. This shows that
nonlinearities tend to increase the implied variance of aggregate output.
   Similarly, the skewness is given by
                                                   3 
                                  log(Y/Y) − µY   2µY                 
                            E                   ≈     4µY + 3λ   σ
                                                                           2 2
                                                                                 .
                                           σY               σ3Y          i



For example, when the second-order term is negative, the distribution of aggregate output
is skewed to the left since nonlinearities magnify negative shocks and attenuate positive
shocks, even though the technology shocks are symmetric. Typical negative deviations of
aggregated output are then larger than typical positive deviations.
    Finally, the kurtosis is given by
                                         4                                          
                        log(Y/Y) − µY                µ 2 22(µY /σ) + 7λi 
                                                                             2       2
                                             ≈ 3 1 + Y 
                                                         
                  E                                                          2  ≥ 3.
                                 σY                        σ     λi + 2(µY /σ) 
                                                                      2           2



Aggregate output has excess kurtosis when second-order terms are nonzero. For example,
when the second-order term is negative, the left tail is fattened because negative shocks
are magnified, and this gives rise to excess kurtosis, even though the technology shocks are
symmetric and thin-tailed. A higher share of the variance is then due to negative, infrequent,
extreme deviations, as opposed to symmetric, frequent, and modestly sized deviations.


                                                      13
   The importance of all these effects increases with the variance σ2 of the shocks because
they are driven by nonlinearities, and because the importance of nonlinearities increases
with the size of the shocks.


Welfare Costs of Sectoral Shocks
For the majority of the paper, we focus on log aggregate output, which can be characterized
with unitless elasticities. With complementarities, we have argued that sector shocks lower
the mean of log aggregate output, an effect which we can interpret as the welfare cost of
sectoral shocks. One may imagine that the losses from uncertainty that we identify depend
on the concavity of the log function. A consumer with log utility prefers a mean-preserving
reduction in uncertainty even when the aggregate output function is linear. However,
as shown by Lucas (1987), the corresponding losses are extremely small in practice in
business-cycle settings. The much larger effects that we identify originate in nonlinearities
in production, and they are present even when the utility function is linear in aggregate
consumption.
    The following proposition formalizes this intuition and shows that the Lucas-style wel-
fare losses due to nonlinearities in the utility function in the form of risk-aversion and the
losses due to nonlinearities in production do not interact with one-another up to a second-
order approximation.22

Proposition 4 (Welfare Cost of Sectoral Shocks). Let u : R → R be a utility function and let
Y : RN → R be the aggregate output function. Suppose that productivty shocks have mean 1 and a
diagonal covariance matrix with kth diagonal element σ2k . Then
                                                       N            N
                                                                                 
                        u0 (Y)                  Y  X 2 2 X d2 Y 2 
                                E(u(Y)) − u(Y) ≈ − γ     λk σk +           σ  ,
                                                                            2 k
                                                                                                                   (4)
                          Y                       2                     d A k
                                                        k=1         k=1


where γ is the coefficient of relative risk aversion at the deterministic steady-state Y.

   The first term on the right-hand side, which is quantitatively small, is the traditional
Lucas-style cost arising from curvature in the utility function. The second term, which is
quantitatively large, is due to the curvature inherent in production and does not depend on
the coefficient of relative risk aversion.23
  22
      In fact, it could easily be the case that a risk-averse household prefers the economy to be subject to stochastic
shocks if the economy features macro-substitutability and the second-order terms are positive, which happens
in the presence of GE-substitutability.
   23
      Proposition 4 is stated idiosyncratic shocks for expositional clarity. In Appendix A, we prove the result
for more general utility functions and shocks. For our theoretical results, we find it convenient work with
elasticities d2 log Y/ d log A2k , but we can use these results to compute the welfare cost in Proposition 4 by noting


                                                          14
Mapping From Micro to Macro
Theorem 2 implies that the GE elasticities of substitution ρi j and the elasticity of the input-
output multiplier d log ξ/ d log Ai are sufficient statistics for the second-order impact of
shocks. However, these sufficient statistics are reduced-form elasticities, and unlike λi and
ξ, they are not readily observable. Furthermore, since they are general equilibrium objects,
they cannot be identified through exogenous microeconomic variation. So, while careful
empirical work can identify micro-elasticities, the leap from micro-estimates to macro-effects
can be hazardous.
    In this paper, we provide the mapping from structural micro parameters to the reduced-
form GE elasticities. This general characterization can be found in Section 4 for general
nested-CES economies, and in Section 5 for arbitrary economies. However, rather than stat-
ing these results up front, we build up to the general characterization using some important
special cases in Section 3.


3     Illustrative Examples
In this section, we work through two special cases to illustrate and isolate some intuition for
how the GE elasticities of substitution and the input-output multiplier affect the shape of
the aggregate output function. After working through these examples, we provide a generic
characterization of the second-order terms in Section 4 and 5.


3.1     GE Elasticities of Substitution
To start with, we focus on the GE elasticities of substitution by considering a simple example
of a horizontal economy with no intermediate inputs. The input-output multiplier is constant
and equal to one, and so deviations from Hulten’s theorem are only due to non-unitary GE
elasticities of substitution. We emphasize how the GE elasticities of substitution depend
not only on the micro elasticities of substitution, but also on the degree to which labor can
be reallocated across uses and on the returns to scale in production. Throughout all the
upcoming examples, variables with overlines denote steady-state values.
    There are N goods produced using the production functions
                                                         1−ωg  ωg
                                              yi         lis   lig 
                                                 = Ai  i       ,
                                              yi
                                                                     
                                                           lis
                                                            i
                                                                      lig

that d2 Y/ d A2k = Y d2 log Y/ d log A2k − Yλk (1 − λk ).




                                                            15
where lisi and lig are the amounts of the specific and general labor used by producer i. The
specific labor of type i can only be used by producer i and the general labor can be used by
all producers.
    The household’s consumption function is
                                                                  θ0
                                                        θ0 −1  θ −1
                                              N        !          0
                                       Y X      ci θ0 
                                        =     ω0i                 ,
                                       Y  i=1      ci          


where θ0 is the microeconomic elasticity of substitution in consumption and N       i=1 ω0i = 1.
                                                                                  P

   The specific labors and the general labor are in fixed supplies at lsi = lisi and l g = N
                                                                                          P
                                                                                             i=1 lig .
The market-clearing conditions are

                                                                             N
                                                                             X
                               ci = y i ,   lsi = lisi ,        and   lg =         lig .
                                                                             i=1


    Different degrees of labor reallocation can be expected depending on the degree of
aggregation. The the time horizon is also important since we might expect labor to be more
difficult to adjust at short horizons than at long horizons. Some of these dynamic effects can
be captured by performing comparative statics with respect to ω g , where ω g = 0 represents
an economy where labor cannot be reallocated, and ω g = 1 an economy where labor can be
fully reallocated.

Proposition 5. In the horizontal economy, the sales shares are given by λi = ω0i , the input-output
multiplier is constant with ξ = 1 and d log ξ/ d log Ai = 0. The GE elasticities of substitution are
all equal and are given by
                                               θ0 (1 − ω g ) + ω g
                              ρ ji = ρ =                                 .
                                         θ0 (1 − ω g ) + ω g + (1 − θ0 )
The second-order macroeconomic impact of microeconomic shocks is given by

                             d2 log Y      d λi
                                                                       !
                                                                     1
                                       =          = λi (1 − λi ) 1 −     .
                             d log A2i   d log Ai                    ρ

   To build intuition, we consider the polar cases with no-reallocation where ω g = 0 and
with full reallocation where ω g = 1. We start with the no-reallocation case where ω g = 0.
Because labor cannot be moved across producers, it is as if there were a fixed endowment




                                                           16
of each good and so aggregate output is given by:

                                                               θ0
                                                        θ0 −1  θ0 −1
                                             N
                                      Y   X
                                                         θ 
                                        =      ω0i Ai 0        .
                                      Y       i=1


The GE elasticities of substitution and the microeconomic elasticities of substitution coincide
so that ρ = θ0 . Since θ0 ∈ [0, ∞) we have ρ ∈ [0, ∞). The second-order macroeconomic impact
of microeconomic shocks is given by

                           d2 log Y      d λi
                                                              
                                                                   1
                                                                      
                                     =          = λi (1 − λi ) 1 −      .
                           d log A2i   d log Ai                    θ0

    In the Cobb-Douglas case θ0 = 1, second-order terms are identically equal to zero and
the first-order approximation of Hulten’s theorem is globally accurate. The quality of the
first-order approximation deteriorates as we move away from θ0 = 1 in both directions.
The second-order term is negative when θ0 < 1 and positive when θ0 > 1. Relative to the
first-order approximation, the second-order approximation amplifies negative shocks and
mitigates positive shocks in the former case and the reverse the latter case.
    To build intuition, it is useful to inspect how the relative sales share λi /λ j of i versus j
changes in response to a shock to i:

      d log(λi /λ j ) d log(pi /p j ) d log(yi /y j ) d log(pi /p j ) d log(Ai /A j )    1
                     =               +               =               +                =1− .
        d log Ai        d log Ai        d log Ai        d log Ai         d log Ai        θ0

    Because there is no reallocation, the relative quantity yi /y j moves one-for-one with the
shock to i. In the Cobb-Douglas case θ0 = 1, the relative price pi /p j moves one-for-one
in the opposite direction, and so the relative share λi /λ j remains constant. When θ0 < 1,
the relative price moves more than one-for-one with the shock, and so the relative share
increases when the shock is negative, and increases when it is positive. When θ0 > 1, the
relative price moves less than one-for-one with the shock, and so the relative share decreases
when the shock is negative, and increases when it is positive.
    Consider the Leontief limit θ0 → 0. In this limit, deviations from the first-order ap-
proximation become so large that the first-order term becomes completely uninformative.
Following a negative shock to i, the relative price pi /p j jumps to infinity, and so does the
relative share λi /λ j . Following a positive shock, the relative price jumps to zero and so
does the relative share. The associated amplification of negative shocks and mitigation of
negative shocks is extreme.
    Let us now consider the perfect-substitutes limit θ0 → ∞. Positive shocks are amplified


                                                    17
             0.06                                                                            0.08

             0.04                                                                            0.06

             0.02
                                                                                             0.04
               0
 log(Y/Y)




                                                                                log(Y/Y)
                                                                                             0.02
            −0.02
                                                                                               0
            −0.04
                                                                                            −0.02
            −0.06
                                              Leontief                                                                                 Leontief
            −0.08                             Hulten/Cobb-Douglas                           −0.04                                      Hulten/Cobb-Douglas
                                              Perfect Substitutes                                                                      Perfect Substitutes
             −0.1                                                                           −0.06
               −0.15   −0.1   −0.05     0       0.05     0.1        0.15                       −0.15            −0.1   −0.05     0       0.05     0.1        0.15
                                      log A                                                                                    log A

(a) log aggregate output with no realloca- (b) log aggregate output with full realloca-
tion/extreme decreasing returns. Perfect substi- tion/constant returns. Leontief and Hulten’s ap-
tutes and Hulten’s approximation overlap almost proximation overlap almost perfectly.
perfectly.

Figure 1: log aggregate output as a function of productivity log Ai in the economy with
full reallocation/constant returns for different values of θ0 . This example consists of two,
equally, sized industries using labor as their only input. The economies depicted in Figures
1a and 1b are all equivalent to a first-order.


and negative shocks are mitigated, but the effect is not nearly so dramatic. In fact, because
goods are perfect substitutes, the relative price pi /p j is constant. Therefore, the relative share
λi /λ j moves one-for-one with the shock to i. The situation is depicted graphically in Figure
1a.
    Having analyzed the case with no labor reallocation, we now consider the polar opposite
case, where labor can be costlessly reallocated across producers and can be used with
constant returns to scale so that ω g = 1. Solving out the allocation of labor to each producer
and replacing leads to the following expression for aggregate output:

                                                               PN                                  θθ−1
                                                                                                       0
                                                                                           θ0 −1
                                                       Y            i=1   ω0i Ai                     0

                                                          =                                                 .
                                                                            ω0i Aθi 0 −1
                                                                 PN
                                                       Ȳ             i=1


In this case, the GE elasticities of substitution do not typically coincide with the structural
microeconomic elasticity of substitution since we have ρ = 1/(2−θ0 ). Because θ0 ∈ [0, ∞), we
have ρ ∈ (−∞, 0) ∪ [1/2, +∞). The second-order macroeconomic impact of microeconomic
shocks is given by
                            d2 log Y      d λi
                                    2
                                      =          = λi (1 − λi ) (θ0 − 1) .
                            d log Ai    d log Ai
            As above, in the Cobb-Douglas case θ0 = 1, second-order terms are identically equal to

                                                                           18
zero and the first-order approximation of Hulten’s theorem is globally accurate. The second-
order term is negative when θ0 < 1 and positive when θ0 > 1. Relative to the first-order
approximation, the second-order approximation amplifies negative shocks and mitigates
positive shocks in the former case and the reverse the latter case. However, this time, the
second-order term becomes singular when the goods are highly substitutable rather than
when they are highly complementary.
   Once again, we can unpack this result by noting that

       d log(λi /λ j ) d log(pi /p j ) d log(yi /y j ) d log(A j /Ai ) d log(yi /y j )
                      =               +               =               +                = θ0 − 1.
         d log Ai        d log Ai        d log Ai         d log Ai       d log Ai

Because labor can be costlessly reallocated across producers, the relative price pi /p j always
moves inversely one-for-one with the shock to i. In the Cobb-Douglas case, the relative
quantity yi /y j moves one for one with the shock to i, and the relative share λi /λ j remains
constant. When θ0 < 1, the relative quantity moves less than one-for-one with the shock as
labor is reallocated towards i if the shock is negative and away from i if the shock is positive.
As a result, the relative share increases when the shock is negative, and increases when it
is positive. When θ0 > 1, relative quantity moves more than one-for-one with the shock as
labor is reallocated away from i when the shock is negative and towards i when it is positive.
As a result, the relative share decreases when the shock is negative, and increases when it is
positive.
    Contrary to what one may have assumed, a near-Leontief production function is not
sufficient for generating large deviations from Hulten’s theorem, as long as factors can
be reallocated freely, precisely because this reallocation is successful at reinforcing “weak
links”. In the Leontief limit, the relative quantity yi /y j is invariant to the shock, and so the
relative sales share λi /λ j moves inversely one-for-one with the shock to i. Relative to the
first-order approximation, the second-order approximation still amplifies negative shocks
and mitigates positive shocks, but the corresponding magnitudes are much smaller than in
the case where labor cannot not be reallocated.
    In the perfect-substitutes limit, labor is entirely allocated to the most productive producer.
In response to a positive shock to i, the relative quantity yi /y j jumps to infinity, and so does
the relative share λi /λ j . In response to a negative shock, the relative quantity drops to
zero, and so does the relative share. Relative to the first-order approximation, the second-
order approximation still amplifies positive shocks and mitigates negative shocks, but the
corresponding magnitudes are now much larger than in the case where labor cannot not be
reallocated. The situation is depicted graphically in Figure 1b.
    Finally, note that both when labor can or cannot be reallocated, the second-order term
scales in λi (1 − λi ) as a function of the size λi of the shocked producer i. Its absolute value is

                                                  19
therefore hump-shaped in λi : it goes zero when λi is close to 0 or 1, and reaches a maximum
when λi is intermediate at 1/2. That the term is small when λi is close to 0 is intuitive. That
it is small when λi is close to 1 makes sense since the then economy behaves much like
producer i and aggregate output is then close to being proportional to Ai . The second-order
term can only be significant for intermediate values of λi .
    To recap, with complementarities: a negative shock can cause a large downturn when
labor cannot be freely re-allocated, but the ability to re-allocate labor largely mitigates these
effects; positive shocks have a lesser impact. By contrast, with substitutabilities: a positive
shock can cause a big boom when labor can be re-allocated, but the inability to re-allocated
labor mitigates these effects; negative shocks have a lesser impact. Cobb-Douglas stands
as a special case where the macroeconomic impact of microeconomic shocks is symmetric
independently of whether or not labor can be reallocated (since the equilibrium allocation
of labor across producers is constant even when labor can be re-allocated).24 These effects
are less pronounced when the size of the shocked producer is very small or very large, and
are more pronounced when it is intermediate.


3.2    Input-Output Multiplier
In the previous example of a horizontal economy, the input-output multiplier ξ is constant
and deviations from Hulten’s theorem are due to non-unitary GE elasticities of substitution.
We now focus on a different example, that of a roundabout economy, where deviations from
Hulten’s theorem are driven purely by variability in ξ, and the GE elasticities of substitution
play no role.
    The economy has a single good and single factor. Gross output is given by
                                                                                      θ1
                                               ! θθ1 −1                 ! θθ1 −1  θ1 −1
                              y1            l1 1                     x1 1 
                                 = A1 ω1l             + (1 − ω1l )                      ,
                                        
                                                                                   
                              y1            l1                       x1            

where x1 is the amount of good 1 used as an intermediate input.The supply of the factor is
inelastic at l = l1 . Final output Y = c1 is produced one-to-one from good 1.
   The market-clearing conditions are

                                          y1 = c1 + x1        and     l = l1 .
  24
     These results are closely related to the findings in Jones (2011), who noted that the relevant CES parameter
used in aggregating microeconomic productivity shocks depends on whether or not factors are allocated
through the market or assigned exogenously.




                                                           20
       The steady-state input-output multiplier

                               ξ = 1 + (1 − ω1l ) + (1 − ω1l )2 + . . . = 1/ω1l

decreases with the labor share ω1l and increases with the intermediate input share 1 − ω1l .
Hulten’s theorem implies that
                                        d log Y
                                                = ξ,
                                       d log A1
so that the first-order impact of the shock increases with the steady-state input-output
multiplier ξ.

Proposition 6 (Variable IO multiplier). In the roundabout economy, the input-output multiplier
is given by ξ = 1/ω1l and its elasticity is given by25

                                        d log ξ
                                                 = (ξ − 1)(θ1 − 1).
                                        d log A1

The second-order macroeconomic impact of microeconomic shocks is given by

                                 d2 log Y           dξ
                                             =            = ξ(ξ − 1)(θ1 − 1).
                                 d log A21       d log A1

    Hulten’s approximation is exact only when there are no intermediate inputs so that ξ = 1
or when the economy is Cobb-Douglas so that θ1 = 1. Otherwise, the second-order term is
increasing in θ1 − 1 and in a network term ξ(ξ − 1).26
    Intuitively, this results from the fact that output is used as its own input. When θ1 = 1,
the input-output multiplier remains constant. When θ1 < 1, the input-output multiplier
increases if the shock is negative, and decreases if it is positive. When θ1 > 1, the input-
output multiplier decreases if the shock is negative, and increases if it is positive. The larger
is the steady-state input-output multiplier, the larger is the effect.
    Figure 2 plots log Y as a function of log A1 for the case where θ1 ≈ 0, θ1 = 1, and θ1 = 2.
In the limit θ1 → 0, output is linear in productivity (rather than loglinear) with slope 1/ω1l .
When θ1 = 2, output is hyperbolic in productivity.27
  25
      Proposition 6 shows that even though the gross production function is homogenous in productivity,
aggregate net output (value added) is not homogeneous of degree 1. Furthermore, aggregate output is not
homogenous of any degree in equilibrium, since ξ varies in response to the shock.
   26
      There is no closed-form solution for equilibrium aggregate output in this case.
   27
      In this example, when θ1 = 0, we have Y = A/ω1l , where 1/ω1l is the steady-state input-output multiplier.
Therefore, although Hulten’s approximation fails in log terms, Hulten’s theorem is globally accurate in linear
terms. This is a consequence of the fact that there is only one good. In Appendix B, we generalize this example
to multiple goods, and show that output can be very strongly nonlinear even with full labor reallocation.



                                                       21
                                            4


                                            2


                                            0




                               log(Y/Y)
                                          −2


                                          −4


                                          −6

                                                                           Leontief
                                          −8                               Hulten/Cobb-Douglas
                                                                           θ1 = 2
                                          −10
                                           −0.15   −0.1   −0.05            0        0.05         0.1
                                                                  log A1


Figure 2: Output as a function of productivity shocks log A1 with variable input-output
multiplier effect with steady-state input-output multiplier ξ = 10.


4        General Nested-CES Networks
We now characterize the second-order terms for a general nested-CES economy (encom-
passing the examples in Section 3). Throughout this section, variables with over-lines are
normalizing constants equal to the values in steady-state.28
    Any nested-CES economy with a representative consumer, an arbitrary numbers of nests,
elasticities, and intermediate input use, can be re-written in what we call standard form, which
simply means that each CES aggregator corresponds to a node in the production network
with a one node-specific elasticity of substitution. Through a relabelling, this structure
can represent any nested-CES economy with an arbitrary pattern of nests and elasticities.
Intuitively, by relabelling each CES aggregator to be a new producer, we can have as many
nests as desired.
    Formally, a nested-CES economy in standard form is defined by a tuple (ω, θ, F) and a
set of normalizing constants (y, x). The (N + 1 + F) × (N + 1 + F) matrix ω is a matrix of
input-output parameters where the first row and column correspond to household sector,
the next N rows and columns correspond to reproducible goods and the last F rows and
columns correspond to factors. What distinguishes factors from goods is that factors cannot
be produced. The (N + 1) × 1 vector θ is a vector of microeconomic elasticities of substitution.
For convenience we use number indices starting at 0 instead of 1 to describe the elements of
ω and θ.29
    28
     Since we are interested in log changes, the normalizing constants are irrelevant. We use normalized
quantities since it simplifies calibration, and clarifies the fact that CES aggregators are not unit-less.
  29
     We impose the restriction that ωij ∈ [0, 1], N+F
                                                    j=1 ωi j = 1 for all 0 ≤ i ≤ N, ω f j = 0 for all N + 1 ≤ f ≤ N + F,
                                                  P
ω0 f = 0 for all N + 1 ≤ f ≤ N + F, and ωi0 = 0 for all 0 ≤ i ≤ N.



                                                            22
   The F factors are modeled as non-reproducible goods and the production function of
these goods are endowments
                                       yf
                                          = 1.
                                       yf
The other N + 1 other goods are reproducible with production functions
                                                                                θi
                                                                      θi −1  θ −1
                                                       N+F           !          i
                                          yi       X          xi j θi 
                                             = Ai        ωi j               ,
                                                                           
                                          yi         
                                                       j=1
                                                                xi j          

where xij are intermediate inputs from j used by i. Producer 0 represents final-demand and
its production function is the final-demand aggregator so that

                                                           Y         y0
                                                                =       ,
                                                           Y         y0

where Y is aggregate output and y0 is the final good.
  The market-clearing conditions for goods and factors 0 ≤ i ≤ N + F are

                                                                N
                                                                X
                                                         yi =          x ji .
                                                                 j=0


       To state our results, we need the following definitions.

Definition 3. The (N + 1 + F) × (N + 1 + F) input-output matrix Ω is the matrix whose i jth
element is equal to the steady-state value of

                                                                    p j xij
                                                         Ωij =              .
                                                                    pi yi

The Leontief inverse is
                                                       Ψ = (I − Ω)−1 .

   Intuitively, the i jth element Ψij of the Leontief inverse is a measure of i’s total reliance
on j as a supplier. It captures both the direct and indirect ways through which i uses j in its
production.30

Definition 4. The input-output covariance operator is

                                                 N+F
                                                                         N+F             N+F             
                                                 X                       X              X             
                      CovΩ(k) (Ψ(i) , Ψ(j) ) =         Ωkl Ψli Ψl j −     Ωkl Ψli   Ωkl Ψl j  .   (5)
                                                 l=1                            l=1          l=1
  30
       See, for example, Baqaee (2015) for a detailed description of Ω and Ψ.

                                                                23
    It is the covariance between the ith and jth column of the Leontief inverse using the kth
row of the input-output matrix as the distribution. The input-output covariance operator plays
a crucial role in our results.
    We consider arbitrary CES network structures (in standard-form), starting with a single
factor and then generalizing to multiple factors. As previously mentioned, a one-factor
model is equivalent to a model where primary factors are equivalent and can be fully
reallocated. To model limited factor reallocation or decreasing-returns, we need to have
multiple factors.


4.1    One Factor
Proposition 7 (Second-Order Network Centrality). Consider a nested-CES model in standard
form with a single factor. The second-order macroeconomic impact of microeconomic shocks is given
by

                                                         N
                        d2 log Y         d λi      X
                                      =          =  (θk − 1)λk CovΩ(k) (Ψ(i) , Ψ(j) ),                 (6)
                    d log A j d log Ai d log A j
                                                      k=0


and in particular

                                                     N
                           d2 log Y      d λi     X
                                     =          =     (θk − 1)λk VarΩ(k) (Ψ(i) ).                      (7)
                           d log A2i   d log Ai
                                                  k=0


    Equations (6) and (7) have a simple intuition. Let us focus first on equation (6). The
change in the sales share of i, in response to a shock to j, depends on how the relative
demand expenditure for i changes. Changes in the demand expenditure for i arise from the
substitution by the different nodes k and captured by the different terms in the sum on the
right-hand side.31
    Consider for example the effect of a negative productivity shock d log A j < 0 to j. The
change in the vector of prices of the different producers is proportional to the vector of direct
and indirect exposures to the shock, which is simply the jth column Ψ(j) of the Leontief
inverse. Now consider a given producer k. If θk < 1, producer k increases its expenditure
share on inputs whose price increases more, i.e. inputs that are more exposed to the shock
to j, as measured by Ψ(j) . This increases the relative demand expenditure for i if those inputs
are also relatively more exposed to i, as measured by the ith column of the Leontief inverse
Ψ(i) . The overall effect is stronger, the higher is the covariance CovΩ(k) (Ψ(i) , Ψ(j) ), the larger is
  31
    In ongoing work (Baqaee and Farhi, 2019), we show that there is a connection between these formulas and
the gains-from-trade formulas in Arkolakis et al. (2012). See Appendix F for more details.


                                                    24
the size of producer k as measured by λk , and the further away from one is the elasticity of
substitution θk as measured by θk − 1.
    Equation (7) is a particular case of equation (6) and so the intuition is identical. The
change in the sales share of i depends on substitution by all producers k. The extent to
which substitution by producer k matters depends on how unequally k is exposed to i
through its different inputs, on how large k is, and on far away from one is the elasticity of
substitution in production of k. If k is small, or is exposed in the same way to i through all
of its inputs, then the extent to which it can substitute amongst its inputs is irrelevant. If the
elasticity of substitution of k is equal to one, then the direct and indirect relative demand
expenditure for i arising from k does not change in response to shocks. Equation (7) can
be seen as a centrality measure which combines structural microeconomic elasticities of
substitution and features of the network.32
    The Cobb-Douglas specification is the knife-edge special case where all the second-order
terms are equal to zero and where the first-order approximation is globally accurate. This
occurs because Domar weights, and more generally, the whole input-output matrix, are
constant and can be taken to be exogenous. Away from the Cobb-Douglas case, sales shares
and the input-output matrix respond endogenously to shocks, and this is precisely what
gives rise to the nonlinearities which are captured by the second-order approximation.


GE Elasticities of Substitution

Proposition 7 can also be used to compute the GE elasticities of substitution, using equations
(6) and (7) to substitute the corresponding derivatives in the following equations:

                                             1     d log λi d log λ j
                                        1−       =         −
                                             ρ ji d log Ai d log Ai

and
                                         d log ξ   1 X d log λ j
                                                 =    λj          .
                                         d log Ai ξ j    d log Ai


A Network-Irrelevance Result

To build more intuition, we provide a benchmark irrelevance result where the deviation
from Hulten’s approximation does not depend on the network structure.33 The key as-
sumptions required for obtaining this irrelevance result are: (1) productivity shocks are
  32
     Equation (7) is also related to the concentration centrality defined by Acemoglu et al. (2016), but generalizes
their result by allowing for heterogeneity in the interaction functions, non-symmetric network structures, and
micro-founds its use for production networks.
  33
     Footnote 13 of Baqaee (2018) also discusses this network irrelevance result.


                                                        25
factor-augmenting; (2) the structural microeconomic elasticities of substitution are all the
same.
    Once the economy is written in standard form, the shocks are factor-augmenting if they
only hit producers i which have the primary factor as their only input, i.e. if Ωi j = 0 for
every j = 0, . . . , N. In other words, the productivity shocks Ai hitting producers i which do
not have the primary factor as their only input are kept at their steady-state values of Ai = 1.

Corollary 1 (Network Irrelevance). Consider a nested-CES model in standard form with a single
factor, uniform elasticities of substitution θ j = θ for every j, and with factor-augmenting shocks.
Aggregate output is given by the closed-form expression

                                               N               1
                                                             θ−1
                                        Y    X
                                                    λi Aθ−1
                                                           
                                          =                ,
                                                            
                                                        i
                                        Y
                                                              
                                                i=0


where λi is the steady-state Domar weight of i. The second-order macroeconomic impact of factor-
augmenting microeconomic shocks is given by

                         d2 log Y         d λi
                                       =          = (θ − 1)λi (1(i = j) − λ j ),
                     d log A j d log Ai d log A j
and in particular

                                         N
              d2 log Y      d λi     X
                        =          =     (θ j − 1)λ j VarΩ(j) (Ψ(i) ) = (θ − 1)λi (1 − λi ).
              d log A2i   d log Ai   j=0


    In words, if we consider factor-augmenting shocks, and if all microeconomic elasticities
of substitution are the same, then the network structure remains irrelevant, even though
there are deviations from Hulten’s approximation. In this special case, the Domar weights
and the structural microeconomic elasticities of substitution are sufficient statistics for the
second-order effects.In fact, the result is true not only locally, but also globally.
    Essentially, factor-augmenting shocks shut down variations in ξ, which is constant and
equal to one, and uniform structural microeconomic elasticities of substitution shut down
variations in ρ ji which are uniform and constant

                                                        1
                                              ρ ji =       .
                                                       2−θ

Deviating from either condition breaks the irrelevance.




                                                   26
Energy Example – One Factor

A simple example, motivated by a universal intermediate input like energy, helps explain
some of the intuition of Proposition 7 and Corollary 1. Consider the example economy
depicted in Figure 3. Energy is produced linearly from labor:

                                                    e     le
                                                      = Ae .
                                                    e     le

Downstream producers produce using energy and labor with elasticity of substitution θ1 :
                                                                                θ1
                                                   θ1 −1          ! θθ1 −1  θ1 −1
                               yi             li θ1          ei 1 
                                 = (1 − ωie )          + ωie                    .
                               yi               li             ei            

They sell directly to the household who values goods with an elasticity of substitution θ0 :
                                                                     θ0
                                             
                                               N        ! θθ0 −1  θ0 −1
                                         Y 
                                              X     ci 0 
                                          =    ω0i                    ,
                                         Y  i=1     ci            


where Ni=1 ω0i = 1.
     P

  The market-clearing conditions are

                                                N
                                                X                              N
                                                                               X
                            y i = ci ,     e=          ei    and    l = le +          li ,
                                                 i=1                            i=1


where l = le + N
                 P
                    i=1 li .
     Producer i’s steady-state sales share is λi = ω0i , the intermediate input share of industry
i is ωie , and the sales share of energy is λe = i λi ωie .
                                                P

     We simplify the example further by supposing that all final sectors are equally sized with
λi = 1/N, and that M ≤ N producers use energy with the same steady-state intermediate
input share ωie = ωe , while the other N − M producers use no energy at all so that ωie = 0.
We set ωe to ensure that λe stays constant. We take θ1 < θ0 and θ1 < 1.
     Proposition 7 implies that

                    d2 log Y           N
                                      −M
                                                         
                                                             N
                                                                
                              =    λ2e      (θ0 − 1) + λe 1 − λe (θ1 − 1)
                    d log A2e         N                      M
                                                             N
                                                               
                              = λe (1 − λe )(θ0 − 1) + λe 1 − λe (θ1 − θ0 ).
                                                             M



                                                            27
                                       e                           L
                       θ1


                   1             ...           M            M+1              ...   N

                            θ0
                                              HH

Figure 3: An illustration of the economy with a near-universal intermediate input which we
call energy. Each downstream producer substitutes across labor and energy with elasticity
θ1 < 1. The household can substitute across final goods with elasticity of substitution
θ0 > θ1 . Energy is produced from labor with constant-returns.


The first equation directly expresses the second-order term as a weighted sum of the mi-
croeconomic elasticities of substitution as in Proposition 7. The first term on the right-hand
side of the second equation is the network-independent second-order term when all the
microeconomic elasticities of substitution are identical so that θ0 = θ1 as in Corollary 1. The
second term is a network-dependent correction that takes into account the fact that θ0 , θ1 .
   When every sector uses energy M = N, these equations become

                                       d2 log Y
                                                   = λe (1 − λe )(θ1 − 1),
                                       d log A2e

and the elasticity of substitution in consumption θ0 drops out completely. The fact that θ0
is irrelevant when M = N is a manifestation of the general principle stated in Proposition
7. When M = N, energy is a universal input and hence VarΩ(0) (Ψ(e) ) = 0. In this case,
the household is symmetrically exposed to shocks to energy via the different downstream
producers, and so the elasticity of substitution in consumption θ0 is irrelevant.
    When M , N instead θ0 matters, with a weight that decreases with N. Through the
lens of Proposition 7, VarΩ(0) (Ψ(e) ) = λ2e (N − M)/N > 0 is decreasing in M: as heterogeneity
in energy-intensity across downstream producers increases, the ability of the household to
substitute across these producers matters more and more.
    Because θ1 < 1, when M = N, the second-order approximation magnifies negative the
macroeconomic impact of negative shocks to energy compared to the first-order approxima-
tion. As M decreases, this effect becomes weaker, since a lower M means that energy is less
of a universal input, and so it becomes easier to substitute away from it further downstream
across producers with different energy intensities. The sign of the effect can even flip if M is
low enough and if θ0 is high enough above one.


                                                       28
Macro-Influence – One Factor

A final implication of Proposition 7 is that it is only the producer’s role as a supplier that
matters, not its role as a consumer.34

Proposition 8 (Macro-Influence). Consider a nested-CES model in standard form with a single
factor. Suppose that all producers k have the same expenditures on producers i and j so that Ωki = Ωk j
for all k. Then
                                         d log Y     d log Y
                                                  =          ,
                                         d log Ai d log A j

                                          d2 log Y         d2 log Y
                                                      =                ,
                                          d log A2i        d log A2j

and for all l,
                                     d2 log Y          d2 log Y
                                                  =                   .
                                 d log Al d log Ai d log Al d log A j
    The intuition is that, in a one factor model, we can normalize the wage to one, and
then aggregate output, which is equal to real factor income, depends only on the prices
of final goods. A change in the size of the ith industry does not affect its price. Hence, a
productivity shock travels downstream from suppliers to their consumers by lowering their
marginal costs and hence their prices, but it does not travel upstream from consumers to
their suppliers. This result fails whenever there are multiple factors, and by implication
when the model does not feature constant returns to scale. 35


4.2     Multiple Factors
We now generalize the results of the previous section to allow for multiple factors of produc-
tion. This in turn opens the door to modelling limited-reallocation and decreasing-returns-
to-scale via producer and industry-specific fixed factors.
    We sometime use separate uppercase indices to denote the producers that correspond
to factors, and lowercase indices to denote all other producers. For example, we sometime
use Λ f to denote the Domar weight, or income share, of factor f , and Λ to denote the F × 1
vector of factor shares.

  34
    This generalizes a result in Baqaee (2018).
  35
    Acemoglu et al. (2015) show that outside of the Cobb-Douglas special case, shocks can propagate both
upstream and downstream. There is no contradiction between their result and Proposition 8. Their results and
ours simply characterize different forms of propagation: they focus on the propagation of shocks to producers
on the quantities and sales of other producers, whereas we focus on the impact of shocks to producers on the
prices of other producers and on aggregate output.



                                                      29
Proposition 9 (Second-Order Network Centrality with Multiple Factors). Consider a nested-
CES model in standard form. Then

                                                     N
                    d2 log Y         d λi      X
                                  =          =  (θk − 1)λk CovΩ(k) (Ψ(j) , Ψ(i) )                     (8)
                d log A j d log Ai d log A j
                                                    k=0
                                       N+F
                                       X   d log Λ f X
                                                     N                                
                                     −                 (θk − 1)λk CovΩ(k) Ψ( f ) , Ψ(i) ,
                                           d log A j
                                       f =N+1             k=0


where the vector of elasticities of the factor income shares to the shocks solves the linear system

                                       d log Λ      d log Λ
                                                 =Γ           + δ(j) ,                                (9)
                                       d log A j    d log A j

with                                        N                            
                                      1    X                         
                           Γ f,g   =−        (θ − 1)λ Cov (k) Ψ , Ψ  ,
                                                 k     k   Ω     (f) (g) 
                                      Λf
                                                                        
                                             k=0

and                                         N                            
                             (j)     1     X                         
                            δf     =         (θ − 1)λ Cov (k) Ψ , Ψ  .
                                                 k     k   Ω     (f) (j) 
                                     Λf
                                                                        
                                            k=0

    Note that we can rewrite equation (8) as a function of d log λ j / d log A j using the identity
d log λ j / d log A j = (1/λ j )(d λ j / d log A j ). Proposition 9 can then be seen as a full character-
ization of the elasticities of the Domar weights of the different producers to the different
shocks.
    The intuition is the following. The first set of summands on the right-hand side of
equation (8) are exactly those in equation (6) in Proposition 7: these terms capture how
substitution by downstream producers k in response to a shock to j changes the sales share
of i. The second set of summands in equation (8) take into account the fact that, when
there are multiple factors, the shock also changes relative factor prices, and substitution in
response to changes in factor prices in turn affects the sales share of i.
    Consider for example a negative shock d log A j < 0 to producer j. Imagine that this shock
increases the price of factor f relative to the prices of other factors, so that d log Λ f > 0. Now
consider the response of a producer k to this change. If θk < 1, producer k increases its
expenditure share on producers that are more exposed to factor f as measured by Ψ( f ) .
If these producers are also more exposed to i, as measured by Ψ(i) , then the substitution
increases the sales share of i. These changes must be cumulated across producers k and
factors f . The total effect on the relative demand expenditure for producer i, and hence
on its sales share, is the sum of the effect of substitutions in response to the initial impulse


                                                     30
d log A j , as well as the substitutions in responses to changes in relative factor prices captured
by d log Λ f .
    Equation (9) in turn determines how factor shares d log Λ f / d log A j respond to different
shocks. For a given set of factor prices, a shock to j affects the relative demand expenditure
for each factor, and hence the factor income shares, as measured by the F × 1 vector δ( j) . This
change in the factor income shares then causes further substitution through the network,
leading to additional changes in relative factor shares and prices. The impact of the change
in the relative share or price of factor g on the relative demand expenditure for factor f is
measured by the f gth element of the F × F matrix Γ. Crucially, the matrix Γ does not depend
on which producer j is being shocked.
    We can verify that we get back Proposition 7 when there is only a single factor, since in
that case the exposure vector Ψ( f ) , corresponding to the unique factor, is equal to a vector of
all ones, and so the second set of summands in equation (8) is identically zero.
    Just like in the case of a single factor and for the same reasons, the Cobb-Douglas
specification is the knife-edge special case where all the second-order terms are equal to
zero and where the first-order approximation is globally accurate because sales shares,
and more generally the whole input-output matrix, are constant and can be taken to be
exogenous.


GE Elasticities of Substitution

Proposition 9 can also be used to compute the GE elasticities of substitution, using equations
(6) and (7) to substitute the corresponding derivatives in the following equations:36

                                           1     d log λi d log λ j
                                      1−       =         −
                                           ρ ji d log Ai d log Ai
and
                                       d log ξ   1 X d log λ j
                                               =    λj          .
                                       d log Ai ξ j    d log Ai
  36
    Although Proposition 9 is stated in terms of productivity shocks to non-factor producers j, the same
formulas hold for a productivity shock d log A g to a factor industry g. The productivity shock is then just a
shock to the endowment of the factor.37 We can also compute the GE elasticities of substitution between two
factors g and f using
                                            1     d log Λ f d log Λ g
                                       1−       =           −           .
                                           ρg f   d log A f   d log A f
We refer the reader to Baqaee and Farhi (2018a) for an extensive discussion of macroeconomic elasticities of
substitution between factors. This paper also characterizes the macroeconomic bias of technical change as a
function of microeconomic primitives.




                                                     31
A Network-Irrelevance Result

In the special case where all microeconomic elasticities of substitution are the same, we once
again obtain network-irrelevance result. However, because there are multiple factors, it is
not enough to consider factor-augmenting shocks as we did in the case of a single factor, and
we must instead focus on shocks that increase the overall quantities of the different factors.

Corollary 2 (Network Irrelevance). Consider a nested-CES model in standard form with uniform
elasticities of substitution θ j = θ for every j, and shocks A f to the supplies of the different factors f .
Aggregate output is given by the following closed-form expression

                                                                     θ
                                                                    θ−1
                                                  N+F
                                         Y     X          θ−1   
                                           =         Λ f A f θ  ,
                                                                  
                                                                   
                                         Y    
                                                f =N+1
                                                                   


where Λ f is the Domar weight of f at steady-state. The second-order macroeconomic impact of
microeconomic shocks to the supplies of factors is given by

                         d2 log Y            d Λf     
                                                          1
                                                            
                                         =           = 1−     Λ g (1(g = f ) − Λ g ),
                     d log A g d log A f   d log A g      θ

and in particular,
                              d2 log Y      d Λf     
                                                         1
                                                           
                                        =           = 1−     Λ f (1 − Λ f ).
                              d log A2f   d log A f      θ

   In this special case, the Domar weight and the structural microeconomic elasticities of
substitution are sufficient statistics for the second-order effects. In fact, the result is true not
only locally, but also globally.
   A consequence of this corollary is that whenever all the micro-elasticities of substitution
are the same and equal to θ, the GE elasticity of substitution ρ g f between any two factors f
and g is also equal to θ.


Energy Example – Multiple Factors

We revisit the energy example introduced in Section 4.1, but we now model energy as an
endowment rather than as a produced good. The economy is represented in Figure 4. For
this example, the effect of a shock to energy is now a nonlinear function of the underlying
microeconomic elasticities of substitution
                                                                                      
              d2 log Y      d Λe     (θ 0 − 1)Λe (1 − Λe ) + (θ1 − θ 0 )Λ e  1 − N
                                                                                 M
                                                                                   Λ e
                       =           =                                                     .
                     2
              d log Ae           2
                          d log Ae                                1− N
                                                                       Λ
                                                  θ + (θ − θ ) M
                                                                        e
                                                            0       1      0   1−Λe


                                                      32
                                                 E             L
                           θ1


                   1            ...              M            M+1         ...   N

                           θ0
                                              HH

Figure 4: An illustration of the economy with a near-universal input which we treat as
energy. Each industry has different shares of labor and energy and substitutes across labor
and energy with elasticity θ1 < 1. The household can substitute across goods with elasticity
of substitution θ0 > θ1 . Labor and energy are in fixed supply.


The difference with the case of a single factor is that following a negative productivity shock
to energy, labor cannot be reallocated to the production of energy in order to reinforce that
weak link. This effect, encapsulated in the denominator, further amplifies the effect of the
shock.
    Once again, and in accordance with Corollary 2, whenever the micro-elasticities of sub-
stitution are the same θ0 = θ1 , the shape of the network becomes irrelevant. Additionally,
in the extreme case where energy becomes a universal input M = N, the elasticity θ0 drops
out of the formula because producers are uniformly exposed to energy:

                                      d2 log Y       1
                                                       
                                                = 1−      Λe (1 − Λe ).
                                      d log A2e      θ1

Note that even in this case, the formula is different from that of the case of a single factor
where the first term on the right-hand side is θ1 − 1 instead of 1 − 1/θ1 . This reflects the
aforementioned fact that in contrast to the case of a single factor, labor cannot be reallocated
to the production of energy following a negative shock to energy, which further amplifies
the negative impact of the energy shock.


Macro-Influence – Multiple Factors

In contrast to the case of a single factor, shocks to prices now propagate downstream and
upstream. The result derived in Proposition 8 when there is only factor breaks down when
there are multiple factors: two producers with identical demand chains do not necessarily
have the same importance. This is because they might have different direct and indirect
exposures to the different factors. As a result, the role of a producer as a consumer matters


                                                         33
in addition to its role as a supplier.


5    Beyond CES
The input-output covariance operator defined in equation (5) is a key concept capturing the
substitution patterns in economies where all production and utility functions are nested-
CES functions. In this section, we generalize this input-output covariance operator in such
a way that allows us to work with arbitrary production functions.
    For a producer k with cost function Ck , we define the Allen-Uzawa elasticity of substitu-
tion between inputs x and y as

                                            Ck d2 Ck /(dpx dp y )   k (x, y)
                              θk (x, y) =                         =           ,
                                          (dCk /dpx )(dCk /dp y )     Ωky

where k (x, y) is the elasticity of the demand by producer k for input x with respect to the
price p y of input y, and Ωky is the expenditure share in cost of input y.
    Note the following properties. Because of the symmetry of partial derivatives, we have
θk (x, y) = θk (y, x). Because of the homogeneity of degree one of the cost function in the
prices of inputs, we have the homogeneity identity 1≤y≤N+1+F Ωky θk (x, y) = 0.
                                                       P

    We define the input-output substitution operator for producer k as
                                         X
              Φk (Ψ(i) , Ψ(j) ) = −                 Ωkx [δxy + Ωky (θk (x, y) − 1)]Ψxi Ψ yj ,    (11)
                                      1≤x,y≤N+1+F
                               1                                                        
                              = EΩ(k) (θk (x, y) − 1)(Ψi (x) − Ψi (y))(Ψ j (x) − Ψ j (y)) ,      (12)
                               2

where δxy is the Kronecker delta, Ψi (x) = Ψxi and Ψ j (x) = Ψxj , and the expectation on
the second line is over x and y. The second line can be obtained from the first using the
symmetry of Allen-Uzawa elasticities of substitution and the homogeneity identity.
   In the CES case with elasticity θk , all the cross Allen-Uzawa elasticities are identical
with θk (x, y) = θk if x , y, and the own Allen-Uzawa elasticities are given by θk (x, x) =
−θk (1 − Ωkx )/Ωkx . It is easy to verify that we then recover the input-output covariance
operator:
                            Φk (Ψ(i) , Ψ(j) ) = (θk − 1)CovΩ(k) (Ψ(i) , Ψ(j) ).

    Even outside the CES case, the input-output substitution operator shares many properties
with the input-output covariance operator. For example, it is immediate to verify, that:
Φk (Ψ(i) , Ψ(j) ) is bilinear in Ψ(i) and Ψ(j) ; Φk (Ψ(i) , Ψ(j) ) is symmetric in Ψ(i) and Ψ(j) ; and
Φk (Ψ(i) , Ψ(j) ) = 0 whenever Ψ(i) or Ψ(j) is a constant.


                                                         34
   Luckily, it turns out that all of the results stated so far can be generalized to non-CES
economies simply by replacing terms of the form (θk − 1)CovΩ(k) (Ψ(i) , Ψ(j) ) by Φk (Ψ(i) , Ψ(j) ).
For example, equation (8) in Proposition 9 becomes

                 d2 log Y
                                  N
                                  X                     N+F
                                                        X   d log Λ f X
                                                                      N
                                =   Φk (Ψ(i) , Ψ(j) ) −                 Φk (Ψ(i) , Ψ( f ) ).
             d log A j d log Ai                             d log A j
                                   k=0                  f =N+1           k=0


By replacing the input-output covariance operator with the input-output substitution op-
erator, we fully characterize the Hessian of the output function of the general economy
described in Section 2, with arbitrary, and potentially, non-homothetic production func-
tions, an arbitrary number of factors, and arbitrary patterns of input-output linkages.
    Intuitively, Φk (Ψ(i) , Ψ(j) ) captures the way in which k redirects demand expenditure to-
wards i in response to proportional unit decline in the price of j. To see this, we make use of
the following observation: the elasticity of the expenditure share of producer k on input x
with respect to the price of input y is given by δxy + Ωky (θk (x, y) − 1). Equation (11) requires
considering, for each pair of inputs x and y, how much the proportional reduction Ψ y j in
the price of y induced by a unit proportional reduction in the price of j causes producer k
to increase its expenditure share on x (as measured by −Ωkx [δxy + Ωky (θk (x, y) − 1)]Ψ yj ) and
how much x is exposed to i (as measured by Ψxi ).
    Equation (12) says that this amounts to considering, for each pair of inputs x and y,
whether or not increased exposure to j as measured by Ψ j (x)−Ψ j (y), corresponds to increased
exposure to i as measured by Ψi (x) − Ψi (y), and whether x and y are complements or
substitutes as measured by (θk (x, y) − 1). If x and y are substitutes, and Ψ j (x) − Ψ j (y) and
Ψi (x) − Ψi (y) are both positive, then substitution across x and y by k, in response to a shock
to a decrease in the price of j, increases demand for i.


6    Quantitative Illustration
In this section, we develop some illustrative quantitative applications of our results to gauge
the practical importance of the nonlinearities that we have identified. We perform three ex-
ercises focusing on macroeconomic phenomena at different frequencies. First, we calibrate a
multi-sector business-cycle model with sectoral productivity shocks. We match the observed
input-output data, and use the best available information to choose the structural (micro)
elasticities of substitution, and we match the volatility of sectoral shocks at business-cycle
frequencies. We compare the outcome of the nonlinear model to its first-order approxima-
tion. In the second exercise, we study the macroeconomic impact of the energy crisis of the
1970s using a non-parametric generalization of Hulten (1978) that takes second-order terms

                                                   35
into account. In the third and final exercise, we investigate the importance of nonlinearities
which underpin Baumol’s cost disease for long-run aggregate TFP growth. All our exercises
suggest that production is highly nonlinear.


6.1      A Quantitative Multi-Sector Business-Cycle Model with Sectoral Pro-
         ductivity Shocks
In this section, we use a simple version of the structural model defined in Section 2, calibrate
it with sectoral shocks at business-cycle frequencies, and solve for the equilibrium using
global solution methods.38 The final demand function is
                                                                        σ
                                                  N          ! σ−1
                                                                 σ 
                                                                     σ−1
                                          Y      X       ci
                                            =      ω0i           .
                                                                    
                                                           ci
                                                                     
                                          Y        i=1


       The production function of industry i is
                                                                                    θ
                                                  ! θ−1
                                                      θ
                                                                          ! θ−1
                                                                             θ 
                                                                                 θ−1
                                yi             li                    X̂i
                                   = Ai ωil          + (1 − ωil )             ,
                                                                               
                                yi              li                    Xi          


consisting of labor inputs li and intermediate inputs X̂i .
    We consider two polar opposite possibilities for the labor market: the case where each
labor type is specific to each industry, and cannot be reallocated, and the case where there is a
common factor which can be reallocated across all industries. In light of increasing evidence
(see for example Acemoglu et al., 2016; Autor et al., 2016; Notowidigdo, 2011) that labor is
not easily reallocated across industries or regions after shocks in the short run, we view the
no-reallocation case as more realistic for modeling the short-run impact of shocks, and the
full-reallocation case as better suited to study the medium to long-run impact shocks.39
  38
      For comparison, Table 3 in Appendix D shows the macro-moments for the model using the second-order
approximation. The second-order approximation does a very good job at capturing the mean and standard
deviation of aggregate output at both annual and quadrennial frequencies. It also performs well for skewness
and kurtosis at an annual frequency, but less so at a quadrennial frequency. Basically, the quality of the
approximation is worse for larger shocks and higher moments of output. Of course, whenever it is feasible
to solve the model non-linearly, the fully nonlinear solution is preferable. However, even in these cases,
our analytical pen-and-paper approach also sheds light on the mechanisms driving nonlinearities that would
be lost were we to simply solve a series of nonlinear equations on a computer. Furthermore, our sufficient
statistics approach allows us to construct the second-order approximation without needing to fully specify the
nonlinear model.
   39
      In our baseline calibrations, we assume that intermediate inputs can be freely reallocated across producers
even in the short run. This is sensible since intermediate goods are probably easier to reallocate than labor.
We refer the reader to Appendix C for a version of these calibrations in the presence of costs of adjusting
intermediate inputs. These adjustment costs hamper the reallocation of intermediate inputs across producers



                                                        36
   The composite intermediate input Xi is given by
                                                                         ε
                                              
                                                  N            ! ε−1  ε−1
                                       Xi     X         xi j
                                                                  ε 

                                          =       ωi j              ,
                                                                    
                                                                     
                                       Xi      
                                                 j=1
                                                          xi j         

where xij are intermediate inputs from industry j used by industry i.


Data and Calibration

We work with the 88 sector US KLEMS annual input-output data from Dale Jorgenson and
his collaborators, dropping the government sectors. The dataset contains sectoral output
and inputs from 1960 to 2005. We use the sector-level TFP series computed by Carvalho and
Gabaix (2013) using the methodology of Jorgenson et al. (1987).
    We calibrate the expenditure share parameters to match the input-output table, using
1982 (the middle of the sample) as the base year. We specify sectoral TFP shocks to be
lognormally distributed so that log Ai ∼ N(−Σii /2, Σii ), where Σii is the sample variance
of log TFP growth for industry i. We work with uncorrelated sectoral shocks since the
average correlation between sectoral growth rates is small (less than 5%). Our results are
not significantly affected if we matched the whole covariance matrix of sectoral TFP instead.
    We consider shocks at annual and quadrennial horizons, the latter corresponding to
the average period of a business cycle. The average standard deviation at a quadrennial
frequency is about twice its value at an annual frequency. In fact, it is the only difference
between the annual and quadrennial calibrations. Nonlinearities, which matter more for
bigger shocks, are more important at a quadriennal frequency than at an annual frequency.
    Our specification assumes only three distinct structural microeconomic elasticities of
substitution. This is because estimates of more disaggregated elasticities are not available.
For our benchmark calibration, we set (σ, θ, ε) = (0.9, 0.5, 0.001). We set the elasticity of
substitution in consumption σ = 0.9, following Atalay (2017), Herrendorf et al. (2013), and
Oberfield and Raval (2014), all of whom use an elasticity of substitution in consumption
(across industries) of slightly less than one. For the elasticity of substitution across value-
added and intermediate inputs, we set θ = 0.5. This accords with the estimates of Atalay
(2017), who estimates this parameter to be between 0.4 and 0.8, as well as Boehm et al. (2017),
who estimate this elasticity to be close to zero. Finally, we set the elasticity of substitution
across intermediate inputs to be ε = 0.001, which matches the estimates of Atalay (2017).
    Owing to uncertainty surrounding the estimates for (σ, θ, ε), we include many robust-
ness checks in Tables 4-7 in Appendix D. In the main text in Tables 1 and 2, we focus
and magnify the nonlinearities of the model.


                                                      37
on four sets of elasticities (σ, θ, ε): our benchmark calibration (0.9, 0.5, 0.001); a calibration
with lower but still plausible elasticities (0.7, 0.3, 0.001); a calibration with higher elastici-
ties (0.9, 0.6, 0.2); and a (close to) Cobb-Douglas calibration (0.99, 0.99, 0.99). In Appendix
D, we report robustness checks for different values of these elasticities on a grid with
σ ∈ {0.8, 0.9, 0.99}, θ ∈ {0.4, 0.5, 0.6, 0.99}, and ε ∈ {0.001, 0.2, 0.99}. Our results in Table 1 are
not sensitive to the exact value of (σ, θ, ε) provided that the elasticities are collectively low
enough that the calibration matches the observed volatility of the Domar weights.
    Since the volatility of Domar weights are a measure of the size of the second-order terms
in the model, we use the volatility of Domar weights as a sanity check for our calibration.
Specifically, we target σλ = i λi σλi , where λi is the time-series average of the ith Domar
                                  P

weight and σλi is the time-series standard deviation of industry i’s log-differenced Domar
weight. In our data, at annual frequency, σλ ≈ 0.13 and for quadrennial frequency σλ ≈ 0.27.
With no labor-reallocation, our baseline calibrations match these numbers relatively well;
the lower-elasticity calibrations overshoot; the higher-elasticity calibrations undershoot; and
the Cobb-Douglas calibrations deliver zero volatility of the Domar weights. Allowing for
labor re-allocation reduces the volatility of the Domar weights.40


Results

Table 1 displays the mean, standard deviation, skewness, and excess kurtosis of log aggregate
output for various specifications. For comparison, the table also shows these moments for
aggregate TFP growth in the data.41 In addition, we also report the volatility of the Domar
weights, both in the model and in the data. Since we have too few annual (and even fewer
quadrennial) observations of aggregate TFP, we do not report the skewness and excess
kurtosis: the implied confidence intervals for these estimates would be so large as to make
the point estimates uninformative. In Appendix D, we report results for numerous other
permutations of the elasticities of substitution for robustness.
    Overall, given our elasticities of substitution, the model with full reallocation is unable
to replicate the volatility of the Domar weights at either annual or quadrennial frequency,
suggesting that this model is not nonlinear enough to match the movements in the Domar
weights as arising from sectoral productivity shocks. On the other hand, the model without
  40
      To match the data, we assume that changes in sectoral TFPs are the sole driver of fluctuations in the Domar
weight. Other types of shocks, besides industry-level TFP shocks, could also drive volatility to the Domar
weights (for example shocks to the composition of demand). While such shocks, whatever they are, would also
indicate the presence nonlinearities, they would imply different elasticities of substitution for the calibration
of the micro-elasticities of substitution. We abstract from this issue in calibrating the parameters of the model
in Section 6.1.
   41
      Since our model has inelastic factor supply, its output is more comparable to aggregate TFP than to real
GDP. As shown by Gabaix (2011) and Carvalho and Gabaix (2013), elastic capital and labor supply would
further amplify TFP shocks.


                                                       38
      (σ, θ, )                          Mean       Std   Skew    Ex-Kurtosis    σλ

      Full Reallocation - Annual
      (0.7, 0.3, 0.001)                 -0.0023   0.011   -0.10           0.1 0.090
      (0.9, 0.5, 0.001)                 -0.0022   0.011   -0.08           0.0 0.069
      (0.9, 0.6, 0.2)                   -0.0020   0.011   -0.05           0.0 0.056
      (0.99, 0.99, 0.99)                -0.0013   0.011    0.01           0.0 0.001


      No Reallocation - Annual
      (0.7, 0.3, 0.001)                 -0.0045   0.012   -0.31           0.4 0.171
      (0.9, 0.5, 0.001)                 -0.0034   0.012   -0.18           0.1 0.115
      (0.9, 0.6, 0.2)                   -0.0024   0.011   -0.11           0.1 0.068
      (0.99, 0.99, 0.99)                -0.0011   0.011    0.00           0.0 0.001


      Full Reallocation - Quadrennial
      (0.7,0.3,.0.001)                  -0.0118   0.026    -0.4           0.4 0.307
      (0.9, 0.5, 0.001)                 -0.0113   0.026   -0.28           0.4 0.176
      (0.9, 0.6, 0.2)                   -0.0100   0.026   -0.23           0.2 0.133
      (0.99, 0.99, 0.99)                -0.0058   0.025    0.01           0.0 0.003


      No Reallocation - Quadrennial
      (0.7, 0.3, 0.001)                 -0.0270   0.037   -2.18          12.7 0.404
      (0.9, 0.5, 0.001)                 -0.0187   0.030   -1.11           3.6 0.267
      (0.9, 0.6, 0.2)                   -0.0129   0.027   -0.44           0.7 0.154
      (0.99, 0.99, 0.99)                -0.0057   0.025    0.00           0.0 0.002



      Annual Data                               - 0.015       -             -   0.13
      Quadrennial Data                          - 0.030       -             -   0.27


Table 1: Simulated and estimated moments. For the data, we use the demeaned growth rate
of aggregate TFP. For the model, we use the sample moments of log output. The simulated
moments are calculated from 50,000 draws. Skewness and kurtosis of the data are impossible
to estimate with enough precision and so we do not report them.




                                           39
reallocation is able to match the volatility of the Domar weights, which is consistent with
the intuition of Section 3.
    Let us consider each moment in turn, starting with the mean. For our benchmark
calibration (σ, θ, ε) = (0.9, 0.5, 0.001), the model without reallocation matches the volatility
of Domar weights at both annual and quadrennial frequency. The reductions in the mean
are around 0.3% at annual and just under 2% at quadrennial frequency. Since our lognormal
shocks are calibrated to have a mean of 1 in levels, as we increase the variance, the mean
of the log declines. We can net out this mechanical effect by subtracting the average loss in
performance from the ones in the loglinear Cobb-Douglas model. At an annual frequency,
this results in a loss from nonlinearities of 0.34% − 0.11% = 0.23%, and at a quadrennial
frequency, the loss from nonlinearities is 1.87% − 0.57% = 1.30%. These numbers, which
identify the welfare costs of sectoral shocks arising from concavity in production, can be
compared with the welfare costs of fluctuations à la Lucas (1987) arising from concavity in
utility, which are around 0.01% and 0.05% respectively in these calibrations. The reduction
in the mean increases as we pump up the degree of nonlinearity, and so do the corresponding
losses from nonlinearities.
    A qualitatively similar pattern holds for the model with full reallocation. In that case,
the reductions in the mean are smaller: 0.2% − 0.1% = 0.1% at an annual frequency and
1.1% − 0.57% = 0.46% at a quadrennial frequency. Unsurprisingly, the approximately Cobb-
Douglas model behaves similarly regardless of the mobility of labor — this follows from
the fact that Hulten’s theorem holds globally for a Cobb-Douglas model where no labor
reallocation takes place in equilibrium whether or not it is allowed.
    At an annual frequency, both models undershoot a bit on the overall volatility of ag-
gregate TFP. One reason why the model undershoots on standard deviation, particularly at
annual frequency, is that we restrict the industry-level productivity shocks to be indepen-
dent, whereas in the data, particularly at higher frequencies, they feature some correlation.
At a quadrennial frequency, the model better matches the volatility of aggregate TFP. The
degree of nonlinearity makes little difference for the volatility of aggregate TFP at an annual
frequency.42 Nonlinearities matter more for the volatility of aggregate TFP at a quadrennial
frequency because the shocks are larger.
    Finally, the models with and without reallocation both generate negative skewness and
some positive excessive kurtosis (in fact, a very high amount for the quadrennial specifi-
cations without reallocation). The skewness and excess kurtosis fatten the left tail of the
  42
    Whereas for the mean, skewness, and kurtosis, the second-order terms are the dominant power in the
Taylor expansion (since the linear terms have no effect), for the variance, the dominant power is the linear
term. For example, letting σ be the standard deviation of the shocks, the approximation of the variance in
Appendix E shows that the contribution of the linear terms scales in σ2 , whereas that of the nonlinear terms
scales in σ4 .


                                                     40
distribution, providing an endogenous explanation for “rare disasters”. Unlike Acemoglu
et al. (2017) or Barro (2006), to achieve rare disasters, we do not need to assume fat-tailed
exogenous shocks nor rule out “rare bonanzas” a priori. Instead these features are endoge-
nously generated by the nonlinearities in the model. This can be seen in Figure 5, where we
plot the histograms for the benchmark calibrations with no reallocation (which match the
volatility of Domar weights) and for a loglinear approximation subject to the same shocks.
As expected, nonlinearities are more important at a quadrennial frequency than at an annual
frequency because the shocks are larger (more volatile).

       40                                                                16
              Benchmark Annual                                                   Benchmark Quadrennial
              Cobb-Douglas                                               14      Cobb-Douglas

       30                                                                12

                                                                         10
 pdf




                                                                   pdf
       20                                                                 8

                                                                          6

       10                                                                 4

                                                                          2

       0                                                                  0
       0.96   0.97   0.98   0.99   1   1.01   1.02   1.03   1.04          0.9   0.92   0.94   0.96   0.98   1   1.02   1.04   1.06   1.08


Figure 5: The left panel shows the distribution of aggregate output for the benchmark model
and loglinear model at an annual frequency. The right panel shows these for shocks at a
quadrennial frequency. The difference between the two frequencies is that shocks are larger
(their volatility is higher) at a quadrennial than at an annual frequency. The benchmark
model has (σ, θ, ε) = (0.9, 0.5, 0.001) and no labor reallocation. Note that the scales are
different in these two figures.

    We also consider the response of aggregate output to shocks to specific industries, using
our benchmark calibration. It turns out that for a large negative shock, the “oil and gas”
industry produces the largest negative response in aggregate output, despite the fact it is
not the largest industry in the economy. Figure 6 plots the response of aggregate output for
shocks to the oil and gas industry as well as for the “retail trade (excluding automobiles)”
industry. The retail trade industry has a similar sales share, and therefore, to a first-order,
both industries are equally important. As expected, the nonlinear model amplifies negative
shocks and mitigates positive shocks. However, whereas output is roughly loglinear for
shocks to retail trade, output is highly nonlinear with respect to shocks to oil and gas.
    The intuition for this asymmetry comes from the examples in Figures 3 and 4. “Oil and
ga’s” is an approximately universal input, so that the downstream elasticity of substitution
(in consumption) σ is less relevant and the upstream elasticity of substitution (in production)


                                                               41
θ is more relevant. Since θ  σ in our calibration, this means that output is more nonlinear
in shocks to “oil and gas” than in shocks to “retail trade”. Furthermore, “oil and gas” have
a relatively low share of intermediate input usage. As a result, in response to a negative
shock, resources cannot be reallocated to boost the production of oil and gas. This means
that we are closer to the economy depicted in Figure 4 than the one in Figure 3, with a
correspondingly lower GE elasticity of substitution between oil and gas and everything else
due to the lack of reallocation.
    The strong asymmetry between the effects of positive and negative shocks is consistent
with the empirical findings of Hamilton (2003) that oil price increases are much more
important than oil price decreases.43

                                       Oil
                              0.02     Retail
                                       Hulten Oil
                                       Hulten Retail
                                0
                  log(Y/Y)




                             −0.02



                             −0.04



                             −0.06

                                −0.4   −0.3    −0.2    −0.1      0       0.1      0.2      0.3
                                                         log TFP

Figure 6: The effect of TFP shocks to the oil and gas industry and the retail trade industry.
Both industries have roughly the same sales share, and so they are equally important up
to a first-order approximation (dotted line). The nonlinear model is more fragile to both
shocks than the loglinear approximation. The “oil and gas” industry is significantly more
important than “retail trade” for large negative shocks. The histogram is the empirical
distribution of sectoral annual TFP shocks pooled over the whole sample. The model has
(σ, θ, ε) = (0.9, 0.5, 0.001) with no labor reallocation and no adjustment costs.

  43
    Figure 6 may give the impression that the relative ranking of industries is stable as a function of the size
of the shock. The oil industry is always more important than the retail trade industry for negative shocks,
and always less important for positive shocks. However, this need not be the case. In Appendix D we plot
aggregate output as a function of shocks to the “oil and gas” industry and the construction industry. The
construction industry is larger than the oil industry. Therefore, the first-order approximation implies that it
should be more important. The nonlinear model also behaves the same way for positive shocks, and small
negative shocks. However, for very large negative shocks, the “oil and gas” industry once again becomes
more important.

                                                       42
6.2    The Effect of Oil Shocks
In this section, we use the oil shocks of the 1970s to demonstrate the way nonlinearities can
amplify the macroeconomic impact of industry-level shocks.44 To recap the history, starting
in 1973, coordinated action by OPEC caused the price of crude oil to increase from $3.5 per
barrel in 1972 to $11 per barrel in 1974. In 1979, OPEC implemented a second round of
quantity restrictions which caused the price of crude to soar to $31 per barrel. Shortly after
this, the Iranian revolution of 1979 and the ensuing Iraqi invasion of Iran caused further
disruptions to global crude oil supply. The price peaked at $37 in 1980. Starting in the early
1980s, with the abdication of the Shah, OPEC’s pricing structure collapsed and, in a bid to
maintain its market share, Saudi Arabia flooded the market with inexpensive oil. In real
terms, the price of crude oil declined back to its pre-crisis levels by 1986.
    We adopt a non-parametric approach which allows us to account for the second-order
macroeconomic impact of microeconomic shocks using ex-post data. Instead of trying to
predict how Domar weights change in response to a shock as would be required for a
counterfactual exercise, we can simply observe it. Formally, we rely on the following result.

Proposition 10. Up to the second order in the vector ∆, we have

                                             1
                log (Y(A + ∆)/Y(A)) =          [λ(A + ∆) + λ(A)]0 log(A + ∆) − log(A) .
                                                                                     
                                             2

    The idea of averaging weights across two periods is due to Törnqvist (1936). Proposition
10 relates the macroeconomic impact of microeconomic shocks to the size of the shock and
the corresponding Domar weights before and after the shock.45
   44
      Although our structural model suggests that the “oil and gas” extraction industry is important, it abstracts
away from trade, by assuming all intermediate inputs are sourced domestically, with net imports showing up
only in final demand. Hence, the Domar weight of the “oil and gas” industry measures domestic production,
rather than domestic consumption. Since the oil price shocks did not directly affect the productivity of
domestic oil production, this means that they are not measured in our sectoral TFP data (which is for domestic
production). Furthermore, our industry classification is too coarse to isolate crude oil separately from other
petrochemicals. For this reason, we use global (rather than US) data.
                                                                                               R A+∆
   45
      One can always compute the full nonlinear impact of a shock on output by computing A λ(Ã) d log Ã,
and our formula approximates this integral by performing a first-order (log) approximation of the Domar
weight λ(Ã) or equivalently a second-order (translog) approximation of aggregate output. In theory, if TFP is
a continuous diffusion then one can disaggregate time-periods and compute the impact of shocks over a time
                    R t+δ
period [t, t + δ] as t λ(As ) d log(As ) which can be seen as a repeated application of Hulten’s theorem at every
point in time over infinitesimal intervals of time. However, when TFP has jumps, then this decomposition no
longer applies. In any case, even when it does apply, and when the required high-frequency data regarding
TFP shocks and Domar weights is available, it can only be useful ex post to asses the changes in aggregate
output over an elapsed period of time due to the TFP shocks d log(As ) to a given sector given the observed path
of Domar weight λ(As ). It is of no use ex ante to predict how these future shocks will affect aggregate output
because one would need to know how the Domar weight will change over time as a result of the shocks, and
hence of no use to run counterfactuals. This latter part is precisely what the second-order approximation at
the heart of our paper accomplishes.

                                                       43
    We measure the price of oil using the West Texas Intermediate Spot Crude Oil price
from the Federal Reserve Database. Global crude oil production, measured in thousand
tonne of oil equivalents, is from the OECD. World GDP, in current USD, is from the World
Bank national accounts data. The choice of the pre and post Domar weight is not especially
controversial. Crude oil, as a fraction of world GDP, increased from 1.8% in 1972 to 7.6%
in 1979. Reassuringly, the Domar weight is back down to its pre-crisis level by 1986 (see
Figure 7). This means that, taking the second-order terms into account, we need to weight
the shock to the oil industry by 1/2(1.8% + 7.6%) = 4.7%. Hence, the second-order terms
amplify the shock by a factor of 4.7/1.8 ≈ 2.6.

                      0.08




                      0.06




                      0.04




                      0.02




                         0
                         1970         1980          1990          2000         2010

            Figure 7: Global expenditures on crude oil as a fraction of world GDP.

    Calibrating the size of the shock to the oil industry is more tricky, since it is not directly
observed. If we assume that oil is an endowment, then we can simply measure the shock via
changes in the physical quantity of production. To do this, we demean the log growth rate
in global crude oil production, and take the shock to be the cumulative change in demeaned
growth rates from 1973 to 1980, which gives us a shock of −13%.46
    Putting this altogether, the first-order impact on aggregate output is therefore

                                          1.8% × −13% = −.23%
   46
      We use the demeaned growth rate to remove the overall (positive) trend in production. Intuitively, if
everything is growing at the same rate, then a negative oil shock is a reduction in the growth of oil relative
to trend. Of course, one can easily quibble with this estimate of the size of the shock, but fortunately, the
degree of amplification (defined as the ratio of the second-order approximation to the first) is independent of
our estimate for the size of the shock. So, for any value of the shock, the second-order approximation almost
triples the impact of the shock.



                                                      44
On the other hand, the second-order impact on aggregate output is

                                    1
                                      (1.8% + 7.6%) × −13% = −.61%.
                                    2

Hence, accounting for the second-order terms amplifies the impact of the oil shocks signif-
icantly, so that oil shocks can be macroeconomically significant even without any financial
or demand side frictions.47


6.3    Baumol’s Cost Disease and Long-Run Growth
Our final empirical exercise looks to quantify the importance of nonlinearities on long-run
productivity growth. For this exercise, we use World KLEMS data for the US from 1948-2014.
   The “nonlinear” measure of aggregate TFP growth over the sample is built by updating
the Domar weights every period:

                                                     N X
                                                     X 2013
                         ∆ log TFP   nonlinear
                                                 =                λi,t (log Ai,t+1 − log(Ai,t )).
                                                     i=1 t=1948


This provides an approximation, by discrete left Riemann sums, of the exact aggregate TFP
                                                  P R 2014
growth, given by the sum of continuous integrals N  i=1 1948 λi,t d log Ai,t .
   Now consider the following counterfactual: imagine that the economy is loglinear so
that the Domar weights are constant throughout the sample at their 1948 values. Assuming
that the path for industry-level TFP is unchanged, aggregate TFP growth over the sample
would be given by

                                                     N
                                                     X
                         ∆ log TFP   1st order
                                                 =         λi,1948 (log Ai,2014 − log Ai,1948 ),
                                                     i=1


    By comparing actual aggregate TFP growth and TFP growth in the counterfactual log-
linear economy, we quantify the importance of Baumol’s cost disease (Baumol, 1967): the
notion that over time, because of complementarities, the sales shares of low-productivity-
growth industries increase while those of high-productivity-growth industries decrease,
  47
     As noted by Hamilton (2013), first-order approximations of efficient models assign a relatively small impact
to oil price shocks. Hence, the literature has tended to focus on various frictions that may account for the strong
statistical relationship between oil shocks and aggregate output. Our calculations suggests that nonlinearities
in production may help explain the outsized effect of oil shocks even in efficient models. Furthermore, our
calculation makes no allowance for amplification of shocks through endogenous labor supply and capital
accumulation, which are the standard channels for amplification of shocks in the business cycle literature.
Hence, coupled with the standard amplification mechanisms of those models, we would expect the reduction
in aggregate output to be even larger.



                                                             45
thereby slowing down aggregate TFP growth.
   By the end of the sample, aggregate TFP growth in the counterfactual loglinear or Cobb-
Douglas economy is around 87% whereas actual TFP grew by 68%. Hence the presence of
nonlinearities slowed down aggregate TFP growth by around 19 percentage points over the
sample period.


                1.80



                1.60



                1.40



                1.20
                                                                                Nonlinear
                                                                                First Order
                                                                                Second Order

                1.00
                   1940   1950         1960       1970   1980   1990     2000     2010         2020

Figure 8: Cumulative change in TFP: nonlinear (actual), first-order approximation, and
second-order approximation.

   Baumol’s cost disease is a manifestation of nonlinearities, since ∆ log TFP1st order is a first-
order approximation of actual aggregate TFP growth. A second-order approximation, which
captures some of the nonlinearities, is given by

                                              N
                                         1X
               ∆ log TFP   2nd order
                                       =       (λi,1948 + λi,2014 )(log Ai,2014 − log Ai,1948 ).
                                         2 i=1

    In Figure 8, we plot aggregate TFP growth using the nonlinear, first-order, and second-
order measures. The gap between the nonlinear measure and the first-order approximation
is sizeable, but that between the nonlinear measure and the second-order approximation is
much smaller.
    These findings are in some sense more general than Baumol’s hypothesized mecha-
nism. Traditionally, the mechanism for Baumol’s cost disease is through prices: because
of complementarities, as the prices of high-productivity-growth industries fall, their shares
in aggregate output fall, resources are reallocated away from them, thereby reducing ag-

                                                         46
gregate TFP growth. Alternative stories for structural transformation emphasize other
mechanisms, principally, non-homotheticities whereby as real income increases, consumers
increase their expenditures on industries that happen to have lower productivity growth.48
From the perspective of our framework, non-homotheticities and complementarities are
both nonlinearities. Our calculations of the impact of nonlinearities encompass both types
of mechanisms.49,50


7        Conclusion
The paper points to many unanswered questions. For instance, it shows that the macroe-
conomic impact of a microeconomic shock depends greatly on how quickly factors can be
reallocated across production units. Since our structural model is static, we are forced to
proxy for the temporal dimension of reallocation by resorting to successive comparative
statics. In ongoing work, we investigate the dynamic adjustment process more rigorously
and find that although we can think of the no-reallocation and perfect-reallocation cases as
the beginning and end of the adjustment, the speed of adjustment also greatly depends on
the microeconomic details. This means that the dynamic response of aggregate output to
different shocks is greatly affected by issues like geographic or sectoral mobility of labor,
even with perfect and complete markets that allow us to abstract from distributional issues.
Our structural application also lacks capital accumulation and endogenous labor supply,
and incorporating these into the present analysis is an interesting area for future work.
    Furthermore, in this paper, we have focused exclusively on the way shocks affect aggre-
gate output. In Baqaee and Farhi (2018a), we focus on how shocks affect factor shares and
derive characterizations of the macroeconomic elasticities of substitution between factors
and of the macroeconomic bias of technical change. In Baqaee and Farhi (2018b), we take
up the related question of how shocks affect non-aggregate outcomes, namely how shocks
propagate from one producer to another, and how microeconomic variables comove with
one another in a production network.
    In addition, this paper assumes that aggregate final demand is homothetic. Nonhomoth-
    48
      See Herrendorf et al. (2013) as an example.
    49
      Our theoretical characterizations cover all these nonlinearities. In fact, formally, non-homotheticities can
always be represented via non-unitary elasticities of substitution between inputs and a fixed factor. To see this,
note that any non-homothetic function f (x) can be extended into a constant-returns function f˜(x, y) = y f (x/y)
where f (x) = f˜(x, 1). Then, non-homotheticity in f is equivalent to a non-unitary elasticity of substitution
between x and y in f˜(x, y).
   50
      Another potential source of nonlinearities is shocks to the composition of demand. For example, a Cobb-
Douglas model with shocks to the share parameters is a nonlinear model since the cross-partial derivatives
of aggregate output with respect to industry TFP and share shocks are non-zero. Our results also cover such
economies.


                                                       47
etic aggregate final demand can arise from nonhomothetic individual final demand or from
the aggregation of heterogenous but homothetic individual demands. In Baqaee and Farhi
(2018b, 2019), we show how to take these elements into account. In particular, in Baqaee
and Farhi (2018b), we show how to combine input-output production networks with het-
eorgeneous agents and non-homothetic final demand in closed economies. In Baqaee and
Farhi (2019), we show how to take these elements into account in trade models.
    Finally, this paper assumes away non-technological frictions, but the forces we identify
do not disappear in richer models with inefficient equilibria. Non-unitary elasticities of
substitution in networks can amplify or attenuate the underlying distortions. In Baqaee and
Farhi (2018c), we undertake a systematic characterization of these effects. We show that in
inefficient models, the “second-order” terms that we characterize in this paper can become
first order.


References
Acemoglu, D., U. Akcigit, and W. Kerr (2015). Networks and the macroeconomy: An empirical exploration.
  NBER Macro Conference.
Acemoglu, D., D. Autor, D. Dorn, G. H. Hanson, and B. Price (2016). Import competition and the great US
  employment sag of the 2000s. Journal of Labor Economics 34(S1), S141–S198.
Acemoglu, D., V. M. Carvalho, A. Ozdaglar, and A. Tahbaz-Salehi (2012). The network origins of aggregate
  fluctuations. Econometrica 80(5), 1977–2016.
Acemoglu, D., A. Ozdaglar, and A. Tahbaz-Salehi (2015). Systemic risk and stability in financial networks. The
  American Economic Review 105(2), 564–608.
Acemoglu, D., A. Ozdaglar, and A. Tahbaz-Salehi (2016). Networks, shocks, and systemic risk. In The Oxford
  Handbook of the Economics of Networks.
Acemoglu, D., A. Ozdaglar, and A. Tahbaz-Salehi (2017). Microeconomic origins of macroeconomic tail risks.
  The American Economic Review 107(1), 54–108.
Aghion, P. and P. W. Howitt (2008). The economics of growth. MIT press.
Altinoglu, L. (2016). The origins of aggregate fluctuations in a credit network economy.
Arkolakis, C., A. Costinot, and A. Rodrı́guez-Clare (2012). New trade models, same old gains? American
  Economic Review 102(1), 94–130.
Atalay, E. (2017). How important are sectoral shocks? American Economic Journal: Macroeconomics 9(4), 254–80.
Autor, D. H., D. Dorn, and G. H. Hanson (2016). The china shock: Learning from labor-market adjustment to
  large changes in trade. Annual Review of Economics 8, 205–240.
Ballester, C., A. Calvó-Armengol, and Y. Zenou (2006). Who’s who in networks. wanted: the key player.
  Econometrica 74(5), 1403–1417.
Baqaee, D. and E. Farhi (2018a). The microeconomic foundations of aggregate production functions. Technical
  report, National Bureau of Economic Research.
Baqaee, D. R. (2015). Targeted fiscal policy.
Baqaee, D. R. (2018). Cascading failures in production networks. Econometrica 86(5), 1819–1838.



                                                     48
Baqaee, D. R. and E. Farhi (2018b). Macroeconomics with heterogeneous agents and input-output networks.
   Technical report, NBER Working Papers 24684, National Bureau of Economic Research, Inc.
Baqaee, D. R. and E. Farhi (2018c). Productivity and misallocation in general equilibrium. Technical report,
   National Bureau of Economic Research.
Baqaee, D. R. and E. Farhi (2019). Trade theory with global production networks. Technical report.
Barro, R. J. (2006). Rare disasters and asset markets in the twentieth century. The Quarterly Journal of Economics,
   823–866.
Barrot, J.-N. and J. Sauvagnat (2016). Input specificity and the propagation of idiosyncratic shocks in production
   networks. The Quarterly Journal of Economics.
Bartelme, D. and Y. Gorodnichenko (2015). Linkages and economic development. Technical report, National
   Bureau of Economic Research.
Baumol, W. J. (1967). Macroeconomics of unbalanced growth: the anatomy of urban crisis. The American
   economic review 57(3), 415–426.
Bigio, S. and J. La’O (2016). Financial frictions in production networks. Technical report.
Blackorby, C. and R. R. Russell (1989). Will the real elasticity of substitution please stand up?(a comparison of
   the Allen/Uzawa and Morishima elasticities). The American economic review 79(4), 882–888.
Boehm, C. E., A. Flaaen, and N. Pandalai-Nayar (2017). Input linkages and the transmission of shocks:
   Firm-level evidence from the 2011 tohoku earthquake. The Review of Economics and Statistics.
Burstein, A. and J. Cravino (2015). Measured aggregate gains from international trade. American Economic
   Journal: Macroeconomics 7(2), 181–218.
Carvalho, V. and X. Gabaix (2013). The great diversification and its undoing. The American Economic Re-
   view 103(5), 1697–1727.
Carvalho, V. M. (2010). Aggregate fluctuations and the network structure of intersectoral trade.
Costinot, A. and A. Rodriguez-Clare (2014). Trade theory with numbers: quantifying the consequences of
   globalization. Handbook of International Economics 4, 197.
Di Giovanni, J., A. A. Levchenko, and I. Méjean (2014). Firms, destinations, and aggregate fluctuations.
   Econometrica 82(4), 1303–1340.
Durlauf, S. N. (1993). Nonergodic economic growth. The Review of Economic Studies 60(2), 349–366.
Elliott, M., B. Golub, M. O. Jackson, et al. (2014). Financial networks and contagion. American Economic
   Review 104(10), 3115–53.
Feenstra, R. C. and G. H. Hanson (1996). Globalization, outsourcing, and wage inequality. The American
   Economic Review 86(2), 240.
Foerster, A. T., P.-D. G. Sarte, and M. W. Watson (2011). Sectoral versus aggregate shocks: A structural factor
   analysis of industrial production. Journal of Political Economy 119(1), 1–38.
Gabaix, X. (2011). The granular origins of aggregate fluctuations. Econometrica 79(3), 733–772.
Gabaix, X. (2016). Power laws in economics: An introduction. Journal of Economic Perspectives 30(1), 185–206.
Gomme, P. and P. Rupert (2007). Theory, measurement and calibration of macroeconomic models. Journal of
   Monetary Economics 54(2), 460–497.
Grassi, B. (2017). IO in I-O: Competition and volatility in input-output networks. Technical report.
Grossman, G. M., E. Helpman, E. Oberfield, and T. Sampson (2016). Balanced growth despite Uzawa. Technical
   report, National Bureau of Economic Research.
Hamilton, J. D. (2003). What is an oil shock? Journal of econometrics 113(2), 363–398.
Hamilton, J. D. (2013). Historical oil shocks. In R. E. Parker and R. M. Whaples (Eds.), Routledge Handbook of
   Major Events in Economic History, Chapter 21, pp. 239–265. Routledge.


                                                        49
Herrendorf, B., R. Rogerson, and A. Valentinyi (2013). Two perspectives on preferences and structural trans-
   formation. American Economic Review 103(7), 2752–89.
Hicks, J. (1932). Theory of wages. Springer.
Horvath, M. (1998). Cyclicality and sectoral linkages: Aggregate fluctuations from independent sectoral
   shocks. Review of Economic Dynamics 1(4), 781–808.
Horvath, M. (2000). Sectoral shocks and aggregate fluctuations. Journal of Monetary Economics 45(1), 69–106.
Hulten, C. R. (1978). Growth accounting with intermediate inputs. The Review of Economic Studies, 511–518.
Jones, C. I. (2011). Intermediate goods and weak links in the theory of economic development. American
   Economic Journal: Macroeconomics, 1–28.
Jones, C. I. (2013). Input-Output economics. In Advances in Economics and Econometrics: Tenth World Congress,
   Volume 2, pp. 419. Cambridge University Press.
Jorgenson, D. W., F. Gollop, and B. M Fraumeni (1987). Productivity and US economic growth.
Jovanovic, B. (1987). Micro shocks and aggregate risk. The Quarterly Journal of Economics, 395–409.
Kim, S.-J., H. S. Shin, et al. (2013). Working capital, trade and macro fluctuations. Technical report.
Liu, E. (2017). Industrial policies and economic development. Technical report.
Long, J. B. and C. I. Plosser (1983). Real business cycles. The Journal of Political Economy, 39–69.
Lucas, R. E. (1987). Models of business cycles, Volume 26. Basil Blackwell Oxford.
Morishima, M. (1967). A few suggestions on the theory of elasticity. Keizai Hyoron (Economic Review) 16,
   144–150.
Notowidigdo, M. J. (2011). The incidence of local labor demand shocks. Technical report, National Bureau of
   Economic Research.
Oberfield, E. and D. Raval (2014). Micro data and macro technology. Technical report, National Bureau of
   Economic Research.
Scheinkman, J. A. and M. Woodford (1994). Self-organized criticality and economic fluctuations. The American
   Economic Review, 417–421.
Stella, A. (2015). Firm dynamics and the origins of aggregate fluctuations. Journal of Economic Dynamics and
   Control 55, 71–88.
Theil, H. (1967). Economics and information theory. Technical report.
Törnqvist, L. (1936). The Bank of Finland’s consumption price index. Bank of Finland Monthly Bulletin 10.




                                                     50
A      Proofs
Proof of theorem 1. Since the first welfare theorem holds, the equilibrium allocation solves
                                                                                                                               
                                                   X                                     X              X         X 
Y(A1 , . . . , AN ) = max D(c1 , . . . , cn ) +          µi Ai Fi (li j ) j , (xi j ) j −   xi j − ci  + λi li −  l ji  ,
                                                                                                                               
                     ci ,xi j ,li j                                                                                            
                                                     i                                   j                   i              j


where li is the endowment of each labor type, and µi and λi are Lagrange multipliers. The
envelope theorem then implies that

                                          dY                               
                                               = µi Fi (li j ) j , (xi j ) j = µi yi .
                                          d Ai

If we show that µi is equal to the price of i in the competitive equilibrium, then we are done.
    Meanwhile, for each good j, either there exists another producer i using that good as an
input, or the household must consume that input (otherwise, the input is irrelevant and has
a price of zero). Hence, in a competitive equilibrium, we must have either

                                                               ∂Fi
                                                          pi         = pj                                                       (13)
                                                               ∂xi j

and/or
                                                               ∂D
                                                          Pc        = p j,                                                      (14)
                                                               ∂c j
where Pc is the ideal price index associated with D (which we can take to be the numeraire).
The expression above uses the fact that D is constant-returns-to-scale.
    On the other hand, the first-order conditions of the social planners problem implies that
for each j, either
                                             ∂Fi
                                          µi       = µj                                  (15)
                                             ∂xi j
and/or
                                                            ∂D
                                                                 = µ j.                                                         (16)
                                                            ∂c j
Hence µi = pi for every i.
                                                                                                                                  

                                                   λi = ξ to get
                                           P
Proof of Theorem 2. Differentiate              i


                             d log λi    d log ξ X d log λ j
                       λi             =ξ          −     λj           ,
                             d log Ai    d log Ai   j,i
                                                           d log A i




                                                                 51
                                   d log ξ X d log λ j /λi X d log λi
                                =ξ          −     λj          −     λj          ,
                                   d log Ai   j,i
                                                     d log Ai   j,i
                                                                       d log Ai


which we can rewrite as

                     d log λi    d log ξ X                                d log λi
                                                            !
                                                       1
                  λi          =ξ          +     λj 1 −        − (ξ − λi )          ,
                     d log Ai    d log Ai   j,i
                                                       ρ ji               d log Ai




Rearrange this to get
                              d log λi    d log ξ X
                                                                     !
                                                                1
                            ξ          =ξ          +     λj 1 −        .                    (17)
                              d log Ai    d log Ai   j,i
                                                                ρ ji

Finally, Theorem 1 implies that

                                        d2 log Y        d log λi
                                                 2
                                                   = λi          .
                                       d log(Ai )       d log Ai

Substitute (17) into the expression above to get the desired result. Lastly, if Y is homogeneous,
Euler’s theorem implies that
                                    X dY A         X
                                              i
                                                =     λi = ξ,
                                      i
                                        d Ai Y      i

hence, d log ξ/ d log Ai = 0.                                                                  

Proof of Proposition 4. We prove a slightly more general formulation with arbitrary variance
covariance matrix and an arbitrary twice-differentiable utility function.

                                                1
                                                                                
E(u(Y(A))) ≈ E u(Y(A)) + u0 (Y(A))∇Y(A)(A − A) + u00 (Y(A))(A − A)0 ∇Y(A) ◦ ∇Y(A)0 (A − A)+
                                                2
           1 0
                                            
             u (Y(A))(A − A)0 ∇2 Y(A)(A − A) ,
           2
                        1                         1                     
           = u(Y(A)) + u00 (Y(A))tr ∇Y(A) ◦ ∇Y(A)0 Σ + u0 (Y(A))tr ∇2 Y(A)Σ .
                        2                                2

Now apply Hulten’s theorem to get

                                       N                    X d2 Y   N
                      1           X              1
           = u(Y(A)) + u00 (Y(A))   λk λ j σ jk + u0 (Y(A))             σ jk ,
                      2                          2           d Ak d A j
                                       k, j                          j,k




                                                   52
with idiosyncratic shocks, this simplifies to

                                       N                 X d2 Y   N
                       1           X          1
            = u(Y(A)) + u00 (Y(A))   λ2k σ2k + u0 (Y(A))        σ2 .
                       2
                                       k
                                              2            d A2k k k




The second summand is the Lucas term (which equals zero when u is linear), and the third
summand is our term. Rearrange this to get the desired result.                         

Proof of Proposition 3.
                                       d2 log Y        d λi
                                                    =          .                    (18)
                                    d log A j log Ai d log A j
By definition
                                 d log λi              d log λ j
                                                    !
                                             1
                                           =      −1 +           ,                  (19)
                                 d log A j   ρ ji      d log A j
which simplifies to
                                d λi                   λi d λ j
                                                    !
                                             1
                                        = λi      −1 +               .              (20)
                              d log A j      ρ ji      λ j d log A j
Now apply theorem 2 to the second summand to obtain the desired result.               

Proof of Proposition 5. The allocation for labor is

                                                  θ−1
                                                          1 θ−1
                                      lig  ω0i Ai
                                             
                                                   θ     1−ωg θ
                                         =  P                   .
                                                          
                                                     θ−1 
                                                           
                                      lig  ω0j A θ 
                                                           
                                                         j


Substituting this into the utility function gives

                                                            θ(1−ωθ−1g )+ωg
                                             θ        θ−1
                              Y   X
                                        θ(1−ω )+ω θ(1−ω )+ω 
                                =    ω0i g g Ai g g                     .
                                                           
                              Y      i

   Then for this economy

                                                θ(1 − ω g ) + ω g
                               ρ ji = ρ =                               ,
                                            θ(1 − ω g ) + ω g + (1 − θ)

where ω g = 0 corresponds to
                                                 ρ = θ,




                                                    53
which is the same as no reallocation case. On the other hand, for ω g = 1,

                                                 1
                                           ρ=       ,
                                                2−θ

which is the same as the fully reallocative case. Note that this explodes when θ ≥ 2. For
ρ ∈ (0, 1) we get something in between the perfectly reallocative and no reallocation special
cases.                                                                                     

Proof of Proposition 6. Consumption is given by

                                      ! θ−1                       θ
                                                         ! θ−1  θ−1
                                      l θ            X    θ 

                           Y = AY a      + (1 − a)           − X.
                                                               
                                        l              X         

The first-order condition gives

                                   X     θ−1           −θ
                                       = YA    (1 − a)θ X Y.
                                   X

Substituting this into the production function gives
                                                     θ
                                              AYa θ−1
                                Y=                           θ
                                                                 .
                                                     θ−1  θ−1
                                    1 − (1 − a)θ YA/X

This means that                                      θ
                                              AYa θ−1
                                Y=                           1
                                                                 .
                                                     θ−1  θ−1
                                    1 − (1 − a)θ YA/X

Finally, note that
                                          d log Y
                                                  = ξ.
                                          d log A
                                                                                               

Proof of Proposition 7. This follows as a special case of Proposition 9.                       

Proof of Corollary 1. The proof is similar to that of Corollary 2.                             

Proof of Proposition 8. Denote the ith standard basis vector by ei . Then, by assumption,
Ωei = Ωe j and b0 ei = b0 e j . Repeated multiplication implies that Ωn ei = Ωn e j . This then
implies that Ψei = Ψe j so that in steady state, λi = b0 Ψei = b0 Ψe j = λ j . So the first-order
impact of a shock is the same. Furthermore, substitution into (7) shows that the second-order
impact of a shock is also the same.                                                            

                                                54
Proof of Proposition 9. Denote the N × F matrix corresponding to Ωi f by αi f . By Shephard’s
lemma,
                     d log pi               X      d log p j X d log w f
                              = −1(i = k) +   Ωi j          + αi f          .            (21)
                     d log Ak               j
                                                   d log Ak        d log Ak
                                                                                             f

Invert this system to get

                                           d log pi          X      d log w f
                                                    = −Ψik +   Ψi f           ,                                               (22)
                                           d log Ak                 d log Ak
                                                                            f


where Ψ( f ) = (I − Ω)−1 α( f ) . Note that b0 Ψ f = Λ f .
   Denote the household’s final demand expenditure share Ω0i by bi . Then, for a factor L,
we have

      d Λf     X                     X     d log w g
             =   bi (1 − θ0 )[−Ψik +   Ψig           ]Ψi f ,
    d log Ak   i                     g
                                           d log A k

                        X                   X                       X             d log w g          X      d log w g
                  +         (1 − θ j )λ j            Ω ji [−Ψik +           Ψig             + Ψ jk −   Ψ jg           ]Ψi f
                        j                        i                  g
                                                                                  d log Ak           g
                                                                                                            d log A k
                                     X
                  + (θk − 1)λk                  Ωki Ψi f .
                                       i


Simplify this to
                                                                              
                        X                X           X      d log   w      g 
     d Λ f =(θ0 − 1)    bi Ψik Ψi f −      bi Ψi f   Ψig                     ,
                                                              d  log  A
                                                                                 
                                                       g                     k
                          i                 i
                                                                         
               X                 X                   X
             +                        Ω ji Ψik Ψi f −    Ω ji Ψ jk Ψi f 
                                                                          
                  (θ j − 1)λ j 
                    j                       i                       i
                                                                                   
                 X                    X          X            d log w g         
               +     (1 − θ j )λ j      Ω ji     Ψig − Ψ jg             Ψi f 
                  j                      i         g
                                                                  d log Ak
                              X
               + (θk − 1)λk             Ωki Ψi f ,
                               i
                                                                                 
                         X                X           X        d  log       w g 
            =(θ0 − 1)    bi Ψik Ψi f −      bi Ψi f      Ψig                    ,
                                                                 d  log       A
                                                                                    
                                                           g                    k
                           i                 i
                                                                                              
                X                 X                    X               X
              +                        Ω ji Ψik Ψi f −     Ω ji Ψi f          Ω ji Ψik 
                                                                                                  
                   (θ j − 1)λ j 
                    j                       i                           i                i
                                                                            
                 X                 X      X            d log w g         
               +  (1 − θ j )λ j    Ω ji   Ψig − Ψ jg             Ψi f  ,
                    j                       i           g
                                                           d log Ak


                                                                    55
                                                                       
                       X               X              X     d log w g 
          =(θ0 − 1)    bi Ψik Ψi f −      bi Ψi f     Ψig             ,
                                                              d log Ak 
                                                                          
                         i                i             g
              X
            +    (θ j − 1)λ j CovΩ( j) (Ψ(k) , Ψ( f ) )
                 j
                                                                                  
              X              X X                     X                  X             d log w g
            +  (1 − θ j )λ j       Ω ji Ψig Ψi f −   Ω ji Ψi f    Ω ji Ψig            ,
                                                   
                                                                   
                                                                      
                                
                 j                  g         i                       i                i
                                                                                           d log A              k
                                                                       
                       X               X              X     d log w g 
          =(θ0 − 1)    bi Ψik Ψi f −      bi Ψi f     Ψig             ,
                                                              d log A
                                                                          
                                                        g             k
                         i                i
              X
            +    (θ j − 1)λ j CovΩ( j) (Ψ(k) , Ψ( f ) )
                 j
              X                X                            d log w g
            +    (1 − θ j )λ j     CovΩ(j) (Ψ(g) , Ψ( f ) )           ,
               j                 g
                                                            d log  Ak
                                                                          
                       X               X          X           d log  w g 
          =(θ0 − 1)    bi Ψik Ψi f −    bi Ψi f        Ψig               ,
                                                                d log  A
                                                                             
                                                    g                    k
                         i               i
             X                                 X        d log w g
            +    (θ j − 1)λ j CovΩ( j) (Ψ(k) −     Ψ(g)                  , Ψ( f ) )
               j                                g
                                                        d log       A  k
                                                           
                       X                 X     d log w g 
          =(θ0 − 1)    bi Ψi f Ψik −   Ψig             ,
                         i                   g
                                                   d log A k
                                                                
              X                              X      d log w g
            +   (θ j − 1)λ j CovΩ(j) (Ψ(k) −   Ψ(g)           , Ψ( f ) )
              j                              g
                                                    d log Ak
                                        X                d log w g                            X d log w g
          =(θ0 − 1)Covb (Ψ(k) −                   Ψ(g)             , Ψ( f ) ) + (θ0 − 1)(λk −   Λg           )λ f ,
                                          g
                                                         d log Ak                             g
                                                                                                   d log A k

              X                               X      d log w g
            +   (θ j − 1)λ j CovΩ( j) (Ψ(k) −   Ψ(g)           , Ψ( f ) ).
              j                               g
                                                     d log A k



Hence, for a productivity shock d log Ak , letting Λ f be demand for factor f , we have
                                                                                       
                   d Λf                          X            d log   w g             
                          =(θ0 − 1)Covb Ψ(k) −         Ψ(g)             , Ψ( f ) 
                 d log Ak                            g
                                                                d log Ak
                                                                                                          
                              X                                X           d log         w g             
                            +    (θ j − 1)λ j CovΩ j Ψ(k) −         Ψ(g)                   , Ψ( f ) 
                               j                                   g
                                                                             d log Ak
                                                                    
                                             X d log w g 
                            + (θ0 − 1) λk −
                                         
                                                  Λg                 Λ .
                                                                       f                                             (23)
                                                 g
                                                           d log Ak 



                                                                56
   We have
                      d log w f   d log Y   1 d Λf             1 d Λf
                                =         +             = λk +              .                                (24)
                      d log Ak    d log Ak Λ f d log Ak        Λ f d log Ak
Substituting this expression for back into the formula, we get
                                                                                     
               d log Λ f            1             X                                  
                         =(θ0 − 1) Covb Ψ(k) −         Ψ(g) d log Λ g , Ψ( f ) 
                                           
               d log Ak           Λf                     g
                                                                                                      
                             X           λj                  X        d   log   Λ      g             
                           +    (θ j − 1) CovΩ( j) Ψ(k) −      Ψ(g)                    , Ψ( f )  .   (25)
                              j
                                         Λf                      g
                                                                        d log Ak

The proof obtains by labelling final demand as producer 0. The derivation of the expression
for d log λi / d log Ak is similar.                                                       

Proof of Corollary 2. Note that since θi = θ for every i, market clearing for a good i (neglecting
the normalizing constants and setting the household’s price index to be the numeraire), is
                                                                     X
                                          pθi yi   =   ωθ0i Y    +             pθj y j ωθji .                (26)
                                                                         j


Hence, letting pθ y denote the vector whose ith element is pθi yi and bi = ω0i , we can write

                                              pθ y = b0 (I − ω◦θ )−1 Y,                                      (27)

where ω◦θ is the matrix of ωij raised to θ elementwise. Let b̃0 = b0 (I − ω◦θ )−1 . This is
reminiscent of the supplier centrality defined by Baqaee (2018).
   Furthermore, market clearing for labor type k is
                                                                  X
                                            wθk lk = A−1
                                                      k                      pθi yi ωθik ,                   (28)
                                                                     i


where we use the fact that productivity shocks affect only the stock of factors. Rearrange
this to get                                                
                                  θ
                                               X      θ
                                wk lk = Ak Y 
                                         −1 
                                                  b̃i ωik  ,
                                                            
                                                                                       (29)
                                                                         i

whence
                                                               ! θ1 X              θ1
                                                        Y
                                          wk =                          b̃i ωθik  .
                                                                                 
                                                                     
                                                                                                            (30)
                                                       Ak lk             i




                                                                57
To complete the proof note that

                                                              ! θ1 X              θ1
                                   X                   Y
                              Y=         wk Ak lk =                    b̃i ωθik  Ak lk .
                                                                                
                                                                    
                                                                                             (31)
                                     k                Ak lk            i


Rearrange this to get a closed form expression for output
                                                                                   θ
                                                                          θ1  θ−1
                                         X        θ−1   X                 
                                                                b̃i ωθik   .
                                                       θ
                                   Y = 
                                                                           
                                              Ak lk                                           (32)
                                                                         
                                                                               
                                           k                    i


Since Y can be written in closed-form as a CES aggregate of the underlying productivity
shocks, Corollary 2 follows immediately.                                             

Proof of Proposition 10. By Lemma (5.8) from (Theil, 1967, p.222) we know that

    log (Y(A + ∆)/Y(A))
                              1                            0 
                          =      ∇ log Y(A + ∆) + ∇ log Y(A) log(A + ∆) − log(A) + O(∆3 ). (33)
                                                                                
                              2

Hulten (1978) then implies that ∇ log Y(A) = λ(A) and ∇ log Y(A + ∆) = λ(A + ∆).                


B      Generalization of Section 3.2 to Multiple Goods
For the example is Section 3.2, the economy with extreme complementarity θ = 0 has Y =
A/a, where 1/a is the sales to output ratio in steady-state. Therefore, in this example, although
Hulten’s approximation fails in log terms, Hulten’s theorem is globally accurate in linear
terms. In other words, our examples so far may suggest that extreme complementarities
can only have outsized effects, in linear terms, if we restrict the movement of labor across
industries.
   However, this impression is false. To see this, consider a slightly more complex exam-
ple where we generalize the example above by allowing multiple industries. Aggregate
consumption is Cobb-Douglas across goods with equal weights (bi = 1/N). Each good is
produced using labor and the good itself as an intermediate input. We assume full labor
reallocation/constant returns to scale. We have
                                                      Y
                                                Y=            c1/N
                                                               i
                                                                   ,
                                                        i




                                                       58
and                                                                             θi
                                                 θi −1                θi −1  θ −1
                                                !                    !          i
                                           li θi                xi θi 
                            yi = yi Ai ωil            + (1ωil )             ,
                                         
                                            li                   xi          

with
                                                 yi = ci + xi ,

and perfect reallocation of labor. Then we have the following.

Proposition 11. Consider the model described above. Then

                                          1                 1
                                                                 
                                    1−         = (θi − 1)       −1 ,
                                          ρ ji              ωil

and
                                  d log ξ  1
                                                     
                                                       1
                                                             
                                          = (θi − 1)       −1 .
                                  d log Ai N           ωil
    In Figure 9 we plot output as a function of TFP shocks in linear terms. As promised,
this economy features strong aggregate complementarities in the sense that a negative TFP
shock can cause a drastic reduction in output even in linear terms, despite the fact that labor
can be costlessly reallocated across sectors. This happens because, in equilibrium, a negative
shock to industry i does not result in more labor being allocated to production in industry
i. This follows from the fact that consumption has a Cobb-Douglas form, and so the income
and substitution effects from a shock to i offset each other. Since no new labor is allocated
to i, if i faces a low structural elasticity of substitution θi ≈ 0, its output falls dramatically in
response to a negative shock. This can then have a large effect on aggregate consumption.
Of course, Cobb-Douglas consumption is simply a clean way to illustrate this intuition. If
the structural elasticity of substitution in consumption where less than unity (θ0 < 1), then
these effects would be even further amplified.

Proof of Proposition 11. First, consider

                                                 max yi − xi ,
                                                  xi


which has the first-order condition
                                                          !θi −1
                                                  Ai yi
                          xi = yi (1 − ωil )θi
                                                                   = yi (1 − ωil )Aθi i −1 ,
                                                   xi

where we use the fact that Xi = yi (1 − ωil ). Substitute this into the production function for yi



                                                        59
                        1




                 Y/Y   0.9




                       0.8




                       0.7                                                                        Leontief
                                                                                                  Hulten

                         0.9             0.95              1                    1.05            1.1          1.15
                                                                      A

         Figure 9: Aggregate output for the Leontief case θi ≈ 0 with two industries.


to get
                                                                  θi /(θi −1)
                                                        Ai yi a                 li /li
                                             yi =                                           .
                                                                                     θθ−1i
                                                     1 − (1 − a)Aθi i −1
                                                    
                                                                                       i



Substitute this into ci = yi − xi to get

                                                               θi /(θi −1)
                                                        Ai yi a              li /li
                                             ci =                                θ 1−1 .
                                                      1 − (1 − a)Aθi i −1              i




Substitute these into the utility function to get aggregate consumption when labor cannot be
reallocated. To get aggregate consumption when labor is reallocated, maximize aggregate
the non-reallocative solution with respect to li :

                                                            θi              θ0 −1  θ01−1
                                                             θ −1
                                                     Ai yi ai i /li
                                     N                                          
                               Y X θ0                                         
                                = 
                                                                               
                                         bi                                                l.
                                                                                     
                                                                           1 
                                                                  θ
                                                                                        
                                              (1 − (1 − ωil )A ) i  −1
                               Y  i       
                                                                  i
                                                                    i    θ −1           
                                                                                          

                                                                                                                    




                                                               60
C    Adjustment Costs in the Quantitative Model
In this section, we explain how to extend the quantitative model of Section 6.1 to allow for
adjustment costs. For each composite intermediate input, we allow for the possibility that
there are adjustment costs, indexed by κ ≥ 0, in adjusting the quantity of the input compared
to its steady-state value:                                !2 
                                                  κ X i
                                  X̂i = Xi 1 −       − 1  ,
                                                            
                                                  2 Xi

where Xi are units of good i purchased and X̂i are the units of good i actually used. When
κ = 0, there are no adjustment costs.
    Introducing adjustment costs increases the volatility of the Domar weights. For the
model with adjustment costs, we choose the value of the adjustment cost parameter κ so
that, given the microecononomic elasticities of substitution, the model matches the volatility
of the Domar weights at an annual frequency (when the model already overshoots without
adjustment costs, we set them to zero). We then keep the same value of κ when we
move quadrennial frequency. By picking a suitable value for κ, even the model with
fully mobile labor can match the volatility of the Domar weights. We report these results
in Table 2. Interestingly, once we pick κ to match the volatility of Domar weights at
annual frequency, the model also roughly matches the volatility of the Domar weights at
a quadrennial frequency. The results are consistent with what we found in Table 1. In the
final column of Table 2 we also report the value of resources destroyed by the adjustment
cost directly
                                          P                   !
                                             i pi (Xi − X̂i )
                                   ∆=E                          .
                                                GDP
In all cases, the amount of resources destroyed directly by the adjustment costs are not large
enough to mechanically drive the reductions in average aggregate output. For example,
whereas at quadrennial frequency, the reduction in expected log aggregate output is around
1.5% − 0.5% ≈ 1.0%, the value of the resources destroyed by the adjustment costs are less
than 0.5%.


D     Additional Tables and Figures




                                             61
     (σ, θ, , κ, t)             Mean      Std     Skewness     Ex-Kurtosis   σλ      ∆
     No reallocation

     (0.9, 0.5, 0.001 , 0, 1)    -0.0034   0.012        -0.18           0.1   0.115       0

     (0.9, 0.5, 0.001 , 0 , 4)   -0.0187   0.030        -1.11           3.6   0.267       0

     (0.9, 0.6, 0.2, 2, 1)       -0.0033   0.011        -0.27          0.21   0.124   0.0007

     (0.9, 0.6, 0.2, 2, 4)       -0.0152   0.028        -0.63          1.57   0.286   0.0046
     Full reallocation

     (0.9, 0.5, 0.001, 3, 1)     -0.0031   0.012        -0.25          0.26   0.124   0.0006

     (0.9, 0.5, 0.001, 3, 4)     -0.0166   0.030        -0.98          2.47   0.279   0.0046

     (0.9, 0.6, 0.2, 4, 1)       -0.0026   0.011        -0.23          0.23   0.129   0.0004

     (0.9, 0.6, 0.2, 4, 4)       -0.0140   0.029        -0.75          1.05   0.291   0.0028

Table 2: Simulated and estimated moments for the model with adjustment costs. The
simulated moments are calculated from 10,000 draws. The parameter t measures the length
of the time interval for the shocks: annual and quadrennial. Finally, the column ∆ is the
share of lost resources.




                                                   62
                                                         Mean          Std     Skewness        Ex-Kurtosis

        No reallocation, Annual                         -0.0031 0.011               -0.16              0.1
        No reallocation, Quadrennial                    -0.0173 0.027               -0.60              1.0
        Full Reallocation, Annual                       -0.0021 0.011               -0.09              0.0
        Full Reallocation, Quadrennial                  -0.0110 0.026               -0.25              0.1

Table 3: Moments of log output estimated from 50, 000 draws using the second order Taylor
approximation with the benchmark elasticities (σ, θ, ε) = (0.9, 0.5, 0.001). This is the version
of the model with no adjustment costs κ = 0.


                                0.04


                                0.02


                                   0
                    log(Y/Y)




                               −0.02


                               −0.04

                                                                       Oil
                               −0.06                                   Construction
                                                                       Hulten Oil
                                                                       Hulten Construction
                               −0.08
                                   −0.4   −0.3   −0.2    −0.1      0         0.1   0.2       0.3
                                                           log TFP

Figure 10: The effect of TFP shocks to the “oil and gas” industry and the construction
industry. Construction has a bigger sales share, but “oil and gas” is more important for large
negative shocks. This graph shows that the ranking of which industry is more important is
not monotonic in the size of the shock.




                                                         63
       (σ, θ, )              Mean       Std   Skew     Ex-Kurtosis      σλ
       (0.8, 0.5, 0.001)     -0.0023   0.011    -0.06           0.0   0.074
       (0.9, 0.5, 0.001)     -0.0022   0.011    -0.08           0.0   0.069
       (0.99, 0.5, 0.001)    -0.0021   0.011    -0.07           0.0   0.065
       (0.8, 0.5, 0.2)       -0.0020   0.011    -0.07           0.0   0.066
       (0.9, 0.5, 0.2)       -0.0020   0.011    -0.08           0.0   0.062
       (0.99, 0.5, 0.2)      -0.0019   0.011    -0.06           0.0   0.058
       (0.8, 0.5, 0.99)      -0.0014   0.011    -0.02           0.0   0.044
       (0.9, 0.5, 0.99)      -0.0013   0.011    -0.03           0.0   0.040
       (0.99, 0.5, 0.99)     -0.0013   0.011    -0.02           0.0   0.036
       (0.8, 0.4, 0.001)     -0.0023   0.011    -0.08           0.0   0.079
       (0.9, 0.4, 0.001)     -0.0022   0.011    -0.06           0.0   0.075
       (0.99, 0.4, 0.001)    -0.0022   0.011    -0.07           0.0   0.071
       (0.8, 0.4, 0.2)       -0.0021   0.011    -0.06           0.0   0.073
       (0.9, 0.4, 0.2)       -0.0021   0.011    -0.08           0.0   0.068
       (0.99, 0.4, 0.2)      -0.0020   0.011    -0.07           0.0   0.064
       (0.8, 0.4, 0.99)      -0.0013   0.011    -0.04           0.0   0.052
       (0.9, 0.4, 0.99)      -0.0014   0.011    -0.04           0.0   0.047
       (0.99, 0.4, 0.99)     -0.0013   0.011    -0.01           0.0   0.044
       (0.8, 0.6, 0.001)     -0.0022   0.011    -0.06           0.0   0.068
       (0.9, 0.6, 0.001)     -0.0021   0.011    -0.08           0.0   0.063
       (0.99, 0.6, 0.001)    -0.0020   0.011    -0.07           0.0   0.059
       (0.8, 0.6, 0.2)       -0.0021   0.011    -0.05           0.0   0.061
       (0.9, 0.6, 0.2)       -0.0020   0.011    -0.05           0.0   0.056
       (0.99, 0.6, 0.2)      -0.0020   0.011    -0.04           0.0   0.052
       (0.8, 0.6, 0.99)      -0.0014   0.011    -0.02           0.0   0.037
       (0.9, 0.6, 0.99)      -0.0013   0.011    -0.02           0.0   0.033
       (0.99, 0.6, 0.99)     -0.0013   0.011    -0.01           0.0   0.029
       (0.8, 0.99, 0.001)    -0.0022   0.011    -0.09           0.0   0.052
       (0.9, 0.99, 0.001)    -0.0020   0.011    -0.05           0.0   0.047
       (0.99, 0.99, 0.001)   -0.0021   0.011    -0.06           0.0   0.044
       (0.8, 0.99, 0.2)      -0.0021   0.011    -0.04           0.0   0.043
       (0.9, 0.99, 0.2)      -0.0019   0.011    -0.05           0.0   0.039
       (0.99, 0.99, 0.2)     -0.0018   0.011    -0.04           0.0   0.035
       (0.8, 0.99, 0.99)     -0.0013   0.011    -0.03           0.0   0.011
       (0.9, 0.99, 0.99)     -0.0013   0.011    -0.02           0.0   0.006
       (0.99, 0.99, 0.99)    -0.0013   0.011     0.01           0.0   0.001

Table 4: Annual Shocks, Model with full reallocation and no adjustment costs.




                                        64
          (σ, θ, )              Mean       Std   Skew     Ex-Kurtosis      σλ
          (0.8, 0.5, 0.001)     -0.0112   0.026    -0.31           0.3   0.178
          (0.9, 0.5, 0.001)     -0.0113   0.026    -0.28           0.4   0.176
          (0.99, 0.5, 0.001)    -0.0107   0.026    -0.27           0.3   0.163
          (0.8, 0.5, 0.2)       -0.0102   0.026    -0.25           0.2   0.162
          (0.9, 0.5, 0.2)       -0.0101   0.026    -0.23           0.1   0.152
          (0.99, 0.5, 0.2)      -0.0098   0.026    -0.22           0.2   0.144
          (0.8, 0.5, 0.99)      -0.0070   0.025    -0.09           0.0   0.113
          (0.9, 0.5, 0.99)      -0.0066   0.025    -0.09           0.1   0.103
          (0.99, 0.5, 0.99)     -0.0064   0.025    -0.09           0.0   0.095
          (0.8, 0.4, 0.001)     -0.0116   0.026    -0.32           0.3   0.228
          (0.9, 0.4, 0.001)     -0.0110   0.026    -0.32           0.3   0.228
          (0.99, 0.4, 0.001)    -0.0107   0.026    -0.27           0.3   0.212
          (0.8, 0.4, 0.2)       -0.0106   0.026    -0.27           0.3   0.201
          (0.9, 0.4, 0.2)       -0.0104   0.026    -0.24           0.2   0.195
          (0.99, 0.4, 0.2)      -0.0097   0.026    -0.25           0.2   0.173
          (0.8, 0.4, 0.99)      -0.0072   0.025    -0.09           0.0   0.134
          (0.9, 0.4, 0.99)      -0.0070   0.025    -0.09           0.0   0.125
          (0.99, 0.4, 0.99)     -0.0067   0.025    -0.08           0.0   0.117
          (0.8, 0.6, 0.001)     -0.0112   0.026    -0.26           0.2   0.159
          (0.9, 0.6, 0.001)     -0.0108   0.026    -0.27           0.3   0.149
          (0.99, 0.6, 0.001)    -0.0105   0.026    -0.26           0.2   0.140
          (0.8, 0.6, 0.2)       -0.0102   0.026    -0.23           0.2   0.143
          (0.9, 0.6, 0.2)       -0.0100   0.026    -0.23           0.2   0.133
          (0.99, 0.6, 0.2)      -0.0096   0.026    -0.20           0.1   0.123
          (0.8, 0.6, 0.99)      -0.0071   0.025    -0.07           0.0   0.093
          (0.9, 0.6, 0.99)      -0.0066   0.025    -0.06           0.0   0.083
          (0.99, 0.6, 0.99)     -0.0064   0.025    -0.06           0.0   0.075
          (0.8, 0.99, 0.001)    -0.0106   0.026    -0.20           0.1   0.112
          (0.9, 0.99, 0.001)    -0.0104   0.026    -0.19           0.1   0.103
          (0.99, 0.99, 0.001)   -0.0101   0.026    -0.19           0.1   0.096
          (0.8, 0.99, 0.2)      -0.0100   0.025    -0.15           0.1   0.093
          (0.9, 0.99, 0.2)      -0.0095   0.026    -0.14           0.1   0.085
          (0.99, 0.99, 0.2)     -0.0091   0.026    -0.13           0.1   0.078
          (0.8, 0.99, 0.99)     -0.0064   0.025    -0.02           0.0   0.024
          (0.9, 0.99, 0.99)     -0.0062   0.025    -0.01           0.0   0.013
          (0.99, 0.99, 0.99)    -0.0058   0.025     0.01           0.0   0.003

Table 5: Quadrennial Shocks, model with full reallocation and no adjustment costs.




                                           65
         (σ, θ, )              Mean       Std   Skew     Ex-Kurtosis      σλ
         (0.8, 0.5, 0.001)     -0.0036   0.011    -0.23           0.2   0.128
         (0.9, 0.5, 0.001)     -0.0034   0.012    -0.18           0.1   0.115
         (0.99, 0.5, 0.001)    -0.0032   0.011    -0.20           0.1   0.104
         (0.8, 0.5, 0.2)       -0.0026   0.011    -0.13           0.1   0.079
         (0.9, 0.5, 0.2)       -0.0026   0.011    -0.11           0.0   0.070
         (0.99, 0.5, 0.2)      -0.0025   0.011    -0.13           0.0   0.063
         (0.8, 0.5, 0.99)      -0.0014   0.011    -0.01           0.0   0.018
         (0.9, 0.5, 0.99)      -0.0014   0.011    -0.01           0.0   0.014
         (0.99, 0.5, 0.99)     -0.0012   0.011    -0.01           0.0   0.011
         (0.8, 0.4, 0.001)     -0.0039   0.012    -0.23           0.2   0.137
         (0.9, 0.4, 0.001)     -0.0035   0.011    -0.21           0.2   0.123
         (0.8, 0.4, 0.2)       -0.0028   0.011    -0.14           0.1   0.082
         (0.9, 0.4, 0.2)       -0.0026   0.011    -0.12           0.1   0.073
         (0.99, 0.4, 0.2)      -0.0030   0.011     0.15           5.9   0.065
         (0.8, 0.4, 0.99)      -0.0015   0.011    -0.05           0.0   0.020
         (0.9, 0.4, 0.99)      -0.0013   0.011    -0.05           0.0   0.016
         (0.99, 0.4, 0.99)     -0.0014   0.011    -0.04           0.0   0.014
         (0.8, 0.6, 0.001)     -0.0034   0.011    -0.20           0.1   0.122
         (0.9, 0.6, 0.001)     -0.0032   0.011    -0.20           0.1   0.109
         (0.99, 0.6, 0.001)    -0.0030   0.011    -0.14           0.1   0.098
         (0.8, 0.6, 0.2)       -0.0026   0.011    -0.12           0.0   0.077
         (0.9, 0.6, 0.2)       -0.0024   0.011    -0.11           0.1   0.068
         (0.99, 0.6, 0.2)      -0.0023   0.011    -0.10           0.0   0.061
         (0.8, 0.6, 0.99)      -0.0015   0.011    -0.05           0.0   0.016
         (0.9, 0.6, 0.99)      -0.0013   0.011     0.00           0.0   0.011
         (0.99, 0.6, 0.99)     -0.0013   0.011    -0.02           0.0   0.009
         (0.8, 0.99, 0.001)    -0.0030   0.011    -0.15           0.1   0.107
         (0.9, 0.99, 0.001)    -0.0028   0.011    -0.13           0.1   0.095
         (0.99, 0.99, 0.001)   -0.0027   0.011    -0.11           0.1   0.086
         (0.8, 0.99, 0.2)      -0.0026   0.011    -0.11           0.0   0.072
         (0.9, 0.99, 0.2)      -0.0024   0.011    -0.09           0.0   0.063
         (0.99, 0.99, 0.2)     -0.0022   0.011    -0.07           0.0   0.056
         (0.8, 0.99, 0.99)     -0.0014   0.011    -0.01           0.0   0.010
         (0.9, 0.99, 0.99)     -0.0013   0.011    -0.01           0.0   0.005
         (0.99, 0.99, 0.99)    -0.0011   0.011     0.00           0.0   0.001

Table 6: Annual Shocks, model with no labor reallocation and no adjustment costs.




                                          66
         (σ, θ, )              Mean       Std   Skew     Ex-Kurtosis      σλ
         (0.8, 0.5, 0.001)     -0.0202   0.031    -1.26           4.5   0.297
         (0.9, 0.5, 0.001)     -0.0187   0.030    -1.11           3.6   0.267
         (0.8, 0.5, 0.2)       -0.0139   0.028    -0.58           1.1   0.180
         (0.9, 0.5, 0.2)       -0.0133   0.027    -0.52           0.9   0.160
         (0.99, 0.5, 0.2)      -0.0176   0.024    -0.66           1.3   0.138
         (0.8, 0.5, 0.99)      -0.0073   0.025    -0.09           0.0   0.041
         (0.9, 0.5, 0.99)      -0.0068   0.025    -0.07           0.0   0.033
         (0.99, 0.5, 0.99)     -0.0068   0.025    -0.09           0.0   0.027
         (0.8, 0.4, 0.001)     -0.0217   0.032    -1.40           5.3   0.320
         (0.9, 0.4, 0.001)     -0.0201   0.031    -1.30           4.8   0.287
         (0.8, 0.4, 0.2)       -0.0146   0.028    -0.67           1.4   0.187
         (0.9, 0.4, 0.2)       -0.0137   0.028    -0.59           1.1   0.167
         (0.8, 0.4, 0.99)      -0.0075   0.025    -0.13           0.0   0.048
         (0.9, 0.4, 0.99)      -0.0069   0.025    -0.10           0.0   0.039
         (0.99, 0.4, 0.99)     -0.0069   0.025    -0.09           0.0   0.034
         (0.8, 0.6, 0.001)     -0.0188   0.030    -0.99           2.5   0.281
         (0.9, 0.6, 0.001)     -0.0176   0.029    -0.90           2.2   0.253
         (0.99, 0.6, 0.001)    -0.0163   0.028    -0.65           1.0   0.229
         (0.8, 0.6, 0.2)       -0.0136   0.027    -0.49           0.7   0.175
         (0.9, 0.6, 0.2)       -0.0129   0.027    -0.44           0.7   0.154
         (0.99, 0.6, 0.2)      -0.0128   0.026    -0.50           0.6   0.138
         (0.8, 0.6, 0.99)      -0.0070   0.025    -0.08           0.0   0.036
         (0.9, 0.6, 0.99)      -0.0066   0.025    -0.08           0.0   0.027
         (0.99, 0.6, 0.99)     -0.0067   0.025    -0.09           0.1   0.021
         (0.8, 0.99, 0.001)    -0.0163   0.028    -0.64           1.1   0.246
         (0.9, 0.99, 0.001)    -0.0153   0.028    -0.58           0.9   0.221
         (0.99, 0.99, 0.001)   -0.0145   0.027    -0.53           0.8   0.200
         (0.8, 0.99, 0.2)      -0.0128   0.026    -0.40           0.4   0.162
         (0.9, 0.99, 0.2)      -0.0120   0.026    -0.35           0.3   0.143
         (0.99, 0.99, 0.2)     -0.0114   0.026    -0.29           0.3   0.127
         (0.8, 0.99, 0.99)     -0.0066   0.025    -0.01           0.0   0.021
         (0.9, 0.99, 0.99)     -0.0061   0.025    -0.03           0.0   0.011
         (0.99, 0.99, 0.99)    -0.0057   0.025     0.00           0.0   0.002

Table 7: Quadrennial Shocks, model with no reallocation and no adjustment costs.




                                          67
E    Macro Moment Approximations
The notes in this section were prepared with the assistance of a research assistant Chang
He. Let output be Y(A), where A is the N × 1 vector of productivity parameters. Suppose
that A is distributed according to a multivariate normal distribution, and that the elements
of A are independent. Let Y∗ (A) be the second-order Taylor approximation of Y around the
mean vector of A.


Second-order Taylor Approximation
Let µA denote the mean vector of A. The second-order Taylor expansion of Y(A) is:

                                  N                                      N   N
                                  X ∂Y(µA )                           1 X X ∂2 Y(µA )
        Y (A) = Y(µA ) +
         ∗
                                                        (Ai − µAi ) +                    (Ai − µAi )(A j − µA j ).
                                  i=1
                                              ∂Ai                     2 i=1 j=1 ∂Ai ∂A j

We introduce the following abbreviations:

                                                         ∂Y(µA )                ∂2 Y(µA )
                                                 Yi =            ,     Yi j =             ,
                                                          ∂Ai                   ∂Ai ∂A j
                                  Z     ∞                                  Z    ∞
                          µAi =             Ai fA (Ai )dAi       µAi,k =            (Ai − µAi )k fA (Ai )dAi ,
                                      −∞                                       −∞
                                        Z    ∞Z     ∞
                             µAi ,A j                   (Ai − µAi )(A j − µA j ) fA (Ai , A j )dAi dA j ,
                                            −∞    −∞

where fA is the density function of A.


Mean Value Approximation
Let µY∗ be the mean value approximation of Y(A). We have:

                                  Z     ∞
       µY∗ = E[Y (A)] =
                      ∗
                                            Y∗ (A) fA (A)dA,
                                      −∞
                 Z   ∞                  N                         N   N
                          h            X                       1 XX                                   i
             =             Y(µA ) +           Yi (Ai − µAi ) +           Yi j (Ai − µAi )(A j − µA j ) fA (A)dA,
                     −∞                 i=1
                                                               2 i=1 j=1
                                  N      N
                        1 XX
             = Y(µA ) +           Yij µAi ,A j .
                        2 i=1 j=1




                                                                     68
    Expanding the quadratic and since elements of A are independent, we get

                                                                                          N
                                                                                       1X
                                                           µY∗ = Y(µA ) +                    Yii µAi ,2 .
                                                                                       2 i=1


Variance Approximation
Let σY2 ∗ be the variance approximation of Y(A).
                  h               i2             
         σY2 ∗ = E Y∗ (A) − Y(µA ) = E Y∗2 (A) − Y2 (µA ),
                 Z ∞h           N                       N   N
                               X                     1 XX                                   i2
               =      Y(µA ) +     Yi (Ai − µAi ) +            Yi j (Ai − µAi )(A j − µA j ) fA (A)dA − µ2Y∗ .
                  −∞           i=1
                                                     2 i=1 j=1

    Since elements of A are independent, we get

              N
              X                                                             N
                                                                            X                     N
                                                                                                  X
  σY2 ∗   =            Yi2 µAi ,2   + Y (µA ) −
                                       2
                                                    µ2Y∗   + Y(µA )                Yii µAi ,2 +          Yi Yii µAi ,3
              i=1                                                           i=1                    i=1
                                                     N                              N N                                         N X
                                                                                                                                  N
                                                    1X                             1XX                                          X
                                                +                Yii2 µAi ,4   +                   Yii Y j j µAi ,2 µA j ,2 +               Yij2 µAi ,2 µA j ,2 .
                                                    4      i=1
                                                                                   2   i=1 j=i+1                                i=1 j=i+1



Skewness Approximation
Let νY∗ be the skewness approximation of Y(A). By definition, νY∗ = µY∗ ,3 /σY3 ∗ .
                                           R∞
   Use the definition of skewness, and that −∞ Y∗2 (A) fA (A)dA = σY2 ∗ + µ2Y∗ , we have


              h               i3  Z ∞ h                 i3
µY∗ ,3    = E Y (A) − Y(µA ) =
                       ∗
                                           Y∗ (A) − Y(µA ) fA (A)dA,
                                     −∞
            Z ∞
          =     Y∗3 (A) fA (A)dA − 3µY∗ σY2 ∗ − µ3Y∗ ,
                  −∞
                                      N                         N   N                                                      3
              Z   ∞    h              X                      1 XX                                  i
          =                Y(µA ) +         Yi (Ai − µAi ) +           Yij (Ai − µAi )(A j − µA j ) fA (A)dA − 3µY∗ σY2 ∗ − µ3Y∗ .
                  −∞                  i=1
                                                             2 i=1 j=1

   Simplifying the equation above and use the fact that the elements of A are independent,
we have:


              N                                                         N                                   N                                 N
              X                             3         X                        X                        X
 µY∗ ,3 =              Yi µAi ,3 + Y (µA ) + Y2 (µA )
                            3           3
                                                          Yii µAi ,2 + 3Y(µA )     Yi2 µAi ,2 + 3Y(µA )     Yi Yii µAi ,3
              i=1
                                            2         i=1                      i=1                      i=1


                                                                                   69
             N−2 N−1 N                                        N−1 N
           3XX X                                            3XX
         +             Yii Y jj Ykk µAi ,2 µA j ,2 µAk ,2 +             Yii Yi j Y j j µAi ,3 µA j ,3
           4 i=1 j=i+1                                      2 i=1 j=i+1
                             k= j+1
                N     N                                      N                      N     N
             3 XX                                1X 2               3 XX 2
         +             Yii Y2jj µAi ,2 µA j ,4 +       Yii µAi ,6 +          Y Yij µAi ,2 µA j ,2
             8 i=1 j=1                           8 i=1              2 i=1 j=1 i
                     j,i                                                                  j,i
              N                         N−1 X N                                      N
           3X 2                 3       X                                   3       X
         +       Yi Yii µAi ,4 + Y(µA )           Yii Y j j µAi ,2 µA j ,2 + Y(µA )     Yii2 µAi ,4
           2 i=1                2       i=1 j=i+1
                                                                            4       i=1
                N     N                                           N
             3 XX                                   3X
         +             Yi Yii Y jj µAi ,3 µA j ,2 +       Yi Yii2 µAi ,5
             2 i=1 j=1                              4 i=1
                     j,i
              N N−1 N                                    N−2 N−1 N
           3 XX X                                      9XX X
         +            Yii Y jk µAi ,2 µA j ,2 µAk ,2 +
                           2
                                                                   Yij Yik Y jk µAi ,2 µA j ,2 µAk ,2
           2 i=1 j=1                                   4 i=1 j=i+1
                            k= j+1                                                    k= j+1
                     j,i     k,i
             N−1 X
                 N                                   N   N                            N−1 X N
             X                                    3 XX 2                              X
         +                Yij3 µAi ,3 µA j ,3   +          Y Y j j µAi ,2 µA j ,4 + 6           Yi Y j Yi j µAi ,2 µA j ,2
             i=1 j=i+1
                                                  2 i=1 j=1 i j                       i=1 j=i+1
                                                            j,i
                      N−1
                      X        N
                               X                                  N X
                                                                  X N                                        N X
                                                                                                             X N
         + 3Y(µA )                    Yij2 µAi ,2 µA j ,2   +3              Yi Yij Y jj µAi ,2 µA j ,3 + 3             Yi Yij2 µAi ,3 µA j ,2
                         i=1 j=i+1                                i=1 j=1                                    i=1 j=1
                                                                      j,i                                        j,i

         − 3µY∗ σY2 ∗ − µ3Y∗ .

    We can then use the expression of σY2 ∗ from previous to compute νY∗ = µY∗ ,3 /σY3 ∗ .


F    Relation to ACR
Arkolakis, Costinot, and Rodrı́guez-Clare (2012), henceforth ACR, consider an open-economy
model with no intermediate inputs and a single factor of production per country. They im-
pose some macro-level restrictions, and prove a powerful characterization of the gains from
trade. Namely, they assume that (1) trade is balanced, (2) profits are a constant share of
revenues, and (3) import demand system is CES. Using these assumptions, they show that
the gains from trade, as measured by the change in real income associated with going to
autarky, is given by the reciprocal of the domestic expenditure share raised to the reciprocal
of the trade elasticity. The ACR result, and its generalizations (summarized in Costinot and
Rodriguez-Clare, 2014), suggest that one can quantify the gains from trade without needing
to directly estimate the size of the trade shock.
    In Baqaee and Farhi (2019), we show how under certain conditions, changes in iceberg


                                                                      70
trade costs in an open-economy model can be recast as productivity shocks in an associated
closed-economy model. This then allows us to use our results to study the second-order
effects of trade shocks. For simplicity, we work with a one-factor model (like ACR), but
these results can be extended to the case of multiple factors. We also restrict ourselves to
nested-CES economies in standard form.
     We start by associating a fictitious nested-CES domestic closed-economy model to the true
nested-CES open-economy model, both in standard form. The closed economy has the same
set C of domestic producers as the open economy and the same elasticities of substitution,
but its input-output matrix Ωcij ≡ Ωij /( k∈C Ωik ) is different because each domestic producer
                                             P

only sources from other domestic producers, and not from foreign producers, where C
denotes the set of domestic producers.
     We show that effects on domestic welfare of a change in trade costs in the true open-
economy model are identical to the effects on aggregate output of a set of productivity shocks
(λic /λic )1/(1−θi ) , where λic is the domestic cost share of producer i and λic is its steady-state
value. It is straightforward to leverage our results to characterize the effects of these shocks
up to the second order. Only in some special cases resembling those underpinning our
network-irrelevance result in Corollary 1, can a global expression be derived. The baseline
ACR specification falls in this category: it has a single sector and no intermediate goods. In
                                         c
this case λc = 1 and we get Yc /Y = (λc /λc )1/(1−θ) , where λc is the domestic cost share and λc
is its steady-state value.




                                                 71
