                               NBER WORKING PAPER SERIES




                   LIQUIDITY SHOCKS AND ORDER BOOK DYNAMICS

                                            Bruno Biais
                                        Pierre-Olivier Weill

                                       Working Paper 15009
                               http://www.nber.org/papers/w15009


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     May 2009




Many thanks, for helpful discussions and suggestions, to Andy Atkeson, Dirk Bergemann, Darrell
Duffie, Emmanuel Farhi, Thierry Foucault, Christian Hellwig, Hugo Hopenhayn, Vivien Levy–Garboua,
Johannes Horner, John Moore, Henri Pages, Jean Charles Rochet, Larry Samuelson, Jean Tirole, Aleh
Tsyvinski, Jusso Valimaki, Dimitri Vayanos, Adrien Verdelhan, and Glen Weyl; and seminar participants
at the Federal Reserve Bank of Minneapolis, UCLA Economics, Toulouse, LSE, LBS, the Banque
de France Conference on Macroeconomics and Liquidity, UCSD Rady School of Business, the University
of Minnesota Carlson School of Business, UCLA Anderson, Yale University theory and macro, Harvard
University, Loyola Marymount University, the FBF-IDEI Conference on Investment Banking and
Financial Markets, and Boston University. This research benefited from the support of the “Financial
Markets and Investment Banking Value Chain Chair” sponsored by the Federation Bancaire Francaise.
The views expressed herein are those of the author(s) and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

© 2009 by Bruno Biais and Pierre-Olivier Weill. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.
Liquidity Shocks and Order Book Dynamics
Bruno Biais and Pierre-Olivier Weill
NBER Working Paper No. 15009
May 2009
JEL No. G12

                                              ABSTRACT

We propose a dynamic competitive equilibrium model of limit order trading, based on the premise
that investors cannot monitor markets continuously. We study how limit order markets absorb transient
liquidity shocks, which occur when a significant fraction of investors lose their willingness and ability
to hold assets. We characterize the equilibrium dynamics of market prices, bid-ask spreads, order submissions
and cancelations, as well as the volume and limit order book depth they generate.


Bruno Biais
Toulouse School of Economics (CNRS, IDEI)
Manufacture des Tabacs
21, allée de Brienne
31000 TOULOUSE
FRANCE
biais@cict.fr

Pierre-Olivier Weill
Department of Economics
University of California, Los Angeles
Bunche Hall 8283
Los Angeles, CA 90095
and NBER
poweill@econ.ucla.edu
      Investors do not trade each and every asset continuously. They face a multiplicity of
tasks to which they must allocate time and effort. They must participate in meetings,
interact with customers and comply with reporting requirements. In order to make
efficient financial decisions, they need to collect and process information regarding asset
supply and demand, as well as the fundamentals of underlying cash flows. In doing so
they must decide which assets to monitor in priority. Because these activities take time,
they prevent investors from continuously making trading decisions.1
      That all investors are not continuously trading reduces liquidity (Demsetz, 1968,
Garbade and Silber, 1979). However, investors can use the order book to leave limit
orders in the market. In the words of Harris (2003): “Limit orders represent absent
traders [enabling them] to participate in the markets while they attend to business
elsewhere.”
      The goal of this paper is to analyze the equilibrium dynamics of the order book
in this context. We focus on market dynamics following liquidity shocks. Liquidity
shocks arise when a significant fraction of the investor population is affected by a
change in its willingness and ability to hold assets, as in Grossman and Miller (1988).
This can occur because of changes in the characteristics of assets. For example, many
institutions are required to sell bonds which lose their investment grade status, or to
sell stocks when they are de-listed from exchanges or indices (see Greenwood, 2005).
Alternatively, liquidity shocks can reflect events affecting the overall financial situation
of a population of investors; for example, Funds experiencing large outflows must sell
their holdings, as documented by Coval and Stafford (2007). For regulatory reasons,
after large losses, banks must sell risky assets, as discussed by Berndt, Douglas, Duffie,
and Ferguson (2005) for the corporate debt market. Khandaniy and Lo (2008) discuss
how deteriorating credit portfolios and the need to reduce risk exposure compelled
hedge funds to execute large sales in equity markets in the second week of August 2007,
corresponding to a severe liquidity shock.
      To analyze the equilibrium reaction of limit order markets to liquidity shocks, we
address the following questions: How do prices react and adjust? What are the dynam-
ics of liquidity supply and demand and the corresponding evolution of the order book,
trading volume and transactions costs? What are the optimal orders for investors?
  1
    Corwin and Coughenour (2008) find empirically that specialists allocate effort towards certain
stocks, which results in them trading less frequently the other stocks they are entrusted with.


                                                2
   We study these issues in a dynamic rational expectations model: anticipating the
dynamics of prices and of the order book, agents design their optimal orders. In equilib-
rium, these orders give rise to the anticipated market dynamics. We consider an infinite
horizon, continuous–time market with a continuum of rational, risk–neutral competi-
tive investors. Each investor can hold up to one unit of the asset. The asset is in fixed
supply and a fraction of the investors is initially endowed with one unit. Investors de-
rive a utility flow from holding the asset. For high-valuation investors this utility flow
is greater than for low-valuation investors. To model the aggregate liquidity shock, we
follow Duffie, Gârleanu, and Pedersen (2007) and Weill (2007) and assume that at time
0 all investors switch to the low-valuation type. Then, as time passes, some investors
switch back to a high valuation. More precisely, each investor is associated with a
Poisson process and switches back to high-valuation at the first jump in this process.
Efficiency would require that low-valuation investors sell to high-valuation investors.
Such efficient reallocation of the asset is delayed, however, because all investors are not
continuously trading on the market. To model discontinuous market presence, we follow
Duffie, Gârleanu, and Pedersen (2005) and assume that final investors make contact
with the market at Poisson arrival times. The greater the intensity of this Poisson
process, the greater the frequency with which investors make contact with the market.
   When making contact with the market, investors can place limit orders to sell or
buy, and, if they already have orders in the order book, they can cancel or modify them.
Marketable limit orders (i.e., sell orders at prices lower than or equal to the best bid
and buy orders at prices greater than or equal to the ask) hit the market quotes and
are immediately executed. Non–immediately executed limit orders are stored in the
order book. The dynamics of the order book, in particular the evolution of the bid–ask
spread and its depth at the quotes, are endogenous.
   In equilibrium, trading occurs in continuous time, but volume, which is initially
very low, gradually increases until it reaches a maximum and then progressively dies
out. Furthermore, the equilibrium transaction price drops sharply at the time of the
liquidity shock, then gradually recovers until it reverts to its long term equilibrium level.
The initial price drop and low level of trading are the immediate consequences of the
liquidity shock. The hump–shaped pattern of trading volume and the progressive price
recovery reflect the delayed and gradual adjustment of the market due to discontinuous
market presence.

                                             3
   High valuation investors, when making contact with the market, place buy orders,
while low-valuation investors place orders to sell. The reaction of the limit order market
to the liquidity shock can be decomposed into two phases. In the first phase, buy orders
are placed at very low prices; these set the bid quote and are hit by market orders to
sell. But, as time passes buy orders are placed at higher and higher prices. In the second
phase, buy orders have reached such high prices that they now hit the ask quotes in
the order book. The behavior of the low-valuation investors also varies during the two
phases. Initially, they are indifferent between i) placing limit orders to sell at high
prices or ii) immediately hitting the bid quote. During this first period, their non–
immediately executed orders are placed at lower and lower ask prices. In the second
phase, the low-valuation investors place market orders to sell.
   Thus, after the shock, there is initially a convergence process, by which the market
ask quote declines and the market bid quote increases. Correspondingly, the bid–ask
spread declines and depth on the ask side of the order book grows, beginning at high
prices, then at progressively lower prices. What is the rationale for this pattern? For
a low-valuation investor considering how to price her limit sell order, the following
tradeoff arises: If she sets a higher price, the benefit is that she gets a better deal. But
the cost is that she must wait longer. The cost of waiting is the time value of money,
minus the expected utility derived from holding the asset while waiting. Consider a
given execution time. For early investors, the probability of switching to high valuation
prior to this time is higher than for investors arriving on the market later. Thus, at
this execution time, the expected utility derived from holding the asset while waiting is
higher for early investors than for late investors. Consequently, early investors have a
lower cost of waiting and place orders to sell at higher prices than late investors. Hence,
the order book progressively fills on the ask side, first at high prices and subsequently
at progressively lower prices.
   Our theoretical analysis generates several empirical implications in line with stylized
facts. Order placement activity concentrates at the best quotes and orders of similar
type tend to follow each other (in the first phase of our equilibrium there is a sequence of
market sell orders, while in the second phase there is a sequence of market buy orders.)
Both of these implications are in line with the order book and flow dynamics empirically
evidenced by Biais, Hillion, and Spatt (1995). The implications of our theoretical model
are also in line with the empirical findings of Da and Gao (2007) and Khandaniy and

                                             4
Lo (2008), that after a liquidity shock there is a sharp decline in price and strong order
flow imbalance reflecting selling pressure, and then the price gradually recovers.
       Progress in communications technology and the computerization of exchanges and
trading rooms have reduced the cost of market access. An important recent develop-
ment is algorithmic trading, which increases the speed with which investors can process
information and which reduces the cost of implementing trading strategies. In the lan-
guage of our model, this corresponds to an increase in the rate at which investors make
contact with the market. Hendershott, Jones, and Menkveld (2007) offer an empirical
study of these developments. Their proxy for algorithmic trading is the ratio of the
number of messages (new order placements, cancelations and modifications) to volume
traded. They find that this ratio increases, especially as the market becomes more com-
puterized. In the context of our model, this ratio can be analyzed, along with its link to
the rate at which traders make contact with the market. Consistent with the evidence
of Hendershott, Jones, and Menkveld, we show that as the rate at which investors make
contact with the market grows larger, so too does the ratio of the number of messages
to trading volume. This result stems from two facts. On the one hand, trading vol-
ume is bounded above by its Walrasian level, which is finite. On the other hand, as
the rate at which investors make contact with the market grows larger, traders place
more demanding orders and cancel and modify them frequently and quickly. This is in
line with the stylized fact that on electronic markets, with the progress of algorithmic
trading, cancelations have become very frequent (see Hasbrouck and Saar, 2009). Has-
brouck and Saar provide evidence that quickly canceled limit orders often correspond
to modifications, whereby the order is resubmitted at another price or transformed into
a market order. These two phenomena become prevalent in our equilibrium as the
intensity of contact with the market grows large.
       This paper is the first to introduce limit orders into the liquidity paradigm initiated
by Duffie, Gârleanu, and Pedersen (2005).2 By doing so, we add to the rich literature
   2
    Duffie, Gârleanu, and Pedersen (2002) apply the paradigm to markets for borrowing stocks.
Vayanos and Wang (2007), Weill (2008) and Vayanos and Weill (2008) study cross-sectional asset
pricing in multi-asset extensions of the original model. Lagos and Rocheteau (2009) and Gârleanu
(2009) demonstrate that relaxing the asset holding constraint can have important impact on asset
prices and on the entry decisions of intermediaries. Mı́nguez Afonso (2008) studies the externalities
involved in investors’ entry decisions. Weill (2007), Lagos, Rocheteau, and Weill (2007) and Weill
(2008) study the liquidity provision of intermediaries in response to liquidity shocks similar to the one
studied in the present model. Finally, Duffie and Manso (2007) and Golosov, Lorenzoni, and Tsyvinski
(2008) study the diffusion of private information about asset payoffs in search-and-matching financial


                                                   5
on limit order markets (see the insightful survey by Parlour and Seppi, 2008). The
first dynamic models of limit order books were offered by Foucault (1999) and Parlour
(1998). The former proposes an elegant rational expectations model in which orders
reflect the anticipations of traders about future market prices, but traders and orders
survive only one period. The latter provides a rich analysis of the dynamics of depth
with long lived orders, but the bid and ask quotes are exogenous. Foucault, Kadan, and
Kandel (2005) offer an interesting analysis of long lived orders and endogenous quotes,
but only quote improving orders are allowed, while cancelations and modifications are
ruled out. Rosu (2009) presents a fully dynamic model, where traders arrive on the
market at Poisson times; he provides an insightful analysis of the game played by
strategic traders, and characterizes Markov perfect equilibria, where only the number of
buyers and sellers matters. Because traders are large relative to the market, their orders
have an impact on prices, which Rosu (2009) characterizes. While these papers take a
game theoretic approach to analyze interactions between traders with market power,
we study a continuum of competitive agents, where orders reflect investors’ marginal
valuation of the asset rather than strategic considerations. This different approach
demonstrates that, with imperfect monitoring and discontinuous market presence, the
forces of competition and market clearing yield order book dynamics consistent with
several stylized facts. It also enables us to study how, in this context, the joint evolution
of pricing, orders and cancelations reflect the structure of valuations in the population
of investors as well as the trading technology.
   The next section presents our model. Section 2 characterizes the equilibrium. Sec-
tion 3 presents implications from our analysis. Section 4 discusses the robustness of
our results. The last section presents our conclusions. Proofs not given in the text are
in the appendix, or in the addendum to this paper (Biais and Weill, 2009), which also
presents additional useful computations and results and an extension of our model.
markets. Asset liquidity has also been analyzed within the monetary search models of Kiyotaki and
Wright (1989) and Lagos and Wright (2005): see, for instance, Lagos (2005), Lester, Postelwaite, and
Wright (2009a,b) and Rocheteau (2009).




                                                 6
1     Model
1.1    Asset and agents
Consider the market for an asset, in positive supply s ∈ [0, 1). The economy operates in
continuous time and is populated by a [0, 1] continuum of infinitely lived, competitive
and risk-neutral investors who discount the future at the same rate r > 0. Investors can
hold either zero or one unit of the asset and derive either high or low utility from holding
the asset. For high-utility investors, the utility flow per unit of time is normalized to
θ(t) = 1. For low-utility investors, it is equal to θ(t) = 1 − δ, where δ > 0. There is
also a Treasury bill with return r.
    At time 0, the market is hit by an aggregate liquidity shock, reducing the utility
flow to 1 − δ for all investors. But the liquidity shock is transient. Thus, as time goes
by, investors randomly switch back to the high utility state, and stay there forever.
For simplicity, we assume that the times at which investors switch back to high–utility
are exponentially distributed, with parameter γ, and are independent across investors.
Hence the law of large numbers (Sun, 2006) applies and the measure of high-utility
investors at time t, denoted by µh (t), is equal to 1 − e−γt . That is, the measure of
high–utility investors at time t is equal to the probability of being high–utility at that
time, conditional on being low–utility at time zero. Because all investors start in the
low state, we have µh (0) = 0.
    Conditional on being in the low state at time t, the probability that an individual
investor has switched to the high state by time u ≥ t is:

                                               µh (u) − µh (t)
                                 πh (t, u) =                   .                        (1)
                                                 1 − µh (t)

The numerator is the measure of investors who switch from low to high in the interval
[t, u], and the denominator is the measure of investors who are still in the low state at
time t. Dividing by (u − t) and taking the limit as u goes to t, we obtain the hazard
rate of switching from low to high utility at time t, which is equal to γ.
    Note that, since
                                      s < 1 = lim µh (t),                               (2)
                                                t→∞

it follows that, in the steady state, the marginal investor has a high utility. We denote



                                                7
by Ts the time at which the measure of investors with high–utility reaches s:

                                              µh (Ts ) = s.

The evolution of µh (t) and the construction of Ts are illustrated in Figure 1.3

                               µh (t)



                           1


                          s




                              0
                                                                          time
                                   0         Ts

 Figure 1: The time path of the fraction µh (t) = 1 − e−γt of high-valuation investors




1.2     Walrasian Equilibrium
First consider the benchmark case where market monitoring is perfect and costless and
all investors are permanently ready to trade. The investors are competitive and take the
market-clearing price p(t) as given. In equilibrium, p(t) must be such that the marginal
investor is indifferent between holding the asset and holding the Treasury bill. After
time Ts , the mass of investors who derive high–utility from holding the asset is greater
than s. Hence the marginal investor is a high–utility type and the price is:

                                                     1
                                               p(t) = .
                                                     r
   3
     An alternative specification, closer in spirit to Grossman and Miller (1988), would be to assume that
investors come from two separate populations: a population of low–valuation investors who initially
hold the asset, and a population of high–valuation investors who progressively enter the economy
according to the function µh (t). In Section IV of the Addendum (Biais and Weill, 2009), we show that
this approach would yield similar results.


                                                    8
Before time Ts , in contrast, the marginal investor derives low–utility from holding the
asset. Hence, the price must be such that,

                                    rp(t) = 1 − δ + ṗ(t).

This equality ensures that, during a small time interval [t, t + dt], the marginal investor
is indifferent between holding the Treasury bill and holding the asset. Indeed, the left–
hand–side of the inequality is the instantaneous return on investing p(t) dollars in the
Treasury bill. The right–hand–side sums the marginal-investor utility flow from holding
one share, and the capital gain from buying one share at t and selling it at t + dt. The
above conditions imply that, at time t ≤ Ts , the Walrasian price is equal to:

                                          1 − δ δ −r(Ts −t)
                                 p(t) =        + e          .
                                            r   r

      Thus, the price deterministically increases until it reaches 1/r at Ts . One may
wonder why investors do not immediately bid up this predictable price increase? This
is because the demand for the asset builds up slowly: on the extensive margin, high-
valuation investors cannot hold more than one unit of the asset; and, on the intensive
margin, the recovery from the aggregate liquidity shock occurs progressively as investors
switch back to high utility flows. Such slow demand build up has been observed in many
markets (see e.g., Coval and Stafford, 2007) and reflects “limits to arbitrage.”4
      The greater the initial liquidity shock (δ), the lower the price. Also, the lower the
rate at which agents switch back to high utility (γ), the greater the time it takes for
the market to recover (Ts ), and the lower the price.
      In the Walrasian market, trading volume can be readily characterized. Before time
Ts , µh (t) < s and all high–utility investors hold one share. Conversely, the only investors
who do not hold the asset are low–utility types. Hence there is a mass 1 − s of low
utility investors who do not own the asset. Trading occurs as these investors switch (at
rate γ) to high utility and purchase the asset from low–utility owners. This generates
an instantaneous trading volume equal to γ(1 − s)dt. After time Ts , all assets are in
the hands of high-valuation investors forever, and the trading volume is zero.
  4
    See Lagos and Rocheteau (2009) and Gârleanu (2009) for a comprehensive analysis of position
limits in search-and-matching financial markets.




                                               9
2         Trading with imperfect monitoring
2.1         How the limit order book works
Denote by ρ > 0 the intensity of market monitoring and assume that investors establish
contact with the market at Poisson arrival times with intensity ρ. Contact times are
independent across investors and independent from investors’ utility processes.5 When
an investor contacts the market, she trades through a limit order book. She can place
market buy or sell orders immediately executed at the current ask or bid. Otherwise she
can place limit sell (resp. buy) orders at prices strictly above (resp. below) the current
market quotes, which are not immediately executed. When contacting the order book,
investors can also update and cancel any existing limit order. We assume that order
placement, modification or cancelation are costless.
        A limit order to sell submitted at time t at limit price p is filled after the first time
the market price is greater than or equal to p, according to standard price and time
priority rules. That is, it is executed at the limit price p i), before sell orders at higher
prices (price priority) and ii) before limit sell orders at the same price submitted after t
(time priority). The case of limit buy orders is symmetric. In equilibrium, the number
of (market or limit) buy orders executed at time t at the current market price p(t) must
equal the number of (market or limit) sell orders filled at that price.


2.2         Equilibrium
We consider competitive equilibria where investors take the price and order book process
as given, and respond to this process by placing optimal limit or market, buy or sell
orders. In equilibrium, the price and order book process resulting from these orders is
that which had been anticipated by the agents, and the market clears at each point in
time.
        In the remainder of this paper, we restrict our attention to the class of monotone
limit order equilibria (MLOE), defined as equilibria whose price paths have the following
property:

        – deterministic, bounded, piecewise continuously differentiable,
    5
    In Section 4, we relax this assumption and consider what happens when, with some probability,
investors contact the market as soon as their type changes. There we show that the qualitative features
of our equilibrium are robust to that extension.


                                                  10
   – strictly increasing over some initial time interval [0, Tf ), for some 0 ≤ Tf ≤ ∞,

   – constant at all subsequent times, [Tf , ∞).

These restrictions are satisfied, in particular, by the Walrasian price path decribed
above.


2.3      A Unique Candidate Equilibrium
2.3.1    Elementary Properties of an Equilibrium

We first show that a MLOE must have the following elementary properties:

Lemma 1. In an MLOE, i) p(Tf ) = 1/r, ii) Tf < ∞, and iii) Tf > 0.

   To see why points i) and ii) in Lemma (1) hold, note that, if either Tf < ∞
and p(Tf ) < 1/r, or if Tf = ∞ and p(Tf ) = limt→∞ p(t) ≤ 1/r, then at each time
p(t) < 1/r, implying that high-valuation investors find it strictly optimal to buy and
hold the asset. Thus, asymptotically all high-valuation investors would hold the asset,
which is impossible given that the asset supply s is less than the asymptotic measure
of high-valuation investors, limt→∞ µh (t) = 1. If, on the other hand p(Tf ) > 1/r, then
for all t large enough no investor would be willing to hold the asset, which also cannot
be the basis of an equilibrium.
   To see why point iii) holds, note that if Tf = 0, the price is immediately equal to
1/r at time zero. But, at that time all investors have a low-valuation and thus prefer
to sell since the price is 1/r. Thus, the market supply in a time interval of length ∆
around zero is ρs∆ + o(∆). By the same token, since the measure of high-valuation
investors is very close to zero, the demand is of order o(∆). So the market cannot clear.
Our next lemma states that there is no limit buy order before Tf :

Lemma 2. In an MLOE, when coming into contact with the market during [0, Tf ), an
investor does not find it optimal to submit a limit buy order.

   This lemma stems from the fact that a limit order to buy at price p < p(t) will never
be executed and can therefore be ignored, while a limit buy order at price p > p(t) is
executed immediately at price p(t) and is therefore equivalent to a market order.
   Given that Lemma 2 allows us to ignore limit-buy orders, we may categorize in-
vestors into 6 types. An investor’s type includes her utility flow (high “h,” or low “ℓ”)

                                           11
and her ownership status (non–owner “n,” or owner). We also distinguish asset owners
who have not previously placed a limit sell order in the order book (“o”) from owners
who have previously placed a limit sell order in the book (“b”). Of course, these in-
vestors differ in terms of their limit prices, but we need not keep track of these at this
stage of the analysis. The set of investor types is, then:

                                    {hn, ℓn, ho, ℓo, hb, ℓb} .

2.3.2     The demand of high-valuation investors

First, it is easy to show that, in an MLOE, the asset demand of high-valuation investors
has essentially the same form as in the Walrasian case:

Lemma 3. In an MLOE the following trading plan is strictly optimal for high-valuation
investors coming into contact with the market at time t ∈ [0, Tf ):

        ho: hold on to the asset until at least Tf ;

        hb: cancel any previously placed limit order, then behave as ho;

        hn: buy immediately, then behave as ho.

After Tf , the same plan is weakly optimal.

   The trading plan of hn investors reflects that, since the price is increasing towards
1/r, it is optimal to buy as quickly as possible. Together with investors’ ability to
submit limit sell orders, the lemma implies:

Lemma 4. The price path is continuous.

   Indeed if the increasing price process were to jump up at some time t ∈ [0, Tf ], an
investor would strictly prefer to submit a limit order to sell immediately after the jump,
rather than a (market or limit) sell order just before the jump. Thus, the asset supply
just before the jump would be zero. This contradicts market clearing since Lemma 3
shows that the demand is strictly positive at all times t ∈ [0, Tf ).




                                               12
2.3.3   The supply of low-valuation investors

Next, we study the problem of low-valuation investors. To that end, it is convenient to
identify a sell order with its execution time, which we denote by z. Consider an investor
who contacts the market at time t. If she places a market sell order, it is immediately
executed, i.e., z = t. Since the price is strictly increasing over [0, Tf ), a limit sell order
at price p(z) ∈ (p(t), 1/r) corresponds to execution time z > t. Submitting no sell order
or submitting limit prices above 1/r results in no execution, which can be identified
with execution time z = ∞. Lastly, the execution time for the limit price 1/r belongs to
[Tf , ∞) and is determined by time priority; as will become clear below, in equilibrium
this must be equal to Tf . Now let Vℓn (t) be the value (maximum attainable utility) of
an ℓn investor and Vℓb (t, z) be that of a ℓb investor with a previously submitted limit-sell
order to be executed at time z > t. To determine which orders are optimal, we study
the function
                            Nℓ (t, z) ≡ Vℓb (t, z) − [Vℓn (t) + p(t)],                     (3)

which is the net utility of submitting a limit sell order to be executed at z, rather than
a market sell order. The value obtained with the latter is the current market price p(t),
plus continuation value Vℓn (t).
   To analyze Nℓ (t, z), consider the derivative ∂Nℓ (t, z)/∂z, which is the marginal value
of increasing execution time by dz and behaving optimally thereafter. Note first that
the change in execution time is relevant only if the next contact time with the market is
greater than z, an event occurring with probability e−ρ(z−t) . In that event, the increase
in execution time has two effects. First, the investor enjoys the asset longer, until z +dz,
and receives the expected utility

                          Et [θ(z)] dz = (1 − δ) dz + δπh (t, z) dz,                       (4)

i.e. the investor always enjoys utility flow 1 − δ, but on top of this she may enjoy δ if
she has switched to high–utility at some point in the interval [t, z], which happens with
probability πh (t, z). The second effect is that the limit order is executed at time z + dz
instead of time z. The corresponding net utility is

                          p(z + dz)
                                    − p(z) dz = (ṗ(z) − rp(z))dz,                         (5)
                           1 + rdz


                                               13
where ṗ(z) is the left derivative of the price path, which is well defined given that the
price is continuous (Lemma 4) and piecewise continuously differentiable by assumption.
The first term on the right-hand side of (5) is the capital gain of selling at a later time.
The second term is the time cost of delaying the sale. Taking the two effects of equations
(4) and (5) together, multiplying by the discount factor e−r(z−t) and by the probability
e−ρ(z−t) that the execution time is indeed greater than the next contact time, we obtain
the marginal value of increasing the execution time z:

                  ∂Nℓ
                      (t, z) = e−(r+ρ)(z−t) [1 − δ + δπh (t, z) + ṗ(z) − rp(z)] .           (6)
                   ∂z

Integrating over [t, z], and keeping in mind that Nℓ (t, t) = 0, because a limit order to
sell at time z = t clearly yields the same utility as a market sell order at time t, we
obtain our next lemma:

Lemma 5. For a low-valuation investor, the net utility of submitting a limit sell order
is                           Z   z
               Nℓ (t, z) =           (1 − δ + δπh (t, u) + ṗ(u) − rp(u)) e−(r+ρ)(u−t) du.   (7)
                             t
     But when z ≥ Tf , we have p(z) = 1/r: thus, equation (6) shows that

                                        ∂Nℓ
                                            (t, z) < 0 when z ≥ Tf .                         (8)
                                         ∂z

This has two implications.
     First, at any time, low-valuation investors do not find it optimal to submit limit
orders with execution time z > Tf . This leads to the next lemma, pinning down the
execution time of a limit sell order at price 1/r.

Lemma 6. In an MLOE, at any time t < Tf , a limit sell order at price 1/r is executed
at time Tf .

     Intuitively, if the execution time were strictly larger than Tf , then low-valuation
investors would prefer to submit limit sell orders at a price just below 1/r, which would
be executed just before Tf . But this also implies that the measure of limit sell orders
at price 1/r would be zero, and therefore the execution time for orders placed at price
1/r would be equal to Tf , a contradiction.
     The second implication of (8) is that a low-valuation investor holding on to his
his asset will find it optimal to submit some limit sell order. Consider, for instance,

                                                      14
the submission of a limit order with a limit price just below 1/r, executed just before
Tf , and focus on the case where the investor does not re–contact the market prior to
that time, so that his initial order is relevant. Then there are two scenarios: either
the investor has switched to high utility by Tf , and since the limit price is 1/r he is
indifferent between selling and not selling. Or, the investor still has low–utility, in which
case he strictly prefers to sell at price 1/r. This yields our next lemma:

Lemma 7. A low-valuation investor strictly prefers to submit some (limit or market)
sell order executed at some time z ≤ Tf , rather than simply holding on to her asset
until her next contact time with the market (z = ∞).

   Based on Lemma 6 and 7, there is no loss of generality in restricting attention to
execution times in [t, Tf ]. Optimal sell orders are, then, characterized by the correspon-
dences:

                                 Φ(t) = arg max Nℓ (t, z)
                                                z∈[t,Tf ]

                                 φ(t) = Φ(t) ∩ (t, Tf ].

   In words, the set Φ(t) contains all optimal execution times, and the set φ(t) contains
the execution times of optimal, not immediately executed, limit sell orders. Namely, if
t ∈ Φ(t), then placing a market order is optimal, while if z ∈ φ(t), then placing a limit
sell at price p(z) is optimal.
   This bring us to a key property of our model: investors who contact the market
relatively early are more willing to choose relatively late execution times.

Proposition 1. Consider some contact time t and suppose there is some z ∈ φ(t).
Then, for all t′ ∈ (t, z], Φ(t′ ) ⊆ [t′ , z]. In particular, Φ(z) = {z}.

   That is, if the investor contacting the market at time t finds it optimal to place a
limit order to sell executed at time z > t, then the investor contacting the market at a
later time t′ > t finds it optimal to place an order executed earlier, i.e., between t′ and
z. In particular, a low-valuation owner contacting the market at time z would place a
sell order executed at time z, i.e. a market sell order.
   To prove the proposition, we re-scale the net utility Nℓ (t, z) by e−(r+ρ)t and take the



                                               15
derivative with respect to z:

             ∂  −(r+ρ)t          
                e        Nℓ (t, z) = e−(r+ρ)z [1 − δ + δπh (t, z) + ṗ(z) − rp(z)] .    (9)
             ∂z

This is simply the marginal value of delaying, but measured in time-zero consumption
units. Observe that the derivative (9) is decreasing in the contact time t; indeed, the
only way it depends on the contact time t is through the probability πh (t, z) that dur-
ing [t, z] there was a switch to high utility. Now, that probability is higher for early
t’s because early investors have more time to switch to high utility during [t, z]. This
property makes the low-valuation investor’s problem sub-modular: the cross-derivative
of the value with respect to the “type” (the contact time) and the “action” (the exe-
cution time) is negative. This implies that low types, who contact the market early,
choose higher actions, i.e., limit orders with higher limit prices that are executed at
later times. Thus, as time passes, sellers place limit orders at lower and lower prices.
This is similar to undercutting except that it is not driven by strategic considerations.
Rather, it stems from the evolution of the agent’s preferences toward liquidity.

2.3.4     Market Clearing

The next proposition describes the implications of market–clearing for the supply stem-
ming from low–valuation agents before Ts :

Proposition 2. In an MLOE, market clearing implies that the following trading plan
must be optimal for low-valuation investors coming into contact with the market at time
t ∈ [0, Ts ∧ Tf ):

        ℓo: sell with a market order; or place a limit order executed at some time z ∈ φ(t);

        ℓb: cancel previously placed limit order and behave as ℓo;

        ℓn: stay put.

In addition, during any measurable set of times T ⊆ [0, Ts ∧Tf ), low-valuation investors
                             R
collectively submit a measure T ρ(s−µh (t)) dt of limit sell orders to be executed at some
time z ≥ Ts ∧ Tf .

    It is important to keep in mind that Proposition 2 does not establish the optimality
of the trading plan. Instead, it shows what trading plan low-valuation investors must

                                               16
follow in order for the market to clear, given the restrictions imposed by Proposition 1.
We will verify optimality below, in Section 2.4.
   To prove the proposition, consider any measurable set of times T ⊆ [0, Ts ∧ Tf ). The
total measure of high-valuation investors contacting the market during T is equal to
R                                                                               R
 T
   ρµh (t) dt, and the total measure of assets brought to the market is equal to T ρs dt.
According to Proposition 3 all high-valuation investors must exit the market with one
unit of the asset. Since for all t < Ts , we have the inequality µh (t) < s, this implies
that there remains a measure
                                  Z
                                       ρ(s − µh (t)) dt > 0                            (10)
                                   T


of assets that must be held by some other investors. Since limit-buy orders are not
submitted, the assets cannot be held by investors who previously posted limit-buy
orders. Therefore, the measure of assets given by (10) must be held by the low-valuation
investors who contact the market during T. In turn, we know from Lemma 7 that a
low-valuation investor who contacts the market and chooses to hold on to an asset finds
it optimal to submit some limit sell order. Hence, the measure of assets given by (10)
must be held by low valuation agents willing to postpone their sales and correspondingly
place limit orders to be executed at later times. Thus, the measure of limit sell orders
submitted during T must be greater than or equal to (10).
   In the appendix we show that, at all times in [0, Ts ∧ Tf ), limit orders are never
executed. Thus, during T buy orders are executed against market sell orders and
low-valuation investors must find it optimal to submit market sell orders. A further
implication is that all limit sell orders submitted during T can be executed only at
z ≥ Ts ∧ Tf . Lastly, this implies that the measure of limit sell orders submitted during
T must be exactly equal to (10). Indeed, the only way there could be a strict inequality
                                                                     R
is if the measure of assets supplied to the market were greater than T ρs dt, which is
impossible since limit-sell orders are never executed. The next step is to show:

Lemma 8. In an MLOE, Tf > Ts .

   Suppose instead that Tf ≤ Ts . By Proposition 2, at all times in t ∈ [0, Tf ), φ(t) 6= ∅,
i.e., investors submit limit orders. Proposition 2 showed that φ(t) ≥ Ts ∧ Tf = Tf , and
Lemma 7 showed that φ(t) ≤ Tf . Thus, φ(t) = Tf for all t ∈ [0, Tf ). Now, since any


                                              17
limit order submitted in [0, Tf ) is executed with a probability bounded away from zero,6
This results in a positive measure of orders being executed exactly at time Tf . But this
cannot be the basis of an equilibrium since, on the other side of the market, there are
no market buy orders and the measure of investors who contact the market exactly at
time Tf is equal to zero. Thus we can state our next proposition.

Proposition 3. In an MLOE the following trading plan is strictly optimal for low-
valuation investors coming into contact with the market at (almost all) times t > Ts :

       ℓo: sell with a market order;

       ℓb: cancel previously placed limit order and behave as ℓo;

       ℓn: stay put.
                                                                                      R
In addition, during any measurable set of times T ⊆ (Ts , Tf ), a measure               T
                                                                                            ρ (µh (t) − s) dt
of limit sell orders is executed.
                                                                                               R
    Proceeding as above, we know that during T there is a cumulative measure                     T
                                                                                                     ρµh (t) dt
of high-valuation investors who all exit the market with one unit of the asset. Since
µh (t) > s, it follows that the asset demand of high-valuation investors cannot be met
       R
using T ρs dt, the measure of assets supplied by those investors who contact the market
during T. Thus, asset demand must be met by the limit order book, and the measure
of limit sell orders executed from the book must be greater than:
                                         Z
                                               ρ (µh (t) − s) dt.                                       (11)
                                           T

    Note that this implies in particular that limit orders are executed at almost all times
in t ∈ (Ts , Tf ). Thus, by Proposition 1, Φ(t) = {t} at almost all times t ∈ (Ts , Tf ) and
market sell orders are strictly optimal for low-valuation investors. One can easily show
that this is also true at t ≥ Tf .
    Next, we argue that the measure of executed limit-sell orders must, in fact, be equal
to (11). Indeed, there are only two reasons why it could be strictly greater than (11).
First, there could be a positive measure of limit buy orders, which is ruled out by
    6
      Indeed, a limit sell order submitted at time t corresponding to execution time z > t will be executed
if the investor does not manage to re-contact the market and cancel it, which occurs with probability
e−ρ(z−t) ≥ e−ρTf > 0.


                                                     18
Lemma 2. Second, low-valuation investors could submit a positive measure of market
buy orders. But this is impossible since we just showed that market sell orders are
strictly optimal at almost all times in (Ts , Tf ).
       We proceed with additional properties of the correspondence φ(t), which specifies
the optimal execution times of orders placed at time t:

Proposition 4. The correspondence φ(t) is i) non-empty, ii) single valued, ii) strictly
decreasing, iv) continuous in t ∈ [0, Ts ) and v) satisfies φ(0) = Tf and limt→Ts φ(Ts ) =
Ts .

       The intuition is that, otherwise, there would be either holes or atoms in the limit
order book. Holes cannot be the basis of an equilibrium since we know that limit
orders must be executed at almost all times in (Ts , Tf ). Atoms are not consistent with
equilibrium either since there are no limit-buy orders and, at any point in time, the
demand originating from those investors who contact the market is a “flow” of measure
zero.7
       The next proposition states the integral equation, which pins down the function
φ(t):

Proposition 5. For all t ∈ [0, Ts ), φ(t) is the unique solution of:
                             Z    φ(t)
                                         ρ (s − µh (u)) e−ρ(φ(t)−u) du = 0.                     (12)
                              t

       In order to prove this Proposition, we let L(z, φ(t)) denote the cumulative number
of orders in the book at time z, to be executed before time φ(t). By construction,
L(z, φ(t)) = 0 for z ≤ t and for z ≥ φ(t). For z ∈ [t, φ(t)], we derive an ordinary
differential equation (ODE) for L(z, φ(t)) in several steps.
   First, we know from Proposition 2 that the measure of new limit sell orders submit-
                                        Rv
ted during [u, v] ⊆ [0, Ts ) is equal to u ρ(s − µh (z)) dz. We also know from Proposition
3 that the measure of limit orders executed during any time interval [u, v] ⊆ (Ts , Tf )
  Rv
is u ρ(µh (z) − s) dz. In addition to these new order submissions and executions, all
investors with a limit order outstanding who establish a new contact with the market
find it strictly optimal to cancel their limit sell order. This results in a cumulative
   7
    Note that the continuity of φ(t) means that limit orders are executed at all times in (Ts , Tf ).
This implies in turn that the trading plan of Proposition 3 is optimal everywhere instead of almost
everywhere.


                                                     19
                                        Rv
number of cancelations equal to          u
                                             ρL(z, φ(t)) dz. Putting these results together, we
find that
                                           Z       v                     Z   v
           L(v, φ(t)) − L(u, φ(t)) = −                 ρL(z, φ(t)) dz +     ρ (s − µh (z)) dz
                                               u                          u
                                     |                   {z         }   |         {z        }
                                                   cancelations        new submissions and executions


Taking derivatives yields the ODE:8

                          ∂L
                             (z, φ(t)) = −ρL(z, φ(t)) + ρ (s − µh (z)) .
                          ∂z

Integrating this ODE with initial condition L(t, φ(t)) = 0, we obtain that L(z, φ(t)) is
given by the left-hand side of equation (12). One easily sees that this equation has a
unique solution z > Ts .

2.3.5      The price path

The first-order necessary condition for the execution time φ(t) to be optimal at time
t ∈ [0, Ts ) is

                   ∂Nℓ
                       (t, φ(t)) = 0 ⇔ rp(t) = 1 − δ + δπh (φ−1 (t), t) + ṗ(t),                        (13)
                    ∂z

after applying equation (6) and rearranging. This leads to the following intuition:
consider an order that will be filled at time t ∈ [Ts , Tf ]. This order was placed previously,
at time φ−1 (t). At that time, the investor optimally chooses the price of the limit order,
to equalize the cost of waiting a short while longer before execution, rp(t), with the
benefits of trading slightly later but at a better price. That benefit is equal to the
expected flow of utility from holding the asset, 1 − δ + δπh (φ−1 (t), t), plus the price
increase, ṗ(t).
       Another optimality condition is that, during [0, Ts ), a low-valuation investor must
be indifferent between selling immediately with a market sell order, or selling with a
limit sell order executed at time φ(t). Thus, the net utility of submitting a limit-sell
order executed at time φ(t) is Nℓ (t, φ(t)) = 0. Given that φ(Ts ) = Ts and Nℓ (t, t) = 0,
   8
    Clearly, L(z, φ(t)) is bounded by s so we can bound above the integrand above and obtain that
L(z, φ(t)) is Lipchitz with coefficient 2ρs, and therefore continuous. Since the integrand is continuous,
L(z, φ(t)) is continuously differentiable with respect to z.




                                                         20
this is the same as:
                                dNℓ             ∂Nℓ
                                    (t, φ(t)) =     (t, φ(t)) = 0.
                                 dt              ∂t
where the first equality follows from the envelope condition. Taking derivatives in
equation (7), using Nℓ (t, z) = 0, this equation becomes:
                                               Z       φ(t)
                                                              ∂πh
                   1 − δ + ṗ(t) − rp(t) = δ                      (t, u)e−(r+ρ)(u−t) du.   (14)
                                                   t           ∂t

This yields the following intuition. As time elapses during [0, Ts ), the “marginal” low-
valuation investor must remain indifferent between market sell or limit sell orders. That
is, his value of delaying the submission of a market sell order must be equal to his value
of delaying the submission of a limit sell order, holding the optimal execution time,
φ(t), constant. The value of delaying submission of a market sell order is given by the
left-hand side of equation (14), while the value of delaying submission of a limit sell
order is, on the right-hand side, the change in the expected present value of utility flows
over the interval [t, φ(t)]. Taken together, this gives:

Proposition 6. In an MLOE, before Tf , the price path solves the ODEs:
                                                       Z   φ(t)
                                                   ∂πh
          t ∈ [0, Ts ],    rp(t) = 1 − δ − δ             (t, u)e−(r+ρ)(u−t) du + ṗ(t)     (15)
                                             t      ∂t
         t ∈ [Ts , Tf ],   rp(t) = 1 − δ + δπh (φ−1 (t), t) + ṗ(t),                       (16)

and, for t ≥ Ts , p(t) = 1/r.

2.3.6   Uniqueness

Taken together, the propositions of this section imply that an MLOE is uniquely char-
acterized: investors’ trading plans follow Proposition 3, 2, and 3 with execution times
given by Proposition 5. On the other hand, the price is given by Proposition 6. This
allows us to state our uniqueness theorem.

Theorem 1. If an MLOE exists, it is unique.


2.4     Completing the Existence Proof
The next step is to show that the price path and trading plans are indeed the basis
of an equilibrium. To that end, we first note that, by construction of the trading

                                                   21
plans, the market clears at each date: supply expressed at the current market price is
equal to current demand. Next, we observe that, so long as the price of Proposition
6 is strictly increasing over [0, Tf ], we know from Proposition 3 that high-valuation
investors’ trading plan is optimal at all times, and from Proposition 3 that the low-
valuation investors’ trading plan is optimal after Ts . Thus, in order to establish that our
candidate is indeed an equilibrium, we need only show that the price path of Proposition
6 is strictly increasing over [0, Tf ] and that the trading plan of low-valuation investors is
optimal over [0, Ts ]. We prove these properties in the appendix, leading to our existence
theorem:

Theorem 2. There exists an MLOE.


3     Implications
3.1    Trading volume
During the time interval [0, Ts ], the dynamics of the measure of hn investors is

                               µ̇hn (t) = −ρµhn (t) + γµℓn (t),                          (17)

where µhn (t) and µℓn (t) denote the measure of hn and ℓn investors, and µ̇hn (t) =
d/dt[µhn(t)]. The first term on the right-hand side of (17) arises because, during a
short time interval, there is a flow ρµhn (t) of hn investors who contact the market. All
of them submit market buy orders and become ho investors. The second term arises
because there is a flow γµℓn dt of ℓn investors who switch to a high utility.
    Since µhn (t) + µℓn (t) = 1 − s, we have that µℓn = 1 − s − µhn (t) which, together
with (17) implies that

                           µ̇hn (t) = −(ρ + γ)µhn (t) + γ(1 − s).

With the initial condition that µhn (0) = 0, solving this ODE gives:

                                         γ(1 − s)             
                             µhn (t) =            1 − e−(ρ+γ)t .
                                          ρ+γ

During the interval [t, t + dt] a fraction ρdt of the hn investors contact the market.


                                              22
Hence, prior to Ts , instantaneous trading volume is equal to:

                                                    ρ               
                      V(t) = ρµhn (t) = γ(1 − s)       1 − e−(ρ+γ)t                  (18)
                                                   ρ+γ

Equation (18) yields our first implication.

Implication 1. Trading volume with imperfect monitoring is lower than its Walrasian
counterpart (γ(1 − s)).

   To study how the intensity of market monitoring affects trading volume, differentiate
V( · ) in (18) with respect to ρ. This yields

                   ∂V       γ(1 − s) −(ρ+γ)t (ρ+γ)t
                      (t) =          e      (γe     − γ + ρ(ρ + γ)t),
                   ∂ρ       (ρ + γ)2

which is positive. This yields our second implication:

Implication 2. Trading volume increases with the intensity of market monitoring.

   This is intuitive. If high-utility investors can contact the market more often, trading
volume goes up. Note also that, as ρ goes to infinity, volume goes to γ(1 − s), which is
the trading volume in the Walrasian market.
   Since (18) is symmetric in ρ and γ we also obtain the following implication.

Implication 3. Trading volume increases in the rate at which low utility investors
switch to high utility.

   Indeed, in this model it is the buyer side of the market that constrains trading, so
if there are more high utility investors eager to buy, there is more trade. An increase
in γ generates an increase in the flow of new high utility investors.
   On the other hand, inspecting (18), one can see that volume goes down with s. This
is similar to what happens in the Walrasian case and arises because trading volume
reflects the number of low-valuation non-owners who switch to high utility and later
contact the market: an increase in s mechanically reduces the number of non-owners,
and results in a decrease in volume.




                                              23
3.2    The number of orders in the book
As in the proof of Proposition 5, we let L(z, φ(t)) denote the stock of limit orders in
the book at time z, to be executed before time φ(t):
                                             Z    z
                       L(z, φ(t)) =                   ρ (s − µh (u)) e−ρ(z−u) du.
                                              t


Setting t = 0, this yields the stock of limit orders in the book at time z:
                                                      Z    z
                   L(z) ≡ L(z, φ(0)) =                         ρ (s − µh (u)) e−ρ(z−u) dz.   (19)
                                                       0

Substituting the value of µh (t) in equation (19), we get:
                                 Z       z                 
                        L(z) =               ρ s − 1 + e−γu e−ρ(z−u) du.
                                     0


So the derivative of L(z) with respect to γ is:
                               Z     z
                                         −ue−γu e−ρ(z−u) du < 0.
                                 0


Thus, we state our next implication.

Implication 4. The smaller the rate γ at which investors switch back to high utility,
the greater the need to use limit orders to wait for counterparties, and the larger the
number of orders accumulated in the book.

   The implication suggests that when the liquidity shock is severe so that it takes a
long time for investors to recover their willingness to hold the asset, the limit order
book is very useful.


3.3    How the limit order market absorbs the liquidity shock
As discussed in Section 3, before time Ts , the flow of low-valuation investors is greater
than the flow of high-valuation investors. We interpret this as a buyers’ market. In
this context, low-valuation investors who own the asset are indifferent between placing
limit orders to sell and market orders to sell. These market orders are immediately
executed, at the current market price, against the flow of orders to buy. The latter
can be interpreted as marketable orders to buy, setting the bid price, which is also the


                                                           24
current transaction price.
   In contrast after time Ts , the flow of low-valuation investors is lower than the flow of
high-valuation investors. We interpret this as a sellers’ market. High-valuation investors
buy at the limit selling price established by previously placed orders, i.e., the buyers
hit the ask quote.
   We summarize this in the following implication.

Implication 5. After the liquidity shock, there are two market regimes: before Ts , there
is a buyers’ market, in which market orders to sell repeatedly hit the bid quote, while
after Ts there is a sellers’ market, in which market orders to buy repeatedly hit the ask
quote. And, during the first phase, there is a sequence of new limit orders to sell placed
within the best quotes and undercutting each other.

   These patterns are consistent with the stylized facts observed in limit order markets
- in particular, the fact that similar order types tend to follow each other (see Biais,
Hillion, and Spatt (1995), Griffiths, Smith, Turnbull, and White (2000) and Ellul,
Holden, Jain, and Jennings (2007)).
   Our results also have implications for the dynamics of the spread and the order book
during these two regimes. These are illustrated in Figure 2. The following implication
is in line with the figure.

Implication 6. Just after liquidity shock, the spread is large. Then, limit orders to
sell accumulate in the order book, driving down the ask quote, and limit buy orders are
placed at higher and higher levels. This results in a decrease in the bid–ask spread.
Also, the number of orders in the book is very low just after the shock. But, as new
limit orders to sell are placed in the book, depth progressively builds up. Yet, at some
point, cancelations and executions of market buy orders lead to a decrease in the stock
of limit orders in the book.


3.4    Technological Change
Over the last 20 years, the technology involved in exchange trading has improved dra-
matically. The ability for investors to observe market quotes and trades and rapidly
place orders has expanded. Agents increasingly rely on computers to collect and process
information, generate alerts on market movements and inform trading and investment

                                            25
                                             new limit orders
                                       at lower and lower prices


                                                                   p(t)

          bid ask
           spread




                                                                           t
                                        Ts           Tf
          stock
     of limit orders




                                                                           t

                       Figure 2: Price and order book dynamics


decisions. An extreme and important form of the development of such computerization
has been the growth of algorithmic trading.
   Hendershott, Jones, and Menkveld (2007) offer interesting evidence on these issues.
They proxy algorithmic trading by the ratio of the number of new orders, modifications
and cancelations (i.e., messages) to trading volume. The idea is that, without algo-
rithmic trading, investors will use a few large orders, while with algorithmic trading
they will split up these orders in several smaller ones and often cancel and revise these
orders. Hendershott, Jones, and Menkveld also take advantage of the fact that, during
the period of their study, the NYSE progressively implemented its “autoquote” sys-
tem, which facilitates the placement of electronic orders, and thus algorithmic trading.
These authors find that, as “autoquote” was implemented, the proxy for algorithmic

                                             26
trading (i.e., the ratio of messages to volume) went up.
   Our analysis offers a framework to shed light on these technological evolutions. The
growth of algorithmic trading and exchange computerization correspond to an increase
in the speed with which agents contact the market, i.e., in our model an increase in ρ.
For simplicity, in this subsection, we focus on the case where ρ goes to infinity, i.e., the
market approaches the continuous trading Walrasian benchmark. Our first result is:

Implication 7. For each t ∈ (0, Ts ], as ρ goes to infinity, the number of orders in the
book at time t converges to limρ→∞ L(t) = s − µh (t).

   Since, in the limit µho (t) = µh (t), it follows that s − µh (t) is equal to the number
of assets in the hands of low-utility investors. Therefore, in the limit, although agents
can effectively trade continuously, the limit order book is not empty. Intuitively, low-
valuation investors who choose not to trade now always post a limit order, because there
remains a remote chance that they are not able to re-contact the market very quickly.
Correspondingly, since orders in the book are associated with limit prices greater than
p(Ts ) > p(t), the bid-ask spread at time t < Ts converges to some non-zero limit. Now,
turning to the behavior of cancelations:

Implication 8. For each t ∈ (0, Ts ), as ρ goes to infinity, the flow of cancelations goes
to infinity. Moreover, it is strictly increasing in ρ, for sufficiently large ρ.

   The intuition for this result is as follows: at any time t < Ts , the flow of cancelation
is equal to
                                       C(t) = ρL(t).

Thus, since the order book does not become empty as ρ goes to infinity, the flow of
cancelations goes to infinity. The proof of monotonicity is in the appendix. Finally,
consider the flow of messages and its relation to trading volume, the statistics studied
empirically by Hendershott, Jones, and Menkveld (2007):

Implication 9. For each t ∈ (0, Ts ), as ρ goes to infinity, the ratio of messages to
volume goes to infinity. Moreover, it is strictly increasing in ρ, for sufficiently large ρ.

   The flow of messages at time t is

                      M(t) = ρµℓo (t) + 2ρµℓb (t) + ρµhb (t) + ρµhn (t),

                                             27
which is the sum of four components:

     – The flow ρµℓo (t) of ℓo investors contacting the market, whose message is an order
       to sell.

     – Twice the flow of ρµℓb (t) of ℓb investors who contact the market, because these
       agents send two messages: they cancel their sell order and submit another one.

     – The flow ρµhb (t) of hb investors contacting the market, whose message is to cancel
       their limit sell order.

     – The flow ρµhn (t) of hn investors contacting the market, whose message is to
       submit a market order to buy.

     Rearranging, we obtain:
                                                           
    M(t) = ρ µℓo (t) + µℓb (t) − µhn (t) + ρ µℓb (t) + µhb (t) + 2ρµhn (t)
                                                           
         = ρ µℓo (t) + µℓb (t) + µℓn (t) − µℓn (t) − µhn (t) + ρL(t) + 2V(t)
                                                                   
         = ρ 1 − µh (t) − (1 − s) + ρL(t) + 2V(t) = ρ s − µh (t) + ρL(t) + 2V(t)
                       
         = ρ s − µh (t) + C(t) + 2V(t).


That is, the flow of messages is the sum of the flow ρ(s − µh (t)) of new limit orders, the
flow C(t) of cancelations, and twice the volume. One sees that, although the volume
is bounded, the number of messages goes to infinity as ρ goes to infinity. The ratio of
messages to volume is equal to
                                                       
                                            ρ s − µh (t) + C(t)
                                 M(t)
                                      =2+                         .
                                 V(t)               V(t)

The proof that this ratio increases in ρ is in the appendix.


4      Robustness
In this section, we examine the robustness of our results to relaxing i) the assumption
that preference switching times and market contact times are independent, and ii) the

                                               28
assumption that the intensity of preference switching (γ) is constant.


4.1     Synchronizing contact times with switching times
Investors could benefit from synchronizing switching and contact times. In particular,
this could enable them to avoid the execution of a limit sell order after switching
to a high valuation. As we show below, our results are robust to allowing for such
synchronization.
   Consider the following variant of our framework: as in the main model, we let an
investor’s total intensity of contact with the market be ρ, and a low-valuation investor’s
switching intensity be γ. We depart from the main model by assuming that a low-
valuation investor can partially synchronize his switching time with his contact time.
Namely, we assume that, conditional on switching to a high-valuation, a low-valuation
investor instantly contacts the market with probability ε ∈ [0, 1]. To keep low-valuation
investors’ total contact intensity equal to ρ, we assume that he makes additional contacts
with the market, at independent Poisson arrival times with intensity ρ − γε. Note that
if ε = 0, we obtain of course our main model without synchronization. If ε = 1, then
there is perfect synchronization and switching times always coincide with contact times.
In between, there is partial synchronization.
   What is, under partial synchronization, a low-valuation investor’s marginal value of
increasing his execution time z? As before, the change in execution time is relevant
only if the investor does not re-establish contact between the contact time, t, and the
execution time, z. Conditional on this event, the marginal value is:

            ∂  −(r+ρ)t          
               e        Nℓ (t, z) = e−(r+ρ)z [1 − δ + δπhε (t, z) + ṗ(z) − rp(z)] ,
            ∂z

but with πhε (t, z) ≡ 1 − e−γ(1−ε)(z−t) . This is the same formula as before except that the
probability πhε (t, z) is different. To understand why, recall that πhε (t, z) is the probability
that one’s utility is high at time z conditional on having a low utility at time t, and
not contacting the market during [t, z]. Thus, the switching intensity that matters for
πhε (t, z) is γ(1 −ε) < γ, the arrival intensity of a switching time that is not synchronized
with a contact time.
   Our key observation is that, although the marginal future value of delaying differs,
as long as ε < 1 it remains a decreasing function of the contact time, t. This implies

                                               29
that the result of Proposition 1 goes through identically: low valuation investors find
it optimal to undercut each others so long as there is some (possibly arbitrarily small)
synchronization problem.
       Having established that the order submission problem of low-valuation investors is
essentially the same as before, one can solve for an MLOE characterized by two times
T1 < T2 where at any time t ∈ [0, T1 ], low-valuation investors submit limit orders to be
executed at some time φ(t) ∈ [T1 , T2 ], for some strictly decreasing function φ(t). This
is stated in the next proposition, whose proof is sketched in the appendix.

Proposition 7 (Equilibrium with Synchronization). Suppose ρs > γε and ε < 1. Then
there is an MLOE that is identical to that of Theorems 1 and 2 after making the change
of variable πhε (t, z) = 1 − e−γ(1−ε)(z−t) and µεh (t) = 1 − (1 − γε/ρ)e−γt .

       The Proposition shows that our main results continue to hold if investors can syn-
chronize their switching times and their contact times, as long as two conditions are
satisfied.
       The first condition is that ρs > γε. If this condition is not satisfied, the price
immediately adjusts to 1/r and limit orders are never submitted. The reason is that,
with synchronization, the sample of investors in contact with the market is no longer
representative of the overall population. Instead, it is biased toward high-valuation
investors. The added buying pressure can be large enough to make the number of
high-valuation investors in contact with the market larger than the number of assets
brought to the market, even at time zero.9 In that case, high-valuation investors must be
made indifferent between holding the asset or not holding it, and the price immediately
adjusts to 1/r. In that case, as we already know from Proposition 4, all low-valuation
investors in contact with the market find it optimal to submit market sell orders.
       The second condition is that ε < 1. If this condition is not satisfied, then although
the equilibrium characterization would also work, low-valuation investors are indifferent
regarding the execution time of their limit order. It would then be possible to construct
other equilibria where successive limit orders to sell would no longer necessarily undercut
each other. Thus, as long as the limit order book at T1 remains constant, different
patterns of evolution of the order book before T1 are consistent with equilibrium. The
   9
     This is, in fact, the meaning of condition ρs ≤ γε: the flow of assets brought to the market, ρs, is
less than the flow of low-valuation investors who switch to highvaluation at time zero, and immediately
make contact with the market.


                                                   30
proposition suggests, however, a natural way to select among all these equilibria: by
setting ε arbitrarily close to 1, investors face a small synchronization problem and
strictly prefer to adopt decreasing order submission strategies.


4.2    Time varying switching rate
Returning to the case where the times at which agents switch to high utility and at which
they contact the market are independent, consider now the case where the intensity of
switching, γ, is time-varying.
   In this generalized framework, let the hazard rate of switching be some positive
function γ(t), resulting in the aggregate dynamics:
                                                    Rt
                                                         γ(z) dz
                                  µh (t) = 1 − e−   0              .

Then, one easily shows that the entire uniqueness proof goes through identically; the
existence result, however, may fail to hold. This is because, for some specifications
of γ(t), the price path of Proposition 6 may fail to be increasing. The next corollary
provides such a counterexample.

Corollary 1. Suppose that the hazard rate of switching is γ̄ initially, during some time
interval [0, T̄ ], and γ < γ̄ for t ≥ T̄ . Let γ̄ → ∞, holding γ̄ T̄ constant. Then, for γ̄
large enough, the price of Proposition 6 is decreasing for t ∈ [0, T̄ ].

   The intuition is that, as time elapses during the initial time interval [0, T̄ ] without
switching, we progressively approach the interval [T̄ , ∞), where the switching intensity
is much lower. Thus, a low valuation investor becomes more and more pessimistic about
her probability of switching in the near future. Now recall that that price must keep
these increasingly pessimistic low-valuation investors indifferent between selling imme-
diately and waiting until the best execution time or the next contact time (whichever
comes first). Corollary 1 shows that, when γ̄ is large enough, low-valuation investors’
pessimism increases so much that the price stated in Proposition 6 declines.
   Note that the effect of Corollary 1 relies on making low-valuation investors more
and more pessimistic about their probability of switching before the execution time or
the next contact time. If ρ → ∞, the next contact time comes much more rapidly than
the execution time, and the probability of switching to high utility becomes negligible

                                             31
anyway. Thus, the effect of Corollary 1 does not operate. In that case, we obtain the
following corollary.

Corollary 2. Suppose that γ(t) is continuously differentiable and strictly positive.
Then, if ρ is large enough, the price of Proposition 6 is strictly increasing.

    Together with our findings discussed above that, even when ρ goes to infinity, the
limit order book does not become empty and the bid–ask spread remains strictly pos-
itive, Corollary 2 shows that our equilibrium is quite robust to letting ρ become very
large.


5        Conclusion
This paper offers a continuous time model of order book dynamics, in which the ar-
rival of traders is random. The order flow, including the placement of limit orders,
cancelations & modifications, as well as the dynamics of prices and trading volume, are
endogenous. We find that, after a liquidity shock, there are two phases. First, there is
a “buyers’ market,” in which the flow of sell orders exceeds the flow of buy orders and
trades hit the bid quote. During that phase, the bid-ask spread is initially high, but
progressively tightens, while in parallel, the depth in the order book builds up. Second,
there is a “sellers’ market, ” in which the flow of buy orders exceeds the flow of buy
orders, and trades hit the ask side of the order book. The dynamics generated by our
model match the stylized facts on order books, with clustering of activity at the best
quotes, undercutting, and serial correlation in order types.
    Our model also sheds light on the consequences of the increased computerization of
markets & the growth of algorithmic trading. Our analysis implies that these changes
imply an increase in trading volume and an even stronger increase in message traffic,
corresponding to frequent cancelations and modifications. These results also corrobo-
rate empirical evidence.
    In future research we plan to extend this framework to endogenize information and
market structures.




                                            32
A       Proofs
A.1      Proof of Lemma 1
To keep the appendix short, we omit the proof and relegate it to the Addendum, Section I.1, page 2.


A.2      Proof of Lemma 3
After Tf , since p(Tf ) = 1/r, a high-valuation investor is indifferent between buying and selling the
asset. Next, consider what happens before Tf .
    First, consider a high valuation agent who does not own the asset (hn) and contacts the market at
time t ∈ [0, Tf ). If he behaves according to the prescribed trading plan of purchasing the asset at t and
afterwards follows the optimal policy of keeping the asset, his value is 1/r − p(t). To check optimality,
by the Bellman principle it suffices to rule out one-stage deviations, whereby an investors deviates once
from the prescribed plan, and follows it thereafter. If the high–valuation non–owner deviates once by
not submitting a market buy order his value is
                                                                     
                                                              1
                                      Vhn (t) = E e−r(τ −t)     − p(τ ) ,                                        (20)
                                                              r

where τ is the next of the agent’s contact with the market. This is strictly less than

                                                       1
                                                         − p(t),                                                 (21)
                                                       r

because the price is strictly increasing and because of discounting. Note that, by Lemma 2 we do not
need to check deviation involving limit buy orders.
    Second consider a high-valuation investor who owns the asset. The value of following the prescribed
plan of holding on to the asset until at least Tf , is equal to 1/r. If the agent deviates once and submits
an order to sell at time z ≥ t, his value is:
                        Z   z∧τ                                                        
                                                                                1
                   Et      e−r(u−t) du + e−r(z∧τ −t) (p(z) + Vhn (z))) I{z<τ } + I{z≥τ }
                       t                                                        r
                                                                
                   1                                    1
              =      + Et e−r(z∧τ −t) p(z) + Vhn (z)) −     I{z<τ } ,
                   r                                    r

where Vhn (z) is defined in equation (20). The value above is lower than 1/r, because, from equations
(20)-(21), it follows that p(z) + Vhn (z) − 1/r < 0 for all z < Tf . This shows that a high-valuation
investor is strictly better off holding on to her asset until at least Tf .                     QED


A.3      Proof of Lemma 4
Lemma 9. The difference between the value derived from placing a limit sell order to be executed at
time z and placing a market sell order is
                                                Z   z∧τ                                                    
                                                                   −r(u−t)            −r(z∧τ −t)
                  N (t, z) =       −p(t) + Et              θ(u)e             du + e                p(z ∧ τ ) .   (22)
                                                 t




                                                             33
    The proof goes as follows. Consider a “limit order investor” who submits at time t a limit sell
order to be executed at time z, and a “market order investor” who submits at time t a market sell
order. These investor have different value (maximum attainable utilities) for three reasons.

   1. First, of course, at time t, the market order investor sells immediately so he receives p(t) while
      the limit order investor receives nothing at that time.

   2. Second, the limit order investor continues to hold the asset until either the execution time z or
      the next contact time τ with the market, enjoying the utility:
                                             Z     z∧τ
                                                         e−r(u−t) θ(u) du,
                                               t

       given any realization of the valuation and contact time processes.

   3. Third, there is a difference in continuation utility at z ∧ τ . In order to calculate this difference,
      consider as before a given realization of the utility and contact time process and distinguish
      two cases. First, if z ∧ τ = z, i.e. if the execution time comes before the next contact time,
      then the difference in continuation utility is simply p(z). Indeed, the limit order is executed,
      the limit-order investor becomes a non-owner with the same valuation and contact time history
      as the market order investor, so from time z on he has the same continuation utility. If, on
      the other hand, z ∧ τ = τ , i.e. if the next contact time comes before the execution time, then
      the difference in continuation utility is also p(τ ). Indeed at their next contact time the only
      difference between the limit order and the market order investor is that the limit order investor
      owns the asset. The limit order investors can always sell his asset and obtain the continuation
      utility of the market order investor, by adopting the same trading plan. The same is true for
      the market order investor when he purchases the asset. Thus, the difference in continuation
      utility at time τ between the two investors is simply the value p(τ ) of the asset.

    Thus, given any realization of the contact time and valuation processes, the net utility of a limit
order is:                        Z z∧τ
                         −p(t) +        θ(u)e−r(u−t) du + e−r(z∧τ −t)p(z ∧ τ ) .
                         | {z }                           |       {z         }
                         point 1 |t        {z         }         point 3
                                           point 2

Thus, after taking expectation bearing in mind that the distribution of contact time and valuation
processes are the same for the limit order and market order investor, we obtain that the net utility of
submitting a limit sell order rather than selling is as given in the lemma.                          QED
     Let us now prove that the price path is continuous. First the price is constant for all t ∈ (Tf , ∞)
so, obviously, it is also continuous in that interval. Consider now any time t ∈ [0, Tf ]. By construction,
in an MLOE, the price is increasing so it cannot have negative jumps; thus, the only thing we need
to show is that the price cannot have positive jumps. Towards a contradiction, suppose there were a
positive price jump at some time v ∈ [0, Tf ]. Consider a small time interval before v where the price
is continuous (such an interval must exist given that the price is assumed to be piecewise continuously
differentiable). Now take any time u in that interval, and any investor who contacts the market at
some t ≤ u. Let us calculate the net-utility of submitting a sell order at a price just slightly below




                                                         34
p(v + ), which is executed at time v, rather than a sell order executed at time u:
                                                        Z v∧τ                                          
      +                                         −r(u−t)               −r(z−t)        −r(v∧τ −t)    +
N (t, v ) − N (t, u) =    Et I{u≤τ } −p(u)e             +       θ(z)e         dz + e            p(v ∧ τ )
                                                           u
                            h                                                 i
                      ≥   Et I{u≤τ } −p(u)e−r(u−t) + e−r(v∧τ −t)p(v + ∧ τ )
                            h                    h                                      ii
                      =   Et I{u≤τ } e−r(u−t) E −p(u) + e−r(v∧τ −u)p(v + ∧ τ ) | τ ≥ u
                            h                 i     h                                       i
                      =   Et I{u≤τ } e−r(u−t) × E −p(u) + e−r(v∧τ −t) p(v + ∧ τ ) | τ ≥ u
                                       n             h                             io
                      =   e−(r+ρ)(u−t) −p(u) + E e−r(v∧τ −u) p(v + ∧ τ ) | τ ≥ u
                                       n                                            o
                      ≥   e−(r+ρ)(u−t) −p(u) + Pr(τ ≥ v | τ ≥ u)e−r(v−u) p(v + )
                                   n                             o
                      ≥   e−(r+ρ)v −p(v) + e−(r+ρ)(v−u) p(v + ) .

The equality between third to the fourth line follows because the only random variable in the expecta-
                                                                                    
tion is τ , so the conditional expectation E −p(u) + e−r(v∧τ −u) p(v + ∧ τ ) | τ ≥ u is in fact a deterlmin-
istic function of u. The last inequality shows that N (t, v + ) − N (t, u) is bounded below by a continuous
function of u, independent of the contact time t, with limit e−(r+ρ)v {−p(v) + p(v + )} > 0 as u goes
to v. Hence, for all execution times u close enough to v, investors strictly prefer to delay their order
until v + because they foresee the jump. It follows that, in a small time interval to the left of v, there
are no limit-sell order nor market sell order executed. On the other hand, since v < Tf , we know from
Lemma 3 that the demand originating from high-valuation non-owners is positive. To see why, note
that the measure of high-valuation non-owners in the overall population is bounded below by:

                                            e−ρt (1 − s)µh (t),

which is the measure of high-valuation non-owners who never contacted the market at time t. Indeed,
e−ρt is the measure of investors who, at time t, have never contacted the market. Since they never had
the opportunity to trade, the proportion of non-owner in this subpopulation stays the same over time
so it must be equal to its time-zero value, 1 − s. This explains the second term of the product. Lastly,
each of these investors is equally likely to be have valuation at time t, with a probability µh (t). Thus,
in any time interval of length ∆ before, v, the cumulative demand originating from high valuation
investors is bounded below by:
                                       ρe−ρv (1 − s)µh (v)∆ + o(∆).

Since we know from above that the supply is zero, it follows that the market does not clear, a contra-
diction.                                                                                         QED




                                                    35
A.4       Proof of Lemma 5
We start from equation 28 in Lemma 9.
                                           Z z∧τ                                          
          Nℓ (t, z) =        −p(t) + Et             θ(u)e−r(u−t) du + e−r(z∧τ −t) p(z ∧ τ )
                                               t
                                Z z∧τ                                                        
                         =   Et           Et [θ(u)] e−r(u−t) du − p(t) + e−r(z∧τ −t) p(z ∧ τ )                            (23)
                                    t
                                Z z∧τ                                                                  
                         =   Et           (1 − δ + δπh (t, u)) e−r(u−t) du − p(t) + e−r(z∧τ −t)p(z ∧ τ )                  (24)
                                    t
                                Z z∧τ                                                      
                         =   Et           (1 − δ + δπh (t, u) + ṗ(u) − rp(u)) e−r(u−t) du                                (25)
                                Zt z                                                            
                         =   Et         I{u≤τ } (1 − δ + δπh (t, u) + ṗ(u) − rp(u)) e−r(u−t) du
                             Z z t
                                              
                         =        Et I{u≤τ } (1 − δ + δπh (t, u) + ṗ(u) − rp(u)) e−r(u−t) du                             (26)
                             Zt z
                         =        (1 − δ + δπh (t, u) + ṗ(u) − rp(u)) e−(r+ρ)(u−t) du,                                   (27)
                               0

where equation (23) follows because of the independence between the contact time and the valuation
process, equation (24) follows because of the definition of πh (t, u), equation (25) follows because p(t)
is continuous and piecewise continuously differentiable, so we can write that
                                                                      Z   t2
                                        −r(t2 −t1 )
                              p(t2 )e                 − p(t1 ) =               (ṗ(u) − rp(u)) e−r(u−t1 ) ,
                                                                       t1


on any interval [t1 , t2 ]. Equation (26) follows after changing the order of the expectation and the
integration sign and noting that, at each time u, I{u≤τ } is the only random variable in the integrand.
Lastly, equation (27) follows from the fact that Pr(τ ≥ u | τ ≥ t) = e−ρ(u−t) .                   QED


A.5       Proof of Lemma 6
To keep the appendix short, we omit the proof and relegate it to Addendum, Section I.2, page 3.


A.6       Proof of Proposition 1
Consider any time t and suppose there exists z ∈ φ(t). Then, we have that for all z ′ > z,
                                                        Z     z′
                                          ′
           0 ≤ Nℓ (t, z) − Nℓ (t, z ) ⇔ 0 ≥                        (1 − δ + δπh (t, u) + ṗ(u) − rp(u)) e−(r+ρ)(u−t) du
                                                          z
                Z   z′
                                                                                            ′
      ⇒    0>            (1 − δ + δπh (t′ , u) + ṗ(u) − rp(u)) e−(r+ρ)(u−t ) du ⇔ 0 < Nℓ (t′ , z) − Nℓ (t′ , z ′ ),
                z

for all t′ ∈ (t, z], and where the move from a weak to a strict inequality follows because πh (t, u) is
strictly decreasing in t. This means that, for all t′ ∈ (t, z] the execution time z strictly dominates
all subsequent execution times, implying that Φ(t′ ) ⊆ (t, z]. Since execution times must be greater
than submission times, i.e. Φ(t′ ) ⊆ [t′ , ∞), the result follows. In the special case when t′ = z, then



                                                                      36
we obtain that Φ(z) = {z}, since it is included in {z} and cannot be empty (being the argmax of a
continuous function over a compact set).


A.7      Proof of Proposition 2
The only two things left to show to establish the proposition are that limit-sell orders are never executed
during (0, Ts ∧ Tf ) and that low valuation investors find it optimal to submit market and limit sell
orders at all times during [0, Ts ∧ Tf ).


A.7.1     Limits sell orders are never executed during (0, Ts ∧ Tf )
Suppose that, during (0, Ts ∧ Tf ), limit orders are executed at all times in some set T. Our goal is to
show that T = ∅.
       By, Proposition 1, for all z ∈ T, φ(z) = ∅. That is, when contacting the market at all times in T,
low-valuation investors do not submit limit orders. But we know that limit-sell orders are submitted
at almost all times in [0, Ts ∧ Tf ). Therefore, the set T must be of measure zero. Now consider
some execution time z ∈ T, corresponding to a limit order at price p(z), submitted at some time
t < z. By Proposition 1, at all times t′ ∈ (t, z), investors submit orders with execution times in
                                                                                      ′
[t′ , z]. The probability that such a limit order is executed is greater than e−ρ(z−t ) , the probability
that an investor does not get a chance to re-contact the market and cancel his order by time z. Clearly,
          ′
e−ρ(z−t ) ≥ e−ρ(z−t) . Now, applying the the law of large numbers, it follows that the fraction of limit
orders submitted during [t, z] that are executed during [t, z] is greater than e−ρ(z−t) . Thus, using
equation (10) the total number of limit sell orders submitted and executed during [t, z] is greater than:
                                   Z    z                   
                                             ρ(s − µh (u)) du e−r(z−t) > 0.                           (28)
                                     t


Now, since the set of execution times in (0, Ts ∧ Tf ) is of measure zero, it follows that the positive
measure (28) of limit sell orders is executed during a measure zero set of times, T ′ . But Lemma 2
showed that investors do not submit limit buy orders, so the cumulative asset demand during T ′ is
less than the cumulative number of investors who contact the market during T ′ , which is equal to zero
because T ′ is of measure zero. Thus we have a positive measure of asset supplied, but at the same
time a measure zero of asset demanded, which contradicts market clearing.                         QED


A.7.2     Low-valuation investors find it optimal to submit market and limit
          sell orders at all times t ∈ [0, Ts ∧ Tf )
We know that these properties must be true at almost all times in [0, Ts ∧ Tf ). Therefore, given any
time t ∈ [0, Ts ∧ Tf ), there is a sequence tk converging towards t such that {tk , zk } ⊆ Φ(tk ) for some
zk > tk . Moreover, because limit sell orders are never executed during (0, Ts ∧Tf ), and always executed
before Tf (Lemma 7), we know that zk ∈ [Ts ∧ Tf , Tf ]. Since the sequence zk is bounded, it has a
subsequence converging to some (t, z), where z ≥ Tf . By the Theorem of the Maximum (see, e.g.,
Theorem 3.6 in Stokey and Lucas, 1989) the correspondence Φ( · ) is upper hemi continuous, and so
(t, z) ∈ Φ(t). This establishes that, at time t, submitting a market sell order and submitting a limit
sell orders are both optimal.                                                                         QED



                                                        37
A.8       Proof of Proposition 4
Point i) is a re-statement of a finding in Proposition 2: low-valuation investors submit limit sell orders
at all times in [0, Ts ).
     As for point ii), suppose to the contrary that for some t ∈ [0, Ts ), φ(t) has more than one element,
say z1 < z2 ∈ (Ts , Tf )2 . Then by Proposition 1, for all t′ ∈ [0, t), φ(t′ ) ≥ z2 and for all t′ ∈ (t, Ts ),
φ(t′ ) ≤ z1 . Thus, there is a “hole” in the limit-order book, in that no limit order are executed during
the interval (z1 , z2 ). But this contradicts Proposition 3 according to which limit orders have to be
executed at almost all times during (z1 , z2 ).
     For the point iii), we already know from Proposition 1 that φ(t) is decreasing so the only thing left
to show is that it is strictly decreasing. Suppose to the contrary that φ(t) has a “flat spot,” i.e. that it
is constant equal to z over some interval [t, t′ ]. By Proposition 2 there is a strictly positive measure of
limit orders submitted during [t, t′ ], and all these limit orders are executed with a probability bounded
away from zero. Thus, there is a positive measure limit orders executed exactly at time z. But this
can’t be the basis of an equilibrium since, on the other side of the market, there are no market buy
order (Lemma 2) and the asset demand originating from investors contacting the market exactly at
time z is zero.
     For point iv), we note that since φ(t) is a decreasing function, it has countably many discontinuity
points. Now consider any discontinuity point, t. We must have φ(t+ ) < φ(t) since φ(t) is decreasing.
By Proposition 1, low-valuation investors contacting the market at t′ < t submit limit orders executed
at times z ′ ≥ φ(t), and low-valuation investors contacting the market at t′ > t submit limit orders
executed at times z ′ ≤ φ(t+ ). Thus, the measure of limit orders executed during the time interval
(φ(t+ ), φ(t)) is bounded above by the measure of low-valuation investors contacting the market exactly
at time t, which is equal to zero. But this is a contradiction since, by Proposition 2, there must be a
strictly positive measure of limit orders executed during this time interval.
     Finally for point v), we know that ∂Nℓ /∂z(t, z) < 0 for z > Tf , so φ(t) ≤ Tf and in particular
φ(0) ≤ Tf . In addition we cannot have φ(0) < Tf because otherwise the measure of limit orders
executed during [φ(0), Tf ] would be zero, in contradiction with Proposition 3. Similarly, by Proposition
2 we must have limt→Ts φ(t) = Ts because otherwise no limit order would be submitted at all times
close enough to Ts .                                                                                   QED


A.9       Proof of Proposition 6
Because low-valuation investors who contact the market at time t ∈ [0, Ts ] must find it optimal to
submit a limit-sell order with execution time φ(t), it follows that

                                             Nℓ (t, φ(t)) − Nℓ (t, z)
                                     lim                                ≥   0
                                   z→φ(t)−           φ(t) − z
                                             Nℓ (t, φ(t)) − Nℓ (t, z)
                                     lim                                ≤   0
                                   z→φ(t)+           φ(t) − z

which gives, after taking left and right derivative in equation (7):

                             1 − δ + δπh (t, φ(t)) + ṗ(φ(t))− − rp(φ(t))       ≤ 0                      (29)
                                                              +
                             1 − δ + δπh (t, φ(t)) + ṗ(φ(t)) − rp(φ(t))        ≥ 0                      (30)



                                                       38
Note that p(z) is continuous and is assumed to be piecewise continuously differentiable. Thus, the
above inequalities have to hold with an equality except may be at countably many kink points. At a
kink point, either one of the two above inequality must be strict. For instance, suppose that

                               1 − δ + δπh (t, φ(t)) + ṗ(φ(t))− − rp(φ(t)) > 0.

Then, because the price path is piecewise continuously differentiable and φ(t) is continuous, this strict
inequality must also hold for all t′ in a neighborhood of t. But, because of the optimality conditions
this means that p(z) has an uncountable number of kink points, which is a contradiction. The ODE
follows by using the optimality condition (29)-(30) with an equality, and letting z = φ(t).
     Next we turn to the ODE (15) during [0, Ts ]. At any time t < Ts , some low-valuation investors
submit limit sell orders to be executed at φ(t). At the same time, there is a positive demand originating
from high-valuation non-owners, so other low-valuation investors must submit market sell orders.
Therefore, in an equilibrium a low-valuation investor contacting the market during [0, Ts ) must be
indifferent between the two, i.e.:
                                          Z     φ(t)
           Nℓ (t, φ(t)) = 0   ⇔ p(t) =                 [1 − δ + πh (t, u) + ṗ(u) − rp(u)] e−(r+ρ)(u−t) du.   (31)
                                            t

Recall our maintained assumption that p(t) is piecewise continuously differentiable. In any interval
where p(t) is continuously differentiable, we can take derivatives with respect to t and obtain the ODE
(15). Starting from the terminal condition given by the solution of ODE (16) evaluated at Tf , we can
solve the ODE (15) backward, in each interval where p(t) is continuously differentiable. Clearly this
yields to a price path that is, in fact, continuously differentiable everywhere.                    QED


A.10        Proof of Theorem 2
A.10.1       Low-valuation optimality
The only thing left to show is that the conjectured trading strategies are optimal at all time t ∈ [0, Ts ).
By construction, investors are indifferent between submitting a market sell order, and a limit sell order
executed at time z = φ(t). The only thing we need to verify is that these two trading strategies achieve
the maximum of Nℓ (t, z) over [t, Tf ].
    Plugging the ODE 16 for the price in [Ts , Tf ] into the derivative ∂Nℓ (t, z)/∂z, we find that:
                                                                      
                          ∂Nℓ
            e(r+ρ)(z−t)       (t, z) =    δ πh (t, z) − πh (φ−1 (z), z)
                           ∂z
                                                                                    
                                              µh (z) − µh (t) µh (z) − µh (φ−1 (z))
                                     =    δ                  −
                                                1 − µh (t)        1 − µh (φ−1 (z))
                                                                                                
                                                      1 − µh (z)                 −1
                                     =    δ                                 µh (φ   (z)) − µh (t)  .          (32)
                                            (1 − µh (t))(1 − µh (φ−1 (z)))

Since φ−1 (z) is decreasing and µh (t) increasing, it follows that the above expression is strictly positive
for z ∈ [Ts , φ(t)), and strictly negative for z ∈ (φ(t), Tf ]. Therefore, φ(t) achieves the strict maximum
of Nℓ (t, z) over [Ts , Tf ]: in words, the best execution time in [Ts , Tf ] is φ(t). Turning to z ∈ [t, Ts ], we




                                                            39
plug the ODE (15) in the formula (7) for Nℓ (t, z):
                                   Z                                                                                                          !
                                       z                                                             φ(u)
                                                                                                                −(r+ρ)(v−u) ∂πh
                                                                                                 Z
                                               −(r+ρ)(u−t)
           Nℓ (t, z) =         δ           e                                   πh (t, u) +                  e                     (u, v) dv       du.
                                   t                                                              u                         ∂u

Keeping in mind that πh (v, v) = 0, the first integral term can be written:
                          z                        Z z               Z v              
                                                                          ∂πh
                      Z
                  δ  e−(r+ρ)(v−t) πh (t, v) dv = δ      e−(r+ρ)(v−t) −        (u, v) du dv
                  t                                  t                 t  ∂u
                   Z zZ z
                                         ∂πh
              = −δ        e−(r+ρ)(v−t)        (u, v) dv du,                                                                                             (33)
                    t   u                 ∂u

where the third inequality follows from exchanging the order of integration. The second integral term,
on the other hand, is:

                                                   z                                    φ(u)
                                                                                                                   ∂πh
                                           Z                                        Z
                                       δ               e−(r+ρ)(u−t)                            e−(r+ρ)(v−u)            (u, v) dv du
                                               t                                     u                             ∂u
                                                   z       φ(u)
                                                                                               ∂πh
                                           Z           Z
                               =       δ                                e−(r+ρ)(v−t)               (u, v) dv du                                         (34)
                                               t        u                                      ∂u

Adding up the two integrals above, and keeping in mind that z ≤ Ts ≤ φ(u), we obtain

                                                                    z        φ(u)
                                                                                                      ∂πh
                                                            Z           Z
                              Nℓ (t, z) = δ                                         e−(r+ρ)(v−t)          (u, v) dv du
                                                                t        z                            ∂u

which is negative because πh (u, v) is strictly decreasing in its first argument. Thus we have shown
that, for all z ∈ (t, Ts ], Nℓ (t, z) < 0. This establishes that a low-valuation investor strictly prefers to
submit a market sell order than a limit-sell order to be executed at z ∈ (t, Ts ].                      QED


A.10.2      The price is increasing
We first verify that the price is increasing in [Ts , Tf ]. We first note that, at t = Tf− , p(Tf ) = 1/r and
using the ODE (16):

                              ṗ(Ts ) = 1 − (1 − δ) − δπh (0, Tf ) = δ(1 − πh (0, Tf )) > 0.

Now, for t ∈ [Ts , Tf ], we note that φ−1 (t) is continuously differentiable (see, in the Addendum, Section
II.1 page II.1) so that can differentiate (16). We obtain:

                              d
                    rṗ(t) = πh (φ−1 (t), t) + p̈(t)
                             dt
                            Z Tf                    
                                    d
                  ⇒ ṗ(t) =           πh (φ−1 (u), u) e−r(u−t) du + e−r(Tf −t) ṗ(Tf− ) > 0.
                             t     du

Indeed, because πh (t, u) is decreasing in t and increasing in u, and because φ−1 (u) is decreasing, it
follows that d/du πh (φ−1 (u), u) > 0.
                                

     We now turn to the interval [0, Ts ] and show that under our assumption that the hazard rate of
switching is constant the price is increasing. Using the functional form πh (t, u) = 1 − e−γ(u−t) we



                                                                                         40
obtain that d(t) = ṗ(t) solves the ODEs:
                                                                       
                            t ∈ [0, Ts ]                        ′                              ˙
                                                    rd(t) = δγ φ (t) − 1 e−(r+ρ+γ)(φ(t)−t) + d(t)
                                                                               
                                                                        1
                                                                                  e−γ (t−φ (t)) + d(t).
                                                                                          −1
                    t ∈ [Ts , Tf ]                  rd(t) = δγ 1 − ′                               ˙
                                                                    φ ◦ φ−1 (t)

After integrating these two ODEs we obtain that, for t ∈ [0, Ts ]:
                                             Z      Ts                     
                    d(t)              = δγ               e−r(u−t) φ′ (u) − 1 e−(r+ρ+γ)(φ(u)−u) du
                                                t
                                                     φ(t)                                                
                                                                                           1
                                                 Z
                                                                                                              e−γ (u−φ        (u))
                                                                                                                         −1
                                                                      −r(u−t)
                                          +δγ                     e                 1− ′                                             du
                                                  Ts                                  φ ◦ φ−1 (u)
                                               −r(φ(t)−t)
                                          +e                          d(φ(t)).

Now we make the change of variable v = φ−1 (u) in the second integral. We obtain:
                                                     Z       Ts                     
                                 d(t)    = δγ                     e−r(u−t) φ′ (u) − 1 e−(r+ρ+γ)(φ(u)−u) du
                                                         t
                                                         Z    Ts                                 
                                                                           −r(φ(v)−t)
                                               +δγ                     e                 1 − φ (v) e−γ(φ(v)−v) dv
                                                                                              ′
                                                        t
                                                     −r(φ(t)−t)
                                               +e                           d(φ(t)).

After collecting the first two lines, we obtain:
                    Z       Ts                                                                      
                                     −r(φ(u)−t)−γ(φ(u)−u)                        ′
    d(t) =     δγ                e                                          1 − φ (u)   1 − e−ρ(φ(u)−u) du + e−r(φ(t)−t) d(φ(t)).
                        t


The integrand in the first term is positive because φ′ (u) < 0 and φ(u) ≥ u. We also have d(φ(t)) ≥ 0
since φ(t) ≥ Ts . So d(t) > 0, meaning that the price is indeed increasing.                     QED


A.11        Proof of Implication 7
Lemma 10 (Preliminary result). Let f (u) be some bounded measurable function, continuous at t.
Then                            Z t
                                    f (u)ρeρ(u−t) du → f (t),
                                                              0

as ρ goes to infinity.

    Because of continuity, given any ε > 0 there is some 0 < η < t such that |f (u) − f (t)| < ε/2 for all
u ∈ [η, t]. Thus,
                            Z    t                                                  Z    t
                                     f (u)ρeρ(u−t) du − f (t) =                              (f (u) − f (t))ρeρ(u−t) du + e−ρt f (t)
                             0                                                       0
                                            Z    ηZ t
                ≤ 2 sup |f (u)|     ρeρ(u−t) du +     ρeρ(u−t) |f (u) − f (t)| du + e−ρt f (t)
                                0                  η
                                                 ε               
                                             −ρt
                ≤ 2 sup |f (u)| e ρ(η−t)
                                         −e       +     1 − eρ(η−t) + e−ρt f (0) ≤ ε,
                                                    2


                                                                                    41
for ρ large enough.                                                                                                                      QED
    The result follows from applying the lemma .                                                                                         QED


A.12          Proof of Implication 8
To prove the result we first establish the following lemma.

Lemma 11. Suppose that f (u) is twice continuously differentiable over [0, t]. Then
                                                              Z   t
                                                         ρ2           f (u) [1 + ρ(u − t)] eρ(u−t) du → f ′ (t),
                                                              0

as ρ goes to infinity.

    To prove this lemma we start with a first integration by part, noting that:

                                                           d
                                                             (u − t)eρ(u−t) = [1 + ρ(u − t)] eρ(u−t) .
                                                          du

This shows that
              Z   t                                       h                   it    Z t
         ρ2           f (u) [1 + ρ(u − t)] eρ(u−t) du = ρ2 f (u)(u − t)eρ(u−t) − ρ2     f ′ (u)(u − t)eρ(u−t) du
              0                                                                                                       0        0
                                               Z    t
    = ρ2 f (0)te−ρt − ρ2                                (u − t)f ′ (u)eρ(u−t) du.
                                                0


We integrate the second term by part again, differentiating ρ(u − t)f ′ (u) and integrating ρeρ(u−t) . We
obtain:
                               Z       t
                           2
                       ρ                   f (u) [1 + ρ(u − t)] eρ(u−t) du
                                   0
                                                      t Z t
              = ρ2 f (0)te−ρt − ρ (u − t)f ′ (u)eρ(u−t) +     [f ′′ (u)(u − t) + f ′ (u)] ρeρ(u−t) du
                                                                                                     0   0
                                                                                    Z     t
              = ρ2 f (0)te−ρt + ρf ′ (0)te−ρt +                                               [f ′′ (u)(u − t) + f ′ (u)] ρeρ(u−t) du.
                                                                                      0

The result then follows by noting that the first two terms go to zero as ρ goes to infinity, and by
applying Lemma 10 to the third term.                                                             QED
    The only thing that remains to be shown to establish the implication is that, for ρ large enough,
the number of cancelations increases with ρ. To see this first note that the derivative of the flow of
cancelations with respect to ρ is:
                                      ∂C               ∂L
                                         (t) = L(t) + ρ (t).
                                      ∂ρ               ∂ρ
Also note that
                                                                           t
                                                   ∂L
                                                                      Z
                                                      (t) =                    (1 + ρ(u − t)) eρ(u−t) (s − µh (u)) du.
                                                   ∂ρ                  0

Thus, an application of Lemma 11 implies that ρ2 ∂L/∂ρ(t) goes to −µ̇h (t) as ρ goes to infinity. Hence
ρ∂L/∂ρ(t) goes to 0 and, ∂C/∂ρ(t) goes to s − µh (t) which is positive for t < Ts .                QED




                                                                                                42
A.13        Proof of Implication 9
We show that the ratio M(t)/V(t) increases with ρ, as long as ρ is large enough. This is equivalent to
show that                                             
                             d                               d
                               log ρ(s − µh (t)) + L(t) >      log V(t),
                            dρ                              dρ
for ρ large enough. The left hand side of the above expression is

                          s − µh (t) + L(t) + ρ ∂L
                                                ∂ρ        1 s − µh (t) + L(t) + o(1)
                                                   =
                                                          ρ    s − µh (t) + L(t)
                           ρ s − µh (t) + L(t)
                                                                  
                                                          1       1
                                                     =      +o       .                                   (35)
                                                          ρ       ρ

Now using equation (18), we obtain that

                                  1 ∂V           1   1     te−(ρ+γ)t
                                            =      −   +
                                 V(t) ∂ρ         ρ ρ+γ   1 − e−(ρ+γ)t
                                                 γ       te−(ρ+γ)t
                                            =         +
                                              ρ(ρ + γ) 1 − e−(ρ+γ)t
                                                 
                                                 1
                                            = o     .                                                    (36)
                                                 ρ

Comparing (35) and (36), it the follows that M(t)/V(t) increases for ρ large enough.                    QED


A.14        Proof of Proposition 7
To construct a MLOE, we use a guess and verify method. We guess is that the equilibrium has the same
form as in the main model and is characterized by two times T1 < T2 . The price is strictly increasing
over [0, T2 ] and constant equal to 1/r over [T2 , ∞). At all times t during some initial interval [0, T1 ],
low-valuation investors submit market sell orders and limit sell orders to be executed at φ(t) ∈ [T1 , T2 ].
At all times during [T1 , ∞), low-valuation investors submit market sell orders. The times T1 , T2 and
the function φ(t) have to be determined in equilibrium.
    We then know from the main model (Proposition 3) that high-valuation investors submit market
buy orders when contacting the market during [0, T2 ), and are indifferent between buying or not
afterwards. As in the main model, the optimal order of a low-valuation investor is determined by the
net-utility Nℓ (t, z) of submitting at time t a limit-sell order executed at time z, rather than a market-sell
order. The derivation is the same as in the main model except for the fact that switching and contact
times are no longer independent. Formally, we let τρ−γε be the next contact time without simultaneous
switching, and τγε be the next contact time with simultaneous switching, and τ = τρ−γε ∧ τγε be the




                                                     43
next contact time. Proceeding as in the Proof of Lemma 5, we find that:
                       Z     z                                                                   
                                                                                   −r(u−t)
   Nℓ (t, z) =    Et              I{u≤τρ−γε } I{u≤τγε } (θ(u) + ṗ(u) − rp(u)) e             du
                          t
                  Z z
                         Et I{u≤τρ−γε } Probat [u ≤ τγε ] (Et [θ(u) | u ≤ τγε ] + ṗ(u) − rp(u)) e−r(u−t) du
                                      
             =
                  Zt z                        h                 i                
             =           e−(r+ρ)(u−t) 1 − δ + δ 1 − e−γ(1−ε)(u−t) + ṗ(u) − rp(u)) du
                  Zt z
             =           e−(r+ρ)(u−t) (1 − δ + δπhε (t, z) + ṗ(u) − rp(u))) du
                   t

where the second line follows from the independence between τγε and τρ−γε . Note that the expression is
the same as in the main model after the change of variable of the proposition. Given πhε (t, z) and given
the strictly decreasing function φ(t) mapping [0, T1 ] onto [T1 , T2 ], we construct the price path using
the ODE of Proposition 6. Going through the same argument as in the main model, one shows easily
that, given this price, the trading plans of investors with low-valuation are optimal. Lastly, given
the functional form of πhε (t, z), we know from Section A.10.2 that the price path is indeed strictly
increasing over [0, T2 ].
    All what’s left to determine, then, is the function φ(t) and the two times T1 and T2 . To that end,
we note that at any time t ∈ [0, T2 ], there is a flow

                                                   ρµhn (t) + γεµℓn (t),                                   (37)

of high-valuation investors who contact the market and demand one unit of the asset. In particular
the second term is the flow of low-valuation investors who switch to high and immediately contact the
market. On the other side of the market, we have a flow

                                                (ρ − γε) (µℓo (t) + µℓb (t)) ,                             (38)

of low-valuation investors who contact the market with one unit of the asset. It is important to keep in
mind that the relevant intensity of contact for equation (38) is not ρ but ρ − γε < ρ. This is because of
synchronization: some low-valuation owners contact the market but instantly switch to high, so they
do not submit any sell order. Subtracting (38) from (37), we find that the net buy order flow is

                                    (ρ − γε) (µhn − µℓo (t) − µℓb (t)) − γε (µℓn (t) + µhn (t))
                            =       (ρ − γε) (µh (t) − s) + γε (1 − s)
                            =       ρµh (t) + γε (1 − µh (t)) − ρs.

    The first term is the flow of high-valuation investors who contact the market at each time. The
second term is the flow of low-valuation investors who switch to high and immediately contact the
market. The third term is the flow of assets brought to the market by all investors. The only difference
with the main model is, therefore, the second term. It arises because of synchronization: the market
is no longer representative of the overall population, but is instead biased towards high-valuation




                                                             44
investors. This calculation allows us to write the net buy order flow as:
                                                                                       
                                                                                      γε −γt
                                  ρ (µεh (t)   − s) where            µεh (t)   =1− 1−     e .
                                                                                      ρ

Given that limit orders are canceled with intensity ρ, the construction of φ(t), T1 and T2 is exactly as
in the main model. That is, T1 solves µεh (T1 ) = s, and φ(t):
                                          Z        φ(t)
                                                          ρ(s − µh (z))eρ(z−φ(t)) dz = 0,
                                               t

for all t ∈ [0, T1 ]. Finally, observing that T2 = φ(0) completes the proof.                                      QED


A.15        Proof of Corollary 1
Let µ̃h (u) be the solution of µ̃˙ h (u) = γ (1 − µ̃h (u)) with initial condition 1 − e−γ̄ T̄ . Then the measure
of high valuation investors at time t is 1 − e−γ̄t if t ≤ T̄ and µ̃h (t − T̄ ) if t ≥ T̄ . In particular, if we let
T̃s solve µ̃h (T̃s ) = s, we have that Ts = T̄ + T̃s . For all t ≤ T̄ , the probability πh (t, u) of switching to
high in the interval [t, u], is given by:

                                      u ≤ T̄         : πh (t, u) = 1 − e−γ̄(u−t)
                                      u ≥ T̄         : πh (t, u) = 1 − e−γ̄(T̄ −t)−γ(u−T̄ ) .

For t ≥ T̄ we have, as before, πh (t, u) = 1 − e−γ(u−t) . Now consider any t ≤ T̄ . From equation (15),
we have that:
                                                                               φ(t)
                                                                                      ∂πh
                                                                         Z
                          ṗ(t)   =     rp(t) − (1 − δ) + δ                               (t, u)e−(r+ρ)(u−t) du
                                                                           t           ∂t
                                                          T̃s
                                                                ∂πh
                                                    Z
                                  ≤     δ+δ                         (t, u)e−(r+ρ)(u−t) du
                                                      t          ∂t


where the second line follows because, in a MLOE, rp(t) ≤ 1, because ∂πh /∂t < 0, and T̃s ≤ Ts ≤ φ(t).
Now using the explicit expression for πh (t, u) above, we find that:

                          T̃s
                             ∂πh
                      Z
                                   (t, u)e−(r+ρ)(u−t) du
                       t      ∂t
                              γ̄       h                     i γ̄e−γ̄(T̄ −t) h                        i
                 =    −                 1 − e−(r+ρ+γ̄)(T̄ −t) −               1 − e−(r+ρ+γ)(T̃s −T̄ )
                         r + ρ + γ̄                             r+ρ+γ
                           γ̄e−γ̄ T̄   h                  i
                 ≤    −                 1 − e−(r+ρ+γ)T̃s → −∞
                         r+ρ+γ

as γ̄ → ∞, holding γ̄ T̄ constant. Plugging this back into the expression for ṗ(t) it follows that, for γ̄
sufficiently large, ṗ(t) < 0.                                                                       QED




                                                                        45
A.16         Proof of Corollary 2
We now show that the price is increasing in [0, Tf ] when ρ is large enough. First of all, the Walrasian
price is p∗ (t) = 1/r for t ≥ Ts , and

                                                                              1 δ                
                                                   p∗ (t) =                     −   1 − e−r(Ts −t) ,
                                                                              r   r

for t < Ts . The price when ρ < ∞ is denoted by p(t). The idea of the proof is to that p(t) and its
first derivative, ṗ(t), both converges uniformly towards the Walrasian price as ρ goes to infinity. Since
ṗ∗ (t) > 0 over [0, Ts ), this implies that, if ρ is large enough, ṗ(t) > 0 for all t ∈ [0, Ts ).


A.16.1       Uniform convergence of p(t).
First consider t ∈ [Ts , Tf ].

                                         Tf
                                                                                        1
                                 Z
                                                  1 − δ + δπh (φ−1 (u), u) e−r(u−t) du + e−r(Tf −t) .
                                                                         
                       p(t) =
                                     t                                                  r

Thus,
                                                  Z       Tf
           0 ≤ p∗ (t) − p(t) =                                     1 − πh (φ−1 (u), u) e−r(u−t) du
                                                                                     
                                              δ
                                                      t
                                                          Tf
                                                                                        δh              i δh
                                                  Z                                                                          i
                                 ≤            δ                e−r(u−t) du ≤              1 − e−r(Tf −t) ≤   1 − e−r(Tf −Ts ) .
                                                      t                                 r                  r

Since, for t ≥ Tf , we have p(t) = 1/r = p∗ (t), we obtain that

                                                                                  δh                i
                                                  |p(t) − p∗ (t)| ≤                 1 − e−r(Tf −Ts ) ,
                                                                                  r

for all t ≥ Ts . Given that Tf = φ(0) goes to Ts (see in the Addendum, Section II.2.4, page 8), the
convergence is uniform for all t ≥ Ts . Next, consider some t ≤ Ts . We have:

                                                               rp(t) = 1 − δ + η(t) + ṗ(t),

where
                                                                       φ(t)
                                                                              ∂πh
                                                               Z
                                     η(t) ≡ −δ                                    (t, u)e−(r+ρ)(u−t) du.
                                                                   t           ∂t

Taking the difference with p∗ (t), we obtain that
                                                                                                   Z    Ts
                    |p(t) − p∗ (t)|           =            e−r(Ts −t) |p(Ts ) − p∗ (Ts )| +                  η(u)e−r(u−t) du
                                                                                                    t

Now
                                                                                
                         ∂πh                                   ∂ µh (u) − µh (t)       1 − µh (u)
                             (t, u) =                                              =−               µ̇h (t).
                          ∂t                                   ∂t   1 − µh (t)        [1 − µh (t)]2




                                                                                   46
Since µh (t) is continuously differentiable, ∂πh /∂t can be bounded above over [0, φ(0)] by some constant
K. Note that, since φ(0) decrease in ρ (see in the Addendum, Section II.2 page 7) the bound will also
work for any larger ρ. We obtain that

                                              δK                       δK
                                0 ≤ η(t) ≤        1 − e−(r+ρ)(φ(t)−t) ≤     .
                                             r+ρ                        r+ρ

Plugging this into the expression above we obtain

                                                                            δK                  
                |p(t) − p∗ (t)|    ≤   e−r(t−Ts ) |p(Ts ) − p∗ (Ts )| +            1 − e−r(Ts −t) .
                                                                          r(r + ρ)

Since p(Ts ) → p∗ (Ts ) = 1/r, this establishes the uniform convergence of p(t) towards p∗ (t) over the
interval [0, Ts ].


A.16.2      Uniform convergence of ṗ(t) over [0, Ts ).
To see that ṗ(t) converges uniformly towards its limit rp∗ (t) − (1 − δ), note that

                                           ṗ(t) = rp(t) − (1 − δ) − η(t),

so

                                                                                             δK
                   |ṗ(t) − ṗ∗ (t)|   ≤   r|p(t) − p∗ (t)| + |η(t)| ≤ r|p(t) − p∗ (t)| +       ,
                                                                                            r+ρ

which converges uniformly towards ṗ∗ (t) as ρ goes to infinity.


A.16.3      The price is increasing for ρ large enough.
Indeed, recall that                                        
                                  ṗ∗ (t) = δ 1 − e−r(Ts −t) > δ 1 − e−rTs > 0,
                                                                "         


is uniformly bounded away from zero over [0, Ts ). Since ṗ(t) converges to ṗ∗ (t) uniformly for t ∈ [0, Ts ),
the result follows.                                                                                     QED




                                                         47
References
Antje Berndt, Rohan Douglas, Darrell Duffie, and David Ferguson, Mark andSchranz.
  Measuring default risk premia from default swap rates and edfs. 2005.

Bruno Biais and Pierre-Olivier Weill. Addendum to “liquidity shocks and order book
  dynamics”. Working paper, TSE and UCLA, 2009.

Bruno Biais, Piere Hillion, and Chester Spatt. An empirical analysis of the limit order
  book and the order flow in the paris bourse. Journal of Finance, 50:1655–1689, 1995.

Shane A. Corwin and Jay F. Coughenour. Limited attention and the allocation of effort
  in securities trading. Journal of Finance, 63:3031–3067, 2008.

Joshua D. Coval and Erik Stafford. Asset fire sales (and purchases) in equity markets.
  Journal of Financial Economics, 86:479–512, 2007.

Zhi Da and Pengjie Gao. Clientele change, liquidity shock, and the return on financially
  distressed stocks. Working Paper, Northwestern University, 2007.

Harold Demsetz. The cost of transacting. The Quarterly Journal of Economics, 82:
  33–53, 1968.

Darrell Duffie and Gustavo Manso. Information diffusion in large population. American
  Economic Review Papers and Proceedings, 97:203–209, 2007.

Darrell Duffie, Nicolae Gârleanu, and Lasse H. Pedersen. Securities lending, shorting,
  and pricing. Journal of Financial Economics, 66:307–339, 2002.

Darrell Duffie, Nicolae Gârleanu, and Lasse H. Pedersen. Over-the-counter markets.
  Econometrica, 73:1815–1847, 2005.

Darrell Duffie, Nicolae Gârleanu, and Lasse H. Pedersen. Valuation in over-the-counter
  markets. Review of Financial Studies, 20:1865–1900, 2007.

Andrew Ellul, Graig W. Holden, Pankaj K. Jain, and Robert H. Jennings. Order dynam-
  ics: Recent evidence from the nyse. Working paper, Indiana University Bloomington,
  2007.



                                          48
Thierry Foucault. Order flow composition and trading costs in a dynamic limit order
  market. Journal of Financial Markets, 2:99–134, 1999.

Thierry Foucault, Ohad Kadan, and Eugene Kandel. Limit order book as a market for
  liquidity. Review of Financial Studies, 18:1171–1217, 2005.

Kenneth D. Garbade and William L. Silber. Structural organization of secondary mar-
  kets: Clearing frequency, dealer activity, and liquidity risk. Journal of Finance, 34:
  577–593, 1979.

Nicolae Gârleanu. Portfolio choice and pricing in illiquid markets. Journal of Economic
  Theory, 144:532–564, 2009.

Mikhail Golosov, Guido Lorenzoni, and Aleh Tsyvinski. Decentralized trading with
  private information. Working Paper, MIT and Yale, 2008.

Robin Greenwood. Short and long-term demand curves for stocks: Theory and evidence
  on the dynamics of arbitrage. Journal of Financial Economics, 75:607–650, 2005.

Mark D. Griffiths, Brian F. Smith, D. Alasdair Turnbull, and Robert W. White. The
  costs and determinants of order aggressiveness. Journal of Financial Economics, 56:
  65–88, 2000.

Sanford J. Grossman and Merton H. Miller. Liquidity and market structure. Journal
  of Finance, 43:617–637, 1988.

Larry Harris. Trading and Exchanges: Market Microstructure for Practitioners. Oxford
  University Press, New York, New York, 2003.

Joel Hasbrouck and Gideon Saar. Technology and liquidity provision: the blurring of
  traditional definitions. Journal of financial Markets, 12:143–172, 2009.

Terrence Hendershott, Charles M. Jones, and Albert J. Menkveld. Does algorithmic
  trading improve liquidity? Working paper, UC Berkeley, 2007.

Amir E. Khandaniy and Andrew W. Lo. What happened to the quants in August 2007?
  Working paper, MIT, 2008.




                                          49
Nobuhiro Kiyotaki and Randall Wright. On money as a medium of exchange. Journal
  of Political Economy, 97:927–954, 1989.

Ricardo Lagos. Asset prices and liquidity in an exchange economy. Working paper,
  NYU, 2005.

Ricardo Lagos and Guillaume Rocheteau. Liquidity in asset markets with search fric-
  tions. Econometrica, 77:403–426, 2009.

Ricardo Lagos and Randall Wright. A unified framework for monetary theory and
  policy analysis. Journal of Political Economy, 113:463–484, 2005.

Ricardo Lagos, Guillaume Rocheteau, and Pierre-Olivier Weill. Crashes and recoveries
  in illiquid markets. Working Paper, NYU, UCI, UCLA, 2007.

Benjamin Lester, Andrew Postelwaite, and Randall Wright. Liquidity and information:
  I. Working Paper, UWO and UPenn, 2009a.

Benjamin Lester, Andrew Postelwaite, and Randall Wright. Liquidity and information:
  Ii. Working Paper, UWO and UPenn, 2009b.

Gara Mı́nguez Afonso. Liquidity and congestion. Working paper, LSE, 2008.

Christine A. Parlour. Price dynamics in limit order markets. Review of Financial
  Studies, 11:789–816, 1998.

Christine A. Parlour and Duane J. Seppi. Limit order markets: A survey. In A.W.A.
  Boot and A.V. Thakor, editors, Handbook of Financial Intermediation and Banking,.
  2008.

Guillaume Rocheteau. A monetary approach to asset liquidity. Working paper, UCI,
  2009.

Ioanid Rosu. A dynamic model of the limit-order book. Review of Financial Studies,
  2009. Forthcoming.

Nancy L. Stokey and Robert E. Lucas. Recursive Methods in Economic Dynamics.
  Harvard University Press, Cambridge, 1989.



                                            50
Yeneng Sun. The exact law of large numbers via fubini extension and characterization
  of insurable risks. Journal of Economic Theory, 126:31–69, 2006.

Dimitri Vayanos and Tan Wang. Search and endogenous concentration of liquidity in
  asset markets, working paper. Journal of Economic Theory, 136:66–104, 2007.

Dimitri Vayanos and Pierre-Olivier Weill. A search-based theory of the on-the-run
  phenomenon. Journal of Finance, 63:1361–1398, 2008.

Pierre-Olivier Weill. Leaning against the wind. Review of Economic Studies, 74:1329–
  1354, 2007.

Pierre-Olivier Weill. Liquidity premia in dynamic bargaining markets. Journal of
  Economic Theory, 140:66–96, 2008.




                                         51
