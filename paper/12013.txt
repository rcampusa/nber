                                  NBER WORKING PAPER SERIES




                                ESTIMATING STATIC MODELS OF
                                   STRATEGIC INTERACTION

                                              Patrick Bajari
                                               Han Hong
                                              John Krainer
                                             Denis Nekipelov

                                          Working Paper 12013
                                  http://www.nber.org/papers/w12013


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                      January 2006




The application in this paper is based on an earlier draft, by Bajari and Krainer “An Empirical Model of
Stock Analysts’ Recommendations: Market Fundamentals, Conflicts of Interest, and Peer Effects.” Bajari
and Hong would like to thank the National Science Foundation for genereous research support. The views
expressed in this paper are those of the authors and not necessarily those of the Federal Reserve System. We
thank Ulrich Doraszelski and participants at various seminars for helpful comments. The views expressed
herein are those of the author(s) and do not necessarily reflect the views of the National Bureau of Economic
Research.

©2006 by Patrick Bajari, Han Hong, John Krainer, and Denis Nekipelov. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.
Estimating Static Models of Strategic Interaction
Patrick Bajari, Han Hong, John Krainer and Denis Nekipelov
NBER Working Paper No. 12013
January 2006
JEL No. L0, L5, C1

                                           ABSTRACT

We propose a method for estimating static games of incomplete information. A static game is a

generalization of a discrete choice model, such as a multinomial logit or probit, which allows the

actions of a group of agents to be interdependent. Unlike most earlier work, the method we propose

is semiparametric and does not require the covariates to lie in a discrete set. While the estimator we

propose is quite flexible, we demonstrate that in most cases it can be easily implemented using

standard statistical packages such as STATA. We also propose an algorithm for simulating the model

which finds all equilibria to the game. As an application of our estimator, we study recommendations

for high technology stocks between 1998-2003. We find that strategic motives, typically ignored in

the empirical literature, appear to be an important consideration in the recommendations submitted

by equity analysts.

Patrick Bajari
Department of Economics
University of Michigan
266 Lorch Hall
611 Tappan Street
Ann Arbor, MI 48109-1220
and NBER
bajari@umich.edu

Han Hong
Duke University
han.hong@duke.edu

John Krainer
Federal Reserve Bank of San Francisco
john.krainer@sf.frb.org

Denis Nekipelov
Duke University
denis.nekipelov@duke.edu
1    Introduction
Game theory is one of the most commonly applied tools in economic theory, with substantive
applications in all major ﬁelds in economics. In some ﬁelds, particularly industrial organization,
game theory has not only transformed the analysis of market interactions, but also serves as an
important basis for policy recommendations. Given the importance of gaming in economic theory,
it is not surprising that the empirical analysis of games has been the focus of a recent literature in
econometrics and industrial organization.
    In much of the literature, a discrete game is modeled much like a standard discrete choice
problem, such as the multinomial logit. An agent’s utility is often assumed to be a linear function
of covariates and a random preference shock. However, unlike a discrete choice model, utility
is also allowed to depend on the actions of other agents. A discrete game strictly generalizes a
standard random utility model, but does not impose the often strong assumption that agents act
in isolation. Early attempts at the econometric analysis of such games included Bjorn and Vuong
(1984), Bresnahan and Reiss (1991a), Bresnahan and Reiss (1991b). Other recent examples include
Haile, Hortacsu, and Kosenok (2003), Aradillas-Lopez (2005), Ho (2005), Ishii (2005), Pakes, Porter,
Ho, and Ishii (2005), Augereau, Greenstein, and Rysman (2005), Seim (2005), Sweeting (2005) and
Tamer (2003).
    An important insight in the recent literature is that it is often most straightforward to estimate
discrete games in two steps. For examples see Aguirregabiria and Mira (2002), Bajari, Benkard, and
Levin (2004), Berry, Pakes, and Ostrovsky (2003) and Pesendorfer and Schmidt-Dengler (2003).
In a ﬁrst step, the economist estimates the reduced forms implied by the model. This often boils
down to using standard econometric methods to estimate the probability that one, out of a ﬁnite
number of possible choices, is observed conditional on the relevant covariates. In the second step,
the economist estimates a single agent random utility model, including as controls the equilibrium
beliefs about the behavior of others from the ﬁrst step.
    In this paper, we propose an estimator that can be applied to static games of strategic interac-
tion. Like the two-step approach discussed above, we estimate the reduced form choice probabilities
in a ﬁrst stage in order to simplify the estimation of the model. The approach that we propose,
however, diﬀers from earlier work in four ways. First, much of the earlier literature on two step
estimation considered fully dynamic games. This made it diﬃcult for researchers unfamiliar with
dynamic programming to understand how to estimate a game. Also, we note that to date, the ma-
jority of empirical applications of discrete games have been static. Therefore, proposing methods
for static games is of practical importance for many researchers.
    Second, the approach that we propose can be done nonparametrically or semiparametrically.


                                                  2
Much of the earlier literature on two-step estimation of games considered the case where the set
of regressors was discrete or the ﬁrst stage was a correctly speciﬁed parametric model. In this
paper, we allow for continuous covariates and a fully nonparametric ﬁrst stage. We establish
two useful properties of this estimator. First, despite the fact the ﬁrst stage is nonparametric
and might converge at a slow rate, the structural parameters estimated in the second stage have
normal asymptotics and converge at a rate proportional to the square root of the sample size.
This follows from arguments based on Newey (1994). Second, we demonstrate in many cases our
model can be estimated, with correct standard errors, using a two stage least squares procedure in
a standard statistical package like STATA. We hope that the simplicity of this approach will make
the estimation of these models accessible to a larger audience of researchers. In Bajari and Hong
(2004) we demonstrate that the ideas in this paper can be generalized to dynamic games. However,
this estimator is more diﬃcult to implement and requires quite distinct econometric arguments.
   Third, we consider the problem of identiﬁcation in games with continuous state variables. Our
results, as in Bajari and Hong (2004), show that a suﬃcient condition for identiﬁcation is to
exclude payoﬀ relevant covariates for a particular player i from the utilities of the other players.
For instance, in an entry model, if the productivity shock of ﬁrm i inﬂuences its own entry decision,
but only indirectly inﬂuences the entry decisions of other players, then our results imply that the
model is identiﬁed. An alternative identiﬁcation strategy is to search for events that change which
equilibrium to the game is played, but otherwise do not inﬂuence payoﬀs. Our results can be
interpreted as standard rank conditions for an appropriately deﬁned linear system. We note that
Pesendorfer and Schmidt-Dengler (2003) demonstrate that exclusion restrictions are suﬃcient for
identiﬁcation in a particular set of entry games with discrete states. Sweeting (2005) demonstrates
that multiplicity of equilibrium can assist with identiﬁcation in a symmetric location game.
   Finally, we consider the problem of simulating the model, which is required to study predictions
of the model such as counterfactuals. It is widely known that models of the form that we consider
can generate multiple solutions. However, outside of certain speciﬁc examples (e.g., those studied
in Sweeting (2005)), it is not possible to analytically derive all of the solutions of the model or
even to determine the number of possible solutions. Therefore, we propose an algorithm that can
compute all of the equilibria to the model. This algorithm uses the “all solutions homotopy”, which
is available in standard numerical libraries such as hompack. Therefore, we can use this to ﬁnd the
entire set of equilibrium actions at our estimated parameter values. We discuss the potential uses
of this algorithm in our application.
   As an application of our methods, we model the determination of stock recommendations (e.g.
strong buy, buy, hold, sell) issued by equity analysts for high technology stocks listed in the NAS-
DAQ 100 between 1998 and 2003. The determination of recommendations during this time period

                                                 3
is of particular interest in the wake of the sharp stock price declines for technology ﬁrms in 2000.
Recommended stocks underperformed the market as a whole during this period by a wide margin.
Highly-publicized allegations of conﬂicts of interest have called into question whether analysts were
more concerned with helping their ﬁrms win investment banking business than with producing
accurate assessments of the prospects for the ﬁrms under scrutiny. While there is a fairly large
literature in ﬁnance on recommendations, we are not aware of any papers that formally consider
the simultaneity of recommendations due to strategic motives.
   In our model, recommendations submitted by analysts depend on four factors. First, recom-
mendations must depend on fundamentals and commonly shared expectations about the future
proﬁtability of the ﬁrm. These expectations will be embedded in the stock price. Second, analysts
are heterogeneous, both in terms of talent and perhaps in terms of access to information. We try to
capture an individual analyst’s private belief about the stock by looking at the diﬀerence between
the quarterly earnings forecast submitted by the analyst (or the analyst’s brokerage ﬁrm) and the
distribution of forecasts from other ﬁrms. Mindful of the large number of inquiries into possible
conﬂicts of interest among research analysts, we include as a third factor a dummy variable for an
investment banking relationship between the ﬁrm and the analyst’s employer.
   Finally, we consider the inﬂuence of peers on the recommendation decision. Peer eﬀects can
impact the recommendation in diﬀerent ways. Individual analysts have incentive to condition their
recommendation on the recommendations of their peers, because even if their recommendations
turn out to be unproﬁtable ex-post, performance evaluation is typically a comparison against the
performance of peers. More subtly, recommendations are relative rankings of ﬁrms and are not
easily quantiﬁable (or veriﬁable) objects. As such, ratings scales usually reﬂect conventions and
norms. The phenomenon is similar to the college professor’s problem of assigning grades. If a
professor were to award the average student with a C while other faculty give a B+ to the average
student, the professor might incorrectly signal his views of student performance. Even while there
is heterogeneity in how individual professors feel about grading, most conform to norms if only
to communicate clearly with students (and their potential employers) about their performance.
Similarly, analysts might have an incentive to benchmark their recommendations against perceived
industry norms.
   The paper is organized as follows. In section 2 we outline the general economic environment.
For purposes of exposition, we develop many of the key formulae within the context of a simple
entry model. In section 3 we discuss the problem of nonparametric identiﬁcation. In section 4 we
show how to derive nonparametric and semiparametric estimates of the structural parameters for
our class of models. Section 5 describes the all solutions homotopy algorithm for simulating the
model. Section 6 contains the empirical application to equity analyst recommendations. Section 7

                                                 4
concludes the paper.


2     The model
In the model, there are a ﬁnite number of players, i = 1, ..., n and each player simultaneously
chooses an action ai ∈ {0, 1, . . ., K} out of a ﬁnite set. We restrict players to have the same set of
actions for notational simplicity. However, all of our results will generalize to the case where all
players have diﬀerent ﬁnite sets of actions. Let A = {0, 1, . . ., K}n denote the vector of possible
actions for all players and let a = (a1 , ..., an) denote a generic element of A. As is common in the
literature, we let a−i = (a1 , ...ai−1, ai+1 , ..., an) denote a vector of strategies for all players excluding
player i. We will abstract from mixed strategies since in our model, with probability one each player
will have a unique best response.
    Let si ∈ Si denote the state variable for player i. Let S = Πi Si and let s = (s1 , ..., sn) ∈ S
denote a vector of state variables for all n players. We will assume that s is common knowledge to
all players in the game and in our econometric analysis, we will assume that s is observable to the
econometrician. The state variable is assumed to be a real valued vector, but Si is not required to
be a ﬁnite set. Much of the previous literature assumes that the state variables in a discrete games
lie in a discrete set. While this assumption simpliﬁes the econometric analysis of the estimator and
identiﬁcation, it is a strong assumption that may not be satisﬁed in many applications.
    For each agent, there are also K + 1 state variables which we label as i (ai ) which are pri-
vate information to each agent.            These state variables are distributed i.i.d. across agents and
actions. Let i denote the 1 × (K + 1) vector of the individual i (ai ). The density of i (ai ) will
be denoted as f (i (ai)). However, we shall sometimes abuse notation and denote the density for
εi = (εi (0), ..., εi(K)) as f (i ).
    The period utility function for player i is:

                                  ui (a, s, i; θ) = Πi (ai , a−i , s; θ) + i (ai ).                      (1)

The utility function in our model is similar to a standard random utility model such as a multinomial
logit. Each player i receives a stochastic preference shock, i (ai ), for each possible action ai . In
many applications, this will be drawn from an extreme value distribution as in the logit model.
In the literature, the preference shock is alternatively interpreted as an unobserved state variable
(see Rust (1994)). Utility also depends on the vector of state variables s and actions a through
Πi (ai , a−i , s; θ). For example, in the literature, this part of utility is frequently parameterized as
a simple linear function of actions and states. Unlike a standard discrete choice model, however,
note that the actions a−i of other players in the game enter into i’s utility. A standard discrete

                                                             5
choice model typically assumes that agents i act in isolation in the sense that a−i is omitted from
the utility function. In many applications, this is an implausible assumption.
   In this model, player i’s decision rule is a function ai = δi (s, i ). Note that i’s decision does not
depend on the −i since these shocks are private information to the other −i players in the game
and hence unobservable to i. Deﬁne σi (ai|s) as:
                                        
                         σi (ai = k|s) = 1 {δi (s, i ) = k} f (i )di .                               (2)

In the above expression, 1 {δi (s, i) = k} is the indicator function that player ı́’s action is k given
the vector of state variable (s, i ). Therefore, σi (ai = k|s) is the probability that i chooses action
k conditional on the state variables s that are public information. We will deﬁne the distribution
of a given s as σ(a|s) = Πni=1 σ(ai|s).
   Next, deﬁne πi (ai, s, i ; θ) as:
                                               
                       πi (ai , s, i ; θ) =         Πi (ai , a−i , s; θ)σ−i(a−i |s) + i (ai )         (3)
                                               a−i
                                                     where σ−i (a−i |s) = Πj=i σj (aj |s).             (4)

In (3), πi (ai , s, i; θ) is player i’s expected utility from choosing ai when the vector of parameters is
θ. Since i does not know the private information shocks, j for the other players, i’s beliefs about
                                                  
their actions are given by σ−i (a−i |s). The term   a−i Πi (ai , a−i , s, θ)σ−i(a−i |s) is the expected
value of Πi (ai , a−i , s; θ), marginalizing out the strategies of the other players using σ−i (a−i |s). The
structure of payoﬀs in (3) is quite similar to standard random utility models, except that the
probability distribution over other agents’ actions enter into the formula for agent i’s utility. Note
that if the error term has an atomless distribution, then player i’s optimal action is unique with
probability one. This is an extremely convenient property and eliminates the need to consider
mixed strategies as in a standard normal form game.
   We also deﬁne the deterministic part of the expected payoﬀ as
                                                 
                             Πi (ai , s; θ) =              Πi (ai , a−i , s, θ)σ−i(a−i |s).             (5)
                                                     a−i



It follows immediately then that the optimal action for player i satisﬁes:



            σi (ai|s) = P rob {i |Πi (ai , s; θ) + i (ai ) > Πi (aj , s; θ) + i (aj ) for j = i.}   (6)




                                                                 6
2.1      A Simple Example.

For expositional clarity, consider a simple example of a discrete game. Perhaps the most commonly
studied example of a discrete game in the literature is a static entry game (see Bresnahan and
Reiss (1991a), Bresnahan and Reiss (1991b),Berry (1992), Tamer (2003), Ciliberto and Tamer
(2003), Manuszak and Cohen (2004)). In the empirical analysis of entry games, the economist
typically has data on a cross section of markets and observes whether a particular ﬁrm, i, chooses
to enter a particular market. In Berry (1992) and Ciliberto and Tamer (2003), for example, the
ﬁrms are major U.S. airlines such as American, United and Northwest and the markets are large,
metropolitan airports. The state variables, si might include the population in the metropolitan
area surrounding the airport and measures of an airline’s operating costs. Let ai = 1 denote the
decision to enter a particular market and ai = 0 denote the decision not to enter the market. In
many applications, Πi (ai , a−i , s; θ) is assumed to be a linear function, e.g.:
                                                                    
                                                      s · β + δ          1 {aj = 1} if ai = 1
                             Πi (ai , a−i , s; θ) =                 j=i                                     (7)
                                                                        0 if ai = 0
In equation (7), the mean utility from not entering is set equal to zero.2 The term δ measures the
inﬂuence of j’s choice on i’s entry decision. If proﬁts decrease from having another ﬁrm enter the
market then δ < 0. The parameters β measure the impact of the state variables on Πi (ai , a−i , s).
      The random error terms εi (ai ) are thought to capture shocks to the proﬁtability of entry that
are private information to ﬁrm i. Suppose that the error terms are distributed extreme value.
Then, utility maximization by ﬁrm i implies that:
                                                            
                                           exp(s · β + δ          σj (aj = 1|s))
                                                            j=i
                      σi (ai = 1|s) =                                                   for i = 1, ..., n   (8)
                                        1+   exp(s    ·β+δ             σj (aj = 1|s))
                                                                 j=i

In the system of equations above, applying the formula in equation (5) implies that Πi (ai , s; θ) =
          
s · β + δ σj (aj = 1|s). Since the error terms are distributed extreme value, equation (6) implies
            j=i
that the choice probabilities, σi (ai = 1|s) take a form similar to a single agent multinomial logit
model. We note in passing that it can easily be shown using Brouwer’s ﬁxed point theorem an
equilibrium to this model exists for any ﬁnite s (see McKelvey and Palfrey (1995))).
      We exploit the convenient representation of equilibrium in equation (8) in our econometric
analysis. Suppose that the econometrician observes t = 1, ..., T repetitions of the game. Let ai,t
  2
      We formally discuss this normalization in our section on identiﬁcation.



                                                             7
denote the entry decision of ﬁrm i in repetition t and let the value of the state variables be equal
to st . By observing entry behavior in a large number of markets, the econometrician could form a
                    i (ai = 1|s) of σi (ai = 1|s) for i = 1, ..., n. In an application, this simply boils
consistent estimate σ
down to ﬂexibly estimating the probability that a binary response, ai is equal to one conditional
on a given set of covariates. This could be done using any one of a number of standard techniques.
    We let L(β, δ) denote the pseudo-likelihood function deﬁned as:
                         ⎛                                     ⎞1{ai,t =1} ⎛                                          ⎞1{ai,t =0}
                             exp(s ·β+δ       σ̂j (aj =1|s))                     exp(s ·β+δ          σ̂j (aj =1|s))
                
                T 
                  n
                         ⎜             j=i                      ⎟        ⎜                     j=i                     ⎟
                         ⎜                                       ⎟        ⎜1 −                                           ⎟
    L(β, δ) =            ⎝ 1+exp(s ·β+δσ̂                      ⎠        ⎝      1+exp(s ·β+δ
                                                                                                                        ⎠
                t=1i=1                            j (aj   =1|s))                                        σ̂j (aj   =1|s))
                                           j=i                                                  j=i
                              i (ai = 1|s), we could then estimate the structural parameters of the payoﬀ,
Given ﬁrst stage estimates of σ
β and δ, by maximizing the above pseudo-likelihood function. There are two attractive features of this
strategy. The ﬁrst is that it not demanding computationally. First stage estimates of choice probabilities
could be done using a strategy as simple as a linear probability model. The computational burden of the
second stage is also light since we only need to estimate a logit model. A second attractive feature is that
it allows us to view a game as a generalization of a standard discrete choice model. Thus, techniques from
the voluminous econometric literature on discrete choice models can be imported into the study of strategic
interaction. While the example considered above is simple, it nonetheless illustrates many of the key ideas
that will be essential in what follows.
    We can also see a key problem with identiﬁcation in the simple example above. Both the ﬁrst stage
          i (ai = 1|s) and the term s · β depend on the vector of state variables s. This suggests that we
estimates σ
will suﬀer from a collinearity problem in order to separately identify the eﬀects of β and δ on the observed
choices. The standard solution to this type of problem in many settings is to impose an exclusion restriction.
Suppose, for instance, a ﬁrm speciﬁc productivity shock is included in s. In most oligopoly models, absent
technology spillovers, the productivity shocks of ﬁrms −i would not directly enter into ﬁrm i’s proﬁts. These
shocks only enter indirectly through the endogenously determined actions of ﬁrms −i, e.g. price, quantity
or entry decisions. Therefore, if we exclude the productivity shocks of other ﬁrms from the term s · β, we
would no longer suﬀer from a collinearity problem. While this idea is quite simple, as we shall discover in
the next section, similar restrictions are required to identify more general models.


3     Nonparametric Identiﬁcation
In this section, we consider the problem of identifying the deterministic part of payoﬀs, without making
particular assumptions about its functional form (e.g. that it is a linear index as in the previous example).
In the context of nonparametric identiﬁcation, we let θ be completely nonparametric and write Πi (ai , a−i , s)
instead of Πi (ai , a−i , s; θ).

Deﬁnition We will say that Πi (ai , a−i , s) is identiﬁed if Πi (ai , a−i , s) = Πi (ai , a−i , s) for some i = 1, ..., n
       implies that for the corresponding equilibrium choice probabilities σi (ai = 1|s) = σi (ai = 1|s) for some
       i = 1, ..., n.


                                                                      8
Formally, identiﬁcation requires that diﬀerent values of the primitives generate diﬀerent choice probabilities.
If this condition is not satisﬁed, then it will be impossible for us to uniquely recover the structural parameters
Πi (ai , a−i , s) (for i = 1, ..., n) from knowledge of the observed choice probabilities, σi (ai = 1|s).
    It is well known that even in a single agent problem, it is not possible to nonparametrically identify both
Πi (ai , a−i , s) and the joint distribution of the error terms F (i ). To take the simplest possible example,
consider a simple binary response model and assume that the error terms are normally distributed, as in the
probit model. Let σi (ai = 1|s) denote the probability that the response is equal to one in the data conditional
on s. Deﬁne Πi (ai = 0|s) = 0 and Πi (ai = 0|s) = F −1 (σi (ai = 1|s)) where F −1 denotes the normal cdf. It
can easily be veriﬁed that this deﬁnition of Πi perfectly rationalizes any set of choice probabilities σi (ai = 1|s).
Since our model is not identiﬁed without a parametric assumption on the error term in even a simple probit
model, assumptions at least as strong will be required in the more general set up that we consider here.
In Bajari, Hong, and Ryan (2004) we demonstrate that when we allow for nonparametric Πi (ai , a−i , s) an
independence assumption is required to identify our model in even single agent problems. In what follows,
we will typically impose the assumption that the error terms are distributed i.i.d. extreme value since both
an independence and parametric form assumption on the error terms are required for identiﬁcation.
    Based on the discussion above, we shall impose the following assumption in order to identify the model.

A1 The error terms i (ai ) are distributed i.i.d. across actions ai and agents i. Furthermore, the parametric
         form of the distribution F comes from a known family.
                                                                                             
    Analogous to the notation in the previous section, deﬁne Πi (k, s) =                         a−i   Πi (ai = k, a−i , s)σ−i (a−i |s).
It is straightforward to show that the equilibrium in this model must satisfy:

                   δi (s, i ) = k if and only if Πi (k, s) + i (k) > Πi (k  , s) + i (k  ) for all k  = k.                   (9)

That is, action k is chosen if and only if the deterministic expected payoﬀ and error term associated with
action k is greater than the analogous values of k  = k. An implication of (9) is that the equilibrium choice
probabilities σi (a|s) must satisfy:

        σi (ai |s) = Pr {i (ai ) + Πi (ai , s) − Πi (0, s) > i (k) + Πi (k, s) − Πi (0, s), ∀k = 0, . . . , K, k = ai }         (10)

Equation (10) is a simple consequence of (9) where we can subtract Πi (0, s) from both sides of the inequality.
    Suppose we generate i (ai ) from an extreme value distribution as in the logit model. Then (10) implies
that:
                                                      exp(Πi (ai , s) − Πi (0, s))
                                        σi (ai |s) = K                                                                            (11)
                                                      k=0 exp(Πi (k, s) − Πi (0, s))

A key insight due to Hotz and Miller (1993) is that equation (11) implies that the equilibrium choice
probabilities, σi (ai |s), have a one-to-one relationship to the “choice speciﬁc value functions”, Πi (ai , s) −
Πi (0, s). To see why, note that taking logarithms of both sides of (11) implies that for any k, k  :

                                     log (σi (k|s)) − log (σi (k  |s)) = Πi (k, s) − Πi (k  , s).



                                                                    9
    The one-to-one mapping between choice probabilities and choice speciﬁc value functions holds more
generally than in just the logit model. It is obvious that we should expect it in any model where the
distribution of i has full support. We let Γ : {0, ..., K} × S → [0, 1] denote the map in general from choice
speciﬁc value functions to choice probabilities, i.e.

                     (σi (0|s), ..., σi(K|s)) = Γi (Πi (1, s) − Πi (0, s), ..., Πi(K, s) − Πi (0, s)) .                       (12)

We will denote the inverse mapping by Γ−1 :

                 (Πi (1, s) − Πi (0, s), ..., Πi(K, s) − Πi (0, s)) = Γ−1
                                                                       i (σi (0|s), ..., σi(K|s)) .                           (13)

    The above analysis implies that we can invert the equilibrium choice probabilities to nonparametrically
recover Πi (1, s) − Πi (0, s), ..., Πi(K, s) − Πi (0, s). However, the above analysis implies that we will not be
able to separately identify Πi (1, s) and Πi (0, s), we can only identify the diﬀerence between these two terms.
Therefore, we shall impose the following assumption:

A2 For all i and all a−i and s, Πi (ai = 0, a−i , s) = 0.

The above assumption is similar to the “outside good” assumption in a single agent model where the mean
utility from a particular choice is set equal to zero. In the context of our entry model, this assumption is
satisﬁed if the proﬁt from not entering the market is equal to zero regardless of the actions of other agents.
Just as in the single agent model, there are alternative normalizations that we could use to identify the
Πi (ai , a−i , s) just as in a single agent model. However, for expositional simplicity we shall restrict attention
to the normalization A2.
    Given assumption A2 and knowledge of the equilibrium choice probabilities, σi (ai |s), we can then apply
the mapping in (13) to recover Πi (ai , s) for all i, ai and s. Recall that the deﬁnition of Πi (ai , s) implies that:
                                    
                    Πi (ai , s) =         σ−i (a−i |s)Πi (ai , a−i , s), ∀i = 1, . . . , n, ai = 1, . . . , K.                (14)
                                    a−i


    Even if we know the values of Πi (ai , s) and σ−i (a−i |s) in the above equation, it is not possible to uniquely
determine the values of Πi (ai , a−i , s). To see why, hold the state vector s ﬁxed, determining the utilities of
all agents involves solving for n × K × (K + 1)n−1 unknowns. That is, there are n agents, for each action
k = 1, ..., K, utility depends on the (K + 1)n−1 possible actions of the other agents.                           However, the left
hand side of (14) only contains information about n × (K + 1) scalars holding s ﬁxed.                             It is clearly not
possible to invert this system in order to identify Πi (ai , a−i , s) for all i, all k = 1, ...., K and all a−i ∈ A−i .
Related nonidentiﬁcation results have been found by Bresnahan and Reiss1991a, 1991c and Pesendorfer and
Schmidt-Dengler (2003) in the context of dynamic games with discrete state spaces.
    Obviously, there must be cross-equation restrictions across either i or k in order to identify the system.
One way to identify the system is to impose exclusion restrictions. Partition s = (si , s−i ), and suppose
Πi (ai , a−i , s) = Πi (ai , a−i , si ) depends only on the subvector si . An example of this might be in an entry
model.    In this type of model the state is usually a vector of productivity shocks.                            While we might
expect the proﬁt of ﬁrm i to depend on the entry decisions of other agents, it should not depend on the


                                                                   10
productivity shocks of other agents. See Bajari, Hong, and Ryan (2004) for other examples of possible
exclusion restrictions that can be used in applications. If such an exclusion restriction is possible, we can
then write
                                                         
                                 Πi (ai , s−i , si ) =         σ−i (a−i |s−i , si )Πi (ai , a−i , si ).                       (15)
                                                         a−i

Clearly, a suﬃcient identiﬁcation condition is that for each si , there exists (K + 1)n−1 points in the support
of the conditional distribution of s−i given si , such that this system of equations form by these (K + 1)n−1
                                                                               (K+1)n−1
points given si is invertible. In other words, Let s1−i , . . . , s−i                       denote these points, then identiﬁcation
requires that the matrix
                                                                                                   
                        σ(a−i |sj−i , si ), a−i = 1, . . . , (K + 1)n−1 , j = 1, . . . , (K + 1)n−1

be nonsingular and invertible. Note that this assumption will be satisﬁed as long as s−i contains a continu-
ously distributed variable with Πi (ai , a−i , si ) suﬃcient variability.

Theorem 1 Suppose that A1 and A2 hold. Also suppose that for each si , there exists (K + 1)n−1 points in
the support of the conditional distribution of s−i given si so that (15) is invertible. Then the latent utilities
Πi (ai , a−i , si ) are identified.

    Another approach to identiﬁcation is to exploit the multiplicity of equilibria. Suppose that there is some
state variable z which shifts which equilibrium to the game is played, but otherwise does not enter into the
payoﬀs. Then we can write the payoﬀs are σi (ai |s, z) but the utilities do not directly depend on the variable
z. We shall give a detailed example of such a variable in our application which is due to the intervention
in the market by a regulator which we interpret as shifting the equilibrium to the game but not directly
entering payoﬀs. This generates variation in the right hand size of (15) which allows us to check similar rank
conditions. We note that Sweeting (2005) has also pointed out that the multiplicity of equilibrium can help
in identifying a special case of the model above.


4     Estimation
In the previous section, we demonstrated that there is a nonparametric inversion between choice probabil-
ities and the choice speciﬁc value functions, Π(ai , s). Furthermore, we demonstrated that the structural
parameters of our model are identiﬁed if appropriate exclusion restrictions are made on payoﬀs. In this
section, we exploit this inversion to construct nonparametric and semiparametric estimates of our structural
parameters.

Step 1: Estimation of Choice Probabilities. Suppose the economist has access to data on t =
1, . . . , T repetitions of the game. For each repetition, the economist observes the actions and state variables
                                                                    i (k|s) of σi (k|s) using sieve series expansions
for each agent (ai,t , si,t ). In the ﬁrst step we form an estimate σ
( see Newey (1990) and Ai and Chen (2003)). We note, however, that we could alternatively estimate the ﬁrst
stage using other nonparametric regression methods such as kernel smoothing or local polynomial regressions.

                                                                      11
    Let {ql (s), l = 1, 2, . . .} denote a sequence of known basis functions that can approximate a real valued
measurable function of s arbitrarily well for a suﬃciently large value of l. The sieve could be formed using
splines, Fourier Series or orthogonal polynomials. We let the basis become increasingly ﬂexible as the number
of repetitions of the game T becomes large. Let κ(T ) denote the number of basis functions to be used when
the sample size is T. We shall assume that κ(T ) → ∞, κ(T )/T → 0 at an appropriate rate to be speciﬁed
below. Denote the 1 × κ(T ) vector of basis functions as

                                            q κ(T ) (s) = (q1 (s), . . . , qκ(T ) (s)),                          (16)

and its collection into a regressor data matrix as

                                               QT = (q κ(T ) (s1 ), . . . , q κ(T ) (sT ).

                                      i (k|s), k = 1, . . . , K is a linear probability model, i.e.:
    One potential sieve estimator for σ
                                            
                                            T
                               i (k|s) =
                               σ                  1(ait = k)q κ(T ) (st )(QT QT )−1 q κ(T ) (s).                (17)
                                            t=1

Equation (17) is the standard formula for a linear probability model where the regressors are the sieve
functions κ(T ) in equation (16). We note that in the presence of continuous state variables, the sieve
                                                                                                  √
          i (k|s) will converge to the true σi (k|s) at a nonparametric rate which is slower than T .
estimator σ

Second Step: Inversion In our second step, we take as given our estimates σi(k|s) of the equilibrium
choice probabilities. We then form an estimate of the expected deterministic utility functions, Π̂i (k, st ) −
Π̂i (0, st ) for k = 1, ..., K and t = 1, ..., T .                                                i (k|s) in place of
                                                        This can be done by evaluating (13) using σ
σi (k|s). That is:
                                                                         
                Π               i (0, st ), ...Π
                 i (1, st ) − Π                 i(K, st ) − Π
                                                               i (0, st ) = Γ−1 (
                                                                                  σi (0|st ), ..., 
                                                                                                   σi(K|st ))    (18)
                                                                                  i

In the speciﬁc case of the logit model, this inversion would simply be:

                                Π̂i (k, st ) − Π̂i (0, st ) = log (
                                                                   σi (k|st )) − log (
                                                                                      σi (0|st ))                (19)

In an alternative model, such as one with normal shocks, we would need to solve a nonlinear system. In
what follows, we shall impose A2 so that Π̂i (0, s) = Π̂i (0, a−i , s) = 0 for all a−i .

Third Step: Recovering The Structural Parameters In the ﬁrst step we recovered an estimate
of σ̂i (ai , s) and in the second step we recovered an estimate of the choice speciﬁc value function Π̂i (k, s). In
our third step, we use the empirical analogue of (14) to form an estimate of Π(ai , a−i , si ). We shall assume
that we have made a suﬃcient number of exclusion restrictions, as discussed in the previous section, so that
the model is identiﬁed. For a given value of si , for a given a = (ai , a−i ), we estimate Πi (ai , a−i , si ) by
minimizing the following weighted least square function
    Πi (ai , a−i , si ), which are taken to be a vector of coeﬃcients:
                          ⎛                                                                    ⎞2
                      T                           
                          ⎝Π̂i (ai , s−it , si ) −   σ̂−i (a−i |s−it , si ) Πi (ai , a−i , si )⎠ w (t, si ) ,    (20)
                     t=1                          a−i



                                                                  12
where the nonparametric weights w (t, si ) can take a variety of forms. For example,
                                                       T              
                                             sit − si            siτ − si
                            w (t, si ) = k             /     k                                                 (21)
                                                 h       τ=1
                                                                     h

uses kernel weights, and other local weights are also possible. The identiﬁcation condition in the previous
section ensures that the regressor matrix in this weighted least square regression is nonsingular asymptoti-
cally.


4.1      A Linear Model of Utility
The nonparametric estimation procedure described in the previous section follows the identiﬁcation argu-
ments closely and oﬀers the advantage of ﬂexibility and robustness against misspeciﬁcation. However, without
a huge amount of data nonparametric estimation methods can be subject to severe curve of dimensionality
when we intend to control for a large dimension of state variables s. Also, in small samples, diﬀerent imple-
mentations of nonparametric procedures may lead to drastically diﬀerent point estimates. Therefore in the
following we consider a semiparametric estimation where the deterministic utility components Πi (ai , a−i , s)
are speciﬁed to be a linear function of a ﬁnite dimensional parameter vector θ. This is the typical econometric
speciﬁcation that is commonly used in the empirical literature. In this section we describe a straightforward
estimation and inference procedure for this model.
    The deterministic part of the utility is assumed to take the form of
                                                                              
                                      Πi (ai , a−i , si ) = Φi (ai , a−i , si ) θ.                             (22)

In the above expression, the deterministic part of utility is a linear combination of a vector of basis functions,
Φi (ai , a−i , si ). For instance, we might let utility be a linear index as in our simple entry game example of the
previous section. Alternatively, we might choose Φi (ai , a−i , si ) to be a standard ﬂexible functional form, such
as a high order polynomial, spline function or orthogonal polynomial. The estimator we discuss below can
easily be generalized to allow for the possibility that θ enters the utility nonlinearly. However, the exposition
of the properties of the estimator is facilitated by the linearity assumption. Also, most applications of
discrete choice models and discrete games usually are linear in the structural parameters of interest.
    This linearity assumption implies that the choice speciﬁc value function, given ai and s, takes the
convenient form:
                                                                                       
                             Πi (ai , s) = E [Πi (ai , a−i , si ) |s, ai ] = Φi (ai , s) θ.                    (23)

where Φi (ai , s) is deﬁned as:

                            Φi (ai , s) =              E [Φi (ai , a−i , si ) |ai , s]                         (24)
                                                                        
                                        =        a−i Φi (ai , a−i , si )  j=i σ(aj = kj |s).

    Arguing as in Section 2, it follows that if the error terms are distributed extreme value, the equilibrium
choice probabilities must satisfy:
                                                                    
                                                     exp Φi (ai , s) θ
                                   σi (ai |s) =      K                 
                                                                            .                                  (25)
                                                  1 + k=1 exp Φi (k, s) θ

                                                             13
    More generally, if the error terms are not distributed extreme value, it may not be possible to express the
equilibrium choice probabilities in closed form as above. However, equation (6) implies that each σi (ai |s)
depends on σj (aj |s) , j = i through (24). We denote this mapping as:

                              σi (ai |s) = Γi,ai (s, σj (k|s) , j = i, k = 1, . . . , K) .                           (26)

If we deﬁne σ (s) to be the stacked vector of choice probabilities σi (k|s) for all k = 1, . . . , K, i = 1, . . . , n,
then we can collect (26) into a ﬁxed point mapping:

                                                   σ (s) = Γ (σ (s)) .                                                (27)

To emphasize the dependence on the parameter θ, we can also write

                                              σ (s; θ) = Γ (s, θ; σ (s; θ)) .                                         (28)


4.2    Semiparametric Estimation.

Step 1: Estimation of Choice Probabilities. The simple semiparametric procedure we propose
proceeds in two steps. We begin by forming a nonparametric estimate of the choice probabilities, σ̂i (k|s).
We will do this like above using a sieve approach, however, one could alternatively use kernels or a local
polynomial method.


                                                                −1
                                                                     
                                                                     T
                           σ̂i (k|s) = q κ(T ) (s) (QT QT )              q κ(T ) (sτ )1 (ai = k) .                  (29)
                                                                     τ=1

Given our estimates of the choice probabilities, we can then estimate Φi (k, s) correspondingly by
                                                                               
                                 Φ̂i (k, s) =          Φi (ai = k, a−i , si )          σ̂(aj |s)                      (30)
                                                 a−i                            j=i
                                                                                                           
For instance, take the example presented in (7). In this example, Πi (ai = 1, a−i , s) = (s,               j=i   1{aj =
                                                                                                           
1})·(β, δ) where “ ·” denotes an inner product. Thus, in the above formula, Φi (ai = 1, a−i ) = (s,           j=i 1{aj   =
                                                                                                       
1}) and θ = (β, δ). Then, given our ﬁrst stage estimates of the choice probabilities, Φ̂ (ai = 1, a−i ) =
   
(s, j=i 1{aj = 1}σj (aj |s)).
    Then for each parameter value θ, we can evaluate the empirical analogue of (28). For example, in the
multinomial logit case,
                                                                             
                                                                           
                                                         exp Φ̂i (ai , s) θ
                                σi       ai |s, Φ̂, θ =    K                                                       (31)
                                                                                
                                                        1 + k=1 exp Φ̂i (k, s) θ




                                                                14
Step 2: Parameter Estimation. In the second stage a variety of estimators can be used to recover
the value of θ. Most of these estimators can be written as GMM estimators with a properly deﬁned set of
instruments. To describe the second stage, deﬁne yikt = 1 if ait = k and yikt = 0 otherwise, for k = 0, . . . , K.
Deﬁne yit = (yi1t , . . . , yiKt ) and the vector
                                                                                  
                                    σi st , Φ̂, θ = σi k|st , Φ̂, θ , k = 1, . . . , K                                (32)

Furthermore,
             collect yit , i = 1, . . . , n into a long
                                                        vector  yt with n × K elements, and similarly collect
σi st , Φ̂, θ , i = 1, . . . , n into a long vector σ st , Φ̂, θ with corresponding n × K elements. Then for
any dimension dim (θ) × (nK) matrix of instruments Â (st ), a GMM estimator θ̂ can be deﬁned by solving
the sample equations:

                                            1 
                                               T                           
                                                  Â (st ) yt − σ st , Φ̂, θ̂ = 0.                                    (33)
                                            T t=1

The instrument matrix Â (st ) may be known as A (st ), may be estimated in the ﬁrst stage (such as two-step
optimally weighted GMM), or may be estimated simultaneously (such as pseudo MLE). For example, with
a pseudo MLE method, θ̂ is deﬁned by maximizing the pseudo likelihood function, which can be written as
the following because of the independent error terms across agents:
                  K                                                                 
           T n                                   
                                                      K              
                                                                     K                
                       yikt log σi k|st , Φ̂, θ + 1 −   yikt log 1 −   σi k|st , Φ̂, θ     .                          (34)
            t=1 i=1   k=1                                               k=1                          k=1
                                                  
In the following we let σ̂ikt (θ) = σi k|st , Φ̂, θ . The ﬁrst order condition for the “pseudo” MLE estimator
is then given by
                                                   K                      
                                                                             ∂                 
                    T  n 
                                                     j=1 (yijt − σ̂ijt (θ))
                            K
                                 yikt − σ̂ikt (θ)
                                                  +      K                      σi k|st , Φ̂, θ̂ ,                   (35)
                   t=1 i=1 k=1
                                     σ̂ikt (θ)       1 − j=1 σ̂ijt (θ)        ∂θ

In term 
        of expressing
                       it as an instrumental variable estimator, this corresponds to (33) with Â (st ) equal to
the ∂θ σ st , Φ̂, θ̂ × Ŵ (st , θ), where Ŵ (st , θ) is the nK × nK diagonal matrix, such that the ith diagonal
     ∂

block, for i = 1, . . . , n, is given by
                                  ⎡    1
                                                                        ⎤    ⎡       1
                                                                                             ⎤
                                     σ̂i1t (θ)      0          0                 σ̂i0t (θ)
                                 ⎢                                      ⎥ ⎢         ..       ⎥
                                 ⎢                 ..                   ⎥+⎢                  ⎥ [1 · · · 1] ,          (36)
                                 ⎣      0               .      0        ⎦ ⎣          .       ⎦
                                                                1                    1
                                        0           0       σ̂iKt (θ)            σ̂i0t (θ)

                        K
where σ̂i0t (θ) = 1 −       j=1 σ̂ijt (θ).    If we deﬁne W (st , θ) in analog to Ŵ (st , θ), except with Φ̂ replaced by
                                                                                                                      −1
the true unknown Φ in each σ̂ikt (θ), then it is easy to verify that W (st , θ0 ) = V ar (yt − σ (st , Φ, θ0 ) |st )       ,
where the ith diagonal block of the              block diagonal matrix V ar (yt − σ (st , Φ, θ0 ) |st ) is given by
                           ⎡                                ⎤ ⎡         ⎤
                              σi1t                0     0         σi1t
                           ⎢                                ⎥ ⎢ . ⎥
                           ⎢                     ..         ⎥ ⎢         ⎥
                           ⎣ 0                      .   0 ⎦ − ⎣ .. ⎦ [σi1t · · · σiKt ] .                             (37)
                               0                  0 σiKt          σiKt

                                                                        15
It is well known that the estimation errors in Â (st ) will not aﬀect the asymptotic distribution of θ̂ deﬁned
by (33), regardless of whether Â (st ) is estimated in a preliminary step or is estimated simultaneously with
θ̂. Therefore, the asymptotic distribution of the pseudo MLE is the same as that of an infeasible GMM IV
estimator with an instrument matrix A(st ) which is given by
                                          ∂
                                             σ (st , Φ0 , θ0 ) × W (st , θ0 )                             (38)
                                          ∂θ
Here note that in terms of (28)
                                                                                   !
                            ∂                       ∂                              !
                               σ (st , Φ0 , θ0 ) =     Γ (st , θ1 , σ (st ; θ2 )) !!                      (39)
                            ∂θ                     ∂θ1                               θ1 =θ2 =θ

Therefore, assuming all Φ are known, the MLE corresponds to the eﬃcient choice of instruments Â (st )
in (33), under the eﬃciency framework of Newey and McFadden (1994). Therefore, next we will focus on
deriving the large sample properties of θ̂ deﬁned by (33) where A(st ) is known.
    The estimator that we consider falls within the class of semiparametric estimators considered by Newey
(1994). A somewhat surprising conclusion is that even though the ﬁrst stage is estimated nonparametrically
                                                      √
and can be expected to converge at a rate slower than T , the structural parameters will be asymptotically
                                      √
normal and will converge at a rate of T . Moreover, under appropriate regularity conditions, the second
stage asymptotic variance will be independent of the particular choice of nonparametric method used to
estimate the ﬁrst stage (e.g. sieve or kernel). As a practical matter, these results justify the use of the
bootstrap to calculate standard errors for our model.
    In the appendix, we derive the following result, applying the general framework developed by Newey
(1990). Under appropriate regularity conditions, the asymptotic distribution of θ̂ deﬁned in 33 satisﬁes the
following:
                                    √                     
                                                               
                                     T θ̂ − θ −→ N 0, G−1ΩG−1 ,
                                               d



where
                                                          ∂
                                         G = EA (st )        σ (st , Φ0 , θ0 ) ,                          (40)
                                                          ∂θ
and Ω is deﬁned such that

                             1 
                                 T                           
                                                                   d
                            √       A (st ) yt − σ st , Φ̂, θ0    −→ N (0, Ω) .                           (41)
                              T t=1

In the appendix, we also compare the asymptotic variance of alternative estimators.


4.3     Linear Probability Model
Next, we demonstrate that in many cases it is possible to estimate our model using a simple two stage
least squares method. While the formal econometrics in this section are quite straightforward, we believe
that this observation is useful for researchers. Much of the previous literature on estimating games has
concentrated on the case of fully dynamic models and required an understanding of dynamic programming.

                                                              16
In this section, we demonstrate that the methods in their simplest version only require invoking the ivreg
command in STATA.
    To simplify notation, we will focus on a binary choice model in the following. The extension to multino-
mial models is straightforward. Therefore consider a special case of (1) where K = 1, Πi (0, a−i , s) = i (0) ≡
                                                      
0, θ, Φi (1, a−i , s; θ) = Φ1i (si ) β + Φ1i (a−i , s) γ so that
                                                                                          
                                  ui (1, a−i , s; θ) = Φ1i (si ) β + Φ2i (a−i , s) γ + i (1) ,

and i (1) is uniformly distributed on the interval (−1, 0). The decision rule of agent i is such that action 1
is chosen if and only if
                                                                  "                #
                        E [ui (1, a−i , s; θ) |s] = Φ1i (si ) β + E Φ2i (a−i , s) |s γ + i (1) > 0.

Because of the uniform distribution assumption of i (1), this implies that
                                                           "                #
                              P (ai = 1|s) = Φ1i (si ) β + E Φ2i (a−i , s) |s γ,

which can be written as
                                                          "                #
                                       ai = Φ1i (si ) β + E Φ2i (a−i , s) |s γ + ηit (1) ,                  (42)

such that E (ηit (1) |st ) = 0.
  In this model Φ1i (si ) and Φ2i (a−i , s) are known functions, but β and γ are unknown parameters.
 " 2             #
E Φi (a−i , s) |s needs to be estimated nonparametrically. As before, this can be consistently estimated
by a linear least square regression with a suﬃciently large number of sieve approximating functions in the
ﬁrst step:
                         " 2             #                     −1
                                                                   
                                                                   T
                                              κ(T )       
                       Ê Φi (a−i , s) |s = q       (s) (QT QT )     q κ(T ) (sτ ) Φ2i (a−iτ , sτ ) .
                                                                              τ=1

In the second step, a linear regression is used to estimate β and γ:
                                           T 
                                                                        "                    # 2
                            β̂, γ̂ = arg min     ait − Φ1i (sit ) β − Ê Φ2i (a−it , st ) |st γ .
                                           β,γ
                                                 t=1

Note that this is precisely a two stage least square estimator. Also note that this is a special case of (33)
where
                                                                                              
                                                                       Φ1i (sit )
                                            Âi (st ) =          "                     #           ,
                                                               Ê Φ2i (a−it , st ) |st
                                   "                    #
                              
and σ st , Φ̂, θ̂ = Φ1i (sit ) β + Ê Φ2i (a−it , st ) |st and yit − σi (st , θ0 ) = ηit (1).
    In the following we will demonstrate that the ivreg procedure with the robust standard error options in
stata will give correct standard errors for this model, when ai is entered as the dependent variable, Φ1i (s) is
entered as the exogenous regressor, Φ2i (a−i , s) is entered as the endogenous regressor, and q κ(T ) (s) is used
as the set of instruments to instrument for Φ2i (a−i , s). In other words, β̂ and γ̂ are computed as
                                              
                                                           1
                                                              T
                                            β̂
                                    θ̂ =          = A−1T        Âi (st ) ait ,
                                            γ̂             T t=1


                                                                    17
where
                                                     1 
                                                        T
                                                
                                                AT =       Âi (st ) Âi (st ) .
                                                     T t=1

Then it follows from a standard manipulation that
                                           
                               √                     1 
                                                         T
                                     β̂ − β
                                 T            = A−1
                                                  T √       m̂i (st , β, γ) ,
                                     γ̂ − γ           T t=1

where
                                                                          "                    # 
                                                                    
                        m̂i (st , β, γ) = Âi (st ) ait − Φ1i (sit ) β − Ê Φ2i (a−it , st ) |st γ .

The asymptotic variance is then a special case of section (C). We will use a slightly diﬀerent notation here
to facilitate comparison with 2SLS. In particular, it follows from Newey (1994) that

                                    1                        1 
                                        T                         T
                                   √       m̂i (st , β, γ) = √       mi (st , β, γ) + op (1) ,
                                     T t=1                     T t=1

where mi (st , β, γ) = Ai (st ) (ηit (1) − vit (1) γ) , and
                                                                     "                    #
                                       vit (1) = Φ2i (a−it , st ) − E Φ2i (a−it , st ) |st .

The asymptotic distribution of the 2SLS estimator is then given by, letting A = EAi (st ) Ai (st ) :
                                  ⎛                                                      ⎞
              √         
                                  ⎜                                                   ⎟
                T θ̂ − θ −→ N ⎝0, A−1 EAi (st ) V ar ηit (1) − vit (1) γ|st Ai (st ) A−1 ⎠ .
                            d
                                                  $           %&            '
                                                                              Σ(st )

To obtain a consistent estimate of this asymptotic variance matrix, both A and Σ (st ) needs to be estimated.
A can be estimated by AT . The key in estimating Σ (st ) is to estimate ηit (1) − vit (1) consistently. This can
be estimated by
                                                      
            eit =ait − Φ1i (sit ) β̂ − Φ2i (a−it , st ) γ̂
                                         "                  #                       "                    #
                =ait − Φ1i (sit ) β̂ − E Φ2i (a−it , st ) |st γ̂ − Φ2i (a−it , st ) − E Φ2i (a−it , st ) |st γ̂.
                               
Then EAi (st ) Σ (st ) Ai (st ) can be consistently estimated by

                                                 1 
                                                    T
                                                                                   
                                                       Âi (st ) eit eit Âi (st ) .
                                                 T t=1

Now note that this is precisely how Stata ivreg calculates robust standard errors for 2SLS estimators.


5     Fixed eﬀect model of unobserved heterogeneity
5.1     Nonparametric identiﬁcation
Unobserved heterogeneity can be a potentially important source of misspeciﬁcation if it is not accounted for
in the model. In this section, we discuss how to introduce market speciﬁc ﬁxed eﬀects into our model. For

                                                                 18
each market t = 1, . . . , T , all the players in that market observe a market speciﬁc proﬁt shifter αt that is not
observed by the econometrician. We will assume that αt is an unknown but smooth function of the state
variables st = (st1 , . . . , stn ) in that market, which we will denote as α (st ). In principal, we would prefer a
model where the unobserved heterogeneity was not required to be a function of the observables. However,
in highly nonlinear models, such as ours, similar assumptions are commonly made (see, for example, Newey
(1994)).
    This assumption is convenient technically since it implies that the equilibrium choice probabilities, σi can
still be written as a function of the state st . If the unobserved heterogeneity were not a function of st , then
it would be quite diﬃcult to estimate the choice probabilities, σi since they would depend on an unknown,
market speciﬁc parameter in a nonlinear manner. There is no obvious method to identify or estimate the
ﬁrst stage in this case.
    With the inclusion of a market speciﬁc ﬁxed eﬀect, the mean period utility function in (1) for player i
in market t is now modiﬁed to

                                    Πi (ai , a−i , s) = α (ai , s) + Π̃i (ai , a−i , s).                              (43)

In the above, and what follows, we drop the market speciﬁc subscript t for notational simplicity.
    Under the normalization assumption that Πi (0, a−i , s) ≡ 0 for all i = 1, . . . , n, our previous results show
that, as in (14), the choice speciﬁc value functions Πi (ai , s) are nonparametrically identiﬁed. Note that the
choice speciﬁc value functions must satisfy ∀i = 1, . . . , n, ai = 1, . . . , K:
                                                    
                             Πi (ai , s) =                σ−i (a−i |s)Πi (ai , a−i , s)
                                                        a−i
                                                         
                                       =     α (ai , s) + a−i σ−i (a−i |s)Π̃i (ai , a−i , si ).                       (44)

    Obviously, since α (ai , s) is unknown but is the same function across all market participants, they can
be diﬀerenced out by looking at the diﬀerence of Πi (k, s) and Πj (k, s) between diﬀerent players i and j. By
diﬀerencing (44) between i and j one obtains
                                                                       
          Πi (k, s) − Πj (k, s) =   σ−i (a−i |s) Π̃i (ai , a−i , si ) −   σ−j (a−j |s) Π̃j (aj , a−j , sj )
                                     a−i                                     a−j

Here we can treat Π̃i (ai , a−i , si ) and Π̃j (aj , a−j , sj ) as coeﬃcients, and σ−i (a−i |s) and σ−j (a−j |s) as regres-
sors in a linear regression. Identiﬁcation follows as in Theorem 1. As long as there is suﬃcient variation in the
state variables si , sj , the coeﬃcients Π̃i (ai , a−i , si ) and Π̃j (aj , a−j , sj ) can be nonparametrically identiﬁed.
    We could nonparametrically estimate Π̃j (aj , a−j , sj ) using an approach analogous to the nonparametric
approach discussed in section Section 4. However, in practice, semiparametric estimation will typically be a
more useful alternative. Denote the mean utility (less the market speciﬁc ﬁxed eﬀect) as:
                                                                                
                                       Π̃i (ai , a−i , si ) = Φi (ai , a−i , si ) θ.                                  (45)

    In practice, we imagine estimating the structural model in two steps. In the ﬁrst step, we estimate
the equilibrium choice probabilities nonparametrically. In the second stage, we estimate Π̃i treating α (st )
as a ﬁxed eﬀect in a discrete choice model. Estimating discrete choice models with ﬁxed eﬀects is quite
straightforward is many cases.

                                                               19
    For instance, consider a model of entry and suppose that the error terms are distributed extreme value.
In the ﬁrst step, we nonparametrically estimate Φ̂i (1, sit ), the probability of entry by ﬁrm i when the state is
sit . As in the previous section, we could do this using a sieve linear probability model. In the second stage,
we can form a conditional likelihood function as in Chamberlain (1984)). This allows us to consistently
estimate θ when market speciﬁc ﬁxed eﬀects α (st ) are present. The likelihood function is then:
                            n                                    n                     
                
                T                                                        
                                                                        
        log L =     log exp θ       ait Φ̂i (1, sit )   − log     exp θ      dit Φ̂i (1, sit )
                   t=1                        i=1                       dt ∈Bt          i=1
                     n                n
where Bt ≡ {dt :         i=1   dit =    i=1    ait } is the set of actions that give rise to the same number of entrants
as observed in the data. In other words, the likelihood is formulated conditional on the number of entrants.
One can follow similar steps as in previous derivations to prove consistency and demonstrate asymptotic
normality of this semiparametric conditional logit estimator where Φ̂i (1, sit ) is estimated in the ﬁrst stage
nonparametrically.
    We also note that we could estimate this model using a using a panel data rank estimation type procedure
as in (Manski (1987)). While this is a more challenging model computationally, it is free of distributional
assumptions on the error term.


6     Computing Models with Multiple Equilibria.
In the previous sections, we have either assumed that the model has a unique equilibrium (which can be the
case, for example, for a linear probability interaction model), or that only a single equilibrium outcome out of
several possible multiple equilibria is being observed in the data set. However, in many static game models,
multiple equilibria are possible. The importance of multiple equilibria in empirical research is emphasized
by many authors, including Brock and Durlauf (2001) and Sweeting (2005). In the rest of this manuscript
we present a method for estimating parametric models of interactions in the presence of possible multiple
equilibria.
    In the previous sections we have considered a model with known distribution F (i ) of the error terms
and a parametric model for the mean utility functions Πi (ai , a−i , θ). At every possible parameter value
θ, given the known distribution F (i ), equations (10), (12) and (14) deﬁned a ﬁxed point mapping in the
conditional choice probabilities:
                                                                                                           
                                
              σi (ai |s) = Γi     σa−i (a−i |s) [Πi (k, a−i , s; θ) − Πi (0, a−i , s; θ) , k = 1, . . . , K] .     (46)
                                   −i

For example, under the linear mean utility speciﬁcation (5), this system of ﬁxed point mappings in the choice
probabilities takes the form of
                                 ⎛                                                      ⎞
                                  
                 σi (ai |s) = Γi ⎝  σ−i (a−i |s)Φi (ai , a−i , s) θ, ai = 1, . . . , K ⎠ , i = 1, . . . , n.      (47)
                                        a−i


    In previous sections, we have assumed that either there is a unique solution to this system of ﬁxed


                                                               20
mapping with K × n equations and K × n unknown variables

                                      σi (ai |s) , ∀ai = 1, . . . , K, i = 1, . . . , n,

or that only one particular ﬁxed point of this system gets realized in the observed data. However, this
system of ﬁxed point mapping can potentially have multiple solutions, leading to the possibility of multiple
equilibria.
    In the following of this section, we will ﬁrst give a brief introduction to the use of homotopy methods
for ﬁnding multiple solutions to a system of nonlinear equations. We will then discuss how the homotopy
method can be used to compute multiple equilibria for our model of static interactions. In the next section,
we will describe an innovative estimation method that we develop for estimating the parameters in static
interaction models with multiple equilibria. While brief, this section is highly technical. Readers can proceed
to the application in section 7 after reading section 6.1.


6.1    The homotopy method
The homotopy continuation method (which will simply be referred to as the homotopy method in the rest of
the paper) is a well known generic algorithm for looking for a ﬁxed point to a system of nonlinear equations.
Based on the particular nonlinear system of equations to be solved, a well designed homotopy system is
capable of ﬁnding multiple solutions of the nonlinear system, and in some cases, all solutions to the system.
A concise and clear introduction to the homotopy method can be found in the book by Zangwill and Garcia
(1981). Algorithms for implementing the homotopy method can be found in several papers including Watson,
Billups, and Morgan (1987), Kostreva and Kinard (1991), ? and ?.
    Our goal is to ﬁnd, for all possible parameter values and realized state variables s, the solutions for the
ﬁxed point system (28):

                                                     σ − Γ (σ) = 0.

To simplify the notation, we suppress the fact that the choice probabilities depend on the state σ = σ (s).
    The basic idea behind the homotopy method is to take a system for which we know the solution and
map this system into the system that we are interested in. Under the right conditions, the solution to the
original system will also map into the solution that we are seeking. Formally, a homotopy is a linear mapping
between the two topological spaces of functions of the form

                             H (σ, τ ) = τ G (σ) + (1 − τ ) (σ − Γ (σ)) ,            τ ∈ [0, 1] ,               (48)

where each of H (σ, τ ) and G (σ) are vectors of functions with n × K component functions:

                    Hi,ai (σ, τ )   and Gi,ai (σ)       for i = 1, . . . , n and           ai = 1, . . . , K.

    H (σ, τ ) is the homotopy function and τ is the homotopy parameter. As one can see, for τ = 1 we get
H (σ, 0) = G (σ) and for τ = 0 we obtain H (σ, 0) = σ − Γ (σ) so varying τ from 1 to 0 maps the function
G (·) into the function Γ(·). The homotopy method suggests that we start with τ = 1 and choose G (σ) to


                                                             21
be a system for which it is very easy to obtain the solutions to G (σ) = 0. If for each 0 ≤ τ < 1, we can solve
for the nonlinear equations, H (σ, τ ) = 0, then by moving along the path in the direction of τ = 1 to τ = 0,
at the end of the path we should be able to reach a solution of the original nonlinear equations σ − Γ (σ) = 0.
This path then constructs a mapping between a solution of the initial system G (σ) = 0 and a solution to
the ﬁxed point problem of interest, σ − Γ (σ) = 0.
    In practice, algorithms for solving diﬀerential equations can be used to trace the path from τ = 1 to
τ = 0. At each τ , we denote the solution along a particular path by σ (τ ):

                                                   H (σ (τ ) , τ ) = 0.

By diﬀerentiating this homotopy function with respect to τ :
                                      d                   ∂H   ∂H ∂σ
                                        H (σ (τ ) , τ ) =    +   ·   = 0.
                                     dτ                   ∂τ   ∂σ ∂τ
This deﬁnes a system of diﬀerential equations for σ (τ ) with initial condition σ (1) calculated from the
solution of the (easy) initial system G (σ (1)) = 0. A number of computer algorithms are available to
compute numerical solutions of nonlinear systems of diﬀerential equations can then be used to trace this
diﬀerential equation system to reach an end point in the path of τ = 1 to τ = 0 in order to obtain a solution
σ (0) of the original system σ − Γ (σ) = 0.
    A regularity condition is necessary to insure the stability and the proper behavior of the homotopy
diﬀerential equation system.

Condition 1 (Regularity) Let ∇ (τ ) denote the Jacobian of the homotopy functions with respect to σ at
the solution path σ (τ ):
                                                                    !
                                                    ∂               !
                                        ∇ (τ ) =      Re{H (σ, τ )}!!        ,
                                                   ∂σ                 σ=σ(τ)

where Re{H (σ, τ )} denotes the real component of the homotopy functions. The jacobian ∇ (τ ) has full rank
for almost all τ .

    This condition ensures the smoothness and diﬀerentiability of the paths. It rules out cases of bifurcation,
branching and inﬁnite spiraling. The mapping between G (σ) and σ − Γ (σ) is called a conformal one if the
path that links them is free of these complications. If a homotopy system satisﬁes the regularity condition,
it will either reach a solution or drift oﬀ to inﬁnity.
    Obviously, in applied work where the system of diﬀerential equations above will be solved numerically, it
will be convenient to work with conformal mappings. A convenient way of generating a conformal mapping,
or a homotopy that satisﬁes the above regularity condition, is to extend the original homotopy into the
complex space. A homotopy, as deﬁned in equation (48) is extended to the complex space by permitting
the argument σ to take on complex values, which will result in complex values of the homotopy. When the
real and complex components of σ are considered two diﬀerent sets of arguments, and the real and complex
components of the output are considered two diﬀerent sets of components of the homotopy, this deﬁnes
a real valued homotopy with 2nK inputs and 2nK outputs. If the original homotopy (48) is an analytic

                                                           22
function in the complex space, then the Cauchy-Riemann conditions will ensure that the extended real-value
2nK × 2nK homotopy system satisﬁes the regularity condition above.
       The all solution homotopy is one where the initial system G (σ) is chosen such that, if we follow the paths
originating from each of the solutions to G (σ) = 0, we will reach all solutions of the original system σ = Γ (σ)
at the end of the path. The extension of a real homotopy system into the complex space is essential to the
idea of all-solution homotopy. It is related with the property of the complex space that conformal mappings
                                                                                3
in the complex space do not change the algebraic properties of the sets.            The concept of conformal mapping
is widely used in complex analysis. It implies that we can conformally map a function with a complicated
set of roots to another function with a simple set of roots, then the results from an analysis of the function
with the simple set of roots should apply to the function with the complicate set of roots. An all solution
homotopy has to satisfy an additional path ﬁniteness condition:

Condition 2 (Path Finiteness) Define H −1 (τ ) to be the set of solutions σ (τ ) to the homotopy system
at τ . H −1 (τ ) is bounded for all 0 ≤ τ < 1. In other words, for all τ > 0.

                                                   lim H (σ, τ ) = 0.
                                                ||σ||→∞


6.2       Multiple equilibria in static discrete games
As we noted in the previous section, the issue of multiple equilibria in static interaction models amounts
to the issue of computing all the ﬁxed points to the system of equations of choice probabilities deﬁned in
equation (46). Note that the argument to the mapping from expected utility to choice probabilities, Γ (·),
is linear in the choice probabilities of competing agents σ−i (a−i |s). Therefore, the question of possible
multiplicity of equilibria depends crucially on the functional form of Γ, which in turn depends exclusively on
the assumed joint distribution of the error terms.
       Interestingly, if we are content with the linear probability model where Γ is a linear function of the
individual choice probabilities, and the model has only two agents, then the equilibrium will be guaranteed
to be unique and the issue of multiple equilibria is not relevant. Γ is a linear function of the individual
choice probabilities if the underlying utility functions depend linearly on the indicator function of whether
individual competitors make a particular choice or not. For example, this would be the case if the proﬁt
from entering a market depends on the total number of competitors who also enter the market. On the
other hand, if we have nonlinear interactions of the individual choice probabilities in the linear probability
model, or if the joint distribution of the error term in the multinomial choice model is speciﬁed such that Γi
is a polynomial function for each i = 1, . . . , n, then all the equilibria can be found by choosing a homotopy
system where the initial system of equations

                                  Gi,ai (σ) ,   i = 1, . . . , n and ai = 1, . . . , K.
   3
       The conformal mapping is a mapping in the complex space that does not locally change the argument of a
complex number. It is known that if the function is analytic and does not have stationary points then the associated
mapping is conformal.



                                                           23
takes the following simple polynomial form:

                                        qi,ai
                   Gi,ai (σ) = σi (ai )         − 1 = 0 for           i = 1, . . . , n and ai = 1, . . . , K,   (49)

where qi,ai is an integer that exceeds the degree of the polynomial of Γi,ai as a function of σ−i (a−i ). This
results in a homotopy mapping

                                                qi,ai
                   Hi,ai (σ, τ ) = τ {σi (ai )          − 1} + (1 − τ ) (σi (ai ) − Γi,ai (σ)) , τ ∈ [0, 1].    (50)

For τ = 0 the system (48) coincides with the original system while for τ = 1 it is equal to the ’simple’ system
(49).
    It is a well known result from complex analysis that there are exactly qi,ai complex roots to Gi,ai (σ) that
are evenly distributed on the unit circle. It is known that nondegenerate polynomial functions are analytic
and the regularity condition of the resulting homotopy system is automatically satisﬁed. The particular
choice of qi,ai also ensures the path ﬁniteness property of the homotopy system (c.f. Zangwill and Garcia
(1981)).
    While a polynomial model for Γ (·) is convenient for calculating multiple equilibria, it is rarely used in
applied problems because it is not clear what parametric utility speciﬁcation will give rise to a polynomial
choice probability function. The most popular multinomial choice probability function is probably the
multinomial logit, which follows from the assumption of i.i.d. extreme value distributions in the unobserved
component of the latent utilities. The logit choice model is given in (25). Our analysis in the following will
consist of three steps. First we will establish that this model has a ﬁnite number of equilibria represented
by real solutions to (25). Second, we will show that by letting the degree of the initial polynomial system
increase to inﬁnity at an appropriate rate, we will be able to ﬁnd all the equilibria for the multinomial logit
choice model (25) using the homotopy method. We prove it by ﬁrst verifying that the homotopy mapping
is regular in the complex space when the discontinuity points of the original function are isolated, and then
providing a method to make homotopy work in the small vicinity of discontinuity points.
    It is not diﬃcult to show that the ﬁxed point system (25) has a ﬁnite number of solutions in the real
line. To see this, note that in general, this function is clearly continuous and inﬁnitely diﬀerentiable with
nonsingular derivatives. In particular, it is easy to verify this condition for the multinomial logit and probit
models that are commonly used in practice. Consider a compact ball BR in RnK with radius larger than
1. By Sard’s theorem the set of irregular values of Γ (·) has measure zero. In particular, it can be veriﬁed
by diﬀerentiation through the implicit function theorem that zero is its regular value. This implies that the
submanifold of σ satisfying σ = Γ (σ) is compact as a closed subset of this ball BR . Thus it contains a
ﬁnite number of points. This veriﬁes that the set of solutions in BR in ﬁnite. It is also obvious that all the
solutions must satisfy 0 ≤ σi (ai ) ≤ 1 because of the choice probability functional form. Therefore there can
not be solutions outside BR .
    While we have just shown that there are in general a ﬁnite number of multiple equilibria, to compute
these equilibria we need to make use of an all solution homotopy system. In particular, we choose to use the
all solution homotopy deﬁned in (50). In the following we will show that there exists a homotopy system
of the form of (50) with a suﬃciently high orders of the initial system qi,ai ’s, such that we will ﬁnd all the


                                                                 24
solution to the original system of choice probabilities. As described in the previous subsection, verifying
the validity of the all solution homotopy requires checking the regularity condition and the path ﬁniteness
condition, which in terms require extension of the real homotopy system into the complex space. Verifying
these conditions require us to specify the particular functional form of the joint distribution of the error
terms in the latent utilities. In the following we will focus on the multinomial logit case which is the most
widely used discrete choice model in the empirical literature.
    The following Theorem 2 and Theorem 3 formally state this result. In the statement of the theorems,
σ = {σr , σi } denotes more generally a vector of the real part and the imaginary part of complex numbers
which extend the real choice probabilities we considered early into the complex space. Theorem 2 ﬁrst
establishes the regularity properties of the homotopy outside the imaginary subspace.

Theorem 2 Define the sets H −1 = {(σr , σi , τ ) | H(σr , σi , τ ) = 0} and

                   H −1 (τ ) = {(σr , σi ) | H(σ, τ ) = 0}    for   σr ∈ RnK ,   and   σi ∈ RnK .

Note that H is a homotopy of dimension R2nK that include both real and imaginary parts separately. Also
define, for any small , ℘ = ∪i,ai {|σr,i,ai | ≤ } to be the area around the imaginary axis. Then:

1) The set H −1 ∩ {R2nK \ ℘ × [0, 1]} consists of closed disjoint paths.

2) For any τ ∈ (0, 1] there exists a bounded set such that H −1 (τ ) ∩ R2nK \ ℘ is in that set.

3) For (σr , σi , τ ) ∈ H −1 ∩{R2nK \℘ ×[0, 1]} the homotopy system allows parametrization H(σr (s), σi (s), τ (s)) =
      0. Moreover, τ (s) is a monotone function.

Remark: Theorem 2 establishes the regularity and path ﬁniteness conditions for the homotopy (50) for
the multinomial logit model in areas that are not close to the pure imaginary subspace in the complex
domain CnK . The homotopy system can become irregular along the pure imaginary subspace, because the
denominator in the system can approach zero and the system will become nonanalytic in the case. However,
the next theorem shows that there exists a sequence q such that homotopies with initial system of order q
will have paths that stay away from the imaginary subspace. Homotopies with these orders will be able to
trace out all the solutions of the original multinomial logit system.

Theorem 3 For given τ one can pick the power qi,ai of the initial function (49) such that the homotopy
system is regular and path finite given some sequence of converging polyhedra ℘ ,  → 0.

    Theorem 3 implies that if we continue to increase the power qi,ai of the initial system (49) of the
homotopy, we will eventually be able to ﬁnd all the solutions to the original multinomial logit system. This
also implies, however, we might lose solutions when we continue to increase qi,ai . But Theorem 3 does
imply that for suﬃciently large qi,ai , no new solutions will be added for larger powers. In the monte carlo
simulation that we will report in the next section, we do ﬁnd this to be the case.




                                                             25
6.3    Monte Carlo Analysis
We perform several Monte-Carlo simulations for an entry game with a small number of potential entrants.
Player’s payoﬀ functions for each player i were constructed as linear functions of the indicator of the rival’s
entry (ai = 1), market covariates and a random term:
                                           ⎛           ⎞
                                            
               Ui (ai = 1, a−i ) = θ1 − θ2 ⎝  1(aj = 1)⎠ + θ3 x1 + θ4 x2 + i (a), i = 1, . . . , n.          (51)
                                              j=i


The payoﬀ of staying out is equal to Ui (ai = 0, a−i ) = i (a), where the i (a) have i.i.d extreme value
distributions across both a and i. The coeﬃcients in the model are interpreted as: θ1 is the ﬁxed beneﬁt of
entry, θ2 is the loss of utility when one other player enters, θ3 , θ4 are the sensitivities of the beneﬁt of entry
to market covariates.
    The game can be solved to obtain ex-ante probabilities of entry in the market. The solution to this
problem is given by:                            
                                        eθ1 −θ2 (    j=i   Pj )+θ3 x1 +θ4 x2
                               Pi =                                                , i = 1, . . . , n.       (52)
                                      1 + eθ1 −θ2 (      j=i   Pj )+θ3 x1 +θ4 x2

Here Pi is the ex-ante probability of entry for the player i, Pi = p (ai = 1|x). Both coeﬃcients of the model
and market covariates were taken from independent Monte-Carlo draws. The parameters of generated
random variables are presented in Table 6.1. The means and variances of parameter values and market
covariates were chosen so to have a fair percentage of cases with more then one equilibrium. For the games
with 3,4 and 5 players 400 independent parameter combinations for every player were taken. The modiﬁcation
of the HOMPACK algorithm was run to solve for all equilibria in each game.
    Throughout the Monte-Carlo runs both coeﬃcients and covariates x1 and x2 were changing. So, every
equilibrium was calculated for a speciﬁc set of parameters. Summary statistics for the results of computations
are presented in Table 6.1. It is possible to see from Table 6.1 that in the constructed games the players
have approximately same average parameters in every type of game. This agrees with the symmetric form
of underlying data generating process for the coeﬃcients and market covariates.
    Table 6.2 and 6.3 tabulate the frequencies of diﬀerent number of equilibria that are being observed in the
simulations, classiﬁed according to the number of players in the market. Interestingly, a dominant number
of simulations have only a single equilibrium. In addition, the frequency of observing multiple equilibria
seems to decrease with the number of players in the market. In other words, we observe a large number of
multiple equilibria in the two player case but only observe a handful of them in the ﬁve player case.
    Table 6.4 tabulates the probability of entry of the ﬁrst player classiﬁed by the number of equilibria
and the number of players in the market. In general, what we see from this table is that there is no clear
correlation pattern between the entry probability and the numbers of equilibria and players in the market.




                                                                  26
7        Application to stock market analysts’ recommendations and
         peer eﬀects
Next, we discuss an application of our estimators to the problem of analyzing the behavior of equity market
analysts and the stock recommendations that they issue (e.g. strong buy, buy, hold sell). There is a fairly
sizeable empirical literature on this topic. However, the literature does not allow for strategic interactions
between analysts. We believe that this is a very strong assumption. Accurate forecasts and recommendations
are highly valued, of course. But the penalty for issuing a poor recommendation depends on whether
competitor analysts also made the same poor recommendation. Therefore, the utility an analyst receives
from issuing a recommendation is a function of the recommendations issued by other analysts. Therefore,
we apply the framework discussed in the previous sections to allow payoﬀs to be interdependent.
        There has been a revival of interest on the determinants of analyst recommendations as researchers
have tried to explain the remarkable behavior of the analysts in the run-up and subsequent collapse of the
                       4
NASDAQ in 2000.            The focus in this paper is on the recommendations generated for ﬁrms in the high tech
sector, which includes the ﬁrms most aﬀected by the excitement surrounding the development of e-commerce
and the spread of the Internet. Given the great uncertainty surrounding the demand for new products and
new business models, the late 1990’s would seem to have been the perfect environment for equity analysts to
add value. Yet analyst recommendations were not particularly helpful or proﬁtable during this period. For
example, the analysts were extremely slow to downgrade stocks, even as it was apparent that the market
had substantially revised its expectations about the technology sector’s earnings potential. Barber, Lehavey,
McNichols, and Trueman (2003) show that the least recommended stocks earned an average abnormal return
of 13% in 2000-2001, while the most highly recommended stocks earned average abnormal returns of -7%.
Observations like this have led commentators to wonder whether the analysts had ulterior motives for keeping
their recommendations unjustiﬁably optimistic, such as the pressure to win investment banking business.
Allegedly, this conﬂict of interest took the form of analysts keeping recommendations on stocks high in order
to appease ﬁrms, who would then reward the analyst’s company by granting it underwriting business or
other investment advisory fees.5 Indeed, these suspicions came to a head when New York State Attorney
General Elliot Spitzer launched an investigation into conﬂicts of interest in the securities research business.
        In this application we develop an empirical model of the recommendations generated by stock analysts
from the framework outlined in section 1. We quantify the relative importance of four factors inﬂuencing
the production of recommendations in a sample of high technology stocks during the time period between
1998 and 2003.
    4
        See for example Barber, Lehavey, McNichols, and Trueman (2003) and Chan, Karceski, and Lakonishok (2003).
Research prior to the NASDAQ collapse includes Womack (1996), Lin and McNichols (1998), and Michaely and
Womack (1999).
  5
    In 1998, Goldman Sachs estimated that Jack Grubman, a prominent telecommunications industry analyst, would
bring in $100 to $150 million in investment banking fees. This estimate was based on the fees generated by 32 of
the stocks he covered that also had banking relationships with Citigroup, including WorldCom, Global Crossing and
Winstar Communications. (Wall Street Journal, October 11, 2002).




                                                         27
       First, recommendations must depend on expectations about the future proﬁtability of a ﬁrm. There
should be some systematic component to these expectations common across all analysts and investors that
will be embedded in the current stock price.
       Second, analysts are heterogeneous, both in terms of talent and perhaps in terms of access to information.
We try to capture an individual analyst’s private belief about the stock by looking at the diﬀerence between
the quarterly earnings forecast submitted by the analyst (or the analyst’s brokerage ﬁrm) and the distribution
of forecasts from other ﬁrms.
       Mindful of the large number of inquiries into possible conﬂicts of interest among research analysts, we
include as a third factor a dummy variable for an investment banking relationship between the ﬁrm and the
analyst’s employer.
       Finally, we consider the inﬂuence of peers on the recommendation decision. Peer eﬀects can impact the
recommendation in diﬀerent ways. Individual analysts have incentive to condition their recommendation
on the recommendations of their peers, because even if their recommendations turn out to be unproﬁtable
ex-post, performance evaluation is typically a comparison against the performance of peers. More subtly,
recommendations are relative rankings of ﬁrms and are not easily quantiﬁable (or veriﬁable) objects. As such,
ratings scales usually reﬂect conventions and norms. The phenomenon is similar to the college professor’s
problem of assigning grades. If a professor were to award the average student with a C while other faculty give
a B+ to the average student, the professor might incorrectly signal his views of student performance. Even
while there is heterogeneity in how individual professors feel about grading, most conform to norms if only
to communicate clearly with students (and their potential employers) about their performance. Similarly,
analysts have an incentive to benchmark their recommendations against perceived industry norms.


7.1       Data
Our data consist of the set of recommendations on ﬁrms that made up the NASDAQ 100 index as of
year-end 2001. The recommendations were collected from Thomson Firstcall. Firstcall is one of the most
comprehensive historical data sources for analysts’ recommendations and earnings forecasts, containing real-
time recommendations and forecasts from hundreds of analysts. It is common for analysts to rate ﬁrms on
a 5 point scale, with 1 denoting the best recommendation and 5 denoting the worst. When this is not the
case, Firstcall converts the recommendations to the 5 point scale (see Table 7.1).
       We have 12,719 recommendations from analysts at 185 brokerage ﬁrms over this time period (see Table
7.2). The dependent variable in our data set is a recommendation submitted between January of 1998
and June of 2003 for a ﬁrm in the NASDAQ 100. The data set was formed by merging the earnings and
recommendations ﬁles from Firstcall. In a given quarter, for a given stock, we merge a quarterly earnings
forecast with a recommendation from the same brokerage.6 This will allow us to determine if analysts that
are more optimistic than the consensus tend to give higher recommendations. In the Firstcall data, quarterly
earnings forecasts are frequently made more than a year in advance. In order to have a consistent time frame,
   6
       When there were multiple recommendations by the same analyst within a quarter, we chose to use the last
recommendation in the results that we report.




                                                        28
we limit analysis to forecasts that were made within the quarter that the forecast applies.7 Note that not
every recommendation can be paired with an earnings forecast made within the contemporaneous quarter.
Recommendations that could not be paired with an earnings forecast were dropped from the results that
we report. However, qualitatively similar results were found for a data set where this censoring was not
performed. We choose not to report these results in the interests of brevity. The variables in our data
include:

       • REC- Recommendation from 1-5 for a stock listed in the NASDAQ 100 recorded by I/B/E/S.

       • QUARTER- Quarter during which the recommendation was submitted.

       • STOCK-Name of the stock for which the recommendation applies.

       • BROKERAGE-The brokerage employing the analyst.

       • EPS-Earnings per share forecast submitted by the analyst’s brokerage associated with the recommen-
         dation. Submitted during the same quarter as the recommendation.

       • AEPS-Average of the earnings per share forecasts submitted for that quarter.

       • %DEV-(EPS-APS)/APS, the percent deviation of an individual broker’s earnings forecast from the
         average earning’s forecast.

       • RELATION-A dummy variable that is one if the analyst’s brokerage engages in investment banking
         business with the company to which the recommendation applies.

       • IBANK-A dummy variable that is equal to one if the brokerage does any investment banking business
         with stocks in the NASDAQ 100.

       The investment banking relationship was identiﬁed from several diﬀerent sources. First, we checked form
424 ﬁlings in the SEC’s database for information on the lead underwriters and syndicate members of debt
issues. When available, we used SEC form S-1 for information on ﬁnancial advisors in mergers. We also
gathered information on underwriters of seasoned equity issues from Securities Data Corporation’s Platinum
database. To be sure, transaction advisory services (mergers), and debt and equity issuance are not the only
services that investment banks provide. However, these sources contribute the most to total proﬁtability of
the investment banking side of a brokerage ﬁrm.
       The average recommendation in our data set is 2.2, which is approximately a buy recommendation (see
Table 7.2). The mean value of RELATION is 0.035. The mean value of IBANK is 0.81. That is, 3.5 percent of
the analyst-company pairs in our data set were identiﬁed as having a potential conﬂict of interest due to some
kind of investment banking activity for the stock in question. Eighty-one percent of the recommendations
in our data were generated by ﬁrms engaging in investment banking with some ﬁrm list in the NASDAQ
100. Both of these variables are potentially useful measures of potential conﬂict of interest. The variable
   7
       We chose to merge the brokerage ﬁeld, instead of the analysts ﬁeld, because the names and codes in the analysts
ﬁeld were not recorded consistently across IBES data sets for recommendations. It was possible to merge at the level
of the brokerage.


                                                           29
RELATION is more direct, since it indicates that the brokerage is engaged in investment banking with the
company during the quarter the recommendation was issued. However, brokerages might view any company
it is giving a recommendation to as a potential client, particularly in the NASDAQ 100, where many of the
companies generated considerable investment banking fees.
    The variable earnings was formed by merging the recommendations and earnings ﬁles in Firstcall. In a
given quarter, for a given stock, we merge the quarterly earnings forecast with the recommendation from the
same brokerage. This allows us to determine if analysts that are more or less optimistic than the consensus
tend to give higher recommendations. In the Firstcall data, quarterly earnings forecasts are frequently made
more than a year in advance. In order to have a consistent time frame, we limit analysis to forecasts that
were made within the quarter for which the forecast applies. We chose to merge the brokerage ﬁeld, instead
of the analysts ﬁeld, because the names and codes in the analysts ﬁeld were not recorded consistently across
Firstcall data sets for recommendations. It was possible to merge at the level of the brokerage. Note that
not every recommendation can be paired with an earnings forecast made in the contemporaneous quarter.


7.2    Empirical model
An observation is a recommendation submitted for a particular stock during a speciﬁc quarter. We will
let t = 1, ..., T denote a quarter, s = 1, ..., S a stock and and i = 1, ..., I an analyst. We will denote a
particular recommendation by ri,s,t. The recommendation can take on integer values between 1 and 5, where
1 is the highest recommendation and 5 the lowest. Since the dependent variable can be naturally ranked
from highest to lowest, we will assume that the utilities come from an ordered logit. Let x(i, s, t) denote a
set of covariates that inﬂuence the recommendation for analyst i for stock s during quarter t. Let x(s, t)
denote a vector of (x(i, s, t)) of payoﬀ relevant covariates that enter into the utility of all the analysts who
submit a recommendation for stock s during quarter q. Let z(s, t) denote a set of covariates that shift the
equilibrium, but which do not inﬂuence payoﬀs.
    Deﬁne the utility or payoﬀ to analyst i for a recommendation on stock s in quarter t to be,


                               yi,s,t = β  x(i, s, t) + ηE(r|x(s, t), z(s, t)) + εi,s,t                   (53)


In equation (53), the term E(r|x(s, t), z(s, t)) is the expected recommendation for stock s during quarter t
and εi,s,t is an error term drawn from an extreme value model. Thus, conforming to the expected actions
of peers enters into an individual analyst’s utility. The model would is the familiar ordered logit, where the
probability that a particular recommendation is observed is determined as follows:




                                                          30
                         P (r = 1) = Φ(−β  x(i, s, t) − ηE(r|x(s, t), z(s, t)))                        (54)
                         P (r = 2) = Φ(μ1 − β  x(i, s, t) − ηE(r|x(s, t), z(s, t)))                    (55)
                                       
                              − Φ(−β x(i, s, t) − ηE(r|x(s, t), z(s, t)))                               (56)
                                                 
                         P (r = 3) = Φ(μ2 − β x(i, s, t) − ηE(r|x(s, t), z(s, t)))                      (57)
                              − Φ(μ1 − β  x(i, s, t) − ηE(r|x(s, t), z(s, t)))                         (58)
                                                 
                         P (r = 4) = Φ(μ3 − β x(i, s, t) − ηE(r|x(s, t), z(s, t)))                      (59)
                              − Φ(μ2 − β  x(i, s, t) − ηE(r|x(s, t), z(s, t)))                         (60)
                         P (r = 5) = 1 − Φ(μ3 − β  x(i, s, t) − ηE(r|x(s, t), z(s, t)))                (61)



In equations (53)-(61), the likelihood that determines the probability that the recommendation is r depends
on the latent estimated covariates β and η along with the cut points μ1 − μ3 .
   The analysis of the previous section suggests that identiﬁcation depends crucially on having appropriate
exclusion restrictions. First, we need covariates that inﬂuence the payoﬀs of one particular agent, but not
other agents. In our analysis, the covariates will include IBANK and RELATION. This assumption would
imply, for instance, that the amount of investment banking done by Merrill Lynch should not directly
inﬂuence the recommendations submitted by analysts working for Goldman Sachs. We believe that this is a
reasonable assumption.
   In addition, we have attempted to control for unobserved heterogeneity in several ways. First, in many
speciﬁcations, we include a full set of stock and quarter ﬁxed eﬀects to control for factors that remain ﬁxed
in a quarter that inﬂuence recommendations. Second, we have controlled for unobserved heterogeneity using
both a ﬁxed eﬀects and random eﬀects speciﬁcation. Equations (53)-(61) imply that the probability of 1 or
a recommendation between 2 and 5 is a binary logit. This implies that we can estimate our model using a
ﬁxed eﬀect logit speciﬁcation. We choose to present a random eﬀect logit speciﬁcation since almost all of
the coeﬃcient estimates in the ﬁxed eﬀects logit model were insigniﬁcant. Given the number of observations
in our data, we believe that the ﬁxed eﬀect logit model is too diﬀusely speciﬁed. We therefore use random
eﬀects instead.


7.3     Results

7.3.1    Fundamentals

The ﬁrst question that we ask is the extent to which recommendations were determined by publicly observable
information about the stocks. In our data, these fundamentals correspond to time ﬁxed eﬀects, stock ﬁxed
eﬀects and the diﬀerence between an individual analyst’s beliefs about earnings and beliefs in the market as
whole. In Table 7.4, we run an ordered logit to explore these questions. The variable %DEV is the percentage
deviation of an analyst’s recommendation from the average recommendation and ABS. DEV is the algebraic
diﬀerence. In both cases, a more optimistic earnings forecast has the anticipated sign, but is not signiﬁcant


                                                       31
at conventional levels in any of the speciﬁcations that we have tried. On the other hand, quarterly and stock
ﬁxed eﬀects are almost all statistically signiﬁcant (not reported in this Table). If quarter and stock ﬁxed
eﬀects proxy for publicly available information about the stock, then this information is considerably more
important than measures of an individual analyst’s optimism. We note, however, that there could be other
interpretations of these variables.
    In Table 7.5, we report the estimated quarterly ﬁxed eﬀects and compare these estimates to the NASDAQ
Index and NASDAQ 100. The quarterly eﬀects are labeled qdum2-qdum22 for the 2nd quarter (1998.Q2)
through the 22nd quarter (2003.Q2) of our data set. Several points emerge. First, the quarterly eﬀects
are typically signiﬁcant. Second, the quarterly eﬀects are highly correlated with the NASDAQ index and
with the QQQ. We take these results as evidence that the quarterly eﬀects can reasonably be interpreted
as reﬂecting publicly observed information about the the ﬁrms that is embedded in the share prices as
opposed to some other latent eﬀects. The movement in share prices can explain most of the movement in the
recommendations in the previous tables. In Table 7.6, we regress the quarterly dummies on these indexes.
We ﬁnd that the indexes are statistically signiﬁcant at conventional levels and that the measures of goodness
of ﬁt are quite high.


7.3.2    Conﬂicts of Interest

In Table 7.7 we run an ordered logit model of recommendations as a function of our conﬂict of interest
measures. The coeﬃcient on RELATION indicates that potential conﬂicts of interest are statistically signif-
icant at conventional levels, except for the third column where quarterly and stock ﬁxed eﬀects are included,
and the fourth column where the full set of ﬁxed eﬀects are included along with the more inclusive IBANK
variable. The coeﬃcient sign on RELATION is also consistent with our a priori beliefs that conﬂicts of in-
terest could lead to issuing more favorable recommendations. Consistent with the work of prior researchers
and market regulators, these results do suggest that a potential conﬂict of interest exists when a brokerage
engaged in investment banking business with a company that quarter. However, these results must be in-
terpreted with some caution. Since brokerage ﬁrms are expected to cover companies with whom they have
signiﬁcant investment banking business, the ﬁrms have an incentive to select brokerages that already view
them favorably. It would be hard to imagine that a rational manager would want to hire an investment
banking ﬁrm that views her company in an unfavorable manner.
    Interestingly, we note (column 4 of table 7.7) that when we include the IBANK variable denoting that
the brokerage ﬁrm has investment banking relationships with at least one ﬁrm in the index, the coeﬃcient is
positive and signiﬁcant. Evidently, analysts at general investment banking ﬁrm tend to issue slightly more
conservative recommendations. This is consistent with a view of the world that companies tended to select
investment banking ﬁrms that were more favorably disposed towards them. Alternatively, our results could
be interpreted as suﬀering from a bias due to some omitted variable.
    Our results suggest that even though investment banking relationships may generate potential conﬂicts
of interest for equity analysts, the magnitude of the eﬀects recommendations may be small in practice. No-
tice that measures of the goodness of ﬁt are very low when only investment banking is included. Also, the
marginal eﬀects of engaging in investment banking are small. In our data, the expected recommendation


                                                     32
is -0.08 when we allow for quarterly ﬁxed eﬀects, but not stock ﬁxed eﬀects. This ﬁnding is not consistent
with the prosecutors belief that “unbiased” research, separate from investment banking, will generate rec-
ommendations less tainted by potential conﬂicts of interest. However, the behavior of analysts after large
settlements have been paid and signiﬁcant damage has been done to their brokerage’s reputation, in some
cases, may be more conservative.


7.3.3    Peer Eﬀects

The ﬁnal question we consider is whether there are peer eﬀects in submitting recommendations. We do
this in Tables 7.8-7.10 by using the two stage procedure described in the previous sections. We regress the
recommendations on a broker ﬁxed eﬀect, a full set of stock and quarterly dummies, IBANK, RELATION,
and %DEV. In Table 7.8, the regressions are done using linear regression while in the later tables we use
a 3rd order spline. We will let IVBELIEF denote the expected average recommendation, excluding broker
i. If the coeﬃcient on IVBELIEF is positive, this means that broker i has an incentive to conform to the
recommendations of other brokers. If it is negative, it means there is a return from submitting a dissenting
recommendation.
    In all of the speciﬁcations that we examine in Table 7.8, peer eﬀects seem to be important. An individual
analyst will raise his recommendation proportionally to the recommendation that he expects from other
analysts. This is intuitive. A given recommendation does not make senses in isolation, but only relative to
the recommendations of other analysts. If no one else in the market is issuing recommendations of “market
underperform” or “sell”, an individual analysts may give the wrong signal by issuing such a recommendation
even if he believes the recommendation is literally true. It is worth noting that the results for our measure of
peer eﬀects are not only statistically signiﬁcant, but peer eﬀects also explain the results quite well compared
to the other covariates. The Pseudo-R2 suggests that quarterly dummies, stock dummies and IVBELIEF
explain most of the variation in the data. We note that the presence of the peer eﬀect is robust to allowing
for a more ﬂexible ﬁrst stage (see Table 7.9). Also, the peer eﬀect remains signiﬁcant allowing for unobserved
heterogeneity in the form of a stock/quarter speciﬁc random eﬀect in Table 7.10.
    With estimates of the model’s key parameters in hand, it is possible to simulate the model and ﬁnd the
set of equilibria to the analyst recommendation game. In keeping with the static nature of our analysis, we
solve for all possible equilibria at two points in time: the ﬁrst just prior to the regulatory regime change in
2000.Q1, and then again in 2003.Q1 after the Spitzer inquiry was well-underway. These results are based
on assuming that there are two analysts making a recommendation and that the recommendations are
determined as in (53)-(61). All of the variables are set to their sample averages for 2000.Q1 and 2003.Q1
respectively. The parameter values were set equal to the estimates in the last column of Table 7.8. Since we
are interested in the eﬀect of investment banking on recommendations, we consider two cases: one is when
IBANK is 0 for both players and the other when it is 1 for both players.
    Evidently, the pre-Spitzer era was characterized by two diﬀerent equilibria (see Table 7.11). These
equilbrium diﬀer by a roughly uniform, upward shift in the overall recommendation. This is consistent with
our story that there is the possibility of multiple equilibrium in our model, one of which has “grade inﬂation”.
In the post-Spitzer era, there was only one equilibrium. Overall, recommendations fall compared to either


                                                      33
equilibrium in the pre-Spitzer era. This can be attributed, in large part, to the poor environment for high
technology stocks during this period.
     We note that the average recommendation tends to fall when the ﬁrms engage in investment banking
business. This is because the coeﬃcient on IBANK is positive in our estimates. Our model suggests that,
contrary to the allegations made by the prosecutor and in the press, on average, engaging in investment
banking does not tend to generate higher recommendations on average.


8      Conclusion
In this paper we propose a method for estimating static games of incomplete information. The method
we propose is semiparametric and does not require the covariates to lie in a discrete set. Perhaps most
importantly, the method is both ﬂexible and easy to implement using standard statistical packages. We also
introduce an algorithm for computing all equilibria to a game, which is useful for policy simulations using
the estimated model.
     We apply these methods to the problem of determining the factors that govern the assignment of stock
recommendations by equity analysts for a set of high tech stocks between 1998 and 2003. Two factors seem
to be most important for explaining the production of stock recommendations. First, publicly observable
information about the stocks under recommendation, as reﬂected in our time and quarter dummies, plays
a large role in explaining the distribution of recommendations. As we saw in Table 7.3, these variables
explained a large fraction of the variation in the data and were highly correlated with market indexes such
as the NASDAQ or QQQ. Simply put, recommendations improved in 1999-2000 as the stock market rose.
The second and most important factor for explaining recommendations is the peer group eﬀect. Individual
analysts raise their recommendations proportionally to the recommendations they expect from their peers.
Investment banking relationships are shown to be statistically signiﬁcant in the recommendations regressions,
but the economic eﬀect of the investment banking relationship is estimated to be small, and the variable
does not add much to the total ﬁt of the model.




References
Aguirregabiria, V., and P. Mira (2002): “Sequential simulation-based estimation of dynamic discrete
    games,” Technical Report, Boston University.

Ai, C., and X. Chen (2003): “Eﬃcient Estimation of Models with Conditional Moment Restrictions
    Containing Unknown Functions,” Econometrica, 71(6), 1795–1843.

Allgower, E. L., and K. Georg (1980): Numerical Continuation Methods. An Introduction. Springer-
    Verlag.

Aradillas-Lopez, A. (2005): “Semiparametric Estimation of a Simultaneous Game with Incomplete In-
    formation,” working paper, University of California, Berkeley.

                                                      34
Augereau, A., S. Greenstein, and M. Rysman (2005): “Coordination vs. diﬀerentiation in a standards
  war: 56K modems,” working paper, Boston University.

Bajari, P., L. Benkard, and J. Levin (2004): “Estimating Dynamic Models of Imperfect Competition,”
  working paper.

Bajari, P., and H. Hong (2004): “Semiparametric Estimation of a Dynamic Game of Incomplete Infor-
  mation,” working paper, University of Michigan.

Bajari, P., H. Hong, and S. Ryan (2004): “Identiﬁcation and Estimation of Discrete Games of Complete
  Information,” Working paper, Department of Economics, Duke University.

Barber, B., R. Lehavey, M. McNichols, and B. Trueman (2003): “Reassessing the Returns To
  Analysts’ Stock Recommendations,” Financial Analysts Journal.

Berry, S. (1992): “Estimation of a model of entry in the airline industry,” Econometrica, 60(4), 889–917.

Berry, S., A. Pakes, and M. Ostrovsky (2003): “Simple estimators for the parameters of dynamic
  games (with entry/exit examples),” Technical Report, Harvard University.

Bjorn, P. A., and Q. Vuong (1984): “Simultaneous Equations Models for Dummy Endogenous Variables:
  A Game Theoretic Formulation with an Application to Labor Force Participation,” SSWP No. 537,
  Caltech.

Bresnahan, T., and P. Reiss (1991a): “Empirical Models of Discrete Games,” Journal of Econometrics,
  48, 57—81.

         (1991b): “Entry and competition in concentrated markets,” Journal of Political Economy, 99,
  977–1009.

         (1991c): “Entry and competition in concentrated markets,” Journal of Political Economy, 99,
  977–1009.

Brock, W., and S. Durlauf (2001): “Discrete Choice with Social Interactions,” Review of Economic
  Studies, 68, 235–260.

Chamberlain, G. (1984): “Panel Data,” in Handbook of Econometrics, Vol. 2, ed. by Z. Griliches, and
  M. Intriligator. North Holland.

Chan, L., J. Karceski, and J. Lakonishok (2003): “Analysts’ Conﬂict of Interest and Biases in Earnings
  Forecasts,” University of Illinois Working Paper.

Ciliberto, F., and E. Tamer (2003): “Market Structure and Multiple Equilibria in Airline Markets,”
  North Carolina State University and Princeton University.




                                                      35
Haile, P., A. Hortacsu, and G. Kosenok (2003): “On the Empirical Content of Quantal Response
  Equilibrium,” working paper, Yale University.

Ho, K. E. (2005): “Insurer-Provider Networks in the Medical Care Market,” working paper, Columbia
  University.

Hotz, J., and R. Miller (1993): “Conditional Choice Probabilties and the Estimation of Dynamic Mod-
  els,” Review of Economic Studies, 60, 497–529.

Ishii, J. (2005): “Interconnection Pricing, Compatibility, and Investment in Network Industries: ATM
  Networks in the Banking Industry,” working paper, Stanford University.

Kostreva, M. M., and L. A. Kinard (1991): “A diﬀerential homotopy approach for solving polynomial
  optimization problems and noncoorperative games,” Computers and Mathematics with Applications, 21,
  135–143.

Lin, H., and M. McNichols (1998): “Underwriting Relationships, Analysts’ Earnings Forecasts, and
  Investment Recommendations,” Journal of Accounting Economics, 25, 1–34.

Manski, C. F. (1987): “Semiparametric Analysis of Random Eﬀect Linear Models from Binary Panel
  Data,” Econometrica, 55(2), 357–362.

Manuszak, M., and A. Cohen (2004): “Endogenous Market Structure with Discrete Product Diﬀerentia-
  tion and Multiple Equilibria: An Empirical Analysis of Competition Between Banks and Thrifts,” working
  paper.

McKelvey, R., and T. Palfrey (1995): “Quantal Response Equilibria for Normal Form Games,” Games
  and Economic Behavior, 10(1), 6–38.

Michaely, R., and K. Womack (1999): “Conﬂict of Interest and Credibility of Underwriter Analyst
  Recommendations,” Review of Financial Studies, 12, 653–686.

Newey, W. (1990): “Semiparametric Eﬃciency Bounds,” Journal of Applied Econometrics, 5(2), 99–135.

           (1994): “The Asymptotic Variance of Semiparametric Estimators,” Econometrica, 62, 1349–82.

Newey, W., and D. McFadden (1994): “Large Sample Estimation and Hypothesis Testing,” in Handbook
  of Econometrics, Vol. 4, ed. by R. Engle, and D. McFadden, pp. 2113–2241. North Holland.

Pakes, A., J. Porter, K. Ho, and J. Ishii (2005): “Moment Inequalities and Their Application,” working
  paper, Harvard University.

Pesendorfer, M., and P. Schmidt-Dengler (2003): “Identiﬁcation and Estimation of Dynamic
  Games,” NBER working paper No. w9726.




                                                   36
Rust, J. (1994): “Structural Estimation of Markov Decision Processes,” in Handbook of Econometrics, Vol.
  4, ed. by R. Engle, and D. McFadden, pp. 3082–146. North Holland.

Seim, K. (2005): “An Empirical Model of Firm Entry with Endogenous Product-Type Choices,” forthcom-
  ing, Rand Journal of Economics.

Sweeting, A. (2005): “Coordination Games, Multiple Equilibria and the Timing of Radio Commercials,”
  Northwestern University Working Paper.

Tamer, E. (2003): “Incomplete Simultaneous Discrete Response Model with Multiple Equilibria,” Review
  of Economic Studies, 70(1).

Watson, L. T., S. C. Billups, and A. P. Morgan (1987): “Algorithm 652 HOMPACK: A Suite of
  Codes of Globally Convergent Homotopy Algorithms,” ACM Transactions on Mathematical Software,
  13(3), 281–310.

Watson, L. T., M. Sosonkina, R. C. Melville, A. P. Morgan, and H. F. Walker (1997): “Algo-
  rithm 777: HOMPACK90: A Suite of Fortran 90 Codes for Globally Convergent Homotopy Algorithms,”
  ACM Transactions on Mathematicsl Software, 23(4), 514–549.

Womack, K. (1996): “Do Brokerage Analyst Recommendations Have Investment Value,” Journal of Fi-
  nance, 51(1), 137–167.

Zangwill, W. I., and C. B. Garcia (1981): Pathways to Solutions, Fixed Points, and Equilibria. Prentice-
  Hall.



A      Proof for Theorem 2
Before we set out to prove the theorem we need to introduce some notations. Collapse the indexation for
i = 1, . . . , n and ai = 1, . . . , K to a single index j = 1, . . . , nK. In other words, each j represents a (i, ai )
pair. First we will rewrite the expression (47) for the case of multinomial choice probability as:

                                                       exp (Pj (σ))
                                          σj =                           ,                                          (62)
                                                 1+     k∈Ii exp (Pk (σ))

where Ii = {(i, ai ) , ai = 1, . . . , K} is the set of all indices j = (i, ai ) that corresponds to the set of strategies
available to player i, and Pj (σ) is the expected utility associated with player i for playing ai when j = (i, ai ):
                                                    
                               Pj (σ) = Pi,ai (σ) =     σ−i (a−i |s) Φi (ai , a−i , s) θ,
                                                        a−i

which is in general a polynomial function in σj . Let P(·) denote the vector-function of polynomials of size
nK × 1 that collects all the elements Pj (·) for j = 1, . . . , nK. Let Q be the product of the degrees of the
                                                                           nK
polynomial over all elements of the vector P(·). In other words, Q = j=1 Qj where Qj is the degree of
polynomial Pj (·). For each complex argument ξ ∈ CnK the system of polynomials has exactly Q solutions.

                                                              37
Because of this, for each ξ ∈ CnK we can ﬁnd Q vectors σ ∗ such that P(σ ∗ ) = ξ. Let us denote each
                          −1
particular vector σ ∗ by P(k) (ξ).
      The complex-valued vector P(·) of dimension nK × 1 can be transformed into a real-valued vector of
dimension 2nK ×1 by considering separately real and complex part of vector P(·). Because of the polynomial
                −1
property, each P(k) (ξ) is a continuously diﬀerentiable function of ξ for almost all ξ. It is possible that for
                                                            −1           −1                   
some range of the argument ξ, two (or more) solution paths P(k) (ξ) and P(k  ) (ξ) for k = k might coincide

with each other. In this case we will relabel the paths k so that the merged paths create a total Q of smooth
                −1
solution paths P(k) (ξ).
                                                                   −1
      The following analysis will apply to each individual branch P(k) (ξ), which we will just denote by P −1 (ξ)
without explicit reference to thepath indice k. For j = 1, . . . , nK introduce the following notations: ξj =
                                   yj
xj + iyj , ρj = ξj , ϕj = arctan xj . Then a homotopy system can be constructed for (62) as:
                                                                        (
                           H1j (ξ, τ ) = {ρqj cos(qϕj ) − 1}τ + (1 − τ ) Re{P −1 (ξ)}−
                                                                                                         )
                                            e2xj +exj cos(yj )+ k=j exj +xk cos(yj −yk )
                           − 1+          e2xk +2
                                                         xk
                                                                      
                                                             cos(yk )+ l∈I
                                                                                     xk +xl
                                                                                             cos(yl −yk )
                                   k∈Ii             k∈I e
                                                        i                      k=l e
                                                                               i


and
                                                                        (
                           H2j (ξ, τ ) = {ρqj sin(qϕj ) − 1}τ + (1 − τ ) Im{P −1 (ξ)}−
                                                                                                          )
                                                exj sin(yj )+ k=j exk +xj sin(yj −yk )
                           − 1+                                     
                                          e2xk +2 k∈I exk cos(yk )+ l∈I
                                                                                      xk +xl
                                                                                              cos(yl −yk )
                                   k∈Ii                 i                      ik=l e



      If the system P(·) is polynomial, P −1 (ξ) is smooth and has a Jacobian of full rank for almost all ξ.
Therefore, we can locally linearize it so that P −1 (ξ) ≈ Λξ + C. (This expansion is used only for the purpose
of clarity. A suﬃcient fact for the validity of the proof is that there exist Λ and C such that |P −1 (ξ)| ≤ Λ|ξ|+C
which is true if P(·) is a polynomial.) The homotopy system can then be written as:
                                                                           (
                          H1j (ξ, τ ) = {ρqj cos(qϕj ) − 1}τ + (1 − τ ) Λj xj −
                                                                                                )
                                        e2xj +exj cos(yj )+ k=j exj +xk cos(yj −yk )                              (63)
                          − 1+        2x
                                      e k +2
                                                     x
                                                    e k cos(yk )+
                                                                              x +x
                                                                              e k l cos(yl −yk )
                                   k∈Ii             k∈Ii                  l∈Ii     k=l


and
                                                                        (
                           H2j (ξ, τ ) = {ρqj sin(qϕj ) − 1}τ + (1 − τ ) Λj yj −
                                                                                                        )
                                                exj sin(yj )+ k=j exk +xj sin(yj −yk )                            (64)
                           − 1+                                     
                                          e2xk +2 k∈I exk cos(yk )+ l∈I
                                                                                      xk +xl cos(y −y )
                                   k∈Ii                 i                      ik=l e             l  k



where Λj is the jth row of the nK × nK matrix Λ. Without loss of generality we will let C = 0 in subsequent
analysis for the sake of brevity because all the results will hold for any other given C. To simplify notation
we will denote:
                                                                             
                       Θi (x, y) =          e2xk + 2          exk cos(yk ) +               exk +xl cos(yl − yk )
                                     k∈Ii              k∈Ii                    l∈Ii k=l

Now given some index k ∈ {1, . . . , Q}, we consider the solutions of the system {H(x, y, τ )} = 0 for all possible
real values of the vectors of x and y.
      Now we set out to prove the statements of Theorem 2. First we will prove statement (2). Deﬁne ρ = ξ
to be the Euclidean norm of the entire nK × 1 vector ξ. We need to prove that there will not be a sequence

                                                                  38
of solutions along a path where ρ → ∞. We will show this by contradiction. Consider a path where ρ → ∞.
Choose the component j of the homotopy system for which ρqj cos(q ϕj ) → ∞ at the fastest rate among all
                                                  8
the possible indexes j where ρj → ∞.
       Consider the real part of the homotopy function, H1j (·, ·, ·). The equation H1j (x, y, τ ) = 0 is equivalent
                         H1j (x,y,τ)
to the equation     τ (ρqj cos(q ϕj )−1)
                                           = 0 for ρj > 1. The last equation can be rewritten as:
                                              *                                                      +
                       (1 − τ )                      e2xj + exj cos(yj ) + k=j exj +xk cos(yj − yk )
               1+  q                          Λ x−
                                                  j
                                                                                                        = 0.                     (65)
                 τ ρj cos(q ϕj ) − 1                                   1 + Θi (x, y)

We will show that the second term in the curly bracket of the previous equation is uniformly bounded from
above in absolute terms:
               ! 2xj                                          !
               ! e + exj cos(yj ) + k=j exj +xk cos(yj − yk ) !
               !                                               !≤C                        and for a constant C,                  (66)
               !                1 + Θi (x, y)                  !

where the constant C can depend on . Therefore the term in the curly bracket in the homotopy (65) will
                                                                                            
grow at most at a linear rate |x| ≤ Cρj . On the other hand, denominator τ ρqj cos (qϕj ) − 1 outside the
curly bracket grows at a much faster polynomial rate for large q. Hence the second term in (65) is close to 0
for large q for large values of ξ, and equation (65) can not have a sequence of solutions that tends to inﬁnity.
       In other words, there exists R0 > 0 such that for any ξ = (x, y) outside ℘ with ξ ≥ R0 and any
τ ∈ (0, 1] we have that H1 (x, y, τ ) = 0, that is, homotopy system does not have solutions. This implies that

                          H −1 (τ ) ∩ ℘ ⊂ BR
                                           τ
                                             0
                                               = {(x, y, τ ) ∈ R2nK \ ℘ × (0, 1] ∩ ξ < R0 }.

This proves the statement 2).
       Finally, we will prove both statements 1) and 3) of Theorem 2. Again we consider the above homotopy
                           τ
system on the compact set BR 0
                               . The homotopy function is analytic in this set so Cauchy - Riehmann
theorem holds. This implies that
                         ∂H1j   ∂H2j                     ∂H1j    ∂H2j
                              =                 and           =−      ,      for all j, k = 1, . . . , 2nK.
                         ∂xk     ∂yk                      ∂yk     ∂xk
       This means that if the Jacobian is considered:
                                               ∂H                 ∂H1j    ∂H1j
                                                                                  
                                                              1j
                                                            ∂x     ∂y     ∂τ
                                                  Ji =      ∂H2j   ∂H2j    ∂H2j       ,
                                                             ∂x    ∂y     ∂τ
                                                                                                       2       2
                                                                                                 ∂H1j        ∂H
then it contains at least one 2×2 submatrix with nonnegative determinant                         ∂xk      + ∂y1jk
                                                                                                                     . Calculating the
derivatives directly due to the fact that  < ρ < R0 this determinant is strictly positive for all (x, y, τ ) ∈ BR
                                                                                                                 τ
                                                                                                                   0
                                                                                                                     .
   8
       In case when instead of ρqj cos(q ϕj ) → ∞ we have that ρqj sin(q ϕj ) → ∞, the proof can be appropriately modiﬁed
by considering the imaginary part of the j-th element of the homotopy system without any further changes. The logic
of the proof can be seen to hold as long as there is a slower growing element of x or y. In case when all components
of x and y grow at the same rate to inﬁnity in such a way that the second terms inside the curly brackets of (63) and
(64) explode to inﬁnity, one can take a Laurent expansion around the values of yk ’s such that the denominators are
close to zero. Then one can see that these terms in (63) and (64) explode to inﬁnity at quadratic and linear rates in
1/(y − y∗ ), respectively. Therefore (63) and (64) can not both be zero simultaneously for large x and y.


                                                                   39
Therefore, the implicit function theorem veriﬁes that the pair (x, y) can be locally parameterized by τ .
Moreover, this representation is locally unique and continuous. This proves the ﬁrst statement. The same
arguments above, which show that the determinant is positively almost everywhere, also immediately implies
the third statement.                                                                                                        2

Proof of equation (66):
    We are to bound the left hand side of equation (66) by a given constant. First of all we can bound the
denominator from below by
                              ,           , ,                                         ,
                              ,          , ,
                                            ,                
                                                                                      ,
                                                                                      ,
                              ,       2xk , ,
              1 + Θi (x, y) ≥ ,1 +   e , − ,2    xk
                                                e cos(yk ) +     exk +xl
                                                                         cos(yl − yk ),
                                                                                      ,,
                              ,           , ,                                         ,
                                         k∈Ii                  k∈Ii                    l∈Ii k=l


as a + b ≥ a − b . Then we can continue to bound:
                                                                                                  
                       1 + Θi (x, y) ≥ 1 +            k∈Ii   e2xk − 2      k∈Ii   exk −       l∈Ii       k=l e
                                                                                                               xk +xl
                                                                                                                      .   (67)

The last expression was obtained taking into account the fact that
                                                     
                           max 2       exk cos(yk ) +        exk +xl cos(yl − yk )
                             yk , k∈Ii
                                           k∈Ii                       l∈Ii k=l

is attained at the point cos(yk ) ≡ cos(yk − yl ) = 1, ∀k, l ∈ Ii .
For the same reason, we can bound the numerator from above by
                  ,                                            ,
                  , 2xj                                         ,
                  ,e + exj cos(yj ) + k=j exj +xk cos(yj − yk ), ≤ e2xj + exj cos(yj )
                                             ,               
                                              ,
                  + k=j exj +xk cos(yj − yk ), ≤ e2xj + exj + k=j exj +xk .

    Recall that j - th component was assumed to be the fastest growing x component as ρ → ∞. Then from
equation (67) for some small but positive constant ψ we can write:

                                                  1 + Θi (x, y) ≥ 1 + ψe2xj

    Collecting terms we have that:
                                                                                              
                         e2xj +exj cos(yj )+ k=j exj +xk cos(yj −yk )            1+e2xj +exj + k=j exj +xk
                                         1+Θi (x,y)
                                                                              ≤            1+ψe2xj
                                                                                                                   .

which is clearly uniformly bounded from above by a large constant.
    The same arguments can be used by looking at the imaginary part of the homotopy system when there
exists a yj that converges to inﬁnity at the fastest rate.                                                                  2


B      Proof for Theorem 3
For the clarify of exposition we will present the proof in the case of two strategies for each player. In the
case with more than two strategies for each player, the expansions for the homotopy system will be more


                                                                  40
complex and will involve more terms in the denominator. But the proof strategy is very similar, except it
involves more points around which expansions have to be taken.
      In the two strategy case case, we can rewrite the homopoty system (63) and (64) as

                                                                  -                                              .
                                                                                           e2xj +exj cos(yj )
                     H1j (ξ, τ ) = {ρqj cos(qϕj ) − 1}τ + (1 − τ ) Λj xj −               1+e2xj +2exj cos(yj )
                                                                                                                     ,

and
                                                                  -                                              .
                                                                                             exj sin(yj )
                     H2j (ξ, τ ) = {ρqj sin(qϕj ) − 1}τ + (1 − τ ) Λj yj −               1+e2xi +2exj cos(yj )
                                                                                                                     .

      We need to check the presence of solutions in the small vicinity of the imaginary axis. Now consider
positive increments of xj such that xj is equal to some small value . If we linear the above homotopy system
around xj = 0, we can approximate them linearly by
                                    (1 − τ )      1         1+τ                   
                H1j =τ qyjq−1 −                           −     + λjj (1 − τ ) +   λjk xk (1 − τ )
                                       2      1 + cos(yj )    2
                                                                                                   k=j
                                                                                                                        (68)
                                                        1 − τ sin(yj )
                H2j =τ yjq   + (1 − τ )        λjk yk −                  −τ
                                                          2 1 + cos(yj )
                                          k

where λjj is the j, jth element of the Λ matrix.
      One can see that these two functions are continuous everywhere except for the set of points {yj =
π + 2πk, k ∈ Z} where cos (yj ) = −1.
      We will prove that for appropriate large values of q this system has no solutions in the vicinity of this
set. First of all note that if we take a second order expansion of 1 + cos (yj ) around some yj∗ = π + 2πk we
                                            2
can approximate 1 + cos (yj ) ≈ 12 yj − yj∗ . Then we can further linearize these two equations in (68) to:
                                                                                            1+τ    (1 − τ )
                    H1j =τ qyj∗ q−1 − λjj (1 − τ ) +                   λkj xk (1 − τ ) −       −
                                                                                              2    (yj − yj∗ )2
                                                                  k=j
                                                                                                                        (69)
                                                                                                           1
                    H2j =τ yj∗ q   + (1 −     τ )λjj yj∗   −          λkj yk (1 − τ ) − τ + (1 − τ )
                                                                                                       (yi − yi∗ )
                                                               k=j
                                             
where we have also used sin (yj ) ≈ − yj − yj∗ .
      Now we can construct a sequence of homotopies with the order q increasing to inﬁnity at appropriate
rate such that these homotopies do not have solutions with extraneous solution of |yj | → ∞. This sequence
of q is constructed by letting q = 1 + 1/, as  → 0. Along this sequence, we will see below that the solutions
yj − yj∗ to H1j and H2j will be of diﬀerent orders of magnitude. Therefore there can not solutions yj − yj∗
that simultaneously satisfy both equations H1j = 0 and H2j = 0.                                           1
                                                                                                           ∗
      To see this, consider the ﬁrst part H1j = 0 of (69). For small  only the ﬁrst term τ qyj∗ q−1 = O yj 
and the last term (y(1−τ)                                              ∗
                           ∗ 2 dominate. Therefore the solution yj − yj has to have the order of magnitude
                       j −yj )
   /         1
                
        1 ∗− 2
O        yj       . On the other hand, for the second part H2j = 0 of (69). For small  only the ﬁrst term
             1
                ∗
τ yj∗ q = O yj  and the last term (1 − τ ) (yi −y
                                                1
                                                   ∗  dominate. Therefore the solution yj − yj∗ has to have the
                                                   i)
                                                                          /          
                            ∗− 1                                                     1
                                                                                1 ∗− 2
order of magnitude O yj  which increases to ∞ much slower than O                yj       as  → ∞. Therefore


                                                                       41
there can be no solution yj to both H1j and H2j simultaneously for the sequence of q chosen above. This
proves that the homotopy is path ﬁnite along that sequence of q.
          The considered homotopy function is analytic outside the balls of ﬁxed radius around the members of
countable set of points {xj = 0, yj = π + 2πk}, k ∈ Z 9 . Therefore a monotone smooth parametrization is
available except for the interior of these balls because the determinant of the Jacobian is strictly positive
everywhere else.
          This establishes regularity of the homotopy and concludes the proof.                                      2


Proof of equation (68): We consider each term individually. First of all
                                                 π                    π  
                              ϕ = arctan (y/) = − arctan (/y) ≈ − .
                                                 2                    2  y
                                                                  π
Hence, as long as q is chosen so that qπ/2 is 2kπ +           for some k,
                                                                  2
                                                                                   
                                                                    π               q  q
                           cos (qϕ) = cos (q arctan (y/)) ≈ cos q − q        = sin     ≈ .
                                                                    2    y           y   y
Together with ρq ≈ yjq , this gives the ﬁrst term in H1j .
          Secondly, a ﬁrst order expansion around  = 0 gives
                                             exj sin(yj )   1 1      1
                                            2x       x
                                                           ≈ +               .
                                       1 + e + 2e cos(yj )
                                               i       j    2 2 1 + cos (yj )
Therefore the H1j is proved in (68).
          The second part of H2j follows similarly, noting that given the choice of q where sin(qϕ) = 1, and
                                                                  exj sin(yj )
ρqj   ≈ yjq , and the ﬁrst Taylor expansion term for          1+e2xi +2exj cos(yj )
                                                                                      vanishes.


End of proof for equation (68).


C           Semiparametric Variance
To derive Ω, we need to follow Newey (1990) and derive the asymptotic linear inﬂuence function of the left
hand side of the above relation. For this purpose, note that

                     1 
                         T                           
                    √       A (st ) yt − σ st , Φ̂, θ0
                      T t=1
                    1 
                        T
                                                               1 
                                                                   T                                        
                  =√       A (st ) (yt − σ (st , Φ0 , θ0 )) − √       A (st ) σ st , Φ̂, θ0 − σ (st , Φ0 , θ0 ) .
                     T t=1                                      T t=1

Since Φ̂ depends only on the nonparametric estimates of choice probabilities σ̂j (k|s) , j = 1, . . . , n, k =
1, . . . , K in (29) through (24), the second part can also be written as

                                   1 
                                       T
                                  √       A (st ) (Γ (st , θ0 ; σ̂ (s)) − Γ (st , θ0 ; σ0 (s))) ,
                                    T t=1
      9
          Moreover, it is possible to check that the homotopy system has no solutions when all arguments are purely
imaginary in case if q is an arbitrary odd number


                                                                  42
where σ̂ (s) is the collection of all σ̂j (k|s) for j = 1, . . . , n and k = 1, . . . , K, and the function Γ (·) is
deﬁned in (28). Then using the semiparametric inﬂuence function representation of Newey (1994), as long
as Γ (st , θ, σ (s)) is suﬃciently smooth in σ (s) and as long as the nonparametric ﬁrst stage estimates satisfy
certain regularity conditions regarding the choice of the smoothing parameters, we can write this second
part as

                                   1 
                                       T
                                  √       A (st ) (Γ (st , θ0 ; σ̂ (s)) − Γ (st , θ0 ; σ0 (s)))
                                    T t=1
                                  1 
                                      T
                                                  ∂
                                =√       A (st )    Γ (st , θ0 ; σ0 (s)) (yt − σ (st , θ0 )) + op (1) .
                                   T t=1         ∂σ
                                                ∂
In other words, if we write Γσ (s) =           ∂σ Γ (st , θ0 ; σ0 (s)),   we can write

                                       1 
                                           T                           
                                      √       A (st ) yt − σ st , Φ̂, θ0
                                        T t=1
                                     1 
                                         T
                                   =√       A (st ) (I − Γσ (st )) (yt − σ (st , θ0 )) + op (1) .
                                      T t=1

      Therefore we can derive the asymptotic distribution of the two-step semiparametric θ̂ deﬁned through
(33) as

          √        
                                            −1 1
                                                  T
           T θ̂ − θ0 = − (EA (st ) Γθ (st )) √        A (st ) (I − Γσ (st )) (yt − σ (st , θ0 )) + op (1) .
                                                T t=1
Hence
                                                 √        
                                                             d
                                                  T θ̂ − θ0 −→ N (0, Σ)

where Σ is equal to
                           −1 "                                                         #                −1
        E (A (st ) Γθ (st ))       EA (st ) (I − Γσ (st )) Ω (st ) (I − Γσ (st )) A (st ) E Γθ (st ) A (st )      .

In the above, we have deﬁned
                                                                                  !
                                                   ∂                              !
                                       Γθ (st ) =     Γ (st , θ1 , σ (st ; θ2 )) !!            ,
                                                  ∂θ1                               θ1 =θ2 =θ0

and

                                             Ω (st ) = V ar (yt − σ (st , θ0 ) |st ) .

The eﬃcient choice of the instrument matrix (which can be feasibly estimated in preliminary steps without
aﬀecting the asymptotic variance) is then given by
                                                                   −1         −1                  −1
                               A (st ) = Γθ (st ) (I − Γσ (st ))         Ω (st )    (I − Γσ (st ))       .

With this eﬃcient choice of the instrument matrix, the asymptotic variance of θ̂ becomes
                                                                                 −1
                                             −1      −1              −1
                      EΓθ (st ) (I − Γσ (st )) Ω (st ) (I − Γσ (st ))     Γθ (st )    .                               (70)


                                                                    43
C.1       Eﬃciency Considerations
We present two eﬃciency results in this section. First of all, we show that with the above eﬃcient choice of
the instrument matrix A (st ), the semiparametric two step estimation procedure above is as eﬃcient as the
full maximum likelihood estimator where the ﬁxed point mapping in (28) is solved for every parameter value
θ which is then nested inside maximum likelihood optimization to obtain choice probabilities as a function
of θ. Secondly, we show that estimating σ̂ (st ) may even improves eﬃciency over the hypothesis case where
σ (st ) is known and the pseudo MLE in (34) is used to estimate θ (but using Φ0 instead of Φ̂).


C.1.1      Eﬃciency comparison with full maximum likelihood

Consider a full maximum likelihood approach where a ﬁxed point calculation (assuming the solution is
unique) of (28) is nested inside the numerical optimization. For each θ, (28) is solved to obtain σ (st , θ) as
a function of θ, which is then used to form the likelihood function as in (34). Deﬁne the total derivative of
(28) as
                                                                                !
                                    d                d                          !
                                      σ (st , θ0 ) =    Γ (st , θ, σ (st ; θ)) !!
                                   dθ                dθ                           θ=θ0
                                                        d
                                  =Γθ (st ) + Γσ (st ) σ (st , θ0 )
                                                       dθ
which can be used to solve for
                                    d                               −1
                                       σ (st , θ0 ) = (I − Γσ (st )) Γθ (st ) .                           (71)
                                    dθ
    Following the same logic as the discussions of pseudo MLE after (34), but with the pseudo log likelihood
function replaced by the full maximum likelihood function, it is easy to show that the asymptotic distribution
of the full maximum likelihood estimator, which is the same as an iv estimator with the instruments chosen
optimally, satisﬁes
                                   √              
                                                     d
                                    T θ̂F M LE − θ0 −→ N (0, ΣF M LE )

where
                                                                                        −1
                                             d                 −1 d              
                            ΣF M LE =       E σ (st , θ0 ) Ω (s)      σ (st , θ0 )             .
                                             dθ                    dθ

Using (71), we can also write
                                                                                   −1
                                                   −1      −1             −1
                  ΣF M LE = EΓθ (st ) (I − Γσ (st )) Ω (st ) (I − Γσ (st )) Γθ (st )    .

This is identical to (70) for the asymptotic variance of the two step semiparametric iv estimator when the
instrument matrix is chosen optimally.




                                                          44
C.1.2       Eﬃciency comparison with infeasible pseudo MLE

Consider an infeasible pseudo MLE, which is similar to (34) except with Φ̂ replaced by the true but unknown
Φ0 :
                 K                                                                                             
             
             T 
               n                                                     
                                                                      K                    
                                                                                           K
                             yikt log σi (k|st , Φ0 , θ) +       1−         yikt log 1 −         σi (k|st , Φ0 , θ)     .              (72)
             t=1 i=1   k=1                                            k=1                  k=1

                                                                                                              d             
The asymptotic variance of this estimator is similar to that of ΣF M LE except with                          dθ σ (st , θ0 )    replaced by
Γθ (st ). In other words,
                                                                          −1
                                                                 −1
                                      ΣIP M LE = EΓθ (st ) Ω (st ) Γθ (st )    .

where IP M LE stands for infeasible pseudo MLE.
       The relation between ΣF M LE and ΣIP M LE is obviously ambiguous and depends on the response matrix
Γσ (st ). It is clear possible that ΣF M LE < ΣIP M LE , in which case estimating Φ̂ may improve eﬃciency over
the case where Φ0 is known.




                                                                      45
                      Table 6.1: Characteristics of the Parameters
     PARAMETER              MEAN                  VARIANCE            DISTRIBUTION
θ1                    2.45                   1                       Normal
θ2                    5.0                    1                       Normal
θ3                    1.0                    1                       Normal
θ4                    -1.0                   1                       Normal
x1                    1.0                    0.33                    Uniform
X2                    1.0                    0.33                    Uniform


                Table 6.2 (i): Results of Monte-Carlo Simulations, n=3.
 PARAMETER             MEAN              STD. DEV           MAX                 MIN
# of equilibria   1.592                1.175           7                    1
P1                0.366                0.362           0.998                0
P2                0.360                0.367           0.995                0
P3                0.363                0.348           0.993                0.003


                Table 6.2 (ii): Results of Monte-Carlo Simulations, n=4.
 PARAMETER             MEAN               STD. DEV           MAX                MIN
# of equilibria   1.292                0.777            5                   1
P1                0.278                0.328            0.981               0.001
P2                0.246                0.320            0.981               0.003
P3                0.276                0.338            0.999               0.001
P4                0.280                0.338            0.987               0.002


                Table 6.2 (iii): Results of Monte-Carlo Simulations, n=5.
 PARAMETER              MEAN              STD. DEV            MAX               MIN
# of equilibria    1.106                0.505            5                  1
P1                 0.104                0.201            0.964              0
P2                 0.138                0.252            0.975              0
P3                 0.315                0.338            0.992              0
P4                 0.356                0.385            0.983              0
P5                 0.319                0.344            0.982              0
            Table 6.3 (i): Frequencies for the number of equilibria, n=3.
    # OF EQUILIBRIA             NUMBER OF CASES                 FREQUENCY (%)
n=1                          192                           47.93
n=3                          132                           33.06
n=5                          64                            16.12
n=7                          12                            2.89
Total                        400                           1.00

            Table 6.3 (ii): Frequencies for the number of equilibria, n=4.
    # OF EQUILIBRIA             NUMBER OF CASES                 FREQUENCY (%)
n=1                          287                           71.84
n=3                          93                            23.30
n=5                          20                            4.85
Total                        400                           1.00

            Table 6.3 (iii): Frequencies for the number of equilibria, n=5.
    # OF EQUILIBRIA              NUMBER OF CASES                 FREQUENCY (%)
n=1                           373                           93.16
n=3                           25                            6.21
n=5                           2                             0.62
Total                         400                           1.00
                Table 6.4 (i): Entry Probability of First Player, n=3.
    # OF EQUILIBRIA                    MEAN                            STD
n=1                         0.375                            0.386
n=3                         0.337                            0.341
n=5                         0.353                            0.322
n=7                         0.601                            0.367

               Table 6.4 (ii): Entry Probability of First Player, n=4.
    # OF EQUILIBRIA                    MEAN                            STD
n=1                         0.211                           0.300
n=3                         0.431                           0.328
n=5                         0.129                           0.235

               Table 6.4 (iii): Entry Probability of First Player, n=5.
    # OF EQUILIBRIA                    MEAN                             STD
n=1                         0.116                            0.216
n=3                         0.080                            0.206
n=5                         0.007                            0.232
                  Table 7.1: Recommendation Variables.
         RECOMMENDATION              NUMERICAL VALUE RECORDED BY
                                                     I/B/E/S
Strong Buy                                              1
Buy                                                     2
Hold                                                    3
Underperform                                            4
Sell                                                    5



                                  Table 7.2: Summary Statistics.
  VARIABLE                 MEAN           STD.         MIN.                     MAX.             NOBS
Recommendation              2.210        0.9168          1                        5              12719
Relation                   0.0350        0.1839          0                        1              12719
Ibank                      0.8155        0.3878          0                        1              12719
Earnings                   0.1111        0.2439       -3.010                    1.720            12719



                Table 7.3: Tabulation of Recommendations by Quarter.
  VARIABLE/TIME              Q1 1998            Q1 2000              Q2 2003
      PERIOD
  % Recs. Equal to 1          30.51              46.73                11.65
  % Recs. Equal to 2          30.51              41.46                18.12
  % Recs. Equal to 3          37.62              11.81                53.07
  % Recs. Equal to 4          1.02                0.00                12.62
  % Recs. Equal to 5          0.34                0.00                4.53


          Table 7.4 Ordered Logit Estimates of the Effect of Fundamentals.
   VARIBLE          COEF.             COEF.              COEF.             COEF.
    %DEV        -.0539 (-0.276) -.1030 (-0.519)              -               -
   ABS. DEV                                          -.1030 (-0.519)         -

Log Likelihood           -16171.589           -14861.218             -14861.218             -14861.352
   Psueo-R2                0.0000               0.0810                 0.0810                 0.0810
 Fixed Effects              none             quarterly,stock       quarterly, stock       quarterly, stock
In the ordered logit model, the dependent variable is the analyst’s recommendation as coded by IBES. This
takes on discrete values from one to five. In the table above, t-statistics are included in parentheses. Most
of the quarterly and stock fixed effects are significant in the specifications that we study.
                  Table 7.5 Quarterly Effects Versus Market Indexes.
VARIABLE          COEFFICIENT T-STATISTIC NASDAQ                       QQQ
qdum2                -0.1865            -1.979            1,770
qdum3               -0.15266            -1.803            1,509
qdum4               -0.24117            -2.258            1,928
qdum5               -0.27011            -3.134            2,207          102.25
qdum6               -0.36868            -4.297            2,467          103.87
qdum7               -0.46412            -5.485            2,752          120.12
qdum8               -0.43603            -5.149            3,341          148.63
qdum9                -0.6408            -7.394            4,732          214.5
qdum10              -0.43113            -4.973            3,471           85.19
qdum11              -0.35704            -3.958            4,252            103
qdum12              -0.08381            -1.031            2,664           64.06
qdum13               0.07177             0.955            2,126          46.97
qdum14               0.04712             0.632            2,131          85.19
qdum15              0.063716              0.79            1,802          36.51
qdum16              0.128908             1.671            1,915          39.29
qdum17              0.217669              2.86            1,745          34.15
qdum18              0.349657             4.631            1,613            30
qdum19              0.630952             8.753            1,403          26.05
qdum20              1.009163            13.389            1,887          21.07
qdum21              0.572553             7.596            1,345          24.72
qdum22              0.989535             12.45            1,374          26.06



               Table 7.6 Regression of Dummies on Market Indexes.
            VARIABLE            COEFFICIENT         COEFFICIENT
           Constant            .8208896 (3.965)       0.6270 (4.3)
           Nasdaq Index       -.0003467 (-4.960)            -
           QQQ Price                   -              -0.007 (-4.7)

           Nobs                         21                     18
           R2                          0.48                  0.6830
       Table 7.7 Ordered Logit Estimates of the Effect of Conflicts of Interest.
   VARIBLE           COEF.             COEF.              COEF.              COEF.
  RELATION       -.3231 (-6.19)    -.1108 (-2.06)     .05397 (0.94)      .03932 (0.68)
    IBANK                                                                 .1080 (4.18)

Log Likelihood           -16152.389             -15314.605             -14860.888             -14855.94
   Psueo-R2                0.0012                 0.0530                 0.0811                 0.0814
 Fixed Effects              none                 quarterly           quarterly, stock       quarterly, stock
In the ordered probit model, the dependent variable is the analyst’s recommendation as coded by IBES.
This takes on discrete values from one to five. In the table above, t-statistics are included in parentheses.
We do not report ancillary parameters, such as the cut values and values of the fixed effects.




   Table 7.8 Ordered Logit Estimates including Peer Effects (Parametric First Stage)
  VARIABLE           COEF.             COEF.             COEF.              COEF.
IVBELIEF           1.121982           1.108108          .2531818          .2531353
                     (24.66)            (7.90)            (5.80)            (5.75)

IBANK                           -                      -                      -                .2938029
                                                                                                 (4.41)
RELATION                        -                      -                      -                -.0879437
                                                                                                 (-1.16)

%DEV                            -                      -                      -                 .0073782
                                                                                                  (0.71)


Log Likelihood           -15113.967             -14930.088             -14823.868             -14535.476
Psueo- R 2                 0.0472                 0.0588                 0.0830                 0.0837
Fixed Effects               none                   stock             quarterly, stock       quarterly, stock
In the ordered logit model, the dependent variable is the analyst’s recommendation as coded by IBES. This
takes on discrete values from one to five. In the table above, t-statistics are included in parentheses (the t-
statistic for the variable IVBELIEF is corrected using bootstrap). IVBELIEF is constructed by subtracting
the individual fitted values (divided by the number of the other analysts for a specific stock in a specific
quarter) from the conditional expectations of fitted values (conditional on quarter and stock), with these
fitted values being from the parametric first stage regression. Most of the quarterly and stock fixed effects
are significant in the specifications that we study.
 Table 7.9 Ordered Logit Estimates including Peer Effects (Semiparametric First Stage)
  VARIABLE           COEF.             COEF.              COEF.            COEF.
IVBELIEF            1.121863          1.108009          .2542394          .2540114
                     (10.73)           (23.20)             (5.95)           (5.90)

IBANK                            -                     -                      -                 .2935598
                                                                                                   (4.41)
RELATION                         -                     -                      -                  -.0880207
                                                                                                  (-1.16)
%DEV                             -                     -                      -                 .0072834
                                                                                                   (0.70)

Log Likelihood            -15113.55             -14929.674               -14545.766           -14535.35
Psueo- R 2                  0.0472                0.0588                   0.0830               0.0837
Fixed Effects                none                  stock               quarterly, stock     quarterly, stock

In the ordered logit model, the dependent variable is the analyst’s recommendation as
coded by IBES. This takes on discrete values from one to five. In the table above, t-statistics are included in
parentheses (the t-statistic for the variable IVBELIEF is
corrected using bootstrap). IVBELIEF is constructed by subtracting the individual fitted values (divided by
the number of the other analysts for a specific stock in a specific quarter) from the conditional expectations
of fitted values (conditional on quarter and stock), with these fitted values being from the first stage
semiparametric sieve regression. Most of the quarterly and stock fixed effects are significant in the
specifications that we study.



Table 7.10 Random Effect Estimates including Peer Effects (Semiparametric First Stage)
  VARIABLE        COEF.         COEF.          COEF.          COEF.         COEF.
IVBELIEF         .766924            -             -          .7631302     .7672082
                  (11.53)                                     (11.51)      (10.63)

IBANK                        -            .6669054                 -                 -           .6559327
                                            (7.94)                                                 (7.87)
RELATION                     -                 -             -.2539996         -.1754189         -.2416273
                                                               (-1.61)           (-1.22)           (-1.67)

Log                  -6454.5547          -6687.9966         -6717.4526        -6453.8047        -6423.6011
Likelihood
The dependent variable is equal to zero if the analyst’s recommendation is recorded as 1
(i.e. strong buy) in IBES and one otherwise. IVBELIEF is constructed by subtracting the individual fitted
values (divided by the number of analysts for a specific stock in a specific quarter) from the conditional
expectations of fitted values (conditional on quarter and stock), with these fitted values being from the first
stage semiparametric sieve regression. In the table above, t-statistics are included in parentheses (the t-
statistic for the variable IVBELIEF is corrected using bootstrap). There was a unique fixed effect for
each stock during each quarter. In the data, 3447 observations were dropped due to all
positive or negative recommendations.
                   Table 7.11 Equilibrium Simulations.
             REC=1       REC=2          REC=3        REC=4      REC=5
IBANK=0      0.6353      0.2785       0.08113      0.4650E-03   0.3400E-04
QUARTER=9
IBANK=1      0.06847     0.68742      0.22397      0.014376     0.5753E-02
QUARTER=9
FIRST
EQUILBRIUM
IBANK=1      0.4042      0.4009       0.1821       0.01183      0.87246E-04
QUARTER=9
SECOND
EQUILBRIUM
IBANK=0      0.2096      0.4076       0.3507       0.2967E-02   0.2235E-03
QUARTER=21
IBANK=1      0.09775     0.2936       0.5316       0.7127E-02   0.5653E-03
QUARTER=21
